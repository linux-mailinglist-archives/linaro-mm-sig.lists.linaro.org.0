Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 5A50C5118CB
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 27 Apr 2022 16:34:46 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 8C7E947FB2
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 27 Apr 2022 14:34:45 +0000 (UTC)
Received: from mail-yw1-f202.google.com (mail-yw1-f202.google.com [209.85.128.202])
	by lists.linaro.org (Postfix) with ESMTPS id 6A66F3EC43
	for <linaro-mm-sig@lists.linaro.org>; Wed, 20 Apr 2022 23:52:44 +0000 (UTC)
Received: by mail-yw1-f202.google.com with SMTP id 00721157ae682-2f182a726abso29636137b3.1
        for <linaro-mm-sig@lists.linaro.org>; Wed, 20 Apr 2022 16:52:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=google.com; s=20210112;
        h=date:in-reply-to:message-id:mime-version:references:subject:from:to
         :cc:content-transfer-encoding;
        bh=5E9Rbs7lnkN3+W98JnkIUAPTQ49TUyPznJB6J7YNkeo=;
        b=SWzxIRgdRQUtqcnezZ1qAW7U1kX7+57LPNNbfRy88rcYumm4IA2OJuYgyyg7UDgn4q
         MCDVqH2XccdjAMgVUESHKUP693m4h0vVR930REBPdZ6wch5vagUCuVlCO3pq1G/WttSm
         AKvzWT9Nlv5PQyonszFAMeFGYDERNSYU+Ih9zKKj6eBos5pKLMLliVS1pcZcxSRG7Zrn
         Oqa7NQcw9kxxBDKs5sWyq9NwhYkTbsb6IZoi2/ioWxpbEzVBB21ZKhOvAmxpG8APKTEc
         XJCoqM2RQuc7J0nxY6KCv4Zd+OgEpsgHqAse8y3xvopI5/qJepc4wtE8OIQeY+rpy9yg
         tZlw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=x-gm-message-state:date:in-reply-to:message-id:mime-version
         :references:subject:from:to:cc:content-transfer-encoding;
        bh=5E9Rbs7lnkN3+W98JnkIUAPTQ49TUyPznJB6J7YNkeo=;
        b=0yrmAUlhSTMcNkzSheK2u8+NRJoC/aC12y1VwgurIQJb33Fa3XLO/yv9A1y5OFTEw6
         FV/zn85GgKvTbB90eEXfPHxkPm/+9xSm5f3qRlK8/oIIet2QMqDxFnl/2120dyI3OFMb
         5mmJR5wULr5Ee6lDDLtu8LelOGAEn/KXnfDo+psSGokK+6X3+Gurv+AX0IYRyO7SKLK7
         GclWxOgaEt1ppRZPGcBYjD8lpBHVLgWZtmgiSKaGxkukekyNT9OE4cRFJA4W8fyTVZOK
         b43yMZz9aWFpEW3rdRL0ZtE5F/896hHRFRp1LoPdSLI+xVt1Do48YadXvgbtjVa49Jn0
         zL8Q==
X-Gm-Message-State: AOAM530TwoFI/CJyBv6tOntgNvF7NsISBCBALkljRz9zcjfuhTN+xlxb
	hg9d2c+yhSQUvzmDsRYTE1TCd5uImUMPxDc=
X-Google-Smtp-Source: ABdhPJw5EwHTC7Q1N41+mc2GzL5YAYNhrKpjL8DBLEBrLVaVg9GO5bS/iutUfeBK1JN69nQVWaRhMs4VIs/z4os=
X-Received: from tj.c.googlers.com ([fda3:e722:ac3:cc00:20:ed76:c0a8:53a])
 (user=tjmercier job=sendgmr) by 2002:a25:7795:0:b0:645:682a:d56e with SMTP id
 s143-20020a257795000000b00645682ad56emr3285177ybc.403.1650498763943; Wed, 20
 Apr 2022 16:52:43 -0700 (PDT)
Date: Wed, 20 Apr 2022 23:52:21 +0000
In-Reply-To: <20220420235228.2767816-1-tjmercier@google.com>
Message-Id: <20220420235228.2767816-4-tjmercier@google.com>
Mime-Version: 1.0
References: <20220420235228.2767816-1-tjmercier@google.com>
X-Mailer: git-send-email 2.36.0.rc0.470.gd361397f0d-goog
From: "T.J. Mercier" <tjmercier@google.com>
To: tjmercier@google.com, daniel@ffwll.ch, tj@kernel.org,
	Sumit Semwal <sumit.semwal@linaro.org>,
	"=?UTF-8?q?Christian=20K=C3=B6nig?=" <christian.koenig@amd.com>,
	Benjamin Gaignard <benjamin.gaignard@collabora.com>, Liam Mark <lmark@codeaurora.org>,
	Laura Abbott <labbott@redhat.com>, Brian Starkey <Brian.Starkey@arm.com>,
	John Stultz <john.stultz@linaro.org>
X-MailFrom: 3y5xgYgkKDaATJMERCIERGOOGLE.COMLINARO-MM-SIGLISTS.LINARO.ORG@flex--tjmercier.bounces.google.com
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
Message-ID-Hash: BC4EGYO2A64DALTRRNX5NZ33XD46ULG4
X-Message-ID-Hash: BC4EGYO2A64DALTRRNX5NZ33XD46ULG4
X-Mailman-Approved-At: Wed, 27 Apr 2022 14:34:39 +0000
CC: hridya@google.com, jstultz@google.com, tkjos@android.com, cmllamas@google.com, surenb@google.com, kaleshsingh@google.com, Kenny.Ho@amd.com, mkoutny@suse.com, skhan@linuxfoundation.org, kernel-team@android.com, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [RFC v5 3/6] dmabuf: heaps: export system_heap buffers with GPU cgroup charging
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/BC4EGYO2A64DALTRRNX5NZ33XD46ULG4/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

QWxsIERNQSBoZWFwcyBub3cgcmVnaXN0ZXIgYSBuZXcgR1BVIGNncm91cCBidWNrZXQgdXBvbiBj
cmVhdGlvbiwgYW5kIHRoZQ0Kc3lzdGVtX2hlYXAgbm93IGV4cG9ydHMgYnVmZmVycyBhc3NvY2lh
dGVkIHdpdGggaXRzIEdQVSBjZ3JvdXAgYnVja2V0IGZvcg0KdHJhY2tpbmcgcHVycG9zZXMuDQoN
CkluIG9yZGVyIHRvIHN1cHBvcnQgR1BVIGNncm91cCBjaGFyZ2UgdHJhbnNmZXIgb24gYSBkbWEt
YnVmLCB0aGUgY3VycmVudA0KR1BVIGNncm91cCBpbmZvcm1hdGlvbiBtdXN0IGJlIHN0b3JlZCBp
bnNpZGUgdGhlIGRtYS1idWYgc3RydWN0LiBGb3INCnRyYWNrZWQgYnVmZmVycywgZXhwb3J0ZXJz
IGluY2x1ZGUgdGhlIHN0cnVjdCBncHVjZyBhbmQgc3RydWN0DQpncHVjZ19idWNrZXQgcG9pbnRl
cnMgaW4gdGhlIGV4cG9ydCBpbmZvIHdoaWNoIGNhbiBsYXRlciBiZSBtb2RpZmllZCBpZg0KdGhl
IGNoYXJnZSBpcyBtaWdyYXRlZCB0byBhbm90aGVyIGNncm91cC4NCg0KU2lnbmVkLW9mZi1ieTog
SHJpZHlhIFZhbHNhcmFqdSA8aHJpZHlhQGdvb2dsZS5jb20+DQpTaWduZWQtb2ZmLWJ5OiBULkou
IE1lcmNpZXIgPHRqbWVyY2llckBnb29nbGUuY29tPg0KDQotLS0NCnY1IGNoYW5nZXMNCk1lcmdl
IGRtYWJ1ZjogVXNlIHRoZSBHUFUgY2dyb3VwIGNoYXJnZS91bmNoYXJnZSBBUElzIGludG8gdGhp
cyBwYXRjaC4NCg0KUmVtb3ZlIGFsbCBHUFUgY2dyb3VwIGNvZGUgZnJvbSBkbWEtYnVmIGV4Y2Vw
dCB3aGF0J3MgbmVjZXNzYXJ5IHRvIHN1cHBvcnQNCmNoYXJnZSB0cmFuc2Zlci4gUHJldmlvdXNs
eSBjaGFyZ2luZyB3YXMgZG9uZSBpbiBleHBvcnQsIGJ1dCBmb3INCm5vbi1BbmRyb2lkIGdyYXBo
aWNzIHVzZS1jYXNlcyB0aGlzIGlzIG5vdCBpZGVhbCBzaW5jZSB0aGVyZSBtYXkgYmUgYQ0KZGVh
bHkgYmV0d2VlbiBhbGxvY2F0aW9uIGFuZCBleHBvcnQsIGR1cmluZyB3aGljaCB0aW1lIHRoZXJl
IGlzIG5vDQphY2NvdW50aW5nLg0KDQpBcHBlbmQgIi1oZWFwIiB0byBncHVjZ19idWNrZXQgbmFt
ZXMuDQoNCkNoYXJnZSBvbiBhbGxvY2F0aW9uIGluc3RlYWQgb2YgZXhwb3J0LiBUaGlzIHNob3Vs
ZCBtb3JlIGNsb3NlbHkgbWlycm9yDQpub24tQW5kcm9pZCB1c2UtY2FzZXMgd2hlcmUgdGhlcmUg
aXMgcG90ZW50aWFsbHkgYSBkZWxheSBiZXR3ZWVuIGFsbG9jYXRpb24NCmFuZCBleHBvcnQuDQoN
ClB1dCB0aGUgY2hhcmdlIGFuZCB1bmNoYXJnZSBjb2RlIGluIHRoZSBzYW1lIGZpbGUgKHN5c3Rl
bV9oZWFwX2FsbG9jYXRlLA0Kc3lzdGVtX2hlYXBfZG1hX2J1Zl9yZWxlYXNlKSBpbnN0ZWFkIG9m
IHNwbGl0dGluZyB0aGVtIGJldHdlZW4gdGhlIGhlYXAgYW5kDQp0aGUgZG1hX2J1Zl9yZWxlYXNl
Lg0KDQpNb3ZlIG5vLW9wIGNvZGUgdG8gaGVhZGVyIGZpbGUgdG8gbWF0Y2ggb3RoZXIgZmlsZXMg
aW4gdGhlIHNlcmllcy4NCg0KdjMgY2hhbmdlcw0KVXNlIG1vcmUgY29tbW9uIGR1YWwgYXV0aG9y
IGNvbW1pdCBtZXNzYWdlIGZvcm1hdCBwZXIgSm9obiBTdHVsdHouDQoNCnYyIGNoYW5nZXMNCk1v
dmUgZG1hLWJ1ZiBjZ3JvdXAgY2hhcmdlIHRyYW5zZmVyIGZyb20gYSBkbWFfYnVmX29wIGRlZmlu
ZWQgYnkgZXZlcnkNCmhlYXAgdG8gYSBzaW5nbGUgZG1hLWJ1ZiBmdW5jdGlvbiBmb3IgYWxsIGhl
YXBzIHBlciBEYW5pZWwgVmV0dGVyIGFuZA0KQ2hyaXN0aWFuIEvDtm5pZy4NCi0tLQ0KIGRyaXZl
cnMvZG1hLWJ1Zi9kbWEtYnVmLmMgICAgICAgICAgIHwgMTkgKysrKysrKysrKysrKw0KIGRyaXZl
cnMvZG1hLWJ1Zi9kbWEtaGVhcC5jICAgICAgICAgIHwgMzkgKysrKysrKysrKysrKysrKysrKysr
KysrKysrDQogZHJpdmVycy9kbWEtYnVmL2hlYXBzL3N5c3RlbV9oZWFwLmMgfCAyOCArKysrKysr
KysrKysrKysrKy0tLQ0KIGluY2x1ZGUvbGludXgvZG1hLWJ1Zi5oICAgICAgICAgICAgIHwgNDEg
KysrKysrKysrKysrKysrKysrKysrKystLS0tLS0NCiBpbmNsdWRlL2xpbnV4L2RtYS1oZWFwLmgg
ICAgICAgICAgICB8IDE1ICsrKysrKysrKysrDQogNSBmaWxlcyBjaGFuZ2VkLCAxMzAgaW5zZXJ0
aW9ucygrKSwgMTIgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYv
ZG1hLWJ1Zi5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYw0KaW5kZXggZGYyMzIzOWIwNGZj
Li5iYzg5YzQ0YmQ5YjkgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jDQor
KysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jDQpAQCAtNDYyLDYgKzQ2MiwyNCBAQCBzdGF0
aWMgc3RydWN0IGZpbGUgKmRtYV9idWZfZ2V0ZmlsZShzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBp
bnQgZmxhZ3MpDQogICogJmRtYV9idWZfb3BzLg0KICAqLw0KIA0KKyNpZmRlZiBDT05GSUdfQ0dS
T1VQX0dQVQ0KK3N0YXRpYyB2b2lkIGRtYV9idWZfc2V0X2dwdWNnKHN0cnVjdCBkbWFfYnVmICpk
bWFidWYsIGNvbnN0IHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvICpleHApDQorew0KKwlkbWFi
dWYtPmdwdWNnID0gZXhwLT5ncHVjZzsNCisJZG1hYnVmLT5ncHVjZ19idWNrZXQgPSBleHAtPmdw
dWNnX2J1Y2tldDsNCit9DQorDQordm9pZCBkbWFfYnVmX2V4cF9pbmZvX3NldF9ncHVjZyhzdHJ1
Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwX2luZm8sDQorCQkJCXN0cnVjdCBncHVjZyAqZ3B1
Y2csDQorCQkJCXN0cnVjdCBncHVjZ19idWNrZXQgKmdwdWNnX2J1Y2tldCkNCit7DQorCWV4cF9p
bmZvLT5ncHVjZyA9IGdwdWNnOw0KKwlleHBfaW5mby0+Z3B1Y2dfYnVja2V0ID0gZ3B1Y2dfYnVj
a2V0Ow0KK30NCisjZWxzZQ0KK3N0YXRpYyB2b2lkIGRtYV9idWZfc2V0X2dwdWNnKHN0cnVjdCBk
bWFfYnVmICpkbWFidWYsIHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvICpleHApIHt9DQorI2Vu
ZGlmDQorDQogLyoqDQogICogZG1hX2J1Zl9leHBvcnQgLSBDcmVhdGVzIGEgbmV3IGRtYV9idWYs
IGFuZCBhc3NvY2lhdGVzIGFuIGFub24gZmlsZQ0KICAqIHdpdGggdGhpcyBidWZmZXIsIHNvIGl0
IGNhbiBiZSBleHBvcnRlZC4NCkBAIC01MjcsNiArNTQ1LDcgQEAgc3RydWN0IGRtYV9idWYgKmRt
YV9idWZfZXhwb3J0KGNvbnN0IHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvICpleHBfaW5mbykN
CiAJaW5pdF93YWl0cXVldWVfaGVhZCgmZG1hYnVmLT5wb2xsKTsNCiAJZG1hYnVmLT5jYl9pbi5w
b2xsID0gZG1hYnVmLT5jYl9vdXQucG9sbCA9ICZkbWFidWYtPnBvbGw7DQogCWRtYWJ1Zi0+Y2Jf
aW4uYWN0aXZlID0gZG1hYnVmLT5jYl9vdXQuYWN0aXZlID0gMDsNCisJZG1hX2J1Zl9zZXRfZ3B1
Y2coZG1hYnVmLCBleHBfaW5mbyk7DQogDQogCWlmICghcmVzdikgew0KIAkJcmVzdiA9IChzdHJ1
Y3QgZG1hX3Jlc3YgKikmZG1hYnVmWzFdOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9k
bWEtaGVhcC5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1oZWFwLmMNCmluZGV4IDhmNTg0OGFhMTQ0
Zi4uYjgxMDE1NTQ4MzE0IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9kbWEtYnVmL2RtYS1oZWFwLmMN
CisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtaGVhcC5jDQpAQCAtNywxMCArNywxMiBAQA0KICAq
Lw0KIA0KICNpbmNsdWRlIDxsaW51eC9jZGV2Lmg+DQorI2luY2x1ZGUgPGxpbnV4L2Nncm91cF9n
cHUuaD4NCiAjaW5jbHVkZSA8bGludXgvZGVidWdmcy5oPg0KICNpbmNsdWRlIDxsaW51eC9kZXZp
Y2UuaD4NCiAjaW5jbHVkZSA8bGludXgvZG1hLWJ1Zi5oPg0KICNpbmNsdWRlIDxsaW51eC9lcnIu
aD4NCisjaW5jbHVkZSA8bGludXgva2NvbmZpZy5oPg0KICNpbmNsdWRlIDxsaW51eC94YXJyYXku
aD4NCiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPg0KICNpbmNsdWRlIDxsaW51eC9zbGFiLmg+DQpA
QCAtMjEsNiArMjMsNyBAQA0KICNpbmNsdWRlIDx1YXBpL2xpbnV4L2RtYS1oZWFwLmg+DQogDQog
I2RlZmluZSBERVZOQU1FICJkbWFfaGVhcCINCisjZGVmaW5lIEhFQVBfTkFNRV9TVUZGSVggIi1o
ZWFwIg0KIA0KICNkZWZpbmUgTlVNX0hFQVBfTUlOT1JTIDEyOA0KIA0KQEAgLTMxLDYgKzM0LDcg
QEANCiAgKiBAaGVhcF9kZXZ0CQloZWFwIGRldmljZSBub2RlDQogICogQGxpc3QJCWxpc3QgaGVh
ZCBjb25uZWN0aW5nIHRvIGxpc3Qgb2YgaGVhcHMNCiAgKiBAaGVhcF9jZGV2CQloZWFwIGNoYXIg
ZGV2aWNlDQorICogQGdwdWNnX2J1Y2tldAlncHUgY2dyb3VwIGJ1Y2tldCBmb3IgbWVtb3J5IGFj
Y291bnRpbmcNCiAgKg0KICAqIFJlcHJlc2VudHMgYSBoZWFwIG9mIG1lbW9yeSBmcm9tIHdoaWNo
IGJ1ZmZlcnMgY2FuIGJlIG1hZGUuDQogICovDQpAQCAtNDEsNiArNDUsOSBAQCBzdHJ1Y3QgZG1h
X2hlYXAgew0KIAlkZXZfdCBoZWFwX2RldnQ7DQogCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsNCiAJ
c3RydWN0IGNkZXYgaGVhcF9jZGV2Ow0KKyNpZmRlZiBDT05GSUdfQ0dST1VQX0dQVQ0KKwlzdHJ1
Y3QgZ3B1Y2dfYnVja2V0IGdwdWNnX2J1Y2tldDsNCisjZW5kaWYNCiB9Ow0KIA0KIHN0YXRpYyBM
SVNUX0hFQUQoaGVhcF9saXN0KTsNCkBAIC0yMTYsNiArMjIzLDE5IEBAIGNvbnN0IGNoYXIgKmRt
YV9oZWFwX2dldF9uYW1lKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCkNCiAJcmV0dXJuIGhlYXAtPm5h
bWU7DQogfQ0KIA0KKy8qKg0KKyAqIGRtYV9oZWFwX2dldF9ncHVjZ19idWNrZXQoKSAtIGdldCBz
dHJ1Y3QgZ3B1Y2dfYnVja2V0IGZvciB0aGUgaGVhcC4NCisgKiBAaGVhcDogRE1BLUhlYXAgdG8g
Z2V0IHRoZSBncHVjZ19idWNrZXQgc3RydWN0IGZvci4NCisgKg0KKyAqIFJldHVybnM6DQorICog
VGhlIGdwdWNnX2J1Y2tldCBzdHJ1Y3QgZm9yIHRoZSBoZWFwLiBOVUxMIGlmIHRoZSBHUFUgY2dy
b3VwIGNvbnRyb2xsZXIgaXMNCisgKiBub3QgZW5hYmxlZC4NCisgKi8NCitzdHJ1Y3QgZ3B1Y2df
YnVja2V0ICpkbWFfaGVhcF9nZXRfZ3B1Y2dfYnVja2V0KHN0cnVjdCBkbWFfaGVhcCAqaGVhcCkN
Cit7DQorCXJldHVybiAmaGVhcC0+Z3B1Y2dfYnVja2V0Ow0KK30NCisNCiBzdHJ1Y3QgZG1hX2hl
YXAgKmRtYV9oZWFwX2FkZChjb25zdCBzdHJ1Y3QgZG1hX2hlYXBfZXhwb3J0X2luZm8gKmV4cF9p
bmZvKQ0KIHsNCiAJc3RydWN0IGRtYV9oZWFwICpoZWFwLCAqaCwgKmVycl9yZXQ7DQpAQCAtMjI4
LDYgKzI0OCwxMiBAQCBzdHJ1Y3QgZG1hX2hlYXAgKmRtYV9oZWFwX2FkZChjb25zdCBzdHJ1Y3Qg
ZG1hX2hlYXBfZXhwb3J0X2luZm8gKmV4cF9pbmZvKQ0KIAkJcmV0dXJuIEVSUl9QVFIoLUVJTlZB
TCk7DQogCX0NCiANCisJaWYgKElTX0VOQUJMRUQoQ09ORklHX0NHUk9VUF9HUFUpICYmIHN0cmxl
bihleHBfaW5mby0+bmFtZSkgKyBzdHJsZW4oSEVBUF9OQU1FX1NVRkZJWCkgPj0NCisJCUdQVUNH
X0JVQ0tFVF9OQU1FX01BWF9MRU4pIHsNCisJCXByX2VycigiZG1hX2hlYXA6IE5hbWUgaXMgdG9v
IGxvbmcgZm9yIEdQVSBjZ3JvdXBcbiIpOw0KKwkJcmV0dXJuIEVSUl9QVFIoLUVOQU1FVE9PTE9O
Ryk7DQorCX0NCisNCiAJaWYgKCFleHBfaW5mby0+b3BzIHx8ICFleHBfaW5mby0+b3BzLT5hbGxv
Y2F0ZSkgew0KIAkJcHJfZXJyKCJkbWFfaGVhcDogQ2Fubm90IGFkZCBoZWFwIHdpdGggaW52YWxp
ZCBvcHMgc3RydWN0XG4iKTsNCiAJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOw0KQEAgLTI1Myw2
ICsyNzksMTkgQEAgc3RydWN0IGRtYV9oZWFwICpkbWFfaGVhcF9hZGQoY29uc3Qgc3RydWN0IGRt
YV9oZWFwX2V4cG9ydF9pbmZvICpleHBfaW5mbykNCiAJaGVhcC0+b3BzID0gZXhwX2luZm8tPm9w
czsNCiAJaGVhcC0+cHJpdiA9IGV4cF9pbmZvLT5wcml2Ow0KIA0KKwlpZiAoSVNfRU5BQkxFRChD
T05GSUdfQ0dST1VQX0dQVSkpIHsNCisJCWNoYXIgZ3B1Y2dfYnVja2V0X25hbWVbR1BVQ0dfQlVD
S0VUX05BTUVfTUFYX0xFTl07DQorDQorCQlzbnByaW50ZihncHVjZ19idWNrZXRfbmFtZSwgc2l6
ZW9mKGdwdWNnX2J1Y2tldF9uYW1lKSwgIiVzJXMiLA0KKwkJCSBleHBfaW5mby0+bmFtZSwgSEVB
UF9OQU1FX1NVRkZJWCk7DQorDQorCQlyZXQgPSBncHVjZ19yZWdpc3Rlcl9idWNrZXQoZG1hX2hl
YXBfZ2V0X2dwdWNnX2J1Y2tldChoZWFwKSwgZ3B1Y2dfYnVja2V0X25hbWUpOw0KKwkJaWYgKHJl
dCA8IDApIHsNCisJCQllcnJfcmV0ID0gRVJSX1BUUihyZXQpOw0KKwkJCWdvdG8gZXJyMDsNCisJ
CX0NCisJfQ0KKw0KIAkvKiBGaW5kIHVudXNlZCBtaW5vciBudW1iZXIgKi8NCiAJcmV0ID0geGFf
YWxsb2MoJmRtYV9oZWFwX21pbm9ycywgJm1pbm9yLCBoZWFwLA0KIAkJICAgICAgIFhBX0xJTUlU
KDAsIE5VTV9IRUFQX01JTk9SUyAtIDEpLCBHRlBfS0VSTkVMKTsNCmRpZmYgLS1naXQgYS9kcml2
ZXJzL2RtYS1idWYvaGVhcHMvc3lzdGVtX2hlYXAuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9z
eXN0ZW1faGVhcC5jDQppbmRleCBmY2Y4MzZiYTljMWYuLjI3ZjY4NmZhZWYwMCAxMDA2NDQNCi0t
LSBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVhcC5jDQorKysgYi9kcml2ZXJzL2Rt
YS1idWYvaGVhcHMvc3lzdGVtX2hlYXAuYw0KQEAgLTI5Nyw2ICsyOTcsMTEgQEAgc3RhdGljIHZv
aWQgc3lzdGVtX2hlYXBfZG1hX2J1Zl9yZWxlYXNlKHN0cnVjdCBkbWFfYnVmICpkbWFidWYpDQog
CX0NCiAJc2dfZnJlZV90YWJsZSh0YWJsZSk7DQogCWtmcmVlKGJ1ZmZlcik7DQorDQorCWlmIChk
bWFidWYtPmdwdWNnICYmIGRtYWJ1Zi0+Z3B1Y2dfYnVja2V0KSB7DQorCQlncHVjZ191bmNoYXJn
ZShkbWFidWYtPmdwdWNnLCBkbWFidWYtPmdwdWNnX2J1Y2tldCwgZG1hYnVmLT5zaXplKTsNCisJ
CWdwdWNnX3B1dChkbWFidWYtPmdwdWNnKTsNCisJfQ0KIH0NCiANCiBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRtYV9idWZfb3BzIHN5c3RlbV9oZWFwX2J1Zl9vcHMgPSB7DQpAQCAtMzQ2LDExICszNTEs
MjEgQEAgc3RhdGljIHN0cnVjdCBkbWFfYnVmICpzeXN0ZW1faGVhcF9hbGxvY2F0ZShzdHJ1Y3Qg
ZG1hX2hlYXAgKmhlYXAsDQogCXN0cnVjdCBzY2F0dGVybGlzdCAqc2c7DQogCXN0cnVjdCBsaXN0
X2hlYWQgcGFnZXM7DQogCXN0cnVjdCBwYWdlICpwYWdlLCAqdG1wX3BhZ2U7DQotCWludCBpLCBy
ZXQgPSAtRU5PTUVNOw0KKwlzdHJ1Y3QgZ3B1Y2cgKmdwdWNnOw0KKwlzdHJ1Y3QgZ3B1Y2dfYnVj
a2V0ICpncHVjZ19idWNrZXQ7DQorCWludCBpLCByZXQ7DQorDQorCWdwdWNnID0gZ3B1Y2dfZ2V0
KGN1cnJlbnQpOw0KKwlncHVjZ19idWNrZXQgPSBkbWFfaGVhcF9nZXRfZ3B1Y2dfYnVja2V0KGhl
YXApOw0KKwlyZXQgPSBncHVjZ19jaGFyZ2UoZ3B1Y2csIGdwdWNnX2J1Y2tldCwgbGVuKTsNCisJ
aWYgKHJldCkNCisJCWdvdG8gcHV0X2dwdWNnOw0KIA0KIAlidWZmZXIgPSBremFsbG9jKHNpemVv
ZigqYnVmZmVyKSwgR0ZQX0tFUk5FTCk7DQotCWlmICghYnVmZmVyKQ0KLQkJcmV0dXJuIEVSUl9Q
VFIoLUVOT01FTSk7DQorCWlmICghYnVmZmVyKSB7DQorCQlyZXQgPSAtRU5PTUVNOw0KKwkJZ290
byB1bmNoYXJnZV9ncHVjZzsNCisJfQ0KIA0KIAlJTklUX0xJU1RfSEVBRCgmYnVmZmVyLT5hdHRh
Y2htZW50cyk7DQogCW11dGV4X2luaXQoJmJ1ZmZlci0+bG9jayk7DQpAQCAtMzk2LDYgKzQxMSw4
IEBAIHN0YXRpYyBzdHJ1Y3QgZG1hX2J1ZiAqc3lzdGVtX2hlYXBfYWxsb2NhdGUoc3RydWN0IGRt
YV9oZWFwICpoZWFwLA0KIAlleHBfaW5mby5zaXplID0gYnVmZmVyLT5sZW47DQogCWV4cF9pbmZv
LmZsYWdzID0gZmRfZmxhZ3M7DQogCWV4cF9pbmZvLnByaXYgPSBidWZmZXI7DQorCWRtYV9idWZf
ZXhwX2luZm9fc2V0X2dwdWNnKCZleHBfaW5mbywgZ3B1Y2csIGdwdWNnX2J1Y2tldCk7DQorDQog
CWRtYWJ1ZiA9IGRtYV9idWZfZXhwb3J0KCZleHBfaW5mbyk7DQogCWlmIChJU19FUlIoZG1hYnVm
KSkgew0KIAkJcmV0ID0gUFRSX0VSUihkbWFidWYpOw0KQEAgLTQxNCw3ICs0MzEsMTAgQEAgc3Rh
dGljIHN0cnVjdCBkbWFfYnVmICpzeXN0ZW1faGVhcF9hbGxvY2F0ZShzdHJ1Y3QgZG1hX2hlYXAg
KmhlYXAsDQogCWxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZShwYWdlLCB0bXBfcGFnZSwgJnBhZ2Vz
LCBscnUpDQogCQlfX2ZyZWVfcGFnZXMocGFnZSwgY29tcG91bmRfb3JkZXIocGFnZSkpOw0KIAlr
ZnJlZShidWZmZXIpOw0KLQ0KK3VuY2hhcmdlX2dwdWNnOg0KKwlncHVjZ191bmNoYXJnZShncHVj
ZywgZ3B1Y2dfYnVja2V0LCBsZW4pOw0KK3B1dF9ncHVjZzoNCisJZ3B1Y2dfcHV0KGdwdWNnKTsN
CiAJcmV0dXJuIEVSUl9QVFIocmV0KTsNCiB9DQogDQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51
eC9kbWEtYnVmLmggYi9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaA0KaW5kZXggMjA5Nzc2MGU4ZTk1
Li44ZTdjNTVjODMwYjMgMTAwNjQ0DQotLS0gYS9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaA0KKysr
IGIvaW5jbHVkZS9saW51eC9kbWEtYnVmLmgNCkBAIC0xMyw2ICsxMyw3IEBADQogI2lmbmRlZiBf
X0RNQV9CVUZfSF9fDQogI2RlZmluZSBfX0RNQV9CVUZfSF9fDQogDQorI2luY2x1ZGUgPGxpbnV4
L2Nncm91cF9ncHUuaD4NCiAjaW5jbHVkZSA8bGludXgvaW9zeXMtbWFwLmg+DQogI2luY2x1ZGUg
PGxpbnV4L2ZpbGUuaD4NCiAjaW5jbHVkZSA8bGludXgvZXJyLmg+DQpAQCAtMzAzLDcgKzMwNCw3
IEBAIHN0cnVjdCBkbWFfYnVmIHsNCiAJLyoqDQogCSAqIEBzaXplOg0KIAkgKg0KLQkgKiBTaXpl
IG9mIHRoZSBidWZmZXI7IGludmFyaWFudCBvdmVyIHRoZSBsaWZldGltZSBvZiB0aGUgYnVmZmVy
Lg0KKwkgKiBTaXplIG9mIHRoZSBidWZmZXIgaW4gYnl0ZXM7IGludmFyaWFudCBvdmVyIHRoZSBs
aWZldGltZSBvZiB0aGUgYnVmZmVyLg0KIAkgKi8NCiAJc2l6ZV90IHNpemU7DQogDQpAQCAtNDUz
LDYgKzQ1NCwxNCBAQCBzdHJ1Y3QgZG1hX2J1ZiB7DQogCQlzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVm
Ow0KIAl9ICpzeXNmc19lbnRyeTsNCiAjZW5kaWYNCisNCisjaWZkZWYgQ09ORklHX0NHUk9VUF9H
UFUNCisJLyoqIEBncHVjZzogUG9pbnRlciB0byB0aGUgR1BVIGNncm91cCB0aGlzIGJ1ZmZlciBj
dXJyZW50bHkgYmVsb25ncyB0by4gKi8NCisJc3RydWN0IGdwdWNnICpncHVjZzsNCisNCisJLyog
QGdwdWNnX2J1Y2tldDogUG9pbnRlciB0byB0aGUgR1BVIGNncm91cCBidWNrZXQgd2hlbmNlIHRo
aXMgYnVmZmVyIG9yaWdpbmF0ZXMuICovDQorCXN0cnVjdCBncHVjZ19idWNrZXQgKmdwdWNnX2J1
Y2tldDsNCisjZW5kaWYNCiB9Ow0KIA0KIC8qKg0KQEAgLTUyNiwxMyArNTM1LDE1IEBAIHN0cnVj
dCBkbWFfYnVmX2F0dGFjaG1lbnQgew0KIA0KIC8qKg0KICAqIHN0cnVjdCBkbWFfYnVmX2V4cG9y
dF9pbmZvIC0gaG9sZHMgaW5mb3JtYXRpb24gbmVlZGVkIHRvIGV4cG9ydCBhIGRtYV9idWYNCi0g
KiBAZXhwX25hbWU6CW5hbWUgb2YgdGhlIGV4cG9ydGVyIC0gdXNlZnVsIGZvciBkZWJ1Z2dpbmcu
DQotICogQG93bmVyOglwb2ludGVyIHRvIGV4cG9ydGVyIG1vZHVsZSAtIHVzZWQgZm9yIHJlZmNv
dW50aW5nIGtlcm5lbCBtb2R1bGUNCi0gKiBAb3BzOglBdHRhY2ggYWxsb2NhdG9yLWRlZmluZWQg
ZG1hIGJ1ZiBvcHMgdG8gdGhlIG5ldyBidWZmZXINCi0gKiBAc2l6ZToJU2l6ZSBvZiB0aGUgYnVm
ZmVyIC0gaW52YXJpYW50IG92ZXIgdGhlIGxpZmV0aW1lIG9mIHRoZSBidWZmZXINCi0gKiBAZmxh
Z3M6CW1vZGUgZmxhZ3MgZm9yIHRoZSBmaWxlDQotICogQHJlc3Y6CXJlc2VydmF0aW9uLW9iamVj
dCwgTlVMTCB0byBhbGxvY2F0ZSBkZWZhdWx0IG9uZQ0KLSAqIEBwcml2OglBdHRhY2ggcHJpdmF0
ZSBkYXRhIG9mIGFsbG9jYXRvciB0byB0aGlzIGJ1ZmZlcg0KKyAqIEBleHBfbmFtZToJCW5hbWUg
b2YgdGhlIGV4cG9ydGVyIC0gdXNlZnVsIGZvciBkZWJ1Z2dpbmcuDQorICogQG93bmVyOgkJcG9p
bnRlciB0byBleHBvcnRlciBtb2R1bGUgLSB1c2VkIGZvciByZWZjb3VudGluZyBrZXJuZWwgbW9k
dWxlDQorICogQG9wczoJCUF0dGFjaCBhbGxvY2F0b3ItZGVmaW5lZCBkbWEgYnVmIG9wcyB0byB0
aGUgbmV3IGJ1ZmZlcg0KKyAqIEBzaXplOgkJU2l6ZSBvZiB0aGUgYnVmZmVyIGluIGJ5dGVzIC0g
aW52YXJpYW50IG92ZXIgdGhlIGxpZmV0aW1lIG9mIHRoZSBidWZmZXINCisgKiBAZmxhZ3M6CQlt
b2RlIGZsYWdzIGZvciB0aGUgZmlsZQ0KKyAqIEByZXN2OgkJcmVzZXJ2YXRpb24tb2JqZWN0LCBO
VUxMIHRvIGFsbG9jYXRlIGRlZmF1bHQgb25lDQorICogQHByaXY6CQlBdHRhY2ggcHJpdmF0ZSBk
YXRhIG9mIGFsbG9jYXRvciB0byB0aGlzIGJ1ZmZlcg0KKyAqIEBncHVjZzoJCVBvaW50ZXIgdG8g
R1BVIGNncm91cCB0aGlzIGJ1ZmZlciBpcyBjaGFyZ2VkIHRvLCBvciBOVUxMIGlmIG5vdCBjaGFy
Z2VkDQorICogQGdwdWNnX2J1Y2tldDoJUG9pbnRlciB0byBHUFUgY2dyb3VwIGJ1Y2tldCB0aGlz
IGJ1ZmZlciBjb21lcyBmcm9tLCBvciBOVUxMIGlmIG5vdCBjaGFyZ2VkDQogICoNCiAgKiBUaGlz
IHN0cnVjdHVyZSBob2xkcyB0aGUgaW5mb3JtYXRpb24gcmVxdWlyZWQgdG8gZXhwb3J0IHRoZSBi
dWZmZXIuIFVzZWQNCiAgKiB3aXRoIGRtYV9idWZfZXhwb3J0KCkgb25seS4NCkBAIC01NDUsNiAr
NTU2LDEwIEBAIHN0cnVjdCBkbWFfYnVmX2V4cG9ydF9pbmZvIHsNCiAJaW50IGZsYWdzOw0KIAlz
dHJ1Y3QgZG1hX3Jlc3YgKnJlc3Y7DQogCXZvaWQgKnByaXY7DQorI2lmZGVmIENPTkZJR19DR1JP
VVBfR1BVDQorCXN0cnVjdCBncHVjZyAqZ3B1Y2c7DQorCXN0cnVjdCBncHVjZ19idWNrZXQgKmdw
dWNnX2J1Y2tldDsNCisjZW5kaWYNCiB9Ow0KIA0KIC8qKg0KQEAgLTYzMCw0ICs2NDUsMTQgQEAg
aW50IGRtYV9idWZfbW1hcChzdHJ1Y3QgZG1hX2J1ZiAqLCBzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3Qg
KiwNCiAJCSB1bnNpZ25lZCBsb25nKTsNCiBpbnQgZG1hX2J1Zl92bWFwKHN0cnVjdCBkbWFfYnVm
ICpkbWFidWYsIHN0cnVjdCBpb3N5c19tYXAgKm1hcCk7DQogdm9pZCBkbWFfYnVmX3Z1bm1hcChz
dHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgaW9zeXNfbWFwICptYXApOw0KKw0KKyNpZmRl
ZiBDT05GSUdfQ0dST1VQX0dQVQ0KK3ZvaWQgZG1hX2J1Zl9leHBfaW5mb19zZXRfZ3B1Y2coc3Ry
dWN0IGRtYV9idWZfZXhwb3J0X2luZm8gKmV4cF9pbmZvLA0KKwkJCQlzdHJ1Y3QgZ3B1Y2cgKmdw
dWNnLA0KKwkJCQlzdHJ1Y3QgZ3B1Y2dfYnVja2V0ICpncHVjZ19idWNrZXQpOw0KKyNlbHNlLyog
Q09ORklHX0NHUk9VUF9HUFUgKi8NCitzdGF0aWMgaW5saW5lIHZvaWQgZG1hX2J1Zl9leHBfaW5m
b19zZXRfZ3B1Y2coc3RydWN0IGRtYV9idWZfZXhwb3J0X2luZm8gKmV4cF9pbmZvLA0KKwkJCQkJ
ICAgICAgc3RydWN0IGdwdWNnICpncHVjZywNCisJCQkJCSAgICAgIHN0cnVjdCBncHVjZ19idWNr
ZXQgKmdwdWNnX2J1Y2tldCkge30NCisjZW5kaWYgLyogQ09ORklHX0NHUk9VUF9HUFUgKi8NCiAj
ZW5kaWYgLyogX19ETUFfQlVGX0hfXyAqLw0KZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvZG1h
LWhlYXAuaCBiL2luY2x1ZGUvbGludXgvZG1hLWhlYXAuaA0KaW5kZXggMGMwNTU2MWNhZDZlLi42
MzIxZTc2MzY1MzggMTAwNjQ0DQotLS0gYS9pbmNsdWRlL2xpbnV4L2RtYS1oZWFwLmgNCisrKyBi
L2luY2x1ZGUvbGludXgvZG1hLWhlYXAuaA0KQEAgLTEwLDYgKzEwLDcgQEANCiAjZGVmaW5lIF9E
TUFfSEVBUFNfSA0KIA0KICNpbmNsdWRlIDxsaW51eC9jZGV2Lmg+DQorI2luY2x1ZGUgPGxpbnV4
L2Nncm91cF9ncHUuaD4NCiAjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4NCiANCiBzdHJ1Y3QgZG1h
X2hlYXA7DQpAQCAtNTksNiArNjAsMjAgQEAgdm9pZCAqZG1hX2hlYXBfZ2V0X2RydmRhdGEoc3Ry
dWN0IGRtYV9oZWFwICpoZWFwKTsNCiAgKi8NCiBjb25zdCBjaGFyICpkbWFfaGVhcF9nZXRfbmFt
ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXApOw0KIA0KKyNpZmRlZiBDT05GSUdfQ0dST1VQX0dQVQ0K
Ky8qKg0KKyAqIGRtYV9oZWFwX2dldF9ncHVjZ19idWNrZXQoKSAtIGdldCBhIHBvaW50ZXIgdG8g
dGhlIHN0cnVjdCBncHVjZ19idWNrZXQgZm9yIHRoZSBoZWFwLg0KKyAqIEBoZWFwOiBETUEtSGVh
cCB0byByZXRyaWV2ZSBncHVjZ19idWNrZXQgZm9yDQorICoNCisgKiBSZXR1cm5zOg0KKyAqIFRo
ZSBncHVjZ19idWNrZXQgc3RydWN0IGZvciB0aGUgaGVhcC4NCisgKi8NCitzdHJ1Y3QgZ3B1Y2df
YnVja2V0ICpkbWFfaGVhcF9nZXRfZ3B1Y2dfYnVja2V0KHN0cnVjdCBkbWFfaGVhcCAqaGVhcCk7
DQorI2Vsc2UgLyogQ09ORklHX0NHUk9VUF9HUFUgKi8NCitzdGF0aWMgaW5saW5lIHN0cnVjdCBn
cHVjZ19idWNrZXQgKmRtYV9oZWFwX2dldF9ncHVjZ19idWNrZXQoc3RydWN0IGRtYV9oZWFwICpo
ZWFwKQ0KK3sgcmV0dXJuIE5VTEw7IH0NCisjZW5kaWYgLyogQ09ORklHX0NHUk9VUF9HUFUgKi8N
CisNCiAvKioNCiAgKiBkbWFfaGVhcF9hZGQgLSBhZGRzIGEgaGVhcCB0byBkbWFidWYgaGVhcHMN
CiAgKiBAZXhwX2luZm86CQlpbmZvcm1hdGlvbiBuZWVkZWQgdG8gcmVnaXN0ZXIgdGhpcyBoZWFw
DQotLSANCjIuMzYuMC5yYzAuNDcwLmdkMzYxMzk3ZjBkLWdvb2cNCg0KX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxp
c3QgLS0gbGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQg
YW4gZW1haWwgdG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
