Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 6E82D70A774
	for <lists+linaro-mm-sig@lfdr.de>; Sat, 20 May 2023 12:58:48 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 7DBE0443D4
	for <lists+linaro-mm-sig@lfdr.de>; Sat, 20 May 2023 10:58:47 +0000 (UTC)
Received: from 189.cn (ptr.189.cn [183.61.185.104])
	by lists.linaro.org (Postfix) with ESMTP id E5ADA43D1C
	for <linaro-mm-sig@lists.linaro.org>; Sat, 20 May 2023 10:57:59 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=none;
	spf=pass (lists.linaro.org: domain of 15330273260@189.cn designates 183.61.185.104 as permitted sender) smtp.mailfrom=15330273260@189.cn;
	dmarc=none
HMM_SOURCE_IP: 10.64.8.41:56618.881688069
HMM_ATTACHE_NUM: 0000
HMM_SOURCE_TYPE: SMTP
Received: from clientip-114.242.206.180 (unknown [10.64.8.41])
	by 189.cn (HERMES) with SMTP id 1993B1002AA;
	Sat, 20 May 2023 18:57:50 +0800 (CST)
Received: from  ([114.242.206.180])
	by gateway-151646-dep-75648544bd-xwndj with ESMTP id b8c2b84acc094695b1d4a28b3875bb8c for maarten.lankhorst@linux.intel.com;
	Sat, 20 May 2023 18:57:54 CST
X-Transaction-ID: b8c2b84acc094695b1d4a28b3875bb8c
X-Real-From: 15330273260@189.cn
X-Receive-IP: 114.242.206.180
X-MEDUSA-Status: 0
Sender: 15330273260@189.cn
From: Sui Jingfeng <15330273260@189.cn>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
	Maxime Ripard <mripard@kernel.org>,
	Thomas Zimmermann <tzimmermann@suse.de>,
	David Airlie <airlied@gmail.com>,
	Daniel Vetter <daniel@ffwll.ch>,
	Sui Jingfeng <suijingfeng@loongson.cn>,
	Li Yi <liyi@loongson.cn>,
	suijingfeng <15330273260@189.cn>,
	Sumit Semwal <sumit.semwal@linaro.org>,
	Christian Koenig <christian.koenig@amd.com>,
	Emil Velikov <emil.l.velikov@gmail.com>
Date: Sat, 20 May 2023 18:57:17 +0800
Message-Id: <20230520105718.325819-2-15330273260@189.cn>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230520105718.325819-1-15330273260@189.cn>
References: <20230520105718.325819-1-15330273260@189.cn>
MIME-Version: 1.0
X-Spamd-Result: default: False [-1.20 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	MID_CONTAINS_FROM(1.00)[];
	RCVD_IN_DNSWL_HI(-0.50)[114.242.206.180:received];
	R_SPF_ALLOW(-0.20)[+ip4:183.61.185.0/24:c];
	MIME_GOOD(-0.10)[text/plain];
	RCVD_NO_TLS_LAST(0.10)[];
	FROM_EQ_ENVFROM(0.00)[];
	ARC_NA(0.00)[];
	FREEMAIL_ENVFROM(0.00)[189.cn];
	R_DKIM_NA(0.00)[];
	MIME_TRACE(0.00)[0:+];
	ASN(0.00)[asn:4134, ipnet:183.0.0.0/10, country:CN];
	FREEMAIL_TO(0.00)[linux.intel.com,kernel.org,suse.de,gmail.com,ffwll.ch,loongson.cn,189.cn,linaro.org,amd.com];
	RCPT_COUNT_TWELVE(0.00)[20];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	TO_DN_SOME(0.00)[];
	FROM_HAS_DN(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	FREEMAIL_FROM(0.00)[189.cn];
	DMARC_NA(0.00)[189.cn];
	TAGGED_RCPT(0.00)[renesas];
	RCVD_COUNT_TWO(0.00)[2]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: E5ADA43D1C
X-Spamd-Bar: -
Message-ID-Hash: SMVHHBVXTRRGV7NERKAJ4KITOUZUKH7T
X-Message-ID-Hash: SMVHHBVXTRRGV7NERKAJ4KITOUZUKH7T
X-MailFrom: 15330273260@189.cn
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: Nathan Chancellor <nathan@kernel.org>, linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org, linux-media@vger.kernel.org, linaro-mm-sig@lists.linaro.org, loongson-kernel@lists.loongnix.cn, Liu Peibao <liupeibao@loongson.cn>, Geert Uytterhoeven <geert+renesas@glider.be>, Javier Martinez Canillas <javierm@redhat.com>
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH v14 1/2] drm: add kms driver for loongson display controller
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/SMVHHBVXTRRGV7NERKAJ4KITOUZUKH7T/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

RnJvbTogU3VpIEppbmdmZW5nIDxzdWlqaW5nZmVuZ0Bsb29uZ3Nvbi5jbj4NCg0KTG9vbmdzb24g
ZGlzcGxheSBjb250cm9sbGVyIElQIGhhcyBiZWVuIGludGVncmF0ZWQgaW4gYm90aCBMb29uZ3Nv
biBub3J0aA0KYnJpZGdlIGNoaXBzZXQobHM3YTEwMDAvbHM3YTIwMDApIGFuZCBMb29uZ3NvbiBT
b0NzKGxzMmsxMDAwL2xzMmsyMDAwKSwgaXQNCmhhcyBiZWVuIGV2ZW4gaW5jbHVkZWQgaW4gTG9v
bmdzb24gc2VsZi1tYWRlIEJNQyBwcm9kdWN0cy4NCg0KVGhpcyBkaXNwbGF5IGNvbnRyb2xsZXIg
aXMgYSBQQ0kgZGV2aWNlLiBJdCBoYXMgdHdvIGRpc3BsYXkgcGlwZXMgYW5kIGVhY2gNCmRpc3Bs
YXkgcGlwZSBzdXBwb3J0IGEgcHJpbWFyeSBwbGFuZSBhbmQgYSBjdXJzb3IgcGxhbmUuIEZvciB0
aGUgREMgaW4gdGhlDQpsczdhMTAwMCBhbmQgbHMyazEwMDAsIGVhY2ggZGlzcGxheSBwaXBlIGhh
cyBhIERWTyBvdXRwdXQgaW50ZXJmYWNlIHdoaWNoDQpwcm92aWRlIFJHQjg4OCBzaWduYWxzLCB2
ZXJ0aWNhbCAmIGhvcml6b250YWwgc3luY2hyb25pc2F0aW9ucyBhbmQgcGl4ZWwNCmNsb2NrLiBF
YWNoIENSVEMgaXMgYWJsZSB0byBzdXBwb3J0IDE5MjB4MTA4MEA2MEh6LCB0aGUgbWF4aW11bSBy
ZXNvbHV0aW9uDQpvZiBlYWNoIGRpc3BsYXkgcGlwZSBpcyAyMDQ4eDIwNDggYWNjb3JkaW5nIHRv
IHRoZSBoYXJkd2FyZSBzcGVjLg0KDQpGb3IgdGhlIERDIGluIExTN0EyMDAwLCBlYWNoIGRpc3Bs
YXkgcGlwZSBpcyBlcXVpcHBlZCB3aXRoIGEgYnVpbHQtaW4gSERNSQ0KZW5jb2RlciB3aGljaCBp
cyBjb21wbGlhbnQgd2l0aCB0aGUgSERNSSAxLjQgc3BlY2lmaWNhdGlvbiwgdGh1cyBpdCBzdXBw
b3J0DQozODQweDIxNjBAMzBIei4gVGhlIGZpcnN0IGRpc3BsYXkgcGlwZSBpcyBhbHNvIGVxdWlw
cGVkIHdpdGggYSB0cmFuc3BhcmVudA0KdmdhIGVuY29kZXIgd2hpY2ggaXMgcGFyYWxsZWwgd2l0
aCB0aGUgSERNSSBlbmNvZGVyLiBUaGUgREMgaW4gTFM3QTIwMDAgaXMNCm1vcmUgY29tcGxldGUg
Y29tcGFyZSB3aXRoIHRoZSBvbmUgaW4gb2xkIGNoaXBzLCBiZXNpZGVzIGFib3ZlIGZlYXR1cmUs
IGl0DQpoYXMgdHdvIGhhcmR3YXJlIGN1cnNvcnMsIHR3byBoYXJkd2FyZSB2YmxhbmsgY291bnRl
ciBhbmQgdHdvIHNjYW5vdXQNCnBvc2l0aW9uIHJlY29yZGVycyB1bml0LiBJdCBhbHNvIHN1cHBv
cnQgdGlsZWQgZnJhbWVidWZmZXIgZm9ybWF0IHdoaWNoDQpjYW4gYmUgc2Nhbm91dCB0aGUgdGls
ZWQgZnJhbWVidWZmZXIgcmVuZGVyZWQgYnkgdGhlIExvb25nR1BVIGRpcmVjdGx5Lg0KDQp2MSAt
PiB2MjoNCiAxKSBVc2UgaHBkIHN0YXR1cyByZWcgd2hlbiBwb2xsaW5nIGZvciBsczdhMjAwMA0K
IDIpIEZpeCBhbGwgd2FybmluZ3MgZW1lcmdlZCB3aGVuIGNvbXBpbGUgd2l0aCBXPTENCg0KdjIg
LT4gdjM6DQogMSkgQWRkIENPTVBJTEVfVEVTVCBpbiBLY29uZmlnIGFuZCBtYWtlIHRoZSBkcml2
ZXIgb2ZmIGJ5IGRlZmF1bHQNCiAyKSBBbHBoYWJldGljYWwgc29ydGluZyBoZWFkZXJzIChUaG9t
YXMpDQogMykgVW50YW5nbGUgcmVnaXN0ZXIgYWNjZXNzIGZ1bmN0aW9ucyBhcyBtdWNoIGFzIHBv
c3NpYmxlIChUaG9tYXMpDQogNCkgU3dpdGNoIHRvIFRUTSBiYXNlZCBtZW1vcnkgbWFuYWdlciBh
bmQgcHJlZmVyIGNhY2hlZCBtYXBwaW5nDQogICAgZm9yIExvb25nc29uIFNvQyAoVGhvbWFzKQ0K
IDUpIEFkZCBjaGlwIGlkIGRldGVjdGlvbiBtZXRob2QsIG5vdyBhbGwgbW9kZWxzIGFyZSBkaXN0
aW5ndWlzaGFibGUuDQogNikgUmV2aXNlIGJ1aWx0aW4gSERNSSBwaHkgZHJpdmVyLCBuZWFybHkg
YWxsIG1haW4gc3RyZWFtIG1vZGUNCiAgICBiZWxvdyA0S0AzMEh6IGlzIHRlc3RlZCwgdGhpcyBk
cml2ZXIgc3VwcG9ydGVkIHRoZXNlIG1vZGUgdmVyeQ0KICAgIHdlbGwgaW5jbHVkaW5nIGNsb25l
IGRpc3BsYXkgbW9kZSBhbmQgZXh0ZW5kIGRpc3BsYXkgbW9kZS4NCg0KdjMgLT4gdjQ6DQogMSkg
UXVpY2tseSBmaXggYSBzbWFsbCBtaXN0YWtlLg0KDQp2NCAtPiB2NToNCiAxKSBEcm9wIHBvdGVu
dGlhbCBzdXBwb3J0IGZvciBMb29uZ3NvbiAySyBzZXJpZXMgU29DIHRlbXBvcmFyeSwNCiAgICB0
aGlzIHBhcnQgc2hvdWxkIGJlIHJlc2VuZCB3aXRoIHRoZSBEVCBiaW5kaW5nIHBhdGNoIGluIHRo
ZSBmdXR1cmUuDQogMikgQWRkIHBlciBkaXNwbGF5IHBpcGUgZGVidWdmcyBzdXBwb3J0IHRvIHRo
ZSBidWlsdGluIEhETUkgZW5jb2Rlci4NCiAzKSBSZXdyaXRlIGF0b21pY191cGRhdGUoKSBmb3Ig
aGFyZHdhcmUgY3Vyc29ycyBwbGFuZShUaG9tYXMpDQogNCkgUmV3cml0ZSBlbmNvZGVyIGFuZCBj
b25uZWN0b3IgaW5pdGlhbGl6YXRpb24gcGFydCwgdW50YW5nbGUgaXQNCiAgICBhY2NvcmRpbmcg
dG8gdGhlIGNoaXAoVGhvbWFzKS4NCg0KdjUgLT4gdjY6DQogMSkgUmVtb3ZlIHN0cmF5IGNvZGUg
d2hpY2ggZGlkbid0IGdldCB1c2VkLCBzYXkgbHNkY19vZl9nZXRfcmVzZXJ2ZWRfcmFtDQogMikg
Rml4IGFsbCB0eXBvcyBJIGNvdWxkIGZvdW5kLCBtYWtlIHNlbnRlbmNlcyBhbmQgY29kZSBtb3Jl
IHJlYWRhYmxlDQogMykgVW50YW5nbGUgbHNkY19oZG1pKl9jb25uZWN0b3JfZGV0ZWN0KCkgZnVu
Y3Rpb24gYWNjb3JkaW5nIHRvIHRoZSBwaXBlDQogNCkgQWZ0ZXIgYSBzZXJpb3VzIGNvbnNpZGVy
YXRpb24sIHdlIHJlbmFtZSB0aGlzIGRyaXZlciBhcyBsb29uZ3Nvbi4NCiAgICBCZWNhdXNlIHdl
IGFsc28gaGF2ZSBkcml2ZXJzIHRvd2FyZCB0aGUgTG9vbmdHUFUgSVAgaW4gTFM3QTIwMDAgYW5k
DQogICAgTFMySzIwMDAuIEJlc2lkZXMsIHRoZXJlIGFyZSBhbHNvIGRyaXZlcnMgYWJvdXQgdGhl
IGV4dGVybmFsIGVuY29kZXIsDQogICAgSERNSSBhdWRpbyBkcml2ZXIgYW5kIHZiaW9zIHN1cHBv
cnQgZXRjLiBUaGlzIHBhdGNoIG9ubHkgcHJvdmlkZSBEQw0KICAgIGRyaXZlciBwYXJ0LCBteSB0
ZWFtbWF0ZSBMaSBZaSBiZWxpZXZlIHRoYXQgbG9vbmdzb24gd2lsbCBiZSBtb3JlDQogICAgc3Vp
dGFibGUgZm9yIGxvb25nc29uIGdyYXBoaWNzIHRoYW4gbHNkYyBpbiB0aGUgbG9uZyBydW4uDQoN
CiAgICBsb29uZ3Nvbi5rbyA9IExTREMgKyBMb29uZ0dQVSArIGVuY29kZXJzIGRyaXZlciArIHZi
aW9zL0RUIC4uLg0KDQp2NiAtPiB2NzoNCiAxKSBBZGQgcHJpbWUgc3VwcG9ydCwgc2VsZi1zaGFy
aW5nIGlzIHdvcmtzLiBzaGFyaW5nIGJ1ZmZlciB3aXRoIGV0bmF2aXYNCiAgICBpcyBhbHNvIHRl
c3RlZCwgYW5kIGl0cyB3b3JrcyB3aXRoIGxpbWl0YXRpb24uDQogMikgSW1wbGVtZW50IGJ1ZmZl
ciBvYmplY3RzIHRyYWNraW5nIHdpdGggbGlzdF9oZWFkLg0KIDMpIFMzKHNsZWVwIHRvIFJBTSkg
aXMgdGVzdGVkIG9uIGxzM2E1MDAwK2xzN2EyMDAwIGV2YiBhbmQgaXQgd29ya3MuDQogNCkgUmV3
cml0ZSBsc2RjX2JvX21vdmUsIHNpbmNlIHR0bSBjb3JlIHN0b3AgYWxsb2NhdGluZyByZXNvdXJj
ZXMNCiAgICBkdXJpbmcgQk8gY3JlYXRpb24uIFBhdGNoIFYxIH4gVjYgb2YgdGhpcyBzZXJpZXMg
bm8gbG9uZ2VyIHdvcmtzDQogICAgb24gbGF0ZXN0IGtlcm5lbC4gVGh1cywgd2Ugc2VuZCBWNyB0
byByZXZpdmFsIHRoZW0uDQoNCnY3IC0+IHY4Og0KIDEpIFplcm8gYSBjb21waWxlIHdhcm5uaW5n
cyBvbiAzMi1iaXQgcGxhdGZvcm0sIGNvbXBpbGUgd2l0aCBXPTENCiAyKSBSZXZpc2UgbHNkY19i
b19ncHVfb2Zmc2V0KCkgYW5kIG1pbm9yIGNsZWFudXANCiAzKSBQYWdlZmxpcCB0ZXN0ZWQgb24g
dGhlIHZpcnR1YWwgdGVybWluYWwgd2l0aCBmb2xsb3dpbmcgY29tbWFuZHMNCg0KICAgIG1vZGV0
ZXN0IC1NIGxvb25nc29uIC1zIDMyOjE5MjB4MTA4MCAtdg0KICAgIG1vZGV0ZXN0IC1NIGxvb25n
c29uIC1zIDM0OjE5MjB4MTA4MCAtdiAtRiB0aWxlcw0KDQogICBJdCB3b3JrcyBsaWtlIGEgY2hh
cm0sIHdoZW4gcnVubmluZyBwYWdlZmxpcCB0ZXN0IHdpdGggZHVhbCBzY3Jlbm4NCiAgIGNvbmZp
Z3VyYXRpb24sIGFub3RoZXIgdHdvIGFkZGl0aW9uYWwgYm8gY3JlYXRlZCBieSB0aGUgbW9kZXRl
c3QNCiAgIGVtZXJnZWQsIFZSQU0gdXNhZ2UgdXAgdG8gNDArTUIsIHdlbGwgd2UgaGF2ZSBhdCBs
ZWFzdCA2NE1CLCBzdGlsbA0KICAgZW5vdWdoLg0KDQogICAjIGNhdCBib3MNCg0KICAgICAgIGJv
WzAwMDBdOiBzaXplOiAgICAgODExMmtCIFZSQU0NCiAgICAgICBib1swMDAxXTogc2l6ZTogICAg
ICAgMTZrQiBWUkFNDQogICAgICAgYm9bMDAwMl06IHNpemU6ICAgICAgIDE2a0IgVlJBTQ0KICAg
ICAgIGJvWzAwMDNdOiBzaXplOiAgICAxNjIwOGtCIFZSQU0NCiAgICAgICBib1swMDA0XTogc2l6
ZTogICAgIDgxMTJrQiBWUkFNDQogICAgICAgYm9bMDAwNV06IHNpemU6ICAgICA4MTEya0IgVlJB
TQ0KDQp2OCAtPiB2OToNCiAxKSBTZWxlY3QgSTJDIGFuZCBJMkNfQUxHT0JJVCBpbiBLY29uZmln
IGFuZCBzaG91bGQgZGVwZW5kIG9uIE1NVS4NCiAyKSBVc2luZyBwY2lfZ2V0X2RvbWFpbl9idXNf
YW5kX3Nsb3QgdG8gZ2V0IHRoZSBHUFUgZGV2aWNlLg0KIDMpIE90aGVyIG1pbm9yIGltcHJvdmVt
ZW50cy4NCg0KIFRob3NlIHBhdGNoZXMgYXJlIHRlc3RlZCBvbiBsczNhNTAwMCArIGxzN2ExMDAw
IENSQiwgbHMzYTUwMDAgKyBsczdhMjAwMA0KIGV2YiwgYW5kIGxlbW90ZSBhMTkwMSBib2FyZChs
czNhNDAwMCArIGxzN2ExMDAwKS4gT24gbG9vbmdzb24gbWlwcyBDUFUsDQogdGhlIHdyaXRlIGNv
bWJpbmUgc3VwcG9ydCBzaG91bGQgYmUgZW5hYmxlZCwgdG8gZ2V0IGEgZGVjZW50IHBlcmZvcm1h
bmNlDQogZm9yIHdyaXRpbmcgZnJhbWVidWZmZXIgZGF0YSB0byB0aGUgVlJBTS4NCg0KdjkgLT4g
djEwOg0KIDEpIFJldmlzZSBsc2RjX2RybV9mcmVlemUoKSB0byBpbXBsZW1lbnQgUzMgY29tcGxl
dGVseSBhbmQgY29ycmVjdGx5Lg0KICAgIEkgc3VkZGVubHkgcmVhbGl6ZWQgdGhhdCBwaW5uZWQg
YnVmZmVyIGNhbiBub3QgbW92ZSBhbmQgVlJBTSBsb3N0DQogICAgcG93ZXIgd2hlbiBzbGVlcCB0
byBSQU0uIFRodXMsIHRoZSBkYXRhIGluIHRoZSBidWZmZXIgd2hvIGlzIHBpbm5lZA0KICAgIGlu
IFZSQU0gd2lsbCBnZXQgbG9zdCB3aGVuIHJlc3VtZS4gWWV0IGl0J3Mgbm90IGJpZyBwcm9ibGVt
IGJlY2F1c2UNCiAgICB3ZSBhcmUgc29mdHdhcmUgcmVuZGVyaW5nIHNvbHV0aW9uIHdoaWNoIHJl
bGF5IG9uIHRoZSBDUFUgdXBkYXRlIHRoZQ0KICAgIGZyb250IGZyYW1lYnVmZmVyLiBXZSBjYW4g
c2VlIHRoZSBnYXJiYWdlIGRhdGEgd2hlbiByZXN1bWUgZnJvbSBTMywNCiAgICBidXQgdGhlIHNj
cmVlbiB3aWxsIHNob3cgY29ycmVjdCBpbWFnZSBhcyBJIG1vdmUgdGhlIGN1cnNvci4gVGhpcyBp
cw0KICAgIGR1ZSB0byB0aGUgY3B1IHJlcGFpbnQuIHYxMCBvZiB0aGlzIHBhdGNoIG1ha2UgUzMg
cGVyZmVjdCBieSB1bnBpbg0KICAgIGFsbCBvZiBCT3MgaW4gVlJBTSwgZXZpY3QgdGhlbSBhbGwg
dG8gc3lzdGVtIFJBTS4NCg0KdjEwIC0+IHYxMToNCiAxKSBPbiBkb3VibGUgc2NyZWVuIGNhc2Us
IHRoZSBzaW5nbGUgZ2lhbnQgZnJhbWVidWZmZXIgaXMgcmVmZXJlbmNlZCBieQ0KICAgIHR3byBH
RU0gb2JqZWN0LCBoZW5jZSwgaXQgd2lsbCBiZSBwaW5uZWQgYnkgcHJlcGFyZV9mYigpIGF0IGxl
YXNlIHR3bw0KICAgIHRpbWVzLiBUaGlzIGNhdXNlIGl0cyBwaW4gY291bnQgPiAxLiBWMTAgb2Yg
dGhpcyBwYXRjaCBvbmx5IHVucGluIFZSQU0NCiAgICBCT3Mgb25jZSB3aGVuIHN1c3BlbmQsIHdo
aWNoIGlzIG5vdCBjb3JyZWN0IG9uIGRvdWJsZSBzY3JlZW4gY2FzZS4gVjExDQogICAgb2YgdGhp
cyBwYXRjaCB1bnBpbiBCT3MgdW50aWwgaXRzIHBpbiBjb3VudCByZWFjaCB0byB6ZXJvIHdoZW4g
c3VzcGVuZC4NCiAgICBUaGVuLCB3ZSBtYWtlIHRoZSBTMyBzdXBwb3J0IGNvbXBsZXRlIGZpbmFs
bHkuIFdpdGggdjExLCBJIGNhbid0IHNlZQ0KICAgIGFueSBnYXJiYWdlIGRhdGEgYWZ0ZXIgcmVz
dW1lLiBUZXN0ZWQgb24gYm90aCBsczdhMTAwMCBhbmQgbHM3YTIwMDANCiAgICBwbGF0Zm9ybSwg
d2l0aCBzaW5nbGUgc2NyZWVuIGFuZCBkb3VibGUgc2NyZWVuIGNvbmZpZ3VyYXRpb24uDQogMikg
Rml4IHZibGFuayB3YWl0IHRpbWVvdXQgd2hlbiBkaXNhYmxlIENSVEMuDQogMykgVGVzdCBhZ2Fp
bnN0IElHVCwgYXQgbGVhc3QgZmJkZXYgdGVzdCBhbmQga21zX2ZsaXAgdGVzdCBwYXNzZWQuDQog
NCkgUmV3cml0ZSBwaXhlbCBQTEwgdXBkYXRlIGZ1bmN0aW9uLCBtYWdpYyBudW1iZXJzIGVsaW1p
bmF0ZWQgKEVtaWwpDQogNSkgRHJvcCBhIGZldyBjb21tb24gaGFyZHdhcmUgZmVhdHVyZXMgZGVz
Y3JpcHRpb24gaW4gbHNkY19kZXNjIChFbWlsKQ0KIDYpIERyb3AgbHNkY19tb2RlX2NvbmZpZ19t
b2RlX3ZhbGlkKCksIGluc3RlYWQgYWRkIHJlc3RyaWN0aW9ucyBpbiBkdW1iDQogICAgY3JlYXRl
IGZ1bmN0aW9uLiAoRW1pbCkNCiA3KSBVbnRhbmdsZSB0aGUgbHM3YTEwMDAgY2FzZSBhbmQgbHM3
YTIwMDAgY2FzZSBjb21wbGV0ZWx5IChUaG9tYXMpDQoNCnYxMSAtPiB2MTI6DQogbm9uZQ0KDQp2
MTIgLT4gdjEzOg0KIDEpIEFkZCBiZW5jaG1hcmsgdG8gZmlndXJlIG91dCB0aGUgYmFuZHdpZHRo
IG9mIHRoZSBoYXJkd2FyZSBwbGF0Zm9ybS4NCiAgICBVc2FnZToNCiAgICAjIGNkIC9zeXMva2Vy
bmVsL2RlYnVnL2RyaS8wLw0KICAgICMgY2F0IGJlbmNobWFyaw0KDQogMikgVlJBTSBpcyBmaWxs
ZWQgd2l0aCBnYXJiYWdlIGRhdGEgaWYgdW5pbml0aWFsaXplZCwgYWRkIGEgYnVmZmVyDQogICAg
Y2xlYXJpbmcgcHJvY2VkdXJlLCBjbGVhciBpdCBvbiB0aGUgQk8gY3JlYXRpb24gdGltZS4NCiAz
KSBVcGRhdGUgY29weXJpZ2h0cyBhbmQgYWRqdXN0IGNvZGluZyBzdHlsZSAoSHVhY2FpKQ0KDQp2
MTMgLT4gdjE0Og0KIDEpIFRyeWluZyB0byBhZGQgYXN5bmMgdXBkYXRlIHN1cHBvcnQgZm9yIGN1
cnNvciBwbGFuZS4NCg0KU2lnbmVkLW9mZi1ieTogTGkgWWkgPGxpeWlAbG9vbmdzb24uY24+DQpT
aWduZWQtb2ZmLWJ5OiBTdWkgSmluZ2ZlbmcgPHN1aWppbmdmZW5nQGxvb25nc29uLmNuPg0KVGVz
dGVkLWJ5OiBMaXUgUGVpYmFvIDxsaXVwZWliYW9AbG9vbmdzb24uY24+DQpDYzogTWFhcnRlbiBM
YW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4NCkNjOiBNYXhpbWUg
UmlwYXJkIDxtcmlwYXJkQGtlcm5lbC5vcmc+DQpDYzogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1t
ZXJtYW5uQHN1c2UuZGU+DQpDYzogRGF2aWQgQWlybGllIDxhaXJsaWVkQGdtYWlsLmNvbT4NCkNj
OiBEYW5pZWwgVmV0dGVyIDxkYW5pZWxAZmZ3bGwuY2g+DQpDYzogU3VtaXQgU2Vtd2FsIDxzdW1p
dC5zZW13YWxAbGluYXJvLm9yZz4NCkNjOiAiQ2hyaXN0aWFuIEvDtm5pZyIgPGNocmlzdGlhbi5r
b2VuaWdAYW1kLmNvbT4NCkNjOiBOYXRoYW4gQ2hhbmNlbGxvciA8bmF0aGFuQGtlcm5lbC5vcmc+
DQpDYzogRW1pbCBWZWxpa292IDxlbWlsLmwudmVsaWtvdkBnbWFpbC5jb20+DQpDYzogR2VlcnQg
VXl0dGVyaG9ldmVuIDxnZWVydCtyZW5lc2FzQGdsaWRlci5iZT4NCkNjOiBKYXZpZXIgTWFydGlu
ZXogQ2FuaWxsYXMgPGphdmllcm1AcmVkaGF0LmNvbT4NCi0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9L
Y29uZmlnICAgICAgICAgICAgICAgICAgICAgICB8ICAgIDIgKw0KIGRyaXZlcnMvZ3B1L2RybS9N
YWtlZmlsZSAgICAgICAgICAgICAgICAgICAgICB8ICAgIDEgKw0KIGRyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9LY29uZmlnICAgICAgICAgICAgICB8ICAgMTcgKw0KIGRyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9NYWtlZmlsZSAgICAgICAgICAgICB8ICAgMjAgKw0KIGRyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX2JlbmNobWFyay5jICAgICB8ICAxMzMgKysNCiBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaCAgICAgfCAgIDEzICsNCiBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19jcnRjLmMgICAgICAgICAgfCAxMDY2ICsrKysrKysrKysrKysrKysrDQog
ZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGVidWdmcy5jICAgICAgIHwgICA5MSArKw0K
IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2RldmljZS5jICAgICAgICB8ICAxMDQgKysN
CiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kcnYuYyAgICAgICAgICAgfCAgNDk1ICsr
KysrKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmggICAgICAgICAgIHwg
IDQ1MSArKysrKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2VtLmMgICAgICAg
ICAgIHwgIDMyNCArKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5oICAg
ICAgICAgICB8ICAgMzcgKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dmeHBsbC5j
ICAgICAgICB8ICAxOTkgKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2Z4cGxs
LmggICAgICAgIHwgICA1MiArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfaTJjLmMg
ICAgICAgICAgIHwgIDE3OSArKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pMmMu
aCAgICAgICAgICAgfCAgIDI5ICsNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEu
YyAgICAgICAgICAgfCAgIDcxICsrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfaXJx
LmggICAgICAgICAgIHwgICAxNiArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0
cHV0LmggICAgICAgIHwgICAyMSArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0
cHV0XzdhMTAwMC5jIHwgIDE2MSArKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19v
dXRwdXRfN2EyMDAwLmMgfCAgNTMxICsrKysrKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfcGl4cGxsLmMgICAgICAgIHwgIDQ4MSArKysrKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX3BpeHBsbC5oICAgICAgICB8ICAgODYgKysNCiBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19wbGFuZS5jICAgICAgICAgfCAgNzgxICsrKysrKysrKysrKw0KIGRyaXZl
cnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMgICAgICAgICB8ICAgNTYgKw0KIGRyaXZl
cnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmggICAgICAgICB8ICAgMTIgKw0KIGRyaXZl
cnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3JlZ3MuaCAgICAgICAgICB8ICA0MDIgKysrKysrKw0K
IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3R0bS5jICAgICAgICAgICB8ICA2MTAgKysr
KysrKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3R0bS5oICAgICAgICAgICB8
ICAgOTkgKysNCiAzMCBmaWxlcyBjaGFuZ2VkLCA2NTQwIGluc2VydGlvbnMoKykNCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25maWcNCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL01ha2VmaWxlDQogY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5jDQogY3JlYXRl
IG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5oDQog
Y3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2NydGMuYw0K
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kZWJ1Z2Zz
LmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGV2
aWNlLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
ZHJ2LmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
ZHJ2LmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
Z2VtLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
Z2VtLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
Z2Z4cGxsLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfZ2Z4cGxsLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfaTJjLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfaTJjLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfaXJxLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfaXJxLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfb3V0cHV0LmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfb3V0cHV0XzdhMTAwMC5jDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1
L2RybS9sb29uZ3Nvbi9sc2RjX291dHB1dF83YTIwMDAuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19waXhwbGwuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0
NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19waXhwbGwuaA0KIGNyZWF0ZSBtb2RlIDEw
MDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19wbGFuZS5jDQogY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMNCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuaA0KIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19yZWdzLmgNCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmMNCiBjcmVhdGUg
bW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmgNCg0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcN
CmluZGV4IGJhM2ZiMDRiYjY5MS4uZDFmYTg3ZDJhY2I3IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9n
cHUvZHJtL0tjb25maWcNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnDQpAQCAtMzMxLDYg
KzMzMSw4IEBAIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL3YzZC9LY29uZmlnIg0KIA0KIHNvdXJj
ZSAiZHJpdmVycy9ncHUvZHJtL3ZjNC9LY29uZmlnIg0KIA0KK3NvdXJjZSAiZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL0tjb25maWciDQorDQogc291cmNlICJkcml2ZXJzL2dwdS9kcm0vZXRuYXZp
di9LY29uZmlnIg0KIA0KIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9LY29uZmln
Ig0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2Ry
bS9NYWtlZmlsZQ0KaW5kZXggYTMzMjU3ZDJiYzdmLi4xMzE1MzE0NTNiOGUgMTAwNjQ0DQotLS0g
YS9kcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmls
ZQ0KQEAgLTE5NCwzICsxOTQsNCBAQCBvYmoteQkJCSs9IGd1ZC8NCiBvYmotJChDT05GSUdfRFJN
X0hZUEVSVikgKz0gaHlwZXJ2Lw0KIG9iai15CQkJKz0gc29sb21vbi8NCiBvYmotJChDT05GSUdf
RFJNX1NQUkQpICs9IHNwcmQvDQorb2JqLSQoQ09ORklHX0RSTV9MT09OR1NPTikgKz0gbG9vbmdz
b24vDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25maWcgYi9kcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vS2NvbmZpZw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4
IDAwMDAwMDAwMDAwMC4uZGY2OTQ2ZDUwNWZhDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vS2NvbmZpZw0KQEAgLTAsMCArMSwxNyBAQA0KKyMgU1BEWC1MaWNl
bnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisNCitjb25maWcgRFJNX0xPT05HU09ODQorCXRyaXN0
YXRlICJEUk0gc3VwcG9ydCBmb3IgTG9vbmdzb24gR3JhcGhpY3MiDQorCWRlcGVuZHMgb24gRFJN
ICYmIFBDSSAmJiBNTVUNCisJc2VsZWN0IERSTV9LTVNfSEVMUEVSDQorCXNlbGVjdCBEUk1fVFRN
DQorCXNlbGVjdCBJMkMNCisJc2VsZWN0IEkyQ19BTEdPQklUDQorCWhlbHANCisJICBUaGlzIGlz
IGEgRFJNIGRyaXZlciBmb3IgTG9vbmdzb24gR3JhcGhpY3MsIGl0IG1heSBpbmNsdWRpbmcNCisJ
ICBMUzdBMjAwMCwgTFM3QTEwMDAsIExTMksyMDAwIGFuZCBMUzJLMTAwMCBldGMuIExvb25nc29u
IExTN0ENCisJICBzZXJpZXMgYXJlIGJyaWRnZSBjaGlwc2V0LCB3aGlsZSBMb29uZ3NvbiBMUzJL
IHNlcmllcyBhcmUgU29DLg0KKw0KKwkgIElmICJNIiBpcyBzZWxlY3RlZCwgdGhlIG1vZHVsZSB3
aWxsIGJlIGNhbGxlZCBsb29uZ3Nvbi4NCisNCisJICBJZiBpbiBkb3VidCwgc2F5ICJOIi4NCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vTWFrZWZpbGUgYi9kcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vTWFrZWZpbGUNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAw
MDAwMDAwMDAuLjkxNTg4MTZlY2U4ZQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL01ha2VmaWxlDQpAQCAtMCwwICsxLDIwIEBADQorIyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMA0KKw0KK2xvb25nc29uLXkgOj0gXA0KKwlsc2RjX2JlbmNobWFy
ay5vIFwNCisJbHNkY19jcnRjLm8gXA0KKwlsc2RjX2RlYnVnZnMubyBcDQorCWxzZGNfZGV2aWNl
Lm8gXA0KKwlsc2RjX2Rydi5vIFwNCisJbHNkY19nZW0ubyBcDQorCWxzZGNfZ2Z4cGxsLm8gXA0K
Kwlsc2RjX2kyYy5vIFwNCisJbHNkY19pcnEubyBcDQorCWxzZGNfb3V0cHV0XzdhMTAwMC5vIFwN
CisJbHNkY19vdXRwdXRfN2EyMDAwLm8gXA0KKwlsc2RjX3BsYW5lLm8gXA0KKwlsc2RjX3BpeHBs
bC5vIFwNCisJbHNkY19wcm9iZS5vIFwNCisJbHNkY190dG0ubw0KKw0KK29iai0kKENPTkZJR19E
Uk1fTE9PTkdTT04pICs9IGxvb25nc29uLm8NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19iZW5jaG1hcmsuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X2JlbmNobWFyay5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi44
Mjk2MTUzMWQ4NGMNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nv
bi9sc2RjX2JlbmNobWFyay5jDQpAQCAtMCwwICsxLDEzMyBAQA0KKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29u
IFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxkcm0v
ZHJtX2RlYnVnZnMuaD4NCisNCisjaW5jbHVkZSAibHNkY19iZW5jaG1hcmsuaCINCisjaW5jbHVk
ZSAibHNkY19kcnYuaCINCisjaW5jbHVkZSAibHNkY19nZW0uaCINCisjaW5jbHVkZSAibHNkY190
dG0uaCINCisNCit0eXBlZGVmIHZvaWQgKCpsc2RjX2NvcHlfcHJvY190KShzdHJ1Y3QgbHNkY19i
byAqc3JjX2JvLA0KKwkJCQkgc3RydWN0IGxzZGNfYm8gKmRzdF9ibywNCisJCQkJIHVuc2lnbmVk
IGludCBzaXplLA0KKwkJCQkgaW50IG4pOw0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY29weV9ndHRf
dG9fdnJhbV9jcHUoc3RydWN0IGxzZGNfYm8gKnNyY19ibywNCisJCQkJICAgICAgc3RydWN0IGxz
ZGNfYm8gKmRzdF9ibywNCisJCQkJICAgICAgdW5zaWduZWQgaW50IHNpemUsDQorCQkJCSAgICAg
IGludCBuKQ0KK3sNCisJbHNkY19ib19rbWFwKHNyY19ibyk7DQorCWxzZGNfYm9fa21hcChkc3Rf
Ym8pOw0KKw0KKwl3aGlsZSAobi0tKQ0KKwkJbWVtY3B5X3RvaW8oZHN0X2JvLT5rcHRyLCBzcmNf
Ym8tPmtwdHIsIHNpemUpOw0KKw0KKwlsc2RjX2JvX2t1bm1hcChzcmNfYm8pOw0KKwlsc2RjX2Jv
X2t1bm1hcChkc3RfYm8pOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NvcHlfdnJhbV90b19n
dHRfY3B1KHN0cnVjdCBsc2RjX2JvICpzcmNfYm8sDQorCQkJCSAgICAgIHN0cnVjdCBsc2RjX2Jv
ICpkc3RfYm8sDQorCQkJCSAgICAgIHVuc2lnbmVkIGludCBzaXplLA0KKwkJCQkgICAgICBpbnQg
bikNCit7DQorCWxzZGNfYm9fa21hcChzcmNfYm8pOw0KKwlsc2RjX2JvX2ttYXAoZHN0X2JvKTsN
CisNCisJd2hpbGUgKG4tLSkNCisJCW1lbWNweV9mcm9taW8oZHN0X2JvLT5rcHRyLCBzcmNfYm8t
PmtwdHIsIHNpemUpOw0KKw0KKwlsc2RjX2JvX2t1bm1hcChzcmNfYm8pOw0KKwlsc2RjX2JvX2t1
bm1hcChkc3RfYm8pOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NvcHlfZ3R0X3RvX2d0dF9j
cHUoc3RydWN0IGxzZGNfYm8gKnNyY19ibywNCisJCQkJICAgICBzdHJ1Y3QgbHNkY19ibyAqZHN0
X2JvLA0KKwkJCQkgICAgIHVuc2lnbmVkIGludCBzaXplLA0KKwkJCQkgICAgIGludCBuKQ0KK3sN
CisJbHNkY19ib19rbWFwKHNyY19ibyk7DQorCWxzZGNfYm9fa21hcChkc3RfYm8pOw0KKw0KKwl3
aGlsZSAobi0tKQ0KKwkJbWVtY3B5KGRzdF9iby0+a3B0ciwgc3JjX2JvLT5rcHRyLCBzaXplKTsN
CisNCisJbHNkY19ib19rdW5tYXAoc3JjX2JvKTsNCisJbHNkY19ib19rdW5tYXAoZHN0X2JvKTsN
Cit9DQorDQorc3RhdGljIHZvaWQgbHNkY19iZW5jaG1hcmtfY29weShzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYsDQorCQkJCXVuc2lnbmVkIGludCBzaXplLA0KKwkJCQl1bnNpZ25lZCBpbnQgbiwN
CisJCQkJdTMyIHNyY19kb21haW4sDQorCQkJCXUzMiBkc3RfZG9tYWluLA0KKwkJCQlsc2RjX2Nv
cHlfcHJvY190IGNvcHlfcHJvYywNCisJCQkJc3RydWN0IGRybV9wcmludGVyICpwKQ0KK3sNCisJ
c3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSAmbGRldi0+YmFzZTsNCisJc3RydWN0IGxzZGNfYm8g
KnNyY19ibzsNCisJc3RydWN0IGxzZGNfYm8gKmRzdF9ibzsNCisJdW5zaWduZWQgbG9uZyBzdGFy
dF9qaWZmaWVzOw0KKwl1bnNpZ25lZCBsb25nIGVuZF9qaWZmaWVzOw0KKwl1bnNpZ25lZCBpbnQg
dGhyb3VnaHB1dDsNCisJdW5zaWduZWQgaW50IHRpbWU7DQorDQorCXNyY19ibyA9IGxzZGNfYm9f
Y3JlYXRlX2tlcm5lbF9waW5uZWQoZGRldiwgc3JjX2RvbWFpbiwgc2l6ZSk7DQorCWRzdF9ibyA9
IGxzZGNfYm9fY3JlYXRlX2tlcm5lbF9waW5uZWQoZGRldiwgZHN0X2RvbWFpbiwgc2l6ZSk7DQor
DQorCXN0YXJ0X2ppZmZpZXMgPSBqaWZmaWVzOw0KKw0KKwljb3B5X3Byb2Moc3JjX2JvLCBkc3Rf
Ym8sIHNpemUsIG4pOw0KKw0KKwllbmRfamlmZmllcyA9IGppZmZpZXM7DQorDQorCWxzZGNfYm9f
ZnJlZV9rZXJuZWxfcGlubmVkKHNyY19ibyk7DQorCWxzZGNfYm9fZnJlZV9rZXJuZWxfcGlubmVk
KGRzdF9ibyk7DQorDQorCXRpbWUgPSBqaWZmaWVzX3RvX21zZWNzKGVuZF9qaWZmaWVzIC0gc3Rh
cnRfamlmZmllcyk7DQorDQorCXRocm91Z2hwdXQgPSAobiAqIChzaXplID4+IDEwKSkgLyB0aW1l
Ow0KKw0KKwlkcm1fcHJpbnRmKHAsDQorCQkgICAiQ29weSBibyBvZiAldWtCICV1IHRpbWVzIGZy
b20gJXMgdG8gJXMgaW4gJXVtczogJXVNQi9zXG4iLA0KKwkJICAgc2l6ZSA+PiAxMCwgbiwNCisJ
CSAgIGxzZGNfZG9tYWluX3RvX3N0cihzcmNfZG9tYWluKSwNCisJCSAgIGxzZGNfZG9tYWluX3Rv
X3N0cihkc3RfZG9tYWluKSwNCisJCSAgIHRpbWUsIHRocm91Z2hwdXQpOw0KK30NCisNCitpbnQg
bHNkY19zaG93X2JlbmNobWFya19jb3B5KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwgc3RydWN0
IGRybV9wcmludGVyICpwKQ0KK3sNCisJdW5zaWduZWQgaW50IGJ1ZmZlcl9zaXplID0gMTkyMCAq
IDEwODAgKiA0Ow0KKwl1bnNpZ25lZCBpbnQgaXRlcmF0aW9uID0gNjA7DQorDQorCWxzZGNfYmVu
Y2htYXJrX2NvcHkobGRldiwNCisJCQkgICAgYnVmZmVyX3NpemUsDQorCQkJICAgIGl0ZXJhdGlv
biwNCisJCQkgICAgTFNEQ19HRU1fRE9NQUlOX0dUVCwNCisJCQkgICAgTFNEQ19HRU1fRE9NQUlO
X0dUVCwNCisJCQkgICAgbHNkY19jb3B5X2d0dF90b19ndHRfY3B1LA0KKwkJCSAgICBwKTsNCisN
CisJbHNkY19iZW5jaG1hcmtfY29weShsZGV2LA0KKwkJCSAgICBidWZmZXJfc2l6ZSwNCisJCQkg
ICAgaXRlcmF0aW9uLA0KKwkJCSAgICBMU0RDX0dFTV9ET01BSU5fR1RULA0KKwkJCSAgICBMU0RD
X0dFTV9ET01BSU5fVlJBTSwNCisJCQkgICAgbHNkY19jb3B5X2d0dF90b192cmFtX2NwdSwNCisJ
CQkgICAgcCk7DQorDQorCWxzZGNfYmVuY2htYXJrX2NvcHkobGRldiwNCisJCQkgICAgYnVmZmVy
X3NpemUsDQorCQkJICAgIGl0ZXJhdGlvbiwNCisJCQkgICAgTFNEQ19HRU1fRE9NQUlOX1ZSQU0s
DQorCQkJICAgIExTRENfR0VNX0RPTUFJTl9HVFQsDQorCQkJICAgIGxzZGNfY29weV92cmFtX3Rv
X2d0dF9jcHUsDQorCQkJICAgIHApOw0KKw0KKwlyZXR1cm4gMDsNCit9DQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfYmVuY2htYXJrLmggYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4
IDAwMDAwMDAwMDAwMC4uMmJmOTQwNmVhZTljDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaA0KQEAgLTAsMCArMSwxMyBAQA0KKy8q
IFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQg
KEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQor
DQorI2lmbmRlZiBfX0xTRENfQkVOQ0hNQVJLX0hfXw0KKyNkZWZpbmUgX19MU0RDX0JFTkNITUFS
S19IX18NCisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisNCitpbnQgbHNkY19zaG93X2JlbmNo
bWFya19jb3B5KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwgc3RydWN0IGRybV9wcmludGVyICpw
KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19jcnRjLmMNCm5ldyBmaWxl
IG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmRlMmMxZDUxNGJhYQ0KLS0tIC9kZXYv
bnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfY3J0Yy5jDQpAQCAtMCww
ICsxLDEwNjYgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQor
ICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGlt
aXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPg0KKw0KKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pYy5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4NCisj
aW5jbHVkZSA8ZHJtL2RybV9kZWJ1Z2ZzLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+
DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQorLyoNCisgKiBUaGUgc29mdCByZXNldCBj
YXVzZSB0aGUgdmJsYW5rIGNvdW50ZXIgcmVzZXQgdG8gemVybywgYnV0IHRoZSBhZGRyZXNzDQor
ICogYW5kIG90aGVyIHNldHRpbmdzIGluIHRoZSBjcnRjIHJlZ2lzdGVyIHJlbWFpbnMuDQorICov
DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9zb2Z0X3Jlc2V0KHN0cnVjdCBsc2RjX2NydGMg
KmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQor
CXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JF
Ryk7DQorDQorCXZhbCAmPSBDRkdfVkFMSURfQklUU19NQVNLOw0KKw0KKwkvKiBzb2Z0IHJlc2V0
IGJpdCwgYWN0aXZlIGxvdyAqLw0KKwl2YWwgJj0gfkNGR19SRVNFVF9OOw0KKw0KKwl2YWwgJj0g
fkNGR19QSVhfRk1UX01BU0s7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZH
X1JFRywgdmFsKTsNCisNCisJdWRlbGF5KDUpOw0KKw0KKwl2YWwgfD0gQ0ZHX1JFU0VUX04gfCBM
U0RDX1BGX1hSR0I4ODg4IHwgQ0ZHX09VVFBVVF9FTkFCTEU7DQorDQorCWxzZGNfd3JlZzMyKGxk
ZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRywgdmFsKTsNCisNCisJbWRlbGF5KDIwKTsNCit9DQorDQor
c3RhdGljIHZvaWQgbHNkY19jcnRjMV9zb2Z0X3Jlc2V0KHN0cnVjdCBsc2RjX2NydGMgKmxjcnRj
KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorCXUzMiB2
YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRyk7DQor
DQorCXZhbCAmPSBDRkdfVkFMSURfQklUU19NQVNLOw0KKw0KKwkvKiBzb2Z0IHJlc2V0IGJpdCwg
YWN0aXZlIGxvdyAqLw0KKwl2YWwgJj0gfkNGR19SRVNFVF9OOw0KKw0KKwl2YWwgJj0gfkNGR19Q
SVhfRk1UX01BU0s7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRywg
dmFsKTsNCisNCisJdWRlbGF5KDUpOw0KKw0KKwl2YWwgfD0gQ0ZHX1JFU0VUX04gfCBMU0RDX1BG
X1hSR0I4ODg4IHwgQ0ZHX09VVFBVVF9FTkFCTEU7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1JUQzFfQ0ZHX1JFRywgdmFsKTsNCisNCisJbXNsZWVwKDIwKTsNCit9DQorDQorc3RhdGlj
IHZvaWQgbHNkY19jcnRjMF9lbmFibGUoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlz
dHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisJdTMyIHZhbDsNCisNCisJ
dmFsID0gbHNkY19ycmVnMzIobGRldiwgTFNEQ19DUlRDMF9DRkdfUkVHKTsNCisNCisJLyoNCisJ
ICogVGhpcyBtYXkgaGFwcGVucyBvbiBleHRyZW1lbHkgcmFyZSBjYXNlLCBsdWNraWx5LCBhIHNv
ZnQgcmVzZXQNCisJICogY2FuIGhlbHBzIHRvIGJyaW5nIGl0IGJhY2sgdG8gbm9ybWFsLiBXZSBh
ZGQgYSB3YXJuIGhlcmUsIGhvcGUNCisJICogdG8gY2F0Y2ggc29tZXRoaW5nIGlmIGl0IGhhcHBl
bnMuDQorCSAqLw0KKw0KKwlpZiAodmFsICYgQ1JUQ19BTkNIT1JFRCkgew0KKwkJZHJtX3dhcm4o
JmxkZXYtPmJhc2UsICIlcyBhbmNob3JlZFxuIiwgbGNydGMtPmJhc2UubmFtZSk7DQorCQlyZXR1
cm4gbHNkY19jcnRjMF9zb2Z0X3Jlc2V0KGxjcnRjKTsNCisJfQ0KKw0KKwlsc2RjX3dyZWczMihs
ZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIHZhbCB8IENGR19PVVRQVVRfRU5BQkxFKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9kaXNhYmxlKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRj
KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxz
ZGNfdXJlZzMyX2NscihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIENGR19PVVRQVVRfRU5BQkxF
KTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMxX2VuYWJs
ZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diA9IGxjcnRjLT5sZGV2Ow0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2
LCBMU0RDX0NSVEMxX0NGR19SRUcpOw0KKwlpZiAodmFsICYgQ1JUQ19BTkNIT1JFRCkgew0KKwkJ
ZHJtX3dhcm4oJmxkZXYtPmJhc2UsICIlcyBhbmNob3JlZFxuIiwgbGNydGMtPmJhc2UubmFtZSk7
DQorCQlyZXR1cm4gbHNkY19jcnRjMV9zb2Z0X3Jlc2V0KGxjcnRjKTsNCisJfQ0KKw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHZhbCB8IENGR19PVVRQVVRfRU5BQkxF
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9kaXNhYmxlKHN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7
DQorDQorCWxzZGNfdXJlZzMyX2NscihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIENGR19PVVRQ
VVRfRU5BQkxFKTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCisvKiBBbGwgbG9vbmdzb24gZGlz
cGxheSBjb250cm9sbGVyIHN1cHBvcnQgc2Nhbm91dCBwb3NpdGlvbiBoYXJkd2FyZSAqLw0KKw0K
K3N0YXRpYyB2b2lkIGxzZGNfY3J0YzBfc2Nhbl9wb3Moc3RydWN0IGxzZGNfY3J0YyAqbGNydGMs
IGludCAqaHBvcywgaW50ICp2cG9zKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
bGNydGMtPmxkZXY7DQorCXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExT
RENfQ1JUQzBfU0NBTl9QT1NfUkVHKTsNCisNCisJKmhwb3MgPSB2YWwgPj4gMTY7DQorCSp2cG9z
ID0gdmFsICYgMHhmZmZmOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMxX3NjYW5fcG9z
KHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjLCBpbnQgKmhwb3MsIGludCAqdnBvcykNCit7DQorCXN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKwl1MzIgdmFsOw0KKw0KKwl2
YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX1NDQU5fUE9TX1JFRyk7DQorDQorCSpo
cG9zID0gdmFsID4+IDE2Ow0KKwkqdnBvcyA9IHZhbCAmIDB4ZmZmZjsNCit9DQorDQorc3RhdGlj
IHZvaWQgbHNkY19jcnRjMF9lbmFibGVfdmJsYW5rKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0K
K3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNf
dXJlZzMyX3NldChsZGV2LCBMU0RDX0lOVF9SRUcsIElOVF9DUlRDMF9WU1lOQ19FTik7DQorfQ0K
Kw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzBfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGxzZGNfY3J0
YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsN
CisNCisJbHNkY191cmVnMzJfY2xyKGxkZXYsIExTRENfSU5UX1JFRywgSU5UX0NSVEMwX1ZTWU5D
X0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9lbmFibGVfdmJsYW5rKHN0cnVj
dCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNy
dGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0lOVF9SRUcsIElOVF9D
UlRDMV9WU1lOQ19FTik7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzFfZGlzYWJsZV92
Ymxhbmsoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2Ug
KmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfY2xyKGxkZXYsIExTRENfSU5U
X1JFRywgSU5UX0NSVEMxX1ZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRj
MF9mbGlwKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0NS
VEMwX0NGR19SRUcsIENGR19QQUdFX0ZMSVApOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2Ny
dGMxX2ZsaXAoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfc2V0KGxkZXYsIExTRENf
Q1JUQzFfQ0ZHX1JFRywgQ0ZHX1BBR0VfRkxJUCk7DQorfQ0KKw0KKy8qDQorICogQ1JUQzAgY2xv
bmUgZnJvbSBDUlRDMSBvciBDUlRDMSBjbG9uZSBmcm9tIENSVEMwIHVzaW5nIGhhcmR3YXJlIGxv
Z2ljLg0KKyAqIEhhcmR3YXJlIGVuZ2luZWVyIHNheSB0aGlzIHdvdWxkIGhlbHAgdG8gc2F2aW5n
IGJhbmR3aWR0aCBvbiBjbG9uZSBtb2RlLg0KKyAqDQorICogVGhpcyBtYXkgdXNlZnVsIG9uIGN1
c3RvbSBjbG9uZSBhcHBsaWNhdGlvbi4NCisgKi8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMw
X2Nsb25lKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0NS
VEMwX0NGR19SRUcsIENGR19IV19DTE9ORSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0
YzFfY2xvbmUoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfc2V0KGxkZXYsIExTRENf
Q1JUQzFfQ0ZHX1JFRywgQ0ZHX0hXX0NMT05FKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19j
cnRjMF9zZXRfbW9kZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9IRElTUExB
WV9SRUcsDQorCQkgICAgKG1vZGUtPmNydGNfaHRvdGFsIDw8IDE2KSB8IG1vZGUtPmNydGNfaGRp
c3BsYXkpOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1ZESVNQTEFZX1JFRywN
CisJCSAgICAobW9kZS0+Y3J0Y192dG90YWwgPDwgMTYpIHwgbW9kZS0+Y3J0Y192ZGlzcGxheSk7
DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfSFNZTkNfUkVHLA0KKwkJICAgICht
b2RlLT5jcnRjX2hzeW5jX2VuZCA8PCAxNikgfCBtb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IHwgSFNZ
TkNfRU4pOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1ZTWU5DX1JFRywNCisJ
CSAgICAobW9kZS0+Y3J0Y192c3luY19lbmQgPDwgMTYpIHwgbW9kZS0+Y3J0Y192c3luY19zdGFy
dCB8IFZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9zZXRfbW9kZShz
dHJ1Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKm1vZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsN
CisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMV9IRElTUExBWV9SRUcsDQorCQkgICAg
KG1vZGUtPmNydGNfaHRvdGFsIDw8IDE2KSB8IG1vZGUtPmNydGNfaGRpc3BsYXkpOw0KKw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZESVNQTEFZX1JFRywNCisJCSAgICAobW9kZS0+
Y3J0Y192dG90YWwgPDwgMTYpIHwgbW9kZS0+Y3J0Y192ZGlzcGxheSk7DQorDQorCWxzZGNfd3Jl
ZzMyKGxkZXYsIExTRENfQ1JUQzFfSFNZTkNfUkVHLA0KKwkJICAgIChtb2RlLT5jcnRjX2hzeW5j
X2VuZCA8PCAxNikgfCBtb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IHwgSFNZTkNfRU4pOw0KKw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZTWU5DX1JFRywNCisJCSAgICAobW9kZS0+Y3J0
Y192c3luY19lbmQgPDwgMTYpIHwgbW9kZS0+Y3J0Y192c3luY19zdGFydCB8IFZTWU5DX0VOKTsN
Cit9DQorDQorLyoNCisgKiBUaGlzIGlzIHJlcXVpcmVkIGZvciBTMyBzdXBwb3J0Lg0KKyAqDQor
ICogQWZ0ZXIgcmVzdW1lIGZyb20gc3VzcGVuZCwgTFNEQ19DUlRDeF9DRkdfUkVHICh4PTAgb3Ig
MSlpcyBmaWxsZWQgd2l0aA0KKyAqIGdhcmJhcmdlIHZhbHVlIHdoaWNoIG1heSBjYXVzZSB0aGUg
Q1JUQyBjb21wbGV0ZWx5IGhhbmcuIFRoaXMgZnVuY3Rpb24NCisgKiBnaXZlIGEgbWluaW1hbCBz
ZXR0aW5nIHRvIHRoZSBhZmZlY3RlZCByZWdpc3RlcnMuIFRoaXMgYWxzbyBvdmVycmlkZQ0KKyAq
IHRoZSBmaXJtd2FyZSdzIHNldHRpbmcgb24gc3RhcnR1cCwgZWxpbWluYXRlIHBvdGVudGlhbCBi
bGluZGluZyBzZXR0aW5nLg0KKyAqDQorICogTWFraW5nIHRoZSBDUlRDIHdvcmtzIG9uIG91ciBv
d24gbm93LCB0aGlzIGlzIHNpbWlsYXIgd2l0aCB0aGUgZnVuY3Rpb25hbA0KKyAqIG9mIEdQVSBQ
T1NUKFBvd2VyIE9uIFNlbGYgVGVzdCkuIE9ubHkgdG91Y2ggQ1JUQyBoYXJkd2FyZSByZWxhdGVk
IHBhcnQuDQorICovDQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9yZXNldChzdHJ1Y3QgbHNk
Y19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5s
ZGV2Ow0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmbGNydGMtPmJhc2U7DQorCXUzMiB2YWw7
DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRyk7DQorDQor
CS8qIFRoaXMgaGVscCB0byBzZWUgd2hhdCBpcyBpdCAqLw0KKwlkcm1fZGJnKCZsZGV2LT5iYXNl
LCAidmFsdWUgb2YgJXMgY29uZmlndXJlIHJlZ2lzdGVyOiAleFxuIiwNCisJCWNydGMtPm5hbWUs
IHZhbCk7DQorDQorCS8qDQorCSAqIEhlbHAgdGhlIENSVEMgZ2V0IG91dCBvZiBzb2Z0IHJlc2V0
IHNhdGUsIGFzIHRoZSBDUlRDIGlzIGNvbXBsZXRlbHkNCisJICogaGFsdCBvbiBzb2Z0IHJlc2V0
IG1vZGUgKEJJVCgyMCkgPSAwKS4gSXQgZG9lcyBub3QgZXZlbnQgZ2VuZXJhdGUNCisJICogdmJs
YW5rLCBjYXVzZSB2Ymxhbmsgd2FpdCB0aW1lb3V0LiBUaGlzIGhhcHBlbmRzIHdoZW4gcmVzdW1l
IGZyb20NCisJICogUzMuDQorCSAqDQorCSAqIEFsc28gZ2l2ZSBhIHNhbmUgZm9ybWF0LCBhZnRl
ciByZXN1bWUgZnJvbSBzdXNwZW5kIFMzLCB0aGlzDQorCSAqIHJlZ2lzdGVyIGlzIGZpbGxlZCB3
aXRoIGdhcmJhcmdlIHZhbHVlLiBBIG1lYW5pbmdsZXNzIHZhbHVlIG1heQ0KKwkgKiBhbHNvIGNh
dXNlIHRoZSBDUlRDIGhhbHQgb3Igc3RhbGwuDQorCSAqLw0KKw0KKwl2YWwgPSBDRkdfUkVTRVRf
TiB8IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBf
Q0ZHX1JFRywgdmFsKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9yZXNldChzdHJ1
Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxj
cnRjLT5sZGV2Ow0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmbGNydGMtPmJhc2U7DQorCXUz
MiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRyk7
DQorDQorCWRybV9kYmcoJmxkZXYtPmJhc2UsICJ2YWx1ZSBvZiAlcyBjb25maWd1ZSByZWdpc3Rl
cjogJXhcbiIsDQorCQljcnRjLT5uYW1lLCB2YWwpOw0KKw0KKwkvKg0KKwkgKiBIZWxwIHRoZSBD
UlRDIGdldCBvdXQgb2Ygc29mdCByZXNldCBzYXRlLCBnaXZlIGEgc2FuZSBmb3JtYXQsDQorCSAq
IE90aGVyd2lzZSBpdCB3aWxsIGhhbHQgb3Igc3RhbGwgdGhlcmUuDQorCSAqLw0KKwl2YWwgPSBD
RkdfUkVTRVRfTiB8IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1JUQzFfQ0ZHX1JFRywgdmFsKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsc2Rj
X2NydGNfaHdfb3BzIGxzN2ExMDAwX2NydGNfaHdfb3BzWzJdID0gew0KKwl7DQorCQkuZW5hYmxl
ID0gbHNkY19jcnRjMF9lbmFibGUsDQorCQkuZGlzYWJsZSA9IGxzZGNfY3J0YzBfZGlzYWJsZSwN
CisJCS5lbmFibGVfdmJsYW5rID0gbHNkY19jcnRjMF9lbmFibGVfdmJsYW5rLA0KKwkJLmRpc2Fi
bGVfdmJsYW5rID0gbHNkY19jcnRjMF9kaXNhYmxlX3ZibGFuaywNCisJCS5mbGlwID0gbHNkY19j
cnRjMF9mbGlwLA0KKwkJLmNsb25lID0gbHNkY19jcnRjMF9jbG9uZSwNCisJCS5zZXRfbW9kZSA9
IGxzZGNfY3J0YzBfc2V0X21vZGUsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMF9zY2Fu
X3BvcywNCisJCS5zb2Z0X3Jlc2V0ID0gbHNkY19jcnRjMF9zb2Z0X3Jlc2V0LA0KKwkJLnJlc2V0
ID0gbHNkY19jcnRjMF9yZXNldCwNCisJfSwNCisJew0KKwkJLmVuYWJsZSA9IGxzZGNfY3J0YzFf
ZW5hYmxlLA0KKwkJLmRpc2FibGUgPSBsc2RjX2NydGMxX2Rpc2FibGUsDQorCQkuZW5hYmxlX3Zi
bGFuayA9IGxzZGNfY3J0YzFfZW5hYmxlX3ZibGFuaywNCisJCS5kaXNhYmxlX3ZibGFuayA9IGxz
ZGNfY3J0YzFfZGlzYWJsZV92YmxhbmssDQorCQkuZmxpcCA9IGxzZGNfY3J0YzFfZmxpcCwNCisJ
CS5jbG9uZSA9IGxzZGNfY3J0YzFfY2xvbmUsDQorCQkuc2V0X21vZGUgPSBsc2RjX2NydGMxX3Nl
dF9tb2RlLA0KKwkJLmdldF9zY2FuX3BvcyA9IGxzZGNfY3J0YzFfc2Nhbl9wb3MsDQorCQkuc29m
dF9yZXNldCA9IGxzZGNfY3J0YzFfc29mdF9yZXNldCwNCisJCS5yZXNldCA9IGxzZGNfY3J0YzFf
cmVzZXQsDQorCX0sDQorfTsNCisNCisvKg0KKyAqIFRoZSAzMi1iaXQgaGFyZHdhcmUgdmJsYW5r
IGNvdW50ZXIgaXMgYXZhaWxhYmxlIHNpbmNlIGxzN2EyMDAwL2xzMmsyMDAwLA0KKyAqIFRoZSBj
b3VudGVyIGdyb3cgdXAgZXZlbiB0aGUgQ1JUQyBpcyBiZWluZyBkaXNhYmxlZCwgaXQgd2lsbCBn
b3QgcmVzZXQNCisgKiBpZiB0aGUgY3J0YyBpcyBiZWluZyBzb2Z0IHJlc2V0Lg0KKyAqDQorICog
VGhvc2UgcmVnaXN0ZXJzIGFyZSBhbHNvIHJlYWRhYmxlIGZvciBsczdhMTAwMCwgYnV0IGl0cyB2
YWx1ZSBkb2VzIG5vdA0KKyAqIGNoYW5nZS4NCisgKi8NCisNCitzdGF0aWMgdTMyIGxzZGNfY3J0
YzBfZ2V0X3ZibGFua19jb3VudChzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVj
dCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKw0KKwlyZXR1cm4gbHNkY19ycmVn
MzIobGRldiwgTFNEQ19DUlRDMF9WU1lOQ19DT1VOVEVSX1JFRyk7DQorfQ0KKw0KK3N0YXRpYyB1
MzIgbHNkY19jcnRjMV9nZXRfdmJsYW5rX2NvdW50KHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0K
K3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCXJldHVy
biBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZTWU5DX0NPVU5URVJfUkVHKTsNCit9DQor
DQorLyoNCisgKiBUaGUgRE1BIHN0ZXAgYml0IGZpZWxkIGlzIGF2YWlsYWJsZSBzaW5jZSBsczdh
MjAwMC9sczJrMjAwMCwgZm9yIHN1cHBvcnQNCisgKiBvZGQgcmVzb2x1dGlvbnMuIEJ1dCBhIGxh
cmdlIERNQSBzdGVwIG1heSBzYXZlIGJhbmR3aWR0aC4gQmVoYXZpb3Igb2YNCisgKiB3cml0aW5n
IHRob2VzIGJpdHMgZmllbGQgb24gbHM3YTEwMDAvbHMyazEwMDAgaXMgdW5kZXJmaW5lZC4NCisg
Ki8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMwX3NldF9kbWFfc3RlcChzdHJ1Y3QgbHNkY19j
cnRjICpsY3J0YywNCisJCQkJICAgIGVudW0gbHNkY19kbWFfc3RlcHMgZG1hX3N0ZXApDQorew0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisJdTMyIHZhbCA9IGxz
ZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRyk7DQorDQorCXZhbCAmPSB+Q0ZHX0RN
QV9TVEVQX01BU0s7DQorCXZhbCB8PSBkbWFfc3RlcCA8PCBDRkdfRE1BX1NURVBfU0hJRlQ7DQor
DQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRywgdmFsKTsNCit9DQorDQor
c3RhdGljIHZvaWQgbHNkY19jcnRjMV9zZXRfZG1hX3N0ZXAoc3RydWN0IGxzZGNfY3J0YyAqbGNy
dGMsDQorCQkJCSAgICBlbnVtIGxzZGNfZG1hX3N0ZXBzIGRtYV9zdGVwKQ0KK3sNCisJc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorCXUzMiB2YWwgPSBsc2RjX3JyZWcz
MihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcpOw0KKw0KKwl2YWwgJj0gfkNGR19ETUFfU1RFUF9N
QVNLOw0KKwl2YWwgfD0gZG1hX3N0ZXAgPDwgQ0ZHX0RNQV9TVEVQX1NISUZUOw0KKw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHZhbCk7DQorfQ0KKw0KK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyBsczdhMjAwMF9jcnRjX2h3X29wc1syXSA9IHsN
CisJew0KKwkJLmVuYWJsZSA9IGxzZGNfY3J0YzBfZW5hYmxlLA0KKwkJLmRpc2FibGUgPSBsc2Rj
X2NydGMwX2Rpc2FibGUsDQorCQkuZW5hYmxlX3ZibGFuayA9IGxzZGNfY3J0YzBfZW5hYmxlX3Zi
bGFuaywNCisJCS5kaXNhYmxlX3ZibGFuayA9IGxzZGNfY3J0YzBfZGlzYWJsZV92YmxhbmssDQor
CQkuZmxpcCA9IGxzZGNfY3J0YzBfZmxpcCwNCisJCS5jbG9uZSA9IGxzZGNfY3J0YzBfY2xvbmUs
DQorCQkuc2V0X21vZGUgPSBsc2RjX2NydGMwX3NldF9tb2RlLA0KKwkJLnNvZnRfcmVzZXQgPSBs
c2RjX2NydGMwX3NvZnRfcmVzZXQsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMF9zY2Fu
X3BvcywNCisJCS5zZXRfZG1hX3N0ZXAgPSBsc2RjX2NydGMwX3NldF9kbWFfc3RlcCwNCisJCS5n
ZXRfdmJsYW5rX2NvdW50ZXIgPSBsc2RjX2NydGMwX2dldF92YmxhbmtfY291bnQsDQorCQkucmVz
ZXQgPSBsc2RjX2NydGMwX3Jlc2V0LA0KKwl9LA0KKwl7DQorCQkuZW5hYmxlID0gbHNkY19jcnRj
MV9lbmFibGUsDQorCQkuZGlzYWJsZSA9IGxzZGNfY3J0YzFfZGlzYWJsZSwNCisJCS5lbmFibGVf
dmJsYW5rID0gbHNkY19jcnRjMV9lbmFibGVfdmJsYW5rLA0KKwkJLmRpc2FibGVfdmJsYW5rID0g
bHNkY19jcnRjMV9kaXNhYmxlX3ZibGFuaywNCisJCS5mbGlwID0gbHNkY19jcnRjMV9mbGlwLA0K
KwkJLmNsb25lID0gbHNkY19jcnRjMV9jbG9uZSwNCisJCS5zZXRfbW9kZSA9IGxzZGNfY3J0YzFf
c2V0X21vZGUsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMV9zY2FuX3BvcywNCisJCS5z
b2Z0X3Jlc2V0ID0gbHNkY19jcnRjMV9zb2Z0X3Jlc2V0LA0KKwkJLnNldF9kbWFfc3RlcCA9IGxz
ZGNfY3J0YzFfc2V0X2RtYV9zdGVwLA0KKwkJLmdldF92YmxhbmtfY291bnRlciA9IGxzZGNfY3J0
YzFfZ2V0X3ZibGFua19jb3VudCwNCisJCS5yZXNldCA9IGxzZGNfY3J0YzFfcmVzZXQsDQorCX0s
DQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfcmVzZXQoc3RydWN0IGRybV9jcnRjICpj
cnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7
DQorCWNvbnN0IHN0cnVjdCBsc2RjX2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+aHdfb3BzOw0K
KwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X2NydGNfc3RhdGU7DQorDQorCWlmIChjcnRj
LT5zdGF0ZSkNCisJCWNydGMtPmZ1bmNzLT5hdG9taWNfZGVzdHJveV9zdGF0ZShjcnRjLCBjcnRj
LT5zdGF0ZSk7DQorDQorCXByaXZfY3J0Y19zdGF0ZSA9IGt6YWxsb2Moc2l6ZW9mKCpwcml2X2Ny
dGNfc3RhdGUpLCBHRlBfS0VSTkVMKTsNCisNCisJaWYgKCFwcml2X2NydGNfc3RhdGUpDQorCQlf
X2RybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoY3J0YywgTlVMTCk7DQorCWVsc2UNCisJCV9f
ZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNldChjcnRjLCAmcHJpdl9jcnRjX3N0YXRlLT5iYXNl
KTsNCisNCisJLyoNCisJICogUmVzZXQgdGhlIGNydGMgaGFyZHdhcmUsIHRoaXMgaXMgbmVlZCBm
b3IgUzMgc3VwcG9ydCwNCisJICogb3RoZXJ3aXNlLCB3YWl0IGZvciB2YmxhbmsgdGltZW91dCBt
YXkgaGFwcGVuLg0KKwkgKi8NCisJb3BzLT5yZXNldChsY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyB2
b2lkIGxzZGNfY3J0Y19hdG9taWNfZGVzdHJveV9zdGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMs
DQorCQkJCQkgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxz
ZGNfY3J0Y19zdGF0ZSAqcHJpdl9zdGF0ZSA9IHRvX2xzZGNfY3J0Y19zdGF0ZShzdGF0ZSk7DQor
DQorCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZwcml2X3N0YXRlLT5i
YXNlKTsNCisNCisJa2ZyZWUocHJpdl9zdGF0ZSk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKg0KK2xzZGNfY3J0Y19hdG9taWNfZHVwbGljYXRlX3N0YXRlKHN0cnVjdCBk
cm1fY3J0YyAqY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2NydGNfc3RhdGUgKm5ld19wcml2X3N0
YXRlOw0KKwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpvbGRfcHJpdl9zdGF0ZTsNCisNCisJbmV3
X3ByaXZfc3RhdGUgPSBremFsbG9jKHNpemVvZigqbmV3X3ByaXZfc3RhdGUpLCBHRlBfS0VSTkVM
KTsNCisJaWYgKCFuZXdfcHJpdl9zdGF0ZSkNCisJCXJldHVybiBOVUxMOw0KKw0KKwlfX2RybV9h
dG9taWNfaGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlKGNydGMsICZuZXdfcHJpdl9zdGF0ZS0+
YmFzZSk7DQorDQorCW9sZF9wcml2X3N0YXRlID0gdG9fbHNkY19jcnRjX3N0YXRlKGNydGMtPnN0
YXRlKTsNCisNCisJbWVtY3B5KCZuZXdfcHJpdl9zdGF0ZS0+cHBhcm1zLCAmb2xkX3ByaXZfc3Rh
dGUtPnBwYXJtcywNCisJICAgICAgIHNpemVvZihuZXdfcHJpdl9zdGF0ZS0+cHBhcm1zKSk7DQor
DQorCXJldHVybiAmbmV3X3ByaXZfc3RhdGUtPmJhc2U7DQorfQ0KKw0KK3N0YXRpYyB1MzIgbHNk
Y19jcnRjX2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMpDQorew0KKwlz
dHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJY29uc3Qgc3Ry
dWN0IGxzZGNfY3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQorCXJldHVybiBv
cHMtPmdldF92YmxhbmtfY291bnRlcihsY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19j
cnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJc3RydWN0IGxz
ZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCWNvbnN0IHN0cnVjdCBsc2Rj
X2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+aHdfb3BzOw0KKw0KKwlvcHMtPmVuYWJsZV92Ymxh
bmsobGNydGMpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRj
X2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXN0cnVjdCBsc2Rj
X2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19j
cnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisNCisJb3BzLT5kaXNhYmxlX3ZibGFu
ayhsY3J0Yyk7DQorfQ0KKw0KKy8qDQorICogQ1JUQyByZWxhdGVkIGRlYnVnZnMNCisgKg0KKyAq
IFByaW1hcnkgcGxhbmVzIGFuZCBjdXJzb3IgcGxhbmVzIGFyZSBhbHNvIGJlbG9uZyB0byB0aGUg
Q1JUQyBmb3Igb3VyIGNhc2UsDQorICogc28gYWxzbyBhcHBlbmQgb3RoZXIgcmVnaXN0ZXJzIHRv
IGhlcmUsIGZvciBzYWtlIG9mIGNvbnZlbmllbnQuDQorICovDQorDQorI2RlZmluZSBSRUdfREVG
KHJlZykgeyBcDQorCS5uYW1lID0gX19zdHJpbmdpZnlfMShMU0RDXyMjcmVnIyNfUkVHKSwgXA0K
Kwkub2Zmc2V0ID0gTFNEQ18jI3JlZyMjX1JFRywgXA0KK30NCisNCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGxzZGNfcmVnMzIgbHNkY19jcnRjX3JlZ3NfYXJyYXlbMl1bMjFdID0gew0KKwlbMF0gPSB7
DQorCQlSRUdfREVGKENSVEMwX0NGRyksDQorCQlSRUdfREVGKENSVEMwX0ZCX09SSUdJTiksDQor
CQlSRUdfREVGKENSVEMwX1BBTkVMX0NPTkYpLA0KKwkJUkVHX0RFRihDUlRDMF9IRElTUExBWSks
DQorCQlSRUdfREVGKENSVEMwX0hTWU5DKSwNCisJCVJFR19ERUYoQ1JUQzBfVkRJU1BMQVkpLA0K
KwkJUkVHX0RFRihDUlRDMF9WU1lOQyksDQorCQlSRUdfREVGKENSVEMwX0dBTU1BX0lOREVYKSwN
CisJCVJFR19ERUYoQ1JUQzBfR0FNTUFfREFUQSksDQorCQlSRUdfREVGKENSVEMwX1NZTkNfREVW
SUFUSU9OKSwNCisJCVJFR19ERUYoQ1JUQzBfVlNZTkNfQ09VTlRFUiksDQorCQlSRUdfREVGKENS
VEMwX1NDQU5fUE9TKSwNCisJCVJFR19ERUYoQ1JUQzBfU1RSSURFKSwNCisJCVJFR19ERUYoQ1JU
QzBfRkIxX0FERFJfSEkpLA0KKwkJUkVHX0RFRihDUlRDMF9GQjFfQUREUl9MTyksDQorCQlSRUdf
REVGKENSVEMwX0ZCMF9BRERSX0hJKSwNCisJCVJFR19ERUYoQ1JUQzBfRkIwX0FERFJfTE8pLA0K
KwkJUkVHX0RFRihDVVJTT1IwX0NGRyksDQorCQlSRUdfREVGKENVUlNPUjBfUE9TSVRJT04pLA0K
KwkJUkVHX0RFRihDVVJTT1IwX0JHX0NPTE9SKSwNCisJCVJFR19ERUYoQ1VSU09SMF9GR19DT0xP
UiksDQorCX0sDQorCVsxXSA9IHsNCisJCVJFR19ERUYoQ1JUQzFfQ0ZHKSwNCisJCVJFR19ERUYo
Q1JUQzFfRkJfT1JJR0lOKSwNCisJCVJFR19ERUYoQ1JUQzFfUEFORUxfQ09ORiksDQorCQlSRUdf
REVGKENSVEMxX0hESVNQTEFZKSwNCisJCVJFR19ERUYoQ1JUQzFfSFNZTkMpLA0KKwkJUkVHX0RF
RihDUlRDMV9WRElTUExBWSksDQorCQlSRUdfREVGKENSVEMxX1ZTWU5DKSwNCisJCVJFR19ERUYo
Q1JUQzFfR0FNTUFfSU5ERVgpLA0KKwkJUkVHX0RFRihDUlRDMV9HQU1NQV9EQVRBKSwNCisJCVJF
R19ERUYoQ1JUQzFfU1lOQ19ERVZJQVRJT04pLA0KKwkJUkVHX0RFRihDUlRDMV9WU1lOQ19DT1VO
VEVSKSwNCisJCVJFR19ERUYoQ1JUQzFfU0NBTl9QT1MpLA0KKwkJUkVHX0RFRihDUlRDMV9TVFJJ
REUpLA0KKwkJUkVHX0RFRihDUlRDMV9GQjFfQUREUl9ISSksDQorCQlSRUdfREVGKENSVEMxX0ZC
MV9BRERSX0xPKSwNCisJCVJFR19ERUYoQ1JUQzFfRkIwX0FERFJfSEkpLA0KKwkJUkVHX0RFRihD
UlRDMV9GQjBfQUREUl9MTyksDQorCQlSRUdfREVGKENVUlNPUjFfQ0ZHKSwNCisJCVJFR19ERUYo
Q1VSU09SMV9QT1NJVElPTiksDQorCQlSRUdfREVGKENVUlNPUjFfQkdfQ09MT1IpLA0KKwkJUkVH
X0RFRihDVVJTT1IxX0ZHX0NPTE9SKSwNCisJfSwNCit9Ow0KKw0KK3N0YXRpYyBpbnQgbHNkY19j
cnRjX3Nob3dfcmVncyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmFyZykNCit7DQorCXN0cnVj
dCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1faW5mb19ub2RlICopbS0+cHJpdmF0
ZTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSAoc3RydWN0IGxzZGNfY3J0YyAqKW5vZGUt
PmluZm9fZW50LT5kYXRhOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRl
djsNCisJdW5zaWduZWQgaW50IGk7DQorDQorCWZvciAoaSA9IDA7IGkgPCBsY3J0Yy0+bnJlZzsg
aSsrKSB7DQorCQljb25zdCBzdHJ1Y3QgbHNkY19yZWczMiAqcHJlZyA9ICZsY3J0Yy0+cHJlZ1tp
XTsNCisJCXUzMiBvZmZzZXQgPSBwcmVnLT5vZmZzZXQ7DQorDQorCQlzZXFfcHJpbnRmKG0sICIl
cyAoMHglMDR4KTogMHglMDh4XG4iLA0KKwkJCSAgIHByZWctPm5hbWUsIG9mZnNldCwgbHNkY19y
cmVnMzIobGRldiwgb2Zmc2V0KSk7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRp
YyBpbnQgbHNkY19jcnRjX3Nob3dfc2Nhbl9wb3NpdGlvbihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1f
aW5mb19ub2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSAoc3Ry
dWN0IGxzZGNfY3J0YyAqKW5vZGUtPmluZm9fZW50LT5kYXRhOw0KKwljb25zdCBzdHJ1Y3QgbHNk
Y19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisJaW50IHgsIHk7DQorDQorCW9w
cy0+Z2V0X3NjYW5fcG9zKGxjcnRjLCAmeCwgJnkpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICJzY2Fu
b3V0IHBvc2l0aW9uOiB4OiAlMDh1LCB5OiAlMDh1XG4iLCB4LCB5KTsNCisNCisJcmV0dXJuIDA7
DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50ZXIoc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9k
ZSA9IChzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjID0gKHN0cnVjdCBsc2RjX2NydGMgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisJ
Y29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQor
CWlmIChvcHMtPmdldF92YmxhbmtfY291bnRlcikNCisJCXNlcV9wcmludGYobSwgIiVzIHZibGFu
ayBjb3VudGVyOiAlMDh1XG5cbiIsDQorCQkJICAgbGNydGMtPmJhc2UubmFtZSwNCisJCQkgICBv
cHMtPmdldF92YmxhbmtfY291bnRlcihsY3J0YykpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQor
c3RhdGljIGludCBsc2RjX3BpeHBsbF9zaG93X2Nsb2NrKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9p
ZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUgPSAoc3RydWN0IGRybV9p
bmZvX25vZGUgKiltLT5wcml2YXRlOw0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IChzdHJ1
Y3QgbHNkY19jcnRjICopbm9kZS0+aW5mb19lbnQtPmRhdGE7DQorCXN0cnVjdCBsc2RjX3BpeHBs
bCAqcGl4cGxsID0gJmxjcnRjLT5waXhwbGw7DQorCWNvbnN0IHN0cnVjdCBsc2RjX3BpeHBsbF9m
dW5jcyAqZnVuY3MgPSBwaXhwbGwtPmZ1bmNzOw0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAm
bGNydGMtPmJhc2U7DQorCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmNydGMtPnN0
YXRlLT5tb2RlOw0KKwlzdHJ1Y3QgZHJtX3ByaW50ZXIgcHJpbnRlciA9IGRybV9zZXFfZmlsZV9w
cmludGVyKG0pOw0KKwl1bnNpZ25lZCBpbnQgb3V0X2toejsNCisNCisJb3V0X2toeiA9IGZ1bmNz
LT5nZXRfcmF0ZShwaXhwbGwpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICIlczogJWR4JWRAJWRcbiIs
IGNydGMtPm5hbWUsDQorCQkgICBtb2RlLT5oZGlzcGxheSwgbW9kZS0+dmRpc3BsYXksIGRybV9t
b2RlX3ZyZWZyZXNoKG1vZGUpKTsNCisNCisJc2VxX3ByaW50ZihtLCAiUGl4ZWwgY2xvY2sgcmVx
dWlyZWQ6ICVkIGtIelxuIiwgbW9kZS0+Y2xvY2spOw0KKwlzZXFfcHJpbnRmKG0sICJBY3R1YWwg
ZnJlcXVlbmN5IG91dHB1dDogJXUga0h6XG4iLCBvdXRfa2h6KTsNCisJc2VxX3ByaW50ZihtLCAi
RGlmZjogJWQga0h6XG4iLCBvdXRfa2h6IC0gbW9kZS0+Y2xvY2spOw0KKw0KKwlmdW5jcy0+cHJp
bnQocGl4cGxsLCAmcHJpbnRlcik7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgc3Ry
dWN0IGRybV9pbmZvX2xpc3QgbHNkY19jcnRjX2RlYnVnZnNfbGlzdFsyXVs0XSA9IHsNCisJWzBd
ID0gew0KKwkJeyAicmVncyIsIGxzZGNfY3J0Y19zaG93X3JlZ3MsIDAsIE5VTEwgfSwNCisJCXsg
InBpeGNsayIsIGxzZGNfcGl4cGxsX3Nob3dfY2xvY2ssIDAsIE5VTEwgfSwNCisJCXsgInNjYW5w
b3MiLCBsc2RjX2NydGNfc2hvd19zY2FuX3Bvc2l0aW9uLCAwLCBOVUxMIH0sDQorCQl7ICJ2Ymxh
bmtzIiwgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50ZXIsIDAsIE5VTEwgfSwNCisJfSwNCisJ
WzFdID0gew0KKwkJeyAicmVncyIsIGxzZGNfY3J0Y19zaG93X3JlZ3MsIDAsIE5VTEwgfSwNCisJ
CXsgInBpeGNsayIsIGxzZGNfcGl4cGxsX3Nob3dfY2xvY2ssIDAsIE5VTEwgfSwNCisJCXsgInNj
YW5wb3MiLCBsc2RjX2NydGNfc2hvd19zY2FuX3Bvc2l0aW9uLCAwLCBOVUxMIH0sDQorCQl7ICJ2
YmxhbmtzIiwgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50ZXIsIDAsIE5VTEwgfSwNCisJfSwN
Cit9Ow0KKw0KKy8qIG9wZXJhdGUgbWFudWFsbHkgKi8NCisNCitzdGF0aWMgaW50IGxzZGNfY3J0
Y19tYW5fb3Bfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpDQorew0KKwlzZXFf
cHV0cyhtLCAic29mdF9yZXNldDogc29mdCByZXNldCB0aGlzIENSVENcbiIpOw0KKwlzZXFfcHV0
cyhtLCAiZW5hYmxlOiBlbmFibGUgdGhpcyBDUlRDXG4iKTsNCisJc2VxX3B1dHMobSwgImRpc2Fi
bGU6IGRpc2FibGUgdGhpcyBDUlRDXG4iKTsNCisJc2VxX3B1dHMobSwgImZsaXA6IHRyaWdnZXIg
dGhlIHBhZ2UgZmxpcFxuIik7DQorCXNlcV9wdXRzKG0sICJjbG9uZTogY2xvbmUgdGhlIGFub3Ro
ZXIgY3J0YyB3aXRoIGhhcmR3YXJlIGxvZ2ljXG4iKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0K
K3N0YXRpYyBpbnQgbHNkY19jcnRjX21hbl9vcF9vcGVuKHN0cnVjdCBpbm9kZSAqaW5vZGUsIHN0
cnVjdCBmaWxlICpmaWxlKQ0KK3sNCisJc3RydWN0IGRybV9jcnRjICpjcnRjID0gaW5vZGUtPmlf
cHJpdmF0ZTsNCisNCisJcmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUsIGxzZGNfY3J0Y19tYW5fb3Bf
c2hvdywgY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyBzc2l6ZV90IGxzZGNfY3J0Y19tYW5fb3Bfd3Jp
dGUoc3RydWN0IGZpbGUgKmZpbGUsDQorCQkJCSAgICAgIGNvbnN0IGNoYXIgX191c2VyICp1YnVm
LA0KKwkJCQkgICAgICBzaXplX3QgbGVuLA0KKwkJCQkgICAgICBsb2ZmX3QgKm9mZnApDQorew0K
KwlzdHJ1Y3Qgc2VxX2ZpbGUgKm0gPSBmaWxlLT5wcml2YXRlX2RhdGE7DQorCXN0cnVjdCBsc2Rj
X2NydGMgKmxjcnRjID0gbS0+cHJpdmF0ZTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19v
cHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQorCWNoYXIgYnVmWzE2XTsNCisNCisJaWYgKGxl
biA+IHNpemVvZihidWYpIC0gMSkNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwlpZiAoY29weV9m
cm9tX3VzZXIoYnVmLCB1YnVmLCBsZW4pKQ0KKwkJcmV0dXJuIC1FRkFVTFQ7DQorDQorCWJ1Zlts
ZW5dID0gJ1wwJzsNCisNCisJaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgInNvZnRfcmVzZXQiKSkNCisJ
CW9wcy0+c29mdF9yZXNldChsY3J0Yyk7DQorCWVsc2UgaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgImVu
YWJsZSIpKQ0KKwkJb3BzLT5lbmFibGUobGNydGMpOw0KKwllbHNlIGlmIChzeXNmc19zdHJlcShi
dWYsICJkaXNhYmxlIikpDQorCQlvcHMtPmRpc2FibGUobGNydGMpOw0KKwllbHNlIGlmIChzeXNm
c19zdHJlcShidWYsICJmbGlwIikpDQorCQlvcHMtPmZsaXAobGNydGMpOw0KKwllbHNlIGlmIChz
eXNmc19zdHJlcShidWYsICJjbG9uZSIpKQ0KKwkJb3BzLT5jbG9uZShsY3J0Yyk7DQorDQorCXJl
dHVybiBsZW47DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVyYXRpb25zIGxz
ZGNfY3J0Y19tYW5fb3BfZm9wcyA9IHsNCisJLm93bmVyID0gVEhJU19NT0RVTEUsDQorCS5vcGVu
ID0gbHNkY19jcnRjX21hbl9vcF9vcGVuLA0KKwkucmVhZCA9IHNlcV9yZWFkLA0KKwkubGxzZWVr
ID0gc2VxX2xzZWVrLA0KKwkucmVsZWFzZSA9IHNpbmdsZV9yZWxlYXNlLA0KKwkud3JpdGUgPSBs
c2RjX2NydGNfbWFuX29wX3dyaXRlLA0KK307DQorDQorc3RhdGljIGludCBsc2RjX2NydGNfbGF0
ZV9yZWdpc3RlcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kaXNw
bGF5X3BpcGUgKmRpc3BpcGUgPSBjcnRjX3RvX2Rpc3BsYXlfcGlwZShjcnRjKTsNCisJc3RydWN0
IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCXN0cnVjdCBkcm1fbWlu
b3IgKm1pbm9yID0gY3J0Yy0+ZGV2LT5wcmltYXJ5Ow0KKwl1bnNpZ25lZCBpbnQgaW5kZXggPSBk
aXNwaXBlLT5pbmRleDsNCisJdW5zaWduZWQgaW50IGk7DQorDQorCWxjcnRjLT5wcmVnID0gbHNk
Y19jcnRjX3JlZ3NfYXJyYXlbaW5kZXhdOw0KKwlsY3J0Yy0+bnJlZyA9IEFSUkFZX1NJWkUobHNk
Y19jcnRjX3JlZ3NfYXJyYXlbaW5kZXhdKTsNCisJbGNydGMtPnBfaW5mb19saXN0ID0gbHNkY19j
cnRjX2RlYnVnZnNfbGlzdFtpbmRleF07DQorCWxjcnRjLT5uX2luZm9fbGlzdCA9IEFSUkFZX1NJ
WkUobHNkY19jcnRjX2RlYnVnZnNfbGlzdFtpbmRleF0pOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwg
bGNydGMtPm5faW5mb19saXN0OyArK2kpDQorCQlsY3J0Yy0+cF9pbmZvX2xpc3RbaV0uZGF0YSA9
IGxjcnRjOw0KKw0KKwlkcm1fZGVidWdmc19jcmVhdGVfZmlsZXMobGNydGMtPnBfaW5mb19saXN0
LA0KKwkJCQkgbGNydGMtPm5faW5mb19saXN0LA0KKwkJCQkgY3J0Yy0+ZGVidWdmc19lbnRyeSwN
CisJCQkJIG1pbm9yKTsNCisNCisJLyogc3VwcG9ydGVkIG1hbnVhbCBvcGVyYXRpb25zICovDQor
CWRlYnVnZnNfY3JlYXRlX2ZpbGUoIm9wcyIsIDA2NDQsIGNydGMtPmRlYnVnZnNfZW50cnksIGxj
cnRjLA0KKwkJCSAgICAmbHNkY19jcnRjX21hbl9vcF9mb3BzKTsNCisNCisJcmV0dXJuIDA7DQor
fQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0Y19hdG9taWNfcHJpbnRfc3RhdGUoc3RydWN0IGRy
bV9wcmludGVyICpwLA0KKwkJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUp
DQorew0KKwljb25zdCBzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X3N0YXRlOw0KKwljb25z
dCBzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtczsNCisNCisJcHJpdl9zdGF0ZSA9IGNv
bnRhaW5lcl9vZl9jb25zdChzdGF0ZSwgc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSwgYmFzZSk7DQor
CXBwYXJtcyA9ICZwcml2X3N0YXRlLT5wcGFybXM7DQorDQorCWRybV9wcmludGYocCwgIlx0SW5w
dXQgY2xvY2sgZGl2aWRlciA9ICV1XG4iLCBwcGFybXMtPmRpdl9yZWYpOw0KKwlkcm1fcHJpbnRm
KHAsICJcdE1lZGl1bSBjbG9jayBNdWx0aXBsaWVyID0gJXVcbiIsIHBwYXJtcy0+bG9vcGMpOw0K
Kwlkcm1fcHJpbnRmKHAsICJcdE91dHB1dCBjbG9jayBkaXZpZGVyID0gJXVcbiIsIHBwYXJtcy0+
ZGl2X291dCk7DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNfZnVuY3MgbHM3
YTEwMDBfY3J0Y19mdW5jcyA9IHsNCisJLnJlc2V0ID0gbHNkY19jcnRjX3Jlc2V0LA0KKwkuZGVz
dHJveSA9IGRybV9jcnRjX2NsZWFudXAsDQorCS5zZXRfY29uZmlnID0gZHJtX2F0b21pY19oZWxw
ZXJfc2V0X2NvbmZpZywNCisJLnBhZ2VfZmxpcCA9IGRybV9hdG9taWNfaGVscGVyX3BhZ2VfZmxp
cCwNCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWljX2R1cGxpY2F0
ZV9zdGF0ZSwNCisJLmF0b21pY19kZXN0cm95X3N0YXRlID0gbHNkY19jcnRjX2F0b21pY19kZXN0
cm95X3N0YXRlLA0KKwkubGF0ZV9yZWdpc3RlciA9IGxzZGNfY3J0Y19sYXRlX3JlZ2lzdGVyLA0K
KwkuZW5hYmxlX3ZibGFuayA9IGxzZGNfY3J0Y19lbmFibGVfdmJsYW5rLA0KKwkuZGlzYWJsZV92
YmxhbmsgPSBsc2RjX2NydGNfZGlzYWJsZV92YmxhbmssDQorCS5nZXRfdmJsYW5rX3RpbWVzdGFt
cCA9IGRybV9jcnRjX3ZibGFua19oZWxwZXJfZ2V0X3ZibGFua190aW1lc3RhbXAsDQorCS5hdG9t
aWNfcHJpbnRfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWljX3ByaW50X3N0YXRlLA0KK307DQorDQor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBsczdhMjAwMF9jcnRjX2Z1bmNzID0g
ew0KKwkucmVzZXQgPSBsc2RjX2NydGNfcmVzZXQsDQorCS5kZXN0cm95ID0gZHJtX2NydGNfY2xl
YW51cCwNCisJLnNldF9jb25maWcgPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29uZmlnLA0KKwku
cGFnZV9mbGlwID0gZHJtX2F0b21pY19oZWxwZXJfcGFnZV9mbGlwLA0KKwkuYXRvbWljX2R1cGxp
Y2F0ZV9zdGF0ZSA9IGxzZGNfY3J0Y19hdG9taWNfZHVwbGljYXRlX3N0YXRlLA0KKwkuYXRvbWlj
X2Rlc3Ryb3lfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWljX2Rlc3Ryb3lfc3RhdGUsDQorCS5sYXRl
X3JlZ2lzdGVyID0gbHNkY19jcnRjX2xhdGVfcmVnaXN0ZXIsDQorCS5nZXRfdmJsYW5rX2NvdW50
ZXIgPSBsc2RjX2NydGNfZ2V0X3ZibGFua19jb3VudGVyLA0KKwkuZW5hYmxlX3ZibGFuayA9IGxz
ZGNfY3J0Y19lbmFibGVfdmJsYW5rLA0KKwkuZGlzYWJsZV92YmxhbmsgPSBsc2RjX2NydGNfZGlz
YWJsZV92YmxhbmssDQorCS5nZXRfdmJsYW5rX3RpbWVzdGFtcCA9IGRybV9jcnRjX3ZibGFua19o
ZWxwZXJfZ2V0X3ZibGFua190aW1lc3RhbXAsDQorCS5hdG9taWNfcHJpbnRfc3RhdGUgPSBsc2Rj
X2NydGNfYXRvbWljX3ByaW50X3N0YXRlLA0KK307DQorDQorc3RhdGljIGVudW0gZHJtX21vZGVf
c3RhdHVzDQorbHNkY19jcnRjX21vZGVfdmFsaWQoc3RydWN0IGRybV9jcnRjICpjcnRjLCBjb25z
dCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkNCit7DQorCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2ID0gY3J0Yy0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2Rj
KGRkZXYpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19kZXNjICpkZXNjcCA9IGxkZXYtPmRlc2NwOw0K
Kwl1bnNpZ25lZCBpbnQgcGl0Y2g7DQorDQorCWlmIChtb2RlLT5oZGlzcGxheSA+IGRlc2NwLT5t
YXhfd2lkdGgpDQorCQlyZXR1cm4gTU9ERV9CQURfSFZBTFVFOw0KKw0KKwlpZiAobW9kZS0+dmRp
c3BsYXkgPiBkZXNjcC0+bWF4X2hlaWdodCkNCisJCXJldHVybiBNT0RFX0JBRF9WVkFMVUU7DQor
DQorCWlmIChtb2RlLT5jbG9jayA+IGRlc2NwLT5tYXhfcGl4ZWxfY2xrKSB7DQorCQlkcm1fZGJn
X2ttcyhkZGV2LCAibW9kZSAlZHglZCwgcGl4ZWwgY2xvY2s9JWQgaXMgdG9vIGhpZ2hcbiIsDQor
CQkJICAgIG1vZGUtPmhkaXNwbGF5LCBtb2RlLT52ZGlzcGxheSwgbW9kZS0+Y2xvY2spOw0KKwkJ
cmV0dXJuIE1PREVfQ0xPQ0tfSElHSDsNCisJfQ0KKw0KKwkvKiA0IGZvciBEUk1fRk9STUFUX1hS
R0I4ODg4ICovDQorCXBpdGNoID0gbW9kZS0+aGRpc3BsYXkgKiA0Ow0KKw0KKwlpZiAocGl0Y2gg
JSBkZXNjcC0+cGl0Y2hfYWxpZ24pIHsNCisJCWRybV9kYmdfa21zKGRkZXYsICJhbGlnbmVkIHRv
ICV1IGJ5dGVzIGlzIHJlcXVpcmVkOiAldVxuIiwNCisJCQkgICAgZGVzY3AtPnBpdGNoX2FsaWdu
LCBwaXRjaCk7DQorCQlyZXR1cm4gTU9ERV9CQURfV0lEVEg7DQorCX0NCisNCisJcmV0dXJuIE1P
REVfT0s7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19waXhwbGxfYXRvbWljX2NoZWNrKHN0cnVj
dCBkcm1fY3J0YyAqY3J0YywNCisJCQkJICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqc3RhdGUp
DQorew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJ
c3RydWN0IGxzZGNfcGl4cGxsICpwaXhwbGwgPSAmbGNydGMtPnBpeHBsbDsNCisJY29uc3Qgc3Ry
dWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpwZnVuY3MgPSBwaXhwbGwtPmZ1bmNzOw0KKwlzdHJ1Y3Qg
bHNkY19jcnRjX3N0YXRlICpwcml2X3N0YXRlID0gdG9fbHNkY19jcnRjX3N0YXRlKHN0YXRlKTsN
CisJdW5zaWduZWQgaW50IGNsb2NrID0gc3RhdGUtPm1vZGUuY2xvY2s7DQorCWludCByZXQ7DQor
DQorCXJldCA9IHBmdW5jcy0+Y29tcHV0ZShwaXhwbGwsIGNsb2NrLCAmcHJpdl9zdGF0ZS0+cHBh
cm1zKTsNCisJaWYgKHJldCkgew0KKwkJZHJtX3dhcm4oY3J0Yy0+ZGV2LCAiZmluZCBQTEwgcGFy
bXMgZm9yICV1a0h6IGZhaWxlZFxuIiwgY2xvY2spOw0KKwkJcmV0dXJuIC1FSU5WQUw7DQorCX0N
CisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX2hlbHBlcl9hdG9t
aWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLA0KKwkJCQkJIHN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0Y19zdGF0ZSA9
IGRybV9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsNCisNCisJaWYgKCFj
cnRjX3N0YXRlLT5lbmFibGUpDQorCQlyZXR1cm4gMDsNCisNCisJcmV0dXJuIGxzZGNfcGl4cGxs
X2F0b21pY19jaGVjayhjcnRjLCBjcnRjX3N0YXRlKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNk
Y19jcnRjX21vZGVfc2V0X25vZmIoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJc3RydWN0
IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCWNvbnN0IHN0cnVjdCBs
c2RjX2NydGNfaHdfb3BzICpjcnRjX2h3X29wcyA9IGxjcnRjLT5od19vcHM7DQorCXN0cnVjdCBs
c2RjX3BpeHBsbCAqcGl4cGxsID0gJmxjcnRjLT5waXhwbGw7DQorCWNvbnN0IHN0cnVjdCBsc2Rj
X3BpeHBsbF9mdW5jcyAqcGl4cGxsX2Z1bmNzID0gcGl4cGxsLT5mdW5jczsNCisJc3RydWN0IGRy
bV9jcnRjX3N0YXRlICpzdGF0ZSA9IGNydGMtPnN0YXRlOw0KKwlzdHJ1Y3QgZHJtX2Rpc3BsYXlf
bW9kZSAqbW9kZSA9ICZzdGF0ZS0+bW9kZTsNCisJc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSAqcHJp
dl9zdGF0ZSA9IHRvX2xzZGNfY3J0Y19zdGF0ZShzdGF0ZSk7DQorDQorCXBpeHBsbF9mdW5jcy0+
dXBkYXRlKHBpeHBsbCwgJnByaXZfc3RhdGUtPnBwYXJtcyk7DQorDQorCWlmIChjcnRjX2h3X29w
cy0+c2V0X2RtYV9zdGVwKSB7DQorCQl1bnNpZ25lZCBpbnQgd2lkdGhfaW5fYnl0ZXMgPSBtb2Rl
LT5oZGlzcGxheSAqIDQ7DQorCQllbnVtIGxzZGNfZG1hX3N0ZXBzIGRtYV9zdGVwOw0KKw0KKwkJ
LyoNCisJCSAqIFVzaW5nIGxhcmdlIGRtYSBzdGVwIGFzIG11Y2ggYXMgcG9zc2libGUsIGZvciBp
bXByb3ZpbmcNCisJCSAqIGhhcmR3YXJlIERNQSBlZmZpY2llbmN5Lg0KKwkJICovDQorCQlpZiAo
d2lkdGhfaW5fYnl0ZXMgJSAyNTYgPT0gMCkNCisJCQlkbWFfc3RlcCA9IExTRENfRE1BX1NURVBf
MjU2X0JZVEVTOw0KKwkJZWxzZSBpZiAod2lkdGhfaW5fYnl0ZXMgJSAxMjggPT0gMCkNCisJCQlk
bWFfc3RlcCA9IExTRENfRE1BX1NURVBfMTI4X0JZVEVTOw0KKwkJZWxzZSBpZiAod2lkdGhfaW5f
Ynl0ZXMgJSA2NCA9PSAwKQ0KKwkJCWRtYV9zdGVwID0gTFNEQ19ETUFfU1RFUF82NF9CWVRFUzsN
CisJCWVsc2UgIC8qIHdpZHRoX2luX2J5dGVzICUgMzIgPT0gMCAqLw0KKwkJCWRtYV9zdGVwID0g
TFNEQ19ETUFfU1RFUF8zMl9CWVRFUzsNCisNCisJCWNydGNfaHdfb3BzLT5zZXRfZG1hX3N0ZXAo
bGNydGMsIGRtYV9zdGVwKTsNCisJfQ0KKw0KKwljcnRjX2h3X29wcy0+c2V0X21vZGUobGNydGMs
IG1vZGUpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfc2VuZF92Ymxhbmsoc3RydWN0
IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBjcnRjLT5k
ZXY7DQorCXVuc2lnbmVkIGxvbmcgZmxhZ3M7DQorDQorCWlmICghY3J0Yy0+c3RhdGUgfHwgIWNy
dGMtPnN0YXRlLT5ldmVudCkNCisJCXJldHVybjsNCisNCisJZHJtX2RiZyhkZGV2LCAic2VuZCB2
YmxhbmsgbWFudWFsbHlcbiIpOw0KKw0KKwlzcGluX2xvY2tfaXJxc2F2ZSgmZGRldi0+ZXZlbnRf
bG9jaywgZmxhZ3MpOw0KKwlkcm1fY3J0Y19zZW5kX3ZibGFua19ldmVudChjcnRjLCBjcnRjLT5z
dGF0ZS0+ZXZlbnQpOw0KKwljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOw0KKwlzcGluX3VubG9j
a19pcnFyZXN0b3JlKCZkZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7DQorfQ0KKw0KK3N0YXRpYyB2
b2lkIGxzZGNfY3J0Y19hdG9taWNfZW5hYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJ
ICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19jcnRj
X2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisNCisJZHJtX2NydGNfdmJsYW5rX29uKGNy
dGMpOw0KKw0KKwlkcm1fZGJnKGNydGMtPmRldiwgIiVzIGVuYWJsZVxuIiwgY3J0Yy0+bmFtZSk7
DQorDQorCW9wcy0+ZW5hYmxlKGxjcnRjKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRj
X2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJICAgICBzdHJ1Y3Qg
ZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9
IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19vcHMgKm9w
cyA9IGxjcnRjLT5od19vcHM7DQorDQorCWRybV9jcnRjX3ZibGFua19vZmYoY3J0Yyk7DQorDQor
CW9wcy0+ZGlzYWJsZShsY3J0Yyk7DQorDQorCWRybV9kYmcoY3J0Yy0+ZGV2LCAiJXMgZGlzYWJs
ZVxuIiwgY3J0Yy0+bmFtZSk7DQorDQorCS8qDQorCSAqIE1ha2Ugc3VyZSB3ZSBpc3N1ZSBhIHZi
bGFuayBldmVudCBhZnRlciBkaXNhYmxpbmcgdGhlIENSVEMgaWYNCisJICogc29tZW9uZSB3YXMg
d2FpdGluZyBpdC4NCisJICovDQorCWxzZGNfY3J0Y19zZW5kX3ZibGFuayhjcnRjKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19jcnRjX2F0b21pY19mbHVzaChzdHJ1Y3QgZHJtX2NydGMgKmNy
dGMsDQorCQkJCSAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXNwaW5f
bG9ja19pcnEoJmNydGMtPmRldi0+ZXZlbnRfbG9jayk7DQorCWlmIChjcnRjLT5zdGF0ZS0+ZXZl
bnQpIHsNCisJCWlmIChkcm1fY3J0Y192YmxhbmtfZ2V0KGNydGMpID09IDApDQorCQkJZHJtX2Ny
dGNfYXJtX3ZibGFua19ldmVudChjcnRjLCBjcnRjLT5zdGF0ZS0+ZXZlbnQpOw0KKwkJZWxzZQ0K
KwkJCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2ZW50KGNydGMsIGNydGMtPnN0YXRlLT5ldmVudCk7
DQorCQljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOw0KKwl9DQorCXNwaW5fdW5sb2NrX2lycSgm
Y3J0Yy0+ZGV2LT5ldmVudF9sb2NrKTsNCit9DQorDQorc3RhdGljIGJvb2wgbHNkY19jcnRjX2dl
dF9zY2Fub3V0X3Bvc2l0aW9uKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJCSAgIGJvb2wg
aW5fdmJsYW5rX2lycSwNCisJCQkJCSAgIGludCAqdnBvcywNCisJCQkJCSAgIGludCAqaHBvcywN
CisJCQkJCSAgIGt0aW1lX3QgKnN0aW1lLA0KKwkJCQkJICAga3RpbWVfdCAqZXRpbWUsDQorCQkJ
CQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkNCit7DQorCXN0cnVjdCBs
c2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBzdHJ1Y3QgbHNk
Y19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisJaW50IHZzdywgdmJwLCB2YWN0
aXZlX3N0YXJ0LCB2YWN0aXZlX2VuZCwgdmZwX2VuZDsNCisJaW50IHgsIHk7DQorDQorCXZzdyA9
IG1vZGUtPmNydGNfdnN5bmNfZW5kIC0gbW9kZS0+Y3J0Y192c3luY19zdGFydDsNCisJdmJwID0g
bW9kZS0+Y3J0Y192dG90YWwgLSBtb2RlLT5jcnRjX3ZzeW5jX2VuZDsNCisNCisJdmFjdGl2ZV9z
dGFydCA9IHZzdyArIHZicCArIDE7DQorCXZhY3RpdmVfZW5kID0gdmFjdGl2ZV9zdGFydCArIG1v
ZGUtPmNydGNfdmRpc3BsYXk7DQorDQorCS8qIGxhc3Qgc2NhbiBsaW5lIGJlZm9yZSBWU1lOQyAq
Lw0KKwl2ZnBfZW5kID0gbW9kZS0+Y3J0Y192dG90YWw7DQorDQorCWlmIChzdGltZSkNCisJCSpz
dGltZSA9IGt0aW1lX2dldCgpOw0KKw0KKwlvcHMtPmdldF9zY2FuX3BvcyhsY3J0YywgJngsICZ5
KTsNCisNCisJaWYgKHkgPiB2YWN0aXZlX2VuZCkNCisJCXkgPSB5IC0gdmZwX2VuZCAtIHZhY3Rp
dmVfc3RhcnQ7DQorCWVsc2UNCisJCXkgLT0gdmFjdGl2ZV9zdGFydDsNCisNCisJKnZwb3MgPSB5
Ow0KKwkqaHBvcyA9IHg7DQorDQorCWlmIChldGltZSkNCisJCSpldGltZSA9IGt0aW1lX2dldCgp
Ow0KKw0KKwlyZXR1cm4gdHJ1ZTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0
Y19oZWxwZXJfZnVuY3MgbHNkY19jcnRjX2hlbHBlcl9mdW5jcyA9IHsNCisJLm1vZGVfdmFsaWQg
PSBsc2RjX2NydGNfbW9kZV92YWxpZCwNCisJLm1vZGVfc2V0X25vZmIgPSBsc2RjX2NydGNfbW9k
ZV9zZXRfbm9mYiwNCisJLmF0b21pY19lbmFibGUgPSBsc2RjX2NydGNfYXRvbWljX2VuYWJsZSwN
CisJLmF0b21pY19kaXNhYmxlID0gbHNkY19jcnRjX2F0b21pY19kaXNhYmxlLA0KKwkuYXRvbWlj
X2NoZWNrID0gbHNkY19jcnRjX2hlbHBlcl9hdG9taWNfY2hlY2ssDQorCS5hdG9taWNfZmx1c2gg
PSBsc2RjX2NydGNfYXRvbWljX2ZsdXNoLA0KKwkuZ2V0X3NjYW5vdXRfcG9zaXRpb24gPSBsc2Rj
X2NydGNfZ2V0X3NjYW5vdXRfcG9zaXRpb24sDQorfTsNCisNCitpbnQgbHM3YTEwMDBfY3J0Y19p
bml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJICAgICAgIHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwcmltYXJ5LA0KKwkJICAgICAgIHN0
cnVjdCBkcm1fcGxhbmUgKmN1cnNvciwNCisJCSAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpDQor
ew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJaW50
IHJldDsNCisNCisJcmV0ID0gbHNkY19waXhwbGxfaW5pdCgmbGNydGMtPnBpeHBsbCwgZGRldiwg
aW5kZXgpOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKGRkZXYsICJjcnRjIGluaXQgd2l0aCBw
bGwgZmFpbGVkOiAlZFxuIiwgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJbGNydGMt
PmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlsY3J0Yy0+aHdfb3BzID0gJmxzN2ExMDAwX2NydGNf
aHdfb3BzW2luZGV4XTsNCisNCisJcmV0ID0gZHJtX2NydGNfaW5pdF93aXRoX3BsYW5lcyhkZGV2
LA0KKwkJCQkJY3J0YywNCisJCQkJCXByaW1hcnksDQorCQkJCQljdXJzb3IsDQorCQkJCQkmbHM3
YTEwMDBfY3J0Y19mdW5jcywNCisJCQkJCSJDUlRDLSVkIiwNCisJCQkJCWluZGV4KTsNCisJaWYg
KHJldCkgew0KKwkJZHJtX2VycihkZGV2LCAiY3J0YyBpbml0IHdpdGggcGxhbmVzIGZhaWxlZDog
JWRcbiIsIHJldCk7DQorCQlyZXR1cm4gcmV0Ow0KKwl9DQorDQorCWRybV9jcnRjX2hlbHBlcl9h
ZGQoY3J0YywgJmxzZGNfY3J0Y19oZWxwZXJfZnVuY3MpOw0KKw0KKwlyZXQgPSBkcm1fbW9kZV9j
cnRjX3NldF9nYW1tYV9zaXplKGNydGMsIDI1Nik7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0
Ow0KKw0KKwlkcm1fY3J0Y19lbmFibGVfY29sb3JfbWdtdChjcnRjLCAwLCBmYWxzZSwgMjU2KTsN
CisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK2ludCBsczdhMjAwMF9jcnRjX2luaXQoc3RydWN0IGRy
bV9kZXZpY2UgKmRkZXYsDQorCQkgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRjLA0KKwkJICAg
ICAgIHN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnksDQorCQkgICAgICAgc3RydWN0IGRybV9wbGFu
ZSAqY3Vyc29yLA0KKwkJICAgICAgIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBs
c2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwlpbnQgcmV0Ow0KKw0KKwly
ZXQgPSBsc2RjX3BpeHBsbF9pbml0KCZsY3J0Yy0+cGl4cGxsLCBkZGV2LCBpbmRleCk7DQorCWlm
IChyZXQpIHsNCisJCWRybV9lcnIoZGRldiwgImNydGMgaW5pdCB3aXRoIHBsbCBmYWlsZWQ6ICVk
XG4iLCByZXQpOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlsY3J0Yy0+bGRldiA9IHRvX2xz
ZGMoZGRldik7DQorCWxjcnRjLT5od19vcHMgPSAmbHM3YTIwMDBfY3J0Y19od19vcHNbaW5kZXhd
Ow0KKw0KKwlyZXQgPSBkcm1fY3J0Y19pbml0X3dpdGhfcGxhbmVzKGRkZXYsDQorCQkJCQljcnRj
LA0KKwkJCQkJcHJpbWFyeSwNCisJCQkJCWN1cnNvciwNCisJCQkJCSZsczdhMjAwMF9jcnRjX2Z1
bmNzLA0KKwkJCQkJIkNSVEMtJWQiLA0KKwkJCQkJaW5kZXgpOw0KKwlpZiAocmV0KSB7DQorCQlk
cm1fZXJyKGRkZXYsICJjcnRjIGluaXQgd2l0aCBwbGFuZXMgZmFpbGVkOiAlZFxuIiwgcmV0KTsN
CisJCXJldHVybiByZXQ7DQorCX0NCisNCisJZHJtX2NydGNfaGVscGVyX2FkZChjcnRjLCAmbHNk
Y19jcnRjX2hlbHBlcl9mdW5jcyk7DQorDQorCXJldCA9IGRybV9tb2RlX2NydGNfc2V0X2dhbW1h
X3NpemUoY3J0YywgMjU2KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWRybV9j
cnRjX2VuYWJsZV9jb2xvcl9tZ210KGNydGMsIDAsIGZhbHNlLCAyNTYpOw0KKw0KKwlyZXR1cm4g
MDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGVidWdm
cy5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGVidWdmcy5jDQpuZXcgZmlsZSBt
b2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi45YWQyYzVhMGFkZDINCi0tLSAvZGV2L251
bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2RlYnVnZnMuYw0KQEAgLTAs
MCArMSw5MSBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQor
ICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGlt
aXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisNCisjaW5jbHVk
ZSAibHNkY19iZW5jaG1hcmsuaCINCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisjaW5jbHVkZSAi
bHNkY19nZW0uaCINCisjaW5jbHVkZSAibHNkY19wcm9iZS5oIg0KKyNpbmNsdWRlICJsc2RjX3R0
bS5oIg0KKw0KKy8qIGRldmljZSBsZXZlbCBkZWJ1Z2ZzICovDQorDQorc3RhdGljIGludCBsc2Rj
X2lkZW50aWZ5KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRy
bV9pbmZvX25vZGUgKm5vZGUgPSAoc3RydWN0IGRybV9pbmZvX25vZGUgKiltLT5wcml2YXRlOw0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSAoc3RydWN0IGxzZGNfZGV2aWNlICopbm9kZS0+
aW5mb19lbnQtPmRhdGE7DQorCWNvbnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVzYyAqZ2Z4ID0g
dG9fbG9vbmdzb25fZ2Z4KGxkZXYtPmRlc2NwKTsNCisJdTggaW1wbCwgcmV2Ow0KKw0KKwlsb29u
Z3Nvbl9jcHVfZ2V0X3ByaWQoJmltcGwsICZyZXYpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICJSdW5u
aW5nIG9uIGNwdSAweCV4LCBjcHUgcmV2aXNpb246IDB4JXhcbiIsDQorCQkgICBpbXBsLCByZXYp
Ow0KKw0KKwlzZXFfcHJpbnRmKG0sICJDb250YWluZWQgaW46ICVzXG4iLCBnZngtPm1vZGVsKTsN
CisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19zaG93X21tKHN0cnVjdCBz
ZXFfZmlsZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUg
PSAoc3RydWN0IGRybV9pbmZvX25vZGUgKiltLT5wcml2YXRlOw0KKwlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGRldiA9IG5vZGUtPm1pbm9yLT5kZXY7DQorCXN0cnVjdCBkcm1fcHJpbnRlciBwID0gZHJt
X3NlcV9maWxlX3ByaW50ZXIobSk7DQorDQorCWRybV9tbV9wcmludCgmZGRldi0+dm1hX29mZnNl
dF9tYW5hZ2VyLT52bV9hZGRyX3NwYWNlX21tLCAmcCk7DQorDQorCXJldHVybiAwOw0KK30NCisN
CitzdGF0aWMgaW50IGxzZGNfc2hvd19nZnhwbGxfY2xvY2soc3RydWN0IHNlcV9maWxlICptLCB2
b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSA9IChzdHJ1Y3QgZHJt
X2luZm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IChz
dHJ1Y3QgbHNkY19kZXZpY2UgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisJc3RydWN0IGRybV9w
cmludGVyIHByaW50ZXIgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsNCisJc3RydWN0IGxvb25n
c29uX2dmeHBsbCAqZ2Z4cGxsID0gbGRldi0+Z2Z4cGxsOw0KKw0KKwlnZnhwbGwtPmZ1bmNzLT5w
cmludChnZnhwbGwsICZwcmludGVyLCB0cnVlKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0
YXRpYyBpbnQgbHNkY19zaG93X2JlbmNobWFyayhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmFy
ZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1faW5mb19u
b2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gKHN0cnVjdCBs
c2RjX2RldmljZSAqKW5vZGUtPmluZm9fZW50LT5kYXRhOw0KKwlzdHJ1Y3QgZHJtX3ByaW50ZXIg
cHJpbnRlciA9IGRybV9zZXFfZmlsZV9wcmludGVyKG0pOw0KKw0KKwlsc2RjX3Nob3dfYmVuY2ht
YXJrX2NvcHkobGRldiwgJnByaW50ZXIpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGlj
IHN0cnVjdCBkcm1faW5mb19saXN0IGxzZGNfZGVidWdmc19saXN0W10gPSB7DQorCXsgImNoaXBz
IiwgICAgICAgbHNkY19pZGVudGlmeSwgMCwgTlVMTCB9LA0KKwl7ICJjbG9ja3MiLCAgICAgIGxz
ZGNfc2hvd19nZnhwbGxfY2xvY2ssIDAsIE5VTEwgfSwNCisJeyAibW0iLCAgICAgICAgICBsc2Rj
X3Nob3dfbW0sIDAsIE5VTEwgfSwNCisJeyAiYm9zIiwgICAgICAgICBsc2RjX3Nob3dfYnVmZmVy
X29iamVjdCwgMCwgTlVMTCB9LA0KKwl7ICJiZW5jaG1hcmsiLCAgIGxzZGNfc2hvd19iZW5jaG1h
cmssIDAsIE5VTEwgfSwNCit9Ow0KKw0KK3ZvaWQgbHNkY19kZWJ1Z2ZzX2luaXQoc3RydWN0IGRy
bV9taW5vciAqbWlub3IpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IG1pbm9yLT5k
ZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCXVuc2ln
bmVkIGludCBOID0gQVJSQVlfU0laRShsc2RjX2RlYnVnZnNfbGlzdCk7DQorCXVuc2lnbmVkIGlu
dCBpOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgTjsgKytpKQ0KKwkJbHNkY19kZWJ1Z2ZzX2xpc3Rb
aV0uZGF0YSA9IGxkZXY7DQorDQorCWRybV9kZWJ1Z2ZzX2NyZWF0ZV9maWxlcyhsc2RjX2RlYnVn
ZnNfbGlzdCwNCisJCQkJIE4sDQorCQkJCSBtaW5vci0+ZGVidWdmc19yb290LA0KKwkJCQkgbWlu
b3IpOw0KKw0KKwlsc2RjX3R0bV9kZWJ1Z2ZzX2luaXQobGRldik7DQorfQ0KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2RldmljZS5jIGIvZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfZGV2aWNlLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAw
MDAwMDAwMDAuLmI0MTUyZjIyOGJlYg0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfZGV2aWNlLmMNCkBAIC0wLDAgKzEsMTA0IEBADQorLy8gU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMg
TG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1
ZGUgPGxpbnV4L3BjaS5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKw0KK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgbHNkY19rbXNfZnVuY3MgbHM3YTEwMDBfa21zX2Z1bmNzID0gew0KKwkuY3Jl
YXRlX2kyYyA9IGxzZGNfY3JlYXRlX2kyY19jaGFuLA0KKwkuaXJxX2hhbmRsZXIgPSBsczdhMTAw
MF9kY19pcnFfaGFuZGxlciwNCisJLm91dHB1dF9pbml0ID0gbHM3YTEwMDBfb3V0cHV0X2luaXQs
DQorCS5jdXJzb3JfcGxhbmVfaW5pdCA9IGxzN2ExMDAwX2N1cnNvcl9wbGFuZV9pbml0LA0KKwku
cHJpbWFyeV9wbGFuZV9pbml0ID0gbHNkY19wcmltYXJ5X3BsYW5lX2luaXQsDQorCS5jcnRjX2lu
aXQgPSBsczdhMTAwMF9jcnRjX2luaXQsDQorfTsNCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGxz
ZGNfa21zX2Z1bmNzIGxzN2EyMDAwX2ttc19mdW5jcyA9IHsNCisJLmNyZWF0ZV9pMmMgPSBsc2Rj
X2NyZWF0ZV9pMmNfY2hhbiwNCisJLmlycV9oYW5kbGVyID0gbHM3YTIwMDBfZGNfaXJxX2hhbmRs
ZXIsDQorCS5vdXRwdXRfaW5pdCA9IGxzN2EyMDAwX291dHB1dF9pbml0LA0KKwkuY3Vyc29yX3Bs
YW5lX2luaXQgPSBsczdhMjAwMF9jdXJzb3JfcGxhbmVfaW5pdCwNCisJLnByaW1hcnlfcGxhbmVf
aW5pdCA9IGxzZGNfcHJpbWFyeV9wbGFuZV9pbml0LA0KKwkuY3J0Y19pbml0ID0gbHM3YTIwMDBf
Y3J0Y19pbml0LA0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVz
YyBsczdhMTAwMF9nZnggPSB7DQorCS5kYyA9IHsNCisJCS5udW1fb2ZfY3J0YyA9IDIsDQorCQku
bWF4X3BpeGVsX2NsayA9IDIwMDAwMCwNCisJCS5tYXhfd2lkdGggPSAyMDQ4LA0KKwkJLm1heF9o
ZWlnaHQgPSAyMDQ4LA0KKwkJLm51bV9vZl9od19jdXJzb3IgPSAxLA0KKwkJLmh3X2N1cnNvcl93
ID0gMzIsDQorCQkuaHdfY3Vyc29yX2ggPSAzMiwNCisJCS5waXRjaF9hbGlnbiA9IDI1NiwNCisJ
CS5tY19iaXRzID0gNDAsDQorCQkuaGFzX3ZibGFua19jb3VudGVyID0gZmFsc2UsDQorCQkuZnVu
Y3MgPSAmbHM3YTEwMDBfa21zX2Z1bmNzLA0KKwl9LA0KKwkuY29uZl9yZWdfYmFzZSA9IExTN0Ex
MDAwX0NPTkZfUkVHX0JBU0UsDQorCS5nZnhwbGwgPSB7DQorCQkucmVnX29mZnNldCA9IExTN0Ex
MDAwX1BMTF9HRlhfUkVHLA0KKwkJLnJlZ19zaXplID0gOCwNCisJfSwNCisJLnBpeHBsbCA9IHsN
CisJCVswXSA9IHsNCisJCQkucmVnX29mZnNldCA9IExTN0ExMDAwX1BJWFBMTDBfUkVHLA0KKwkJ
CS5yZWdfc2l6ZSA9IDgsDQorCQl9LA0KKwkJWzFdID0gew0KKwkJCS5yZWdfb2Zmc2V0ID0gTFM3
QTEwMDBfUElYUExMMV9SRUcsDQorCQkJLnJlZ19zaXplID0gOCwNCisJCX0sDQorCX0sDQorCS5j
aGlwX2lkID0gQ0hJUF9MUzdBMTAwMCwNCisJLm1vZGVsID0gIkxTN0ExMDAwIGJyaWRnZSBjaGlw
c2V0IiwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4X2Rlc2MgbHM3
YTIwMDBfZ2Z4ID0gew0KKwkuZGMgPSB7DQorCQkubnVtX29mX2NydGMgPSAyLA0KKwkJLm1heF9w
aXhlbF9jbGsgPSAzNTAwMDAsDQorCQkubWF4X3dpZHRoID0gNDA5NiwNCisJCS5tYXhfaGVpZ2h0
ID0gNDA5NiwNCisJCS5udW1fb2ZfaHdfY3Vyc29yID0gMiwNCisJCS5od19jdXJzb3JfdyA9IDY0
LA0KKwkJLmh3X2N1cnNvcl9oID0gNjQsDQorCQkucGl0Y2hfYWxpZ24gPSA2NCwNCisJCS5tY19i
aXRzID0gNDAsIC8qIFN1cHBvcnQgNDggYnV0IHVzaW5nIDQwIGZvciBiYWNrd2FyZCBjb21wYXRp
YmlsaXR5ICovDQorCQkuaGFzX3ZibGFua19jb3VudGVyID0gdHJ1ZSwNCisJCS5mdW5jcyA9ICZs
czdhMjAwMF9rbXNfZnVuY3MsDQorCX0sDQorCS5jb25mX3JlZ19iYXNlID0gTFM3QTIwMDBfQ09O
Rl9SRUdfQkFTRSwNCisJLmdmeHBsbCA9IHsNCisJCS5yZWdfb2Zmc2V0ID0gTFM3QTIwMDBfUExM
X0dGWF9SRUcsDQorCQkucmVnX3NpemUgPSA4LA0KKwl9LA0KKwkucGl4cGxsID0gew0KKwkJWzBd
ID0gew0KKwkJCS5yZWdfb2Zmc2V0ID0gTFM3QTIwMDBfUElYUExMMF9SRUcsDQorCQkJLnJlZ19z
aXplID0gOCwNCisJCX0sDQorCQlbMV0gPSB7DQorCQkJLnJlZ19vZmZzZXQgPSBMUzdBMjAwMF9Q
SVhQTEwxX1JFRywNCisJCQkucmVnX3NpemUgPSA4LA0KKwkJfSwNCisJfSwNCisJLmNoaXBfaWQg
PSBDSElQX0xTN0EyMDAwLA0KKwkubW9kZWwgPSAiTFM3QTIwMDAgYnJpZGdlIGNoaXBzZXQiLA0K
K307DQorDQorY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqDQorbHNkY19kZXZpY2VfcHJvYmUoc3Ry
dWN0IHBjaV9kZXYgKnBkZXYsIGVudW0gbG9vbmdzb25fY2hpcF9pZCBjaGlwX2lkKQ0KK3sNCisJ
aWYgKGNoaXBfaWQgPT0gQ0hJUF9MUzdBMTAwMCkNCisJCXJldHVybiAmbHM3YTEwMDBfZ2Z4LmRj
Ow0KKw0KKwlpZiAoY2hpcF9pZCA9PSBDSElQX0xTN0EyMDAwKQ0KKwkJcmV0dXJuICZsczdhMjAw
MF9nZnguZGM7DQorDQorCXJldHVybiBFUlJfUFRSKC1FTk9ERVYpOw0KK30NCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kcnYuYyBiL2RyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX2Rydi5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAw
MDAwLi45OGUyYzI4Zjg4NmYNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX2Rydi5jDQpAQCAtMCwwICsxLDQ5NSBAQA0KKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29u
IFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51
eC9wY2kuaD4NCisNCisjaW5jbHVkZSA8dmlkZW8vbm9tb2Rlc2V0Lmg+DQorDQorI2luY2x1ZGUg
PGRybS9kcm1fYXBlcnR1cmUuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMuaD4NCisjaW5j
bHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZHJ2Lmg+
DQorI2luY2x1ZGUgPGRybS9kcm1fZmJkZXZfZ2VuZXJpYy5oPg0KKyNpbmNsdWRlIDxkcm0vZHJt
X2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9pb2N0bC5oPg0K
KyNpbmNsdWRlIDxkcm0vZHJtX21vZGVzZXRfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRybS9kcm1f
cHJvYmVfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+DQorDQorI2luY2x1
ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfZ2VtLmgiDQorI2luY2x1ZGUgImxzZGNf
aTJjLmgiDQorI2luY2x1ZGUgImxzZGNfaXJxLmgiDQorI2luY2x1ZGUgImxzZGNfb3V0cHV0Lmgi
DQorI2luY2x1ZGUgImxzZGNfcHJvYmUuaCINCisjaW5jbHVkZSAibHNkY190dG0uaCINCisNCisj
ZGVmaW5lIERSSVZFUl9BVVRIT1IgICAgICAgICAgICJTdWkgSmluZ2ZlbmcgPHN1aWppbmdmZW5n
QGxvb25nc29uLmNuPiINCisjZGVmaW5lIERSSVZFUl9OQU1FICAgICAgICAgICAgICJsb29uZ3Nv
biINCisjZGVmaW5lIERSSVZFUl9ERVNDICAgICAgICAgICAgICJkcm0gZHJpdmVyIGZvciBsb29u
Z3NvbiBncmFwaGljcyINCisjZGVmaW5lIERSSVZFUl9EQVRFICAgICAgICAgICAgICIyMDIyMDcw
MSINCisjZGVmaW5lIERSSVZFUl9NQUpPUiAgICAgICAgICAgIDENCisjZGVmaW5lIERSSVZFUl9N
SU5PUiAgICAgICAgICAgIDANCisjZGVmaW5lIERSSVZFUl9QQVRDSExFVkVMICAgICAgIDANCisN
CitERUZJTkVfRFJNX0dFTV9GT1BTKGxzZGNfZ2VtX2ZvcHMpOw0KKw0KK3N0YXRpYyBjb25zdCBz
dHJ1Y3QgZHJtX2RyaXZlciBsc2RjX2RybV9kcml2ZXIgPSB7DQorCS5kcml2ZXJfZmVhdHVyZXMg
PSBEUklWRVJfTU9ERVNFVCB8IERSSVZFUl9SRU5ERVIgfCBEUklWRVJfR0VNIHwgRFJJVkVSX0FU
T01JQywNCisJLmZvcHMgPSAmbHNkY19nZW1fZm9wcywNCisNCisJLm5hbWUgPSBEUklWRVJfTkFN
RSwNCisJLmRlc2MgPSBEUklWRVJfREVTQywNCisJLmRhdGUgPSBEUklWRVJfREFURSwNCisJLm1h
am9yID0gRFJJVkVSX01BSk9SLA0KKwkubWlub3IgPSBEUklWRVJfTUlOT1IsDQorCS5wYXRjaGxl
dmVsID0gRFJJVkVSX1BBVENITEVWRUwsDQorDQorCS5kZWJ1Z2ZzX2luaXQgPSBsc2RjX2RlYnVn
ZnNfaW5pdCwNCisJLmR1bWJfY3JlYXRlID0gbHNkY19kdW1iX2NyZWF0ZSwNCisJLmR1bWJfbWFw
X29mZnNldCA9IGxzZGNfZHVtYl9tYXBfb2Zmc2V0LA0KKwkucHJpbWVfaGFuZGxlX3RvX2ZkID0g
ZHJtX2dlbV9wcmltZV9oYW5kbGVfdG9fZmQsDQorCS5wcmltZV9mZF90b19oYW5kbGUgPSBkcm1f
Z2VtX3ByaW1lX2ZkX3RvX2hhbmRsZSwNCisJLmdlbV9wcmltZV9pbXBvcnRfc2dfdGFibGUgPSBs
c2RjX3ByaW1lX2ltcG9ydF9zZ190YWJsZSwNCisJLmdlbV9wcmltZV9tbWFwID0gZHJtX2dlbV9w
cmltZV9tbWFwLA0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdf
ZnVuY3MgbHNkY19tb2RlX2NvbmZpZ19mdW5jcyA9IHsNCisJLmZiX2NyZWF0ZSA9IGRybV9nZW1f
ZmJfY3JlYXRlLA0KKwkuYXRvbWljX2NoZWNrID0gZHJtX2F0b21pY19oZWxwZXJfY2hlY2ssDQor
CS5hdG9taWNfY29tbWl0ID0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LA0KK307DQorDQorLyog
RGlzcGxheSByZWxhdGVkICovDQorDQorc3RhdGljIGludCBsc2RjX21vZGVzZXRfaW5pdChzdHJ1
Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQorCQkJICAgICB1bnNpZ25lZCBpbnQgbnVtX2NydGMsDQor
CQkJICAgICBjb25zdCBzdHJ1Y3QgbHNkY19rbXNfZnVuY3MgKmZ1bmNzKQ0KK3sNCisJc3RydWN0
IGRybV9kZXZpY2UgKmRkZXYgPSAmbGRldi0+YmFzZTsNCisJc3RydWN0IGxzZGNfZGlzcGxheV9w
aXBlICpkaXNwaXBlOw0KKwl1bnNpZ25lZCBpbnQgaTsNCisJaW50IHJldDsNCisNCisJZm9yIChp
ID0gMDsgaSA8IG51bV9jcnRjOyBpKyspIHsNCisJCWRpc3BpcGUgPSAmbGRldi0+ZGlzcGlwZVtp
XTsNCisNCisJCS8qIFdlIG5lZWQgYSBpbmRleCBiZWZvcmUgY3J0YyBpcyBpbml0aWFsaXplZCAq
Lw0KKwkJZGlzcGlwZS0+aW5kZXggPSBpOw0KKw0KKwkJcmV0ID0gZnVuY3MtPmNyZWF0ZV9pMmMo
ZGRldiwgZGlzcGlwZSwgaSk7DQorCQlpZiAocmV0KQ0KKwkJCXJldHVybiByZXQ7DQorCX0NCisN
CisJZm9yIChpID0gMDsgaSA8IG51bV9jcnRjOyBpKyspIHsNCisJCXN0cnVjdCBpMmNfYWRhcHRl
ciAqZGRjID0gTlVMTDsNCisNCisJCWRpc3BpcGUgPSAmbGRldi0+ZGlzcGlwZVtpXTsNCisJCWlm
IChkaXNwaXBlLT5saTJjKQ0KKwkJCWRkYyA9ICZkaXNwaXBlLT5saTJjLT5hZGFwdGVyOw0KKw0K
KwkJcmV0ID0gZnVuY3MtPm91dHB1dF9pbml0KGRkZXYsIGRpc3BpcGUsIGRkYywgaSk7DQorCQlp
ZiAocmV0KQ0KKwkJCXJldHVybiByZXQ7DQorDQorCQlsZGV2LT5udW1fb3V0cHV0Kys7DQorCX0N
CisNCisJZm9yIChpID0gMDsgaSA8IG51bV9jcnRjOyBpKyspIHsNCisJCWRpc3BpcGUgPSAmbGRl
di0+ZGlzcGlwZVtpXTsNCisNCisJCXJldCA9IGZ1bmNzLT5wcmltYXJ5X3BsYW5lX2luaXQoZGRl
diwgJmRpc3BpcGUtPnByaW1hcnkuYmFzZSwgaSk7DQorCQlpZiAocmV0KQ0KKwkJCXJldHVybiBy
ZXQ7DQorDQorCQlyZXQgPSBmdW5jcy0+Y3Vyc29yX3BsYW5lX2luaXQoZGRldiwgJmRpc3BpcGUt
PmN1cnNvci5iYXNlLCBpKTsNCisJCWlmIChyZXQpDQorCQkJcmV0dXJuIHJldDsNCisNCisJCXJl
dCA9IGZ1bmNzLT5jcnRjX2luaXQoZGRldiwNCisJCQkJICAgICAgICZkaXNwaXBlLT5jcnRjLmJh
c2UsDQorCQkJCSAgICAgICAmZGlzcGlwZS0+cHJpbWFyeS5iYXNlLA0KKwkJCQkgICAgICAgJmRp
c3BpcGUtPmN1cnNvci5iYXNlLA0KKwkJCQkgICAgICAgaSk7DQorCQlpZiAocmV0KQ0KKwkJCXJl
dHVybiByZXQ7DQorCX0NCisNCisJZHJtX2luZm8oZGRldiwgInRvdGFsICV1IG91dHB1dHNcbiIs
IGxkZXYtPm51bV9vdXRwdXQpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fbW9kZV9jb25maWdfaGVscGVyX2Z1bmNzDQorbHNkY19tb2RlX2NvbmZpZ19o
ZWxwZXJfZnVuY3MgPSB7DQorCS5hdG9taWNfY29tbWl0X3RhaWwgPSBkcm1fYXRvbWljX2hlbHBl
cl9jb21taXRfdGFpbCwNCit9Ow0KKw0KK3N0YXRpYyBpbnQgbHNkY19tb2RlX2NvbmZpZ19pbml0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCQkgY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAq
ZGVzY3ApDQorew0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBkcm1tX21vZGVfY29uZmlnX2luaXQo
ZGRldik7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkZGV2LT5tb2RlX2NvbmZp
Zy5mdW5jcyA9ICZsc2RjX21vZGVfY29uZmlnX2Z1bmNzOw0KKwlkZGV2LT5tb2RlX2NvbmZpZy5t
aW5fd2lkdGggPSAxOw0KKwlkZGV2LT5tb2RlX2NvbmZpZy5taW5faGVpZ2h0ID0gMTsNCisJZGRl
di0+bW9kZV9jb25maWcubWF4X3dpZHRoID0gZGVzY3AtPm1heF93aWR0aCAqIExTRENfTlVNX0NS
VEM7DQorCWRkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQgPSBkZXNjcC0+bWF4X2hlaWdodCAq
IExTRENfTlVNX0NSVEM7DQorCWRkZXYtPm1vZGVfY29uZmlnLnByZWZlcnJlZF9kZXB0aCA9IDI0
Ow0KKwlkZGV2LT5tb2RlX2NvbmZpZy5wcmVmZXJfc2hhZG93ID0gMTsNCisNCisJZGRldi0+bW9k
ZV9jb25maWcuY3Vyc29yX3dpZHRoID0gZGVzY3AtPmh3X2N1cnNvcl9oOw0KKwlkZGV2LT5tb2Rl
X2NvbmZpZy5jdXJzb3JfaGVpZ2h0ID0gZGVzY3AtPmh3X2N1cnNvcl9oOw0KKw0KKwkvKiBJbmRp
Y2F0ZXMgc3VwcG9ydCBmb3IgaW1tZWRpYXRlIGZsaXAgKi8NCisJZGRldi0+bW9kZV9jb25maWcu
YXN5bmNfcGFnZV9mbGlwID0gdHJ1ZTsNCisNCisJZGRldi0+bW9kZV9jb25maWcuaGVscGVyX3By
aXZhdGUgPSAmbHNkY19tb2RlX2NvbmZpZ19oZWxwZXJfZnVuY3M7DQorDQorCWlmIChkZXNjcC0+
aGFzX3ZibGFua19jb3VudGVyKQ0KKwkJZGRldi0+bWF4X3ZibGFua19jb3VudCA9IDB4ZmZmZmZm
ZmY7DQorDQorCXJldHVybiByZXQ7DQorfQ0KKw0KKy8qDQorICogVGhlIEdQVSBhbmQgZGlzcGxh
eSBjb250cm9sbGVyIGluIExTN0ExMDAwL0xTN0EyMDAwIGFyZSBzZXBhcmF0ZWQNCisgKiBQQ0lF
IGRldmljZXMsIHRoZXkgYXJlIHR3byBkZXZpY2VzIG5vdCBvbmUuIFRoZSBEQyBkb2VzIG5vdCBo
YXMgYQ0KKyAqIGRlZGljYXRlIFZSQU0gYmFyLCBiZWNhdXNlIHRoZSBCSU9TIGVuZ2luZWVyIGNo
b29zZSB0byBhc3NpZ24gdGhlDQorICogVlJBTSB0byB0aGUgR1BVIGRldmljZS4gU2FkbHksIGFm
dGVyIHllYXJzIGFwcGxpY2F0aW9uLCB0aGlzIGZvcm0NCisgKiBhcyBhIGNvbnZlbnRpb24gZm9y
IGxvb25nc29uIGludGVncmF0ZWQgZ3JhcGhpY3MuIEJhciAyIG9mIHRoZSBHUFUNCisgKiBkZXZp
Y2UgY29udGFpbiB0aGUgYmFzZSBhZGRyZXNzIGFuZCBzaXplIG9mIHRoZSBWUkFNLCBib3RoIHRo
ZSBHUFUNCisgKiBhbmQgdGhlIERDIGNhbiBhY2Nlc3MgdGhlIG9uLWJvYXJkIFZSQU0gYXMgbG9u
ZyBhcyB0aGUgRE1BIGFkZHJlc3MNCisgKiBlbWl0dGVkIGZhbGwgaW4gW2Jhc2UsIGJhc2UgKyBz
aXplKS4NCisgKi8NCitzdGF0aWMgaW50IGxzZGNfZ2V0X2RlZGljYXRlZF92cmFtKHN0cnVjdCBs
c2RjX2RldmljZSAqbGRldiwNCisJCQkJICAgc3RydWN0IHBjaV9kZXYgKnBkZXZfZGMsDQorCQkJ
CSAgIGNvbnN0IHN0cnVjdCBsc2RjX2Rlc2MgKmRlc2NwKQ0KK3sNCisJc3RydWN0IGRybV9kZXZp
Y2UgKmRkZXYgPSAmbGRldi0+YmFzZTsNCisJc3RydWN0IHBjaV9kZXYgKnBkZXZfZ3B1Ow0KKwly
ZXNvdXJjZV9zaXplX3QgYmFzZSwgc2l6ZTsNCisNCisJLyoNCisJICogVGhlIEdQVSBoYXMgMDA6
MDYuMCBhcyBpdHMgQkRGLCB3aGlsZSB0aGUgREMgaGFzIDAwOjA2LjEsDQorCSAqIFRoaXMgaXMg
c3VyZSBmb3IgTFM3QTEwMDAsIExTN0EyMDAwIGFuZCBMUzJLMjAwMC4NCisJICovDQorCXBkZXZf
Z3B1ID0gcGNpX2dldF9kb21haW5fYnVzX2FuZF9zbG90KHBjaV9kb21haW5fbnIocGRldl9kYy0+
YnVzKSwNCisJCQkJCSAgICAgICBwZGV2X2RjLT5idXMtPm51bWJlciwNCisJCQkJCSAgICAgICBQ
Q0lfREVWRk4oNiwgMCkpOw0KKwlpZiAoIXBkZXZfZ3B1KSB7DQorCQlkcm1fZXJyKGRkZXYsICJO
byBHUFUgZGV2aWNlLCB0aGVuIG5vIFZSQU1cbiIpOw0KKwkJcmV0dXJuIC1FTk9ERVY7DQorCX0N
CisNCisJYmFzZSA9IHBjaV9yZXNvdXJjZV9zdGFydChwZGV2X2dwdSwgMik7DQorCXNpemUgPSBw
Y2lfcmVzb3VyY2VfbGVuKHBkZXZfZ3B1LCAyKTsNCisNCisJbGRldi0+dnJhbV9iYXNlID0gYmFz
ZTsNCisJbGRldi0+dnJhbV9zaXplID0gc2l6ZTsNCisJbGRldi0+Z3B1ID0gcGRldl9ncHU7DQor
DQorCWRybV9pbmZvKGRkZXYsICJkZWRpY2F0ZWQgdnJhbSBzdGFydDogMHglbGx4LCBzaXplOiAl
dU1CXG4iLA0KKwkJICh1NjQpYmFzZSwgKHUzMikoc2l6ZSA+PiAyMCkpOw0KKw0KKwlyZXR1cm4g
MDsNCit9DQorDQorc3RhdGljIHN0cnVjdCBsc2RjX2RldmljZSAqDQorbHNkY19jcmVhdGVfZGV2
aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LA0KKwkJICAgY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAq
ZGVzY3AsDQorCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2RyaXZlciAqZHJ2KQ0KK3sNCisJc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldjsNCisJaW50IHJl
dDsNCisNCisJbGRldiA9IGRldm1fZHJtX2Rldl9hbGxvYygmcGRldi0+ZGV2LCBkcnYsIHN0cnVj
dCBsc2RjX2RldmljZSwgYmFzZSk7DQorCWlmIChJU19FUlIobGRldikpDQorCQlyZXR1cm4gbGRl
djsNCisNCisJZGRldiA9ICZsZGV2LT5iYXNlOw0KKw0KKwlsZGV2LT5kZXNjcCA9IGRlc2NwOw0K
Kw0KKwlsb29uZ3Nvbl9nZnhwbGxfY3JlYXRlKGRkZXYsICZsZGV2LT5nZnhwbGwpOw0KKw0KKwly
ZXQgPSBsc2RjX2dldF9kZWRpY2F0ZWRfdnJhbShsZGV2LCBwZGV2LCBkZXNjcCk7DQorCWlmIChy
ZXQpIHsNCisJCWRybV9lcnIoZGRldiwgIkluaXQgVlJBTSBmYWlsZWQ6ICVkXG4iLCByZXQpOw0K
KwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisJfQ0KKw0KKwlyZXQgPSBkcm1fYXBlcnR1cmVfcmVt
b3ZlX2NvbmZsaWN0aW5nX2ZyYW1lYnVmZmVycyhsZGV2LT52cmFtX2Jhc2UsDQorCQkJCQkJCSAg
IGxkZXYtPnZyYW1fc2l6ZSwNCisJCQkJCQkJICAgZHJ2KTsNCisJaWYgKHJldCkgew0KKwkJZHJt
X2VycihkZGV2LCAicmVtb3ZlIGZpcm13YXJlIGZyYW1lYnVmZmVycyBmYWlsZWQ6ICVkXG4iLCBy
ZXQpOw0KKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisJfQ0KKw0KKwlyZXQgPSBsc2RjX3R0bV9p
bml0KGxkZXYpOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKGRkZXYsICJtZW1vcnkgbWFuYWdl
ciBpbml0IGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9
DQorDQorCWxzZGNfZ2VtX2luaXQoZGRldik7DQorDQorCS8qIEJBUiAwIG9mIHRoZSBEQyBkZXZp
Y2UgY29udGFpbiByZWdpc3RlcnMgYmFzZSBhZGRyZXNzICovDQorCWxkZXYtPnJlZ19iYXNlID0g
cGNpbV9pb21hcChwZGV2LCAwLCAwKTsNCisJaWYgKCFsZGV2LT5yZWdfYmFzZSkNCisJCXJldHVy
biBFUlJfUFRSKC1FTk9ERVYpOw0KKw0KKwlzcGluX2xvY2tfaW5pdCgmbGRldi0+cmVnbG9jayk7
DQorDQorCXJldCA9IGxzZGNfbW9kZV9jb25maWdfaW5pdChkZGV2LCBkZXNjcCk7DQorCWlmIChy
ZXQpDQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKw0KKwlyZXQgPSBsc2RjX21vZGVzZXRfaW5p
dChsZGV2LCBkZXNjcC0+bnVtX29mX2NydGMsIGRlc2NwLT5mdW5jcyk7DQorCWlmIChyZXQpDQor
CQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKw0KKwlkcm1fbW9kZV9jb25maWdfcmVzZXQoZGRldik7
DQorDQorCXJldCA9IGRybV92YmxhbmtfaW5pdChkZGV2LCBkZXNjcC0+bnVtX29mX2NydGMpOw0K
KwlpZiAocmV0KQ0KKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisNCisJZHJtX2ttc19oZWxwZXJf
cG9sbF9pbml0KGRkZXYpOw0KKw0KKwlyZXR1cm4gbGRldjsNCit9DQorDQorc3RhdGljIGludCBs
c2RjX3BjaV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgY29uc3Qgc3RydWN0IHBjaV9kZXZp
Y2VfaWQgKmVudCkNCit7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2Rlc2MgKmRlc2NwOw0KKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2Ow0KKwlpbnQg
cmV0Ow0KKw0KKwlyZXQgPSBwY2ltX2VuYWJsZV9kZXZpY2UocGRldik7DQorCWlmIChyZXQpDQor
CQlyZXR1cm4gcmV0Ow0KKw0KKwlwY2lfc2V0X21hc3RlcihwZGV2KTsNCisNCisJcmV0ID0gZG1h
X3NldF9tYXNrX2FuZF9jb2hlcmVudCgmcGRldi0+ZGV2LCBETUFfQklUX01BU0soNDApKTsNCisJ
aWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWRlc2NwID0gbHNkY19kZXZpY2VfcHJvYmUo
cGRldiwgZW50LT5kcml2ZXJfZGF0YSk7DQorCWlmIChJU19FUlJfT1JfTlVMTChkZXNjcCkpDQor
CQlyZXR1cm4gLUVOT0RFVjsNCisNCisJZGV2X2luZm8oJnBkZXYtPmRldiwgIkZvdW5kICVzLCBy
ZXZpc2lvbjogJXUiLA0KKwkJIHRvX2xvb25nc29uX2dmeChkZXNjcCktPm1vZGVsLCBwZGV2LT5y
ZXZpc2lvbik7DQorDQorCWxkZXYgPSBsc2RjX2NyZWF0ZV9kZXZpY2UocGRldiwgZGVzY3AsICZs
c2RjX2RybV9kcml2ZXIpOw0KKwlpZiAoSVNfRVJSKGxkZXYpKQ0KKwkJcmV0dXJuIFBUUl9FUlIo
bGRldik7DQorDQorCWxkZXYtPmRjID0gcGRldjsNCisNCisJZGRldiA9ICZsZGV2LT5iYXNlOw0K
Kw0KKwlwY2lfc2V0X2RydmRhdGEocGRldiwgZGRldik7DQorDQorCXJldCA9IGRldm1fcmVxdWVz
dF9pcnEoJnBkZXYtPmRldiwNCisJCQkgICAgICAgcGRldi0+aXJxLA0KKwkJCSAgICAgICBkZXNj
cC0+ZnVuY3MtPmlycV9oYW5kbGVyLA0KKwkJCSAgICAgICBJUlFGX1NIQVJFRCwNCisJCQkgICAg
ICAgZGV2X25hbWUoJnBkZXYtPmRldiksDQorCQkJICAgICAgIGRkZXYpOw0KKwlpZiAocmV0KSB7
DQorCQlkcm1fZXJyKGRkZXYsICJGYWlsZWQgdG8gcmVnaXN0ZXIgaW50ZXJydXB0OiAlZFxuIiwg
cmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJcmV0ID0gZHJtX2Rldl9yZWdpc3Rlcihk
ZGV2LCAwKTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWRybV9mYmRldl9nZW5l
cmljX3NldHVwKGRkZXYsIDMyKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lk
IGxzZGNfcGNpX3JlbW92ZShzdHJ1Y3QgcGNpX2RldiAqcGRldikNCit7DQorCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOw0KKw0KKwlkcm1fZGV2X3VucmVn
aXN0ZXIoZGRldik7DQorCWRybV9hdG9taWNfaGVscGVyX3NodXRkb3duKGRkZXYpOw0KK30NCisN
CitzdGF0aWMgaW50IGxzZGNfZHJtX2ZyZWV6ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldikNCit7
DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCXN0cnVjdCBs
c2RjX2JvICpsYm87DQorCWludCByZXQ7DQorDQorCS8qIHVucGluIGFsbCBvZiBidWZmZXJzIGlu
IHRoZSB2cmFtICovDQorCW11dGV4X2xvY2soJmxkZXYtPmdlbS5tdXRleCk7DQorCWxpc3RfZm9y
X2VhY2hfZW50cnkobGJvLCAmbGRldi0+Z2VtLm9iamVjdHMsIGxpc3QpIHsNCisJCXN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwkJc3RydWN0IHR0bV9yZXNvdXJj
ZSAqcmVzb3VyY2UgPSB0Ym8tPnJlc291cmNlOw0KKwkJdW5zaWduZWQgaW50IHBpbl9jb3VudCA9
IHRiby0+cGluX2NvdW50Ow0KKw0KKwkJZHJtX2RiZyhkZGV2LA0KKwkJCSJib1slcF0sIHNpemU6
ICV6dUtCLCB0eXBlOiAlcywgcGluIGNvdW50OiAldVxuIiwNCisJCQlsYm8sDQorCQkJbHNkY19i
b19zaXplKGxibykgPj4gMTAsDQorCQkJbHNkY19tZW1fdHlwZV90b19zdHIocmVzb3VyY2UtPm1l
bV90eXBlKSwNCisJCQlwaW5fY291bnQpOw0KKw0KKwkJaWYgKCFwaW5fY291bnQpDQorCQkJY29u
dGludWU7DQorDQorCQlpZiAocmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9WUkFNKSB7DQor
CQkJcmV0ID0gbHNkY19ib19yZXNlcnZlKGxibyk7DQorCQkJaWYgKHVubGlrZWx5KHJldCkpIHsN
CisJCQkJZHJtX2VycihkZGV2LCAiYm8gcmVzZXJ2ZSBmYWlsZWQ6ICVkXG4iLCByZXQpOw0KKwkJ
CQljb250aW51ZTsNCisJCQl9DQorDQorCQkJLyoNCisJCQkgKiBGb3IgZG91YmxlIHNjcmVlbiB1
c2FnZSBjYXNlLCBtdWx0aXBsZSBjcnRjIG1heQ0KKwkJCSAqIHJlZmVyZW5jZSB0byB0aGUgc2lu
Z2xlIGdpYW50IGZyYW1lYnVmZmVyIGJvLg0KKwkJCSAqIFRoZSBzaW5nbGUgZ2lhbnQgZmIgYm8g
Z2V0IHBpbm5lZCBieSBtdWx0aXBsZSB0aW1lLg0KKwkJCSAqIHRodXMsIGl0IG5lZWQgdG8gdW5w
aW4gdW50aWwgaXRzIHBpbiBjb3VudGVyIHJlYWNoDQorCQkJICogemVyby4NCisJCQkgKi8NCisJ
CQlkbyB7DQorCQkJCWxzZGNfYm9fdW5waW4obGJvKTsNCisJCQkJLS1waW5fY291bnQ7DQorCQkJ
fSB3aGlsZSAocGluX2NvdW50KTsNCisNCisJCQlsc2RjX2JvX3VucmVzZXJ2ZShsYm8pOw0KKwkJ
fQ0KKwl9DQorCW11dGV4X3VubG9jaygmbGRldi0+Z2VtLm11dGV4KTsNCisNCisJbHNkY19ib19l
dmljdF92cmFtKGRkZXYpOw0KKw0KKwlyZXQgPSBkcm1fbW9kZV9jb25maWdfaGVscGVyX3N1c3Bl
bmQoZGRldik7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fZXJyKGRkZXYsICJmcmVl
emUgZXJyb3I6ICVkIiwgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJcmV0dXJuIDA7
DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19kcm1fcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikN
Cit7DQorCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gdG9fcGNpX2RldihkZXYpOw0KKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiA9IHBjaV9nZXRfZHJ2ZGF0YShwZGV2KTsNCisNCisJcmV0dXJuIGRy
bV9tb2RlX2NvbmZpZ19oZWxwZXJfcmVzdW1lKGRkZXYpOw0KK30NCisNCitzdGF0aWMgaW50IGxz
ZGNfcG1fZnJlZXplKHN0cnVjdCBkZXZpY2UgKmRldikNCit7DQorCXN0cnVjdCBwY2lfZGV2ICpw
ZGV2ID0gdG9fcGNpX2RldihkZXYpOw0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IHBjaV9n
ZXRfZHJ2ZGF0YShwZGV2KTsNCisNCisJcmV0dXJuIGxzZGNfZHJtX2ZyZWV6ZShkZGV2KTsNCit9
DQorDQorc3RhdGljIGludCBsc2RjX3BtX3RoYXcoc3RydWN0IGRldmljZSAqZGV2KQ0KK3sNCisJ
cmV0dXJuIGxzZGNfZHJtX3Jlc3VtZShkZXYpOw0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfcG1f
c3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpDQorew0KKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9
IHRvX3BjaV9kZXYoZGV2KTsNCisJaW50IGVycm9yOw0KKw0KKwllcnJvciA9IGxzZGNfcG1fZnJl
ZXplKGRldik7DQorCWlmIChlcnJvcikNCisJCXJldHVybiBlcnJvcjsNCisNCisJcGNpX3NhdmVf
c3RhdGUocGRldik7DQorCS8qIFNodXQgZG93biB0aGUgZGV2aWNlICovDQorCXBjaV9kaXNhYmxl
X2RldmljZShwZGV2KTsNCisJcGNpX3NldF9wb3dlcl9zdGF0ZShwZGV2LCBQQ0lfRDNob3QpOw0K
Kw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX3BtX3Jlc3VtZShzdHJ1Y3Qg
ZGV2aWNlICpkZXYpDQorew0KKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IHRvX3BjaV9kZXYoZGV2
KTsNCisNCisJcGNpX3NldF9wb3dlcl9zdGF0ZShwZGV2LCBQQ0lfRDApOw0KKw0KKwlwY2lfcmVz
dG9yZV9zdGF0ZShwZGV2KTsNCisNCisJaWYgKHBjaW1fZW5hYmxlX2RldmljZShwZGV2KSkNCisJ
CXJldHVybiAtRUlPOw0KKw0KKwlyZXR1cm4gbHNkY19wbV90aGF3KGRldik7DQorfQ0KKw0KK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyBsc2RjX3BtX29wcyA9IHsNCisJLnN1c3BlbmQg
PSBsc2RjX3BtX3N1c3BlbmQsDQorCS5yZXN1bWUgPSBsc2RjX3BtX3Jlc3VtZSwNCisJLmZyZWV6
ZSA9IGxzZGNfcG1fZnJlZXplLA0KKwkudGhhdyA9IGxzZGNfcG1fdGhhdywNCisJLnBvd2Vyb2Zm
ID0gbHNkY19wbV9mcmVlemUsDQorCS5yZXN0b3JlID0gbHNkY19wbV9yZXN1bWUsDQorfTsNCisN
CitzdGF0aWMgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgbHNkY19wY2lpZF9saXN0W10gPSB7
DQorCXtQQ0lfVkVORE9SX0lEX0xPT05HU09OLCAweDdhMDYsIFBDSV9BTllfSUQsIFBDSV9BTllf
SUQsIDAsIDAsIENISVBfTFM3QTEwMDB9LA0KKwl7UENJX1ZFTkRPUl9JRF9MT09OR1NPTiwgMHg3
YTM2LCBQQ0lfQU5ZX0lELCBQQ0lfQU5ZX0lELCAwLCAwLCBDSElQX0xTN0EyMDAwfSwNCisJezAs
IDAsIDAsIDAsIDAsIDAsIDB9DQorfTsNCisNCitzdGF0aWMgc3RydWN0IHBjaV9kcml2ZXIgbHNk
Y19wY2lfZHJpdmVyID0gew0KKwkubmFtZSA9IERSSVZFUl9OQU1FLA0KKwkuaWRfdGFibGUgPSBs
c2RjX3BjaWlkX2xpc3QsDQorCS5wcm9iZSA9IGxzZGNfcGNpX3Byb2JlLA0KKwkucmVtb3ZlID0g
bHNkY19wY2lfcmVtb3ZlLA0KKwkuZHJpdmVyLnBtID0gJmxzZGNfcG1fb3BzLA0KK307DQorDQor
c3RhdGljIGludCBfX2luaXQgbG9vbmdzb25fbW9kdWxlX2luaXQodm9pZCkNCit7DQorCXN0cnVj
dCBwY2lfZGV2ICpwZGV2ID0gTlVMTDsNCisNCisJaWYgKHZpZGVvX2Zpcm13YXJlX2RyaXZlcnNf
b25seSgpKQ0KKwkJcmV0dXJuIC1FTk9ERVY7DQorDQorCS8qIE11bHRpcGxlIHZpZGVvIGNhcmQg
d29ya2Fyb3VuZCAqLw0KKwl3aGlsZSAoKHBkZXYgPSBwY2lfZ2V0X2NsYXNzKFBDSV9DTEFTU19E
SVNQTEFZX1ZHQSA8PCA4LCBwZGV2KSkpIHsNCisJCWlmIChwZGV2LT52ZW5kb3IgIT0gUENJX1ZF
TkRPUl9JRF9MT09OR1NPTikgew0KKwkJCXByX2luZm8oIkRpc2NyZXRlIGdyYXBoaWMgY2FyZCBk
ZXRlY3RlZCwgYWJvcnRcbiIpOw0KKwkJCXJldHVybiAwOw0KKwkJfQ0KKwl9DQorDQorCXJldHVy
biBwY2lfcmVnaXN0ZXJfZHJpdmVyKCZsc2RjX3BjaV9kcml2ZXIpOw0KK30NCittb2R1bGVfaW5p
dChsb29uZ3Nvbl9tb2R1bGVfaW5pdCk7DQorDQorc3RhdGljIHZvaWQgX19leGl0IGxvb25nc29u
X21vZHVsZV9leGl0KHZvaWQpDQorew0KKwlwY2lfdW5yZWdpc3Rlcl9kcml2ZXIoJmxzZGNfcGNp
X2RyaXZlcik7DQorfQ0KK21vZHVsZV9leGl0KGxvb25nc29uX21vZHVsZV9leGl0KTsNCisNCitN
T0RVTEVfREVWSUNFX1RBQkxFKHBjaSwgbHNkY19wY2lpZF9saXN0KTsNCitNT0RVTEVfQVVUSE9S
KERSSVZFUl9BVVRIT1IpOw0KK01PRFVMRV9ERVNDUklQVElPTihEUklWRVJfREVTQyk7DQorTU9E
VUxFX0xJQ0VOU0UoIkdQTCIpOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nv
bi9sc2RjX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmgNCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjI1NjM2Nzg3MTkxZg0KLS0tIC9k
ZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmgNCkBAIC0w
LDAgKzEsNDUxIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCisv
Kg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9u
IExpbWl0ZWQNCisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19EUlZfSF9fDQorI2RlZmluZSBfX0xT
RENfRFJWX0hfXw0KKw0KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4NCisNCisjaW5jbHVkZSA8ZHJt
L2RybV9jb25uZWN0b3IuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjLmg+DQorI2luY2x1ZGUg
PGRybS9kcm1fZGV2aWNlLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5oPg0KKyNpbmNs
dWRlIDxkcm0vZHJtX2ZpbGUuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZS5oPg0KKyNpbmNs
dWRlIDxkcm0vdHRtL3R0bV9kZXZpY2UuaD4NCisNCisjaW5jbHVkZSAibHNkY19pMmMuaCINCisj
aW5jbHVkZSAibHNkY19pcnEuaCINCisjaW5jbHVkZSAibHNkY19nZnhwbGwuaCINCisjaW5jbHVk
ZSAibHNkY19vdXRwdXQuaCINCisjaW5jbHVkZSAibHNkY19waXhwbGwuaCINCisjaW5jbHVkZSAi
bHNkY19yZWdzLmgiDQorDQorLyogQ3VycmVudGx5LCBhbGwgbG9vbmdzb24gZGlzcGxheSBjb250
cm9sbGVyIGhhcyB0d28gZGlzcGxheSBwaXBlcyAqLw0KKyNkZWZpbmUgTFNEQ19OVU1fQ1JUQyAg
ICAgICAgICAgMg0KKw0KKy8qDQorICogTFM3QTEwMDAvTFM3QTIwMDAgYnJpZGdlIGNoaXBzZXQg
ZnVuY3Rpb24gYXMgc291dGggJiBub3J0aCBvZiB0aGUgTG9vbmdzb24NCisgKiBMUzNBNDAwMC9M
UzNBNTAwMC9MUzNBNjAwMCBDUFUsIHRoZXkgYXJlIGVxdWlwcGVkIHdpdGggb24tYm9hcmQgdmlk
ZW8gUkFNDQorICogdHlwaWNhbGx5LiBXaGlsZSBMUzJLMDUwMC9MUzJLMTAwMC9MUzJLMjAwMCBh
cmUgbG93IGNvc3QgU29DcyB3aGljaCBzaGFyZQ0KKyAqIHRoZSBzeXN0ZW0gUkFNIGFzIHZpZGVv
IFJBTSwgdGhleSBkb24ndCBoYXMgYSBkZWRpYWNhdGVkIFZSQU0uDQorICoNCisgKiBMUzdBMjAw
MCBpbnRlZ3JhdGVkIGEgMzItYml0IEREUjRAMjQwMCB2aWRlbyBtZW10b3J5IGNvbnRyb2xsZXIs
IHdoaWxlDQorICogaXQgaXMganVzdCAxNi1iaXQgRERSMyBmb3IgTFM3QTEwMDAuIExTN0EyMDAw
IGludGVncmF0ZSBMb29uZ3NvbiBzZWxmDQorICogbWFkZWQgTG9vbmdHUFUsIExTN0ExMDAwIGlu
dGVncmF0ZSBHQzEwMDAgZHVlIHRvIGhpc3RvcmljYWwgcmVhc29ucy4NCisgKg0KKyAqIFRoZSBk
aXNwbGF5IGNvbnRyb2xsZXIgaW4gTFM3QTEwMDAgaGFzIG9ubHkgdHdvLXdheSBEVk8gaW50ZXJm
YWNlIGV4cG9ydGVkLA0KKyAqIHRodXMsIGV4dGVybmFsIGVuY29kZXIoVFggY2hpcCkgaXMgcmVx
dWlyZWQgZXhjZXB0IGNvbm5lY3RlZCB3aXRoIERQSSBwYW5lbA0KKyAqIGRpcmVjdGx5Lg0KKyAq
ICAgICAgIF9fX19fX19fX19fX19fX19fX18gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgX19fX19fX19fDQorICogICAgICB8ICAgICAgICAgICAgLS0tLS0tLXwgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICB8DQorICogICAgICB8ICBDUlRDMCAt
LT4gfCBEVk8wIC0tLS0+IEVuY29kZXIwIC0tLT4gQ29ubmVjdG9yMCAtLS0+IHwgRGlzcGxheSB8
DQorICogICAgICB8ICBfICAgXyAgICAgLS0tLS0tLXwgICAgICAgIF4gICAgICAgICAgICAgXiAg
ICAgICAgICAgIHxfX19fX19fX198DQorICogICAgICB8IHwgfCB8IHwgICstLS0tLS0rIHwgICAg
ICAgIHwgICAgICAgICAgICAgfA0KKyAqICAgICAgfCB8X3wgfF98ICB8IGkyYzYgfCA8LS0tLS0t
LS0rLS0tLS0tLS0tLS0tLSsNCisgKiAgICAgIHwgICAgICAgICAgKy0tLS0tLSsgfA0KKyAqICAg
ICAgfCAgICAgICAgICAgICAgICAgICB8DQorICogICAgICB8ICBEQyBpbiBMUzdBMTAwMCAgIHwN
CisgKiAgICAgIHwgICAgICAgICAgICAgICAgICAgfA0KKyAqICAgICAgfCAgXyAgIF8gICArLS0t
LS0tKyB8DQorICogICAgICB8IHwgfCB8IHwgIHwgaTJjNyB8IDwtLS0tLS0tLSstLS0tLS0tLS0t
LS0tKw0KKyAqICAgICAgfCB8X3wgfF98ICArLS0tLS0tKyB8ICAgICAgICB8ICAgICAgICAgICAg
IHwgICAgICAgICAgICAgX19fX19fX19fDQorICogICAgICB8ICAgICAgICAgICAgLS0tLS0tLXwg
ICAgICAgIHwgICAgICAgICAgICAgfCAgICAgICAgICAgIHwgICAgICAgICB8DQorICogICAgICB8
ICBDUlRDMSAtLT4gfCBEVk8xIC0tLS0+IEVuY29kZXIxIC0tLT4gQ29ubmVjdG9yMSAtLS0+IHwg
IFBhbmVsICB8DQorICogICAgICB8ICAgICAgICAgICAgLS0tLS0tLXwgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHxfX19fX19fX198DQorICogICAgICB8X19fX19fX19fX19fX19f
X19fX3wNCisgKg0KKyAqIFRoZSBkaXNwbGF5IGNvbnRyb2xsZXIgaW4gTFM3QTIwMDAgaGFzIHR3
byBkaXNwbGF5IHBpcGUsIHlldCBpdCBoYXMNCisgKiBpbnRlZ3JhdGVkIHRocmVlIGVuY29kZXJz
LCBkaXNwbGF5IHBpcGUgMCBpcyBhdHRhY2hlZCB3aXRoIGEgdHJhbnNwYXJlbnQNCisgKiBWR0Eg
ZW5jb2RlciBhbmQgYSBIRE1JIGVuY29kZXIsIHRoZXkgYXJlIHBhcmFsbGVsLiBEaXNwbGF5IHBp
cGUgMSBoYXMNCisgKiBvbmx5IG9uZSBIRE1JIHBoeSBjb25uZWN0ZWQuDQorICoNCisgKiAgICAg
ICBfX19fX19fX19fX19fX19fX19fX19fICAgICAgICAgICAgICAgICAgICAgICAgICBfX19fX19f
X19fX19fDQorICogICAgICB8ICAgICAgICAgICAgICstLS0tLSsgIHwgICAgICAgICAgICAgICAg
ICAgICAgICB8ICAgICAgICAgICAgIHwNCisgKiAgICAgIHwgQ1JUQzAgLSstLT4gfCBWR0EgfCAg
LS0tLT4gVkdBIENvbm5lY3RvciAtLS0+IHwgVkdBIE1vbml0b3IgfDwtLS0rDQorICogICAgICB8
ICAgICAgICB8ICAgICstLS0tLSsgIHwgICAgICAgICAgICAgICAgICAgICAgICB8X19fX19fX19f
X19fX3wgICAgfA0KKyAqICAgICAgfCAgICAgICAgfCAgICAgICAgICAgICB8ICAgICAgICAgICAg
ICAgICAgICAgICAgIF9fX19fX19fX19fX19fICAgIHwNCisgKiAgICAgIHwgICAgICAgIHwgICAg
Ky0tLS0tLSsgfCAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgIHwgICB8DQor
ICogICAgICB8ICAgICAgICArLS0+IHwgSERNSSB8IC0tLS0+IEhETUkgQ29ubmVjdG9yIC0tPiB8
IEhETUkgTW9uaXRvciB8PC0tKw0KKyAqICAgICAgfCAgICAgICAgICAgICArLS0tLS0tKyB8ICAg
ICAgICAgICAgICAgICAgICAgICAgfF9fX19fX19fX19fX19ffCAgIHwNCisgKiAgICAgIHwgICAg
ICAgICAgICArLS0tLS0tKyAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8DQorICogICAgICB8ICAgICAgICAgICAgfCBpMmM2IHwgIDwtLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KKyAqICAgICAgfCAgICAgICAgICAgICstLS0t
LS0rICB8DQorICogICAgICB8ICAgICAgICAgICAgICAgICAgICAgIHwNCisgKiAgICAgIHwgICAg
REMgaW4gTFM3QTIwMDAgICAgfA0KKyAqICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8DQor
ICogICAgICB8ICAgICAgICAgICAgKy0tLS0tLSsgIHwNCisgKiAgICAgIHwgICAgICAgICAgICB8
IGkyYzcgfCAgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KKyAqICAgICAgfCAg
ICAgICAgICAgICstLS0tLS0rICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQor
ICogICAgICB8ICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAg
IF9fX19fX3xfX19fX19fDQorICogICAgICB8ICAgICAgICAgICAgKy0tLS0tLSsgIHwgICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgfA0KKyAqICAgICAgfCBDUlRDMSAtLS0+
IHwgSERNSSB8ICAtLS0tPiBIRE1JIENvbm5lY3RvciAtLS0+IHwgSERNSSBNb25pdG9yIHwNCisg
KiAgICAgIHwgICAgICAgICAgICArLS0tLS0tKyAgfCAgICAgICAgICAgICAgICAgICAgICAgICB8
X19fX19fX19fX19fX198DQorICogICAgICB8X19fX19fX19fX19fX19fX19fX19fX3wNCisgKg0K
KyAqDQorICogVGhlcmUgaXMgb25seSBhIDE6MSBtYXBwaW5nIG9mIGNydGNzLCBlbmNvZGVycyBh
bmQgY29ubmVjdG9ycyBmb3IgdGhlIERDLA0KKyAqIGRpc3BsYXkgcGlwZSAwID0gY3J0YzAgKyBk
dm8wICsgZW5jb2RlcjAgKyBjb25uZWN0b3IwICsgY3Vyc29yMCArIHByaW1hcnkwDQorICogZGlz
cGxheSBwaXBlIDEgPSBjcnRjMSArIGR2bzEgKyBlbmNvZGVyMSArIGNvbm5lY3RybzEgKyBjdXJz
b3IxICsgcHJpbWFyeTENCisgKiBFYWNoIENSVEMgaGFzIHR3byBGQiBhZGRyZXNzIHJlZ2lzdGVy
cy4NCisgKg0KKyAqIFRoZSBEQyBpbiBMUzdBMTAwMC9MUzJLMTAwMCBoYXMgdGhlIHBjaSB2ZW5k
b3IvZGV2aWNlIElEOiAweDAwMTQ6MHg3YTA2LA0KKyAqIFRoZSBEQyBpbiBMUzdBMjAwMC9MUzJL
MjAwMCBoYXMgdGhlIHBjaSB2ZW5kb3IvZGV2aWNlIElEOiAweDAwMTQ6MHg3YTM2Lg0KKyAqDQor
ICogVGhlIEdQVSBpbiBMUzdBMTAwMCBoYXMgdGhlIHBjaSB2ZW5kb3IvZGV2aWNlIElEOiAweDAw
MTQ6MHg3YTE1LA0KKyAqIFRoZSBHUFUgaW4gTFM3QTIwMDAgaGFzIHRoZSBwY2kgdmVuZG9yL2Rl
dmljZSBJRDogMHgwMDE0OjB4N2EyNS4NCisgKg0KKyAqIExTN0ExMDAwL0xTN0EyMDAwIGNhbiBv
bmx5IGJlIHVzZWQgd2l0aCBkZXNrdG9wIG9yIHNlcnZlciBjbGFzcyBDUFVzLCBzdWNoDQorICog
YXMgTFMzQTQwMDAsIExTM0E1MDAwIGFuZCBMUzNBNjAwMC4gVGh1cywgQ1BVIFBSSUQgY2FuIGJl
IHVzZWQgdG8NCisgKiBkaXN0aW5ndWlzaCBMb29uZ3NvbiBTb0MgZnJvbSB0aG9zZSB0aGUgZGVz
a3RvcCBjbGFzcyBDUFUgb24gdGhlIHJ1bnRpbWUuDQorICovDQorZW51bSBsb29uZ3Nvbl9jaGlw
X2lkIHsNCisJQ0hJUF9MUzdBMTAwMCA9IDAsDQorCUNISVBfTFM3QTIwMDAgPSAxLA0KKwlDSElQ
X0xTX0xBU1QsDQorfTsNCisNCitjb25zdCBzdHJ1Y3QgbHNkY19kZXNjICoNCitsc2RjX2Rldmlj
ZV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgZW51bSBsb29uZ3Nvbl9jaGlwX2lkIGNoaXAp
Ow0KKw0KK3N0cnVjdCBsc2RjX2ttc19mdW5jczsNCisNCisvKiBEQyBzcGVjaWZpYyAqLw0KKw0K
K3N0cnVjdCBsc2RjX2Rlc2Mgew0KKwl1MzIgbnVtX29mX2NydGM7DQorCXUzMiBtYXhfcGl4ZWxf
Y2xrOw0KKwl1MzIgbWF4X3dpZHRoOw0KKwl1MzIgbWF4X2hlaWdodDsNCisJdTMyIG51bV9vZl9o
d19jdXJzb3I7DQorCXUzMiBod19jdXJzb3JfdzsNCisJdTMyIGh3X2N1cnNvcl9oOw0KKwl1MzIg
cGl0Y2hfYWxpZ247ICAgICAgICAgLyogQ1JUQyBETUEgYWxpZ25tZW50IGNvbnN0cmFpbnQgKi8N
CisJdTY0IG1jX2JpdHM7ICAgICAgICAgICAgIC8qIHBoeXNpY2FsIGFkZHJlc3MgYnVzIGJpdCB3
aWR0aCAqLw0KKwlib29sIGhhc192YmxhbmtfY291bnRlcjsgLyogMzIgYml0IGh3IHZzeW5jIGNv
dW50ZXIgKi8NCisNCisJLyogZGV2aWNlIGRlcGVuZGVudCBvcHMsIGRjIHNpZGUgKi8NCisJY29u
c3Qgc3RydWN0IGxzZGNfa21zX2Z1bmNzICpmdW5jczsNCit9Ow0KKw0KKy8qIEdGWCByZWxhdGVk
IHJlc291cmNlcyB3cmFuZ2xlciAqLw0KKw0KK3N0cnVjdCBsb29uZ3Nvbl9nZnhfZGVzYyB7DQor
CXN0cnVjdCBsc2RjX2Rlc2MgZGM7DQorDQorCXUzMiBjb25mX3JlZ19iYXNlOw0KKw0KKwkvKiBH
RlhQTEwgc2hhcmVkIGJ5IHRoZSBEQywgR01DIGFuZCBHUFUgKi8NCisJc3RydWN0IHsNCisJCXUz
MiByZWdfb2Zmc2V0Ow0KKwkJdTMyIHJlZ19zaXplOw0KKwl9IGdmeHBsbDsNCisNCisJLyogUGl4
ZWwgUExMLCBwZXIgZGlzcGxheSBwaXBlICovDQorCXN0cnVjdCB7DQorCQl1MzIgcmVnX29mZnNl
dDsNCisJCXUzMiByZWdfc2l6ZTsNCisJfSBwaXhwbGxbTFNEQ19OVU1fQ1JUQ107DQorDQorCWVu
dW0gbG9vbmdzb25fY2hpcF9pZCBjaGlwX2lkOw0KKwljaGFyIG1vZGVsWzY0XTsNCit9Ow0KKw0K
K3N0YXRpYyBpbmxpbmUgY29uc3Qgc3RydWN0IGxvb25nc29uX2dmeF9kZXNjICoNCit0b19sb29u
Z3Nvbl9nZngoY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqZGNwKQ0KK3sNCisJcmV0dXJuIGNvbnRh
aW5lcl9vZl9jb25zdChkY3AsIHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVzYywgZGMpOw0KK307DQor
DQorc3RydWN0IGxzZGNfcmVnMzIgew0KKwljaGFyICpuYW1lOw0KKwl1MzIgb2Zmc2V0Ow0KK307
DQorDQorLyogY3J0YyBoYXJkd2FyZSByZWxhdGVkIG9wcyAqLw0KKw0KK3N0cnVjdCBsc2RjX2Ny
dGM7DQorDQorc3RydWN0IGxzZGNfY3J0Y19od19vcHMgew0KKwl2b2lkICgqZW5hYmxlKShzdHJ1
Y3QgbHNkY19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCpkaXNhYmxlKShzdHJ1Y3QgbHNkY19jcnRj
ICpsY3J0Yyk7DQorCXZvaWQgKCplbmFibGVfdmJsYW5rKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0
Yyk7DQorCXZvaWQgKCpkaXNhYmxlX3ZibGFuaykoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpOw0K
Kwl2b2lkICgqZmxpcCkoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpOw0KKwl2b2lkICgqY2xvbmUp
KHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisJdm9pZCAoKmdldF9zY2FuX3Bvcykoc3RydWN0
IGxzZGNfY3J0YyAqbGNydGMsIGludCAqaHBvcywgaW50ICp2cG9zKTsNCisJdm9pZCAoKnNldF9t
b2RlKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywgY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKm1vZGUpOw0KKwl2b2lkICgqc29mdF9yZXNldCkoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMp
Ow0KKwl2b2lkICgqcmVzZXQpKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisNCisJdTMyICAo
KmdldF92YmxhbmtfY291bnRlcikoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpOw0KKwl2b2lkICgq
c2V0X2RtYV9zdGVwKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywgZW51bSBsc2RjX2RtYV9zdGVw
cyBzdGVwKTsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX2NydGMgew0KKwlzdHJ1Y3QgZHJtX2NydGMg
YmFzZTsNCisJc3RydWN0IGxzZGNfcGl4cGxsIHBpeHBsbDsNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2Ow0KKwljb25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyAqaHdfb3BzOw0KKwljb25z
dCBzdHJ1Y3QgbHNkY19yZWczMiAqcHJlZzsNCisJdW5zaWduZWQgaW50IG5yZWc7DQorCXN0cnVj
dCBkcm1faW5mb19saXN0ICpwX2luZm9fbGlzdDsNCisJdW5zaWduZWQgaW50IG5faW5mb19saXN0
Ow0KK307DQorDQorLyogcHJpbWFyeSBwbGFuZSBoYXJkd2FyZSByZWxhdGVkIG9wcyAqLw0KKw0K
K3N0cnVjdCBsc2RjX3ByaW1hcnk7DQorDQorc3RydWN0IGxzZGNfcHJpbWFyeV9wbGFuZV9vcHMg
ew0KKwl2b2lkICgqdXBkYXRlX2ZiX2FkZHIpKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnBsYW5lLCB1
NjQgYWRkcik7DQorCXZvaWQgKCp1cGRhdGVfZmJfc3RyaWRlKShzdHJ1Y3QgbHNkY19wcmltYXJ5
ICpwbGFuZSwgdTMyIHN0cmlkZSk7DQorCXZvaWQgKCp1cGRhdGVfZmJfZm9ybWF0KShzdHJ1Y3Qg
bHNkY19wcmltYXJ5ICpwbGFuZSwNCisJCQkJIGNvbnN0IHN0cnVjdCBkcm1fZm9ybWF0X2luZm8g
KmZvcm1hdCk7DQorfTsNCisNCitzdHJ1Y3QgbHNkY19wcmltYXJ5IHsNCisJc3RydWN0IGRybV9w
bGFuZSBiYXNlOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19wcmltYXJ5X3BsYW5lX29wcyAqb3BzOw0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXY7DQorfTsNCisNCisvKiBjdXJzb3IgcGxhbmUgaGFy
ZHdhcmUgcmVsYXRlZCBvcHMgKi8NCisNCitzdHJ1Y3QgbHNkY19jdXJzb3I7DQorDQorc3RydWN0
IGxzZGNfY3Vyc29yX3BsYW5lX29wcyB7DQorCXZvaWQgKCp1cGRhdGVfYm9fYWRkcikoc3RydWN0
IGxzZGNfY3Vyc29yICpwbGFuZSwgdTY0IGFkZHIpOw0KKwl2b2lkICgqdXBkYXRlX2NmZykoc3Ry
dWN0IGxzZGNfY3Vyc29yICpwbGFuZSwNCisJCQkgICBlbnVtIGxzZGNfY3Vyc29yX3NpemUgY3Vy
c29yX3NpemUsDQorCQkJICAgZW51bSBsc2RjX2N1cnNvcl9mb3JtYXQpOw0KKwl2b2lkICgqdXBk
YXRlX3Bvc2l0aW9uKShzdHJ1Y3QgbHNkY19jdXJzb3IgKnBsYW5lLCBpbnQgeCwgaW50IHkpOw0K
K307DQorDQorc3RydWN0IGxzZGNfY3Vyc29yIHsNCisJc3RydWN0IGRybV9wbGFuZSBiYXNlOw0K
Kwljb25zdCBzdHJ1Y3QgbHNkY19jdXJzb3JfcGxhbmVfb3BzICpvcHM7DQorCXN0cnVjdCBsc2Rj
X2RldmljZSAqbGRldjsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX291dHB1dCB7DQorCXN0cnVjdCBk
cm1fZW5jb2RlciBlbmNvZGVyOw0KKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBjb25uZWN0b3I7DQor
fTsNCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX291dHB1dCAqDQorY29ubmVjdG9yX3Rv
X2xzZGNfb3V0cHV0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpDQorew0KKwlyZXR1
cm4gY29udGFpbmVyX29mKGNvbm5lY3Rvciwgc3RydWN0IGxzZGNfb3V0cHV0LCBjb25uZWN0b3Ip
Ow0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX291dHB1dCAqDQorZW5jb2Rlcl90
b19sc2RjX291dHB1dChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpDQorew0KKwlyZXR1cm4g
Y29udGFpbmVyX29mKGVuY29kZXIsIHN0cnVjdCBsc2RjX291dHB1dCwgZW5jb2Rlcik7DQorfQ0K
Kw0KK3N0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZSB7DQorCXN0cnVjdCBsc2RjX2NydGMgY3J0YzsN
CisJc3RydWN0IGxzZGNfcHJpbWFyeSBwcmltYXJ5Ow0KKwlzdHJ1Y3QgbHNkY19jdXJzb3IgY3Vy
c29yOw0KKwlzdHJ1Y3QgbHNkY19vdXRwdXQgb3V0cHV0Ow0KKwlzdHJ1Y3QgbHNkY19pMmMgKmxp
MmM7DQorCXVuc2lnbmVkIGludCBpbmRleDsNCit9Ow0KKw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0
IGxzZGNfZGlzcGxheV9waXBlICoNCitvdXRwdXRfdG9fZGlzcGxheV9waXBlKHN0cnVjdCBsc2Rj
X291dHB1dCAqb3V0cHV0KQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9vZihvdXRwdXQsIHN0cnVj
dCBsc2RjX2Rpc3BsYXlfcGlwZSwgb3V0cHV0KTsNCit9DQorDQorc3RydWN0IGxzZGNfa21zX2Z1
bmNzIHsNCisJaXJxcmV0dXJuX3QgKCppcnFfaGFuZGxlcikoaW50IGlycSwgdm9pZCAqYXJnKTsN
CisNCisJaW50ICgqY3JlYXRlX2kyYykoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICBz
dHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJICB1bnNpZ25lZCBpbnQgaW5k
ZXgpOw0KKw0KKwlpbnQgKCpvdXRwdXRfaW5pdCkoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQor
CQkJICAgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBlLA0KKwkJCSAgIHN0cnVjdCBp
MmNfYWRhcHRlciAqZGRjLA0KKwkJCSAgIHVuc2lnbmVkIGludCBpbmRleCk7DQorDQorCWludCAo
KmN1cnNvcl9wbGFuZV9pbml0KShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkJIHN0cnVj
dCBkcm1fcGxhbmUgKnBsYW5lLA0KKwkJCQkgdW5zaWduZWQgaW50IGluZGV4KTsNCisNCisJaW50
ICgqcHJpbWFyeV9wbGFuZV9pbml0KShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkJICBz
dHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJICB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0K
KwlpbnQgKCpjcnRjX2luaXQpKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSBzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGMsDQorCQkJIHN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnksDQorCQkJIHN0
cnVjdCBkcm1fcGxhbmUgKmN1cnNvciwNCisJCQkgdW5zaWduZWQgaW50IGluZGV4KTsNCit9Ow0K
Kw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGxzZGNfY3J0YyAqDQordG9fbHNkY19jcnRjKHN0cnVj
dCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoY3J0Yywgc3RydWN0
IGxzZGNfY3J0YywgYmFzZSk7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGxzZGNfZGlz
cGxheV9waXBlICoNCitjcnRjX3RvX2Rpc3BsYXlfcGlwZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMp
DQorew0KKwlyZXR1cm4gY29udGFpbmVyX29mKGNydGMsIHN0cnVjdCBsc2RjX2Rpc3BsYXlfcGlw
ZSwgY3J0Yy5iYXNlKTsNCit9DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19wcmltYXJ5
ICoNCit0b19sc2RjX3ByaW1hcnkoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUpDQorew0KKwlyZXR1
cm4gY29udGFpbmVyX29mKHBsYW5lLCBzdHJ1Y3QgbHNkY19wcmltYXJ5LCBiYXNlKTsNCit9DQor
DQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19jdXJzb3IgKg0KK3RvX2xzZGNfY3Vyc29yKHN0
cnVjdCBkcm1fcGxhbmUgKnBsYW5lKQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9vZihwbGFuZSwg
c3RydWN0IGxzZGNfY3Vyc29yLCBiYXNlKTsNCit9DQorDQorc3RydWN0IGxzZGNfY3J0Y19zdGF0
ZSB7DQorCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSBiYXNlOw0KKwlzdHJ1Y3QgbHNkY19waXhwbGxf
cGFybXMgcHBhcm1zOw0KK307DQorDQorc3RydWN0IGxzZGNfZ2VtIHsNCisJLyogQG11dGV4OiBw
cm90ZWN0IG9iamVjdHMgbGlzdCAqLw0KKwlzdHJ1Y3QgbXV0ZXggbXV0ZXg7DQorCXN0cnVjdCBs
aXN0X2hlYWQgb2JqZWN0czsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX2RldmljZSB7DQorCXN0cnVj
dCBkcm1fZGV2aWNlIGJhc2U7DQorCXN0cnVjdCB0dG1fZGV2aWNlIGJkZXY7DQorDQorCS8qIEBk
ZXNjcDogZmVhdHVyZXMgZGVzY3JpcHRpb24gb2YgdGhlIERDIHZhcmlhbnQgKi8NCisJY29uc3Qg
c3RydWN0IGxzZGNfZGVzYyAqZGVzY3A7DQorCXN0cnVjdCBwY2lfZGV2ICpkYzsNCisJc3RydWN0
IHBjaV9kZXYgKmdwdTsNCisNCisJc3RydWN0IGxvb25nc29uX2dmeHBsbCAqZ2Z4cGxsOw0KKw0K
KwkvKiBAcmVnbG9jazogcHJvdGVjdHMgY29uY3VycmVudCBhY2Nlc3MgKi8NCisJc3BpbmxvY2tf
dCByZWdsb2NrOw0KKw0KKwl2b2lkIF9faW9tZW0gKnJlZ19iYXNlOw0KKwlyZXNvdXJjZV9zaXpl
X3QgdnJhbV9iYXNlOw0KKwlyZXNvdXJjZV9zaXplX3QgdnJhbV9zaXplOw0KKw0KKwlyZXNvdXJj
ZV9zaXplX3QgZ3R0X2Jhc2U7DQorCXJlc291cmNlX3NpemVfdCBndHRfc2l6ZTsNCisNCisJc3Ry
dWN0IGxzZGNfZGlzcGxheV9waXBlIGRpc3BpcGVbTFNEQ19OVU1fQ1JUQ107DQorDQorCXN0cnVj
dCBsc2RjX2dlbSBnZW07DQorDQorCXUzMiBpcnFfc3RhdHVzOw0KKw0KKwkvKiB0cmFja2luZyBw
aW5uZWQgbWVtb3J5ICovDQorCXNpemVfdCB2cmFtX3Bpbm5lZF9zaXplOw0KKwlzaXplX3QgZ3R0
X3Bpbm5lZF9zaXplOw0KKw0KKwkvKiBAbnVtX291dHB1dDogY291bnQgdGhlIG51bWJlciBvZiBh
Y3RpdmUgZGlzcGxheSBwaXBlICovDQorCXVuc2lnbmVkIGludCBudW1fb3V0cHV0Ow0KK307DQor
DQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19kZXZpY2UgKnRkZXZfdG9fbGRldihzdHJ1Y3Qg
dHRtX2RldmljZSAqYmRldikNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoYmRldiwgc3RydWN0
IGxzZGNfZGV2aWNlLCBiZGV2KTsNCit9DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19k
ZXZpY2UgKnRvX2xzZGMoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYpDQorew0KKwlyZXR1cm4gY29u
dGFpbmVyX29mKGRkZXYsIHN0cnVjdCBsc2RjX2RldmljZSwgYmFzZSk7DQorfQ0KKw0KK3N0YXRp
YyBpbmxpbmUgc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSAqDQordG9fbHNkY19jcnRjX3N0YXRlKHN0
cnVjdCBkcm1fY3J0Y19zdGF0ZSAqYmFzZSkNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoYmFz
ZSwgc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSwgYmFzZSk7DQorfQ0KKw0KK3ZvaWQgbHNkY19kZWJ1
Z2ZzX2luaXQoc3RydWN0IGRybV9taW5vciAqbWlub3IpOw0KKw0KK2ludCBsczdhMTAwMF9jcnRj
X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkgICAgICAgc3RydWN0IGRybV9jcnRj
ICpjcnRjLA0KKwkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnksDQorCQkgICAgICAg
c3RydWN0IGRybV9wbGFuZSAqY3Vyc29yLA0KKwkJICAgICAgIHVuc2lnbmVkIGludCBpbmRleCk7
DQorDQoraW50IGxzN2EyMDAwX2NydGNfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJ
CSAgICAgICBzdHJ1Y3QgZHJtX2NydGMgKmNydGMsDQorCQkgICAgICAgc3RydWN0IGRybV9wbGFu
ZSAqcHJpbWFyeSwNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpjdXJzb3IsDQorCQkgICAg
ICAgdW5zaWduZWQgaW50IGluZGV4KTsNCisNCitpbnQgbHNkY19wcmltYXJ5X3BsYW5lX2luaXQo
c3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICAgIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
LA0KKwkJCSAgICB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0KK2ludCBsczdhMTAwMF9jdXJzb3Jf
cGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgICAgc3RydWN0IGRy
bV9wbGFuZSAqcGxhbmUsDQorCQkJICAgICAgIHVuc2lnbmVkIGludCBpbmRleCk7DQorDQoraW50
IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJ
CSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkgICAgICAgdW5zaWduZWQgaW50
IGluZGV4KTsNCisNCisvKiByZWdpc3RlcnMgYWNjZXNzIGhlbHBlcnMgKi8NCisNCitzdGF0aWMg
aW5saW5lIHUzMiBsc2RjX3JyZWczMihzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsIHUzMiBvZmZz
ZXQpDQorew0KKwlyZXR1cm4gcmVhZGwobGRldi0+cmVnX2Jhc2UgKyBvZmZzZXQpOw0KK30NCisN
CitzdGF0aWMgaW5saW5lIHZvaWQgbHNkY193cmVnMzIoc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2
LCB1MzIgb2Zmc2V0LCB1MzIgdmFsKQ0KK3sNCisJd3JpdGVsKHZhbCwgbGRldi0+cmVnX2Jhc2Ug
KyBvZmZzZXQpOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgbHNkY191cmVnMzJfc2V0KHN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiwNCisJCQkJICAgdTMyIG9mZnNldCwNCisJCQkJICAgdTMy
IG1hc2spDQorew0KKwl2b2lkIF9faW9tZW0gKmFkZHIgPSBsZGV2LT5yZWdfYmFzZSArIG9mZnNl
dDsNCisJdTMyIHZhbCA9IHJlYWRsKGFkZHIpOw0KKw0KKwl3cml0ZWwodmFsIHwgbWFzaywgYWRk
cik7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBsc2RjX3VyZWczMl9jbHIoc3RydWN0IGxz
ZGNfZGV2aWNlICpsZGV2LA0KKwkJCQkgICB1MzIgb2Zmc2V0LA0KKwkJCQkgICB1MzIgbWFzaykN
Cit7DQorCXZvaWQgX19pb21lbSAqYWRkciA9IGxkZXYtPnJlZ19iYXNlICsgb2Zmc2V0Ow0KKwl1
MzIgdmFsID0gcmVhZGwoYWRkcik7DQorDQorCXdyaXRlbCh2YWwgJiB+bWFzaywgYWRkcik7DQor
fQ0KKw0KK3N0YXRpYyBpbmxpbmUgdTMyIGxzZGNfcGlwZV9ycmVnMzIoc3RydWN0IGxzZGNfZGV2
aWNlICpsZGV2LA0KKwkJCQkgICB1MzIgb2Zmc2V0LA0KKwkJCQkgICB1MzIgcGlwZSkNCit7DQor
CXJldHVybiByZWFkbChsZGV2LT5yZWdfYmFzZSArIG9mZnNldCArIHBpcGUgKiBDUlRDX1BJUEVf
T0ZGU0VUKTsNCit9DQorDQorc3RhdGljIGlubGluZSB2b2lkIGxzZGNfcGlwZV93cmVnMzIoc3Ry
dWN0IGxzZGNfZGV2aWNlICpsZGV2LA0KKwkJCQkgICAgdTMyIG9mZnNldCwNCisJCQkJICAgIHUz
MiBwaXBlLA0KKwkJCQkgICAgdTMyIHZhbCkNCit7DQorCXdyaXRlbCh2YWwsIGxkZXYtPnJlZ19i
YXNlICsgb2Zmc2V0ICsgcGlwZSAqIENSVENfUElQRV9PRkZTRVQpOw0KK30NCisNCisjZW5kaWYN
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19nZW0uYyBiL2RyaXZl
cnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5k
ZXggMDAwMDAwMDAwMDAwLi5mMjE5NDJiMmEzYjgNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZl
cnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5jDQpAQCAtMCwwICsxLDMyNCBAQA0KKy8vIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAy
MDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNp
bmNsdWRlIDxsaW51eC9kbWEtYnVmLmg+DQorDQorI2luY2x1ZGUgPGRybS9kcm1fZGVidWdmcy5o
Pg0KKyNpbmNsdWRlIDxkcm0vZHJtX2ZpbGUuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4N
CisjaW5jbHVkZSA8ZHJtL2RybV9wcmltZS5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0K
KyNpbmNsdWRlICJsc2RjX2dlbS5oIg0KKyNpbmNsdWRlICJsc2RjX3R0bS5oIg0KKw0KK3N0YXRp
YyBpbnQgbHNkY19nZW1fcHJpbWVfcGluKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQ0KK3sN
CisJc3RydWN0IGxzZGNfYm8gKmxibyA9IGdlbV90b19sc2RjX2JvKG9iaik7DQorCWludCByZXQ7
DQorDQorCXJldCA9IGxzZGNfYm9fcmVzZXJ2ZShsYm8pOw0KKwlpZiAodW5saWtlbHkocmV0KSkN
CisJCXJldHVybiByZXQ7DQorDQorCXJldCA9IGxzZGNfYm9fcGluKGxibywgTFNEQ19HRU1fRE9N
QUlOX0dUVCwgTlVMTCk7DQorCWlmIChsaWtlbHkocmV0ID09IDApKQ0KKwkJbGJvLT5zaGFyaW5n
X2NvdW50Kys7DQorDQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorDQorCXJldHVybiByZXQ7
DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfZ2VtX3ByaW1lX3VucGluKHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqb2JqKQ0KK3sNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9IGdlbV90b19sc2RjX2Jv
KG9iaik7DQorCWludCByZXQ7DQorDQorCXJldCA9IGxzZGNfYm9fcmVzZXJ2ZShsYm8pOw0KKwlp
ZiAodW5saWtlbHkocmV0KSkNCisJCXJldHVybjsNCisNCisJbHNkY19ib191bnBpbihsYm8pOw0K
KwlpZiAobGJvLT5zaGFyaW5nX2NvdW50KQ0KKwkJbGJvLT5zaGFyaW5nX2NvdW50LS07DQorDQor
CWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUg
KmxzZGNfZ2VtX3ByaW1lX2dldF9zZ190YWJsZShzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikN
Cit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gdG9fdHRtX2JvKG9iaik7DQor
CXN0cnVjdCB0dG1fdHQgKnR0ID0gdGJvLT50dG07DQorDQorCWlmICghdHQpIHsNCisJCWRybV9l
cnIob2JqLT5kZXYsICJzaGFyaW5nIGEgYnVmZmVyIHdpdGhvdXQgYmFja2luZyBtZW1vcnlcbiIp
Ow0KKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7DQorCX0NCisNCisJcmV0dXJuIGRybV9wcmlt
ZV9wYWdlc190b19zZyhvYmotPmRldiwgdHQtPnBhZ2VzLCB0dC0+bnVtX3BhZ2VzKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19nZW1fb2JqZWN0X2ZyZWUoc3RydWN0IGRybV9nZW1fb2JqZWN0
ICpvYmopDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9IHRvX3R0bV9ibyhv
YmopOw0KKw0KKwlpZiAodGJvKQ0KKwkJdHRtX2JvX3B1dCh0Ym8pOw0KK30NCisNCitzdGF0aWMg
aW50IGxzZGNfZ2VtX29iamVjdF92bWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLA0KKwkJ
CQlzdHJ1Y3QgaW9zeXNfbWFwICptYXApDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KnRibyA9IHRvX3R0bV9ibyhvYmopOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvID0gdG9fbHNkY19i
byh0Ym8pOw0KKwlpbnQgcmV0Ow0KKw0KKwlpZiAobGJvLT52bWFwX2NvdW50ID4gMCkgew0KKwkJ
KytsYm8tPnZtYXBfY291bnQ7DQorCQlnb3RvIG91dDsNCisJfQ0KKw0KKwlyZXQgPSBsc2RjX2Jv
X3BpbihsYm8sIDAsIE5VTEwpOw0KKwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJZHJtX2Vycihv
YmotPmRldiwgInBpbiAlcCBmb3Igdm1hcCBmYWlsZWRcbiIsIGxibyk7DQorCQlyZXR1cm4gcmV0
Ow0KKwl9DQorDQorCXJldCA9IHR0bV9ib192bWFwKHRibywgJmxiby0+bWFwKTsNCisJaWYgKHJl
dCkgew0KKwkJZHJtX2VycihvYmotPmRldiwgInR0bSBibyB2bWFwIGZhaWxlZFxuIik7DQorCQls
c2RjX2JvX3VucGluKGxibyk7DQorCQlyZXR1cm4gcmV0Ow0KKwl9DQorDQorCWxiby0+dm1hcF9j
b3VudCA9IDE7DQorDQorb3V0Og0KKwkqbWFwID0gbGJvLT5tYXA7DQorDQorCXJldHVybiAwOw0K
K30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2dlbV9vYmplY3RfdnVubWFwKHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqb2JqLA0KKwkJCQkgICBzdHJ1Y3QgaW9zeXNfbWFwICptYXApDQorew0KKwlzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9IHRvX3R0bV9ibyhvYmopOw0KKwlzdHJ1Y3QgbHNk
Y19ibyAqbGJvID0gdG9fbHNkY19ibyh0Ym8pOw0KKw0KKwlpZiAodW5saWtlbHkoIWxiby0+dm1h
cF9jb3VudCkpIHsNCisJCWRybV93YXJuKG9iai0+ZGV2LCAiJXAgaXMgbm90IG1hcHBlZFxuIiwg
bGJvKTsNCisJCXJldHVybjsNCisJfQ0KKw0KKwktLWxiby0+dm1hcF9jb3VudDsNCisJaWYgKGxi
by0+dm1hcF9jb3VudCA9PSAwKSB7DQorCQl0dG1fYm9fdnVubWFwKHRibywgJmxiby0+bWFwKTsN
CisNCisJCWxzZGNfYm9fdW5waW4obGJvKTsNCisJfQ0KK30NCisNCitzdGF0aWMgaW50IGxzZGNf
Z2VtX29iamVjdF9tbWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLA0KKwkJCQlzdHJ1Y3Qg
dm1fYXJlYV9zdHJ1Y3QgKnZtYSkNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJv
ID0gdG9fdHRtX2JvKG9iaik7DQorCWludCByZXQ7DQorDQorCXJldCA9IHR0bV9ib19tbWFwX29i
aih2bWEsIHRibyk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fd2FybihvYmotPmRl
diwgIm1tYXAgJXAgZmFpbGVkXG4iLCB0Ym8pOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlk
cm1fZ2VtX29iamVjdF9wdXQob2JqKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfZnVuY3MgbHNkY19nZW1fb2JqZWN0X2Z1bmNzID0g
ew0KKwkuZnJlZSA9IGxzZGNfZ2VtX29iamVjdF9mcmVlLA0KKwkuZXhwb3J0ID0gZHJtX2dlbV9w
cmltZV9leHBvcnQsDQorCS5waW4gPSBsc2RjX2dlbV9wcmltZV9waW4sDQorCS51bnBpbiA9IGxz
ZGNfZ2VtX3ByaW1lX3VucGluLA0KKwkuZ2V0X3NnX3RhYmxlID0gbHNkY19nZW1fcHJpbWVfZ2V0
X3NnX3RhYmxlLA0KKwkudm1hcCA9IGxzZGNfZ2VtX29iamVjdF92bWFwLA0KKwkudnVubWFwID0g
bHNkY19nZW1fb2JqZWN0X3Z1bm1hcCwNCisJLm1tYXAgPSBsc2RjX2dlbV9vYmplY3RfbW1hcCwN
Cit9Ow0KKw0KK3N0cnVjdCBkcm1fZ2VtX29iamVjdCAqDQorbHNkY19nZW1fb2JqZWN0X2NyZWF0
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCSAgICAgICB1MzIgZG9tYWluLA0KKwkJICAg
ICAgIHNpemVfdCBzaXplLA0KKwkJICAgICAgIGJvb2wga2VyZW5sLA0KKwkJICAgICAgIHN0cnVj
dCBzZ190YWJsZSAqc2csDQorCQkgICAgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2KQ0KK3sNCisJ
c3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJc3RydWN0IGRybV9n
ZW1fb2JqZWN0ICpnb2JqOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvOw0KKwlpbnQgcmV0Ow0KKw0K
KwlsYm8gPSBsc2RjX2JvX2NyZWF0ZShkZGV2LCBkb21haW4sIHNpemUsIGtlcmVubCwgc2csIHJl
c3YpOw0KKwlpZiAoSVNfRVJSKGxibykpIHsNCisJCXJldCA9IFBUUl9FUlIobGJvKTsNCisJCXJl
dHVybiBFUlJfUFRSKHJldCk7DQorCX0NCisNCisJLyogVlJBTSBpcyBmaWxsZWQgd2l0aCByYW5k
b20gZGF0YSAqLw0KKwlsc2RjX2JvX2NsZWFyKGxibyk7DQorDQorCWdvYmogPSAmbGJvLT50Ym8u
YmFzZTsNCisJZ29iai0+ZnVuY3MgPSAmbHNkY19nZW1fb2JqZWN0X2Z1bmNzOw0KKw0KKwkvKiB0
cmFja2luZyB0aGUgQk9zIHdlIGNyZWF0ZWQgKi8NCisJbXV0ZXhfbG9jaygmbGRldi0+Z2VtLm11
dGV4KTsNCisJbGlzdF9hZGRfdGFpbCgmbGJvLT5saXN0LCAmbGRldi0+Z2VtLm9iamVjdHMpOw0K
KwltdXRleF91bmxvY2soJmxkZXYtPmdlbS5tdXRleCk7DQorDQorCXJldHVybiBnb2JqOw0KK30N
CisNCitzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKg0KK2xzZGNfcHJpbWVfaW1wb3J0X3NnX3RhYmxl
KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1l
bnQgKmF0dGFjaCwNCisJCQkgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnKQ0KK3sNCisJc3RydWN0IGRt
YV9yZXN2ICpyZXN2ID0gYXR0YWNoLT5kbWFidWYtPnJlc3Y7DQorCXU2NCBzaXplID0gYXR0YWNo
LT5kbWFidWYtPnNpemU7DQorCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ29iajsNCisJc3RydWN0
IGxzZGNfYm8gKmxibzsNCisNCisJZG1hX3Jlc3ZfbG9jayhyZXN2LCBOVUxMKTsNCisJZ29iaiA9
IGxzZGNfZ2VtX29iamVjdF9jcmVhdGUoZGRldiwgTFNEQ19HRU1fRE9NQUlOX0dUVCwgc2l6ZSwg
ZmFsc2UsDQorCQkJCSAgICAgIHNnLCByZXN2KTsNCisJZG1hX3Jlc3ZfdW5sb2NrKHJlc3YpOw0K
Kw0KKwlpZiAoSVNfRVJSKGdvYmopKSB7DQorCQlkcm1fZXJyKGRkZXYsICJGYWlsZWQgdG8gaW1w
b3J0IHNnIHRhYmxlXG4iKTsNCisJCXJldHVybiBnb2JqOw0KKwl9DQorDQorCWxibyA9IGdlbV90
b19sc2RjX2JvKGdvYmopOw0KKwlsYm8tPnNoYXJpbmdfY291bnQgPSAxOw0KKw0KKwlyZXR1cm4g
Z29iajsNCit9DQorDQoraW50IGxzZGNfZHVtYl9jcmVhdGUoc3RydWN0IGRybV9maWxlICpmaWxl
LA0KKwkJICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCSAgICAgc3RydWN0IGRybV9t
b2RlX2NyZWF0ZV9kdW1iICphcmdzKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
dG9fbHNkYyhkZGV2KTsNCisJY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqZGVzY3AgPSBsZGV2LT5k
ZXNjcDsNCisJdTMyIGRvbWFpbiA9IExTRENfR0VNX0RPTUFJTl9WUkFNOw0KKwlzdHJ1Y3QgZHJt
X2dlbV9vYmplY3QgKmdvYmo7DQorCXNpemVfdCBzaXplOw0KKwl1MzIgcGl0Y2g7DQorCXUzMiBo
YW5kbGU7DQorCWludCByZXQ7DQorDQorCWlmICghYXJncy0+d2lkdGggfHwgIWFyZ3MtPmhlaWdo
dCkNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwkvKiBMb29uZ3NvbiBkaWFwbGF5IGNvbnRyb2xs
ZXIgb25seSBzdXBwb3J0IDMyLWJpdCBhbmQgMTYtYml0IEZCICovDQorCWlmIChhcmdzLT5icHAg
IT0gMzIgJiYgYXJncy0+YnBwICE9IDE2KQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQorDQorCXBpdGNo
ID0gYXJncy0+d2lkdGggKiBhcmdzLT5icHAgLyA4Ow0KKwlwaXRjaCA9IEFMSUdOKHBpdGNoLCBk
ZXNjcC0+cGl0Y2hfYWxpZ24pOw0KKwlzaXplID0gcGl0Y2ggKiBhcmdzLT5oZWlnaHQ7DQorCXNp
emUgPSBBTElHTihzaXplLCBQQUdFX1NJWkUpOw0KKw0KKwkvKiBNYXhpbXVtIGJvIHNpemUgYWxs
b3dlZCBpcyB0aGUgaGFsZiB2cmFtIHNpemUgYXZhaWxhYmxlICovDQorCWlmIChzaXplID4gbGRl
di0+dnJhbV9zaXplIC8gMikgew0KKwkJZHJtX2VycihkZGV2LCAiUmVxdWVzdGluZyglenVNQikg
bW9yZSB0aGFuIG93bmVkKCV1TUIpXG4iLA0KKwkJCXNpemUgPj4gMjAsICh1MzIpKGxkZXYtPnZy
YW1fc2l6ZSA+PiAyMCkpOw0KKwkJcmV0dXJuIC1FTk9NRU07DQorCX0NCisNCisJZ29iaiA9IGxz
ZGNfZ2VtX29iamVjdF9jcmVhdGUoZGRldiwNCisJCQkJICAgICAgZG9tYWluLA0KKwkJCQkgICAg
ICBzaXplLA0KKwkJCQkgICAgICBmYWxzZSwNCisJCQkJICAgICAgTlVMTCwNCisJCQkJICAgICAg
TlVMTCk7DQorCWlmIChJU19FUlIoZ29iaikpIHsNCisJCWRybV9lcnIoZGRldiwgIkZhaWxlZCB0
byBjcmVhdGUgZ2VtIG9iamVjdFxuIik7DQorCQlyZXR1cm4gUFRSX0VSUihnb2JqKTsNCisJfQ0K
Kw0KKwlyZXQgPSBkcm1fZ2VtX2hhbmRsZV9jcmVhdGUoZmlsZSwgZ29iaiwgJmhhbmRsZSk7DQor
DQorCS8qIGRyb3AgcmVmZXJlbmNlIGZyb20gYWxsb2NhdGUsIGhhbmRsZSBob2xkcyBpdCBub3cg
Ki8NCisJZHJtX2dlbV9vYmplY3RfcHV0KGdvYmopOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJl
dDsNCisNCisJYXJncy0+cGl0Y2ggPSBwaXRjaDsNCisJYXJncy0+c2l6ZSA9IHNpemU7DQorCWFy
Z3MtPmhhbmRsZSA9IGhhbmRsZTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK2ludCBsc2RjX2R1
bWJfbWFwX29mZnNldChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbHAsDQorCQkJIHN0cnVjdCBkcm1fZGV2
aWNlICpkZGV2LA0KKwkJCSB1MzIgaGFuZGxlLA0KKwkJCSB1aW50NjRfdCAqb2Zmc2V0KQ0KK3sN
CisJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnb2JqOw0KKw0KKwlnb2JqID0gZHJtX2dlbV9vYmpl
Y3RfbG9va3VwKGZpbHAsIGhhbmRsZSk7DQorCWlmICghZ29iaikNCisJCXJldHVybiAtRU5PRU5U
Ow0KKw0KKwkqb2Zmc2V0ID0gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZnb2JqLT52bWFfbm9k
ZSk7DQorDQorCWRybV9nZW1fb2JqZWN0X3B1dChnb2JqKTsNCisNCisJcmV0dXJuIDA7DQorfQ0K
Kw0KK3ZvaWQgbHNkY19nZW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldikNCit7DQorCXN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorDQorCW11dGV4X2luaXQo
JmxkZXYtPmdlbS5tdXRleCk7DQorCUlOSVRfTElTVF9IRUFEKCZsZGV2LT5nZW0ub2JqZWN0cyk7
DQorfQ0KKw0KK2ludCBsc2RjX3Nob3dfYnVmZmVyX29iamVjdChzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBk
cm1faW5mb19ub2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBu
b2RlLT5taW5vci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRk
ZXYpOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvOw0KKwl1bnNpZ25lZCBpbnQgaTsNCisNCisJbXV0
ZXhfbG9jaygmbGRldi0+Z2VtLm11dGV4KTsNCisNCisJaSA9IDA7DQorDQorCWxpc3RfZm9yX2Vh
Y2hfZW50cnkobGJvLCAmbGRldi0+Z2VtLm9iamVjdHMsIGxpc3QpIHsNCisJCXN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwkJc3RydWN0IHR0bV9yZXNvdXJjZSAq
cmVzb3VyY2UgPSB0Ym8tPnJlc291cmNlOw0KKw0KKwkJc2VxX3ByaW50ZihtLCAiYm9bJTA0dV1b
JXBdOiBzaXplOiAlOHp1IEtCICVzIG9mZnNldDogJThsbHhcbiIsDQorCQkJICAgaSwgbGJvLA0K
KwkJCSAgIGxzZGNfYm9fc2l6ZShsYm8pID4+IDEwLA0KKwkJCSAgIGxzZGNfbWVtX3R5cGVfdG9f
c3RyKHJlc291cmNlLT5tZW1fdHlwZSksDQorCQkJICAgbHNkY19ib19ncHVfb2Zmc2V0KGxibykp
Ow0KKwkJaSsrOw0KKwl9DQorDQorCW11dGV4X3VubG9jaygmbGRldi0+Z2VtLm11dGV4KTsNCisN
CisJc2VxX3ByaW50ZihtLCAiUGlubmVkIEJPIHNpemU6IFZSQU06ICV6dSBLQiwgR1RUOiAlenUg
S0JcbiIsDQorCQkgICBsZGV2LT52cmFtX3Bpbm5lZF9zaXplID4+IDEwLCBsZGV2LT5ndHRfcGlu
bmVkX3NpemUgPj4gMTApOw0KKw0KKwlyZXR1cm4gMDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2VtLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24v
bHNkY19nZW0uaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uN2Uw
NWU0NTNiNzMzDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24v
bHNkY19nZW0uaA0KQEAgLTAsMCArMSwzNyBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5v
bG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfR0VNX0hf
Xw0KKyNkZWZpbmUgX19MU0RDX0dFTV9IX18NCisNCisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2Uu
aD4NCisjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4NCisNCitzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
Kg0KK2xzZGNfcHJpbWVfaW1wb3J0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0K
KwkJCSAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwNCisJCQkgICBzdHJ1Y3Qg
c2dfdGFibGUgKnNnKTsNCisNCitpbnQgbHNkY19kdW1iX21hcF9vZmZzZXQoc3RydWN0IGRybV9m
aWxlICpmaWxlLA0KKwkJCSBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LA0KKwkJCSB1MzIgaGFuZGxl
LA0KKwkJCSB1aW50NjRfdCAqb2Zmc2V0KTsNCisNCitpbnQgbHNkY19kdW1iX2NyZWF0ZShzdHJ1
Y3QgZHJtX2ZpbGUgKmZpbGUsDQorCQkgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJ
ICAgICBzdHJ1Y3QgZHJtX21vZGVfY3JlYXRlX2R1bWIgKmFyZ3MpOw0KKw0KK3ZvaWQgbHNkY19n
ZW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldik7DQoraW50IGxzZGNfc2hvd19idWZmZXJf
b2JqZWN0KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKTsNCisNCitzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKg0KK2xzZGNfZ2VtX29iamVjdF9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYsDQorCQkgICAgICAgdTMyIGRvbWFpbiwNCisJCSAgICAgICBzaXplX3Qgc2l6ZSwNCisJCSAg
ICAgICBib29sIGtlcmVubCwNCisJCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLA0KKwkJICAg
ICAgIHN0cnVjdCBkbWFfcmVzdiAqcmVzdik7DQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2Z4cGxsLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19nZnhwbGwuYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAw
MDAwMC4uOTc3YjEyZGNiNzNjDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19nZnhwbGwuYw0KQEAgLTAsMCArMSwxOTkgQEANCisvLyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25n
c29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxs
aW51eC9kZWxheS5oPg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2ZpbGUuaD4NCisjaW5jbHVkZSA8
ZHJtL2RybV9tYW5hZ2VkLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4NCisNCisjaW5j
bHVkZSAibHNkY19kcnYuaCINCisNCisvKg0KKyAqIEdGWCBQTEwgaXMgdGhlIFBMTCB1c2VkIGJ5
IERDLCBHTUMgYW5kIEdQVSwgdGhlIHN0cnVjdHVyZSBvZiB0aGUgR0ZYIFBMTA0KKyAqIG1heSBz
dWZmZXIgZnJvbSBjaGFuZ2UgYWNyb3NzIGNoaXAgdmFyaWFudHMuDQorICoNCisgKg0KKyAqICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArLS0tLS0tLS0tLS0tLSsg
IHNlbF9vdXRfZGMNCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICst
LS0tfCAvIGRpdl9vdXRfMCB8IF9fX19fLyBfX19fXyBEQw0KKyAqICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfCAgICArLS0tLS0tLS0tLS0tLSsNCisgKiByZWZjbGsgICAr
LS0tLS0tLS0tKyAgICAgICstLS0tLS0tKyAgIHwgICAgKy0tLS0tLS0tLS0tLS0rICBzZWxfb3V0
X2dtYw0KKyAqIC0tLSstLS0+IHwgZGl2X3JlZiB8IC0tLT4gfCBsb29wYyB8IC0tKy0tPiB8IC8g
ZGl2X291dF8xIHwgX19fX18vIF9fX19fIEdNQw0KKyAqICAgIHwgICAgICstLS0tLS0tLS0rICAg
ICAgKy0tLS0tLS0rICAgfCAgICArLS0tLS0tLS0tLS0tLSsNCisgKiAgICB8ICAgICAgICAgIC8g
ICAgICAgICAgICAgICAqICAgICAgIHwgICAgKy0tLS0tLS0tLS0tLS0rICBzZWxfb3V0X2dwdQ0K
KyAqICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKy0tLS18IC8gZGl2X291
dF8yIHwgX19fX18vIF9fX19fIEdQVQ0KKyAqICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICArLS0tLS0tLS0tLS0tLSsNCisgKiAgICB8ICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXg0KKyAqICAgIHwgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8DQorICog
ICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBieXBhc3MgLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLSsNCisgKi8NCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2JpdG1hcCB7DQorCS8qIEJ5
dGUgMCB+IEJ5dGUgMyAqLw0KKwl1bnNpZ25lZCBkaXZfb3V0X2RjICAgIDogNzsgIC8qICA2IDog
MCAgICBEQyBvdXRwdXQgY2xvY2sgZGl2aWRlciAgKi8NCisJdW5zaWduZWQgZGl2X291dF9nbWMg
ICA6IDc7ICAvKiAxMyA6IDcgICAgR01DIG91dHB1dCBjbG9jayBkaXZpZGVyICovDQorCXVuc2ln
bmVkIGRpdl9vdXRfZ3B1ICAgOiA3OyAgLyogMjAgOiAxNCAgIEdQVSBvdXRwdXQgY2xvY2sgZGl2
aWRlciAqLw0KKwl1bnNpZ25lZCBsb29wYyAgICAgICAgIDogOTsgIC8qIDI5IDogMjEgICBjbG9j
ayBtdWx0aXBsaWVyICAgICAgICAgKi8NCisJdW5zaWduZWQgX3Jlc2VydmVkXzFfICA6IDI7ICAv
KiAzMSA6IDMwICAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorDQorCS8qIEJ5dGUgNCB+
IEJ5dGUgNyAqLw0KKwl1bnNpZ25lZCBkaXZfcmVmICAgICAgIDogNzsgICAvKiAzOCA6IDMyICAg
SW5wdXQgY2xvY2sgZGl2aWRlciAgICAqLw0KKwl1bnNpZ25lZCBsb2NrZWQgICAgICAgIDogMTsg
ICAvKiAzOSAgICAgICAgUExMIGxvY2tlZCBpbmRpY2F0b3IgICAqLw0KKwl1bnNpZ25lZCBzZWxf
b3V0X2RjICAgIDogMTsgICAvKiA0MCAgICAgICAgZGMgb3V0cHV0IGNsayBlbmFibGUgICAqLw0K
Kwl1bnNpZ25lZCBzZWxfb3V0X2dtYyAgIDogMTsgICAvKiA0MSAgICAgICAgZ21jIG91dHB1dCBj
bGsgZW5hYmxlICAqLw0KKwl1bnNpZ25lZCBzZWxfb3V0X2dwdSAgIDogMTsgICAvKiA0MiAgICAg
ICAgZ3B1IG91dHB1dCBjbGsgZW5hYmxlICAqLw0KKwl1bnNpZ25lZCBzZXRfcGFyYW0gICAgIDog
MTsgICAvKiA0MyAgICAgICAgVHJpZ2dlciB0aGUgdXBkYXRlICAgICAqLw0KKwl1bnNpZ25lZCBi
eXBhc3MgICAgICAgIDogMTsgICAvKiA0NCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAq
Lw0KKwl1bnNpZ25lZCBwb3dlcmRvd24gICAgIDogMTsgICAvKiA0NSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAqLw0KKwl1bnNpZ25lZCBfcmVzZXJ2ZWRfMl8gIDogMTg7ICAvKiA0NiA6
IDYzICAgbm8gdXNlICAgICAgICAgICAgICAgICAqLw0KK307DQorDQordW5pb24gbG9vbmdzb25f
Z2Z4cGxsX3JlZ19iaXRtYXAgew0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2JpdG1hcCBiaXRt
YXA7DQorCXUzMiB3WzJdOw0KKwl1NjQgZDsNCit9Ow0KKw0KK3N0YXRpYyB2b2lkIF9fZ2Z4cGxs
X3JyZWcoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqdGhpcywNCisJCQkgIHVuaW9uIGxvb25nc29u
X2dmeHBsbF9yZWdfYml0bWFwICpyZWcpDQorew0KKyNpZiBkZWZpbmVkKENPTkZJR182NEJJVCkN
CisJcmVnLT5kID0gcmVhZHEodGhpcy0+bW1pbyk7DQorI2Vsc2UNCisJcmVnLT53WzBdID0gcmVh
ZGwodGhpcy0+bW1pbyk7DQorCXJlZy0+d1sxXSA9IHJlYWRsKHRoaXMtPm1taW8gKyA0KTsNCisj
ZW5kaWYNCit9DQorDQorLyogVXBkYXRlIG5ldyBwYXJhbWV0ZXJzIHRvIHRoZSBoYXJkd2FyZSAq
Lw0KKw0KK3N0YXRpYyBpbnQgbG9vbmdzb25fZ2Z4cGxsX3VwZGF0ZShzdHJ1Y3QgbG9vbmdzb25f
Z2Z4cGxsICogY29uc3QgdGhpcywNCisJCQkJICBzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1z
IGNvbnN0ICpwaW4pDQorew0KKwkvKiBOb25lLCBUT0RPICovDQorDQorCXJldHVybiAwOw0KK30N
CisNCitzdGF0aWMgdm9pZCBsb29uZ3Nvbl9nZnhwbGxfZ2V0X3JhdGVzKHN0cnVjdCBsb29uZ3Nv
bl9nZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJCQkgICAgICB1bnNpZ25lZCBpbnQgKmRjLA0KKwkJ
CQkgICAgICB1bnNpZ25lZCBpbnQgKmdtYywNCisJCQkJICAgICAgdW5zaWduZWQgaW50ICpncHUp
DQorew0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1zICpwcGFybXMgPSAmdGhpcy0+cGFy
bXM7DQorCXVuaW9uIGxvb25nc29uX2dmeHBsbF9yZWdfYml0bWFwIGdmeHBsbF9yZWc7DQorCXVu
c2lnbmVkIGludCBwcmVfb3V0cHV0Ow0KKwl1bnNpZ25lZCBpbnQgZGNfbWh6Ow0KKwl1bnNpZ25l
ZCBpbnQgZ21jX21oejsNCisJdW5zaWduZWQgaW50IGdwdV9taHo7DQorDQorCV9fZ2Z4cGxsX3Jy
ZWcodGhpcywgJmdmeHBsbF9yZWcpOw0KKw0KKwlwcGFybXMtPmRpdl9yZWYgPSBnZnhwbGxfcmVn
LmJpdG1hcC5kaXZfcmVmOw0KKwlwcGFybXMtPmxvb3BjID0gZ2Z4cGxsX3JlZy5iaXRtYXAubG9v
cGM7DQorDQorCXBwYXJtcy0+ZGl2X291dF9kYyA9IGdmeHBsbF9yZWcuYml0bWFwLmRpdl9vdXRf
ZGM7DQorCXBwYXJtcy0+ZGl2X291dF9nbWMgPSBnZnhwbGxfcmVnLmJpdG1hcC5kaXZfb3V0X2dt
YzsNCisJcHBhcm1zLT5kaXZfb3V0X2dwdSA9IGdmeHBsbF9yZWcuYml0bWFwLmRpdl9vdXRfZ3B1
Ow0KKw0KKwlwcmVfb3V0cHV0ID0gcHBhcm1zLT5yZWZfY2xvY2sgLyBwcGFybXMtPmRpdl9yZWYg
KiBwcGFybXMtPmxvb3BjOw0KKw0KKwlkY19taHogPSBwcmVfb3V0cHV0IC8gcHBhcm1zLT5kaXZf
b3V0X2RjIC8gMTAwMDsNCisJZ21jX21oeiA9IHByZV9vdXRwdXQgLyBwcGFybXMtPmRpdl9vdXRf
Z21jIC8gMTAwMDsNCisJZ3B1X21oeiA9IHByZV9vdXRwdXQgLyBwcGFybXMtPmRpdl9vdXRfZ3B1
IC8gMTAwMDsNCisNCisJaWYgKGRjKQ0KKwkJKmRjID0gZGNfbWh6Ow0KKw0KKwlpZiAoZ21jKQ0K
KwkJKmdtYyA9IGdtY19taHo7DQorDQorCWlmIChncHUpDQorCQkqZ3B1ID0gZ3B1X21oejsNCit9
DQorDQorc3RhdGljIHZvaWQgbG9vbmdzb25fZ2Z4cGxsX3ByaW50KHN0cnVjdCBsb29uZ3Nvbl9n
ZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJCQkgIHN0cnVjdCBkcm1fcHJpbnRlciAqcCwNCisJCQkJ
ICBib29sIHZlcmJvc2UpDQorew0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1zICpwYXJt
cyA9ICZ0aGlzLT5wYXJtczsNCisJdW5zaWduZWQgaW50IGRjLCBnbWMsIGdwdTsNCisNCisJaWYg
KHZlcmJvc2UpIHsNCisJCWRybV9wcmludGYocCwgInJlZmVyZW5jZSBjbG9jazogJXVcbiIsIHBh
cm1zLT5yZWZfY2xvY2spOw0KKwkJZHJtX3ByaW50ZihwLCAiZGl2X3JlZiA9ICV1XG4iLCBwYXJt
cy0+ZGl2X3JlZik7DQorCQlkcm1fcHJpbnRmKHAsICJsb29wYyA9ICV1XG4iLCBwYXJtcy0+bG9v
cGMpOw0KKw0KKwkJZHJtX3ByaW50ZihwLCAiZGl2X291dF9kYyA9ICV1XG4iLCBwYXJtcy0+ZGl2
X291dF9kYyk7DQorCQlkcm1fcHJpbnRmKHAsICJkaXZfb3V0X2dtYyA9ICV1XG4iLCBwYXJtcy0+
ZGl2X291dF9nbWMpOw0KKwkJZHJtX3ByaW50ZihwLCAiZGl2X291dF9ncHUgPSAldVxuIiwgcGFy
bXMtPmRpdl9vdXRfZ3B1KTsNCisJfQ0KKw0KKwl0aGlzLT5mdW5jcy0+Z2V0X3JhdGVzKHRoaXMs
ICZkYywgJmdtYywgJmdwdSk7DQorDQorCWRybV9wcmludGYocCwgImRjOiAldU1IeiwgZ21jOiAl
dU1IeiwgZ3B1OiAldU1IelxuIiwgZGMsIGdtYywgZ3B1KTsNCit9DQorDQorLyogR0ZYIChEQywg
R1BVLCBHTUMpIFBMTCBpbml0aWFsaXphdGlvbiBhbmQgZGVzdHJveSBmdW5jdGlvbiAqLw0KKw0K
K3N0YXRpYyB2b2lkIGxvb25nc29uX2dmeHBsbF9maW5pKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2
LCB2b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0IGxvb25nc29uX2dmeHBsbCAqdGhpcyA9IChzdHJ1
Y3QgbG9vbmdzb25fZ2Z4cGxsICopZGF0YTsNCisNCisJaW91bm1hcCh0aGlzLT5tbWlvKTsNCisN
CisJa2ZyZWUodGhpcyk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbG9vbmdzb25fZ2Z4cGxsX2luaXQo
c3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMpDQorew0KKwlzdHJ1Y3QgbG9vbmdz
b25fZ2Z4cGxsX3Bhcm1zICpwcGFybXMgPSAmdGhpcy0+cGFybXM7DQorCXN0cnVjdCBkcm1fcHJp
bnRlciBwcmludGVyID0gZHJtX2luZm9fcHJpbnRlcih0aGlzLT5kZGV2LT5kZXYpOw0KKw0KKwlw
cGFybXMtPnJlZl9jbG9jayA9IExTRENfUExMX1JFRl9DTEs7DQorDQorCXRoaXMtPm1taW8gPSBp
b3JlbWFwKHRoaXMtPnJlZ19iYXNlLCB0aGlzLT5yZWdfc2l6ZSk7DQorCWlmIChJU19FUlJfT1Jf
TlVMTCh0aGlzLT5tbWlvKSkNCisJCXJldHVybiAtRU5PTUVNOw0KKw0KKwl0aGlzLT5mdW5jcy0+
cHJpbnQodGhpcywgJnByaW50ZXIsIGZhbHNlKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2Z1bmNzIGxzZGNfZ21jX2dwdV9mdW5j
cyA9IHsNCisJLmluaXQgPSBsb29uZ3Nvbl9nZnhwbGxfaW5pdCwNCisJLnVwZGF0ZSA9IGxvb25n
c29uX2dmeHBsbF91cGRhdGUsDQorCS5nZXRfcmF0ZXMgPSBsb29uZ3Nvbl9nZnhwbGxfZ2V0X3Jh
dGVzLA0KKwkucHJpbnQgPSBsb29uZ3Nvbl9nZnhwbGxfcHJpbnQsDQorfTsNCisNCitpbnQgbG9v
bmdzb25fZ2Z4cGxsX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICBzdHJ1
Y3QgbG9vbmdzb25fZ2Z4cGxsICoqcHBvdXQpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxk
ZXYgPSB0b19sc2RjKGRkZXYpOw0KKwljb25zdCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4X2Rlc2MgKmdm
eCA9IHRvX2xvb25nc29uX2dmeChsZGV2LT5kZXNjcCk7DQorCXN0cnVjdCBsb29uZ3Nvbl9nZnhw
bGwgKnRoaXM7DQorCWludCByZXQ7DQorDQorCXRoaXMgPSBremFsbG9jKHNpemVvZigqdGhpcyks
IEdGUF9LRVJORUwpOw0KKwlpZiAoSVNfRVJSX09SX05VTEwodGhpcykpDQorCQlyZXR1cm4gLUVO
T01FTTsNCisNCisJdGhpcy0+ZGRldiA9IGRkZXY7DQorCXRoaXMtPnJlZ19zaXplID0gZ2Z4LT5n
ZnhwbGwucmVnX3NpemU7DQorCXRoaXMtPnJlZ19iYXNlID0gZ2Z4LT5jb25mX3JlZ19iYXNlICsg
Z2Z4LT5nZnhwbGwucmVnX29mZnNldDsNCisJdGhpcy0+ZnVuY3MgPSAmbHNkY19nbWNfZ3B1X2Z1
bmNzOw0KKw0KKwlyZXQgPSB0aGlzLT5mdW5jcy0+aW5pdCh0aGlzKTsNCisJaWYgKHVubGlrZWx5
KHJldCkpIHsNCisJCWtmcmVlKHRoaXMpOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwkqcHBv
dXQgPSB0aGlzOw0KKw0KKwlyZXR1cm4gZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0KGRkZXYsIGxv
b25nc29uX2dmeHBsbF9maW5pLCB0aGlzKTsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfZ2Z4cGxsLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19nZnhwbGwuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZjVl
YmE2NzY1ODEyDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24v
bHNkY19nZnhwbGwuaA0KQEAgLTAsMCArMSw1MiBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlm
aWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVj
aG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfR0ZY
UExMX0hfXw0KKyNkZWZpbmUgX19MU0RDX0dGWFBMTF9IX18NCisNCisjaW5jbHVkZSA8ZHJtL2Ry
bV9kZXZpY2UuaD4NCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsOw0KKw0KK3N0cnVjdCBsb29u
Z3Nvbl9nZnhwbGxfcGFybXMgew0KKwl1bnNpZ25lZCBpbnQgcmVmX2Nsb2NrOw0KKwl1bnNpZ25l
ZCBpbnQgZGl2X3JlZjsNCisJdW5zaWduZWQgaW50IGxvb3BjOw0KKwl1bnNpZ25lZCBpbnQgZGl2
X291dF9kYzsNCisJdW5zaWduZWQgaW50IGRpdl9vdXRfZ21jOw0KKwl1bnNpZ25lZCBpbnQgZGl2
X291dF9ncHU7DQorfTsNCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2Z1bmNzIHsNCisJaW50
ICgqaW5pdCkoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMpOw0KKw0KKwlpbnQg
KCp1cGRhdGUpKHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJICAgICAg
c3RydWN0IGxvb25nc29uX2dmeHBsbF9wYXJtcyBjb25zdCAqcGluKTsNCisNCisJdm9pZCAoKmdl
dF9yYXRlcykoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJICB1bnNp
Z25lZCBpbnQgKmRjLCB1bnNpZ25lZCBpbnQgKmdtYywgdW5zaWduZWQgaW50ICpncHUpOw0KKw0K
Kwl2b2lkICgqcHJpbnQpKHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJ
ICAgICAgc3RydWN0IGRybV9wcmludGVyICpwcmludGVyLCBib29sIHZlcmJvc2UpOw0KK307DQor
DQorc3RydWN0IGxvb25nc29uX2dmeHBsbCB7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2Ow0K
Kwl2b2lkIF9faW9tZW0gKm1taW87DQorDQorCS8qIFBMTCByZWdpc3RlciBvZmZzZXQgKi8NCisJ
dTMyIHJlZ19iYXNlOw0KKwkvKiBQTEwgcmVnaXN0ZXIgc2l6ZSBpbiBieXRlcyAqLw0KKwl1MzIg
cmVnX3NpemU7DQorDQorCWNvbnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGxfZnVuY3MgKmZ1bmNz
Ow0KKw0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1zIHBhcm1zOw0KK307DQorDQoraW50
IGxvb25nc29uX2dmeHBsbF9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICAg
c3RydWN0IGxvb25nc29uX2dmeHBsbCAqKnBwb3V0KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pMmMuYyBiL2RyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX2kyYy5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAw
MDAwLi5kNjQ3MTJhNDYwOTgNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX2kyYy5jDQpAQCAtMCwwICsxLDE3OSBAQA0KKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24g
VGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGRybS9k
cm1fbWFuYWdlZC5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKyNpbmNsdWRlICJsc2Rj
X291dHB1dC5oIg0KKw0KKy8qDQorICogX19sc2RjX2dwaW9faTJjX3NldCAtIHNldCB0aGUgc3Rh
dGUgb2YgYSBncGlvIHBpbiBpbmRpY2F0ZWQgYnkgbWFzaw0KKyAqIEBtYXNrOiBncGlvIHBpbiBt
YXNrDQorICogQHN0YXRlOiAiMCIgZm9yIGxvdywgIjEiIGZvciBoaWdoDQorICovDQorc3RhdGlj
IHZvaWQgX19sc2RjX2dwaW9faTJjX3NldChzdHJ1Y3QgbHNkY19pMmMgKiBjb25zdCBsaTJjLCBp
bnQgbWFzaywgaW50IHN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9f
bHNkYyhsaTJjLT5kZGV2KTsNCisJdW5zaWduZWQgbG9uZyBmbGFnczsNCisJdTggdmFsOw0KKw0K
KwlzcGluX2xvY2tfaXJxc2F2ZSgmbGRldi0+cmVnbG9jaywgZmxhZ3MpOw0KKw0KKwlpZiAoc3Rh
dGUpIHsNCisJCS8qDQorCQkgKiBTZXR0aW5nIHRoaXMgcGluIGFzIGlucHV0IGRpcmVjdGx5LCB3
cml0ZSAxIGZvciBpbnB1dC4NCisJCSAqIFRoZSBleHRlcm5hbCBwdWxsLXVwIHJlc2lzdG9yIHdp
bGwgcHVsbCB0aGUgbGV2ZWwgdXANCisJCSAqLw0KKwkJdmFsID0gcmVhZGIobGkyYy0+ZGlyX3Jl
Zyk7DQorCQl2YWwgfD0gbWFzazsNCisJCXdyaXRlYih2YWwsIGxpMmMtPmRpcl9yZWcpOw0KKwl9
IGVsc2Ugew0KKwkJLyogRmlyc3Qgc2V0IHRoaXMgcGluIGFzIG91dHB1dCwgd3JpdGUgMCBmb3Ig
b3V0cHV0ICovDQorCQl2YWwgPSByZWFkYihsaTJjLT5kaXJfcmVnKTsNCisJCXZhbCAmPSB+bWFz
azsNCisJCXdyaXRlYih2YWwsIGxpMmMtPmRpcl9yZWcpOw0KKw0KKwkJLyogVGhlbiwgbWFrZSB0
aGlzIHBpbiBvdXRwdXQgMCAqLw0KKwkJdmFsID0gcmVhZGIobGkyYy0+ZGF0X3JlZyk7DQorCQl2
YWwgJj0gfm1hc2s7DQorCQl3cml0ZWIodmFsLCBsaTJjLT5kYXRfcmVnKTsNCisJfQ0KKw0KKwlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZsZGV2LT5yZWdsb2NrLCBmbGFncyk7DQorfQ0KKw0KKy8q
DQorICogX19sc2RjX2dwaW9faTJjX2dldCAtIHJlYWQgdmFsdWUgYmFjayBmcm9tIHRoZSBncGlv
IHBpbiBpbmRpY2F0ZWQgYnkgbWFzaw0KKyAqIEBtYXNrOiBncGlvIHBpbiBtYXNrDQorICogcmV0
dXJuICIwIiBmb3IgbG93LCAiMSIgZm9yIGhpZ2gNCisgKi8NCitzdGF0aWMgaW50IF9fbHNkY19n
cGlvX2kyY19nZXQoc3RydWN0IGxzZGNfaTJjICogY29uc3QgbGkyYywgaW50IG1hc2spDQorew0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGxpMmMtPmRkZXYpOw0KKwl1bnNp
Z25lZCBsb25nIGZsYWdzOw0KKwl1OCB2YWw7DQorDQorCXNwaW5fbG9ja19pcnFzYXZlKCZsZGV2
LT5yZWdsb2NrLCBmbGFncyk7DQorDQorCS8qIEZpcnN0IHNldCB0aGlzIHBpbiBhcyBpbnB1dCAq
Lw0KKwl2YWwgPSByZWFkYihsaTJjLT5kaXJfcmVnKTsNCisJdmFsIHw9IG1hc2s7DQorCXdyaXRl
Yih2YWwsIGxpMmMtPmRpcl9yZWcpOw0KKw0KKwkvKiBUaGVuIGdldCBsZXZlbCBzdGF0ZSBmcm9t
IHRoaXMgcGluICovDQorCXZhbCA9IHJlYWRiKGxpMmMtPmRhdF9yZWcpOw0KKw0KKwlzcGluX3Vu
bG9ja19pcnFyZXN0b3JlKCZsZGV2LT5yZWdsb2NrLCBmbGFncyk7DQorDQorCXJldHVybiAodmFs
ICYgbWFzaykgPyAxIDogMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19ncGlvX2kyY19zZXRf
c2RhKHZvaWQgKmkyYywgaW50IHN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfaTJjICogY29uc3Qg
bGkyYyA9IChzdHJ1Y3QgbHNkY19pMmMgKilpMmM7DQorCS8qIHNldCBzdGF0ZSBvbiB0aGUgbGky
Yy0+c2RhIHBpbiAqLw0KKwlyZXR1cm4gX19sc2RjX2dwaW9faTJjX3NldChsaTJjLCBsaTJjLT5z
ZGEsIHN0YXRlKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19ncGlvX2kyY19zZXRfc2NsKHZv
aWQgKmkyYywgaW50IHN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfaTJjICogY29uc3QgbGkyYyA9
IChzdHJ1Y3QgbHNkY19pMmMgKilpMmM7DQorCS8qIHNldCBzdGF0ZSBvbiB0aGUgbGkyYy0+c2Ns
IHBpbiAqLw0KKwlyZXR1cm4gX19sc2RjX2dwaW9faTJjX3NldChsaTJjLCBsaTJjLT5zY2wsIHN0
YXRlKTsNCit9DQorDQorc3RhdGljIGludCBsc2RjX2dwaW9faTJjX2dldF9zZGEodm9pZCAqaTJj
KQ0KK3sNCisJc3RydWN0IGxzZGNfaTJjICogY29uc3QgbGkyYyA9IChzdHJ1Y3QgbHNkY19pMmMg
KilpMmM7DQorCS8qIHJlYWQgdmFsdWUgZnJvbSB0aGUgbGkyYy0+c2RhIHBpbiAqLw0KKwlyZXR1
cm4gX19sc2RjX2dwaW9faTJjX2dldChsaTJjLCBsaTJjLT5zZGEpOw0KK30NCisNCitzdGF0aWMg
aW50IGxzZGNfZ3Bpb19pMmNfZ2V0X3NjbCh2b2lkICppMmMpDQorew0KKwlzdHJ1Y3QgbHNkY19p
MmMgKiBjb25zdCBsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAqKWkyYzsNCisJLyogcmVhZCB0aGUg
dmFsdWUgZnJvbSB0aGUgbGkyYy0+c2NsIHBpbiAqLw0KKwlyZXR1cm4gX19sc2RjX2dwaW9faTJj
X2dldChsaTJjLCBsaTJjLT5zY2wpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2Rlc3Ryb3lf
aTJjKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LCB2b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0IGxz
ZGNfaTJjICpsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAqKWRhdGE7DQorDQorCWlmIChsaTJjKSB7
DQorCQlpMmNfZGVsX2FkYXB0ZXIoJmxpMmMtPmFkYXB0ZXIpOw0KKwkJa2ZyZWUobGkyYyk7DQor
CX0NCit9DQorDQorLyoNCisgKiBUaGUgREMgaW4gbHM3YTEwMDAvbHM3YTIwMDAvbHMyazIwMDAg
aGFzIGJ1aWx0aW4gZ3BpbyBoYXJkd2FyZQ0KKyAqDQorICogQHJlZ19iYXNlOiBncGlvIHJlZyBi
YXNlDQorICogQGluZGV4OiBvdXRwdXQgY2hhbm5lbCBpbmRleCwgMCBmb3IgUElQRTAsIDEgZm9y
IFBJUEUxDQorICovDQoraW50IGxzZGNfY3JlYXRlX2kyY19jaGFuKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJIHVu
c2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xz
ZGMoZGRldik7DQorCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcjsNCisJc3RydWN0IGxzZGNf
aTJjICpsaTJjOw0KKwlpbnQgcmV0Ow0KKw0KKwlsaTJjID0ga3phbGxvYyhzaXplb2YoKmxpMmMp
LCBHRlBfS0VSTkVMKTsNCisJaWYgKCFsaTJjKQ0KKwkJcmV0dXJuIC1FTk9NRU07DQorDQorCWRp
c3BpcGUtPmxpMmMgPSBsaTJjOw0KKw0KKwlpZiAoaW5kZXggPT0gMCkgew0KKwkJbGkyYy0+c2Rh
ID0gMHgwMTsgIC8qIHBpbiAwICovDQorCQlsaTJjLT5zY2wgPSAweDAyOyAgLyogcGluIDEgKi8N
CisJfSBlbHNlIGlmIChpbmRleCA9PSAxKSB7DQorCQlsaTJjLT5zZGEgPSAweDA0OyAgLyogcGlu
IDIgKi8NCisJCWxpMmMtPnNjbCA9IDB4MDg7ICAvKiBwaW4gMyAqLw0KKwl9IGVsc2Ugew0KKwkJ
cmV0dXJuIC1FTk9FTlQ7DQorCX0NCisNCisJbGkyYy0+ZGRldiA9IGRkZXY7DQorCWxpMmMtPmRp
cl9yZWcgPSBsZGV2LT5yZWdfYmFzZSArIExTN0FfRENfR1BJT19ESVJfUkVHOw0KKwlsaTJjLT5k
YXRfcmVnID0gbGRldi0+cmVnX2Jhc2UgKyBMUzdBX0RDX0dQSU9fREFUX1JFRzsNCisNCisJbGky
Yy0+Yml0LnNldHNkYSA9IGxzZGNfZ3Bpb19pMmNfc2V0X3NkYTsNCisJbGkyYy0+Yml0LnNldHNj
bCA9IGxzZGNfZ3Bpb19pMmNfc2V0X3NjbDsNCisJbGkyYy0+Yml0LmdldHNkYSA9IGxzZGNfZ3Bp
b19pMmNfZ2V0X3NkYTsNCisJbGkyYy0+Yml0LmdldHNjbCA9IGxzZGNfZ3Bpb19pMmNfZ2V0X3Nj
bDsNCisJbGkyYy0+Yml0LnVkZWxheSA9IDU7DQorCWxpMmMtPmJpdC50aW1lb3V0ID0gdXNlY3Nf
dG9famlmZmllcygyMjAwKTsNCisJbGkyYy0+Yml0LmRhdGEgPSBsaTJjOw0KKw0KKwlhZGFwdGVy
ID0gJmxpMmMtPmFkYXB0ZXI7DQorCWFkYXB0ZXItPmFsZ29fZGF0YSA9ICZsaTJjLT5iaXQ7DQor
CWFkYXB0ZXItPm93bmVyID0gVEhJU19NT0RVTEU7DQorCWFkYXB0ZXItPmNsYXNzID0gSTJDX0NM
QVNTX0REQzsNCisJYWRhcHRlci0+ZGV2LnBhcmVudCA9IGRkZXYtPmRldjsNCisJYWRhcHRlci0+
bnIgPSAtMTsNCisNCisJc25wcmludGYoYWRhcHRlci0+bmFtZSwgc2l6ZW9mKGFkYXB0ZXItPm5h
bWUpLCAibHNkYy1pMmMldSIsIGluZGV4KTsNCisNCisJaTJjX3NldF9hZGFwZGF0YShhZGFwdGVy
LCBsaTJjKTsNCisNCisJcmV0ID0gaTJjX2JpdF9hZGRfYnVzKGFkYXB0ZXIpOw0KKwlpZiAocmV0
KSB7DQorCQlrZnJlZShsaTJjKTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJcmV0ID0gZHJt
bV9hZGRfYWN0aW9uX29yX3Jlc2V0KGRkZXYsIGxzZGNfZGVzdHJveV9pMmMsIGxpMmMpOw0KKwlp
ZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZHJtX2luZm8oZGRldiwgIiVzKHNkYSBwaW4g
bWFzaz0ldSwgc2NsIHBpbiBtYXNrPSV1KSBjcmVhdGVkXG4iLA0KKwkJIGFkYXB0ZXItPm5hbWUs
IGxpMmMtPnNkYSwgbGkyYy0+c2NsKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2kyYy5oIGIvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfaTJjLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAw
MDAuLmMzZGFkYzJjNDIzZA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfaTJjLmgNCkBAIC0wLDAgKzEsMjkgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMCAqLw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29u
IFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5kZWYgX19MU0RD
X0kyQ19IX18NCisjZGVmaW5lIF9fTFNEQ19JMkNfSF9fDQorDQorI2luY2x1ZGUgPGxpbnV4L2ky
Yy5oPg0KKyNpbmNsdWRlIDxsaW51eC9pMmMtYWxnby1iaXQuaD4NCisNCitzdHJ1Y3QgbHNkY19p
MmMgew0KKwlzdHJ1Y3QgaTJjX2FkYXB0ZXIgYWRhcHRlcjsNCisJc3RydWN0IGkyY19hbGdvX2Jp
dF9kYXRhIGJpdDsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXY7DQorCXZvaWQgX19pb21lbSAq
ZGlyX3JlZzsNCisJdm9pZCBfX2lvbWVtICpkYXRfcmVnOw0KKwkvKiBwaW4gYml0IG1hc2sgKi8N
CisJdTggc2RhOw0KKwl1OCBzY2w7DQorfTsNCisNCitzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGU7
DQorDQoraW50IGxzZGNfY3JlYXRlX2kyY19jaGFuKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0K
KwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJIHVuc2lnbmVkIGlu
dCBpbmRleCk7DQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEuYw0KbmV3
IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZTRlZTBiNjA4MDIzDQotLS0g
L2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEuYw0KQEAg
LTAsMCArMSw3MSBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQorLyoN
CisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBM
aW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+DQorDQorI2luY2x1
ZGUgImxzZGNfaXJxLmgiDQorDQorLyoNCisgKiBGb3IgdGhlIERDIGluIGxzN2EyMDAwLCBjbGVh
cmluZyBpbnRlcnJ1cHQgc3RhdHVzIGlzIGFjaGlldmVkIGJ5DQorICogd3JpdGUgIjEiIHRvIExT
RENfSU5UX1JFRywgRm9yIHRoZSBEQyBpbiBsczdhMTAwMCwgY2xlYXIgaW50ZXJydXB0DQorICog
c3RhdHVzIGlzIGFjaGlldmVkIGJ5IHdyaXRlICIwIiB0byBMU0RDX0lOVF9SRUcuIFR3byBkaWZm
ZXJlbnQgaGFyZHdhcmUNCisgKiBlbmdpbmVlciBvZiBMb29uZ3NvbiBtb2RpZnkgaXQgYXMgdGhl
aXIgd2lsbC4NCisgKi8NCisNCitpcnFyZXR1cm5fdCBsczdhMjAwMF9kY19pcnFfaGFuZGxlcihp
bnQgaXJxLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGFyZzsN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJdTMyIHZhbDsN
CisNCisJLyogUmVhZCB0aGUgaW50ZXJydXB0IHN0YXR1cyAqLw0KKwl2YWwgPSBsc2RjX3JyZWcz
MihsZGV2LCBMU0RDX0lOVF9SRUcpOw0KKwlpZiAoKHZhbCAmIElOVF9TVEFUVVNfTUFTSykgPT0g
MCkgew0KKwkJZHJtX3dhcm4oZGRldiwgIm5vIGludGVycnVwdCBvY2N1cnNcbiIpOw0KKwkJcmV0
dXJuIElSUV9OT05FOw0KKwl9DQorDQorCWxkZXYtPmlycV9zdGF0dXMgPSB2YWw7DQorDQorCS8q
IHdyaXRlICIxIiB0byBjbGVhciB0aGUgaW50ZXJydXB0IHN0YXR1cyAqLw0KKwlsc2RjX3dyZWcz
MihsZGV2LCBMU0RDX0lOVF9SRUcsIHZhbCk7DQorDQorCWlmIChsZGV2LT5pcnFfc3RhdHVzICYg
SU5UX0NSVEMwX1ZTWU5DKQ0KKwkJZHJtX2hhbmRsZV92YmxhbmsoZGRldiwgMCk7DQorDQorCWlm
IChsZGV2LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMxX1ZTWU5DKQ0KKwkJZHJtX2hhbmRsZV92Ymxh
bmsoZGRldiwgMSk7DQorDQorCXJldHVybiBJUlFfSEFORExFRDsNCit9DQorDQorLyogRm9yIHRo
ZSBEQyBpbiBMUzdBMTAwMCBhbmQgTFMySzEwMDAgKi8NCitpcnFyZXR1cm5fdCBsczdhMTAwMF9k
Y19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGRldiA9IGFyZzsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2
KTsNCisJdTMyIHZhbDsNCisNCisJLyogUmVhZCB0aGUgaW50ZXJydXB0IHN0YXR1cyAqLw0KKwl2
YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0lOVF9SRUcpOw0KKwlpZiAoKHZhbCAmIElOVF9T
VEFUVVNfTUFTSykgPT0gMCkgew0KKwkJZHJtX3dhcm4oZGRldiwgIm5vIGludGVycnVwdCBvY2N1
cnNcbiIpOw0KKwkJcmV0dXJuIElSUV9OT05FOw0KKwl9DQorDQorCWxkZXYtPmlycV9zdGF0dXMg
PSB2YWw7DQorDQorCS8qIHdyaXRlICIwIiB0byBjbGVhciB0aGUgaW50ZXJydXB0IHN0YXR1cyAq
Lw0KKwl2YWwgJj0gfihJTlRfQ1JUQzBfVlNZTkMgfCBJTlRfQ1JUQzFfVlNZTkMpOw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0lOVF9SRUcsIHZhbCk7DQorDQorCWlmIChsZGV2LT5pcnFfc3Rh
dHVzICYgSU5UX0NSVEMwX1ZTWU5DKQ0KKwkJZHJtX2hhbmRsZV92YmxhbmsoZGRldiwgMCk7DQor
DQorCWlmIChsZGV2LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMxX1ZTWU5DKQ0KKwkJZHJtX2hhbmRs
ZV92YmxhbmsoZGRldiwgMSk7DQorDQorCXJldHVybiBJUlFfSEFORExFRDsNCit9DQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfaXJxLmggYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19pcnEuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAw
MDAwMDAwMC4uYzcwMDM0NjEwNTFlDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19pcnEuaA0KQEAgLTAsMCArMSwxNiBAQA0KKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9v
bmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBf
X0xTRENfSVJRX0hfXw0KKyNkZWZpbmUgX19MU0RDX0lSUV9IX18NCisNCisjaW5jbHVkZSA8bGlu
dXgvaXJxcmV0dXJuLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQoraXJxcmV0dXJu
X3QgbHM3YTEwMDBfZGNfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKTsNCitpcnFyZXR1
cm5fdCBsczdhMjAwMF9kY19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpOw0KKw0KKyNl
bmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX291dHB1dC5o
IGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0LmgNCm5ldyBmaWxlIG1vZGUg
MTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmUzYzM3NTI5ODU2OA0KLS0tIC9kZXYvbnVsbA0K
KysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0LmgNCkBAIC0wLDAgKzEs
MjEgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLw0KKy8qDQorICog
Q29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRl
ZA0KKyAqLw0KKw0KKyNpZm5kZWYgX19MU0RDX09VVFBVVF9IX18NCisjZGVmaW5lIF9fTFNEQ19P
VVRQVVRfSF9fDQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQoraW50IGxzN2ExMDAwX291
dHB1dF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNw
bGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJIHN0cnVjdCBpMmNfYWRhcHRlciAqZGRjLA0KKwkJCSB1
bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0KK2ludCBsczdhMjAwMF9vdXRwdXRfaW5pdChzdHJ1Y3Qg
ZHJtX2RldmljZSAqbGRldiwNCisJCQkgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBl
LA0KKwkJCSBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmRkYywNCisJCQkgdW5zaWduZWQgaW50IGluZGV4
KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19vdXRwdXRfN2ExMDAwLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19vdXRwdXRf
N2ExMDAwLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjQ1NjAy
Y2M3Y2NmOQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfb3V0cHV0XzdhMTAwMC5jDQpAQCAtMCwwICsxLDE2MSBAQA0KKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24g
VGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGRybS9k
cm1fYXRvbWljX2hlbHBlci5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4NCisjaW5jbHVk
ZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4NCisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisj
aW5jbHVkZSAibHNkY19vdXRwdXQuaCINCisNCisvKg0KKyAqIEN1cnJlbnRseSwgd2UgYXNzdW1l
IHRoZSBleHRlcm5hbCBlbmNvZGVycyBjb25uZWN0ZWQgd2l0aCB0aGUgRFZPIGlzDQorICogdHJh
bnNwYXJlbnQuIExvb25nc29uIERWTyBpbnRlcmZhY2UgY2FuIGRpcmVjdGx5IGRyaXZlIFJHQjg4
OCBwYW5lbHMuDQorICoNCisgKiAgVE9ETzogQWRkIHN1cHBvcnQgZm9yIG5vbi10cmFuc3BhcmVu
dCBlbmNvZGVycyAuLi4NCisgKi8NCisNCitzdGF0aWMgaW50IGxzN2ExMDAwX2RwaV9jb25uZWN0
b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uKQ0KK3sNCisJdW5zaWduZWQg
aW50IG51bSA9IDA7DQorCXN0cnVjdCBlZGlkICplZGlkOw0KKw0KKwlpZiAoY29ubi0+ZGRjKSB7
DQorCQllZGlkID0gZHJtX2dldF9lZGlkKGNvbm4sIGNvbm4tPmRkYyk7DQorCQlpZiAoZWRpZCkg
ew0KKwkJCWRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubiwgZWRpZCk7DQor
CQkJbnVtID0gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm4sIGVkaWQpOw0KKwkJCWtmcmVlKGVkaWQp
Ow0KKwkJfQ0KKw0KKwkJcmV0dXJuIG51bTsNCisJfQ0KKw0KKwludW0gPSBkcm1fYWRkX21vZGVz
X25vZWRpZChjb25uLCAxOTIwLCAxMjAwKTsNCisNCisJZHJtX3NldF9wcmVmZXJyZWRfbW9kZShj
b25uLCAxMDI0LCA3NjgpOw0KKw0KKwlyZXR1cm4gbnVtOw0KK30NCisNCitzdGF0aWMgc3RydWN0
IGRybV9lbmNvZGVyICoNCitsczdhMTAwMF9kcGlfY29ubmVjdG9yX2dldF9iZXN0X2VuY29kZXIo
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwNCisJCQkJCXN0cnVjdCBkcm1fYXRvbWlj
X3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0ID0gY29ubmVj
dG9yX3RvX2xzZGNfb3V0cHV0KGNvbm5lY3Rvcik7DQorDQorCXJldHVybiAmb3V0cHV0LT5lbmNv
ZGVyOw0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1
bmNzDQorbHM3YTEwMDBfZHBpX2Nvbm5lY3Rvcl9oZWxwZXJzID0gew0KKwkuYXRvbWljX2Jlc3Rf
ZW5jb2RlciA9IGxzN2ExMDAwX2RwaV9jb25uZWN0b3JfZ2V0X2Jlc3RfZW5jb2RlciwNCisJLmdl
dF9tb2RlcyA9IGxzN2ExMDAwX2RwaV9jb25uZWN0b3JfZ2V0X21vZGVzLA0KK307DQorDQorc3Rh
dGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMNCitsczdhMTAwMF9kcGlfY29ubmVjdG9yX2Rl
dGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQ0KK3sNCisJ
c3RydWN0IGkyY19hZGFwdGVyICpkZGMgPSBjb25uZWN0b3ItPmRkYzsNCisNCisJaWYgKGRkYykg
ew0KKwkJaWYgKGRybV9wcm9iZV9kZGMoZGRjKSkNCisJCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1
c19jb25uZWN0ZWQ7DQorDQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7
DQorCX0NCisNCisJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfdW5rbm93bjsNCit9DQorDQorc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGxzN2ExMDAwX2RwaV9jb25uZWN0
b3JfZnVuY3MgPSB7DQorCS5kZXRlY3QgPSBsczdhMTAwMF9kcGlfY29ubmVjdG9yX2RldGVjdCwN
CisJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0b3JfbW9kZXMs
DQorCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLA0KKwkucmVzZXQgPSBkcm1fYXRv
bWljX2hlbHBlcl9jb25uZWN0b3JfcmVzZXQsDQorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlID0g
ZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwNCisJLmF0b21pY19k
ZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ryb3lfc3RhdGUN
Cit9Ow0KKw0KK3N0YXRpYyB2b2lkIGxzN2ExMDAwX3BpcGUwX2VuY29kZXJfcmVzZXQoc3RydWN0
IGRybV9lbmNvZGVyICplbmNvZGVyKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBl
bmNvZGVyLT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7
DQorDQorCS8qDQorCSAqIFdlIG5lZWQgdGhpcywgZm9yIFMzIHJlc3VtZSwgc2NyZWVuIHdpbGwg
bm90IGxpZ2h0dXAgaWYgZG9uJ3Qgc2V0DQorCSAqIGNvcnJlY3RseS4NCisJICovDQorCWxzZGNf
d3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfUEFORUxfQ09ORl9SRUcsDQorCQkgICAgUEhZX0NMT0NL
X1BPTCB8IFBIWV9DTE9DS19FTiB8IFBIWV9EQVRBX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQg
bHM3YTEwMDBfcGlwZTFfZW5jb2Rlcl9yZXNldChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIp
DQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29kZXItPmRldjsNCisJc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisNCisJLyoNCisJICogV2UgbmVl
ZCB0aGlzLCBmb3IgUzMgcmVzdW1lLCBzY3JlZW4gd2lsbCBub3QgbGlnaHQgdXANCisJICogaWYg
d2UgZG9uJ3Qgc2V0IHNldHRpbmcgdGhpcyByZWdpc3RlciBjb3JyZWN0bHkuDQorCSAqLw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1BBTkVMX0NPTkZfUkVHLA0KKwkJICAgIFBIWV9D
TE9DS19QT0wgfCBQSFlfQ0xPQ0tfRU4gfCBQSFlfREFUQV9FTik7DQorfQ0KKw0KK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfZnVuY3MgbHM3YTEwMDBfZW5jb2Rlcl9mdW5jc1syXSA9
IHsNCisJew0KKwkJLnJlc2V0ID0gbHM3YTEwMDBfcGlwZTBfZW5jb2Rlcl9yZXNldCwNCisJCS5k
ZXN0cm95ID0gZHJtX2VuY29kZXJfY2xlYW51cCwNCisJfSwNCisJew0KKwkJLnJlc2V0ID0gbHM3
YTEwMDBfcGlwZTFfZW5jb2Rlcl9yZXNldCwNCisJCS5kZXN0cm95ID0gZHJtX2VuY29kZXJfY2xl
YW51cCwNCisJfSwNCit9Ow0KKw0KK2ludCBsczdhMTAwMF9vdXRwdXRfaW5pdChzdHJ1Y3QgZHJt
X2RldmljZSAqZGRldiwNCisJCQkgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBlLA0K
KwkJCSBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmRkYywNCisJCQkgdW5zaWduZWQgaW50IGluZGV4KQ0K
K3sNCisJc3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQgPSAmZGlzcGlwZS0+b3V0cHV0Ow0KKwlz
dHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAmb3V0cHV0LT5lbmNvZGVyOw0KKwlzdHJ1Y3Qg
ZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gJm91dHB1dC0+Y29ubmVjdG9yOw0KKwlpbnQgcmV0
Ow0KKw0KKwlyZXQgPSBkcm1fZW5jb2Rlcl9pbml0KGRkZXYsDQorCQkJICAgICAgIGVuY29kZXIs
DQorCQkJICAgICAgICZsczdhMTAwMF9lbmNvZGVyX2Z1bmNzW2luZGV4XSwNCisJCQkgICAgICAg
RFJNX01PREVfRU5DT0RFUl9UTURTLA0KKwkJCSAgICAgICAiZW5jb2Rlci0ldSIsDQorCQkJICAg
ICAgIGluZGV4KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWVuY29kZXItPnBv
c3NpYmxlX2NydGNzID0gQklUKGluZGV4KTsNCisNCisJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9pbml0
X3dpdGhfZGRjKGRkZXYsDQorCQkJCQkgIGNvbm5lY3RvciwNCisJCQkJCSAgJmxzN2ExMDAwX2Rw
aV9jb25uZWN0b3JfZnVuY3MsDQorCQkJCQkgIERSTV9NT0RFX0NPTk5FQ1RPUl9EUEksDQorCQkJ
CQkgIGRkYyk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1faW5mbyhkZGV2
LCAiZGlzcGxheSBwaXBlLSV1IGhhcyBhIERWT1xuIiwgaW5kZXgpOw0KKw0KKwlkcm1fY29ubmVj
dG9yX2hlbHBlcl9hZGQoY29ubmVjdG9yLCAmbHM3YTEwMDBfZHBpX2Nvbm5lY3Rvcl9oZWxwZXJz
KTsNCisNCisJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIp
Ow0KKw0KKwljb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9DT05ORUNUIHwN
CisJCQkgICAgRFJNX0NPTk5FQ1RPUl9QT0xMX0RJU0NPTk5FQ1Q7DQorDQorCWNvbm5lY3Rvci0+
aW50ZXJsYWNlX2FsbG93ZWQgPSAwOw0KKwljb25uZWN0b3ItPmRvdWJsZXNjYW5fYWxsb3dlZCA9
IDA7DQorDQorCXJldHVybiAwOw0KK30NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19vdXRwdXRfN2EyMDAwLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19vdXRwdXRfN2EyMDAwLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAw
MDAuLmNjYzM1MjgzZTFkYw0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfb3V0cHV0XzdhMjAwMC5jDQpAQCAtMCwwICsxLDUzMSBAQA0KKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMg
TG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1
ZGUgPGxpbnV4L2RlbGF5Lmg+DQorDQorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5o
Pg0KKyNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9lZGlk
Lmg+DQorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+DQorDQorI2luY2x1ZGUgImxz
ZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfb3V0cHV0LmgiDQorDQorc3RhdGljIGludCBsczdh
MjAwMF9jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3Ip
DQorew0KKwl1bnNpZ25lZCBpbnQgbnVtID0gMDsNCisJc3RydWN0IGVkaWQgKmVkaWQ7DQorDQor
CWlmIChjb25uZWN0b3ItPmRkYykgew0KKwkJZWRpZCA9IGRybV9nZXRfZWRpZChjb25uZWN0b3Is
IGNvbm5lY3Rvci0+ZGRjKTsNCisJCWlmIChlZGlkKSB7DQorCQkJZHJtX2Nvbm5lY3Rvcl91cGRh
dGVfZWRpZF9wcm9wZXJ0eShjb25uZWN0b3IsIGVkaWQpOw0KKwkJCW51bSA9IGRybV9hZGRfZWRp
ZF9tb2Rlcyhjb25uZWN0b3IsIGVkaWQpOw0KKwkJCWtmcmVlKGVkaWQpOw0KKwkJfQ0KKw0KKwkJ
cmV0dXJuIG51bTsNCisJfQ0KKw0KKwludW0gPSBkcm1fYWRkX21vZGVzX25vZWRpZChjb25uZWN0
b3IsIDE5MjAsIDEyMDApOw0KKw0KKwlkcm1fc2V0X3ByZWZlcnJlZF9tb2RlKGNvbm5lY3Rvciwg
MTAyNCwgNzY4KTsNCisNCisJcmV0dXJuIG51bTsNCit9DQorDQorc3RhdGljIHN0cnVjdCBkcm1f
ZW5jb2RlciAqDQorbHM3YTIwMDBfY29ubmVjdG9yX2dldF9iZXN0X2VuY29kZXIoc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciwNCisJCQkJICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0ID0gY29ubmVjdG9yX3Rv
X2xzZGNfb3V0cHV0KGNvbm5lY3Rvcik7DQorDQorCXJldHVybiAmb3V0cHV0LT5lbmNvZGVyOw0K
K30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVyX2Z1bmNzIGxz
N2EyMDAwX2Nvbm5lY3Rvcl9oZWxwZXJzID0gew0KKwkuYXRvbWljX2Jlc3RfZW5jb2RlciA9IGxz
N2EyMDAwX2Nvbm5lY3Rvcl9nZXRfYmVzdF9lbmNvZGVyLA0KKwkuZ2V0X21vZGVzID0gbHM3YTIw
MDBfY29ubmVjdG9yX2dldF9tb2RlcywNCit9Ow0KKw0KKy8qIGRlYnVnZnMgKi8NCisNCisjZGVm
aW5lIExTRENfSERNSV9SRUcoaSwgcmVnKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFwNCisJLm5hbWUgPSBfX3N0cmluZ2lmeV8xKExTRENfSERNSSMjaSMjXyMjcmVnIyNfUkVHKSwg
ICAgXA0KKwkub2Zmc2V0ID0gTFNEQ19IRE1JIyNpIyNfIyNyZWcjI19SRUcsICAgICAgICAgICAg
ICAgICBcDQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19yZWczMiBsczdhMjAwMF9o
ZG1pMF9lbmNvZGVyX3JlZ3NbXSA9IHsNCisJTFNEQ19IRE1JX1JFRygwLCBaT05FKSwNCisJTFNE
Q19IRE1JX1JFRygwLCBJTlRGX0NUUkwpLA0KKwlMU0RDX0hETUlfUkVHKDAsIFBIWV9DVFJMKSwN
CisJTFNEQ19IRE1JX1JFRygwLCBQSFlfUExMKSwNCisJTFNEQ19IRE1JX1JFRygwLCBBVklfSU5G
T19DUlRMKSwNCisJTFNEQ19IRE1JX1JFRygwLCBQSFlfQ0FMKSwNCisJTFNEQ19IRE1JX1JFRygw
LCBBVURJT19QTExfTE8pLA0KKwlMU0RDX0hETUlfUkVHKDAsIEFVRElPX1BMTF9ISSksDQorCXtO
VUxMLCAwfSwgIC8qIE1VU1QgYmUge05VTEwsIDB9IHRlcm1pbmF0ZWQgKi8NCit9Ow0KKw0KK3N0
YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19yZWczMiBsczdhMjAwMF9oZG1pMV9lbmNvZGVyX3JlZ3Nb
XSA9IHsNCisJTFNEQ19IRE1JX1JFRygxLCBaT05FKSwNCisJTFNEQ19IRE1JX1JFRygxLCBJTlRG
X0NUUkwpLA0KKwlMU0RDX0hETUlfUkVHKDEsIFBIWV9DVFJMKSwNCisJTFNEQ19IRE1JX1JFRygx
LCBQSFlfUExMKSwNCisJTFNEQ19IRE1JX1JFRygxLCBBVklfSU5GT19DUlRMKSwNCisJTFNEQ19I
RE1JX1JFRygxLCBQSFlfQ0FMKSwNCisJTFNEQ19IRE1JX1JFRygxLCBBVURJT19QTExfTE8pLA0K
KwlMU0RDX0hETUlfUkVHKDEsIEFVRElPX1BMTF9ISSksDQorCXtOVUxMLCAwfSwgIC8qIE1VU1Qg
YmUge05VTEwsIDB9IHRlcm1pbmF0ZWQgKi8NCit9Ow0KKw0KK3N0YXRpYyBpbnQgbHM3YTIwMDBf
aGRtaV9lbmNvZGVyX3JlZ3Nfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpDQor
ew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSA9IChzdHJ1Y3QgZHJtX2luZm9fbm9kZSAq
KW0tPnByaXZhdGU7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gbm9kZS0+bWlub3ItPmRl
djsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJY29uc3Qg
c3RydWN0IGxzZGNfcmVnMzIgKnByZWc7DQorDQorCXByZWcgPSAoY29uc3Qgc3RydWN0IGxzZGNf
cmVnMzIgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisNCisJd2hpbGUgKHByZWctPm5hbWUpIHsN
CisJCXUzMiBvZmZzZXQgPSBwcmVnLT5vZmZzZXQ7DQorDQorCQlzZXFfcHJpbnRmKG0sICIlcyAo
MHglMDR4KTogMHglMDh4XG4iLA0KKwkJCSAgIHByZWctPm5hbWUsIG9mZnNldCwgbHNkY19ycmVn
MzIobGRldiwgb2Zmc2V0KSk7DQorCQkrK3ByZWc7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0K
Kw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBsczdhMjAwMF9oZG1pMF9kZWJ1
Z2ZzX2ZpbGVzW10gPSB7DQorCXsgInJlZ3MiLCBsczdhMjAwMF9oZG1pX2VuY29kZXJfcmVnc19z
aG93LCAwLCAodm9pZCAqKWxzN2EyMDAwX2hkbWkwX2VuY29kZXJfcmVncyB9LA0KK307DQorDQor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGxzN2EyMDAwX2hkbWkxX2RlYnVnZnNf
ZmlsZXNbXSA9IHsNCisJeyAicmVncyIsIGxzN2EyMDAwX2hkbWlfZW5jb2Rlcl9yZWdzX3Nob3cs
IDAsICh2b2lkICopbHM3YTIwMDBfaGRtaTFfZW5jb2Rlcl9yZWdzIH0sDQorfTsNCisNCitzdGF0
aWMgdm9pZCBsczdhMjAwMF9oZG1pMF9sYXRlX3JlZ2lzdGVyKHN0cnVjdCBkcm1fY29ubmVjdG9y
ICpjb25uZWN0b3IsDQorCQkJCQkgc3RydWN0IGRlbnRyeSAqcm9vdCkNCit7DQorCXN0cnVjdCBk
cm1fZGV2aWNlICpkZGV2ID0gY29ubmVjdG9yLT5kZXY7DQorCXN0cnVjdCBkcm1fbWlub3IgKm1p
bm9yID0gZGRldi0+cHJpbWFyeTsNCisNCisJZHJtX2RlYnVnZnNfY3JlYXRlX2ZpbGVzKGxzN2Ey
MDAwX2hkbWkwX2RlYnVnZnNfZmlsZXMsDQorCQkJCSBBUlJBWV9TSVpFKGxzN2EyMDAwX2hkbWkw
X2RlYnVnZnNfZmlsZXMpLA0KKwkJCQkgcm9vdCwNCisJCQkJIG1pbm9yKTsNCit9DQorDQorc3Rh
dGljIHZvaWQgbHM3YTIwMDBfaGRtaTFfbGF0ZV9yZWdpc3RlcihzdHJ1Y3QgZHJtX2Nvbm5lY3Rv
ciAqY29ubmVjdG9yLA0KKwkJCQkJIHN0cnVjdCBkZW50cnkgKnJvb3QpDQorew0KKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiA9IGNvbm5lY3Rvci0+ZGV2Ow0KKwlzdHJ1Y3QgZHJtX21pbm9yICpt
aW5vciA9IGRkZXYtPnByaW1hcnk7DQorDQorCWRybV9kZWJ1Z2ZzX2NyZWF0ZV9maWxlcyhsczdh
MjAwMF9oZG1pMV9kZWJ1Z2ZzX2ZpbGVzLA0KKwkJCQkgQVJSQVlfU0laRShsczdhMjAwMF9oZG1p
MV9kZWJ1Z2ZzX2ZpbGVzKSwNCisJCQkJIHJvb3QsDQorCQkJCSBtaW5vcik7DQorfQ0KKw0KKy8q
IG1vbml0b3IgcHJlc2VudCBkZXRlY3Rpb24gKi8NCisNCitzdGF0aWMgZW51bSBkcm1fY29ubmVj
dG9yX3N0YXR1cw0KK2xzN2EyMDAwX2hkbWkwX3ZnYV9jb25uZWN0b3JfZGV0ZWN0KHN0cnVjdCBk
cm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgZm9yY2UpDQorew0KKwlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGRldiA9IGNvbm5lY3Rvci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSB0b19sc2RjKGRkZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2
LCBMU0RDX0hETUlfSFBEX1NUQVRVU19SRUcpOw0KKw0KKwlpZiAodmFsICYgSERNSTBfSFBEX0ZM
QUcpDQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7DQorDQorCWlmIChjb25u
ZWN0b3ItPmRkYykgew0KKwkJaWYgKGRybV9wcm9iZV9kZGMoY29ubmVjdG9yLT5kZGMpKQ0KKwkJ
CXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsNCisNCisJCXJldHVybiBjb25uZWN0
b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsNCisJfQ0KKw0KKwlyZXR1cm4gY29ubmVjdG9yX3N0YXR1
c191bmtub3duOw0KK30NCisNCitzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0YXR1cw0KK2xz
N2EyMDAwX2hkbWkxX2Nvbm5lY3Rvcl9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5l
Y3RvciwgYm9vbCBmb3JjZSkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xz
ZGMoY29ubmVjdG9yLT5kZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3JyZWczMihs
ZGV2LCBMU0RDX0hETUlfSFBEX1NUQVRVU19SRUcpOw0KKw0KKwlpZiAodmFsICYgSERNSTFfSFBE
X0ZMQUcpDQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7DQorDQorCXJldHVy
biBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0
cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGxzN2EyMDAwX2hkbWlfY29ubmVjdG9yX2Z1bmNzWzJd
ID0gew0KKwl7DQorCQkuZGV0ZWN0ID0gbHM3YTIwMDBfaGRtaTBfdmdhX2Nvbm5lY3Rvcl9kZXRl
Y3QsDQorCQkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nvbm5lY3Rvcl9t
b2RlcywNCisJCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLA0KKwkJLnJlc2V0ID0g
ZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LA0KKwkJLmF0b21pY19kdXBsaWNhdGVf
c3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLA0KKwkJ
LmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ry
b3lfc3RhdGUsDQorCQkuZGVidWdmc19pbml0ID0gbHM3YTIwMDBfaGRtaTBfbGF0ZV9yZWdpc3Rl
ciwNCisJfSwNCisJew0KKwkJLmRldGVjdCA9IGxzN2EyMDAwX2hkbWkxX2Nvbm5lY3Rvcl9kZXRl
Y3QsDQorCQkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nvbm5lY3Rvcl9t
b2RlcywNCisJCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLA0KKwkJLnJlc2V0ID0g
ZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LA0KKwkJLmF0b21pY19kdXBsaWNhdGVf
c3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0YXRlLA0KKwkJ
LmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ry
b3lfc3RhdGUsDQorCQkuZGVidWdmc19pbml0ID0gbHM3YTIwMDBfaGRtaTFfbGF0ZV9yZWdpc3Rl
ciwNCisJfSwNCit9Ow0KKw0KKy8qIEV2ZW4gdGhvdWdoIHNvbWUgYm9hcmQgaGFzIG9ubHkgb25l
IGhkbWkgb24gZGlzcGxheSBwaXBlIDEsDQorICogV2Ugc3RpbGwgbmVlZCBob29rIGxzZGNfZW5j
b2Rlcl9mdW5jcyB1cCBvbiBkaXNwbGF5IHBpcGUgMCwNCisgKiBUaGlzIGlzIGJlY2F1c2Ugd2Ug
bmVlZCBpdHMgcmVzZXQoKSBjYWxsYmFjayBnZXQgY2FsbGVkLCB0bw0KKyAqIHNldCB0aGUgTFNE
Q19IRE1JeF9DVFJMX1JFRyB1c2luZyBzb2Z0d2FyZSBncGlvIGVtdWxhdGVkIGkyYy4NCisgKiBP
dGhlcndpc2UsIHRoZSBmaXJtd2FyZSBtYXkgc2V0IExTRENfSERNSXhfQ1RSTF9SRUcgYmxpbmRs
eS4NCisgKi8NCitzdGF0aWMgdm9pZCBsczdhMjAwMF9oZG1pMF9lbmNvZGVyX3Jlc2V0KHN0cnVj
dCBkcm1fZW5jb2RlciAqZW5jb2RlcikNCit7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0g
ZW5jb2Rlci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYp
Ow0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBQSFlfQ0xPQ0tfUE9MIHwgUEhZX0NMT0NLX0VOIHwg
UEhZX0RBVEFfRU47DQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfUEFORUxfQ09ORl9S
RUcsIHZhbCk7DQorDQorCS8qIHVzaW5nIHNvZnR3YXJlIGdwaW8gZW11bGF0ZWQgaTJjICovDQor
CXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfSERNSTBfSU5URl9DVFJMX1JFRyk7DQorCXZh
bCAmPSB+SFdfSTJDX0VOOw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX0lOVEZfQ1RS
TF9SRUcsIHZhbCk7DQorDQorCS8qIGhlbHAgdGhlIGhkbWkgcGh5IHRvIGdldCBvdXQgb2YgcmVz
ZXQgc3RhdGUgKi8NCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19IRE1JMF9QSFlfQ1RSTF9SRUcs
IEhETUlfUEhZX1JFU0VUX04pOw0KKw0KKwltZGVsYXkoMjApOw0KKw0KKwlkcm1fZGJnKGRkZXYs
ICJIRE1JLTAgUmVzZXRcbiIpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsczdhMjAwMF9oZG1pMV9l
bmNvZGVyX3Jlc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikNCit7DQorCXN0cnVjdCBk
cm1fZGV2aWNlICpkZGV2ID0gZW5jb2Rlci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxk
ZXYgPSB0b19sc2RjKGRkZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBQSFlfQ0xPQ0tfUE9M
IHwgUEhZX0NMT0NLX0VOIHwgUEhZX0RBVEFfRU47DQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENf
Q1JUQzFfUEFORUxfQ09ORl9SRUcsIHZhbCk7DQorDQorCS8qIHVzaW5nIHNvZnR3YXJlIGdwaW8g
ZW11bGF0ZWQgaTJjICovDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfSERNSTFfSU5U
Rl9DVFJMX1JFRyk7DQorCXZhbCAmPSB+SFdfSTJDX0VOOw0KKwlsc2RjX3dyZWczMihsZGV2LCBM
U0RDX0hETUkxX0lOVEZfQ1RSTF9SRUcsIHZhbCk7DQorDQorCS8qICBoZWxwIHRoZSBoZG1pIHBo
eSB0byBnZXQgb3V0IG9mIHJlc2V0IHN0YXRlICovDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENf
SERNSTFfUEhZX0NUUkxfUkVHLCBIRE1JX1BIWV9SRVNFVF9OKTsNCisNCisJbWRlbGF5KDIwKTsN
CisNCisJZHJtX2RiZyhkZGV2LCAiSERNSS0xIFJlc2V0XG4iKTsNCit9DQorDQorc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBsczdhMjAwMF9lbmNvZGVyX2Z1bmNzWzJdID0g
ew0KKwl7DQorCQkucmVzZXQgPSBsczdhMjAwMF9oZG1pMF9lbmNvZGVyX3Jlc2V0LA0KKwkJLmRl
c3Ryb3kgPSBkcm1fZW5jb2Rlcl9jbGVhbnVwLA0KKwl9LA0KKwl7DQorCQkucmVzZXQgPSBsczdh
MjAwMF9oZG1pMV9lbmNvZGVyX3Jlc2V0LA0KKwkJLmRlc3Ryb3kgPSBkcm1fZW5jb2Rlcl9jbGVh
bnVwLA0KKwl9LA0KK307DQorDQorc3RhdGljIGludCBsczdhMjAwMF9oZG1pX3NldF9hdmlfaW5m
b2ZyYW1lKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwNCisJCQkJCSAgIHN0cnVjdCBkcm1f
ZGlzcGxheV9tb2RlICptb2RlKQ0KK3sNCisJc3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQgPSBl
bmNvZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlzdHJ1Y3QgbHNkY19kaXNwbGF5X3Bp
cGUgKmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlzcGxheV9waXBlKG91dHB1dCk7DQorCXVuc2lnbmVk
IGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9
IGVuY29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2
KTsNCisJc3RydWN0IGhkbWlfYXZpX2luZm9mcmFtZSBpbmZvZnJhbWU7DQorCXU4IGJ1ZmZlcltI
RE1JX0lORk9GUkFNRV9TSVpFKEFWSSldOw0KKwl1bnNpZ25lZCBjaGFyICpwdHIgPSAmYnVmZmVy
W0hETUlfSU5GT0ZSQU1FX0hFQURFUl9TSVpFXTsNCisJdW5zaWduZWQgaW50IGNvbnRlbnQwLCBj
b250ZW50MSwgY29udGVudDIsIGNvbnRlbnQzOw0KKwlpbnQgZXJyOw0KKw0KKwllcnIgPSBkcm1f
aGRtaV9hdmlfaW5mb2ZyYW1lX2Zyb21fZGlzcGxheV9tb2RlKCZpbmZvZnJhbWUsDQorCQkJCQkJ
ICAgICAgICZvdXRwdXQtPmNvbm5lY3RvciwNCisJCQkJCQkgICAgICAgbW9kZSk7DQorCWlmIChl
cnIgPCAwKSB7DQorCQlkcm1fZXJyKGRkZXYsICJmYWlsZWQgdG8gc2V0dXAgQVZJIGluZm9mcmFt
ZTogJWRcbiIsIGVycik7DQorCQlyZXR1cm4gZXJyOw0KKwl9DQorDQorCS8qIEZpeGVkIGluZm9m
cmFtZSBjb25maWd1cmF0aW9uIG5vdCBsaW5rZWQgdG8gdGhlIG1vZGUgKi8NCisJaW5mb2ZyYW1l
LmNvbG9yc3BhY2UgPSBIRE1JX0NPTE9SU1BBQ0VfUkdCOw0KKwlpbmZvZnJhbWUucXVhbnRpemF0
aW9uX3JhbmdlID0gSERNSV9RVUFOVElaQVRJT05fUkFOR0VfREVGQVVMVDsNCisJaW5mb2ZyYW1l
LmNvbG9yaW1ldHJ5ID0gSERNSV9DT0xPUklNRVRSWV9OT05FOw0KKw0KKwllcnIgPSBoZG1pX2F2
aV9pbmZvZnJhbWVfcGFjaygmaW5mb2ZyYW1lLCBidWZmZXIsIHNpemVvZihidWZmZXIpKTsNCisJ
aWYgKGVyciA8IDApIHsNCisJCWRybV9lcnIoZGRldiwgImZhaWxlZCB0byBwYWNrIEFWSSBpbmZv
ZnJhbWU6ICVkXG4iLCBlcnIpOw0KKwkJCXJldHVybiBlcnI7DQorCX0NCisNCisJY29udGVudDAg
PSAqKHVuc2lnbmVkIGludCAqKXB0cjsNCisJY29udGVudDEgPSAqKHB0ciArIDQpOw0KKwljb250
ZW50MiA9ICoodW5zaWduZWQgaW50ICopKHB0ciArIDUpOw0KKwljb250ZW50MyA9ICoodW5zaWdu
ZWQgaW50ICopKHB0ciArIDkpOw0KKw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExTRENfSERN
STBfQVZJX0NPTlRFTlQwLCBpbmRleCwgY29udGVudDApOw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxk
ZXYsIExTRENfSERNSTBfQVZJX0NPTlRFTlQxLCBpbmRleCwgY29udGVudDEpOw0KKwlsc2RjX3Bp
cGVfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfQVZJX0NPTlRFTlQyLCBpbmRleCwgY29udGVudDIp
Ow0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfQVZJX0NPTlRFTlQzLCBpbmRl
eCwgY29udGVudDMpOw0KKw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfQVZJ
X0lORk9fQ1JUTF9SRUcsIGluZGV4LA0KKwkJCSBBVklfUEtUX0VOQUJMRSB8IEFWSV9QS1RfVVBE
QVRFKTsNCisNCisJZHJtX2RiZyhkZGV2LCAiVXBkYXRlIEhETUktJXUgYXZpIGluZm9mcmFtZVxu
IiwgaW5kZXgpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTIwMDBf
aGRtaV9hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsDQorCQkJCQkg
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfb3V0cHV0
ICpvdXRwdXQgPSBlbmNvZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlzdHJ1Y3QgbHNk
Y19kaXNwbGF5X3BpcGUgKmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlzcGxheV9waXBlKG91dHB1dCk7
DQorCXVuc2lnbmVkIGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGRldiA9IGVuY29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
dG9fbHNkYyhkZGV2KTsNCisJdTMyIHZhbDsNCisNCisJLyogRGlzYWJsZSB0aGUgaGRtaSBwaHkg
Ki8NCisJdmFsID0gbHNkY19waXBlX3JyZWczMihsZGV2LCBMU0RDX0hETUkwX1BIWV9DVFJMX1JF
RywgaW5kZXgpOw0KKwl2YWwgJj0gfkhETUlfUEhZX0VOOw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxk
ZXYsIExTRENfSERNSTBfUEhZX0NUUkxfUkVHLCBpbmRleCwgdmFsKTsNCisNCisJLyogRGlzYWJs
ZSB0aGUgaGRtaSBpbnRlcmZhY2UgKi8NCisJdmFsID0gbHNkY19waXBlX3JyZWczMihsZGV2LCBM
U0RDX0hETUkwX0lOVEZfQ1RSTF9SRUcsIGluZGV4KTsNCisJdmFsICY9IH5IRE1JX0lOVEVSRkFD
RV9FTjsNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX0lOVEZfQ1RSTF9SRUcs
IGluZGV4LCB2YWwpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJIRE1JLSV1IGRpc2FibGVkXG4iLCBp
bmRleCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzN2EyMDAwX2hkbWlfYXRvbWljX2VuYWJsZShz
dHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsDQorCQkJCQlzdHJ1Y3QgZHJtX2F0b21pY19zdGF0
ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29kZXItPmRldjsN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJc3RydWN0IGxz
ZGNfb3V0cHV0ICpvdXRwdXQgPSBlbmNvZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlz
dHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlzcGxheV9waXBl
KG91dHB1dCk7DQorCXVuc2lnbmVkIGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwl1MzIg
dmFsOw0KKw0KKwkvKiBkYXRhc2hlZXQgc2F5IGl0IHNob3VsZCBsYXJnZXIgdGhhbiA0OCAqLw0K
Kwl2YWwgPSA2NCA8PCBIRE1JX0hfWk9ORV9JRExFX1NISUZUIHwgNjQgPDwgSERNSV9WX1pPTkVf
SURMRV9TSElGVDsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX1pPTkVf
UkVHLCBpbmRleCwgdmFsKTsNCisNCisJdmFsID0gSERNSV9QSFlfVEVSTV9TVEFUVVMgfA0KKwkg
ICAgICBIRE1JX1BIWV9URVJNX0RFVF9FTiB8DQorCSAgICAgIEhETUlfUEhZX1RFUk1fSF9FTiB8
DQorCSAgICAgIEhETUlfUEhZX1RFUk1fTF9FTiB8DQorCSAgICAgIEhETUlfUEhZX1JFU0VUX04g
fA0KKwkgICAgICBIRE1JX1BIWV9FTjsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RD
X0hETUkwX1BIWV9DVFJMX1JFRywgaW5kZXgsIHZhbCk7DQorDQorCXVkZWxheSgyKTsNCisNCisJ
dmFsID0gSERNSV9DVExfUEVSSU9EX01PREUgfA0KKwkgICAgICBIRE1JX0FVRElPX0VOIHwNCisJ
ICAgICAgSERNSV9QQUNLRVRfRU4gfA0KKwkgICAgICBIRE1JX0lOVEVSRkFDRV9FTiB8DQorCSAg
ICAgICg4IDw8IEhETUlfVklERU9fUFJFQU1CTEVfU0hJRlQpOw0KKw0KKwlsc2RjX3BpcGVfd3Jl
ZzMyKGxkZXYsIExTRENfSERNSTBfSU5URl9DVFJMX1JFRywgaW5kZXgsIHZhbCk7DQorDQorCWRy
bV9kYmcoZGRldiwgIkhETUktJXUgZW5hYmxlZFxuIiwgaW5kZXgpOw0KK30NCisNCisvKg0KKyAq
ICBGb3V0ID0gTSAqIEZpbg0KKyAqDQorICogIE0gPSAoNCAqIExGKSAvIChJREYgKiBPREYpDQor
ICoNCisgKiAgSURGOiBJbnB1dCBEaXZpc2lvbiBGYWN0b3INCisgKiAgT0RGOiBPdXRwdXQgRGl2
aXNpb24gRmFjdG9yDQorICogICBMRjogTG9vcCBGYWN0b3INCisgKiAgICBNOiBSZXF1aXJlZCBN
dWx0DQorICoNCisgKiAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tKw0KKyAqICB8ICAgICBGaW4gKGtIWikgICAgIHwgTSAgfCBJREYgfCBM
RiB8IE9ERiB8ICAgRm91dChNaHopICB8DQorICogIHwtLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0r
LS0tLS0rLS0tLSstLS0tLSstLS0tLS0tLS0tLS0tLXwNCisgKiAgfCAgMTcwMDAwIH4gMzQwMDAw
ICB8IDEwIHwgMTYgIHwgNDAgfCAgMSAgfCAxNzAwIH4gMzQwMCAgfA0KKyAqICB8ICAgODUwMDAg
fiAxNzAwMDAgIHwgMTAgfCAgOCAgfCA0MCB8ICAyICB8ICA4NTAgfiAxNzAwICB8DQorICogIHwg
ICA0MjUwMCB+ICA4NTAwMCAgfCAxMCB8ICA0ICB8IDQwIHwgIDQgIHwgIDQyNSB+IDg1MCAgIHwN
CisgKiAgfCAgIDIxMjUwIH4gIDQyNTAwICB8IDEwIHwgIDIgIHwgNDAgfCAgOCAgfCAyMTIuNSB+
IDQyNSAgfA0KKyAqICB8ICAgMjAwMDAgfiAgMjEyNTAgIHwgMTAgfCAgMSAgfCA0MCB8IDE2ICB8
ICAyMDAgfiAyMTIuNSB8DQorICogICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCisgKi8NCitzdGF0aWMgdm9pZCBsczdhMjAwMF9oZG1p
X3BoeV9wbGxfY29uZmlnKHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwNCisJCQkJCSBpbnQgZmlu
LA0KKwkJCQkJIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpk
ZGV2ID0gJmxkZXYtPmJhc2U7DQorCWludCBjb3VudCA9IDA7DQorCXUzMiB2YWw7DQorDQorCS8q
IEZpcnN0bHksIGRpc2FibGUgcGh5IHBsbCAqLw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExT
RENfSERNSTBfUEhZX1BMTF9SRUcsIGluZGV4LCAweDApOw0KKw0KKwkvKg0KKwkgKiBNb3N0IG9m
IHRpbWUsIGxvb25nc29uIEhETUkgcmVxdWlyZSBNID0gMTANCisJICogZm9yIGV4YW1wbGUsIDEw
ID0gKDQgKiA0MCkgLyAoOCAqIDIpDQorCSAqIGhlcmUsIHdyaXRlICIxIiB0byB0aGUgT0RGIHdp
bGwgZ2V0ICIyIg0KKwkgKi8NCisNCisJaWYgKGZpbiA+PSAxNzAwMDApDQorCQl2YWwgPSAoMTYg
PDwgSERNSV9QTExfSURGX1NISUZUKSB8DQorCQkgICAgICAoNDAgPDwgSERNSV9QTExfTEZfU0hJ
RlQpIHwNCisJCSAgICAgICgwIDw8IEhETUlfUExMX09ERl9TSElGVCk7DQorCWVsc2UgaWYgKGZp
biA+PSA4NTAwMCkNCisJCXZhbCA9ICg4IDw8IEhETUlfUExMX0lERl9TSElGVCkgfA0KKwkJICAg
ICAgKDQwIDw8IEhETUlfUExMX0xGX1NISUZUKSB8DQorCQkgICAgICAoMSA8PCBIRE1JX1BMTF9P
REZfU0hJRlQpOw0KKwllbHNlIGlmIChmaW4gPj0gNDI1MDApDQorCQl2YWwgPSAoNCA8PCBIRE1J
X1BMTF9JREZfU0hJRlQpIHwNCisJCSAgICAgICg0MCA8PCBIRE1JX1BMTF9MRl9TSElGVCkgfA0K
KwkJICAgICAgKDIgPDwgSERNSV9QTExfT0RGX1NISUZUKTsNCisJZWxzZSBpZiAgKGZpbiA+PSAy
MTI1MCkNCisJCXZhbCA9ICgyIDw8IEhETUlfUExMX0lERl9TSElGVCkgfA0KKwkJICAgICAgKDQw
IDw8IEhETUlfUExMX0xGX1NISUZUKSB8DQorCQkgICAgICAoMyA8PCBIRE1JX1BMTF9PREZfU0hJ
RlQpOw0KKwllbHNlDQorCQl2YWwgPSAoMSA8PCBIRE1JX1BMTF9JREZfU0hJRlQpIHwNCisJCSAg
ICAgICg0MCA8PCBIRE1JX1BMTF9MRl9TSElGVCkgfA0KKwkJICAgICAgKDQgPDwgSERNSV9QTExf
T0RGX1NISUZUKTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX1BIWV9Q
TExfUkVHLCBpbmRleCwgdmFsKTsNCisNCisJdmFsIHw9IEhETUlfUExMX0VOQUJMRTsNCisNCisJ
bHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX1BIWV9QTExfUkVHLCBpbmRleCwgdmFs
KTsNCisNCisJdWRlbGF5KDIpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJGaW4gb2YgSERNSS0ldTog
JWQga0h6XG4iLCBpbmRleCwgZmluKTsNCisNCisJLyogV2FpdCBoZG1pIHBoeSBwbGwgbG9jayAq
Lw0KKwlkbyB7DQorCQl2YWwgPSBsc2RjX3BpcGVfcnJlZzMyKGxkZXYsIExTRENfSERNSTBfUEhZ
X1BMTF9SRUcsIGluZGV4KTsNCisNCisJCWlmICh2YWwgJiBIRE1JX1BMTF9MT0NLRUQpIHsNCisJ
CQlkcm1fZGJnKGRkZXYsICJTZXR0aW5nIEhETUktJXUgUExMIHRha2UgJWQgY3ljbGVzXG4iLA0K
KwkJCQlpbmRleCwgY291bnQpOw0KKwkJCWJyZWFrOw0KKwkJfQ0KKwkJKytjb3VudDsNCisJfSB3
aGlsZSAoY291bnQgPCAxMDAwKTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hE
TUkwX1BIWV9DQUxfUkVHLCBpbmRleCwgMHgwZjAwMGZmMCk7DQorDQorCWlmIChjb3VudCA+PSAx
MDAwKQ0KKwkJZHJtX2VycihkZGV2LCAiU2V0dGluZyBIRE1JLSV1IFBMTCBmYWlsZWRcbiIsIGlu
ZGV4KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTIwMDBfaGRtaV9hdG9taWNfbW9kZV9zZXQo
c3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLA0KKwkJCQkJICBzdHJ1Y3QgZHJtX2NydGNfc3Rh
dGUgKmNydGNfc3RhdGUsDQorCQkJCQkgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0YXRlICpjb25u
X3N0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQgPSBlbmNvZGVyX3RvX2xz
ZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUg
PSBvdXRwdXRfdG9fZGlzcGxheV9waXBlKG91dHB1dCk7DQorCXVuc2lnbmVkIGludCBpbmRleCA9
IGRpc3BpcGUtPmluZGV4Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29kZXItPmRl
djsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Y19zdGF0ZS0+bW9kZTsNCisNCisJbHM3YTIw
MDBfaGRtaV9waHlfcGxsX2NvbmZpZyhsZGV2LCBtb2RlLT5jbG9jaywgaW5kZXgpOw0KKw0KKwls
czdhMjAwMF9oZG1pX3NldF9hdmlfaW5mb2ZyYW1lKGVuY29kZXIsIG1vZGUpOw0KKw0KKwlkcm1f
ZGJnKGRkZXYsICIlcyBtb2Rlc2V0IGZpbmlzaGVkXG4iLCBlbmNvZGVyLT5uYW1lKTsNCit9DQor
DQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3MgbHM3YTIwMDBf
ZW5jb2Rlcl9oZWxwZXJfZnVuY3MgPSB7DQorCS5hdG9taWNfZGlzYWJsZSA9IGxzN2EyMDAwX2hk
bWlfYXRvbWljX2Rpc2FibGUsDQorCS5hdG9taWNfZW5hYmxlID0gbHM3YTIwMDBfaGRtaV9hdG9t
aWNfZW5hYmxlLA0KKwkuYXRvbWljX21vZGVfc2V0ID0gbHM3YTIwMDBfaGRtaV9hdG9taWNfbW9k
ZV9zZXQsDQorfTsNCisNCisvKg0KKyAqIEZvciBMUzdBMjAwMDoNCisgKg0KKyAqIDEpIE1vc3Qg
b2YgYm9hcmQgZXhwb3J0IG9uZSB2Z2EgKyBoZG1pIG91dHB1dCBpbnRlcmZhY2UuDQorICogMikg
WWV0LCBTb21lIGJvYXJkcyBleHBvcnQgZG91YmxlIGhkbWkgb3V0cHV0IGludGVyZmFjZS4NCisg
KiAzKSBTdGlsbCBoYXZlIGJvYXJkcyBleHBvcnQgdGhyZWUgb3V0cHV0KDIgaGRtaSArIDEgdmdh
KS4NCisgKg0KKyAqIFNvIGxldCdzIGhvb2sgaGRtaSBoZWxwZXIgZnVuY3MgdG8gYWxsIGRpc3Bs
YXkgcGlwZSwgZG9uJ3QgbWlzcy4NCisgKiB3cml0aW5nIGhkbWkgcmVnaXN0ZXIgZG8gbm8gaGFy
bXMuDQorICovDQoraW50IGxzN2EyMDAwX291dHB1dF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpk
ZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJIHN0cnVj
dCBpMmNfYWRhcHRlciAqZGRjLA0KKwkJCSB1bnNpZ25lZCBpbnQgcGlwZSkNCit7DQorCXN0cnVj
dCBsc2RjX291dHB1dCAqb3V0cHV0ID0gJmRpc3BpcGUtPm91dHB1dDsNCisJc3RydWN0IGRybV9l
bmNvZGVyICplbmNvZGVyID0gJm91dHB1dC0+ZW5jb2RlcjsNCisJc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm5lY3RvciA9ICZvdXRwdXQtPmNvbm5lY3RvcjsNCisJaW50IHJldDsNCisNCisJcmV0
ID0gZHJtX2VuY29kZXJfaW5pdChkZGV2LA0KKwkJCSAgICAgICBlbmNvZGVyLA0KKwkJCSAgICAg
ICAmbHM3YTIwMDBfZW5jb2Rlcl9mdW5jc1twaXBlXSwNCisJCQkgICAgICAgRFJNX01PREVfRU5D
T0RFUl9UTURTLA0KKwkJCSAgICAgICAiZW5jb2Rlci0ldSIsDQorCQkJICAgICAgIHBpcGUpOw0K
KwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZW5jb2Rlci0+cG9zc2libGVfY3J0Y3Mg
PSBCSVQocGlwZSk7DQorDQorCWRybV9lbmNvZGVyX2hlbHBlcl9hZGQoZW5jb2RlciwgJmxzN2Ey
MDAwX2VuY29kZXJfaGVscGVyX2Z1bmNzKTsNCisNCisJcmV0ID0gZHJtX2Nvbm5lY3Rvcl9pbml0
X3dpdGhfZGRjKGRkZXYsDQorCQkJCQkgIGNvbm5lY3RvciwNCisJCQkJCSAgJmxzN2EyMDAwX2hk
bWlfY29ubmVjdG9yX2Z1bmNzW3BpcGVdLA0KKwkJCQkJICBEUk1fTU9ERV9DT05ORUNUT1JfSERN
SUEsDQorCQkJCQkgIGRkYyk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1f
aW5mbyhkZGV2LCAiZGlzcGxheSBwaXBlLSV1IGhhcyBIRE1JICVzXG4iLCBwaXBlLCBwaXBlID8g
IiIgOiAiYW5kL29yIFZHQSIpOw0KKw0KKwlkcm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoY29ubmVj
dG9yLCAmbHM3YTIwMDBfY29ubmVjdG9yX2hlbHBlcnMpOw0KKw0KKwlkcm1fY29ubmVjdG9yX2F0
dGFjaF9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rlcik7DQorDQorCWNvbm5lY3Rvci0+cG9sbGVk
ID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0NPTk5FQ1QgfA0KKwkJCSAgICBEUk1fQ09OTkVDVE9SX1BP
TExfRElTQ09OTkVDVDsNCisNCisJY29ubmVjdG9yLT5pbnRlcmxhY2VfYWxsb3dlZCA9IDA7DQor
CWNvbm5lY3Rvci0+ZG91Ymxlc2Nhbl9hbGxvd2VkID0gMDsNCisNCisJcmV0dXJuIDA7DQorfQ0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3BpeHBsbC5jIGIvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0
DQppbmRleCAwMDAwMDAwMDAwMDAuLjAzNjRjNDk1ODVkYw0KLS0tIC9kZXYvbnVsbA0KKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmMNCkBAIC0wLDAgKzEsNDgxIEBA
DQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisvKg0KKyAqIENvcHlyaWdo
dCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8N
CisNCisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4NCisNCisjaW5jbHVkZSA8ZHJtL2RybV9tYW5h
Z2VkLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQorLyoNCisgKiBUaGUgc3RydWN0
dXJlIG9mIHRoZSBwaXhlbCBQTEwgcmVnaXN0ZXJzIGlzIGV2b2x2ZWQgd2l0aCB0aW1lcywNCisg
KiBpdCBjYW4gYmUgZGlmZmVyZW50IGFjcm9zcyBkaWZmZXJlbnQgY2hpcCBhbHNvLg0KKyAqLw0K
Kw0KKy8qIHNpemUgaXMgdTY0LCBub3RlIHRoYXQgYWxsIGxvb25nc29uJ3MgY3B1IGlzIGxpdHRs
ZSBlbmRpYW4uDQorICogVGhpcyBzdHJ1Y3R1cmUgaXMgc2FtZSBmb3IgbHM3YTIwMDAsIGxzN2Ex
MDAwIGFuZCBsczJrMjAwMC4NCisgKi8NCitzdHJ1Y3QgbHNkY19waXhwbGxfcmVnIHsNCisJLyog
Qnl0ZSAwIH4gQnl0ZSAzICovDQorCXVuc2lnbmVkIGRpdl9vdXQgICAgICAgOiA3OyAgIC8qICA2
IDogMCAgICAgT3V0cHV0IGNsb2NrIGRpdmlkZXIgICovDQorCXVuc2lnbmVkIF9yZXNlcnZlZF8x
XyAgOiAxNDsgIC8qIDIwIDogNyAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorCXVuc2ln
bmVkIGxvb3BjICAgICAgICAgOiA5OyAgIC8qIDI5IDogMjEgICAgQ2xvY2sgbXVsdGlwbGllciAg
ICAgICovDQorCXVuc2lnbmVkIF9yZXNlcnZlZF8yXyAgOiAyOyAgIC8qIDMxIDogMzAgICAgICAg
ICAgICAgICAgICAgICAgICAgICovDQorDQorCS8qIEJ5dGUgNCB+IEJ5dGUgNyAqLw0KKwl1bnNp
Z25lZCBkaXZfcmVmICAgICAgIDogNzsgICAvKiAzOCA6IDMyICAgIElucHV0IGNsb2NrIGRpdmlk
ZXIgICAqLw0KKwl1bnNpZ25lZCBsb2NrZWQgICAgICAgIDogMTsgICAvKiAzOSAgICAgICAgIFBM
TCBsb2NrZWQgaW5kaWNhdG9yICAqLw0KKwl1bnNpZ25lZCBzZWxfb3V0ICAgICAgIDogMTsgICAv
KiA0MCAgICAgICAgIG91dHB1dCBjbGsgc2VsZWN0b3IgICAqLw0KKwl1bnNpZ25lZCBfcmVzZXJ2
ZWRfM18gIDogMjsgICAvKiA0MiA6IDQxICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1
bnNpZ25lZCBzZXRfcGFyYW0gICAgIDogMTsgICAvKiA0MyAgICAgICAgIFRyaWdnZXIgdGhlIHVw
ZGF0ZSAgICAqLw0KKwl1bnNpZ25lZCBieXBhc3MgICAgICAgIDogMTsgICAvKiA0NCAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1bnNpZ25lZCBwb3dlcmRvd24gICAgIDogMTsg
ICAvKiA0NSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1bnNpZ25lZCBfcmVz
ZXJ2ZWRfNF8gIDogMTg7ICAvKiA0NiA6IDYzICAgIG5vIHVzZSAgICAgICAgICAgICAgICAqLw0K
K307DQorDQordW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCB7DQorCXN0cnVjdCBsc2RjX3Bp
eHBsbF9yZWcgYml0bWFwOw0KKwl1MzIgd1syXTsNCisJdTY0IGQ7DQorfTsNCisNCitzdHJ1Y3Qg
Y2xrX3RvX3BpeHBsbF9wYXJtc19sb29rdXBfdCB7DQorCXVuc2lnbmVkIGludCBjbG9jazsgICAg
ICAgIC8qIGtIeiAqLw0KKw0KKwl1bnNpZ25lZCBzaG9ydCB3aWR0aDsNCisJdW5zaWduZWQgc2hv
cnQgaGVpZ2h0Ow0KKwl1bnNpZ25lZCBzaG9ydCB2cmVmcmVzaDsNCisNCisJLyogU3RvcmVzIHBh
cmFtZXRlcnMgZm9yIHByb2dyYW1taW5nIHRoZSBIYXJkd2FyZSBQTExzICovDQorCXVuc2lnbmVk
IHNob3J0IGRpdl9vdXQ7DQorCXVuc2lnbmVkIHNob3J0IGxvb3BjOw0KKwl1bnNpZ25lZCBzaG9y
dCBkaXZfcmVmOw0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBjbGtfdG9fcGl4cGxsX3Bh
cm1zX2xvb2t1cF90IHBpeHBsbF9wYXJtc190YWJsZVtdID0gew0KKwl7MTQ4NTAwLCAxOTIwLCAx
MDgwLCA2MCwgIDExLCA0OSwgIDN9LCAgIC8qIDE5MjB4MTA4MEA2MEh6ICovDQorCXsxNDE3NTAs
IDE5MjAsIDEwODAsIDYwLCAgMTEsIDc4LCAgNX0sICAgLyogMTkyMHgxMDgwQDYwSHogKi8NCisJ
CQkJCQkgLyogMTkyMHgxMDgwQDUwSHogKi8NCisJezE3NDUwMCwgMTkyMCwgMTA4MCwgNzUsICAx
NywgODksICAzfSwgICAvKiAxOTIweDEwODBANzVIeiAqLw0KKwl7MTgxMjUwLCAyNTYwLCAxMDgw
LCA3NSwgIDgsICA1OCwgIDR9LCAgIC8qIDI1NjB4MTA4MEA3NUh6ICovDQorCXsyOTcwMDAsIDI1
NjAsIDEwODAsIDMwLCAgOCwgIDk1LCAgNH0sICAgLyogMzg0MHgyMTYwQDMwSHogKi8NCisJezMw
MTk5MiwgMTkyMCwgMTA4MCwgMTAwLCAxMCwgMTUxLCA1fSwgICAvKiAxOTIweDEwODBAMTAwSHog
Ki8NCisJezE0NjI1MCwgMTY4MCwgMTA1MCwgNjAsICAxNiwgMTE3LCA1fSwgICAvKiAxNjgweDEw
NTBANjBIeiAqLw0KKwl7MTM1MDAwLCAxMjgwLCAxMDI0LCA3NSwgIDEwLCA1NCwgIDR9LCAgIC8q
IDEyODB4MTAyNEA3NUh6ICovDQorCXsxMTkwMDAsIDE2ODAsIDEwNTAsIDYwLCAgMjAsIDExOSwg
NX0sICAgLyogMTY4MHgxMDUwQDYwSHogKi8NCisJezEwODAwMCwgMTYwMCwgOTAwLCAgNjAsICAx
NSwgODEsICA1fSwgICAvKiAxNjAweDkwMEA2MEh6ICAqLw0KKwkJCQkJCSAvKiAxMjgweDEwMjRA
NjBIeiAqLw0KKwkJCQkJCSAvKiAxMjgweDk2MEA2MEh6ICovDQorCQkJCQkJIC8qIDExNTJ4ODY0
QDc1SHogKi8NCisNCisJezEwNjUwMCwgMTQ0MCwgOTAwLCAgNjAsICAxOSwgODEsICA0fSwgICAv
KiAxNDQweDkwMEA2MEh6ICovDQorCXs4ODc1MCwgIDE0NDAsIDkwMCwgIDYwLCAgMTYsIDcxLCAg
NX0sICAgLyogMTQ0MHg5MDBANjBIeiAqLw0KKwl7ODM1MDAsICAxMjgwLCA4MDAsICA2MCwgIDE3
LCA3MSwgIDV9LCAgIC8qIDEyODB4ODAwQDYwSHogKi8NCisJezcxMDAwLCAgMTI4MCwgODAwLCAg
NjAsICAyMCwgNzEsICA1fSwgICAvKiAxMjgweDgwMEA2MEh6ICovDQorDQorCXs3NDI1MCwgIDEy
ODAsIDcyMCwgIDYwLCAgMjIsIDQ5LCAgM30sICAgLyogMTI4MHg3MjBANjBIeiAqLw0KKwkJCQkJ
CSAvKiAxMjgweDcyMEA1MEh6ICovDQorDQorCXs3ODc1MCwgIDEwMjQsIDc2OCwgIDc1LCAgMTYs
IDYzLCAgNX0sICAgLyogMTAyNHg3NjhANzVIeiAqLw0KKwl7NzUwMDAsICAxMDI0LCA3NjgsICA3
MCwgIDI5LCA4NywgIDR9LCAgIC8qIDEwMjR4NzY4QDcwSHogKi8NCisJezY1MDAwLCAgMTAyNCwg
NzY4LCAgNjAsICAyMCwgMzksICAzfSwgICAvKiAxMDI0eDc2OEA2MEh6ICovDQorDQorCXs1MTIw
MCwgIDEwMjQsIDYwMCwgIDYwLCAgMjUsIDY0LCAgNX0sICAgLyogMTAyNHg2MDBANjBIeiAqLw0K
Kw0KKwl7NTcyODQsICA4MzIsICA2MjQsICA3NSwgIDI0LCA1NSwgIDR9LCAgIC8qIDgzMng2MjRA
NzVIeiAqLw0KKwl7NDk1MDAsICA4MDAsICA2MDAsICA3NSwgIDQwLCA5OSwgIDV9LCAgIC8qIDgw
MHg2MDBANzVIeiAqLw0KKwl7NTAwMDAsICA4MDAsICA2MDAsICA3MiwgIDQ0LCA4OCwgIDR9LCAg
IC8qIDgwMHg2MDBANzJIeiAqLw0KKwl7NDAwMDAsICA4MDAsICA2MDAsICA2MCwgIDMwLCAzNiwg
IDN9LCAgIC8qIDgwMHg2MDBANjBIeiAqLw0KKwl7MzYwMDAsICA4MDAsICA2MDAsICA1NiwgIDUw
LCA3MiwgIDR9LCAgIC8qIDgwMHg2MDBANTZIeiAqLw0KKwl7MzE1MDAsICA2NDAsICA0ODAsICA3
NSwgIDQwLCA2MywgIDV9LCAgIC8qIDY0MHg0ODBANzVIeiAqLw0KKwkJCQkJCSAvKiA2NDB4NDgw
QDczSHogKi8NCisNCisJezMwMjQwLCAgNjQwLCAgNDgwLCAgNjcsICA2MiwgNzUsICA0fSwgICAv
KiA2NDB4NDgwQDY3SHogKi8NCisJezI3MDAwLCAgNzIwLCAgNTc2LCAgNTAsICA1MCwgNTQsICA0
fSwgICAvKiA3MjB4NTc2QDYwSHogKi8NCisJezI1MTc1LCAgNjQwLCAgNDgwLCAgNjAsICA4NSwg
MTA3LCA1fSwgICAvKiA2NDB4NDgwQDYwSHogKi8NCisJezI1MjAwLCAgNjQwLCAgNDgwLCAgNjAs
ICA1MCwgNjMsICA1fSwgICAvKiA2NDB4NDgwQDYwSHogKi8NCisJCQkJCQkgLyogNzIweDQ4MEA2
MEh6ICovDQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2RjX3BpeGVsX3BsbF9mcmVlKHN0cnVjdCBk
cm1fZGV2aWNlICpkZGV2LCB2b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0IGxzZGNfcGl4cGxsICp0
aGlzID0gKHN0cnVjdCBsc2RjX3BpeHBsbCAqKWRhdGE7DQorDQorCWlvdW5tYXAodGhpcy0+bW1p
byk7DQorDQorCWtmcmVlKHRoaXMtPnByaXYpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJwaXhwbGwg
cHJpdmF0ZSBkYXRhIGZyZWVkXG4iKTsNCit9DQorDQorLyoNCisgKiBpb3JlbWFwIHRoZSBkZXZp
Y2UgZGVwZW5kZW50IFBMTCByZWdpc3RlcnMNCisgKg0KKyAqIEB0aGlzOiBwb2ludCB0byB0aGUg
b2JqZWN0IHdoZXJlIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20NCisgKi8NCitzdGF0aWMg
aW50IGxzZGNfcGl4ZWxfcGxsX3NldHVwKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMp
DQorew0KKwlzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtczsNCisNCisJdGhpcy0+bW1p
byA9IGlvcmVtYXAodGhpcy0+cmVnX2Jhc2UsIHRoaXMtPnJlZ19zaXplKTsNCisJaWYgKElTX0VS
Ul9PUl9OVUxMKHRoaXMtPm1taW8pKQ0KKwkJcmV0dXJuIC1FTk9NRU07DQorDQorCXBwYXJtcyA9
IGt6YWxsb2Moc2l6ZW9mKCpwcGFybXMpLCBHRlBfS0VSTkVMKTsNCisJaWYgKElTX0VSUl9PUl9O
VUxMKHBwYXJtcykpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJcHBhcm1zLT5yZWZfY2xvY2sg
PSBMU0RDX1BMTF9SRUZfQ0xLOw0KKw0KKwl0aGlzLT5wcml2ID0gcHBhcm1zOw0KKw0KKwlyZXR1
cm4gZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0KHRoaXMtPmRkZXYsIGxzZGNfcGl4ZWxfcGxsX2Zy
ZWUsIHRoaXMpOw0KK30NCisNCisvKg0KKyAqIEZpbmQgYSBzZXQgb2YgcGxsIHBhcmFtZXRlcnMg
ZnJvbSBhIHN0YXRpYyBsb2NhbCB0YWJsZSB3aGljaCBhdm9pZA0KKyAqIGNvbXB1dGluZyB0aGUg
cGxsIHBhcmFtZXRlciBlYWNodGltZSBhIG1vZGVzZXQgaXMgdHJpZ2dlcmVkLg0KKyAqDQorICog
QHRoaXM6IHBvaW50IHRvIHRoZSBvYmplY3Qgd2hlcmUgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQg
ZnJvbQ0KKyAqIEBjbG9jazogdGhlIGRlc2lyZWQgb3V0cHV0IHBpeGVsIGNsb2NrLCB0aGUgdW5p
dCBpcyBrSHoNCisgKiBAcG91dDogcG9pbnQgdG8gd2hlcmUgdGhlIHBhcmFtZXRlcnMgdG8gc3Rv
cmUgaWYgZm91bmQNCisgKg0KKyAqIFJldHVybiAwIGlmIHN1Y2Nlc3MsIHJldHVybiAtMSBpZiBu
b3QgZm91bmQuDQorICovDQorc3RhdGljIGludCBsc2RjX3BpeHBsbF9maW5kKHN0cnVjdCBsc2Rj
X3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJICAgIHVuc2lnbmVkIGludCBjbG9jaywNCisJCQkg
ICAgc3RydWN0IGxzZGNfcGl4cGxsX3Bhcm1zICpwb3V0KQ0KK3sNCisJdW5zaWduZWQgaW50IG51
bSA9IEFSUkFZX1NJWkUocGl4cGxsX3Bhcm1zX3RhYmxlKTsNCisJY29uc3Qgc3RydWN0IGNsa190
b19waXhwbGxfcGFybXNfbG9va3VwX3QgKnB0Ow0KKwl1bnNpZ25lZCBpbnQgaTsNCisNCisJZm9y
IChpID0gMDsgaSA8IG51bTsgKytpKSB7DQorCQlwdCA9ICZwaXhwbGxfcGFybXNfdGFibGVbaV07
DQorDQorCQlpZiAoY2xvY2sgPT0gcHQtPmNsb2NrKSB7DQorCQkJcG91dC0+ZGl2X3JlZiA9IHB0
LT5kaXZfcmVmOw0KKwkJCXBvdXQtPmxvb3BjICAgPSBwdC0+bG9vcGM7DQorCQkJcG91dC0+ZGl2
X291dCA9IHB0LT5kaXZfb3V0Ow0KKw0KKwkJCXJldHVybiAwOw0KKwkJfQ0KKwl9DQorDQorCWRy
bV9kYmdfa21zKHRoaXMtPmRkZXYsICJwaXhlbCBjbG9jayAldTogbWlzc1xuIiwgY2xvY2spOw0K
Kw0KKwlyZXR1cm4gLTE7DQorfQ0KKw0KKy8qDQorICogRmluZCBhIHNldCBvZiBwbGwgcGFyYW1l
dGVycyB3aGljaCBoYXZlIG1pbmltYWwgZGlmZmVyZW5jZSB3aXRoIHRoZQ0KKyAqIGRlc2lyZWQg
cGl4ZWwgY2xvY2sgZnJlcXVlbmN5LiBJdCBkb2VzIHRoYXQgYnkgY29tcHV0aW5nIGFsbCBvZiB0
aGUNCisgKiBwb3NzaWJsZSBjb21iaW5hdGlvbi4gQ29tcHV0ZSB0aGUgZGlmZiBhbmQgZmluZCB0
aGUgY29tYmluYXRpb24gd2l0aA0KKyAqIG1pbmltYWwgZGlmZi4NCisgKg0KKyAqIGNsb2NrX291
dCA9IHJlZmNsayAvIGRpdl9yZWYgKiBsb29wYyAvIGRpdl9vdXQNCisgKg0KKyAqIHJlZmNsayBp
cyBkZXRlcm1pbmVkIGJ5IHRoZSBvc2NpbGxhdG9yIG1vdW50ZWQgb24gbW90aGVyYm9hcmQoMTAw
TUh6DQorICogaW4gYWxtb3N0IGFsbCBib2FyZCkNCisgKg0KKyAqIEB0aGlzOiBwb2ludCB0byB0
aGUgb2JqZWN0IGZyb20gd2hlcmUgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQNCisgKiBAY2xvY2s6
IHRoZSBkZXNpcmVkIG91dHB1dCBwaXhlbCBjbG9jaywgdGhlIHVuaXQgaXMga0h6DQorICogQHBv
dXQ6IHBvaW50IHRvIHRoZSBvdXQgc3RydWN0IG9mIGxzZGNfcGl4cGxsX3Bhcm1zDQorICoNCisg
KiBSZXR1cm4gMCBpZiBhIHNldCBvZiBwYXJhbWV0ZXIgaXMgZm91bmQsIG90aGVyd2lzZSByZXR1
cm4gdGhlIGVycm9yDQorICogYmV0d2VlbiBjbG9ja19rSHogd2Ugd2FudGVkIGFuZCB0aGUgbW9z
dCBjbG9zZXN0IGNhbmRpZGF0ZSB3aXRoIGl0Lg0KKyAqLw0KK3N0YXRpYyBpbnQgbHNkY19waXhl
bF9wbGxfY29tcHV0ZShzdHJ1Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0aGlzLA0KKwkJCQkgIHVu
c2lnbmVkIGludCBjbG9jaywNCisJCQkJICBzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBvdXQp
DQorew0KKwlzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtcyA9IHRoaXMtPnByaXY7DQor
CXVuc2lnbmVkIGludCByZWZjbGsgPSBwcGFybXMtPnJlZl9jbG9jazsNCisJY29uc3QgdW5zaWdu
ZWQgaW50IHRvbGVyYW5jZSA9IDEwMDA7DQorCXVuc2lnbmVkIGludCBtaW4gPSB0b2xlcmFuY2U7
DQorCXVuc2lnbmVkIGludCBkaXZfb3V0LCBsb29wYywgZGl2X3JlZjsNCisJdW5zaWduZWQgaW50
IGNvbXB1dGVkOw0KKw0KKwlpZiAoIWxzZGNfcGl4cGxsX2ZpbmQodGhpcywgY2xvY2ssIHBvdXQp
KQ0KKwkJcmV0dXJuIDA7DQorDQorCWZvciAoZGl2X291dCA9IDY7IGRpdl9vdXQgPCA2NDsgZGl2
X291dCsrKSB7DQorCQlmb3IgKGRpdl9yZWYgPSAzOyBkaXZfcmVmIDwgNjsgZGl2X3JlZisrKSB7
DQorCQkJZm9yIChsb29wYyA9IDY7IGxvb3BjIDwgMTYxOyBsb29wYysrKSB7DQorCQkJCXVuc2ln
bmVkIGludCBkaWZmID0gMDsNCisNCisJCQkJaWYgKGxvb3BjIDwgMTIgKiBkaXZfcmVmKQ0KKwkJ
CQkJY29udGludWU7DQorCQkJCWlmIChsb29wYyA+IDMyICogZGl2X3JlZikNCisJCQkJCWNvbnRp
bnVlOw0KKw0KKwkJCQljb21wdXRlZCA9IHJlZmNsayAvIGRpdl9yZWYgKiBsb29wYyAvIGRpdl9v
dXQ7DQorDQorCQkJCWlmIChjbG9jayA+PSBjb21wdXRlZCkNCisJCQkJCWRpZmYgPSBjbG9jayAt
IGNvbXB1dGVkOw0KKwkJCQllbHNlDQorCQkJCQlkaWZmID0gY29tcHV0ZWQgLSBjbG9jazsNCisN
CisJCQkJaWYgKGRpZmYgPCBtaW4pIHsNCisJCQkJCW1pbiA9IGRpZmY7DQorCQkJCQlwcGFybXMt
PmRpdl9yZWYgPSBkaXZfcmVmOw0KKwkJCQkJcHBhcm1zLT5kaXZfb3V0ID0gZGl2X291dDsNCisJ
CQkJCXBwYXJtcy0+bG9vcGMgPSBsb29wYzsNCisNCisJCQkJCWlmIChkaWZmID09IDApIHsNCisJ
CQkJCQkqcG91dCA9ICpwcGFybXM7DQorCQkJCQkJcmV0dXJuIDA7DQorCQkJCQl9DQorCQkJCX0N
CisJCQl9DQorCQl9DQorCX0NCisNCisJLyogc3RpbGwgYWNjZXB0YWJsZSAqLw0KKwlpZiAobWlu
IDwgdG9sZXJhbmNlKSB7DQorCQkqcG91dCA9ICpwcGFybXM7DQorCQlyZXR1cm4gMDsNCisJfQ0K
Kw0KKwlkcm1fZGJnKHRoaXMtPmRkZXYsICJjYW4ndCBmaW5kIHN1aXRhYmxlIHBhcmFtcyBmb3Ig
JXUga2h6XG4iLCBjbG9jayk7DQorDQorCXJldHVybiBtaW47DQorfQ0KKw0KKy8qIFBpeGVsIHBs
bCBoYXJkd2FyZSByZWxhdGVkIG9wcywgcGVyIGRpc3BsYXkgcGlwZSAqLw0KKw0KK3N0YXRpYyB2
b2lkIF9fcGl4cGxsX3JyZWcoc3RydWN0IGxzZGNfcGl4cGxsICp0aGlzLA0KKwkJCSAgdW5pb24g
bHNkY19waXhwbGxfcmVnX2JpdG1hcCAqZHN0KQ0KK3sNCisjaWYgZGVmaW5lZChDT05GSUdfNjRC
SVQpDQorCWRzdC0+ZCA9IHJlYWRxKHRoaXMtPm1taW8pOw0KKyNlbHNlDQorCWRzdC0+d1swXSA9
IHJlYWRsKHRoaXMtPm1taW8pOw0KKwlkc3QtPndbMV0gPSByZWFkbCh0aGlzLT5tbWlvICsgNCk7
DQorI2VuZGlmDQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX3dyZWcoc3RydWN0IGxzZGNf
cGl4cGxsICp0aGlzLA0KKwkJCSAgdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCAqc3JjKQ0K
K3sNCisjaWYgZGVmaW5lZChDT05GSUdfNjRCSVQpDQorCXdyaXRlcShzcmMtPmQsIHRoaXMtPm1t
aW8pOw0KKyNlbHNlDQorCXdyaXRlbChzcmMtPndbMF0sIHRoaXMtPm1taW8pOw0KKwl3cml0ZWwo
c3JjLT53WzFdLCB0aGlzLT5tbWlvICsgNCk7DQorI2VuZGlmDQorfQ0KKw0KK3N0YXRpYyB2b2lk
IF9fcGl4cGxsX29wc19wb3dlcnVwKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpDQor
ew0KKwl1bmlvbiBsc2RjX3BpeHBsbF9yZWdfYml0bWFwIHBpeHBsbF9yZWc7DQorDQorCV9fcGl4
cGxsX3JyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KKw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5wb3dl
cmRvd24gPSAwOw0KKw0KKwlfX3BpeHBsbF93cmVnKHRoaXMsICZwaXhwbGxfcmVnKTsNCit9DQor
DQorc3RhdGljIHZvaWQgX19waXhwbGxfb3BzX3Bvd2VyZG93bihzdHJ1Y3QgbHNkY19waXhwbGwg
KiBjb25zdCB0aGlzKQ0KK3sNCisJdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCBwaXhwbGxf
cmVnOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVnKTsNCisNCisJcGl4cGxs
X3JlZy5iaXRtYXAucG93ZXJkb3duID0gMTsNCisNCisJX19waXhwbGxfd3JlZyh0aGlzLCAmcGl4
cGxsX3JlZyk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29wc19vbihzdHJ1Y3QgbHNk
Y19waXhwbGwgKiBjb25zdCB0aGlzKQ0KK3sNCisJdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1h
cCBwaXhwbGxfcmVnOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVnKTsNCisN
CisJcGl4cGxsX3JlZy5iaXRtYXAuc2VsX291dCA9IDE7DQorDQorCV9fcGl4cGxsX3dyZWcodGhp
cywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfb2ZmKHN0
cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpDQorew0KKwl1bmlvbiBsc2RjX3BpeHBsbF9y
ZWdfYml0bWFwIHBpeHBsbF9yZWc7DQorDQorCV9fcGl4cGxsX3JyZWcodGhpcywgJnBpeHBsbF9y
ZWcpOw0KKw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5zZWxfb3V0ID0gMDsNCisNCisJX19waXhwbGxf
d3JlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29w
c19ieXBhc3Moc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxz
ZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlz
LCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLmJ5cGFzcyA9IDE7DQorDQor
CV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBf
X3BpeHBsbF9vcHNfdW5ieXBhc3Moc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7
DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhw
bGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLmJ5cGFz
cyA9IDA7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitz
dGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfdW50b2dnbGVfcGFyYW0oc3RydWN0IGxzZGNfcGl4cGxs
ICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxs
X3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBs
bF9yZWcuYml0bWFwLnNldF9wYXJhbSA9IDA7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBp
eHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfc2V0X3BhcmFtKHN0
cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJCSAgIHN0cnVjdCBsc2RjX3BpeHBs
bF9wYXJtcyBjb25zdCAqcCkNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4
cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBp
eHBsbF9yZWcuYml0bWFwLmRpdl9yZWYgPSBwLT5kaXZfcmVmOw0KKwlwaXhwbGxfcmVnLmJpdG1h
cC5sb29wYyA9IHAtPmxvb3BjOw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5kaXZfb3V0ID0gcC0+ZGl2
X291dDsNCisNCisJX19waXhwbGxfd3JlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIF9fcGl4cGxsX29wc190b2dnbGVfcGFyYW0oc3RydWN0IGxzZGNfcGl4cGxsICog
Y29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3Jl
ZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9y
ZWcuYml0bWFwLnNldF9wYXJhbSA9IDE7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBs
bF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfd2FpdF9sb2NrZWQoc3Ry
dWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3Jl
Z19iaXRtYXAgcGl4cGxsX3JlZzsNCisJdW5zaWduZWQgaW50IGNvdW50ZXIgPSAwOw0KKw0KKwlk
byB7DQorCQlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVnKTsNCisNCisJCWlmIChwaXhw
bGxfcmVnLmJpdG1hcC5sb2NrZWQpDQorCQkJYnJlYWs7DQorDQorCQkrK2NvdW50ZXI7DQorCX0g
d2hpbGUgKGNvdW50ZXIgPCAyMDAwKTsNCisNCisJZHJtX2RiZyh0aGlzLT5kZGV2LCAiJXUgbG9v
cCB3YWl0ZWRcbiIsIGNvdW50ZXIpOw0KK30NCisNCisvKg0KKyAqIFVwZGF0ZSB0aGUgUExMIHBh
cmFtZXRlcnMgdG8gdGhlIFBMTCBoYXJkd2FyZQ0KKyAqDQorICogQHRoaXM6IHBvaW50IHRvIHRo
ZSBvYmplY3QgZnJvbSB3aGljaCB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZA0KKyAqIEBwaW46IHBv
aW50IHRvIHRoZSBzdHJ1Y3Qgb2YgbHNkY19waXhwbGxfcGFybXMgcGFzc2VkIGluDQorICoNCisg
KiByZXR1cm4gMCBpZiBzdWNjZXNzZnVsLg0KKyAqLw0KK3N0YXRpYyBpbnQgbHNkY19waXhwbGxf
dXBkYXRlKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJICAgICAgc3RydWN0
IGxzZGNfcGl4cGxsX3Bhcm1zIGNvbnN0ICpwaW4pDQorew0KKwlfX3BpeHBsbF9vcHNfYnlwYXNz
KHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfb2ZmKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNf
cG93ZXJkb3duKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfdG9nZ2xlX3BhcmFtKHRoaXMpOw0K
Kw0KKwlfX3BpeHBsbF9vcHNfc2V0X3BhcmFtKHRoaXMsIHBpbik7DQorDQorCV9fcGl4cGxsX29w
c191bnRvZ2dsZV9wYXJhbSh0aGlzKTsNCisNCisJX19waXhwbGxfb3BzX3Bvd2VydXAodGhpcyk7
DQorDQorCXVkZWxheSgyKTsNCisNCisJX19waXhwbGxfb3BzX3dhaXRfbG9ja2VkKHRoaXMpOw0K
Kw0KKwlfX3BpeHBsbF9vcHNfb24odGhpcyk7DQorDQorCV9fcGl4cGxsX29wc191bmJ5cGFzcyh0
aGlzKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB1bnNpZ25lZCBpbnQgbHNkY19w
aXhwbGxfZ2V0X2ZyZXEoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXN0
cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcHBhciA9IHRoaXMtPnByaXY7DQorCXVuaW9uIGxzZGNf
cGl4cGxsX3JlZ19iaXRtYXAgcGl4X3BsbF9yZWc7DQorCXVuc2lnbmVkIGludCBmcmVxOw0KKw0K
KwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhfcGxsX3JlZyk7DQorDQorCXBwYXItPmRpdl9yZWYg
PSBwaXhfcGxsX3JlZy5iaXRtYXAuZGl2X3JlZjsNCisJcHBhci0+bG9vcGMgPSBwaXhfcGxsX3Jl
Zy5iaXRtYXAubG9vcGM7DQorCXBwYXItPmRpdl9vdXQgPSBwaXhfcGxsX3JlZy5iaXRtYXAuZGl2
X291dDsNCisNCisJZnJlcSA9IHBwYXItPnJlZl9jbG9jayAvIHBwYXItPmRpdl9yZWYgKiBwcGFy
LT5sb29wYyAvIHBwYXItPmRpdl9vdXQ7DQorDQorCXJldHVybiBmcmVxOw0KK30NCisNCitzdGF0
aWMgdm9pZCBsc2RjX3BpeHBsbF9wcmludChzdHJ1Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0aGlz
LA0KKwkJCSAgICAgIHN0cnVjdCBkcm1fcHJpbnRlciAqcCkNCit7DQorCXN0cnVjdCBsc2RjX3Bp
eHBsbF9wYXJtcyAqcGFybXMgPSB0aGlzLT5wcml2Ow0KKw0KKwlkcm1fcHJpbnRmKHAsICJkaXZf
cmVmOiAldSwgbG9vcGM6ICV1LCBkaXZfb3V0OiAldVxuIiwNCisJCSAgIHBhcm1zLT5kaXZfcmVm
LCBwYXJtcy0+bG9vcGMsIHBhcm1zLT5kaXZfb3V0KTsNCit9DQorDQorLyoNCisgKiBMUzdBMTAw
MCwgTFM3QTIwMDAgYW5kIGxzMmsyMDAwJ3MgcGl4ZWwgcGxsIHNldHRpbmcgcmVnaXN0ZXIgaXMg
c2FtZSwNCisgKiB3ZSB0YWtlIHRoaXMgYXMgZGVmYXVsdCwgY3JlYXRlIGEgbmV3IGluc3RhbmNl
IGlmIGEgZGlmZmVyZW50IG1vZGVsIGlzDQorICogaW50cm9kdWNlZC4NCisgKi8NCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzIF9fcGl4cGxsX2RlZmF1bHRfZnVuY3MgPSB7
DQorCS5zZXR1cCA9IGxzZGNfcGl4ZWxfcGxsX3NldHVwLA0KKwkuY29tcHV0ZSA9IGxzZGNfcGl4
ZWxfcGxsX2NvbXB1dGUsDQorCS51cGRhdGUgPSBsc2RjX3BpeHBsbF91cGRhdGUsDQorCS5nZXRf
cmF0ZSA9IGxzZGNfcGl4cGxsX2dldF9mcmVxLA0KKwkucHJpbnQgPSBsc2RjX3BpeHBsbF9wcmlu
dCwNCit9Ow0KKw0KKy8qIHBpeGVsIHBsbCBpbml0aWFsaXphdGlvbiAqLw0KKw0KK2ludCBsc2Rj
X3BpeHBsbF9pbml0KHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgIHN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpDQorew0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwljb25zdCBzdHJ1
Y3QgbHNkY19kZXNjICpkZXNjcCA9IGxkZXYtPmRlc2NwOw0KKwljb25zdCBzdHJ1Y3QgbG9vbmdz
b25fZ2Z4X2Rlc2MgKmdmeCA9IHRvX2xvb25nc29uX2dmeChkZXNjcCk7DQorDQorCXRoaXMtPmRk
ZXYgPSBkZGV2Ow0KKwl0aGlzLT5yZWdfc2l6ZSA9IDg7DQorCXRoaXMtPnJlZ19iYXNlID0gZ2Z4
LT5jb25mX3JlZ19iYXNlICsgZ2Z4LT5waXhwbGxbaW5kZXhdLnJlZ19vZmZzZXQ7DQorCXRoaXMt
PmZ1bmNzID0gJl9fcGl4cGxsX2RlZmF1bHRfZnVuY3M7DQorDQorCXJldHVybiB0aGlzLT5mdW5j
cy0+c2V0dXAodGhpcyk7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nv
bi9sc2RjX3BpeHBsbC5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmgN
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjA2ZWJjZGZjMTczMw0K
LS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxs
LmgNCkBAIC0wLDAgKzEsODYgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MCAqLw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29y
cG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5kZWYgX19MU0RDX1BJWFBMTF9IX18NCisj
ZGVmaW5lIF9fTFNEQ19QSVhQTExfSF9fDQorDQorI2luY2x1ZGUgPGRybS9kcm1fZGV2aWNlLmg+
DQorDQorLyoNCisgKiBMb29uZ3NvbiBQaXhlbCBQTEwgaGFyZHdhcmUgc3RydWN0dXJlDQorICoN
CisgKiByZWZjbGs6IHJlZmVyZW5jZSBmcmVxdWVuY3ksIDEwMCBNSHogZnJvbSBleHRlcm5hbCBv
c2NpbGxhdG9yDQorICogb3V0Y2xrOiBvdXRwdXQgZnJlcXVlbmN5IGRlc2lyZWQuDQorICoNCisg
Kg0KKyAqICAgICAgICAgICAgICAgTDEgICAgICAgRnJlZiAgICAgICAgICAgICAgICAgICAgICBG
dmNvICAgICBMMg0KKyAqIHJlZmNsayAgICstLS0tLS0tLS0tLSsgICAgICArLS0tLS0tLS0tLS0t
LS0tLS0tKyAgICAgICstLS0tLS0tLS0rICAgb3V0Y2xrDQorICogLS0tKy0tLT4gfCBQcmVzY2Fs
ZXIgfCAtLS0+IHwgQ2xvY2sgTXVsdGlwbGllciB8IC0tLT4gfCBkaXZpZGVyIHwgLS0tLS0tLS0+
DQorICogICAgfCAgICAgKy0tLS0tLS0tLS0tKyAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0rICAg
ICAgKy0tLS0tLS0tLSsgICAgIF4NCisgKiAgICB8ICAgICAgICAgICBeICAgICAgICAgICAgICAg
ICAgICAgIF4gICAgICAgICAgICAgICAgICAgIF4gICAgICAgICAgfA0KKyAqICAgIHwgICAgICAg
ICAgIHwgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgfCAgICAgICAg
ICB8DQorICogICAgfCAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAg
ICAgICAgICAgICB8ICAgICAgICAgIHwNCisgKiAgICB8ICAgICAgICBkaXZfcmVmICAgICAgICAg
ICAgICAgICBsb29wYyAgICAgICAgICAgICAgIGRpdl9vdXQgICAgICAgfA0KKyAqICAgIHwgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8DQorICogICAgKy0tLS0gYnlwYXNzIChieXBhc3MgYWJvdmUgc29mdHdhcmUgY29uZmln
dXJhYmxlIGNsb2NrIGlmIHNldCkgLS0tLSsNCisgKg0KKyAqICAgb3V0Y2xrID0gcmVmY2xrIC8g
ZGl2X3JlZiAqIGxvb3BjIC8gZGl2X291dDsNCisgKg0KKyAqICAgc2VsX291dDogUExMIGNsb2Nr
IG91dHB1dCBzZWxlY3RvcihlbmFibGUpLg0KKyAqDQorICogICBJZiBzZWxfb3V0ID09IDEsIHRo
ZW4gZW5hYmxlIG91dHB1dCBjbG9jayAodHVybiBPbik7DQorICogICBJZiBzZWxfb3V0ID09IDAs
IHRoZW4gZGlzYWJsZSBvdXRwdXQgY2xvY2sgKHR1cm4gT2ZmKTsNCisgKg0KKyAqIFBMTCB3b3Jr
aW5nIHJlcXVpcmVtZW50czoNCisgKg0KKyAqICAxKSAyMCBNSHogPD0gcmVmY2xrIC8gZGl2X3Jl
ZiA8PSA0ME1oeg0KKyAqICAyKSAxLjIgR0h6IDw9IHJlZmNsayAvZGl2X291dCAqIGxvb3BjIDw9
IDMuMiBHaHoNCisgKi8NCisNCitzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgew0KKwl1bnNpZ25l
ZCBpbnQgcmVmX2Nsb2NrOw0KKwl1bnNpZ25lZCBpbnQgZGl2X3JlZjsNCisJdW5zaWduZWQgaW50
IGxvb3BjOw0KKwl1bnNpZ25lZCBpbnQgZGl2X291dDsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX3Bp
eHBsbDsNCisNCitzdHJ1Y3QgbHNkY19waXhwbGxfZnVuY3Mgew0KKwlpbnQgKCpzZXR1cCkoc3Ry
dWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcyk7DQorDQorCWludCAoKmNvbXB1dGUpKHN0cnVj
dCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICAgdW5zaWduZWQgaW50IGNsb2Nr
LA0KKwkJICAgICAgIHN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcG91dCk7DQorDQorCWludCAo
KnVwZGF0ZSkoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcywNCisJCSAgICAgIHN0cnVj
dCBsc2RjX3BpeHBsbF9wYXJtcyBjb25zdCAqcGluKTsNCisNCisJdW5zaWduZWQgaW50ICgqZ2V0
X3JhdGUpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpOw0KKw0KKwl2b2lkICgqcHJp
bnQpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICBzdHJ1Y3QgZHJt
X3ByaW50ZXIgKnByaW50ZXIpOw0KK307DQorDQorc3RydWN0IGxzZGNfcGl4cGxsIHsNCisJY29u
c3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpmdW5jczsNCisNCisJc3RydWN0IGRybV9kZXZp
Y2UgKmRkZXY7DQorDQorCS8qIFBMTCByZWdpc3RlciBvZmZzZXQgKi8NCisJdTMyIHJlZ19iYXNl
Ow0KKwkvKiBQTEwgcmVnaXN0ZXIgc2l6ZSBpbiBieXRlcyAqLw0KKwl1MzIgcmVnX3NpemU7DQor
DQorCXZvaWQgX19pb21lbSAqbW1pbzsNCisNCisJc3RydWN0IGxzZGNfcGl4cGxsX3Bhcm1zICpw
cml2Ow0KK307DQorDQoraW50IGxzZGNfcGl4cGxsX2luaXQoc3RydWN0IGxzZGNfcGl4cGxsICog
Y29uc3QgdGhpcywNCisJCSAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkgICAgIHVu
c2lnbmVkIGludCBpbmRleCk7DQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfcGxhbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X3BsYW5lLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjZkMTQ0
N2M3YmZmMQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfcGxhbmUuYw0KQEAgLTAsMCArMSw3ODEgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xv
Z3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5o
Pg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0
b21pY19oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9mcmFtZWJ1ZmZlci5oPg0KKyNpbmNs
dWRlIDxkcm0vZHJtX2dlbV9hdG9taWNfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fcGxh
bmVfaGVscGVyLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNf
cmVncy5oIg0KKyNpbmNsdWRlICJsc2RjX3R0bS5oIg0KKw0KK3N0YXRpYyBjb25zdCB1MzIgbHNk
Y19wcmltYXJ5X2Zvcm1hdHNbXSA9IHsNCisJRFJNX0ZPUk1BVF9YUkdCODg4OCwNCit9Ow0KKw0K
K3N0YXRpYyBjb25zdCB1MzIgbHNkY19jdXJzb3JfZm9ybWF0c1tdID0gew0KKwlEUk1fRk9STUFU
X0FSR0I4ODg4LA0KK307DQorDQorc3RhdGljIGNvbnN0IHU2NCBsc2RjX2ZiX2Zvcm1hdF9tb2Rp
ZmllcnNbXSA9IHsNCisJRFJNX0ZPUk1BVF9NT0RfTElORUFSLA0KKwlEUk1fRk9STUFUX01PRF9J
TlZBTElEDQorfTsNCisNCitzdGF0aWMgdW5zaWduZWQgaW50IGxzZGNfZ2V0X2ZiX29mZnNldChz
dHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwNCisJCQkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmVf
c3RhdGUgKnN0YXRlKQ0KK3sNCisJdW5zaWduZWQgaW50IG9mZnNldCA9IGZiLT5vZmZzZXRzWzBd
Ow0KKw0KKwlvZmZzZXQgKz0gZmItPmZvcm1hdC0+Y3BwWzBdICogKHN0YXRlLT5zcmNfeCA+PiAx
Nik7DQorCW9mZnNldCArPSBmYi0+cGl0Y2hlc1swXSAqIChzdGF0ZS0+c3JjX3kgPj4gMTYpOw0K
Kw0KKwlyZXR1cm4gb2Zmc2V0Ow0KK30NCisNCitzdGF0aWMgdTY0IGxzZGNfZmJfYmFzZV9hZGRy
KHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICps
ZGV2ID0gdG9fbHNkYyhmYi0+ZGV2KTsNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9IGdlbV90b19s
c2RjX2JvKGZiLT5vYmpbMF0pOw0KKw0KKwlyZXR1cm4gbHNkY19ib19ncHVfb2Zmc2V0KGxibykg
KyBsZGV2LT52cmFtX2Jhc2U7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19wcmltYXJ5X2F0b21p
Y19jaGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJICAgICBzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpuZXdfcGxh
bmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsN
CisJc3RydWN0IGRybV9jcnRjICpjcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjOw0KKwlzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOw0KKw0KKwlpZiAoIWNydGMpDQorCQly
ZXR1cm4gMDsNCisNCisJbmV3X2NydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19z
dGF0ZShzdGF0ZSwgY3J0Yyk7DQorDQorCXJldHVybiBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19w
bGFuZV9zdGF0ZShuZXdfcGxhbmVfc3RhdGUsDQorCQkJCQkJICAgbmV3X2NydGNfc3RhdGUsDQor
CQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1ND
QUxJTkcsDQorCQkJCQkJICAgZmFsc2UsDQorCQkJCQkJICAgdHJ1ZSk7DQorfQ0KKw0KK3N0YXRp
YyB2b2lkIGxzZGNfcHJpbWFyeV9hdG9taWNfdXBkYXRlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5l
LA0KKwkJCQkgICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3Ry
dWN0IGxzZGNfcHJpbWFyeSAqcHJpbWFyeSA9IHRvX2xzZGNfcHJpbWFyeShwbGFuZSk7DQorCWNv
bnN0IHN0cnVjdCBsc2RjX3ByaW1hcnlfcGxhbmVfb3BzICpvcHMgPSBwcmltYXJ5LT5vcHM7DQor
CXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0
X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRl
ICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUs
IHBsYW5lKTsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqbmV3X2ZiID0gbmV3X3BsYW5lX3N0
YXRlLT5mYjsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqb2xkX2ZiID0gb2xkX3BsYW5lX3N0
YXRlLT5mYjsNCisJdTY0IGZiX2FkZHIgPSBsc2RjX2ZiX2Jhc2VfYWRkcihuZXdfZmIpOw0KKw0K
KwlmYl9hZGRyICs9IGxzZGNfZ2V0X2ZiX29mZnNldChuZXdfZmIsIG5ld19wbGFuZV9zdGF0ZSk7
DQorDQorCWRybV9kYmcocGxhbmUtPmRldiwgImZiIGRtYSBhZGRyOiAlbGx4XG4iLCBmYl9hZGRy
KTsNCisNCisJb3BzLT51cGRhdGVfZmJfYWRkcihwcmltYXJ5LCBmYl9hZGRyKTsNCisJb3BzLT51
cGRhdGVfZmJfc3RyaWRlKHByaW1hcnksIG5ld19mYi0+cGl0Y2hlc1swXSk7DQorDQorCWlmICgh
b2xkX2ZiIHx8IG9sZF9mYi0+Zm9ybWF0ICE9IG5ld19mYi0+Zm9ybWF0KQ0KKwkJb3BzLT51cGRh
dGVfZmJfZm9ybWF0KHByaW1hcnksIG5ld19mYi0+Zm9ybWF0KTsNCit9DQorDQorc3RhdGljIHZv
aWQgbHNkY19wcmltYXJ5X2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0K
KwkJCQkJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJLyogRG8gbm90aGlu
ZywganVzdCBwcmV2ZW50IGNhbGwgaW50byBhdG9taWNfdXBkYXRlKCkuDQorCSAqIFdyaXRpbmcg
dGhlIGZvcm1hdCBhcyBMU0RDX1BGX05PTkUgY2FuIGRpc2FibGUgdGhlIHByaW1hcnksDQorCSAq
IEJ1dCBpdCBzZWVtcyBub3QgbmVjZXNzYXJ5Li4uDQorCSAqLw0KKwlkcm1fZGJnKHBsYW5lLT5k
ZXYsICIlcyBkaXNhYmxlZFxuIiwgcGxhbmUtPm5hbWUpOw0KK30NCisNCitzdGF0aWMgaW50IGxz
ZGNfcGxhbmVfcHJlcGFyZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJIHN0cnVj
dCBkcm1fcGxhbmVfc3RhdGUgKm5ld19zdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKmZiID0gbmV3X3N0YXRlLT5mYjsNCisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisJdTY0IGdw
dV92YWRkcjsNCisJaW50IHJldDsNCisNCisJaWYgKCFmYikNCisJCXJldHVybiAwOw0KKw0KKwls
Ym8gPSBnZW1fdG9fbHNkY19ibyhmYi0+b2JqWzBdKTsNCisNCisJcmV0ID0gbHNkY19ib19yZXNl
cnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fZXJyKHBsYW5lLT5kZXYs
ICJibyAlcCByZXNlcnZlIGZhaWxlZFxuIiwgbGJvKTsNCisJCXJldHVybiByZXQ7DQorCX0NCisN
CisJcmV0ID0gbHNkY19ib19waW4obGJvLCBMU0RDX0dFTV9ET01BSU5fVlJBTSwgJmdwdV92YWRk
cik7DQorDQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorDQorCWlmICh1bmxpa2VseShyZXQp
KSB7DQorCQlkcm1fZXJyKHBsYW5lLT5kZXYsICJibyAlcCBwaW4gZmFpbGVkXG4iLCBsYm8pOw0K
KwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlsc2RjX2JvX3JlZihsYm8pOw0KKw0KKwlpZiAocGxh
bmUtPnR5cGUgIT0gRFJNX1BMQU5FX1RZUEVfQ1VSU09SKQ0KKwkJZHJtX2RiZyhwbGFuZS0+ZGV2
LA0KKwkJCSIlc1slcF0gcGluIGF0IDB4JWxseCwgYm8gc2l6ZTogJXp1XG4iLA0KKwkJCXBsYW5l
LT5uYW1lLCBsYm8sIGdwdV92YWRkciwgbHNkY19ib19zaXplKGxibykpOw0KKw0KKwlyZXR1cm4g
ZHJtX2dlbV9wbGFuZV9oZWxwZXJfcHJlcGFyZV9mYihwbGFuZSwgbmV3X3N0YXRlKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19wbGFuZV9jbGVhbnVwX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBs
YW5lLA0KKwkJCQkgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSkNCit7DQorCXN0
cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gb2xkX3N0YXRlLT5mYjsNCisJc3RydWN0IGxzZGNf
Ym8gKmxibzsNCisJaW50IHJldDsNCisNCisJaWYgKCFmYikNCisJCXJldHVybjsNCisNCisJbGJv
ID0gZ2VtX3RvX2xzZGNfYm8oZmItPm9ialswXSk7DQorDQorCXJldCA9IGxzZGNfYm9fcmVzZXJ2
ZShsYm8pOw0KKwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJZHJtX2VycihwbGFuZS0+ZGV2LCAi
JXAgcmVzZXJ2ZSBmYWlsZWRcbiIsIGxibyk7DQorCQlyZXR1cm47DQorCX0NCisNCisJbHNkY19i
b191bnBpbihsYm8pOw0KKw0KKwlsc2RjX2JvX3VucmVzZXJ2ZShsYm8pOw0KKw0KKwlsc2RjX2Jv
X3VucmVmKGxibyk7DQorDQorCWlmIChwbGFuZS0+dHlwZSAhPSBEUk1fUExBTkVfVFlQRV9DVVJT
T1IpDQorCQlkcm1fZGJnKHBsYW5lLT5kZXYsICIlcyB1bnBpblxuIiwgcGxhbmUtPm5hbWUpOw0K
K30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgbHNkY19w
cmltYXJ5X2hlbHBlcl9mdW5jcyA9IHsNCisJLnByZXBhcmVfZmIgPSBsc2RjX3BsYW5lX3ByZXBh
cmVfZmIsDQorCS5jbGVhbnVwX2ZiID0gbHNkY19wbGFuZV9jbGVhbnVwX2ZiLA0KKwkuYXRvbWlj
X2NoZWNrID0gbHNkY19wcmltYXJ5X2F0b21pY19jaGVjaywNCisJLmF0b21pY191cGRhdGUgPSBs
c2RjX3ByaW1hcnlfYXRvbWljX3VwZGF0ZSwNCisJLmF0b21pY19kaXNhYmxlID0gbHNkY19wcmlt
YXJ5X2F0b21pY19kaXNhYmxlLA0KK307DQorDQorc3RhdGljIGludCBsc2RjX2N1cnNvcl9wbGFu
ZV9hdG9taWNfYXN5bmNfY2hlY2soc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJc3Ry
dWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0
ZSAqbmV3X3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3RhdGU7DQorDQor
CW5ld19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUp
Ow0KKw0KKwlpZiAoIXBsYW5lLT5zdGF0ZSB8fCAhcGxhbmUtPnN0YXRlLT5mYikgew0KKwkJZHJt
X2RiZyhwbGFuZS0+ZGV2LCAiJXM6IHN0YXRlIGlzIE5VTExcbiIsIHBsYW5lLT5uYW1lKTsNCisJ
CXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCWlmIChzdGF0ZSkgew0KKwkJY3J0Y19zdGF0ZSA9
IGRybV9hdG9taWNfZ2V0X2V4aXN0aW5nX2NydGNfc3RhdGUoc3RhdGUsIG5ld19zdGF0ZS0+Y3J0
Yyk7DQorCX0gZWxzZSB7DQorCQljcnRjX3N0YXRlID0gcGxhbmUtPmNydGMtPnN0YXRlOw0KKwkJ
ZHJtX2RiZyhwbGFuZS0+ZGV2LCAiJXM6IGF0b21pYyBzdGF0ZSBpcyBOVUxMXG4iLCBwbGFuZS0+
bmFtZSk7DQorCX0NCisNCisJaWYgKCFjcnRjX3N0YXRlLT5hY3RpdmUpDQorCQlyZXR1cm4gLUVJ
TlZBTDsNCisNCisJaWYgKHBsYW5lLT5zdGF0ZS0+Y3J0YyAhPSBuZXdfc3RhdGUtPmNydGMgfHwN
CisJICAgIHBsYW5lLT5zdGF0ZS0+c3JjX3cgIT0gbmV3X3N0YXRlLT5zcmNfdyB8fA0KKwkgICAg
cGxhbmUtPnN0YXRlLT5zcmNfaCAhPSBuZXdfc3RhdGUtPnNyY19oIHx8DQorCSAgICBwbGFuZS0+
c3RhdGUtPmNydGNfdyAhPSBuZXdfc3RhdGUtPmNydGNfdyB8fA0KKwkgICAgcGxhbmUtPnN0YXRl
LT5jcnRjX2ggIT0gbmV3X3N0YXRlLT5jcnRjX2gpDQorCQlyZXR1cm4gLUVJTlZBTDsNCisNCisJ
cmV0dXJuIGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKHBsYW5lLT5zdGF0ZSwN
CisJCQkJCQkgICBjcnRjX3N0YXRlLA0KKwkJCQkJCSAgIERSTV9QTEFORV9OT19TQ0FMSU5HLA0K
KwkJCQkJCSAgIERSTV9QTEFORV9OT19TQ0FMSU5HLA0KKwkJCQkJCSAgIHRydWUsDQorCQkJCQkJ
ICAgdHJ1ZSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3Vyc29yX3BsYW5lX2F0b21pY19h
c3luY191cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJICBzdHJ1Y3QgZHJt
X2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciA9
IHRvX2xzZGNfY3Vyc29yKHBsYW5lKTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3Vyc29yX3BsYW5l
X29wcyAqb3BzID0gY3Vyc29yLT5vcHM7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKm9sZF9m
YiA9IHBsYW5lLT5zdGF0ZS0+ZmI7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKm5ld19mYjsN
CisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3N0YXRlOw0KKw0KKwluZXdfc3RhdGUgPSBk
cm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsNCisNCisJbmV3X2Zi
ID0gcGxhbmUtPnN0YXRlLT5mYjsNCisNCisJcGxhbmUtPnN0YXRlLT5jcnRjX3ggPSBuZXdfc3Rh
dGUtPmNydGNfeDsNCisJcGxhbmUtPnN0YXRlLT5jcnRjX3kgPSBuZXdfc3RhdGUtPmNydGNfeTsN
CisJcGxhbmUtPnN0YXRlLT5jcnRjX2ggPSBuZXdfc3RhdGUtPmNydGNfaDsNCisJcGxhbmUtPnN0
YXRlLT5jcnRjX3cgPSBuZXdfc3RhdGUtPmNydGNfdzsNCisJcGxhbmUtPnN0YXRlLT5zcmNfeCA9
IG5ld19zdGF0ZS0+c3JjX3g7DQorCXBsYW5lLT5zdGF0ZS0+c3JjX3kgPSBuZXdfc3RhdGUtPnNy
Y195Ow0KKwlwbGFuZS0+c3RhdGUtPnNyY19oID0gbmV3X3N0YXRlLT5zcmNfaDsNCisJcGxhbmUt
PnN0YXRlLT5zcmNfdyA9IG5ld19zdGF0ZS0+c3JjX3c7DQorCXN3YXAocGxhbmUtPnN0YXRlLT5m
YiwgbmV3X3N0YXRlLT5mYik7DQorDQorCWlmIChuZXdfc3RhdGUtPnZpc2libGUpIHsNCisJCWVu
dW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6ZTsNCisNCisJCXN3aXRjaCAobmV3X3N0YXRl
LT5jcnRjX3cpIHsNCisJCWNhc2UgNjQ6DQorCQkJY3Vyc29yX3NpemUgPSBDVVJTT1JfU0laRV82
NFg2NDsNCisJCQlicmVhazsNCisJCWNhc2UgMzI6DQorCQkJY3Vyc29yX3NpemUgPSBDVVJTT1Jf
U0laRV8zMlgzMjsNCisJCQlicmVhazsNCisJCWRlZmF1bHQ6DQorCQkJY3Vyc29yX3NpemUgPSBD
VVJTT1JfU0laRV8zMlgzMjsNCisJCQlicmVhazsNCisJCX0NCisNCisJCW9wcy0+dXBkYXRlX3Bv
c2l0aW9uKGN1cnNvciwgbmV3X3N0YXRlLT5jcnRjX3gsIG5ld19zdGF0ZS0+Y3J0Y195KTsNCisN
CisJCW9wcy0+dXBkYXRlX2NmZyhjdXJzb3IsIGN1cnNvcl9zaXplLCBDVVJTT1JfRk9STUFUX0FS
R0I4ODg4KTsNCisNCisJCWlmICghb2xkX2ZiIHx8IG9sZF9mYiAhPSBuZXdfZmIpDQorCQkJb3Bz
LT51cGRhdGVfYm9fYWRkcihjdXJzb3IsIGxzZGNfZmJfYmFzZV9hZGRyKG5ld19mYikpOw0KKwl9
DQorfQ0KKw0KKy8qIGxzN2ExMDAwIGN1cnNvciBwbGFuZSBoZWxwZXJzICovDQorDQorc3RhdGlj
IGludCBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lLA0KKwkJCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sN
CisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlOw0KKwlzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7DQor
DQorCW5ld19wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0
ZSwgcGxhbmUpOw0KKw0KKwljcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjOw0KKwlpZiAoIWNy
dGMpIHsNCisJCWRybV9kYmcocGxhbmUtPmRldiwgIiVzIGlzIG5vdCBiaW5kIHRvIGEgY3J0Y1xu
IiwgcGxhbmUtPm5hbWUpOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJaWYgKG5ld19wbGFuZV9z
dGF0ZS0+Y3J0Y193ID4gMzIgfHwgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX2ggPiAzMikgew0KKwkJ
ZHJtX2RiZyhwbGFuZS0+ZGV2LCAiJXMgaXMgdG9vIGxhcmdlICV1eCV1XG4iLCBwbGFuZS0+bmFt
ZSwNCisJCQluZXdfcGxhbmVfc3RhdGUtPmNydGNfdywgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX2gp
Ow0KKwkJcmV0dXJuIC1FSU5WQUw7DQorCX0NCisNCisJbmV3X2NydGNfc3RhdGUgPSBkcm1fYXRv
bWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7DQorDQorCXJldHVybiBkcm1fYXRv
bWljX2hlbHBlcl9jaGVja19wbGFuZV9zdGF0ZShuZXdfcGxhbmVfc3RhdGUsDQorCQkJCQkJICAg
bmV3X2NydGNfc3RhdGUsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJ
ICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgdHJ1ZSwNCisJCQkJCQkgICB0cnVl
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTEwMDBfY3Vyc29yX3BsYW5lX2F0b21pY191cGRh
dGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJc3RydWN0IGRybV9hdG9taWNfc3Rh
dGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3IgPSB0b19sc2RjX2N1
cnNvcihwbGFuZSk7DQorCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSA9
IGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0KKwlzdHJ1Y3Qg
ZHJtX3BsYW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxh
bmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqbmV3X2Zi
ID0gbmV3X3BsYW5lX3N0YXRlLT5mYjsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqb2xkX2Zi
ID0gb2xkX3BsYW5lX3N0YXRlLT5mYjsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3Vyc29yX3BsYW5l
X29wcyAqb3BzID0gY3Vyc29yLT5vcHM7DQorCXU2NCBhZGRyID0gbHNkY19mYl9iYXNlX2FkZHIo
bmV3X2ZiKTsNCisNCisJaWYgKCFuZXdfcGxhbmVfc3RhdGUtPnZpc2libGUpDQorCQlyZXR1cm47
DQorDQorCW9wcy0+dXBkYXRlX3Bvc2l0aW9uKGN1cnNvciwgbmV3X3BsYW5lX3N0YXRlLT5jcnRj
X3gsIG5ld19wbGFuZV9zdGF0ZS0+Y3J0Y195KTsNCisNCisJaWYgKCFvbGRfZmIgfHwgb2xkX2Zi
ICE9IG5ld19mYikNCisJCW9wcy0+dXBkYXRlX2JvX2FkZHIoY3Vyc29yLCBhZGRyKTsNCisNCisJ
b3BzLT51cGRhdGVfY2ZnKGN1cnNvciwgQ1VSU09SX1NJWkVfMzJYMzIsIENVUlNPUl9GT1JNQVRf
QVJHQjg4ODgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRv
bWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJIHN0cnVjdCBkcm1f
YXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX2N1cnNvciAqY3Vyc29yID0g
dG9fbHNkY19jdXJzb3IocGxhbmUpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19jdXJzb3JfcGxhbmVf
b3BzICpvcHMgPSBjdXJzb3ItPm9wczsNCisNCisJb3BzLT51cGRhdGVfY2ZnKGN1cnNvciwgQ1VS
U09SX1NJWkVfMzJYMzIsIENVUlNPUl9GT1JNQVRfRElTQUJMRSk7DQorfQ0KKw0KK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9mdW5jcyBsczdhMTAwMF9jdXJzb3JfcGxhbmVf
aGVscGVyX2Z1bmNzID0gew0KKwkucHJlcGFyZV9mYiA9IGxzZGNfcGxhbmVfcHJlcGFyZV9mYiwN
CisJLmNsZWFudXBfZmIgPSBsc2RjX3BsYW5lX2NsZWFudXBfZmIsDQorCS5hdG9taWNfY2hlY2sg
PSBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2NoZWNrLA0KKwkuYXRvbWljX3VwZGF0ZSA9
IGxzN2ExMDAwX2N1cnNvcl9wbGFuZV9hdG9taWNfdXBkYXRlLA0KKwkuYXRvbWljX2Rpc2FibGUg
PSBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2Rpc2FibGUsDQorCS5hdG9taWNfYXN5bmNf
Y2hlY2sgPSBsc2RjX2N1cnNvcl9wbGFuZV9hdG9taWNfYXN5bmNfY2hlY2ssDQorCS5hdG9taWNf
YXN5bmNfdXBkYXRlID0gbHNkY19jdXJzb3JfcGxhbmVfYXRvbWljX2FzeW5jX3VwZGF0ZSwNCit9
Ow0KKw0KKy8qIGxzN2EyMDAwIGN1cnNvciBwbGFuZSBoZWxwZXJzICovDQorDQorc3RhdGljIGlu
dCBsczdhMjAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1fcGxhbmUgKnBs
YW5lLA0KKwkJCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJ
c3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2Ny
dGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7DQorDQor
CW5ld19wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0ZSwg
cGxhbmUpOw0KKw0KKwljcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjOw0KKwlpZiAoIWNydGMp
IHsNCisJCWRybV9kYmcocGxhbmUtPmRldiwgIiVzIGlzIG5vdCBiaW5kIHRvIGEgY3J0Y1xuIiwg
cGxhbmUtPm5hbWUpOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJaWYgKG5ld19wbGFuZV9zdGF0
ZS0+Y3J0Y193ID4gNjQgfHwgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX2ggPiA2NCkgew0KKwkJZHJt
X2RiZyhwbGFuZS0+ZGV2LCAiJXMgaXMgdG9vIGxhcmdlICV1eCV1XG4iLCBwbGFuZS0+bmFtZSwN
CisJCQluZXdfcGxhbmVfc3RhdGUtPmNydGNfdywgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX2gpOw0K
KwkJcmV0dXJuIC1FSU5WQUw7DQorCX0NCisNCisJbmV3X2NydGNfc3RhdGUgPSBkcm1fYXRvbWlj
X2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7DQorDQorCXJldHVybiBkcm1fYXRvbWlj
X2hlbHBlcl9jaGVja19wbGFuZV9zdGF0ZShuZXdfcGxhbmVfc3RhdGUsDQorCQkJCQkJICAgbmV3
X2NydGNfc3RhdGUsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAg
RFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgdHJ1ZSwNCisJCQkJCQkgICB0cnVlKTsN
Cit9DQorDQorLyogdXBkYXRlIHRoZSBmb3JtYXQsIHNpemUgYW5kIGxvY2F0aW9uIG9mIHRoZSBj
dXJzb3IgKi8NCisNCitzdGF0aWMgdm9pZCBsczdhMjAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX3Vw
ZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJCQlzdHJ1Y3QgZHJtX2F0b21pY19z
dGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciA9IHRvX2xzZGNf
Y3Vyc29yKHBsYW5lKTsNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3BsYW5lX3N0YXRl
ID0gZHJtX2F0b21pY19nZXRfb2xkX3BsYW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7DQorCXN0cnVj
dCBkcm1fcGxhbmVfc3RhdGUgKm5ld19wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19w
bGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpuZXdf
ZmIgPSBuZXdfcGxhbmVfc3RhdGUtPmZiOw0KKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpvbGRf
ZmIgPSBvbGRfcGxhbmVfc3RhdGUtPmZiOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19jdXJzb3JfcGxh
bmVfb3BzICpvcHMgPSBjdXJzb3ItPm9wczsNCisJdTY0IGFkZHIgPSBsc2RjX2ZiX2Jhc2VfYWRk
cihuZXdfZmIpOw0KKw0KKwlpZiAoIW5ld19wbGFuZV9zdGF0ZS0+dmlzaWJsZSkNCisJCXJldHVy
bjsNCisNCisJb3BzLT51cGRhdGVfcG9zaXRpb24oY3Vyc29yLCBuZXdfcGxhbmVfc3RhdGUtPmNy
dGNfeCwgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX3kpOw0KKw0KKwlpZiAoIW9sZF9mYiB8fCBuZXdf
ZmIgIT0gb2xkX2ZiKQ0KKwkJb3BzLT51cGRhdGVfYm9fYWRkcihjdXJzb3IsIGFkZHIpOw0KKw0K
KwlvcHMtPnVwZGF0ZV9jZmcoY3Vyc29yLCBDVVJTT1JfU0laRV82NFg2NCwgQ1VSU09SX0ZPUk1B
VF9BUkdCODg4OCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9h
dG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJCQkgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3Ig
PSB0b19sc2RjX2N1cnNvcihwbGFuZSk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2N1cnNvcl9wbGFu
ZV9vcHMgKmh3X29wcyA9IGN1cnNvci0+b3BzOw0KKw0KKwlod19vcHMtPnVwZGF0ZV9jZmcoY3Vy
c29yLCBDVVJTT1JfU0laRV82NFg2NCwgQ1VSU09SX0ZPUk1BVF9ESVNBQkxFKTsNCit9DQorDQor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNzIGxzN2EyMDAwX2N1cnNv
cl9wbGFuZV9oZWxwZXJfZnVuY3MgPSB7DQorCS5wcmVwYXJlX2ZiID0gbHNkY19wbGFuZV9wcmVw
YXJlX2ZiLA0KKwkuY2xlYW51cF9mYiA9IGxzZGNfcGxhbmVfY2xlYW51cF9mYiwNCisJLmF0b21p
Y19jaGVjayA9IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9hdG9taWNfY2hlY2ssDQorCS5hdG9taWNf
dXBkYXRlID0gbHM3YTIwMDBfY3Vyc29yX3BsYW5lX2F0b21pY191cGRhdGUsDQorCS5hdG9taWNf
ZGlzYWJsZSA9IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9hdG9taWNfZGlzYWJsZSwNCisJLmF0b21p
Y19hc3luY19jaGVjayA9IGxzZGNfY3Vyc29yX3BsYW5lX2F0b21pY19hc3luY19jaGVjaywNCisJ
LmF0b21pY19hc3luY191cGRhdGUgPSBsc2RjX2N1cnNvcl9wbGFuZV9hdG9taWNfYXN5bmNfdXBk
YXRlLA0KK307DQorDQorc3RhdGljIHZvaWQgbHNkY19wbGFuZV9hdG9taWNfcHJpbnRfc3RhdGUo
c3RydWN0IGRybV9wcmludGVyICpwLA0KKwkJCQkJICBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX3N0
YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gc3RhdGUtPmZi
Ow0KKwl1NjQgYWRkcjsNCisNCisJaWYgKCFmYikNCisJCXJldHVybjsNCisNCisJYWRkciA9IGxz
ZGNfZmJfYmFzZV9hZGRyKGZiKTsNCisNCisJZHJtX3ByaW50ZihwLCAiXHRkbWEgYWRkcj0lbGx4
XG4iLCBhZGRyKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3Mg
bHNkY19wbGFuZV9mdW5jcyA9IHsNCisJLnVwZGF0ZV9wbGFuZSA9IGRybV9hdG9taWNfaGVscGVy
X3VwZGF0ZV9wbGFuZSwNCisJLmRpc2FibGVfcGxhbmUgPSBkcm1fYXRvbWljX2hlbHBlcl9kaXNh
YmxlX3BsYW5lLA0KKwkuZGVzdHJveSA9IGRybV9wbGFuZV9jbGVhbnVwLA0KKwkucmVzZXQgPSBk
cm1fYXRvbWljX2hlbHBlcl9wbGFuZV9yZXNldCwNCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUg
PSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUsDQorCS5hdG9taWNfZGVz
dHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX2Rlc3Ryb3lfc3RhdGUsDQorCS5h
dG9taWNfcHJpbnRfc3RhdGUgPSBsc2RjX3BsYW5lX2F0b21pY19wcmludF9zdGF0ZSwNCit9Ow0K
Kw0KKy8qIHByaW1hcnkgcGxhbmUgMCBoYXJkd2FyZSByZWxhdGVkIG9wcyAgKi8NCisNCitzdGF0
aWMgdm9pZCBsc2RjX3ByaW1hcnkwX3VwZGF0ZV9mYl9hZGRyKHN0cnVjdCBsc2RjX3ByaW1hcnkg
KnByaW1hcnksIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gcHJp
bWFyeS0+bGRldjsNCisJdTMyIHN0YXR1czsNCisJdTMyIGxvLCBoaTsNCisNCisJLyogNDAtYml0
IHdpZHRoIHBoeXNpY2FsIGFkZHJlc3MgYnVzICovDQorCWxvID0gYWRkciAmIDB4RkZGRkZGRkY7
DQorCWhpID0gKGFkZHIgPj4gMzIpICYgMHhGRjsNCisNCisJc3RhdHVzID0gbHNkY19ycmVnMzIo
bGRldiwgTFNEQ19DUlRDMF9DRkdfUkVHKTsNCisJaWYgKHN0YXR1cyAmIEZCX1JFR19JTl9VU0lO
Rykgew0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9GQjFfQUREUl9MT19SRUcsIGxv
KTsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfRkIxX0FERFJfSElfUkVHLCBoaSk7
DQorCX0gZWxzZSB7DQorCQlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX0ZCMF9BRERSX0xP
X1JFRywgbG8pOw0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9GQjBfQUREUl9ISV9S
RUcsIGhpKTsNCisJfQ0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3ByaW1hcnkwX3VwZGF0ZV9m
Yl9zdHJpZGUoc3RydWN0IGxzZGNfcHJpbWFyeSAqcHJpbWFyeSwgdTMyIHN0cmlkZSkNCit7DQor
CXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHByaW1hcnktPmxkZXY7DQorDQorCWxzZGNfd3Jl
ZzMyKGxkZXYsIExTRENfQ1JUQzBfU1RSSURFX1JFRywgc3RyaWRlKTsNCit9DQorDQorc3RhdGlj
IHZvaWQgbHNkY19wcmltYXJ5MF91cGRhdGVfZmJfZm9ybWF0KHN0cnVjdCBsc2RjX3ByaW1hcnkg
KnByaW1hcnksDQorCQkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICpmb3JtYXQp
DQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBwcmltYXJ5LT5sZGV2Ow0KKwl1MzIg
c3RhdHVzOw0KKw0KKwlzdGF0dXMgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMwX0NGR19S
RUcpOw0KKw0KKwkvKg0KKwkgKiBUT0RPOiBhZGQgUkdCNTY1IHN1cHBvcnQsIG9ubHkgc3VwcG9y
dCBYUkJHODg4OCBhdCBwcmVzZW50DQorCSAqLw0KKwlzdGF0dXMgJj0gfkNGR19QSVhfRk1UX01B
U0s7DQorCXN0YXR1cyB8PSBMU0RDX1BGX1hSR0I4ODg4Ow0KKw0KKwlsc2RjX3dyZWczMihsZGV2
LCBMU0RDX0NSVEMwX0NGR19SRUcsIHN0YXR1cyk7DQorDQorCXVkZWxheSg5KTsNCit9DQorDQor
LyogcHJpbWFyeSBwbGFuZSAxIGhhcmR3YXJlIHJlbGF0ZWQgb3BzICovDQorDQorc3RhdGljIHZv
aWQgbHNkY19wcmltYXJ5MV91cGRhdGVfZmJfYWRkcihzdHJ1Y3QgbHNkY19wcmltYXJ5ICpwcmlt
YXJ5LCB1NjQgYWRkcikNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHByaW1hcnkt
PmxkZXY7DQorCXUzMiBzdGF0dXM7DQorCXUzMiBsbywgaGk7DQorDQorCS8qIDQwLWJpdCB3aWR0
aCBwaHlzaWNhbCBhZGRyZXNzIGJ1cyAqLw0KKwlsbyA9IGFkZHIgJiAweEZGRkZGRkZGOw0KKwlo
aSA9IChhZGRyID4+IDMyKSAmIDB4RkY7DQorDQorCXN0YXR1cyA9IGxzZGNfcnJlZzMyKGxkZXYs
IExTRENfQ1JUQzFfQ0ZHX1JFRyk7DQorCWlmIChzdGF0dXMgJiBGQl9SRUdfSU5fVVNJTkcpIHsN
CisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFfRkIxX0FERFJfTE9fUkVHLCBsbyk7DQor
CQlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0ZCMV9BRERSX0hJX1JFRywgaGkpOw0KKwl9
IGVsc2Ugew0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMV9GQjBfQUREUl9MT19SRUcs
IGxvKTsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFfRkIwX0FERFJfSElfUkVHLCBo
aSk7DQorCX0NCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19wcmltYXJ5MV91cGRhdGVfZmJfc3Ry
aWRlKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnByaW1hcnksIHUzMiBzdHJpZGUpDQorew0KKwlzdHJ1
Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBwcmltYXJ5LT5sZGV2Ow0KKw0KKwlsc2RjX3dyZWczMihs
ZGV2LCBMU0RDX0NSVEMxX1NUUklERV9SRUcsIHN0cmlkZSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lk
IGxzZGNfcHJpbWFyeTFfdXBkYXRlX2ZiX2Zvcm1hdChzdHJ1Y3QgbHNkY19wcmltYXJ5ICpwcmlt
YXJ5LA0KKwkJCQkJICAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0KQ0KK3sN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gcHJpbWFyeS0+bGRldjsNCisJdTMyIHN0YXR1
czsNCisNCisJc3RhdHVzID0gbHNkY19ycmVnMzIobGRldiwgTFNEQ19DUlRDMV9DRkdfUkVHKTsN
CisNCisJLyoNCisJICogVE9ETzogYWRkIFJHQjU2NSBzdXBwb3J0LCBvbmx5IHN1cHBvcnQgWFJC
Rzg4ODggYXQgcHJlc2VudA0KKwkgKi8NCisJc3RhdHVzICY9IH5DRkdfUElYX0ZNVF9NQVNLOw0K
KwlzdGF0dXMgfD0gTFNEQ19QRl9YUkdCODg4ODsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNE
Q19DUlRDMV9DRkdfUkVHLCBzdGF0dXMpOw0KKw0KKwl1ZGVsYXkoOSk7DQorfQ0KKw0KK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgbHNkY19wcmltYXJ5X3BsYW5lX29wcyBsc2RjX3ByaW1hcnlfcGxhbmVf
aHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBkYXRlX2ZiX2FkZHIgPSBsc2RjX3ByaW1hcnkwX3Vw
ZGF0ZV9mYl9hZGRyLA0KKwkJLnVwZGF0ZV9mYl9zdHJpZGUgPSBsc2RjX3ByaW1hcnkwX3VwZGF0
ZV9mYl9zdHJpZGUsDQorCQkudXBkYXRlX2ZiX2Zvcm1hdCA9IGxzZGNfcHJpbWFyeTBfdXBkYXRl
X2ZiX2Zvcm1hdCwNCisJfSwNCisJew0KKwkJLnVwZGF0ZV9mYl9hZGRyID0gbHNkY19wcmltYXJ5
MV91cGRhdGVfZmJfYWRkciwNCisJCS51cGRhdGVfZmJfc3RyaWRlID0gbHNkY19wcmltYXJ5MV91
cGRhdGVfZmJfc3RyaWRlLA0KKwkJLnVwZGF0ZV9mYl9mb3JtYXQgPSBsc2RjX3ByaW1hcnkxX3Vw
ZGF0ZV9mYl9mb3JtYXQsDQorCX0sDQorfTsNCisNCisvKg0KKyAqIFVwZGF0ZSBsb2NhdGlvbiwg
Zm9ybWF0LCBlbmFibGUgYW5kIGRpc2FibGUgc3RhdGUgb2YgdGhlIGN1cnNvciwNCisgKiBGb3Ig
dGhvc2Ugd2hvIGhhdmUgdHdvIGhhcmR3YXJlIGN1cnNvciwgY3Vyc29yIDAgaXMgYXR0YWNoIGl0
IHRvIENSVEMtMCwNCisgKiBjdXJzb3IgMSBpcyBhdHRhY2hlZCB0byBDUlRDLTEuIENvbXBvc2l0
aW5nIHRoZSBwcmltYXJ5IGFuZCBjdXJzb3IgcGxhbmUNCisgKiBpcyBhdXRvbWF0aWNhbGx5IGRv
bmUgYnkgaGFyZHdhcmUsIHRoZSBjdXJzb3IgaXMgYWx3YXkgb24gdGhlIHRvcCBvZiB0aGUNCisg
KiBwcmltYXJ5LiBJbiBvdGhlciB3b3JkLCB6LW9yZGVyIGlzIGZpeGVkIGluIGhhcmR3YXJlIGFu
ZCBjYW5ub3QgYmUgY2hhbmdlZC4NCisgKiBGb3IgdGhvc2Ugb2xkIERDIHdobyBoYXMgb25seSBv
bmUgaGFyZHdhcmUgY3Vyc29yLCB3ZSBtYWRlIGl0IHNoYXJlZCBieQ0KKyAqIHRoZSB0d28gc2Ny
ZWVuLCB0aGlzIHdvcmtzIG9uIGV4dGVuZCBzY3JlZW4gbW9kZS4NCisgKi8NCisNCisvKiBjdXJz
b3IgcGxhbmUgMCAoZm9yIHBpcGUgMCkgcmVsYXRlZCBoYXJkd2FyZSBvcHMgKi8NCisNCitzdGF0
aWMgdm9pZCBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIoc3RydWN0IGxzZGNfY3Vyc29yICpj
dXJzb3IsIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29y
LT5sZGV2Ow0KKw0KKwkvKiA0MC1iaXQgd2lkdGggcGh5c2ljYWwgYWRkcmVzcyBidXMgKi8NCisJ
bHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJfSElfUkVHLCAoYWRkciA+PiAzMikg
JiAweEZGKTsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJfTE9fUkVHLCBh
ZGRyKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IwX3VwZGF0ZV9wb3NpdGlvbihz
dHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwgaW50IHgsIGludCB5KQ0KK3sNCisJc3RydWN0IGxz
ZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwlpZiAoeCA8IDApDQorCQl4ID0g
MDsNCisNCisJaWYgKHkgPCAwKQ0KKwkJeSA9IDA7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1VSU09SMF9QT1NJVElPTl9SRUcsICh5IDw8IDE2KSB8IHgpOw0KK30NCisNCitzdGF0aWMg
dm9pZCBsc2RjX2N1cnNvcjBfdXBkYXRlX2NmZyhzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwN
CisJCQkJICAgIGVudW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6ZSwNCisJCQkJICAgIGVu
dW0gbHNkY19jdXJzb3JfZm9ybWF0IGZtdCkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diA9IGN1cnNvci0+bGRldjsNCisJdTMyIGNmZzsNCisNCisJY2ZnID0gQ1VSU09SX09OX0NSVEMw
IDw8IENVUlNPUl9MT0NBVElPTl9TSElGVCB8DQorCSAgICAgIGN1cnNvcl9zaXplIDw8IENVUlNP
Ul9TSVpFX1NISUZUIHwNCisJICAgICAgZm10IDw8IENVUlNPUl9GT1JNQVRfU0hJRlQ7DQorDQor
CWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1VSU09SMF9DRkdfUkVHLCBjZmcpOw0KK30NCisNCisv
KiBjdXJzb3IgcGxhbmUgMSAoZm9yIHBpcGUgMSkgcmVsYXRlZCBoYXJkd2FyZSBvcHMgKi8NCisN
CitzdGF0aWMgdm9pZCBsc2RjX2N1cnNvcjFfdXBkYXRlX2JvX2FkZHIoc3RydWN0IGxzZGNfY3Vy
c29yICpjdXJzb3IsIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
Y3Vyc29yLT5sZGV2Ow0KKw0KKwkvKiA0MC1iaXQgd2lkdGggcGh5c2ljYWwgYWRkcmVzcyBidXMg
Ki8NCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IxX0FERFJfSElfUkVHLCAoYWRkciA+
PiAzMikgJiAweEZGKTsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IxX0FERFJfTE9f
UkVHLCBhZGRyKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IxX3VwZGF0ZV9wb3Np
dGlvbihzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwgaW50IHgsIGludCB5KQ0KK3sNCisJc3Ry
dWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwlpZiAoeCA8IDApDQor
CQl4ID0gMDsNCisNCisJaWYgKHkgPCAwKQ0KKwkJeSA9IDA7DQorDQorCWxzZGNfd3JlZzMyKGxk
ZXYsIExTRENfQ1VSU09SMV9QT1NJVElPTl9SRUcsICh5IDw8IDE2KSB8IHgpOw0KK30NCisNCitz
dGF0aWMgdm9pZCBsc2RjX2N1cnNvcjFfdXBkYXRlX2NmZyhzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1
cnNvciwNCisJCQkJICAgIGVudW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6ZSwNCisJCQkJ
ICAgIGVudW0gbHNkY19jdXJzb3JfZm9ybWF0IGZtdCkNCit7DQorCXN0cnVjdCBsc2RjX2Rldmlj
ZSAqbGRldiA9IGN1cnNvci0+bGRldjsNCisJdTMyIGNmZzsNCisNCisJY2ZnID0gQ1VSU09SX09O
X0NSVEMxIDw8IENVUlNPUl9MT0NBVElPTl9TSElGVCB8DQorCSAgICAgIGN1cnNvcl9zaXplIDw8
IENVUlNPUl9TSVpFX1NISUZUIHwNCisJICAgICAgZm10IDw8IENVUlNPUl9GT1JNQVRfU0hJRlQ7
DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1VSU09SMV9DRkdfUkVHLCBjZmcpOw0KK30N
CisNCisvKiBUaGUgaGFyZHdhcmUgY3Vyc29ycyBiZWNvbWUgbm9ybWFsIHNpbmNlIGxzN2EyMDAw
L2xzMmsyMDAwLCAgKi8NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfY3Vyc29yX3BsYW5l
X29wcyBsczdhMjAwMF9jdXJzb3JfaHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBkYXRlX2JvX2Fk
ZHIgPSBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIsDQorCQkudXBkYXRlX2NmZyA9IGxzZGNf
Y3Vyc29yMF91cGRhdGVfY2ZnLA0KKwkJLnVwZGF0ZV9wb3NpdGlvbiA9IGxzZGNfY3Vyc29yMF91
cGRhdGVfcG9zaXRpb24sDQorCX0sDQorCXsNCisJCS51cGRhdGVfYm9fYWRkciA9IGxzZGNfY3Vy
c29yMV91cGRhdGVfYm9fYWRkciwNCisJCS51cGRhdGVfY2ZnID0gbHNkY19jdXJzb3IxX3VwZGF0
ZV9jZmcsDQorCQkudXBkYXRlX3Bvc2l0aW9uID0gbHNkY19jdXJzb3IxX3VwZGF0ZV9wb3NpdGlv
biwNCisJfSwNCit9Ow0KKw0KKy8qIHF1aXJrcyBmb3IgY3Vyc29yIDEsIG9ubHkgZm9yIG9sZCBs
b29uZ3NvbiBkaXNwbGF5IGNvbnRyb2xsZXIgKi8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2N1cnNv
cjFfdXBkYXRlX2JvX2FkZHJfcXVpcmsoc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3IsIHU2NCBh
ZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0K
KwkvKiA0MC1iaXQgd2lkdGggcGh5c2ljYWwgYWRkcmVzcyBidXMgKi8NCisJbHNkY193cmVnMzIo
bGRldiwgTFNEQ19DVVJTT1IwX0FERFJfSElfUkVHLCAoYWRkciA+PiAzMikgJiAweEZGKTsNCisJ
bHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJfTE9fUkVHLCBhZGRyKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IxX3VwZGF0ZV9wb3NpdGlvbl9xdWlyayhzdHJ1Y3Qg
bHNkY19jdXJzb3IgKmN1cnNvciwgaW50IHgsIGludCB5KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2
aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwlpZiAoeCA8IDApDQorCQl4ID0gMDsNCisN
CisJaWYgKHkgPCAwKQ0KKwkJeSA9IDA7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1VS
U09SMF9QT1NJVElPTl9SRUcsICh5IDw8IDE2KSB8IHgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBs
c2RjX2N1cnNvcjFfdXBkYXRlX2NmZ19xdWlyayhzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwN
CisJCQkJCSAgZW51bSBsc2RjX2N1cnNvcl9zaXplIGN1cnNvcl9zaXplLA0KKwkJCQkJICBlbnVt
IGxzZGNfY3Vyc29yX2Zvcm1hdCBmbXQpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSBjdXJzb3ItPmxkZXY7DQorCXUzMiBjZmc7DQorDQorCWNmZyA9IENVUlNPUl9PTl9DUlRDMSA8
PCBDVVJTT1JfTE9DQVRJT05fU0hJRlQgfA0KKwkgICAgICBjdXJzb3Jfc2l6ZSA8PCBDVVJTT1Jf
U0laRV9TSElGVCB8DQorCSAgICAgIGZtdCA8PCBDVVJTT1JfRk9STUFUX1NISUZUOw0KKw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0NVUlNPUjBfQ0ZHX1JFRywgY2ZnKTsNCit9DQorDQorLyoN
CisgKiBUaGUgdW5mb3JnaXZpbmcgTFM3QTEwMDAvTFMySzEwMDAgaGFzIG9ubHkgb25lIGhhcmR3
YXJlIGN1cnNvcnMgcGxhbmUNCisgKi8NCitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfY3Vyc29y
X3BsYW5lX29wcyBsczdhMTAwMF9jdXJzb3JfaHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBkYXRl
X2JvX2FkZHIgPSBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIsDQorCQkudXBkYXRlX2NmZyA9
IGxzZGNfY3Vyc29yMF91cGRhdGVfY2ZnLA0KKwkJLnVwZGF0ZV9wb3NpdGlvbiA9IGxzZGNfY3Vy
c29yMF91cGRhdGVfcG9zaXRpb24sDQorCX0sDQorCXsNCisJCS51cGRhdGVfYm9fYWRkciA9IGxz
ZGNfY3Vyc29yMV91cGRhdGVfYm9fYWRkcl9xdWlyaywNCisJCS51cGRhdGVfY2ZnID0gbHNkY19j
dXJzb3IxX3VwZGF0ZV9jZmdfcXVpcmssDQorCQkudXBkYXRlX3Bvc2l0aW9uID0gbHNkY19jdXJz
b3IxX3VwZGF0ZV9wb3NpdGlvbl9xdWlyaywNCisJfSwNCit9Ow0KKw0KK2ludCBsc2RjX3ByaW1h
cnlfcGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgc3RydWN0IGRy
bV9wbGFuZSAqcGxhbmUsDQorCQkJICAgIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVj
dCBsc2RjX3ByaW1hcnkgKnByaW1hcnkgPSB0b19sc2RjX3ByaW1hcnkocGxhbmUpOw0KKwlpbnQg
cmV0Ow0KKw0KKwlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoZGRldiwNCisJCQkJICAg
ICAgIHBsYW5lLA0KKwkJCQkgICAgICAgMSA8PCBpbmRleCwNCisJCQkJICAgICAgICZsc2RjX3Bs
YW5lX2Z1bmNzLA0KKwkJCQkgICAgICAgbHNkY19wcmltYXJ5X2Zvcm1hdHMsDQorCQkJCSAgICAg
ICBBUlJBWV9TSVpFKGxzZGNfcHJpbWFyeV9mb3JtYXRzKSwNCisJCQkJICAgICAgIGxzZGNfZmJf
Zm9ybWF0X21vZGlmaWVycywNCisJCQkJICAgICAgIERSTV9QTEFORV9UWVBFX1BSSU1BUlksDQor
CQkJCSAgICAgICAicHJpbWFyeS0ldSIsDQorCQkJCSAgICAgICBpbmRleCk7DQorCWlmIChyZXQp
DQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1fcGxhbmVfaGVscGVyX2FkZChwbGFuZSwgJmxzZGNf
cHJpbWFyeV9oZWxwZXJfZnVuY3MpOw0KKw0KKwlwcmltYXJ5LT5sZGV2ID0gdG9fbHNkYyhkZGV2
KTsNCisJcHJpbWFyeS0+b3BzID0gJmxzZGNfcHJpbWFyeV9wbGFuZV9od19vcHNbaW5kZXhdOw0K
Kw0KKwlyZXR1cm4gMDsNCit9DQorDQoraW50IGxzN2ExMDAwX2N1cnNvcl9wbGFuZV9pbml0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFu
ZSwNCisJCQkgICAgICAgdW5zaWduZWQgaW50IGluZGV4KQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vy
c29yICpjdXJzb3IgPSB0b19sc2RjX2N1cnNvcihwbGFuZSk7DQorCWludCByZXQ7DQorDQorCXJl
dCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdChkZGV2LA0KKwkJCQkgICAgICAgcGxhbmUsDQor
CQkJCSAgICAgICAxIDw8IGluZGV4LA0KKwkJCQkgICAgICAgJmxzZGNfcGxhbmVfZnVuY3MsDQor
CQkJCSAgICAgICBsc2RjX2N1cnNvcl9mb3JtYXRzLA0KKwkJCQkgICAgICAgQVJSQVlfU0laRShs
c2RjX2N1cnNvcl9mb3JtYXRzKSwNCisJCQkJICAgICAgIGxzZGNfZmJfZm9ybWF0X21vZGlmaWVy
cywNCisJCQkJICAgICAgIERSTV9QTEFORV9UWVBFX0NVUlNPUiwNCisJCQkJICAgICAgICJjdXJz
b3ItJXUiLA0KKwkJCQkgICAgICAgaW5kZXgpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsN
CisNCisJY3Vyc29yLT5sZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJY3Vyc29yLT5vcHMgPSAmbHM3
YTEwMDBfY3Vyc29yX2h3X29wc1tpbmRleF07DQorDQorCWRybV9wbGFuZV9oZWxwZXJfYWRkKHBs
YW5lLCAmbHM3YTEwMDBfY3Vyc29yX3BsYW5lX2hlbHBlcl9mdW5jcyk7DQorDQorCXJldHVybiAw
Ow0KK30NCisNCitpbnQgbHM3YTIwMDBfY3Vyc29yX3BsYW5lX2luaXQoc3RydWN0IGRybV9kZXZp
Y2UgKmRkZXYsDQorCQkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0KKwkJCSAgICAg
ICB1bnNpZ25lZCBpbnQgaW5kZXgpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciA9
IHRvX2xzZGNfY3Vyc29yKHBsYW5lKTsNCisJaW50IHJldDsNCisNCisJcmV0ID0gZHJtX3VuaXZl
cnNhbF9wbGFuZV9pbml0KGRkZXYsDQorCQkJCSAgICAgICBwbGFuZSwNCisJCQkJICAgICAgIDEg
PDwgaW5kZXgsDQorCQkJCSAgICAgICAmbHNkY19wbGFuZV9mdW5jcywNCisJCQkJICAgICAgIGxz
ZGNfY3Vyc29yX2Zvcm1hdHMsDQorCQkJCSAgICAgICBBUlJBWV9TSVpFKGxzZGNfY3Vyc29yX2Zv
cm1hdHMpLA0KKwkJCQkgICAgICAgbHNkY19mYl9mb3JtYXRfbW9kaWZpZXJzLA0KKwkJCQkgICAg
ICAgRFJNX1BMQU5FX1RZUEVfQ1VSU09SLA0KKwkJCQkgICAgICAgImN1cnNvci0ldSIsDQorCQkJ
CSAgICAgICBpbmRleCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwljdXJzb3It
PmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwljdXJzb3ItPm9wcyA9ICZsczdhMjAwMF9jdXJzb3Jf
aHdfb3BzW2luZGV4XTsNCisNCisJZHJtX3BsYW5lX2hlbHBlcl9hZGQocGxhbmUsICZsczdhMjAw
MF9jdXJzb3JfcGxhbmVfaGVscGVyX2Z1bmNzKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KZGlmZiAt
LWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMgYi9kcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19wcm9iZS5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXgg
MDAwMDAwMDAwMDAwLi40OGJhNjliYjhhOTgNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMNCkBAIC0wLDAgKzEsNTYgQEANCisvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsNCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAy
MyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaW5j
bHVkZSAibHNkY19kcnYuaCINCisjaW5jbHVkZSAibHNkY19wcm9iZS5oIg0KKw0KKy8qDQorICog
UHJvY2Vzc29yIElEIChpbXBsZW1lbnRhdGlvbikgdmFsdWVzIGZvciBiaXRzIDE1Ojggb2YgdGhl
IFBSSUQgcmVnaXN0ZXIuDQorICovDQorI2RlZmluZSBMT09OR1NPTl9DUFVfSU1QX01BU0sgICAg
ICAgICAgIDB4ZmYwMA0KKyNkZWZpbmUgTE9PTkdTT05fQ1BVX0lNUF9TSElGVCAgICAgICAgICA4
DQorDQorI2RlZmluZSBMT09OR0FSQ0hfQ1BVX0lNUF9MUzJLMTAwMCAgICAgIDB4YTANCisjZGVm
aW5lIExPT05HQVJDSF9DUFVfSU1QX0xTMksyMDAwICAgICAgMHhiMA0KKyNkZWZpbmUgTE9PTkdB
UkNIX0NQVV9JTVBfTFMzQTUwMDAgICAgICAweGMwDQorDQorI2RlZmluZSBMT09OR1NPTl9DUFVf
TUlQU19JTVBfTFMySyAgICAgIDB4NjEgLyogTG9vbmdzb24gMksgTWlwcyBzZXJpZXMgU29DICov
DQorDQorLyoNCisgKiBQYXJ0aWN1bGFyIFJldmlzaW9uIHZhbHVlcyBmb3IgYml0cyA3OjAgb2Yg
dGhlIFBSSUQgcmVnaXN0ZXIuDQorICovDQorI2RlZmluZSBMT09OR1NPTl9DUFVfUkVWX01BU0sg
ICAgICAgICAgIDB4MDBmZg0KKw0KKyNkZWZpbmUgTE9PTkdBUkNIX0NQVUNGR19QUklEX1JFRyAg
ICAgICAweDANCisNCisvKg0KKyAqIFdlIGNhbiBhY2hpZXZlIGZpbmUtZ3JhaW5lZCBjb250cm9s
IHdpdGggdGhlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBob3N0Lg0KKyAqLw0KKw0KK3Vuc2lnbmVk
IGludCBsb29uZ3Nvbl9jcHVfZ2V0X3ByaWQodTggKmltcCwgdTggKnJldikNCit7DQorCXVuc2ln
bmVkIGludCBwcmlkID0gMDsNCisNCisjaWYgZGVmaW5lZChfX2xvb25nYXJjaF9fKQ0KKwlfX2Fz
bV9fIHZvbGF0aWxlKCJjcHVjZmcgJTAsICUxXG5cdCINCisJCQk6ICI9JnIiKHByaWQpDQorCQkJ
OiAiciIoTE9PTkdBUkNIX0NQVUNGR19QUklEX1JFRykNCisJCQkpOw0KKyNlbmRpZg0KKw0KKyNp
ZiBkZWZpbmVkKF9fbWlwc19fKQ0KKwlfX2FzbV9fIHZvbGF0aWxlKCJtZmMwXHQlMCwgJDE1XG5c
dCINCisJCQk6ICI9ciIgKHByaWQpDQorCQkJKTsNCisjZW5kaWYNCisNCisJaWYgKGltcCkNCisJ
CSppbXAgPSAocHJpZCAmIExPT05HU09OX0NQVV9JTVBfTUFTSykgPj4gTE9PTkdTT05fQ1BVX0lN
UF9TSElGVDsNCisNCisJaWYgKHJldikNCisJCSpyZXYgPSBwcmlkICYgTE9PTkdTT05fQ1BVX1JF
Vl9NQVNLOw0KKw0KKwlyZXR1cm4gcHJpZDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X3Byb2JlLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjdhOTZi
ZWM0OWFiOQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfcHJvYmUuaA0KQEAgLTAsMCArMSwxMiBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5v
bG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfUFJPQkVf
SF9fDQorI2RlZmluZSBfX0xTRENfUFJPQkVfSF9fDQorDQorLyogSGVscGVycyBmb3IgY2hpcCBk
ZXRlY3Rpb24gKi8NCit1bnNpZ25lZCBpbnQgbG9vbmdzb25fY3B1X2dldF9wcmlkKHU4ICppbXBs
LCB1OCAqcmV2KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19yZWdzLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19yZWdzLmgN
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjMwZmYwNDUwZGRjZA0K
LS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcmVncy5o
DQpAQCAtMCwwICsxLDQwMiBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
ICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jw
b3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfUkVHU19IX18NCisjZGVm
aW5lIF9fTFNEQ19SRUdTX0hfXw0KKw0KKyNpbmNsdWRlIDxsaW51eC9iaXRvcHMuaD4NCisjaW5j
bHVkZSA8bGludXgvdHlwZXMuaD4NCisNCisvKg0KKyAqIFBJWEVMIFBMTCBSZWZlcmVuY2UgY2xv
Y2sNCisgKi8NCisjZGVmaW5lIExTRENfUExMX1JFRl9DTEsgICAgICAgICAgICAgICAgMTAwMDAw
ICAgICAgICAgICAvKiBrSHogKi8NCisNCisvKg0KKyAqIFRob3NlIFBMTCByZWdpc3RlcnMgYXJl
IHJlbGF0aXZlIHRvIExTeHh4eHhfQ0ZHX1JFR19CQVNFLiB4eHh4eCA9IDdBMTAwMCwNCisgKiA3
QTIwMDAsIDJLMjAwMCwgMksxMDAwIGV0Yy4NCisgKi8NCisNCisvKiBMUzdBMTAwMCAqLw0KKw0K
KyNkZWZpbmUgTFM3QTEwMDBfUElYUExMMF9SRUcgICAgICAgICAgICAweDA0QjANCisjZGVmaW5l
IExTN0ExMDAwX1BJWFBMTDFfUkVHICAgICAgICAgICAgMHgwNEMwDQorDQorLyogVGhlIERDLCBH
UFUsIEdyYXBoaWMgTWVtb3J5IENvbnRyb2xsZXIgc2hhcmUgdGhlIHNpbmdsZSBnZnhwbGwgKi8N
CisjZGVmaW5lIExTN0ExMDAwX1BMTF9HRlhfUkVHICAgICAgICAgICAgMHgwNDkwDQorDQorI2Rl
ZmluZSBMUzdBMTAwMF9DT05GX1JFR19CQVNFICAgICAgICAgIDB4MTAwMTAwMDANCisNCisvKiBM
UzdBMjAwMCAqLw0KKw0KKyNkZWZpbmUgTFM3QTIwMDBfUElYUExMMF9SRUcgICAgICAgICAgICAw
eDA0QjANCisjZGVmaW5lIExTN0EyMDAwX1BJWFBMTDFfUkVHICAgICAgICAgICAgMHgwNEMwDQor
DQorLyogVGhlIERDLCBHUFUsIEdyYXBoaWMgTWVtb3J5IENvbnRyb2xsZXIgc2hhcmUgdGhlIHNp
bmdsZSBnZnhwbGwgKi8NCisjZGVmaW5lIExTN0EyMDAwX1BMTF9HRlhfUkVHICAgICAgICAgICAg
MHgwNDkwDQorDQorI2RlZmluZSBMUzdBMjAwMF9DT05GX1JFR19CQVNFICAgICAgICAgIDB4MTAw
MTAwMDANCisNCisvKiBGb3IgTFNEQ19DUlRDeF9DRkdfUkVHICovDQorI2RlZmluZSBDRkdfUElY
X0ZNVF9NQVNLICAgICAgICAgICAgICAgIEdFTk1BU0soMiwgMCkNCisNCitlbnVtIGxzZGNfcGl4
ZWxfZm9ybWF0IHsNCisJTFNEQ19QRl9OT05FID0gMCwNCisJTFNEQ19QRl9YUkdCNDQ0ID0gMSwg
ICAgLyogWzEyIGJpdHNdICovDQorCUxTRENfUEZfWFJHQjU1NSA9IDIsICAgIC8qIFsxNSBiaXRz
XSAqLw0KKwlMU0RDX1BGX1hSR0I1NjUgPSAzLCAgICAvKiBSR0IgWzE2IGJpdHNdICovDQorCUxT
RENfUEZfWFJHQjg4ODggPSA0LCAgIC8qIFhSR0IgWzMyIGJpdHNdICovDQorfTsNCisNCisvKg0K
KyAqIEVhY2ggY3J0YyBoYXMgdHdvIHNldCBmYiBhZGRyZXNzIHJlZ2lzdGVycyB1c2FibGUsIEZC
X1JFR19JTl9VU0lORyBiaXQgb2YNCisgKiBMU0RDX0NSVEN4X0NGR19SRUcgaW5kaWNhdGUgd2hp
Y2ggZmIgYWRkcmVzcyByZWdpc3RlciBpcyBpbiB1c2luZyBieSB0aGUNCisgKiBDUlRDIGN1cnJl
bnRseS4gQ0ZHX1BBR0VfRkxJUCBpcyB1c2VkIHRvIHRyaWdnZXIgdGhlIHN3aXRjaCwgdGhlIHN3
aXRjaGluZw0KKyAqIHdpbGwgYmUgZmluaXNoZWQgYXQgdGhlIHZlcnkgbmV4dCB2YmxhbmsuIFRy
aWdnZXIgaXQgYWdhaW4gaWYgeW91IHdhbnQgdG8NCisgKiBzd2l0Y2ggYmFjay4NCisgKg0KKyAq
IElmIEZCMF9BRERSX1JFRyBpcyBpbiB1c2luZywgd2Ugd3JpdGUgdGhlIGFkZHJlc3MgdG8gRkIw
X0FERFJfUkVHLA0KKyAqIGlmIEZCMV9BRERSX1JFRyBpcyBpbiB1c2luZywgd2Ugd3JpdGUgdGhl
IGFkZHJlc3MgdG8gRkIxX0FERFJfUkVHLg0KKyAqLw0KKyNkZWZpbmUgQ0ZHX1BBR0VfRkxJUCAg
ICAgICAgICAgICAgICAgICBCSVQoNykNCisjZGVmaW5lIENGR19PVVRQVVRfRU5BQkxFICAgICAg
ICAgICAgICAgQklUKDgpDQorI2RlZmluZSBDRkdfSFdfQ0xPTkUgICAgICAgICAgICAgICAgICAg
IEJJVCg5KQ0KKy8qIEluZGljYXRlIHdpdGNoIGZiIGFkZHIgcmVnIGlzIGluIHVzaW5nLCBjdXJy
ZW50bHkuIHJlYWQgb25seSAqLw0KKyNkZWZpbmUgRkJfUkVHX0lOX1VTSU5HICAgICAgICAgICAg
ICAgICBCSVQoMTEpDQorI2RlZmluZSBDRkdfR0FNTUFfRU4gICAgICAgICAgICAgICAgICAgIEJJ
VCgxMikNCisNCisvKiBUaGUgREMgZ2V0IHNvZnQgcmVzZXQgaWYgdGhpcyBiaXQgY2hhbmdlZCBm
cm9tICIxIiB0byAiMCIsIGFjdGl2ZSBsb3cgKi8NCisjZGVmaW5lIENGR19SRVNFVF9OICAgICAg
ICAgICAgICAgICAgICAgQklUKDIwKQ0KKy8qIElmIHRoaXMgYml0IGlzIHNldCwgaXQgc2F5IHRo
YXQgdGhlIENSVEMgc3RvcCB3b3JraW5nIGFueW1vcmUsIGFuY2hvcmVkLiAqLw0KKyNkZWZpbmUg
Q1JUQ19BTkNIT1JFRCAgICAgICAgICAgICAgICAgICBCSVQoMjQpDQorDQorLyoNCisgKiBUaGUg
RE1BIHN0ZXAgb2YgdGhlIERDIGluIExTN0EyMDAwL0xTMksyMDAwIGlzIGNvbmZpZ3VyYWJsZSwN
CisgKiBzZXR0aW5nIHRob3NlIGJpdHMgb24gbHM3YTEwMDAgcGxhdGZvcm0gbWFrZSBubyBlZmZl
Y3QuDQorICovDQorI2RlZmluZSBDRkdfRE1BX1NURVBfTUFTSyAgICAgICAgICAgICAgR0VOTUFT
SygxNywgMTYpDQorI2RlZmluZSBDRkdfRE1BX1NURVBfU0hJRlQgICAgICAgICAgICAgMTYNCitl
bnVtIGxzZGNfZG1hX3N0ZXBzIHsNCisJTFNEQ19ETUFfU1RFUF8yNTZfQllURVMgPSAwLA0KKwlM
U0RDX0RNQV9TVEVQXzEyOF9CWVRFUyA9IDEsDQorCUxTRENfRE1BX1NURVBfNjRfQllURVMgPSAy
LA0KKwlMU0RDX0RNQV9TVEVQXzMyX0JZVEVTID0gMywNCit9Ow0KKw0KKyNkZWZpbmUgQ0ZHX1ZB
TElEX0JJVFNfTUFTSyAgICAgICAgICAgICBHRU5NQVNLKDIwLCAwKQ0KKw0KKy8qIEZvciBMU0RD
X0NSVEN4X1BBTkVMX0NPTkZfUkVHICovDQorI2RlZmluZSBQSFlfQ0xPQ0tfUE9MICAgICAgICAg
ICAgICAgICAgIEJJVCg5KQ0KKyNkZWZpbmUgUEhZX0NMT0NLX0VOICAgICAgICAgICAgICAgICAg
ICBCSVQoOCkNCisjZGVmaW5lIFBIWV9ERV9QT0wgICAgICAgICAgICAgICAgICAgICAgQklUKDEp
DQorI2RlZmluZSBQSFlfREFUQV9FTiAgICAgICAgICAgICAgICAgICAgIEJJVCgwKQ0KKw0KKy8q
IEZvciBMU0RDX0NSVEN4X0hTWU5DX1JFRyAqLw0KKyNkZWZpbmUgSFNZTkNfSU5WICAgICAgICAg
ICAgICAgICAgICAgICBCSVQoMzEpDQorI2RlZmluZSBIU1lOQ19FTiAgICAgICAgICAgICAgICAg
ICAgICAgIEJJVCgzMCkNCisjZGVmaW5lIEhTWU5DX0VORF9NQVNLICAgICAgICAgICAgICAgICAg
R0VOTUFTSygyOCwgMTYpDQorI2RlZmluZSBIU1lOQ19FTkRfU0hJRlQgICAgICAgICAgICAgICAg
IDE2DQorI2RlZmluZSBIU1lOQ19TVEFSVF9NQVNLICAgICAgICAgICAgICAgIEdFTk1BU0soMTIs
IDApDQorI2RlZmluZSBIU1lOQ19TVEFSVF9TSElGVCAgICAgICAgICAgICAgIDANCisNCisvKiBG
b3IgTFNEQ19DUlRDeF9WU1lOQ19SRUcgKi8NCisjZGVmaW5lIFZTWU5DX0lOViAgICAgICAgICAg
ICAgICAgICAgICAgQklUKDMxKQ0KKyNkZWZpbmUgVlNZTkNfRU4gICAgICAgICAgICAgICAgICAg
ICAgICBCSVQoMzApDQorI2RlZmluZSBWU1lOQ19FTkRfTUFTSyAgICAgICAgICAgICAgICAgIEdF
Tk1BU0soMjcsIDE2KQ0KKyNkZWZpbmUgVlNZTkNfRU5EX1NISUZUICAgICAgICAgICAgICAgICAx
Ng0KKyNkZWZpbmUgVlNZTkNfU1RBUlRfTUFTSyAgICAgICAgICAgICAgICBHRU5NQVNLKDExLCAw
KQ0KKyNkZWZpbmUgVlNZTkNfU1RBUlRfU0hJRlQgICAgICAgICAgICAgICAwDQorDQorLyoqKioq
KioqKioqIENSVEMwICYgRElTUExBWSBQSVBFMCAqKioqKioqKioqKi8NCisjZGVmaW5lIExTRENf
Q1JUQzBfQ0ZHX1JFRyAgICAgICAgICAgICAgMHgxMjQwDQorI2RlZmluZSBMU0RDX0NSVEMwX0ZC
MF9BRERSX0xPX1JFRyAgICAgIDB4MTI2MA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9GQjBfQUREUl9I
SV9SRUcgICAgICAweDE1QTANCisjZGVmaW5lIExTRENfQ1JUQzBfU1RSSURFX1JFRyAgICAgICAg
ICAgMHgxMjgwDQorI2RlZmluZSBMU0RDX0NSVEMwX0ZCX09SSUdJTl9SRUcgICAgICAgIDB4MTMw
MA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9QQU5FTF9DT05GX1JFRyAgICAgICAweDEzQzANCisjZGVm
aW5lIExTRENfQ1JUQzBfSERJU1BMQVlfUkVHICAgICAgICAgMHgxNDAwDQorI2RlZmluZSBMU0RD
X0NSVEMwX0hTWU5DX1JFRyAgICAgICAgICAgIDB4MTQyMA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9W
RElTUExBWV9SRUcgICAgICAgICAweDE0ODANCisjZGVmaW5lIExTRENfQ1JUQzBfVlNZTkNfUkVH
ICAgICAgICAgICAgMHgxNEEwDQorI2RlZmluZSBMU0RDX0NSVEMwX0dBTU1BX0lOREVYX1JFRyAg
ICAgIDB4MTRFMA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9HQU1NQV9EQVRBX1JFRyAgICAgICAweDE1
MDANCisjZGVmaW5lIExTRENfQ1JUQzBfRkIxX0FERFJfTE9fUkVHICAgICAgMHgxNTgwDQorI2Rl
ZmluZSBMU0RDX0NSVEMwX0ZCMV9BRERSX0hJX1JFRyAgICAgIDB4MTVDMA0KKw0KKy8qKioqKioq
KioqKiBDVFJDMSAmIERJU1BMQVkgUElQRTEgKioqKioqKioqKiovDQorI2RlZmluZSBMU0RDX0NS
VEMxX0NGR19SRUcgICAgICAgICAgICAgIDB4MTI1MA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9GQjBf
QUREUl9MT19SRUcgICAgICAweDEyNzANCisjZGVmaW5lIExTRENfQ1JUQzFfRkIwX0FERFJfSElf
UkVHICAgICAgMHgxNUIwDQorI2RlZmluZSBMU0RDX0NSVEMxX1NUUklERV9SRUcgICAgICAgICAg
IDB4MTI5MA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9GQl9PUklHSU5fUkVHICAgICAgICAweDEzMTAN
CisjZGVmaW5lIExTRENfQ1JUQzFfUEFORUxfQ09ORl9SRUcgICAgICAgMHgxM0QwDQorI2RlZmlu
ZSBMU0RDX0NSVEMxX0hESVNQTEFZX1JFRyAgICAgICAgIDB4MTQxMA0KKyNkZWZpbmUgTFNEQ19D
UlRDMV9IU1lOQ19SRUcgICAgICAgICAgICAweDE0MzANCisjZGVmaW5lIExTRENfQ1JUQzFfVkRJ
U1BMQVlfUkVHICAgICAgICAgMHgxNDkwDQorI2RlZmluZSBMU0RDX0NSVEMxX1ZTWU5DX1JFRyAg
ICAgICAgICAgIDB4MTRCMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9HQU1NQV9JTkRFWF9SRUcgICAg
ICAweDE0RjANCisjZGVmaW5lIExTRENfQ1JUQzFfR0FNTUFfREFUQV9SRUcgICAgICAgMHgxNTEw
DQorI2RlZmluZSBMU0RDX0NSVEMxX0ZCMV9BRERSX0xPX1JFRyAgICAgIDB4MTU5MA0KKyNkZWZp
bmUgTFNEQ19DUlRDMV9GQjFfQUREUl9ISV9SRUcgICAgICAweDE1RDANCisNCisvKg0KKyAqIEFs
bCBvZiB0aGUgREMgdmFyaWFudHMgaGFzIHRoZSBoYXJkd2FyZSB3aGljaCByZWNvcmQgdGhlIHNj
YW4gcG9zaXRpb24NCisgKiBvZiB0aGUgQ1JUQywgWzMxOjE2XSA6IGN1cnJlbnQgWCBwb3NpdGlv
biwgWzE1OjBdIDogY3VycmVudCBZIHBvc2l0aW9uDQorICovDQorI2RlZmluZSBMU0RDX0NSVEMw
X1NDQU5fUE9TX1JFRyAgICAgICAgIDB4MTRDMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9TQ0FOX1BP
U19SRUcgICAgICAgICAweDE0RDANCisNCisvKg0KKyAqIExTN0EyMDAwIGhhcyBTeW5jIERldmlh
dGlvbiByZWdpc3Rlci4NCisgKi8NCisjZGVmaW5lIFNZTkNfREVWSUFUSU9OX0VOICAgICAgICAg
ICAgICAgQklUKDMxKQ0KKyNkZWZpbmUgU1lOQ19ERVZJQVRJT05fTlVNICAgICAgICAgICAgICBH
RU5NQVNLKDEyLCAwKQ0KKyNkZWZpbmUgTFNEQ19DUlRDMF9TWU5DX0RFVklBVElPTl9SRUcgICAw
eDFCODANCisjZGVmaW5lIExTRENfQ1JUQzFfU1lOQ19ERVZJQVRJT05fUkVHICAgMHgxQjkwDQor
DQorLyoNCisgKiBJbiBncm9zcywgTFNEQ19DUlRDMV9YWFhfUkVHIC0gTFNEQ19DUlRDMF9YWFhf
UkVHID0gMHgxMCwgYnV0IG5vdCBhbGwgb2YNCisgKiB0aGUgcmVnaXN0ZXJzIG9iZXkgdGhpcyBy
dWxlLCBMU0RDX0NVUlNPUnhfWFhYX1JFRyBqdXN0IGRvbid0IGhvbm9yIHRoaXMuDQorICogVGhp
cyBpcyB0aGUgcm9vdCBjYXVzZSB3ZSBjYW4ndCB1bnRhbmdsZSB0aGUgY29kZSBieSBtYW5wdWxh
dGluZyBvZmZzZXQNCisgKiBvZiB0aGUgcmVnaXN0ZXIgYWNjZXNzIHNpbXBseS4gT3VyIGhhcmR3
YXJlIGVuZ2luZWVycyBhcmUgbGFjayBleHBlcmlhbmNlDQorICogd2hlbiB0aGV5IGRlc2lnbiB0
aGlzLi4uDQorICovDQorI2RlZmluZSBDUlRDX1BJUEVfT0ZGU0VUICAgICAgICAgICAgICAgIDB4
MTANCisNCisvKg0KKyAqIFRoZXJlIGlzIG9ubHkgb25lIGhhcmR3YXJlIGN1cnNvciB1bml0IGlu
IExTN0ExMDAwIGFuZCBMUzJLMTAwMCwgbGV0DQorICogQ0ZHX0hXX0NMT05FX0VOIGJpdCBiZSAi
MSIgY291bGQgZWxpbWluYXRlIHRoaXMgZW1iYXJyYXNzbWVudCwgd2UgbWFkZQ0KKyAqIGl0IG9u
IGN1c3RvbSBjbG9uZSBtb2RlIGFwcGxpY2F0aW9uLiBXaGlsZSBMUzdBMjAwMCBoYXMgdHdvIGhh
cmR3YXJlDQorICogY3Vyc29yIHVuaXQgd2hpY2ggaXMgZ29vZCBlbm91Z2guDQorICovDQorI2Rl
ZmluZSBDVVJTT1JfRk9STUFUX01BU0sgICAgICAgICAgICAgIEdFTk1BU0soMSwgMCkNCisjZGVm
aW5lIENVUlNPUl9GT1JNQVRfU0hJRlQgICAgICAgICAgICAgMA0KK2VudW0gbHNkY19jdXJzb3Jf
Zm9ybWF0IHsNCisJQ1VSU09SX0ZPUk1BVF9ESVNBQkxFID0gMCwNCisJQ1VSU09SX0ZPUk1BVF9N
T05PQ0hST01FID0gMSwgICAvKiBtYXNrZWQgKi8NCisJQ1VSU09SX0ZPUk1BVF9BUkdCODg4OCA9
IDIsICAgICAvKiBBOFI4RzhCOCAqLw0KK307DQorDQorLyoNCisgKiBMUzdBMTAwMCBhbmQgTFMy
SzEwMDAgb25seSBzdXBwb3J0IDMyeDMyLCBMUzJLMjAwMCBhbmQgTFM3QTIwMDAgc3VwcG9ydA0K
KyAqIDY0eDY0LCBidXQgaXQgc2VlbXMgdGhhdCBzZXR0aW5nIHRoaXMgYml0IG1ha2Ugbm8gaGFy
bXMgb24gTFM3QTEwMDAsIGl0DQorICoganVzdCBkb24ndCB0YWtlIGVmZmVjdHMuDQorICovDQor
I2RlZmluZSBDVVJTT1JfU0laRV9TSElGVCAgICAgICAgICAgICAgIDINCitlbnVtIGxzZGNfY3Vy
c29yX3NpemUgew0KKwlDVVJTT1JfU0laRV8zMlgzMiA9IDAsDQorCUNVUlNPUl9TSVpFXzY0WDY0
ID0gMSwNCit9Ow0KKw0KKyNkZWZpbmUgQ1VSU09SX0xPQ0FUSU9OX1NISUZUICAgICAgICAgICA0
DQorZW51bSBsc2RjX2N1cnNvcl9sb2NhdGlvbiB7DQorCUNVUlNPUl9PTl9DUlRDMCA9IDAsDQor
CUNVUlNPUl9PTl9DUlRDMSA9IDEsDQorfTsNCisNCisjZGVmaW5lIExTRENfQ1VSU09SMF9DRkdf
UkVHICAgICAgICAgICAgMHgxNTIwDQorI2RlZmluZSBMU0RDX0NVUlNPUjBfQUREUl9MT19SRUcg
ICAgICAgIDB4MTUzMA0KKyNkZWZpbmUgTFNEQ19DVVJTT1IwX0FERFJfSElfUkVHICAgICAgICAw
eDE1ZTANCisjZGVmaW5lIExTRENfQ1VSU09SMF9QT1NJVElPTl9SRUcgICAgICAgMHgxNTQwICAv
KiBbMzE6MTZdIFksIFsxNTowXSBYICovDQorI2RlZmluZSBMU0RDX0NVUlNPUjBfQkdfQ09MT1Jf
UkVHICAgICAgIDB4MTU1MCAgLyogYmFja2dyb3VuZCBjb2xvciAqLw0KKyNkZWZpbmUgTFNEQ19D
VVJTT1IwX0ZHX0NPTE9SX1JFRyAgICAgICAweDE1NjAgIC8qIGZvcmVncm91bmQgY29sb3IgKi8N
CisNCisjZGVmaW5lIExTRENfQ1VSU09SMV9DRkdfUkVHICAgICAgICAgICAgMHgxNjcwDQorI2Rl
ZmluZSBMU0RDX0NVUlNPUjFfQUREUl9MT19SRUcgICAgICAgIDB4MTY4MA0KKyNkZWZpbmUgTFNE
Q19DVVJTT1IxX0FERFJfSElfUkVHICAgICAgICAweDE2ZTANCisjZGVmaW5lIExTRENfQ1VSU09S
MV9QT1NJVElPTl9SRUcgICAgICAgMHgxNjkwICAvKiBbMzE6MTZdIFksIFsxNTowXSBYICovDQor
I2RlZmluZSBMU0RDX0NVUlNPUjFfQkdfQ09MT1JfUkVHICAgICAgIDB4MTZBMCAgLyogYmFja2dy
b3VuZCBjb2xvciAqLw0KKyNkZWZpbmUgTFNEQ19DVVJTT1IxX0ZHX0NPTE9SX1JFRyAgICAgICAw
eDE2QjAgIC8qIGZvcmVncm91bmQgY29sb3IgKi8NCisNCisvKg0KKyAqIERDIEludGVycnVwdCBD
b250cm9sIFJlZ2lzdGVyLCAzMmJpdCwgQWRkcmVzcyBPZmZzZXQ6IDE1NzANCisgKg0KKyAqIEJp
dHMgMTU6MCBpbmlkaWNhdGUgdGhlIGludGVycnVwdCBzdGF0dXMNCisgKiBCaXRzIDMxOjE2IGNv
bnRyb2wgZW5hYmxlIGludGVycnVwdHMgY29ycmVzcG9uZGluZyB0byBiaXQgMTU6MCBvciBub3QN
CisgKiBXcml0ZSAxIHRvIGVuYWJsZSwgd3JpdGUgMCB0byBkaXNhYmxlDQorICoNCisgKiBSRjog
UmVhZCBGaW5pc2hlZA0KKyAqIElEQlU6IEludGVybmFsIERhdGEgQnVmZmVyIFVuZGVyZmxvdw0K
KyAqIElEQkZVOiBJbnRlcm5hbCBEYXRhIEJ1ZmZlciBGYXRhbCBVbmRlcmZsb3cNCisgKiBDQlJG
OiBDdXJzb3IgQnVmZmVyIFJlYWQgRmluaXNoZWQgRmxhZywgbm8gdXNlLg0KKyAqIEZCUkYwOiBD
UlRDLTAgcmVhZGluZyBmcm9tIGl0cyBmcmFtZWJ1ZmZlciBmaW5pc2hlZC4NCisgKiBGQlJGMTog
Q1JUQy0xIHJlYWRpbmcgZnJvbSBpdHMgZnJhbWVidWZmZXIgZmluaXNoZWQuDQorICoNCisgKiAr
LS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tKy0tLS0tLS0tKy0tLS0t
LS0tKy0tLS0tLS0rDQorICogfCAzMToyNyB8ICAgICAgICAgMjY6MTYgICAgICAgICAgICB8IDE1
OjExIHwgICAxMCAgIHwgICA5ICAgIHwgICA4ICAgfA0KKyAqICstLS0tLS0tKy0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLSsNCisgKiB8
ICBOL0EgIHwgSW50ZXJydXB0IEVuYWJsZSBDb250cm9sIHwgIE4vQSAgfCBJREJGVTAgfCBJREJG
VTEgfCBJREJVMCB8DQorICogKy0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0t
LS0tLSstLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tKw0KKyAqDQorICogKy0tLS0tLS0rLS0tLS0t
LSstLS0tLS0tKy0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSsNCisg
KiB8ICAgNyAgIHwgICA2ICAgfCAgIDUgICB8ICA0ICAgfCAgIDMgICAgfCAgIDIgICAgfCAgIDEg
ICAgfCAgIDAgICAgfA0KKyAqICstLS0tLS0tKy0tLS0tLS0rLS0tLS0tLSstLS0tLS0rLS0tLS0t
LS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rDQorICogfCBJREJVMSB8IEZCUkYwIHwgRkJS
RjEgfCBDUlJGIHwgSFNZTkMwIHwgVlNZTkMwIHwgSFNZTkMxIHwgVlNZTkMxIHwNCisgKiArLS0t
LS0tLSstLS0tLS0tKy0tLS0tLS0rLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0tKy0t
LS0tLS0tKw0KKyAqDQorICogdW5mb3J0dW5hdGVseSwgQ1JUQzAncyBpbnRlcnJ1cHQgaXMgbWVz
cyB3aXRoIENSVEMxJ3MgaW50ZXJydXB0IGluIG9uZQ0KKyAqIHJlZ2lzdGVyIGFnYWluLg0KKyAq
Lw0KKw0KKyNkZWZpbmUgTFNEQ19JTlRfUkVHICAgICAgICAgICAgICAgICAgICAweDE1NzANCisN
CisjZGVmaW5lIElOVF9DUlRDMF9WU1lOQyAgICAgICAgICAgICAgICAgQklUKDIpDQorI2RlZmlu
ZSBJTlRfQ1JUQzBfSFNZTkMgICAgICAgICAgICAgICAgIEJJVCgzKQ0KKyNkZWZpbmUgSU5UX0NS
VEMwX1JGICAgICAgICAgICAgICAgICAgICBCSVQoNikNCisjZGVmaW5lIElOVF9DUlRDMF9JREJV
ICAgICAgICAgICAgICAgICAgQklUKDgpDQorI2RlZmluZSBJTlRfQ1JUQzBfSURCRlUgICAgICAg
ICAgICAgICAgIEJJVCgxMCkNCisNCisjZGVmaW5lIElOVF9DUlRDMV9WU1lOQyAgICAgICAgICAg
ICAgICAgQklUKDApDQorI2RlZmluZSBJTlRfQ1JUQzFfSFNZTkMgICAgICAgICAgICAgICAgIEJJ
VCgxKQ0KKyNkZWZpbmUgSU5UX0NSVEMxX1JGICAgICAgICAgICAgICAgICAgICBCSVQoNSkNCisj
ZGVmaW5lIElOVF9DUlRDMV9JREJVICAgICAgICAgICAgICAgICAgQklUKDcpDQorI2RlZmluZSBJ
TlRfQ1JUQzFfSURCRlUgICAgICAgICAgICAgICAgIEJJVCg5KQ0KKw0KKyNkZWZpbmUgSU5UX0NS
VEMwX1ZTWU5DX0VOICAgICAgICAgICAgICBCSVQoMTgpDQorI2RlZmluZSBJTlRfQ1JUQzBfSFNZ
TkNfRU4gICAgICAgICAgICAgIEJJVCgxOSkNCisjZGVmaW5lIElOVF9DUlRDMF9SRl9FTiAgICAg
ICAgICAgICAgICAgQklUKDIyKQ0KKyNkZWZpbmUgSU5UX0NSVEMwX0lEQlVfRU4gICAgICAgICAg
ICAgICBCSVQoMjQpDQorI2RlZmluZSBJTlRfQ1JUQzBfSURCRlVfRU4gICAgICAgICAgICAgIEJJ
VCgyNikNCisNCisjZGVmaW5lIElOVF9DUlRDMV9WU1lOQ19FTiAgICAgICAgICAgICAgQklUKDE2
KQ0KKyNkZWZpbmUgSU5UX0NSVEMxX0hTWU5DX0VOICAgICAgICAgICAgICBCSVQoMTcpDQorI2Rl
ZmluZSBJTlRfQ1JUQzFfUkZfRU4gICAgICAgICAgICAgICAgIEJJVCgyMSkNCisjZGVmaW5lIElO
VF9DUlRDMV9JREJVX0VOICAgICAgICAgICAgICAgQklUKDIzKQ0KKyNkZWZpbmUgSU5UX0NSVEMx
X0lEQkZVX0VOICAgICAgICAgICAgICBCSVQoMjUpDQorDQorI2RlZmluZSBJTlRfU1RBVFVTX01B
U0sgICAgICAgICAgICAgICAgIEdFTk1BU0soMTUsIDApDQorDQorLyoNCisgKiBMUzdBMTAwMC9M
UzdBMjAwMCBoYXZlIDQgZ3Bpb3Mgd2hpY2ggYXJlIHVzZWQgdG8gZW11bGF0ZWQgSTJDLg0KKyAq
IFRoZXkgYXJlIHVuZGVyIGNvbnRyb2wgb2YgdGhlIExTN0FfRENfR1BJT19EQVRfUkVHIGFuZCBM
UzdBX0RDX0dQSU9fRElSX1JFRw0KKyAqIHJlZ2lzdGVyLCBUaG9zZSBHUElPcyBoYXMgbm8gcmVs
YXRpb25zaGlwIHdodGggdGhlIEdQSU8gaGFyZHdhcmUgb24gdGhlDQorICogYnJpZGdlIGNoaXAg
aXRzZWxmLiBUaG9zZSBvZmZzZXRzIGFyZSByZWxhdGl2ZSB0byBEQyByZWdpc3RlciBiYXNlIGFk
ZHJlc3MNCisgKg0KKyAqIExTMmsxMDAwIGRvbid0IGhhdmUgdGhvc2UgcmVnaXN0ZXJzLCB0aGV5
IHVzZSBoYXJkd2FyZSBpMmMgb3IgZ2VuZXJhbCBHUElPDQorICogZW11bGF0ZWQgaTJjIGZyb20g
bGludXggaTJjIHN1YnN5c3RlbS4NCisgKg0KKyAqIEdQSU8gZGF0YSByZWdpc3RlciwgYWRkcmVz
cyBvZmZzZXQ6IDB4MTY1MA0KKyAqICAgKy0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLSstLS0t
LS0tLS0tLSsNCisgKiAgIHwgNyB8IDYgfCA1IHwgNCB8ICAzICB8ICAyICB8ICAxICB8ICAwICB8
DQorICogICArLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKw0KKyAqICAg
fCAgICAgICAgICAgICAgIHwgICAgRFZPMSAgIHwgICAgRFZPMCAgIHwNCisgKiAgICsgICAgICBO
L0EgICAgICArLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0rDQorICogICB8ICAgICAgICAgICAgICAg
fCBTQ0wgfCBTREEgfCBTQ0wgfCBTREEgfA0KKyAqICAgKy0tLS0tLS0tLS0tLS0tLSstLS0tLS0t
LS0tLSstLS0tLS0tLS0tLSsNCisgKi8NCisjZGVmaW5lIExTN0FfRENfR1BJT19EQVRfUkVHICAg
ICAgICAgICAgMHgxNjUwDQorDQorLyoNCisgKiAgR1BJTyBJbnB1dC9PdXRwdXQgZGlyZWN0aW9u
IGNvbnRyb2wgcmVnaXN0ZXIsIGFkZHJlc3Mgb2Zmc2V0OiAweDE2NjANCisgKi8NCisjZGVmaW5l
IExTN0FfRENfR1BJT19ESVJfUkVHICAgICAgICAgICAgMHgxNjYwDQorDQorLyoNCisgKiAgTFM3
QTIwMDAgaGFzIHR3byBidWlsdC1pbiBIRE1JIEVuY29kZXIgYW5kIG9uZSBWR0EgZW5jb2Rlcg0K
KyAqLw0KKw0KKy8qDQorICogTnVtYmVyIG9mIGNvbnRpbnVvdXMgcGFja2V0cyBtYXkgYmUgcHJl
c2VudA0KKyAqIGluIEhETUkgaGJsYW5rIGFuZCB2Ymxhbmsgem9uZSwgc2hvdWxkID49IDQ4DQor
ICovDQorI2RlZmluZSBMU0RDX0hETUkwX1pPTkVfUkVHICAgICAgICAgICAgIDB4MTcwMA0KKyNk
ZWZpbmUgTFNEQ19IRE1JMV9aT05FX1JFRyAgICAgICAgICAgICAweDE3MTANCisNCisjZGVmaW5l
IEhETUlfSF9aT05FX0lETEVfU0hJRlQgICAgICAgICAgMA0KKyNkZWZpbmUgSERNSV9WX1pPTkVf
SURMRV9TSElGVCAgICAgICAgICAxNg0KKw0KKy8qIEhETUkgSXRlcmZhY2UgQ29udHJvbCBSZWcg
Ki8NCisjZGVmaW5lIEhETUlfSU5URVJGQUNFX0VOICAgICAgICAgICAgICAgQklUKDApDQorI2Rl
ZmluZSBIRE1JX1BBQ0tFVF9FTiAgICAgICAgICAgICAgICAgIEJJVCgxKQ0KKyNkZWZpbmUgSERN
SV9BVURJT19FTiAgICAgICAgICAgICAgICAgICBCSVQoMikNCisvKg0KKyAqIFByZWFtYmxlOg0K
KyAqIEltbWVkaWF0ZWx5IHByZWNlZGluZyBlYWNoIHZpZGVvIGRhdGEgcGVyaW9kIG9yIGRhdGEg
aXNsYW5kIHBlcmlvZCBpcyB0aGUNCisgKiBwcmVhbWJsZS4gVGhpcyBpcyBhIHNlcXVlbmNlIG9m
IGVpZ2h0IGlkZW50aWNhbCBjb250cm9sIGNoYXJhY3RlcnMgdGhhdA0KKyAqIGluZGljYXRlIHdo
ZXRoZXIgdGhlIHVwY29taW5nIGRhdGEgcGVyaW9kIGlzIGEgdmlkZW8gZGF0YSBwZXJpb2Qgb3Ig
aXMgYQ0KKyAqIGRhdGEgaXNsYW5kLiBUaGUgdmFsdWVzIG9mIENUTDAsIENUTDEsIENUTDIsIGFu
ZCBDVEwzIGluZGljYXRlIHRoZSB0eXBlIG9mDQorICogZGF0YSBwZXJpb2QgdGhhdCBmb2xsb3dz
Lg0KKyAqLw0KKyNkZWZpbmUgSERNSV9WSURFT19QUkVBTUJMRV9NQVNLICAgICAgICBHRU5NQVNL
KDcsIDQpDQorI2RlZmluZSBIRE1JX1ZJREVPX1BSRUFNQkxFX1NISUZUICAgICAgIDQNCisvKiAx
OiBodyBpMmMsIDA6IGdwaW8gZW11IGkyYywgc2hvdWxkbid0IHB1dCBpbiBMU0RDX0hETUl4X0lO
VEZfQ1RSTF9SRUcgKi8NCisjZGVmaW5lIEhXX0kyQ19FTiAgICAgICAgICAgICAgICAgICAgICAg
QklUKDgpDQorI2RlZmluZSBIRE1JX0NUTF9QRVJJT0RfTU9ERSAgICAgICAgICAgIEJJVCg5KQ0K
KyNkZWZpbmUgTFNEQ19IRE1JMF9JTlRGX0NUUkxfUkVHICAgICAgICAweDE3MjANCisjZGVmaW5l
IExTRENfSERNSTFfSU5URl9DVFJMX1JFRyAgICAgICAgMHgxNzMwDQorDQorI2RlZmluZSBIRE1J
X1BIWV9FTiAgICAgICAgICAgICAgICAgICAgIEJJVCgwKQ0KKyNkZWZpbmUgSERNSV9QSFlfUkVT
RVRfTiAgICAgICAgICAgICAgICBCSVQoMSkNCisjZGVmaW5lIEhETUlfUEhZX1RFUk1fTF9FTiAg
ICAgICAgICAgICAgQklUKDgpDQorI2RlZmluZSBIRE1JX1BIWV9URVJNX0hfRU4gICAgICAgICAg
ICAgIEJJVCg5KQ0KKyNkZWZpbmUgSERNSV9QSFlfVEVSTV9ERVRfRU4gICAgICAgICAgICBCSVQo
MTApDQorI2RlZmluZSBIRE1JX1BIWV9URVJNX1NUQVRVUyAgICAgICAgICAgIEJJVCgxMSkNCisj
ZGVmaW5lIExTRENfSERNSTBfUEhZX0NUUkxfUkVHICAgICAgICAgMHgxODAwDQorI2RlZmluZSBM
U0RDX0hETUkxX1BIWV9DVFJMX1JFRyAgICAgICAgIDB4MTgxMA0KKw0KKy8qIEhpZ2ggbGV2ZWwg
ZHVyYXRpb24gbmVlZCA+IDF1cyAqLw0KKyNkZWZpbmUgSERNSV9QTExfRU5BQkxFICAgICAgICAg
ICAgICAgICBCSVQoMCkNCisjZGVmaW5lIEhETUlfUExMX0xPQ0tFRCAgICAgICAgICAgICAgICAg
QklUKDE2KQ0KKy8qIEJ5cGFzcyB0aGUgc29mdHdhcmUgY29uZmlndXJlZCB2YWx1ZXMsIHVzaW5n
IGRlZmF1bHQgc291cmNlIGZyb20gc29tZXdoZXJlICovDQorI2RlZmluZSBIRE1JX1BMTF9CWVBB
U1MgICAgICAgICAgICAgICAgIEJJVCgxNykNCisNCisjZGVmaW5lIEhETUlfUExMX0lERl9TSElG
VCAgICAgICAgICAgICAgMQ0KKyNkZWZpbmUgSERNSV9QTExfSURGX01BU0sgICAgICAgICAgICAg
ICBHRU5NQVNLKDUsIDEpDQorI2RlZmluZSBIRE1JX1BMTF9MRl9TSElGVCAgICAgICAgICAgICAg
IDYNCisjZGVmaW5lIEhETUlfUExMX0xGX01BU0sgICAgICAgICAgICAgICAgR0VOTUFTSygxMiwg
NikNCisjZGVmaW5lIEhETUlfUExMX09ERl9TSElGVCAgICAgICAgICAgICAgMTMNCisjZGVmaW5l
IEhETUlfUExMX09ERl9NQVNLICAgICAgICAgICAgICAgR0VOTUFTSygxNSwgMTMpDQorI2RlZmlu
ZSBMU0RDX0hETUkwX1BIWV9QTExfUkVHICAgICAgICAgIDB4MTgyMA0KKyNkZWZpbmUgTFNEQ19I
RE1JMV9QSFlfUExMX1JFRyAgICAgICAgICAweDE4MzANCisNCisvKiBMUzdBMjAwMC9MUzJLMjAw
MCBoYXMgaHBkIHN0YXR1cyByZWcsIHdoaWxlIHRoZSB0d28gaGRtaSdzIHN0YXR1cw0KKyAqIGxv
Y2F0ZWQgYXQgdGhlIG9uZSByZWdpc3RlciBhZ2Fpbi4NCisgKi8NCisjZGVmaW5lIExTRENfSERN
SV9IUERfU1RBVFVTX1JFRyAgICAgICAgMHgxQkEwDQorI2RlZmluZSBIRE1JMF9IUERfRkxBRyAg
ICAgICAgICAgICAgICAgIEJJVCgwKQ0KKyNkZWZpbmUgSERNSTFfSFBEX0ZMQUcgICAgICAgICAg
ICAgICAgICBCSVQoMSkNCisNCisjZGVmaW5lIExTRENfSERNSTBfUEhZX0NBTF9SRUcgICAgICAg
ICAgMHgxOEMwDQorI2RlZmluZSBMU0RDX0hETUkxX1BIWV9DQUxfUkVHICAgICAgICAgIDB4MThE
MA0KKw0KKy8qIEFWSSBJbmZvRnJhbWUgKi8NCisjZGVmaW5lIExTRENfSERNSTBfQVZJX0NPTlRF
TlQwICAgICAgICAgMHgxOEUwDQorI2RlZmluZSBMU0RDX0hETUkxX0FWSV9DT05URU5UMCAgICAg
ICAgIDB4MThEMA0KKyNkZWZpbmUgTFNEQ19IRE1JMF9BVklfQ09OVEVOVDEgICAgICAgICAweDE5
MDANCisjZGVmaW5lIExTRENfSERNSTFfQVZJX0NPTlRFTlQxICAgICAgICAgMHgxOTEwDQorI2Rl
ZmluZSBMU0RDX0hETUkwX0FWSV9DT05URU5UMiAgICAgICAgIDB4MTkyMA0KKyNkZWZpbmUgTFNE
Q19IRE1JMV9BVklfQ09OVEVOVDIgICAgICAgICAweDE5MzANCisjZGVmaW5lIExTRENfSERNSTBf
QVZJX0NPTlRFTlQzICAgICAgICAgMHgxOTQwDQorI2RlZmluZSBMU0RDX0hETUkxX0FWSV9DT05U
RU5UMyAgICAgICAgIDB4MTk1MA0KKw0KKy8qIDE6IGVuYWJsZSBhdmkgaW5mb2ZyYW1lIHBhY2tl
dCwgMDogZGlzYWJsZSBhdmkgaW5mb2ZyYW1lIHBhY2tldCAqLw0KKyNkZWZpbmUgQVZJX1BLVF9F
TkFCTEUgICAgICAgICAgICAgICAgICBCSVQoMCkNCisvKiAxOiBzZW5kIG9uZSBldmVyeSB0d28g
ZnJhbWUsIDA6IHNlbmQgb25lIGVhY2ggZnJhbWUgKi8NCisjZGVmaW5lIEFWSV9QS1RfU0VORF9G
UkVRICAgICAgICAgICAgICAgQklUKDEpDQorLyoNCisgKiAxOiB3cml0ZSAxIHRvIGZsdXNoIGF2
aSByZWcgY29udGVudDAgfiBjb250ZW50MyB0byB0aGUgcGFja2V0IHRvIGJlIHNlbmQsDQorICog
VGhlIGhhcmR3YXJlIHdpbGwgY2xlYXIgdGhpcyBiaXQgYXV0b21hdGljYWxseS4NCisgKi8NCisj
ZGVmaW5lIEFWSV9QS1RfVVBEQVRFICAgICAgICAgICAgICAgICAgQklUKDIpDQorDQorI2RlZmlu
ZSBMU0RDX0hETUkwX0FWSV9JTkZPX0NSVExfUkVHICAgIDB4MTk2MA0KKyNkZWZpbmUgTFNEQ19I
RE1JMV9BVklfSU5GT19DUlRMX1JFRyAgICAweDE5NzANCisNCisvKg0KKyAqIExTN0EyMDAwIGhh
cyB0aGUgaGFyZHdhcmUgd2hpY2ggY291bnQgdGhlIG51bWJlciBvZiB2YmxhbmsgZ2VuZXJhdGVk
DQorICovDQorI2RlZmluZSBMU0RDX0NSVEMwX1ZTWU5DX0NPVU5URVJfUkVHICAgIDB4MUEwMA0K
KyNkZWZpbmUgTFNEQ19DUlRDMV9WU1lOQ19DT1VOVEVSX1JFRyAgICAweDFBMTANCisNCisvKg0K
KyAqIExTN0EyMDAwIGhhcyB0aGUgYXVkaW8gaGFyZHdhcmUgYXNzb2NpYXRlIHdpdGggdGhlIEhE
TUkgZW5jb2Rlci4NCisgKi8NCisjZGVmaW5lIExTRENfSERNSTBfQVVESU9fUExMX0xPX1JFRyAg
ICAgMHgxQTIwDQorI2RlZmluZSBMU0RDX0hETUkxX0FVRElPX1BMTF9MT19SRUcgICAgIDB4MUEz
MA0KKw0KKyNkZWZpbmUgTFNEQ19IRE1JMF9BVURJT19QTExfSElfUkVHICAgICAweDFBNDANCisj
ZGVmaW5lIExTRENfSERNSTFfQVVESU9fUExMX0hJX1JFRyAgICAgMHgxQTUwDQorDQorI2VuZGlm
DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmMgYi9kcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmlu
ZGV4IDAwMDAwMDAwMDAwMC4uZmQyY2NmNTY3MGIxDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uYw0KQEAgLTAsMCArMSw2MTAgQEANCisvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsNCisvKg0KKyAqIENvcHlyaWdodCAoQykg
MjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisj
aW5jbHVkZSA8ZHJtL2RybV9kcnYuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+DQorI2lu
Y2x1ZGUgPGRybS9kcm1fZ2VtLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fbWFuYWdlZC5oPg0KKyNp
bmNsdWRlIDxkcm0vZHJtX3ByaW1lLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorI2lu
Y2x1ZGUgImxzZGNfdHRtLmgiDQorDQorY29uc3QgY2hhciAqbHNkY19tZW1fdHlwZV90b19zdHIo
dWludDMyX3QgbWVtX3R5cGUpDQorew0KKwlzd2l0Y2ggKG1lbV90eXBlKSB7DQorCWNhc2UgVFRN
X1BMX1ZSQU06DQorCQlyZXR1cm4gIlZSQU0iOw0KKwljYXNlIFRUTV9QTF9UVDoNCisJCXJldHVy
biAiR1RUIjsNCisJY2FzZSBUVE1fUExfU1lTVEVNOg0KKwkJcmV0dXJuICJTWVNURU0iOw0KKwlk
ZWZhdWx0Og0KKwkJYnJlYWs7DQorCX0NCisNCisJcmV0dXJuICJVbmtub3duIjsNCit9DQorDQor
Y29uc3QgY2hhciAqbHNkY19kb21haW5fdG9fc3RyKHUzMiBkb21haW4pDQorew0KKwlzd2l0Y2gg
KGRvbWFpbikgew0KKwljYXNlIExTRENfR0VNX0RPTUFJTl9WUkFNOg0KKwkJcmV0dXJuICJWUkFN
IjsNCisJY2FzZSBMU0RDX0dFTV9ET01BSU5fR1RUOg0KKwkJcmV0dXJuICJHVFQiOw0KKwljYXNl
IExTRENfR0VNX0RPTUFJTl9TWVNURU06DQorCQlyZXR1cm4gIlNZU1RFTSI7DQorCWRlZmF1bHQ6
DQorCQlicmVhazsNCisJfQ0KKw0KKwlyZXR1cm4gIlVua25vd24iOw0KK30NCisNCitzdGF0aWMg
dm9pZCBsc2RjX2JvX3NldF9wbGFjZW1lbnQoc3RydWN0IGxzZGNfYm8gKmxibywgdTMyIGRvbWFp
bikNCit7DQorCXUzMiBjID0gMDsNCisJdTMyIHBmbGFncyA9IDA7DQorCXUzMiBpOw0KKw0KKwlp
ZiAobGJvLT50Ym8uYmFzZS5zaXplIDw9IFBBR0VfU0laRSkNCisJCXBmbGFncyB8PSBUVE1fUExf
RkxBR19UT1BET1dOOw0KKw0KKwlsYm8tPnBsYWNlbWVudC5wbGFjZW1lbnQgPSBsYm8tPnBsYWNl
bWVudHM7DQorCWxiby0+cGxhY2VtZW50LmJ1c3lfcGxhY2VtZW50ID0gbGJvLT5wbGFjZW1lbnRz
Ow0KKw0KKwlpZiAoZG9tYWluICYgTFNEQ19HRU1fRE9NQUlOX1ZSQU0pIHsNCisJCWxiby0+cGxh
Y2VtZW50c1tjXS5tZW1fdHlwZSA9IFRUTV9QTF9WUkFNOw0KKwkJbGJvLT5wbGFjZW1lbnRzW2Mr
K10uZmxhZ3MgPSBwZmxhZ3M7DQorCX0NCisNCisJaWYgKGRvbWFpbiAmIExTRENfR0VNX0RPTUFJ
Tl9HVFQpIHsNCisJCWxiby0+cGxhY2VtZW50c1tjXS5tZW1fdHlwZSA9IFRUTV9QTF9UVDsNCisJ
CWxiby0+cGxhY2VtZW50c1tjKytdLmZsYWdzID0gcGZsYWdzOw0KKwl9DQorDQorCWlmIChkb21h
aW4gJiBMU0RDX0dFTV9ET01BSU5fU1lTVEVNKSB7DQorCQlsYm8tPnBsYWNlbWVudHNbY10ubWVt
X3R5cGUgPSBUVE1fUExfU1lTVEVNOw0KKwkJbGJvLT5wbGFjZW1lbnRzW2MrK10uZmxhZ3MgPSAw
Ow0KKwl9DQorDQorCWlmICghYykgew0KKwkJbGJvLT5wbGFjZW1lbnRzW2NdLm1lbV90eXBlID0g
VFRNX1BMX1NZU1RFTTsNCisJCWxiby0+cGxhY2VtZW50c1tjKytdLmZsYWdzID0gMDsNCisJfQ0K
Kw0KKwlsYm8tPnBsYWNlbWVudC5udW1fcGxhY2VtZW50ID0gYzsNCisJbGJvLT5wbGFjZW1lbnQu
bnVtX2J1c3lfcGxhY2VtZW50ID0gYzsNCisNCisJZm9yIChpID0gMDsgaSA8IGM7ICsraSkgew0K
KwkJbGJvLT5wbGFjZW1lbnRzW2ldLmZwZm4gPSAwOw0KKwkJbGJvLT5wbGFjZW1lbnRzW2ldLmxw
Zm4gPSAwOw0KKwl9DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfdHRtX3R0X2Rlc3Ryb3koc3Ry
dWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0KQ0KK3sNCisJdHRtX3R0X2Zp
bmkodHQpOw0KKwlrZnJlZSh0dCk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3QgdHRtX3R0ICoNCits
c2RjX3R0bV90dF9jcmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8sIHVpbnQzMl90
IHBhZ2VfZmxhZ3MpDQorew0KKwlzdHJ1Y3QgdHRtX3R0ICp0dDsNCisJaW50IHJldDsNCisNCisJ
dHQgPSBremFsbG9jKHNpemVvZigqdHQpLCBHRlBfS0VSTkVMKTsNCisJaWYgKCF0dCkNCisJCXJl
dHVybiBOVUxMOw0KKw0KKwlyZXQgPSB0dG1fc2dfdHRfaW5pdCh0dCwgdGJvLCBwYWdlX2ZsYWdz
LCB0dG1fY2FjaGVkKTsNCisJaWYgKHJldCA8IDApIHsNCisJCWtmcmVlKHR0KTsNCisJCXJldHVy
biBOVUxMOw0KKwl9DQorDQorCXJldHVybiB0dDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX3R0
bV90dF9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwNCisJCQkJc3RydWN0IHR0bV90
dCAqdHRtLA0KKwkJCQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCkNCit7DQorCWJvb2wg
c2xhdmUgPSAhISh0dG0tPnBhZ2VfZmxhZ3MgJiBUVE1fVFRfRkxBR19FWFRFUk5BTCk7DQorDQor
CWlmIChzbGF2ZSAmJiB0dG0tPnNnKSB7DQorCQlkcm1fcHJpbWVfc2dfdG9fZG1hX2FkZHJfYXJy
YXkodHRtLT5zZywNCisJCQkJCSAgICAgICB0dG0tPmRtYV9hZGRyZXNzLA0KKwkJCQkJICAgICAg
IHR0bS0+bnVtX3BhZ2VzKTsNCisNCisJCXJldHVybiAwOw0KKwl9DQorDQorCXJldHVybiB0dG1f
cG9vbF9hbGxvYygmYmRldi0+cG9vbCwgdHRtLCBjdHgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBs
c2RjX3R0bV90dF91bnBvcHVsYXRlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LA0KKwkJCQkgICBz
dHJ1Y3QgdHRtX3R0ICp0dG0pDQorew0KKwlib29sIHNsYXZlID0gISEodHRtLT5wYWdlX2ZsYWdz
ICYgVFRNX1RUX0ZMQUdfRVhURVJOQUwpOw0KKw0KKwlpZiAoc2xhdmUpDQorCQlyZXR1cm47DQor
DQorCXJldHVybiB0dG1fcG9vbF9mcmVlKCZiZGV2LT5wb29sLCB0dG0pOw0KK30NCisNCitzdGF0
aWMgdm9pZCBsc2RjX2JvX2V2aWN0X2ZsYWdzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJv
LA0KKwkJCQlzdHJ1Y3QgdHRtX3BsYWNlbWVudCAqdHBsYWNlbWVudCkNCit7DQorCXN0cnVjdCB0
dG1fcmVzb3VyY2UgKnJlc291cmNlID0gdGJvLT5yZXNvdXJjZTsNCisJc3RydWN0IGxzZGNfYm8g
KmxibyA9IHRvX2xzZGNfYm8odGJvKTsNCisNCisJc3dpdGNoIChyZXNvdXJjZS0+bWVtX3R5cGUp
IHsNCisJY2FzZSBUVE1fUExfVlJBTToNCisJCWxzZGNfYm9fc2V0X3BsYWNlbWVudChsYm8sIExT
RENfR0VNX0RPTUFJTl9HVFQpOw0KKwkJYnJlYWs7DQorCWNhc2UgVFRNX1BMX1RUOg0KKwlkZWZh
dWx0Og0KKwkJbHNkY19ib19zZXRfcGxhY2VtZW50KGxibywgTFNEQ19HRU1fRE9NQUlOX1NZU1RF
TSk7DQorCQlicmVhazsNCisJfQ0KKw0KKwkqdHBsYWNlbWVudCA9IGxiby0+cGxhY2VtZW50Ow0K
K30NCisNCitzdGF0aWMgaW50IGxzZGNfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KnRibywNCisJCQlib29sIGV2aWN0LA0KKwkJCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4
LA0KKwkJCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0sDQorCQkJc3RydWN0IHR0bV9wbGFj
ZSAqaG9wKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSB0Ym8tPmJhc2UuZGV2Ow0K
KwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gdGJvLT5yZXNvdXJjZTsNCisJc3RydWN0
IGxzZGNfYm8gKmxibyA9IHRvX2xzZGNfYm8odGJvKTsNCisJaW50IHJldDsNCisNCisJaWYgKHVu
bGlrZWx5KHRiby0+cGluX2NvdW50ID4gMCkpIHsNCisJCWRybV93YXJuKGRkZXYsICJDYW4ndCBt
b3ZlIGEgcGlubmVkIEJPXG4iKTsNCisJCXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCXJldCA9
IHR0bV9ib193YWl0X2N0eCh0Ym8sIGN0eCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0K
Kw0KKwlpZiAoIW9sZF9tZW0pIHsNCisJCWRybV9kYmcoZGRldiwgImJvWyVwXSBtb3ZlOiBOVUxM
IHRvICVzLCBzaXplOiAlenVcbiIsDQorCQkJbGJvLCBsc2RjX21lbV90eXBlX3RvX3N0cihuZXdf
bWVtLT5tZW1fdHlwZSksDQorCQkJbHNkY19ib19zaXplKGxibykpOw0KKwkJdHRtX2JvX21vdmVf
bnVsbCh0Ym8sIG5ld19tZW0pOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJaWYgKG9sZF9tZW0t
Pm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0gJiYgIXRiby0+dHRtKSB7DQorCQl0dG1fYm9fbW92
ZV9udWxsKHRibywgbmV3X21lbSk7DQorCQlkcm1fZGJnKGRkZXYsICJib1slcF0gbW92ZTogU1lT
VEVNIHRvIE5VTEwsIHNpemU6ICV6dVxuIiwNCisJCQlsYm8sIGxzZGNfYm9fc2l6ZShsYm8pKTsN
CisJCXJldHVybiAwOw0KKwl9DQorDQorCWlmIChvbGRfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExf
U1lTVEVNICYmDQorCSAgICBuZXdfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQpIHsNCisJCWRy
bV9kYmcoZGRldiwgImJvWyVwXSBtb3ZlOiBTWVNURU0gdG8gR1RULCBzaXplOiAlenVcbiIsDQor
CQkJbGJvLCBsc2RjX2JvX3NpemUobGJvKSk7DQorCQl0dG1fYm9fbW92ZV9udWxsKHRibywgbmV3
X21lbSk7DQorCQlyZXR1cm4gMDsNCisJfQ0KKw0KKwlpZiAob2xkX21lbS0+bWVtX3R5cGUgPT0g
VFRNX1BMX1RUICYmDQorCSAgICBuZXdfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKSB7
DQorCQlkcm1fZGJnKGRkZXYsICJib1slcF0gbW92ZTogR1RUIHRvIFNZU1RFTSwgc2l6ZTogJXp1
XG4iLA0KKwkJCWxibywgbHNkY19ib19zaXplKGxibykpOw0KKwkJdHRtX3Jlc291cmNlX2ZyZWUo
dGJvLCAmdGJvLT5yZXNvdXJjZSk7DQorCQl0dG1fYm9fYXNzaWduX21lbSh0Ym8sIG5ld19tZW0p
Ow0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJZHJtX2RiZyhkZGV2LCAiYm9bJXBdIG1vdmU6ICVz
IHRvICVzLCBzaXplOiAlenVcbiIsDQorCQlsYm8sDQorCQlsc2RjX21lbV90eXBlX3RvX3N0cihv
bGRfbWVtLT5tZW1fdHlwZSksDQorCQlsc2RjX21lbV90eXBlX3RvX3N0cihuZXdfbWVtLT5tZW1f
dHlwZSksDQorCQlsc2RjX2JvX3NpemUobGJvKSk7DQorDQorCXJldHVybiB0dG1fYm9fbW92ZV9t
ZW1jcHkodGJvLCBjdHgsIG5ld19tZW0pOw0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfYm9fcmVz
ZXJ2ZV9pb19tZW0oc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsDQorCQkJCSAgc3RydWN0IHR0bV9y
ZXNvdXJjZSAqbWVtKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdGRldl90b19s
ZGV2KGJkZXYpOw0KKw0KKwlzd2l0Y2ggKG1lbS0+bWVtX3R5cGUpIHsNCisJY2FzZSBUVE1fUExf
U1lTVEVNOg0KKwkJYnJlYWs7DQorCWNhc2UgVFRNX1BMX1RUOg0KKwkJYnJlYWs7DQorCWNhc2Ug
VFRNX1BMX1ZSQU06DQorCQltZW0tPmJ1cy5vZmZzZXQgPSAobWVtLT5zdGFydCA8PCBQQUdFX1NI
SUZUKSArIGxkZXYtPnZyYW1fYmFzZTsNCisJCW1lbS0+YnVzLmlzX2lvbWVtID0gdHJ1ZTsNCisJ
CW1lbS0+YnVzLmNhY2hpbmcgPSB0dG1fd3JpdGVfY29tYmluZWQ7DQorCQlicmVhazsNCisJZGVm
YXVsdDoNCisJCXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCXJldHVybiAwOw0KK30NCisNCitz
dGF0aWMgc3RydWN0IHR0bV9kZXZpY2VfZnVuY3MgbHNkY19ib19kcml2ZXIgPSB7DQorCS50dG1f
dHRfY3JlYXRlID0gbHNkY190dG1fdHRfY3JlYXRlLA0KKwkudHRtX3R0X3BvcHVsYXRlID0gbHNk
Y190dG1fdHRfcG9wdWxhdGUsDQorCS50dG1fdHRfdW5wb3B1bGF0ZSA9IGxzZGNfdHRtX3R0X3Vu
cG9wdWxhdGUsDQorCS50dG1fdHRfZGVzdHJveSA9IGxzZGNfdHRtX3R0X2Rlc3Ryb3ksDQorCS5l
dmljdGlvbl92YWx1YWJsZSA9IHR0bV9ib19ldmljdGlvbl92YWx1YWJsZSwNCisJLmV2aWN0X2Zs
YWdzID0gbHNkY19ib19ldmljdF9mbGFncywNCisJLm1vdmUgPSBsc2RjX2JvX21vdmUsDQorCS5p
b19tZW1fcmVzZXJ2ZSA9IGxzZGNfYm9fcmVzZXJ2ZV9pb19tZW0sDQorfTsNCisNCit1NjQgbHNk
Y19ib19ncHVfb2Zmc2V0KHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgKnRibyA9ICZsYm8tPnRibzsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYg
PSB0Ym8tPmJhc2UuZGV2Ow0KKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXNvdXJjZSA9IHRiby0+
cmVzb3VyY2U7DQorDQorCWlmICh1bmxpa2VseSghdGJvLT5waW5fY291bnQpKSB7DQorCQlkcm1f
ZXJyKGRkZXYsICJ1bnBpbm5lZCBibywgZ3B1IHZpcnR1YWwgYWRkcmVzcyBpcyBpbnZhbGlkXG4i
KTsNCisJCXJldHVybiAwOw0KKwl9DQorDQorCWlmICh1bmxpa2VseShyZXNvdXJjZS0+bWVtX3R5
cGUgPT0gVFRNX1BMX1NZU1RFTSkpDQorCQlyZXR1cm4gMDsNCisNCisJcmV0dXJuIHJlc291cmNl
LT5zdGFydCA8PCBQQUdFX1NISUZUOw0KK30NCisNCitzaXplX3QgbHNkY19ib19zaXplKHN0cnVj
dCBsc2RjX2JvICpsYm8pDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9ICZs
Ym8tPnRibzsNCisNCisJcmV0dXJuIHRiby0+YmFzZS5zaXplOw0KK30NCisNCitpbnQgbHNkY19i
b19yZXNlcnZlKHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlyZXR1cm4gdHRtX2JvX3Jlc2Vy
dmUoJmxiby0+dGJvLCB0cnVlLCBmYWxzZSwgTlVMTCk7DQorfQ0KKw0KK3ZvaWQgbHNkY19ib191
bnJlc2VydmUoc3RydWN0IGxzZGNfYm8gKmxibykNCit7DQorCXJldHVybiB0dG1fYm9fdW5yZXNl
cnZlKCZsYm8tPnRibyk7DQorfQ0KKw0KK2ludCBsc2RjX2JvX3BpbihzdHJ1Y3QgbHNkY19ibyAq
bGJvLCB1MzIgZG9tYWluLCB1NjQgKmdwdV9hZGRyKQ0KK3sNCisJc3RydWN0IHR0bV9vcGVyYXRp
b25fY3R4IGN0eCA9IHsgZmFsc2UsIGZhbHNlIH07DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVj
dCAqdGJvID0gJmxiby0+dGJvOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0ZGV2X3Rv
X2xkZXYodGJvLT5iZGV2KTsNCisJaW50IHJldDsNCisNCisJaWYgKHRiby0+cGluX2NvdW50KQ0K
KwkJZ290byBib19waW5uZWQ7DQorDQorCWlmIChsYm8tPnNoYXJpbmdfY291bnQgJiYgZG9tYWlu
ID09IExTRENfR0VNX0RPTUFJTl9WUkFNKQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQorDQorCWlmIChk
b21haW4pDQorCQlsc2RjX2JvX3NldF9wbGFjZW1lbnQobGJvLCBkb21haW4pOw0KKw0KKwlyZXQg
PSB0dG1fYm9fdmFsaWRhdGUodGJvLCAmbGJvLT5wbGFjZW1lbnQsICZjdHgpOw0KKwlpZiAodW5s
aWtlbHkocmV0KSkgew0KKwkJZHJtX2VycigmbGRldi0+YmFzZSwgIiVwIHZhbGlkYXRlIGZhaWxl
ZDogJWRcbiIsIGxibywgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJaWYgKGRvbWFp
biA9PSBMU0RDX0dFTV9ET01BSU5fVlJBTSkNCisJCWxkZXYtPnZyYW1fcGlubmVkX3NpemUgKz0g
bHNkY19ib19zaXplKGxibyk7DQorCWVsc2UgaWYgKGRvbWFpbiA9PSBMU0RDX0dFTV9ET01BSU5f
R1RUKQ0KKwkJbGRldi0+Z3R0X3Bpbm5lZF9zaXplICs9IGxzZGNfYm9fc2l6ZShsYm8pOw0KKw0K
K2JvX3Bpbm5lZDoNCisJdHRtX2JvX3Bpbih0Ym8pOw0KKw0KKwlpZiAoZ3B1X2FkZHIpDQorCQkq
Z3B1X2FkZHIgPSBsc2RjX2JvX2dwdV9vZmZzZXQobGJvKTsNCisNCisJcmV0dXJuIDA7DQorfQ0K
Kw0KK3ZvaWQgbHNkY19ib191bnBpbihzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8gPSAmbGJvLT50Ym87DQorCXN0cnVjdCBsc2RjX2Rldmlj
ZSAqbGRldiA9IHRkZXZfdG9fbGRldih0Ym8tPmJkZXYpOw0KKw0KKwlpZiAodW5saWtlbHkoIXRi
by0+cGluX2NvdW50KSkgew0KKwkJZHJtX2RiZygmbGRldi0+YmFzZSwgIiVwIHVucGluIGlzIG5v
dCBuZWNlc3NhcnlcbiIsIGxibyk7DQorCQlyZXR1cm47DQorCX0NCisNCisJdHRtX2JvX3VucGlu
KHRibyk7DQorDQorCWlmICghdGJvLT5waW5fY291bnQpIHsNCisJCWlmICh0Ym8tPnJlc291cmNl
LT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkNCisJCQlsZGV2LT52cmFtX3Bpbm5lZF9zaXplIC09
IGxzZGNfYm9fc2l6ZShsYm8pOw0KKwkJZWxzZSBpZiAodGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUg
PT0gVFRNX1BMX1RUKQ0KKwkJCWxkZXYtPmd0dF9waW5uZWRfc2l6ZSAtPSBsc2RjX2JvX3NpemUo
bGJvKTsNCisJfQ0KK30NCisNCit2b2lkIGxzZGNfYm9fcmVmKHN0cnVjdCBsc2RjX2JvICpsYm8p
DQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9ICZsYm8tPnRibzsNCisNCisJ
dHRtX2JvX2dldCh0Ym8pOw0KK30NCisNCit2b2lkIGxzZGNfYm9fdW5yZWYoc3RydWN0IGxzZGNf
Ym8gKmxibykNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJv
Ow0KKw0KKwl0dG1fYm9fcHV0KHRibyk7DQorfQ0KKw0KK2ludCBsc2RjX2JvX2ttYXAoc3RydWN0
IGxzZGNfYm8gKmxibykNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxi
by0+dGJvOw0KKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSA9ICZ0Ym8tPmJhc2U7DQorCXN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gZ2VtLT5kZXY7DQorCWxvbmcgcmV0Ow0KKwlpbnQgZXJy
Ow0KKw0KKwlyZXQgPSBkbWFfcmVzdl93YWl0X3RpbWVvdXQoZ2VtLT5yZXN2LA0KKwkJCQkgICAg
RE1BX1JFU1ZfVVNBR0VfS0VSTkVMLA0KKwkJCQkgICAgZmFsc2UsDQorCQkJCSAgICBNQVhfU0NI
RURVTEVfVElNRU9VVCk7DQorCWlmIChyZXQgPCAwKSB7DQorCQlkcm1fd2FybihkZGV2LCAid2Fp
dCBmZW5jZSB0aW1lb3V0XG4iKTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJaWYgKGxiby0+
a3B0cikNCisJCXJldHVybiAwOw0KKw0KKwllcnIgPSB0dG1fYm9fa21hcCh0Ym8sIDAsIFBGTl9V
UChsc2RjX2JvX3NpemUobGJvKSksICZsYm8tPmttYXApOw0KKwlpZiAoZXJyKSB7DQorCQlkcm1f
ZXJyKGRkZXYsICJrbWFwICVwIGZhaWxlZDogJWRcbiIsIGxibywgZXJyKTsNCisJCXJldHVybiBl
cnI7DQorCX0NCisNCisJbGJvLT5rcHRyID0gdHRtX2ttYXBfb2JqX3ZpcnR1YWwoJmxiby0+a21h
cCwgJmxiby0+aXNfaW9tZW0pOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQordm9pZCBsc2RjX2Jv
X2t1bm1hcChzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJaWYgKCFsYm8tPmtwdHIpDQorCQly
ZXR1cm47DQorDQorCWxiby0+a3B0ciA9IE5VTEw7DQorCXR0bV9ib19rdW5tYXAoJmxiby0+a21h
cCk7DQorfQ0KKw0KK3ZvaWQgbHNkY19ib19jbGVhcihzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sN
CisJbHNkY19ib19rbWFwKGxibyk7DQorDQorCWlmIChsYm8tPmlzX2lvbWVtKQ0KKwkJbWVtc2V0
X2lvKCh2b2lkIF9faW9tZW0gKilsYm8tPmtwdHIsIDAsIGxiby0+c2l6ZSk7DQorCWVsc2UNCisJ
CW1lbXNldChsYm8tPmtwdHIsIDAsIGxiby0+c2l6ZSk7DQorDQorCWxzZGNfYm9fa3VubWFwKGxi
byk7DQorfQ0KKw0KK2ludCBsc2RjX2JvX2V2aWN0X3ZyYW0oc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlz
dHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9ICZsZGV2LT5iZGV2Ow0KKwlzdHJ1Y3QgdHRtX3Jlc291
cmNlX21hbmFnZXIgKm1hbjsNCisNCisJbWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBUVE1f
UExfVlJBTSk7DQorCWlmICh1bmxpa2VseSghbWFuKSkNCisJCXJldHVybiAwOw0KKw0KKwlyZXR1
cm4gdHRtX3Jlc291cmNlX21hbmFnZXJfZXZpY3RfYWxsKGJkZXYsIG1hbik7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGxzZGNfYm9fZGVzdHJveShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibykN
Cit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRkZXZfdG9fbGRldih0Ym8tPmJkZXYp
Ow0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvID0gdG9fbHNkY19ibyh0Ym8pOw0KKw0KKwltdXRleF9s
b2NrKCZsZGV2LT5nZW0ubXV0ZXgpOw0KKwlsaXN0X2RlbF9pbml0KCZsYm8tPmxpc3QpOw0KKwlt
dXRleF91bmxvY2soJmxkZXYtPmdlbS5tdXRleCk7DQorDQorCWRybV9nZW1fb2JqZWN0X3JlbGVh
c2UoJnRiby0+YmFzZSk7DQorDQorCWtmcmVlKGxibyk7DQorfQ0KKw0KK3N0cnVjdCBsc2RjX2Jv
ICpsc2RjX2JvX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgICAgdTMy
IGRvbWFpbiwNCisJCQkgICAgICAgc2l6ZV90IHNpemUsDQorCQkJICAgICAgIGJvb2wga2VybmVs
LA0KKwkJCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLA0KKwkJCSAgICAgICBzdHJ1Y3QgZG1h
X3Jlc3YgKnJlc3YpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRk
ZXYpOw0KKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9ICZsZGV2LT5iZGV2Ow0KKwlzdHJ1Y3Qg
dHRtX2J1ZmZlcl9vYmplY3QgKnRibzsNCisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisJZW51bSB0
dG1fYm9fdHlwZSBib190eXBlOw0KKwlpbnQgcmV0Ow0KKw0KKwlsYm8gPSBremFsbG9jKHNpemVv
ZigqbGJvKSwgR0ZQX0tFUk5FTCk7DQorCWlmICghbGJvKQ0KKwkJcmV0dXJuIEVSUl9QVFIoLUVO
T01FTSk7DQorDQorCUlOSVRfTElTVF9IRUFEKCZsYm8tPmxpc3QpOw0KKw0KKwlsYm8tPmluaXRp
YWxfZG9tYWluID0gZG9tYWluICYgKExTRENfR0VNX0RPTUFJTl9WUkFNIHwNCisJCQkJCUxTRENf
R0VNX0RPTUFJTl9HVFQgfA0KKwkJCQkJTFNEQ19HRU1fRE9NQUlOX1NZU1RFTSk7DQorDQorCXRi
byA9ICZsYm8tPnRibzsNCisNCisJc2l6ZSA9IEFMSUdOKHNpemUsIFBBR0VfU0laRSk7DQorDQor
CXJldCA9IGRybV9nZW1fb2JqZWN0X2luaXQoZGRldiwgJnRiby0+YmFzZSwgc2l6ZSk7DQorCWlm
IChyZXQpIHsNCisJCWtmcmVlKGxibyk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9DQor
DQorCXRiby0+YmRldiA9IGJkZXY7DQorDQorCWlmIChrZXJuZWwpDQorCQlib190eXBlID0gdHRt
X2JvX3R5cGVfa2VybmVsOw0KKwllbHNlIGlmIChzZykNCisJCWJvX3R5cGUgPSB0dG1fYm9fdHlw
ZV9zZzsNCisJZWxzZQ0KKwkJYm9fdHlwZSA9IHR0bV9ib190eXBlX2RldmljZTsNCisNCisJbHNk
Y19ib19zZXRfcGxhY2VtZW50KGxibywgZG9tYWluKTsNCisJbGJvLT5zaXplID0gc2l6ZTsNCisN
CisJcmV0ID0gdHRtX2JvX2luaXRfdmFsaWRhdGUoYmRldiwNCisJCQkJICAgdGJvLA0KKwkJCQkg
ICBib190eXBlLA0KKwkJCQkgICAmbGJvLT5wbGFjZW1lbnQsDQorCQkJCSAgIDAsDQorCQkJCSAg
IGZhbHNlLA0KKwkJCQkgICBzZywNCisJCQkJICAgcmVzdiwNCisJCQkJICAgbHNkY19ib19kZXN0
cm95KTsNCisJaWYgKHJldCkgew0KKwkJa2ZyZWUobGJvKTsNCisJCXJldHVybiBFUlJfUFRSKHJl
dCk7DQorCX0NCisNCisJcmV0dXJuIGxibzsNCit9DQorDQorc3RydWN0IGxzZGNfYm8gKmxzZGNf
Ym9fY3JlYXRlX2tlcm5lbF9waW5uZWQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJCQkg
ICAgIHUzMiBkb21haW4sDQorCQkJCQkgICAgIHNpemVfdCBzaXplKQ0KK3sNCisJc3RydWN0IGxz
ZGNfYm8gKmxibzsNCisJaW50IHJldDsNCisNCisJbGJvID0gbHNkY19ib19jcmVhdGUoZGRldiwg
ZG9tYWluLCBzaXplLCB0cnVlLCBOVUxMLCBOVUxMKTsNCisNCisJcmV0ID0gbHNkY19ib19yZXNl
cnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlsc2RjX2JvX3VucmVmKGxibyk7
DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9DQorDQorCXJldCA9IGxzZGNfYm9fcGluKGxi
bywgZG9tYWluLCBOVUxMKTsNCisJbHNkY19ib191bnJlc2VydmUobGJvKTsNCisJaWYgKHVubGlr
ZWx5KHJldCkpIHsNCisJCWxzZGNfYm9fdW5yZWYobGJvKTsNCisJCXJldHVybiBFUlJfUFRSKHJl
dCk7DQorCX0NCisNCisJcmV0dXJuIGxibzsNCit9DQorDQordm9pZCBsc2RjX2JvX2ZyZWVfa2Vy
bmVsX3Bpbm5lZChzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJaW50IHJldDsNCisNCisJcmV0
ID0gbHNkY19ib19yZXNlcnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKQ0KKwkJcmV0dXJu
Ow0KKw0KKwlsc2RjX2JvX3VucGluKGxibyk7DQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQor
DQorCWxzZGNfYm9fdW5yZWYobGJvKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY190dG1fZmlu
aShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwgdm9pZCAqZGF0YSkNCit7DQorCXN0cnVjdCBsc2Rj
X2RldmljZSAqbGRldiA9IChzdHJ1Y3QgbHNkY19kZXZpY2UgKilkYXRhOw0KKw0KKwl0dG1fcmFu
Z2VfbWFuX2ZpbmkoJmxkZXYtPmJkZXYsIFRUTV9QTF9WUkFNKTsNCisJdHRtX3JhbmdlX21hbl9m
aW5pKCZsZGV2LT5iZGV2LCBUVE1fUExfVFQpOw0KKw0KKwl0dG1fZGV2aWNlX2ZpbmkoJmxkZXYt
PmJkZXYpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJ0dG0gZmluaXNoZWRcbiIpOw0KK30NCisNCitp
bnQgbHNkY190dG1faW5pdChzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYpDQorew0KKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiA9ICZsZGV2LT5iYXNlOw0KKwl1bnNpZ25lZCBsb25nIG51bV92cmFt
X3BhZ2VzOw0KKwl1bnNpZ25lZCBsb25nIG51bV9ndHRfcGFnZXM7DQorCWludCByZXQ7DQorDQor
CXJldCA9IHR0bV9kZXZpY2VfaW5pdCgmbGRldi0+YmRldiwNCisJCQkgICAgICAmbHNkY19ib19k
cml2ZXIsDQorCQkJICAgICAgZGRldi0+ZGV2LA0KKwkJCSAgICAgIGRkZXYtPmFub25faW5vZGUt
PmlfbWFwcGluZywNCisJCQkgICAgICBkZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIsDQorCQkJICAg
ICAgZmFsc2UsDQorCQkJICAgICAgZmFsc2UpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsN
CisNCisJbnVtX3ZyYW1fcGFnZXMgPSBsZGV2LT52cmFtX3NpemUgPj4gUEFHRV9TSElGVDsNCisN
CisJcmV0ID0gdHRtX3JhbmdlX21hbl9pbml0KCZsZGV2LT5iZGV2LA0KKwkJCQkgVFRNX1BMX1ZS
QU0sDQorCQkJCSBmYWxzZSwNCisJCQkJIG51bV92cmFtX3BhZ2VzKTsNCisJaWYgKHVubGlrZWx5
KHJldCkpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1faW5mbyhkZGV2LCAiVlJBTTogJWx1IHBh
Z2VzIHJlYWR5XG4iLCBudW1fdnJhbV9wYWdlcyk7DQorDQorCS8qIDUxMk0gaXMgZmFyIGVub3Vn
aCBmb3IgdXMgbm93ICovDQorCWxkZXYtPmd0dF9zaXplID0gNTEyIDw8IDIwOw0KKw0KKwludW1f
Z3R0X3BhZ2VzID0gbGRldi0+Z3R0X3NpemUgPj4gUEFHRV9TSElGVDsNCisNCisJcmV0ID0gdHRt
X3JhbmdlX21hbl9pbml0KCZsZGV2LT5iZGV2LA0KKwkJCQkgVFRNX1BMX1RULA0KKwkJCQkgdHJ1
ZSwNCisJCQkJIG51bV9ndHRfcGFnZXMpOw0KKwlpZiAodW5saWtlbHkocmV0KSkNCisJCXJldHVy
biByZXQ7DQorDQorCWRybV9pbmZvKGRkZXYsICJHVFQ6ICVsdSBwYWdlcyByZWFkeVxuIiwgbnVt
X2d0dF9wYWdlcyk7DQorDQorCXJldHVybiBkcm1tX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGRldiwg
bHNkY190dG1fZmluaSwgbGRldik7DQorfQ0KKw0KK3ZvaWQgbHNkY190dG1fZGVidWdmc19pbml0
KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldikNCit7DQorCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2
ID0gJmxkZXYtPmJkZXY7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gJmxkZXYtPmJhc2U7
DQorCXN0cnVjdCBkcm1fbWlub3IgKm1pbm9yID0gZGRldi0+cHJpbWFyeTsNCisJc3RydWN0IGRl
bnRyeSAqcm9vdCA9IG1pbm9yLT5kZWJ1Z2ZzX3Jvb3Q7DQorCXN0cnVjdCB0dG1fcmVzb3VyY2Vf
bWFuYWdlciAqdnJhbV9tYW47DQorCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqZ3R0X21h
bjsNCisNCisJdnJhbV9tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIFRUTV9QTF9WUkFNKTsN
CisJZ3R0X21hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgVFRNX1BMX1RUKTsNCisNCisJdHRt
X3Jlc291cmNlX21hbmFnZXJfY3JlYXRlX2RlYnVnZnModnJhbV9tYW4sIHJvb3QsICJ2cmFtX21t
Iik7DQorCXR0bV9yZXNvdXJjZV9tYW5hZ2VyX2NyZWF0ZV9kZWJ1Z2ZzKGd0dF9tYW4sIHJvb3Qs
ICJndHRfbW0iKTsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfdHRtLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uaA0KbmV3IGZpbGUg
bW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uNmVmMzFkNzAyZGNhDQotLS0gL2Rldi9u
dWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uaA0KQEAgLTAsMCAr
MSw5OSBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisg
KiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1p
dGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfVFRNX0hfXw0KKyNkZWZpbmUgX19MU0RDX1RU
TV9IX18NCisNCisjaW5jbHVkZSA8bGludXgvY29udGFpbmVyX29mLmg+DQorI2luY2x1ZGUgPGxp
bnV4L2lvc3lzLW1hcC5oPg0KKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+DQorDQorI2luY2x1ZGUg
PGRybS9kcm1fZ2VtLmg+DQorI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvLmg+DQorI2luY2x1ZGUg
PGRybS90dG0vdHRtX3BsYWNlbWVudC5oPg0KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9yYW5nZV9t
YW5hZ2VyLmg+DQorI2luY2x1ZGUgPGRybS90dG0vdHRtX3R0Lmg+DQorDQorI2RlZmluZSBMU0RD
X0dFTV9ET01BSU5fU1lTVEVNICAgICAgICAgIDB4MQ0KKyNkZWZpbmUgTFNEQ19HRU1fRE9NQUlO
X0dUVCAgICAgICAgICAgICAweDINCisjZGVmaW5lIExTRENfR0VNX0RPTUFJTl9WUkFNICAgICAg
ICAgICAgMHg0DQorDQorc3RydWN0IGxzZGNfYm8gew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgdGJvOw0KKw0KKwkvKiBQcm90ZWN0ZWQgYnkgZ2VtLm11dGV4ICovDQorCXN0cnVjdCBsaXN0
X2hlYWQgbGlzdDsNCisNCisJc3RydWN0IGlvc3lzX21hcCBtYXA7DQorDQorCXVuc2lnbmVkIGlu
dCB2bWFwX2NvdW50Ow0KKwkvKiBjcm9zcyBkZXZpY2UgZHJpdmVyIHNoYXJpbmcgcmVmZXJlbmNl
IGNvdW50ICovDQorCXVuc2lnbmVkIGludCBzaGFyaW5nX2NvdW50Ow0KKw0KKwlzdHJ1Y3QgdHRt
X2JvX2ttYXBfb2JqIGttYXA7DQorCXZvaWQgKmtwdHI7DQorCWJvb2wgaXNfaW9tZW07DQorDQor
CXNpemVfdCBzaXplOw0KKw0KKwl1MzIgaW5pdGlhbF9kb21haW47DQorDQorCXN0cnVjdCB0dG1f
cGxhY2VtZW50IHBsYWNlbWVudDsNCisJc3RydWN0IHR0bV9wbGFjZSBwbGFjZW1lbnRzWzRdOw0K
K307DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRvX3R0bV9i
byhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSkNCit7DQorCXJldHVybiBjb250YWluZXJfb2Yo
Z2VtLCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QsIGJhc2UpOw0KK30NCisNCitzdGF0aWMgaW5s
aW5lIHN0cnVjdCBsc2RjX2JvICp0b19sc2RjX2JvKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
dGJvKQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9vZih0Ym8sIHN0cnVjdCBsc2RjX2JvLCB0Ym8p
Ow0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX2JvICpnZW1fdG9fbHNkY19ibyhz
dHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSkNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoZ2Vt
LCBzdHJ1Y3QgbHNkY19ibywgdGJvLmJhc2UpOw0KK30NCisNCitjb25zdCBjaGFyICpsc2RjX21l
bV90eXBlX3RvX3N0cih1aW50MzJfdCBtZW1fdHlwZSk7DQorY29uc3QgY2hhciAqbHNkY19kb21h
aW5fdG9fc3RyKHUzMiBkb21haW4pOw0KKw0KK3N0cnVjdCBsc2RjX2JvICpsc2RjX2JvX2NyZWF0
ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgICAgdTMyIGRvbWFpbiwNCisJCQkg
ICAgICAgc2l6ZV90IHNpemUsDQorCQkJICAgICAgIGJvb2wga2VybmVsLA0KKwkJCSAgICAgICBz
dHJ1Y3Qgc2dfdGFibGUgKnNnLA0KKwkJCSAgICAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpOw0K
Kw0KK3N0cnVjdCBsc2RjX2JvICpsc2RjX2JvX2NyZWF0ZV9rZXJuZWxfcGlubmVkKHN0cnVjdCBk
cm1fZGV2aWNlICpkZGV2LA0KKwkJCQkJICAgICB1MzIgZG9tYWluLA0KKwkJCQkJICAgICBzaXpl
X3Qgc2l6ZSk7DQorDQordm9pZCBsc2RjX2JvX2ZyZWVfa2VybmVsX3Bpbm5lZChzdHJ1Y3QgbHNk
Y19ibyAqbGJvKTsNCisNCitpbnQgbHNkY19ib19yZXNlcnZlKHN0cnVjdCBsc2RjX2JvICpsYm8p
Ow0KK3ZvaWQgbHNkY19ib191bnJlc2VydmUoc3RydWN0IGxzZGNfYm8gKmxibyk7DQorDQoraW50
IGxzZGNfYm9fcGluKHN0cnVjdCBsc2RjX2JvICpsYm8sIHUzMiBkb21haW4sIHU2NCAqZ3B1X2Fk
ZHIpOw0KK3ZvaWQgbHNkY19ib191bnBpbihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCit2b2lk
IGxzZGNfYm9fcmVmKHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3ZvaWQgbHNkY19ib191bnJlZihz
dHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCit1NjQgbHNkY19ib19ncHVfb2Zmc2V0KHN0cnVjdCBs
c2RjX2JvICpsYm8pOw0KK3NpemVfdCBsc2RjX2JvX3NpemUoc3RydWN0IGxzZGNfYm8gKmxibyk7
DQorDQoraW50IGxzZGNfYm9fa21hcChzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCit2b2lkIGxzZGNf
Ym9fa3VubWFwKHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3ZvaWQgbHNkY19ib19jbGVhcihzdHJ1
Y3QgbHNkY19ibyAqbGJvKTsNCisNCitpbnQgbHNkY19ib19ldmljdF92cmFtKHN0cnVjdCBkcm1f
ZGV2aWNlICpkZGV2KTsNCisNCitpbnQgbHNkY190dG1faW5pdChzdHJ1Y3QgbHNkY19kZXZpY2Ug
KmxkZXYpOw0KK3ZvaWQgbHNkY190dG1fZGVidWdmc19pbml0KHN0cnVjdCBsc2RjX2RldmljZSAq
bGRldik7DQorDQorI2VuZGlmDQotLSANCjIuMjUuMQ0KDQpfX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdCAtLSBs
aW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKVG8gdW5zdWJzY3JpYmUgc2VuZCBhbiBlbWFp
bCB0byBsaW5hcm8tbW0tc2lnLWxlYXZlQGxpc3RzLmxpbmFyby5vcmcK
