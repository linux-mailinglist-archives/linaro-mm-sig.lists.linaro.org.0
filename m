Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 876CB259FE9
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  1 Sep 2020 22:20:53 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id AD22F66727
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  1 Sep 2020 20:20:52 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 979EA66728; Tue,  1 Sep 2020 20:20:52 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-7.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_HI,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 5FF3066722;
	Tue,  1 Sep 2020 20:19:58 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 7367D66722
 for <linaro-mm-sig@lists.linaro.org>; Tue,  1 Sep 2020 20:19:54 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 6677C66724; Tue,  1 Sep 2020 20:19:54 +0000 (UTC)
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by lists.linaro.org (Postfix) with ESMTP id A4CA266723
 for <linaro-mm-sig@lists.linaro.org>; Tue,  1 Sep 2020 20:19:07 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 7111C1063;
 Tue,  1 Sep 2020 13:19:07 -0700 (PDT)
Received: from [10.57.40.122] (unknown [10.57.40.122])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id 0A55E3F66F;
 Tue,  1 Sep 2020 13:19:04 -0700 (PDT)
To: Marek Szyprowski <m.szyprowski@samsung.com>,
 dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
References: <20200826063316.23486-1-m.szyprowski@samsung.com>
 <CGME20200826063629eucas1p194665c749b5a37c74e6445370fd7f7c4@eucas1p1.samsung.com>
 <20200826063316.23486-33-m.szyprowski@samsung.com>
From: Robin Murphy <robin.murphy@arm.com>
Message-ID: <02d07186-d97d-2309-9d9d-2f697112e7e0@arm.com>
Date: Tue, 1 Sep 2020 21:19:03 +0100
User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:68.0) Gecko/20100101
 Thunderbird/68.12.0
MIME-Version: 1.0
In-Reply-To: <20200826063316.23486-33-m.szyprowski@samsung.com>
Content-Language: en-GB
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Pawel Osciak <pawel@osciak.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, Tomasz Figa <tfiga@chromium.org>,
 Kyungmin Park <kyungmin.park@samsung.com>, Daniel Vetter <daniel@ffwll.ch>,
 Mauro Carvalho Chehab <mchehab@kernel.org>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org, linux-media@vger.kernel.org
Subject: Re: [Linaro-mm-sig] [PATCH v9 32/32] videobuf2: use sgtable-based
 scatterlist wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

T24gMjAyMC0wOC0yNiAwNzozMywgTWFyZWsgU3p5cHJvd3NraSB3cm90ZToKPiBVc2UgcmVjZW50
bHkgaW50cm9kdWNlZCBjb21tb24gd3JhcHBlcnMgb3BlcmF0aW5nIGRpcmVjdGx5IG9uIHRoZSBz
dHJ1Y3QKPiBzZ190YWJsZSBvYmplY3RzIGFuZCBzY2F0dGVybGlzdCBwYWdlIGl0ZXJhdG9ycyB0
byBtYWtlIHRoZSBjb2RlIGEgYml0Cj4gbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2llciB0byBm
b2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KPiAKPiBObyBmdW5jdGlvbmFsIGNoYW5nZSwgYmVj
YXVzZSB0aGUgY29kZSBhbHJlYWR5IHByb3Blcmx5IGRpZCBhbGwgdGhlCj4gc2NhdGVybGlzdCBy
ZWxhdGVkIGNhbGxzLgoKXl4gdHlwbwoKT3RoZXJ3aXNlLAoKUmV2aWV3ZWQtYnk6IFJvYmluIE11
cnBoeSA8cm9iaW4ubXVycGh5QGFybS5jb20+Cgo+IFNpZ25lZC1vZmYtYnk6IE1hcmVrIFN6eXBy
b3dza2kgPG0uc3p5cHJvd3NraUBzYW1zdW5nLmNvbT4KPiAtLS0KPiAgIC4uLi9jb21tb24vdmlk
ZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMgICB8IDM0ICsrKysrKysrLS0tLS0tLS0tLS0K
PiAgIC4uLi9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYyB8IDMyICsr
KysrKystLS0tLS0tLS0tCj4gICAuLi4vY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxv
Yy5jICAgICAgfCAxMiArKystLS0tCj4gICAzIGZpbGVzIGNoYW5nZWQsIDMxIGluc2VydGlvbnMo
KyksIDQ3IGRlbGV0aW9ucygtKQo+IAo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NvbW1v
bi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1jb250aWcuYyBiL2RyaXZlcnMvbWVkaWEvY29tbW9u
L3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCj4gaW5kZXggZWMzNDQ2Y2M0NWI4Li4x
YjI0MmQ4NDRkZGUgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYy
L3ZpZGVvYnVmMi1kbWEtY29udGlnLmMKPiArKysgYi9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRl
b2J1ZjIvdmlkZW9idWYyLWRtYS1jb250aWcuYwo+IEBAIC01OCwxMCArNTgsMTAgQEAgc3RhdGlj
IHVuc2lnbmVkIGxvbmcgdmIyX2RjX2dldF9jb250aWd1b3VzX3NpemUoc3RydWN0IHNnX3RhYmxl
ICpzZ3QpCj4gICAJdW5zaWduZWQgaW50IGk7Cj4gICAJdW5zaWduZWQgbG9uZyBzaXplID0gMDsK
PiAgIAo+IC0JZm9yX2VhY2hfc2coc2d0LT5zZ2wsIHMsIHNndC0+bmVudHMsIGkpIHsKPiArCWZv
cl9lYWNoX3NndGFibGVfZG1hX3NnKHNndCwgcywgaSkgewo+ICAgCQlpZiAoc2dfZG1hX2FkZHJl
c3MocykgIT0gZXhwZWN0ZWQpCj4gICAJCQlicmVhazsKPiAtCQlleHBlY3RlZCA9IHNnX2RtYV9h
ZGRyZXNzKHMpICsgc2dfZG1hX2xlbihzKTsKPiArCQlleHBlY3RlZCArPSBzZ19kbWFfbGVuKHMp
Owo+ICAgCQlzaXplICs9IHNnX2RtYV9sZW4ocyk7Cj4gICAJfQo+ICAgCXJldHVybiBzaXplOwo+
IEBAIC0xMDMsOCArMTAzLDcgQEAgc3RhdGljIHZvaWQgdmIyX2RjX3ByZXBhcmUodm9pZCAqYnVm
X3ByaXYpCj4gICAJaWYgKCFzZ3QpCj4gICAJCXJldHVybjsKPiAgIAo+IC0JZG1hX3N5bmNfc2df
Zm9yX2RldmljZShidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKPiAtCQkJICAg
ICAgIGJ1Zi0+ZG1hX2Rpcik7Cj4gKwlkbWFfc3luY19zZ3RhYmxlX2Zvcl9kZXZpY2UoYnVmLT5k
ZXYsIHNndCwgYnVmLT5kbWFfZGlyKTsKPiAgIH0KPiAgIAo+ICAgc3RhdGljIHZvaWQgdmIyX2Rj
X2ZpbmlzaCh2b2lkICpidWZfcHJpdikKPiBAQCAtMTE1LDcgKzExNCw3IEBAIHN0YXRpYyB2b2lk
IHZiMl9kY19maW5pc2godm9pZCAqYnVmX3ByaXYpCj4gICAJaWYgKCFzZ3QpCj4gICAJCXJldHVy
bjsKPiAgIAo+IC0JZG1hX3N5bmNfc2dfZm9yX2NwdShidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+
b3JpZ19uZW50cywgYnVmLT5kbWFfZGlyKTsKPiArCWRtYV9zeW5jX3NndGFibGVfZm9yX2NwdShi
dWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwo+ICAgfQo+ICAgCj4gICAvKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwo+IEBAIC0yNzUsOCArMjc0LDggQEAg
c3RhdGljIHZvaWQgdmIyX2RjX2RtYWJ1Zl9vcHNfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVm
LAo+ICAgCQkgKiBtZW1vcnkgbG9jYXRpb25zIGRvIG5vdCByZXF1aXJlIGFueSBleHBsaWNpdCBj
YWNoZQo+ICAgCQkgKiBtYWludGVuYW5jZSBwcmlvciBvciBhZnRlciBiZWluZyB1c2VkIGJ5IHRo
ZSBkZXZpY2UuCj4gICAJCSAqLwo+IC0JCWRtYV91bm1hcF9zZ19hdHRycyhkYl9hdHRhY2gtPmRl
diwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKPiAtCQkJCSAgIGF0dGFjaC0+ZG1hX2Rpciwg
RE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7Cj4gKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNo
LT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLAo+ICsJCQkJICBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKPiAgIAlzZ19mcmVlX3RhYmxlKHNndCk7Cj4gICAJa2ZyZWUoYXR0YWNoKTsKPiAgIAlk
Yl9hdHRhY2gtPnByaXYgPSBOVUxMOwo+IEBAIC0zMDEsOCArMzAwLDggQEAgc3RhdGljIHN0cnVj
dCBzZ190YWJsZSAqdmIyX2RjX2RtYWJ1Zl9vcHNfbWFwKAo+ICAgCj4gICAJLyogcmVsZWFzZSBh
bnkgcHJldmlvdXMgY2FjaGUgKi8KPiAgIAlpZiAoYXR0YWNoLT5kbWFfZGlyICE9IERNQV9OT05F
KSB7Cj4gLQkJZG1hX3VubWFwX3NnX2F0dHJzKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0
LT5vcmlnX25lbnRzLAo+IC0JCQkJICAgYXR0YWNoLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQ
VV9TWU5DKTsKPiArCQlkbWFfdW5tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRh
Y2gtPmRtYV9kaXIsCj4gKwkJCQkgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwo+ICAgCQlhdHRh
Y2gtPmRtYV9kaXIgPSBETUFfTk9ORTsKPiAgIAl9Cj4gICAKPiBAQCAtMzEwLDkgKzMwOSw4IEBA
IHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kY19kbWFidWZfb3BzX21hcCgKPiAgIAkgKiBt
YXBwaW5nIHRvIHRoZSBjbGllbnQgd2l0aCBuZXcgZGlyZWN0aW9uLCBubyBjYWNoZSBzeW5jCj4g
ICAJICogcmVxdWlyZWQgc2VlIGNvbW1lbnQgaW4gdmIyX2RjX2RtYWJ1Zl9vcHNfZGV0YWNoKCkK
PiAgIAkgKi8KPiAtCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnX2F0dHJzKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAo+IC0JCQkJICAgICAgZG1hX2RpciwgRE1BX0FU
VFJfU0tJUF9DUFVfU1lOQyk7Cj4gLQlpZiAoIXNndC0+bmVudHMpIHsKPiArCWlmIChkbWFfbWFw
X3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2RpciwKPiArCQkJICAgIERNQV9BVFRS
X1NLSVBfQ1BVX1NZTkMpKSB7Cj4gICAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBzY2F0dGVybGlz
dFxuIik7Cj4gICAJCW11dGV4X3VubG9jayhsb2NrKTsKPiAgIAkJcmV0dXJuIEVSUl9QVFIoLUVJ
Tyk7Cj4gQEAgLTQ1NSw4ICs0NTMsOCBAQCBzdGF0aWMgdm9pZCB2YjJfZGNfcHV0X3VzZXJwdHIo
dm9pZCAqYnVmX3ByaXYpCj4gICAJCSAqIE5vIG5lZWQgdG8gc3luYyB0byBDUFUsIGl0J3MgYWxy
ZWFkeSBzeW5jZWQgdG8gdGhlIENQVQo+ICAgCQkgKiBzaW5jZSB0aGUgZmluaXNoKCkgbWVtb3Ag
d2lsbCBoYXZlIGJlZW4gY2FsbGVkIGJlZm9yZSB0aGlzLgo+ICAgCQkgKi8KPiAtCQlkbWFfdW5t
YXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCj4gLQkJCQkg
ICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwo+ICsJCWRtYV91bm1hcF9z
Z3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKPiArCQkJCSAgRE1BX0FUVFJfU0tJ
UF9DUFVfU1lOQyk7Cj4gICAJCXBhZ2VzID0gZnJhbWVfdmVjdG9yX3BhZ2VzKGJ1Zi0+dmVjKTsK
PiAgIAkJLyogc2d0IHNob3VsZCBleGlzdCBvbmx5IGlmIHZlY3RvciBjb250YWlucyBwYWdlcy4u
LiAqLwo+ICAgCQlCVUdfT04oSVNfRVJSKHBhZ2VzKSk7Cj4gQEAgLTU1Myw5ICs1NTEsOCBAQCBz
dGF0aWMgdm9pZCAqdmIyX2RjX2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWdu
ZWQgbG9uZyB2YWRkciwKPiAgIAkgKiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwgdGhp
cyB3aWxsIGhhcHBlbiBsYXRlciB3aGVuIHRoZQo+ICAgCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBj
YWxsZWQuCj4gICAJICovCj4gLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZ19hdHRycyhidWYtPmRl
diwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKPiAtCQkJCSAgICAgIGJ1Zi0+ZG1hX2Rpciwg
RE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7Cj4gLQlpZiAoc2d0LT5uZW50cyA8PSAwKSB7Cj4gKwlp
ZiAoZG1hX21hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKPiArCQkJICAg
IERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpKSB7Cj4gICAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBz
Y2F0dGVybGlzdFxuIik7Cj4gICAJCXJldCA9IC1FSU87Cj4gICAJCWdvdG8gZmFpbF9zZ3RfaW5p
dDsKPiBAQCAtNTc3LDggKzU3NCw3IEBAIHN0YXRpYyB2b2lkICp2YjJfZGNfZ2V0X3VzZXJwdHIo
c3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIHZhZGRyLAo+ICAgCXJldHVybiBidWY7
Cj4gICAKPiAgIGZhaWxfbWFwX3NnOgo+IC0JZG1hX3VubWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBz
Z3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAo+IC0JCQkgICBidWYtPmRtYV9kaXIsIERNQV9BVFRS
X1NLSVBfQ1BVX1NZTkMpOwo+ICsJZG1hX3VubWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVm
LT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKPiAgIAo+ICAgZmFpbF9zZ3RfaW5p
dDoKPiAgIAlzZ19mcmVlX3RhYmxlKHNndCk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEv
Y29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMgYi9kcml2ZXJzL21lZGlhL2NvbW1v
bi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jCj4gaW5kZXggMGE0MGUwMGYwZDdlLi4wZGQz
YjE5MDI1ZTAgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3Zp
ZGVvYnVmMi1kbWEtc2cuYwo+ICsrKyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92
aWRlb2J1ZjItZG1hLXNnLmMKPiBAQCAtMTQ4LDkgKzE0OCw4IEBAIHN0YXRpYyB2b2lkICp2YjJf
ZG1hX3NnX2FsbG9jKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyBkbWFfYXR0cnMs
Cj4gICAJICogTm8gbmVlZCB0byBzeW5jIHRvIHRoZSBkZXZpY2UsIHRoaXMgd2lsbCBoYXBwZW4g
bGF0ZXIgd2hlbiB0aGUKPiAgIAkgKiBwcmVwYXJlKCkgbWVtb3AgaXMgY2FsbGVkLgo+ICAgCSAq
Lwo+IC0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBz
Z3QtPm9yaWdfbmVudHMsCj4gLQkJCQkgICAgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBf
Q1BVX1NZTkMpOwo+IC0JaWYgKCFzZ3QtPm5lbnRzKQo+ICsJaWYgKGRtYV9tYXBfc2d0YWJsZShi
dWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCj4gKwkJCSAgICBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKSkKPiAgIAkJZ290byBmYWlsX21hcDsKPiAgIAo+ICAgCWJ1Zi0+aGFuZGxlci5yZWZjb3Vu
dCA9ICZidWYtPnJlZmNvdW50Owo+IEBAIC0xODYsOCArMTg1LDggQEAgc3RhdGljIHZvaWQgdmIy
X2RtYV9zZ19wdXQodm9pZCAqYnVmX3ByaXYpCj4gICAJaWYgKHJlZmNvdW50X2RlY19hbmRfdGVz
dCgmYnVmLT5yZWZjb3VudCkpIHsKPiAgIAkJZHByaW50aygxLCAiJXM6IEZyZWVpbmcgYnVmZmVy
IG9mICVkIHBhZ2VzXG4iLCBfX2Z1bmNfXywKPiAgIAkJCWJ1Zi0+bnVtX3BhZ2VzKTsKPiAtCQlk
bWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCj4g
LQkJCQkgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwo+ICsJCWRtYV91
bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKPiArCQkJCSAgRE1BX0FU
VFJfU0tJUF9DUFVfU1lOQyk7Cj4gICAJCWlmIChidWYtPnZhZGRyKQo+ICAgCQkJdm1fdW5tYXBf
cmFtKGJ1Zi0+dmFkZHIsIGJ1Zi0+bnVtX3BhZ2VzKTsKPiAgIAkJc2dfZnJlZV90YWJsZShidWYt
PmRtYV9zZ3QpOwo+IEBAIC0yMDQsOCArMjAzLDcgQEAgc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19w
cmVwYXJlKHZvaWQgKmJ1Zl9wcml2KQo+ICAgCXN0cnVjdCB2YjJfZG1hX3NnX2J1ZiAqYnVmID0g
YnVmX3ByaXY7Cj4gICAJc3RydWN0IHNnX3RhYmxlICpzZ3QgPSBidWYtPmRtYV9zZ3Q7Cj4gICAK
PiAtCWRtYV9zeW5jX3NnX2Zvcl9kZXZpY2UoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdf
bmVudHMsCj4gLQkJCSAgICAgICBidWYtPmRtYV9kaXIpOwo+ICsJZG1hX3N5bmNfc2d0YWJsZV9m
b3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7Cj4gICB9Cj4gICAKPiAgIHN0
YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQo+IEBAIC0yMTMsNyAr
MjExLDcgQEAgc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19maW5pc2godm9pZCAqYnVmX3ByaXYpCj4g
ICAJc3RydWN0IHZiMl9kbWFfc2dfYnVmICpidWYgPSBidWZfcHJpdjsKPiAgIAlzdHJ1Y3Qgc2df
dGFibGUgKnNndCA9IGJ1Zi0+ZG1hX3NndDsKPiAgIAo+IC0JZG1hX3N5bmNfc2dfZm9yX2NwdShi
dWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywgYnVmLT5kbWFfZGlyKTsKPiArCWRt
YV9zeW5jX3NndGFibGVfZm9yX2NwdShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwo+ICAg
fQo+ICAgCj4gICBzdGF0aWMgdm9pZCAqdmIyX2RtYV9zZ19nZXRfdXNlcnB0cihzdHJ1Y3QgZGV2
aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgdmFkZHIsCj4gQEAgLTI1Niw5ICsyNTQsOCBAQCBzdGF0
aWMgdm9pZCAqdmIyX2RtYV9zZ19nZXRfdXNlcnB0cihzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2ln
bmVkIGxvbmcgdmFkZHIsCj4gICAJICogTm8gbmVlZCB0byBzeW5jIHRvIHRoZSBkZXZpY2UsIHRo
aXMgd2lsbCBoYXBwZW4gbGF0ZXIgd2hlbiB0aGUKPiAgIAkgKiBwcmVwYXJlKCkgbWVtb3AgaXMg
Y2FsbGVkLgo+ICAgCSAqLwo+IC0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5k
ZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCj4gLQkJCQkgICAgICBidWYtPmRtYV9kaXIs
IERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwo+IC0JaWYgKCFzZ3QtPm5lbnRzKQo+ICsJaWYgKGRt
YV9tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCj4gKwkJCSAgICBETUFf
QVRUUl9TS0lQX0NQVV9TWU5DKSkKPiAgIAkJZ290byB1c2VycHRyX2ZhaWxfbWFwOwo+ICAgCj4g
ICAJcmV0dXJuIGJ1ZjsKPiBAQCAtMjg0LDggKzI4MSw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFf
c2dfcHV0X3VzZXJwdHIodm9pZCAqYnVmX3ByaXYpCj4gICAKPiAgIAlkcHJpbnRrKDEsICIlczog
UmVsZWFzaW5nIHVzZXJzcGFjZSBidWZmZXIgb2YgJWQgcGFnZXNcbiIsCj4gICAJICAgICAgIF9f
ZnVuY19fLCBidWYtPm51bV9wYWdlcyk7Cj4gLQlkbWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5kZXYs
IHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2RpciwKPiAtCQkJICAgRE1BX0FU
VFJfU0tJUF9DUFVfU1lOQyk7Cj4gKwlkbWFfdW5tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBi
dWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwo+ICAgCWlmIChidWYtPnZhZGRy
KQo+ICAgCQl2bV91bm1hcF9yYW0oYnVmLT52YWRkciwgYnVmLT5udW1fcGFnZXMpOwo+ICAgCXNn
X2ZyZWVfdGFibGUoYnVmLT5kbWFfc2d0KTsKPiBAQCAtNDA4LDggKzQwNCw3IEBAIHN0YXRpYyB2
b2lkIHZiMl9kbWFfc2dfZG1hYnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCj4g
ICAKPiAgIAkvKiByZWxlYXNlIHRoZSBzY2F0dGVybGlzdCBjYWNoZSAqLwo+ICAgCWlmIChhdHRh
Y2gtPmRtYV9kaXIgIT0gRE1BX05PTkUpCj4gLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAo+IC0JCQlhdHRhY2gtPmRtYV9kaXIpOwo+ICsJ
CWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2Rpciwg
MCk7Cj4gICAJc2dfZnJlZV90YWJsZShzZ3QpOwo+ICAgCWtmcmVlKGF0dGFjaCk7Cj4gICAJZGJf
YXR0YWNoLT5wcml2ID0gTlVMTDsKPiBAQCAtNDM0LDE1ICs0MjksMTIgQEAgc3RhdGljIHN0cnVj
dCBzZ190YWJsZSAqdmIyX2RtYV9zZ19kbWFidWZfb3BzX21hcCgKPiAgIAo+ICAgCS8qIHJlbGVh
c2UgYW55IHByZXZpb3VzIGNhY2hlICovCj4gICAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFf
Tk9ORSkgewo+IC0JCWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+
b3JpZ19uZW50cywKPiAtCQkJYXR0YWNoLT5kbWFfZGlyKTsKPiArCQlkbWFfdW5tYXBfc2d0YWJs
ZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIsIDApOwo+ICAgCQlhdHRhY2gt
PmRtYV9kaXIgPSBETUFfTk9ORTsKPiAgIAl9Cj4gICAKPiAgIAkvKiBtYXBwaW5nIHRvIHRoZSBj
bGllbnQgd2l0aCBuZXcgZGlyZWN0aW9uICovCj4gLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZyhk
Yl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKPiAtCQkJCWRtYV9kaXIp
Owo+IC0JaWYgKCFzZ3QtPm5lbnRzKSB7Cj4gKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGRiX2F0dGFj
aC0+ZGV2LCBzZ3QsIGRtYV9kaXIsIDApKSB7Cj4gICAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBz
Y2F0dGVybGlzdFxuIik7Cj4gICAJCW11dGV4X3VubG9jayhsb2NrKTsKPiAgIAkJcmV0dXJuIEVS
Ul9QVFIoLUVJTyk7Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVm
Mi92aWRlb2J1ZjItdm1hbGxvYy5jIGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3Zp
ZGVvYnVmMi12bWFsbG9jLmMKPiBpbmRleCBjNjZmZGE0YTY1ZTQuLmJmNWFjNjNhNTc0MiAxMDA2
NDQKPiAtLS0gYS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLXZtYWxs
b2MuYwo+ICsrKyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1h
bGxvYy5jCj4gQEAgLTIyOSw3ICsyMjksNyBAQCBzdGF0aWMgaW50IHZiMl92bWFsbG9jX2RtYWJ1
Zl9vcHNfYXR0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVmLAo+ICAgCQlrZnJlZShhdHRhY2gpOwo+
ICAgCQlyZXR1cm4gcmV0Owo+ICAgCX0KPiAtCWZvcl9lYWNoX3NnKHNndC0+c2dsLCBzZywgc2d0
LT5uZW50cywgaSkgewo+ICsJZm9yX2VhY2hfc2d0YWJsZV9zZyhzZ3QsIHNnLCBpKSB7Cj4gICAJ
CXN0cnVjdCBwYWdlICpwYWdlID0gdm1hbGxvY190b19wYWdlKHZhZGRyKTsKPiAgIAo+ICAgCQlp
ZiAoIXBhZ2UpIHsKPiBAQCAtMjU5LDggKzI1OSw3IEBAIHN0YXRpYyB2b2lkIHZiMl92bWFsbG9j
X2RtYWJ1Zl9vcHNfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVmLAo+ICAgCj4gICAJLyogcmVs
ZWFzZSB0aGUgc2NhdHRlcmxpc3QgY2FjaGUgKi8KPiAgIAlpZiAoYXR0YWNoLT5kbWFfZGlyICE9
IERNQV9OT05FKQo+IC0JCWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNn
dC0+b3JpZ19uZW50cywKPiAtCQkJYXR0YWNoLT5kbWFfZGlyKTsKPiArCQlkbWFfdW5tYXBfc2d0
YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIsIDApOwo+ICAgCXNnX2Zy
ZWVfdGFibGUoc2d0KTsKPiAgIAlrZnJlZShhdHRhY2gpOwo+ICAgCWRiX2F0dGFjaC0+cHJpdiA9
IE5VTEw7Cj4gQEAgLTI4NSwxNSArMjg0LDEyIEBAIHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZi
Ml92bWFsbG9jX2RtYWJ1Zl9vcHNfbWFwKAo+ICAgCj4gICAJLyogcmVsZWFzZSBhbnkgcHJldmlv
dXMgY2FjaGUgKi8KPiAgIAlpZiAoYXR0YWNoLT5kbWFfZGlyICE9IERNQV9OT05FKSB7Cj4gLQkJ
ZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAo+
IC0JCQlhdHRhY2gtPmRtYV9kaXIpOwo+ICsJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+
ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwgMCk7Cj4gICAJCWF0dGFjaC0+ZG1hX2RpciA9IERN
QV9OT05FOwo+ICAgCX0KPiAgIAo+ICAgCS8qIG1hcHBpbmcgdG8gdGhlIGNsaWVudCB3aXRoIG5l
dyBkaXJlY3Rpb24gKi8KPiAtCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAo+IC0JCQkJZG1hX2Rpcik7Cj4gLQlpZiAoIXNn
dC0+bmVudHMpIHsKPiArCWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwg
ZG1hX2RpciwgMCkpIHsKPiAgIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4i
KTsKPiAgIAkJbXV0ZXhfdW5sb2NrKGxvY2spOwo+ICAgCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsK
PiAKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJv
LW1tLXNpZyBtYWlsaW5nIGxpc3QKTGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCmh0dHBz
Oi8vbGlzdHMubGluYXJvLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbmFyby1tbS1zaWcK
