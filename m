Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 885AC5227E9
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 11 May 2022 01:57:10 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id BA514480B8
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 10 May 2022 23:57:09 +0000 (UTC)
Received: from mail-yw1-f202.google.com (mail-yw1-f202.google.com [209.85.128.202])
	by lists.linaro.org (Postfix) with ESMTPS id 29B2E3ED52
	for <linaro-mm-sig@lists.linaro.org>; Tue, 10 May 2022 23:57:05 +0000 (UTC)
Received: by mail-yw1-f202.google.com with SMTP id 00721157ae682-2f7c5767f0fso3213377b3.4
        for <linaro-mm-sig@lists.linaro.org>; Tue, 10 May 2022 16:57:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=google.com; s=20210112;
        h=date:in-reply-to:message-id:mime-version:references:subject:from:to
         :cc:content-transfer-encoding;
        bh=wNfZpS1Ph0bCGjgLml9yBH3I6aG1qAbhk+0rc1ZP/hY=;
        b=m1tdinBInvIZUHU5JN8ycqjveEnO3YkgAIzQKbLrHFO+rIyratWnLSMd/kGnkUfYxk
         QFS/2sxqcTKfPU9D7Jan8j+W3sUE663CsF0y9eEANP3DjiMd1xLCBGOc76l47EOivEIc
         nnQjAGKyPasbtMCN+cHTSXayLOljIA9JwLJ/0w5tpYggjUtqZGRZWAqsRwx2rDPySXTX
         BOSDHRItyryrPr94KsXB6Df9No8XpxQVOB+yj0ELIMH3iRkb+eGxnDAmoPx14qfzwJAS
         jgoMOfoLuHXh1ShUSoUHz7WMbiAgGhN2lB6gEakFMZBsumeevB5jjXpyx9Nlem7NwE0t
         IhGw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=x-gm-message-state:date:in-reply-to:message-id:mime-version
         :references:subject:from:to:cc:content-transfer-encoding;
        bh=wNfZpS1Ph0bCGjgLml9yBH3I6aG1qAbhk+0rc1ZP/hY=;
        b=lUFKF7MWMJc1wOPn0AqoZ9rwufJSwq+FBgqA1XgbLHm5QRinofRJf6oONXZ75E82zK
         boxJ233AAsJTGaHNREbW/QfZGpCuO7rdWvdKsfOyuE1s+jtahrEsotwQ32ePw+5A52sk
         WUkSWe4jIW8PSPPjNsr2wSXhwcBofIMiI4CeviIxMJHViQcNAA6IwgByySGBZA4U/VPL
         Ey2HWg+IpWjFpkpNcPXvpRDoGKAuYC2HYh7lrGvyRv7p72bYqLj9lDJWQpVL/iYzqSLO
         25UEmmMKWDa2ZJkjETlWRk+ox09luE88bmgRIstNzylCAJP1JvXT0N8F2V8bSs405Z0g
         TYGg==
X-Gm-Message-State: AOAM530BQ69ERFLN4G8lm3vEKJugudF4hupf20aUqGCNWx8eBYZRNbiT
	cWA9dBRKdS01caEVYZXBRnQxy9cgjP5TSHo=
X-Google-Smtp-Source: ABdhPJxzdN7A8Vnn6rBrUXgMrzw73E3knQrmokxQfU7igRSDoyBhnjeXgirKX7Wm4wFIxWhyPcQgOh5qijErwe0=
X-Received: from tj.c.googlers.com ([fda3:e722:ac3:cc00:20:ed76:c0a8:53a])
 (user=tjmercier job=sendgmr) by 2002:a81:b044:0:b0:2d6:bd1f:5d8b with SMTP id
 x4-20020a81b044000000b002d6bd1f5d8bmr22265953ywk.27.1652227024764; Tue, 10
 May 2022 16:57:04 -0700 (PDT)
Date: Tue, 10 May 2022 23:56:47 +0000
In-Reply-To: <20220510235653.933868-1-tjmercier@google.com>
Message-Id: <20220510235653.933868-4-tjmercier@google.com>
Mime-Version: 1.0
References: <20220510235653.933868-1-tjmercier@google.com>
X-Mailer: git-send-email 2.36.0.512.ge40c2bad7a-goog
From: "T.J. Mercier" <tjmercier@google.com>
To: tjmercier@google.com, Sumit Semwal <sumit.semwal@linaro.org>,
	"=?UTF-8?q?Christian=20K=C3=B6nig?=" <christian.koenig@amd.com>,
	Benjamin Gaignard <benjamin.gaignard@collabora.com>, Liam Mark <lmark@codeaurora.org>,
	Laura Abbott <labbott@redhat.com>, Brian Starkey <Brian.Starkey@arm.com>,
	John Stultz <john.stultz@linaro.org>
Message-ID-Hash: O5C5P4XSBZZ2KSD5XJD566PUI5GTOW2W
X-Message-ID-Hash: O5C5P4XSBZZ2KSD5XJD566PUI5GTOW2W
X-MailFrom: 30Pt6YgkKDc0C25xAv1xAz77z4x.v75416tA7-55-B1z41BCB.416tA7.7Az@flex--tjmercier.bounces.google.com
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: daniel@ffwll.ch, tj@kernel.org, hridya@google.com, jstultz@google.com, tkjos@android.com, cmllamas@google.com, surenb@google.com, kaleshsingh@google.com, Kenny.Ho@amd.com, mkoutny@suse.com, skhan@linuxfoundation.org, kernel-team@android.com, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH v7 3/6] dmabuf: heaps: export system_heap buffers with GPU cgroup charging
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/O5C5P4XSBZZ2KSD5XJD566PUI5GTOW2W/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

QWxsIERNQSBoZWFwcyBub3cgcmVnaXN0ZXIgYSBuZXcgR1BVIGNncm91cCBidWNrZXQgdXBvbiBj
cmVhdGlvbiwgYW5kIHRoZQ0Kc3lzdGVtX2hlYXAgbm93IGV4cG9ydHMgYnVmZmVycyBhc3NvY2lh
dGVkIHdpdGggaXRzIEdQVSBjZ3JvdXAgYnVja2V0IGZvcg0KdHJhY2tpbmcgcHVycG9zZXMuDQoN
CkluIG9yZGVyIHRvIHN1cHBvcnQgR1BVIGNncm91cCBjaGFyZ2UgdHJhbnNmZXIgb24gYSBkbWEt
YnVmLCB0aGUgY3VycmVudA0KR1BVIGNncm91cCBpbmZvcm1hdGlvbiBtdXN0IGJlIHN0b3JlZCBp
bnNpZGUgdGhlIGRtYS1idWYgc3RydWN0LiBGb3INCnRyYWNrZWQgYnVmZmVycywgZXhwb3J0ZXJz
IGluY2x1ZGUgdGhlIHN0cnVjdCBncHVjZyBhbmQgc3RydWN0DQpncHVjZ19idWNrZXQgcG9pbnRl
cnMgaW4gdGhlIGV4cG9ydCBpbmZvIHdoaWNoIGNhbiBsYXRlciBiZSBtb2RpZmllZCBpZg0KdGhl
IGNoYXJnZSBpcyBtaWdyYXRlZCB0byBhbm90aGVyIGNncm91cC4NCg0KU2lnbmVkLW9mZi1ieTog
SHJpZHlhIFZhbHNhcmFqdSA8aHJpZHlhQGdvb2dsZS5jb20+DQpTaWduZWQtb2ZmLWJ5OiBULkou
IE1lcmNpZXIgPHRqbWVyY2llckBnb29nbGUuY29tPg0KLS0tDQp2NyBjaGFuZ2VzDQpBZGFwdCB0
byBuZXcgZ3B1Y2dfcmVnaXN0ZXJfYnVja2V0IEFQSS4NCg0KdjUgY2hhbmdlcw0KTWVyZ2UgZG1h
YnVmOiBVc2UgdGhlIEdQVSBjZ3JvdXAgY2hhcmdlL3VuY2hhcmdlIEFQSXMgaW50byB0aGlzIHBh
dGNoLg0KDQpSZW1vdmUgYWxsIEdQVSBjZ3JvdXAgY29kZSBmcm9tIGRtYS1idWYgZXhjZXB0IHdo
YXQncyBuZWNlc3NhcnkgdG8gc3VwcG9ydA0KY2hhcmdlIHRyYW5zZmVyLiBQcmV2aW91c2x5IGNo
YXJnaW5nIHdhcyBkb25lIGluIGV4cG9ydCwgYnV0IGZvcg0Kbm9uLUFuZHJvaWQgZ3JhcGhpY3Mg
dXNlLWNhc2VzIHRoaXMgaXMgbm90IGlkZWFsIHNpbmNlIHRoZXJlIG1heSBiZSBhDQpkZWFseSBi
ZXR3ZWVuIGFsbG9jYXRpb24gYW5kIGV4cG9ydCwgZHVyaW5nIHdoaWNoIHRpbWUgdGhlcmUgaXMg
bm8NCmFjY291bnRpbmcuDQoNCkFwcGVuZCAiLWhlYXAiIHRvIGdwdWNnX2J1Y2tldCBuYW1lcy4N
Cg0KQ2hhcmdlIG9uIGFsbG9jYXRpb24gaW5zdGVhZCBvZiBleHBvcnQuIFRoaXMgc2hvdWxkIG1v
cmUgY2xvc2VseSBtaXJyb3INCm5vbi1BbmRyb2lkIHVzZS1jYXNlcyB3aGVyZSB0aGVyZSBpcyBw
b3RlbnRpYWxseSBhIGRlbGF5IGJldHdlZW4gYWxsb2NhdGlvbg0KYW5kIGV4cG9ydC4NCg0KUHV0
IHRoZSBjaGFyZ2UgYW5kIHVuY2hhcmdlIGNvZGUgaW4gdGhlIHNhbWUgZmlsZSAoc3lzdGVtX2hl
YXBfYWxsb2NhdGUsDQpzeXN0ZW1faGVhcF9kbWFfYnVmX3JlbGVhc2UpIGluc3RlYWQgb2Ygc3Bs
aXR0aW5nIHRoZW0gYmV0d2VlbiB0aGUgaGVhcCBhbmQNCnRoZSBkbWFfYnVmX3JlbGVhc2UuDQoN
Ck1vdmUgbm8tb3AgY29kZSB0byBoZWFkZXIgZmlsZSB0byBtYXRjaCBvdGhlciBmaWxlcyBpbiB0
aGUgc2VyaWVzLg0KDQp2MyBjaGFuZ2VzDQpVc2UgbW9yZSBjb21tb24gZHVhbCBhdXRob3IgY29t
bWl0IG1lc3NhZ2UgZm9ybWF0IHBlciBKb2huIFN0dWx0ei4NCg0KdjIgY2hhbmdlcw0KTW92ZSBk
bWEtYnVmIGNncm91cCBjaGFyZ2UgdHJhbnNmZXIgZnJvbSBhIGRtYV9idWZfb3AgZGVmaW5lZCBi
eSBldmVyeQ0KaGVhcCB0byBhIHNpbmdsZSBkbWEtYnVmIGZ1bmN0aW9uIGZvciBhbGwgaGVhcHMg
cGVyIERhbmllbCBWZXR0ZXIgYW5kDQpDaHJpc3RpYW4gS8O2bmlnLg0KLS0tDQogZHJpdmVycy9k
bWEtYnVmL2RtYS1idWYuYyAgICAgICAgICAgfCAxOSArKysrKysrKysrKysrDQogZHJpdmVycy9k
bWEtYnVmL2RtYS1oZWFwLmMgICAgICAgICAgfCAzOCArKysrKysrKysrKysrKysrKysrKysrKysr
Kw0KIGRyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVhcC5jIHwgMjggKysrKysrKysrKysr
KysrKystLS0NCiBpbmNsdWRlL2xpbnV4L2RtYS1idWYuaCAgICAgICAgICAgICB8IDQxICsrKysr
KysrKysrKysrKysrKysrKysrLS0tLS0tDQogaW5jbHVkZS9saW51eC9kbWEtaGVhcC5oICAgICAg
ICAgICAgfCAxNSArKysrKysrKysrKw0KIDUgZmlsZXMgY2hhbmdlZCwgMTI5IGluc2VydGlvbnMo
KyksIDEyIGRlbGV0aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2RtYS1i
dWYuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMNCmluZGV4IGRmMjMyMzliMDRmYy4uYmM4
OWM0NGJkOWI5IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYw0KKysrIGIv
ZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYw0KQEAgLTQ2Miw2ICs0NjIsMjQgQEAgc3RhdGljIHN0
cnVjdCBmaWxlICpkbWFfYnVmX2dldGZpbGUoc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwgaW50IGZs
YWdzKQ0KICAqICZkbWFfYnVmX29wcy4NCiAgKi8NCiANCisjaWZkZWYgQ09ORklHX0NHUk9VUF9H
UFUNCitzdGF0aWMgdm9pZCBkbWFfYnVmX3NldF9ncHVjZyhzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVm
LCBjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwKQ0KK3sNCisJZG1hYnVmLT5n
cHVjZyA9IGV4cC0+Z3B1Y2c7DQorCWRtYWJ1Zi0+Z3B1Y2dfYnVja2V0ID0gZXhwLT5ncHVjZ19i
dWNrZXQ7DQorfQ0KKw0KK3ZvaWQgZG1hX2J1Zl9leHBfaW5mb19zZXRfZ3B1Y2coc3RydWN0IGRt
YV9idWZfZXhwb3J0X2luZm8gKmV4cF9pbmZvLA0KKwkJCQlzdHJ1Y3QgZ3B1Y2cgKmdwdWNnLA0K
KwkJCQlzdHJ1Y3QgZ3B1Y2dfYnVja2V0ICpncHVjZ19idWNrZXQpDQorew0KKwlleHBfaW5mby0+
Z3B1Y2cgPSBncHVjZzsNCisJZXhwX2luZm8tPmdwdWNnX2J1Y2tldCA9IGdwdWNnX2J1Y2tldDsN
Cit9DQorI2Vsc2UNCitzdGF0aWMgdm9pZCBkbWFfYnVmX3NldF9ncHVjZyhzdHJ1Y3QgZG1hX2J1
ZiAqZG1hYnVmLCBzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwKSB7fQ0KKyNlbmRpZg0K
Kw0KIC8qKg0KICAqIGRtYV9idWZfZXhwb3J0IC0gQ3JlYXRlcyBhIG5ldyBkbWFfYnVmLCBhbmQg
YXNzb2NpYXRlcyBhbiBhbm9uIGZpbGUNCiAgKiB3aXRoIHRoaXMgYnVmZmVyLCBzbyBpdCBjYW4g
YmUgZXhwb3J0ZWQuDQpAQCAtNTI3LDYgKzU0NSw3IEBAIHN0cnVjdCBkbWFfYnVmICpkbWFfYnVm
X2V4cG9ydChjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwX2luZm8pDQogCWlu
aXRfd2FpdHF1ZXVlX2hlYWQoJmRtYWJ1Zi0+cG9sbCk7DQogCWRtYWJ1Zi0+Y2JfaW4ucG9sbCA9
IGRtYWJ1Zi0+Y2Jfb3V0LnBvbGwgPSAmZG1hYnVmLT5wb2xsOw0KIAlkbWFidWYtPmNiX2luLmFj
dGl2ZSA9IGRtYWJ1Zi0+Y2Jfb3V0LmFjdGl2ZSA9IDA7DQorCWRtYV9idWZfc2V0X2dwdWNnKGRt
YWJ1ZiwgZXhwX2luZm8pOw0KIA0KIAlpZiAoIXJlc3YpIHsNCiAJCXJlc3YgPSAoc3RydWN0IGRt
YV9yZXN2ICopJmRtYWJ1ZlsxXTsNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLWhl
YXAuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtaGVhcC5jDQppbmRleCA4ZjU4NDhhYTE0NGYuLjQ4
MTczYTY2ZDcwZCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtaGVhcC5jDQorKysg
Yi9kcml2ZXJzL2RtYS1idWYvZG1hLWhlYXAuYw0KQEAgLTcsMTAgKzcsMTIgQEANCiAgKi8NCiAN
CiAjaW5jbHVkZSA8bGludXgvY2Rldi5oPg0KKyNpbmNsdWRlIDxsaW51eC9jZ3JvdXBfZ3B1Lmg+
DQogI2luY2x1ZGUgPGxpbnV4L2RlYnVnZnMuaD4NCiAjaW5jbHVkZSA8bGludXgvZGV2aWNlLmg+
DQogI2luY2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4NCiAjaW5jbHVkZSA8bGludXgvZXJyLmg+DQor
I2luY2x1ZGUgPGxpbnV4L2tjb25maWcuaD4NCiAjaW5jbHVkZSA8bGludXgveGFycmF5Lmg+DQog
I2luY2x1ZGUgPGxpbnV4L2xpc3QuaD4NCiAjaW5jbHVkZSA8bGludXgvc2xhYi5oPg0KQEAgLTIx
LDYgKzIzLDcgQEANCiAjaW5jbHVkZSA8dWFwaS9saW51eC9kbWEtaGVhcC5oPg0KIA0KICNkZWZp
bmUgREVWTkFNRSAiZG1hX2hlYXAiDQorI2RlZmluZSBIRUFQX05BTUVfU1VGRklYICItaGVhcCIN
CiANCiAjZGVmaW5lIE5VTV9IRUFQX01JTk9SUyAxMjgNCiANCkBAIC0zMSw2ICszNCw3IEBADQog
ICogQGhlYXBfZGV2dAkJaGVhcCBkZXZpY2Ugbm9kZQ0KICAqIEBsaXN0CQlsaXN0IGhlYWQgY29u
bmVjdGluZyB0byBsaXN0IG9mIGhlYXBzDQogICogQGhlYXBfY2RldgkJaGVhcCBjaGFyIGRldmlj
ZQ0KKyAqIEBncHVjZ19idWNrZXQJZ3B1IGNncm91cCBidWNrZXQgZm9yIG1lbW9yeSBhY2NvdW50
aW5nDQogICoNCiAgKiBSZXByZXNlbnRzIGEgaGVhcCBvZiBtZW1vcnkgZnJvbSB3aGljaCBidWZm
ZXJzIGNhbiBiZSBtYWRlLg0KICAqLw0KQEAgLTQxLDYgKzQ1LDkgQEAgc3RydWN0IGRtYV9oZWFw
IHsNCiAJZGV2X3QgaGVhcF9kZXZ0Ow0KIAlzdHJ1Y3QgbGlzdF9oZWFkIGxpc3Q7DQogCXN0cnVj
dCBjZGV2IGhlYXBfY2RldjsNCisjaWZkZWYgQ09ORklHX0NHUk9VUF9HUFUNCisJc3RydWN0IGdw
dWNnX2J1Y2tldCAqZ3B1Y2dfYnVja2V0Ow0KKyNlbmRpZg0KIH07DQogDQogc3RhdGljIExJU1Rf
SEVBRChoZWFwX2xpc3QpOw0KQEAgLTIxNiw2ICsyMjMsMTggQEAgY29uc3QgY2hhciAqZG1hX2hl
YXBfZ2V0X25hbWUoc3RydWN0IGRtYV9oZWFwICpoZWFwKQ0KIAlyZXR1cm4gaGVhcC0+bmFtZTsN
CiB9DQogDQorLyoqDQorICogZG1hX2hlYXBfZ2V0X2dwdWNnX2J1Y2tldCgpIC0gZ2V0IHN0cnVj
dCBncHVjZ19idWNrZXQgcG9pbnRlciBmb3IgdGhlIGhlYXAuDQorICogQGhlYXA6IERNQS1IZWFw
IHRvIGdldCB0aGUgZ3B1Y2dfYnVja2V0IHN0cnVjdCBmb3IuDQorICoNCisgKiBSZXR1cm5zOg0K
KyAqIFRoZSBncHVjZ19idWNrZXQgc3RydWN0IHBvaW50ZXIgZm9yIHRoZSBoZWFwLiBOVUxMIGlm
IHRoZSBHUFUgY2dyb3VwIGNvbnRyb2xsZXIgaXMgbm90IGVuYWJsZWQuDQorICovDQorc3RydWN0
IGdwdWNnX2J1Y2tldCAqZG1hX2hlYXBfZ2V0X2dwdWNnX2J1Y2tldChzdHJ1Y3QgZG1hX2hlYXAg
KmhlYXApDQorew0KKwlyZXR1cm4gaGVhcC0+Z3B1Y2dfYnVja2V0Ow0KK30NCisNCiBzdHJ1Y3Qg
ZG1hX2hlYXAgKmRtYV9oZWFwX2FkZChjb25zdCBzdHJ1Y3QgZG1hX2hlYXBfZXhwb3J0X2luZm8g
KmV4cF9pbmZvKQ0KIHsNCiAJc3RydWN0IGRtYV9oZWFwICpoZWFwLCAqaCwgKmVycl9yZXQ7DQpA
QCAtMjI4LDYgKzI0NywxMiBAQCBzdHJ1Y3QgZG1hX2hlYXAgKmRtYV9oZWFwX2FkZChjb25zdCBz
dHJ1Y3QgZG1hX2hlYXBfZXhwb3J0X2luZm8gKmV4cF9pbmZvKQ0KIAkJcmV0dXJuIEVSUl9QVFIo
LUVJTlZBTCk7DQogCX0NCiANCisJaWYgKElTX0VOQUJMRUQoQ09ORklHX0NHUk9VUF9HUFUpICYm
IHN0cmxlbihleHBfaW5mby0+bmFtZSkgKyBzdHJsZW4oSEVBUF9OQU1FX1NVRkZJWCkgPj0NCisJ
CUdQVUNHX0JVQ0tFVF9OQU1FX01BWF9MRU4pIHsNCisJCXByX2VycigiZG1hX2hlYXA6IE5hbWUg
aXMgdG9vIGxvbmcgZm9yIEdQVSBjZ3JvdXBcbiIpOw0KKwkJcmV0dXJuIEVSUl9QVFIoLUVOQU1F
VE9PTE9ORyk7DQorCX0NCisNCiAJaWYgKCFleHBfaW5mby0+b3BzIHx8ICFleHBfaW5mby0+b3Bz
LT5hbGxvY2F0ZSkgew0KIAkJcHJfZXJyKCJkbWFfaGVhcDogQ2Fubm90IGFkZCBoZWFwIHdpdGgg
aW52YWxpZCBvcHMgc3RydWN0XG4iKTsNCiAJCXJldHVybiBFUlJfUFRSKC1FSU5WQUwpOw0KQEAg
LTI1Myw2ICsyNzgsMTkgQEAgc3RydWN0IGRtYV9oZWFwICpkbWFfaGVhcF9hZGQoY29uc3Qgc3Ry
dWN0IGRtYV9oZWFwX2V4cG9ydF9pbmZvICpleHBfaW5mbykNCiAJaGVhcC0+b3BzID0gZXhwX2lu
Zm8tPm9wczsNCiAJaGVhcC0+cHJpdiA9IGV4cF9pbmZvLT5wcml2Ow0KIA0KKwlpZiAoSVNfRU5B
QkxFRChDT05GSUdfQ0dST1VQX0dQVSkpIHsNCisJCWNoYXIgZ3B1Y2dfYnVja2V0X25hbWVbR1BV
Q0dfQlVDS0VUX05BTUVfTUFYX0xFTl07DQorDQorCQlzbnByaW50ZihncHVjZ19idWNrZXRfbmFt
ZSwgc2l6ZW9mKGdwdWNnX2J1Y2tldF9uYW1lKSwgIiVzJXMiLA0KKwkJCSBleHBfaW5mby0+bmFt
ZSwgSEVBUF9OQU1FX1NVRkZJWCk7DQorDQorCQloZWFwLT5ncHVjZ19idWNrZXQgPSBncHVjZ19y
ZWdpc3Rlcl9idWNrZXQoZ3B1Y2dfYnVja2V0X25hbWUpOw0KKwkJaWYgKElTX0VSUihoZWFwLT5n
cHVjZ19idWNrZXQpKSB7DQorCQkJZXJyX3JldCA9IEVSUl9DQVNUKGhlYXAtPmdwdWNnX2J1Y2tl
dCk7DQorCQkJZ290byBlcnIwOw0KKwkJfQ0KKwl9DQorDQogCS8qIEZpbmQgdW51c2VkIG1pbm9y
IG51bWJlciAqLw0KIAlyZXQgPSB4YV9hbGxvYygmZG1hX2hlYXBfbWlub3JzLCAmbWlub3IsIGhl
YXAsDQogCQkgICAgICAgWEFfTElNSVQoMCwgTlVNX0hFQVBfTUlOT1JTIC0gMSksIEdGUF9LRVJO
RUwpOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVhcC5jIGIv
ZHJpdmVycy9kbWEtYnVmL2hlYXBzL3N5c3RlbV9oZWFwLmMNCmluZGV4IGZjZjgzNmJhOWMxZi4u
MjdmNjg2ZmFlZjAwIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9kbWEtYnVmL2hlYXBzL3N5c3RlbV9o
ZWFwLmMNCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9oZWFwcy9zeXN0ZW1faGVhcC5jDQpAQCAtMjk3
LDYgKzI5NywxMSBAQCBzdGF0aWMgdm9pZCBzeXN0ZW1faGVhcF9kbWFfYnVmX3JlbGVhc2Uoc3Ry
dWN0IGRtYV9idWYgKmRtYWJ1ZikNCiAJfQ0KIAlzZ19mcmVlX3RhYmxlKHRhYmxlKTsNCiAJa2Zy
ZWUoYnVmZmVyKTsNCisNCisJaWYgKGRtYWJ1Zi0+Z3B1Y2cgJiYgZG1hYnVmLT5ncHVjZ19idWNr
ZXQpIHsNCisJCWdwdWNnX3VuY2hhcmdlKGRtYWJ1Zi0+Z3B1Y2csIGRtYWJ1Zi0+Z3B1Y2dfYnVj
a2V0LCBkbWFidWYtPnNpemUpOw0KKwkJZ3B1Y2dfcHV0KGRtYWJ1Zi0+Z3B1Y2cpOw0KKwl9DQog
fQ0KIA0KIHN0YXRpYyBjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9vcHMgc3lzdGVtX2hlYXBfYnVmX29w
cyA9IHsNCkBAIC0zNDYsMTEgKzM1MSwyMSBAQCBzdGF0aWMgc3RydWN0IGRtYV9idWYgKnN5c3Rl
bV9oZWFwX2FsbG9jYXRlKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCwNCiAJc3RydWN0IHNjYXR0ZXJs
aXN0ICpzZzsNCiAJc3RydWN0IGxpc3RfaGVhZCBwYWdlczsNCiAJc3RydWN0IHBhZ2UgKnBhZ2Us
ICp0bXBfcGFnZTsNCi0JaW50IGksIHJldCA9IC1FTk9NRU07DQorCXN0cnVjdCBncHVjZyAqZ3B1
Y2c7DQorCXN0cnVjdCBncHVjZ19idWNrZXQgKmdwdWNnX2J1Y2tldDsNCisJaW50IGksIHJldDsN
CisNCisJZ3B1Y2cgPSBncHVjZ19nZXQoY3VycmVudCk7DQorCWdwdWNnX2J1Y2tldCA9IGRtYV9o
ZWFwX2dldF9ncHVjZ19idWNrZXQoaGVhcCk7DQorCXJldCA9IGdwdWNnX2NoYXJnZShncHVjZywg
Z3B1Y2dfYnVja2V0LCBsZW4pOw0KKwlpZiAocmV0KQ0KKwkJZ290byBwdXRfZ3B1Y2c7DQogDQog
CWJ1ZmZlciA9IGt6YWxsb2Moc2l6ZW9mKCpidWZmZXIpLCBHRlBfS0VSTkVMKTsNCi0JaWYgKCFi
dWZmZXIpDQotCQlyZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsNCisJaWYgKCFidWZmZXIpIHsNCisJ
CXJldCA9IC1FTk9NRU07DQorCQlnb3RvIHVuY2hhcmdlX2dwdWNnOw0KKwl9DQogDQogCUlOSVRf
TElTVF9IRUFEKCZidWZmZXItPmF0dGFjaG1lbnRzKTsNCiAJbXV0ZXhfaW5pdCgmYnVmZmVyLT5s
b2NrKTsNCkBAIC0zOTYsNiArNDExLDggQEAgc3RhdGljIHN0cnVjdCBkbWFfYnVmICpzeXN0ZW1f
aGVhcF9hbGxvY2F0ZShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXAsDQogCWV4cF9pbmZvLnNpemUgPSBi
dWZmZXItPmxlbjsNCiAJZXhwX2luZm8uZmxhZ3MgPSBmZF9mbGFnczsNCiAJZXhwX2luZm8ucHJp
diA9IGJ1ZmZlcjsNCisJZG1hX2J1Zl9leHBfaW5mb19zZXRfZ3B1Y2coJmV4cF9pbmZvLCBncHVj
ZywgZ3B1Y2dfYnVja2V0KTsNCisNCiAJZG1hYnVmID0gZG1hX2J1Zl9leHBvcnQoJmV4cF9pbmZv
KTsNCiAJaWYgKElTX0VSUihkbWFidWYpKSB7DQogCQlyZXQgPSBQVFJfRVJSKGRtYWJ1Zik7DQpA
QCAtNDE0LDcgKzQzMSwxMCBAQCBzdGF0aWMgc3RydWN0IGRtYV9idWYgKnN5c3RlbV9oZWFwX2Fs
bG9jYXRlKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCwNCiAJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZl
KHBhZ2UsIHRtcF9wYWdlLCAmcGFnZXMsIGxydSkNCiAJCV9fZnJlZV9wYWdlcyhwYWdlLCBjb21w
b3VuZF9vcmRlcihwYWdlKSk7DQogCWtmcmVlKGJ1ZmZlcik7DQotDQordW5jaGFyZ2VfZ3B1Y2c6
DQorCWdwdWNnX3VuY2hhcmdlKGdwdWNnLCBncHVjZ19idWNrZXQsIGxlbik7DQorcHV0X2dwdWNn
Og0KKwlncHVjZ19wdXQoZ3B1Y2cpOw0KIAlyZXR1cm4gRVJSX1BUUihyZXQpOw0KIH0NCiANCmRp
ZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaCBiL2luY2x1ZGUvbGludXgvZG1hLWJ1
Zi5oDQppbmRleCAyMDk3NzYwZThlOTUuLjhlN2M1NWM4MzBiMyAxMDA2NDQNCi0tLSBhL2luY2x1
ZGUvbGludXgvZG1hLWJ1Zi5oDQorKysgYi9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaA0KQEAgLTEz
LDYgKzEzLDcgQEANCiAjaWZuZGVmIF9fRE1BX0JVRl9IX18NCiAjZGVmaW5lIF9fRE1BX0JVRl9I
X18NCiANCisjaW5jbHVkZSA8bGludXgvY2dyb3VwX2dwdS5oPg0KICNpbmNsdWRlIDxsaW51eC9p
b3N5cy1tYXAuaD4NCiAjaW5jbHVkZSA8bGludXgvZmlsZS5oPg0KICNpbmNsdWRlIDxsaW51eC9l
cnIuaD4NCkBAIC0zMDMsNyArMzA0LDcgQEAgc3RydWN0IGRtYV9idWYgew0KIAkvKioNCiAJICog
QHNpemU6DQogCSAqDQotCSAqIFNpemUgb2YgdGhlIGJ1ZmZlcjsgaW52YXJpYW50IG92ZXIgdGhl
IGxpZmV0aW1lIG9mIHRoZSBidWZmZXIuDQorCSAqIFNpemUgb2YgdGhlIGJ1ZmZlciBpbiBieXRl
czsgaW52YXJpYW50IG92ZXIgdGhlIGxpZmV0aW1lIG9mIHRoZSBidWZmZXIuDQogCSAqLw0KIAlz
aXplX3Qgc2l6ZTsNCiANCkBAIC00NTMsNiArNDU0LDE0IEBAIHN0cnVjdCBkbWFfYnVmIHsNCiAJ
CXN0cnVjdCBkbWFfYnVmICpkbWFidWY7DQogCX0gKnN5c2ZzX2VudHJ5Ow0KICNlbmRpZg0KKw0K
KyNpZmRlZiBDT05GSUdfQ0dST1VQX0dQVQ0KKwkvKiogQGdwdWNnOiBQb2ludGVyIHRvIHRoZSBH
UFUgY2dyb3VwIHRoaXMgYnVmZmVyIGN1cnJlbnRseSBiZWxvbmdzIHRvLiAqLw0KKwlzdHJ1Y3Qg
Z3B1Y2cgKmdwdWNnOw0KKw0KKwkvKiBAZ3B1Y2dfYnVja2V0OiBQb2ludGVyIHRvIHRoZSBHUFUg
Y2dyb3VwIGJ1Y2tldCB3aGVuY2UgdGhpcyBidWZmZXIgb3JpZ2luYXRlcy4gKi8NCisJc3RydWN0
IGdwdWNnX2J1Y2tldCAqZ3B1Y2dfYnVja2V0Ow0KKyNlbmRpZg0KIH07DQogDQogLyoqDQpAQCAt
NTI2LDEzICs1MzUsMTUgQEAgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCB7DQogDQogLyoqDQog
ICogc3RydWN0IGRtYV9idWZfZXhwb3J0X2luZm8gLSBob2xkcyBpbmZvcm1hdGlvbiBuZWVkZWQg
dG8gZXhwb3J0IGEgZG1hX2J1Zg0KLSAqIEBleHBfbmFtZToJbmFtZSBvZiB0aGUgZXhwb3J0ZXIg
LSB1c2VmdWwgZm9yIGRlYnVnZ2luZy4NCi0gKiBAb3duZXI6CXBvaW50ZXIgdG8gZXhwb3J0ZXIg
bW9kdWxlIC0gdXNlZCBmb3IgcmVmY291bnRpbmcga2VybmVsIG1vZHVsZQ0KLSAqIEBvcHM6CUF0
dGFjaCBhbGxvY2F0b3ItZGVmaW5lZCBkbWEgYnVmIG9wcyB0byB0aGUgbmV3IGJ1ZmZlcg0KLSAq
IEBzaXplOglTaXplIG9mIHRoZSBidWZmZXIgLSBpbnZhcmlhbnQgb3ZlciB0aGUgbGlmZXRpbWUg
b2YgdGhlIGJ1ZmZlcg0KLSAqIEBmbGFnczoJbW9kZSBmbGFncyBmb3IgdGhlIGZpbGUNCi0gKiBA
cmVzdjoJcmVzZXJ2YXRpb24tb2JqZWN0LCBOVUxMIHRvIGFsbG9jYXRlIGRlZmF1bHQgb25lDQot
ICogQHByaXY6CUF0dGFjaCBwcml2YXRlIGRhdGEgb2YgYWxsb2NhdG9yIHRvIHRoaXMgYnVmZmVy
DQorICogQGV4cF9uYW1lOgkJbmFtZSBvZiB0aGUgZXhwb3J0ZXIgLSB1c2VmdWwgZm9yIGRlYnVn
Z2luZy4NCisgKiBAb3duZXI6CQlwb2ludGVyIHRvIGV4cG9ydGVyIG1vZHVsZSAtIHVzZWQgZm9y
IHJlZmNvdW50aW5nIGtlcm5lbCBtb2R1bGUNCisgKiBAb3BzOgkJQXR0YWNoIGFsbG9jYXRvci1k
ZWZpbmVkIGRtYSBidWYgb3BzIHRvIHRoZSBuZXcgYnVmZmVyDQorICogQHNpemU6CQlTaXplIG9m
IHRoZSBidWZmZXIgaW4gYnl0ZXMgLSBpbnZhcmlhbnQgb3ZlciB0aGUgbGlmZXRpbWUgb2YgdGhl
IGJ1ZmZlcg0KKyAqIEBmbGFnczoJCW1vZGUgZmxhZ3MgZm9yIHRoZSBmaWxlDQorICogQHJlc3Y6
CQlyZXNlcnZhdGlvbi1vYmplY3QsIE5VTEwgdG8gYWxsb2NhdGUgZGVmYXVsdCBvbmUNCisgKiBA
cHJpdjoJCUF0dGFjaCBwcml2YXRlIGRhdGEgb2YgYWxsb2NhdG9yIHRvIHRoaXMgYnVmZmVyDQor
ICogQGdwdWNnOgkJUG9pbnRlciB0byBHUFUgY2dyb3VwIHRoaXMgYnVmZmVyIGlzIGNoYXJnZWQg
dG8sIG9yIE5VTEwgaWYgbm90IGNoYXJnZWQNCisgKiBAZ3B1Y2dfYnVja2V0OglQb2ludGVyIHRv
IEdQVSBjZ3JvdXAgYnVja2V0IHRoaXMgYnVmZmVyIGNvbWVzIGZyb20sIG9yIE5VTEwgaWYgbm90
IGNoYXJnZWQNCiAgKg0KICAqIFRoaXMgc3RydWN0dXJlIGhvbGRzIHRoZSBpbmZvcm1hdGlvbiBy
ZXF1aXJlZCB0byBleHBvcnQgdGhlIGJ1ZmZlci4gVXNlZA0KICAqIHdpdGggZG1hX2J1Zl9leHBv
cnQoKSBvbmx5Lg0KQEAgLTU0NSw2ICs1NTYsMTAgQEAgc3RydWN0IGRtYV9idWZfZXhwb3J0X2lu
Zm8gew0KIAlpbnQgZmxhZ3M7DQogCXN0cnVjdCBkbWFfcmVzdiAqcmVzdjsNCiAJdm9pZCAqcHJp
djsNCisjaWZkZWYgQ09ORklHX0NHUk9VUF9HUFUNCisJc3RydWN0IGdwdWNnICpncHVjZzsNCisJ
c3RydWN0IGdwdWNnX2J1Y2tldCAqZ3B1Y2dfYnVja2V0Ow0KKyNlbmRpZg0KIH07DQogDQogLyoq
DQpAQCAtNjMwLDQgKzY0NSwxNCBAQCBpbnQgZG1hX2J1Zl9tbWFwKHN0cnVjdCBkbWFfYnVmICos
IHN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqLA0KIAkJIHVuc2lnbmVkIGxvbmcpOw0KIGludCBkbWFf
YnVmX3ZtYXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgc3RydWN0IGlvc3lzX21hcCAqbWFwKTsN
CiB2b2lkIGRtYV9idWZfdnVubWFwKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIHN0cnVjdCBpb3N5
c19tYXAgKm1hcCk7DQorDQorI2lmZGVmIENPTkZJR19DR1JPVVBfR1BVDQordm9pZCBkbWFfYnVm
X2V4cF9pbmZvX3NldF9ncHVjZyhzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwX2luZm8s
DQorCQkJCXN0cnVjdCBncHVjZyAqZ3B1Y2csDQorCQkJCXN0cnVjdCBncHVjZ19idWNrZXQgKmdw
dWNnX2J1Y2tldCk7DQorI2Vsc2UvKiBDT05GSUdfQ0dST1VQX0dQVSAqLw0KK3N0YXRpYyBpbmxp
bmUgdm9pZCBkbWFfYnVmX2V4cF9pbmZvX3NldF9ncHVjZyhzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRf
aW5mbyAqZXhwX2luZm8sDQorCQkJCQkgICAgICBzdHJ1Y3QgZ3B1Y2cgKmdwdWNnLA0KKwkJCQkJ
ICAgICAgc3RydWN0IGdwdWNnX2J1Y2tldCAqZ3B1Y2dfYnVja2V0KSB7fQ0KKyNlbmRpZiAvKiBD
T05GSUdfQ0dST1VQX0dQVSAqLw0KICNlbmRpZiAvKiBfX0RNQV9CVUZfSF9fICovDQpkaWZmIC0t
Z2l0IGEvaW5jbHVkZS9saW51eC9kbWEtaGVhcC5oIGIvaW5jbHVkZS9saW51eC9kbWEtaGVhcC5o
DQppbmRleCAwYzA1NTYxY2FkNmUuLjYzMjFlNzYzNjUzOCAxMDA2NDQNCi0tLSBhL2luY2x1ZGUv
bGludXgvZG1hLWhlYXAuaA0KKysrIGIvaW5jbHVkZS9saW51eC9kbWEtaGVhcC5oDQpAQCAtMTAs
NiArMTAsNyBAQA0KICNkZWZpbmUgX0RNQV9IRUFQU19IDQogDQogI2luY2x1ZGUgPGxpbnV4L2Nk
ZXYuaD4NCisjaW5jbHVkZSA8bGludXgvY2dyb3VwX2dwdS5oPg0KICNpbmNsdWRlIDxsaW51eC90
eXBlcy5oPg0KIA0KIHN0cnVjdCBkbWFfaGVhcDsNCkBAIC01OSw2ICs2MCwyMCBAQCB2b2lkICpk
bWFfaGVhcF9nZXRfZHJ2ZGF0YShzdHJ1Y3QgZG1hX2hlYXAgKmhlYXApOw0KICAqLw0KIGNvbnN0
IGNoYXIgKmRtYV9oZWFwX2dldF9uYW1lKHN0cnVjdCBkbWFfaGVhcCAqaGVhcCk7DQogDQorI2lm
ZGVmIENPTkZJR19DR1JPVVBfR1BVDQorLyoqDQorICogZG1hX2hlYXBfZ2V0X2dwdWNnX2J1Y2tl
dCgpIC0gZ2V0IGEgcG9pbnRlciB0byB0aGUgc3RydWN0IGdwdWNnX2J1Y2tldCBmb3IgdGhlIGhl
YXAuDQorICogQGhlYXA6IERNQS1IZWFwIHRvIHJldHJpZXZlIGdwdWNnX2J1Y2tldCBmb3INCisg
Kg0KKyAqIFJldHVybnM6DQorICogVGhlIGdwdWNnX2J1Y2tldCBzdHJ1Y3QgZm9yIHRoZSBoZWFw
Lg0KKyAqLw0KK3N0cnVjdCBncHVjZ19idWNrZXQgKmRtYV9oZWFwX2dldF9ncHVjZ19idWNrZXQo
c3RydWN0IGRtYV9oZWFwICpoZWFwKTsNCisjZWxzZSAvKiBDT05GSUdfQ0dST1VQX0dQVSAqLw0K
K3N0YXRpYyBpbmxpbmUgc3RydWN0IGdwdWNnX2J1Y2tldCAqZG1hX2hlYXBfZ2V0X2dwdWNnX2J1
Y2tldChzdHJ1Y3QgZG1hX2hlYXAgKmhlYXApDQoreyByZXR1cm4gTlVMTDsgfQ0KKyNlbmRpZiAv
KiBDT05GSUdfQ0dST1VQX0dQVSAqLw0KKw0KIC8qKg0KICAqIGRtYV9oZWFwX2FkZCAtIGFkZHMg
YSBoZWFwIHRvIGRtYWJ1ZiBoZWFwcw0KICAqIEBleHBfaW5mbzoJCWluZm9ybWF0aW9uIG5lZWRl
ZCB0byByZWdpc3RlciB0aGlzIGhlYXANCi0tIA0KMi4zNi4wLjUxMi5nZTQwYzJiYWQ3YS1nb29n
DQoNCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbmFy
by1tbS1zaWcgbWFpbGluZyBsaXN0IC0tIGxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpU
byB1bnN1YnNjcmliZSBzZW5kIGFuIGVtYWlsIHRvIGxpbmFyby1tbS1zaWctbGVhdmVAbGlzdHMu
bGluYXJvLm9yZwo=
