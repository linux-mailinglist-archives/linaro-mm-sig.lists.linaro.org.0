Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id B14BC20F2EF
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 30 Jun 2020 12:46:36 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E502460679
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 30 Jun 2020 10:46:35 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id D6BCB60733; Tue, 30 Jun 2020 10:46:35 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-7.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_HI,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,SPF_HELO_PASS
	autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id A9FE76189D;
	Tue, 30 Jun 2020 10:45:35 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id C7BD960679
 for <linaro-mm-sig@lists.linaro.org>; Tue, 30 Jun 2020 10:45:31 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id A8D8F6189D; Tue, 30 Jun 2020 10:45:31 +0000 (UTC)
Received: from mailout1.w1.samsung.com (mailout1.w1.samsung.com
 [210.118.77.11])
 by lists.linaro.org (Postfix) with ESMTPS id D0D7660679
 for <linaro-mm-sig@lists.linaro.org>; Tue, 30 Jun 2020 10:45:29 +0000 (UTC)
Received: from eucas1p1.samsung.com (unknown [182.198.249.206])
 by mailout1.w1.samsung.com (KnoxPortal) with ESMTP id
 20200630104528euoutp015f0ca947327287052395c88fcaf632dd~dTHmuWRgN0677806778euoutp01O
 for <linaro-mm-sig@lists.linaro.org>; Tue, 30 Jun 2020 10:45:28 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout1.w1.samsung.com
 20200630104528euoutp015f0ca947327287052395c88fcaf632dd~dTHmuWRgN0677806778euoutp01O
Received: from eusmges2new.samsung.com (unknown [203.254.199.244]) by
 eucas1p2.samsung.com (KnoxPortal) with ESMTP id
 20200630104528eucas1p2f23d2b731b639f6643fe42e2cfc862df~dTHmSR8mB0978009780eucas1p2_;
 Tue, 30 Jun 2020 10:45:28 +0000 (GMT)
Received: from eucas1p1.samsung.com ( [182.198.249.206]) by
 eusmges2new.samsung.com (EUCPMTA) with SMTP id F6.B5.05997.8C71BFE5; Tue, 30
 Jun 2020 11:45:28 +0100 (BST)
Received: from eusmtrp2.samsung.com (unknown [182.198.249.139]) by
 eucas1p1.samsung.com (KnoxPortal) with ESMTPA id
 20200630104527eucas1p13f19c24ff053556fb1fa7dc72be14c77~dTHl3UM0R2539025390eucas1p1I;
 Tue, 30 Jun 2020 10:45:27 +0000 (GMT)
Received: from eusmgms2.samsung.com (unknown [182.198.249.180]) by
 eusmtrp2.samsung.com (KnoxPortal) with ESMTP id
 20200630104527eusmtrp252206fb5da44e6f0c16456efe5ac71a5~dTHl2icNj3252132521eusmtrp2N;
 Tue, 30 Jun 2020 10:45:27 +0000 (GMT)
X-AuditID: cbfec7f4-677ff7000000176d-7e-5efb17c8f27f
Received: from eusmtip1.samsung.com ( [203.254.199.221]) by
 eusmgms2.samsung.com (EUCPMTA) with SMTP id CB.86.06017.7C71BFE5; Tue, 30
 Jun 2020 11:45:27 +0100 (BST)
Received: from AMDC2765.digital.local (unknown [106.120.51.73]) by
 eusmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200630104525eusmtip12cf2edfda9c5b2cebe27f89dc948a33e~dTHjlTP4F1804318043eusmtip1H;
 Tue, 30 Jun 2020 10:45:25 +0000 (GMT)
From: Marek Szyprowski <m.szyprowski@samsung.com>
To: dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
Date: Tue, 30 Jun 2020 12:45:16 +0200
Message-Id: <20200630104516.32731-1-m.szyprowski@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200619103636.11974-37-m.szyprowski@samsung.com>
X-Brightmail-Tracker: H4sIAAAAAAAAA0WSa0hTYRjHec85Ozuaq9O0fNFIGGYoeOlCHdDUIuEQfbAPQQQtl55UdKt2
 UjPDJClqal4rNSkpS9PmZbWZ11TUzcR1M1F03rYPZYnGvGsuj0fr2+/5P7+XPzy8BCruFLgQ
 0YqrjFIhi5Xg9piuc9HobXBelvrNZQmoDGMXQtXkVwkomy4bpXpnp3DqVUUHQn0uMGFU8Xt/
 aqZ3DKE05j4B9bW+CKfSq7UCSt1uElIvNSsIlTe5KKRapy2C4G306yevAd00V4zRmvJ7OF07
 NyqgR9L0CP2m5CY9uGpG6dz+UkA3DKTgtHnpB07ff1sOaKtmN/1h1ioMFZ21D4hgYqPjGaVv
 YJh9VEvdovByRei1wT+HU8DnYypgR0DyINRafuEqYE+IyTIAM+fzERUg1oYZAOudOEdMWgEc
 0F3Y9LuWPm74pQDO501h/LDmf+pIwTkLJ/dB1aRqnZ3I2wAaMhw4CSWrULgwnAu4hSMZAnsn
 MhGOMXIPrCtqwLhmEXkE9tUgfJsbrKhuQTm2I4Pgi5aG9TJIjgvhqNaC8dJxWLI6ivPsCCf0
 b4U874K2uqcI/yAVwDGjWsgP6QB+vZUPeMsfDhmXcK4ZJT1hVb0vHx+FjZZmlIshuRX2T27n
 YnQNc3SPNmIRvHtHzNsesFBf+a+29dMXlGcaWkuXAX/FHAArh7yygFvh/65iAMqBMxPHyiMZ
 dr+CSfBhZXI2ThHpE35JrgFrv6t7VT/zDtSvXGgDJAEkDqIw46JULJDFs4nyNgAJVOIkOtbT
 LRWLImSJ1xnlpfPKuFiGbQOuBCZxFh149uOcmIyUXWViGOYyo9zcIoSdSwqAZZ5nTth+m0d/
 +omD+9w99qoXKrwLdn3xmg5vyA32HE+K2a4ZSZJqrdmppm+pQUO2sbSpB40G0xWiNliYafOt
 ybRtKXK923OyOUF9b35pZ/uh4RGJ2VdtCOuKik+/WOo+HrCjPZl5bjGFJ6exITeahlcDc0+1
 iAKnHj80fM8+LcHYKNk+L1TJyv4CUL5aYVkDAAA=
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrNIsWRmVeSWpSXmKPExsVy+t/xu7rHxX/HGXRP0bLoPXeSyWLjjPWs
 Fv+3TWS2uPL1PZvFytVHmSwuzrzLYrFgv7XFlysPmSw2Pb7GanF51xw2i54NW1kt1h65y26x
 bNMfJospb3+yWxz88ITVgd9jzbw1jB57vy1g8di0qpPNY/u3B6we97uPM3lsXlLvcfvfY2aP
 yTeWM3rsvtnA5vH410s2j74tqxg9Pm+S8zj19TN7AG+Unk1RfmlJqkJGfnGJrVK0oYWRnqGl
 hZ6RiaWeobF5rJWRqZK+nU1Kak5mWWqRvl2CXsaBnT/ZC1YHVNz+a97AeNGpi5GTQ0LAROLk
 r/NsXYxcHEICSxklNj1/wAaRkJE4Oa2BFcIWlvhzrQuq6BOjxNIfK1lAEmwChhJdbyESIgKd
 jBLTuj+ygzjMAjuZJSZeb2EGqRIWcJW48qqfCcRmEVCV2DlnN1A3BwevgK3EtY1MEBvkJVZv
 OABWzilgL7H0wG6wBUICdhKfdpxknMDIt4CRYRWjSGppcW56brGRXnFibnFpXrpecn7uJkZg
 RG079nPLDsaud8GHGAU4GJV4eBPO/YwTYk0sK67MPcQowcGsJMLrdPZ0nBBvSmJlVWpRfnxR
 aU5q8SFGU6CbJjJLiSbnA6M9ryTe0NTQ3MLS0NzY3NjMQkmct0PgYIyQQHpiSWp2ampBahFM
 HxMHp1QDo9ZB/Rvfj0+OOH9hVkSm+w8G79LyN0H7OvvnrmELel0aqtp2sXjHFy3z1XvniG5r
 XWgg02l2zl0/8HzbgYuVMUWzL+lOTm+8e8csqmP/jYLDj+fGvbrdtHH2n7ouv/2nxeXa94cn
 LVuX5MEn/6P2SeW+x2nWYTpdh9/u/fauw8pRv6tq6fs6BSWW4oxEQy3mouJEAPQegDS+AgAA
X-CMS-MailID: 20200630104527eucas1p13f19c24ff053556fb1fa7dc72be14c77
X-Msg-Generator: CA
X-RootMTR: 20200630104527eucas1p13f19c24ff053556fb1fa7dc72be14c77
X-EPHeader: CA
CMS-TYPE: 201P
X-CMS-RootMailID: 20200630104527eucas1p13f19c24ff053556fb1fa7dc72be14c77
References: <20200619103636.11974-37-m.szyprowski@samsung.com>
 <CGME20200630104527eucas1p13f19c24ff053556fb1fa7dc72be14c77@eucas1p1.samsung.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Pawel Osciak <pawel@osciak.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, linux-media@vger.kernel.org,
 Daniel Vetter <daniel@ffwll.ch>, Hans Verkuil <hverkuil-cisco@xs4all.nl>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Robin Murphy <robin.murphy@arm.com>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH v8] videobuf2: use sgtable-based scatterlist
	wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VXNlIHJlY2VudGx5IGludHJvZHVjZWQgY29tbW9uIHdyYXBwZXJzIG9wZXJhdGluZyBkaXJlY3Rs
eSBvbiB0aGUgc3RydWN0CnNnX3RhYmxlIG9iamVjdHMgYW5kIHNjYXR0ZXJsaXN0IHBhZ2UgaXRl
cmF0b3JzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQKbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2ll
ciB0byBmb2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLCBi
ZWNhdXNlIHRoZSBjb2RlIGFscmVhZHkgcHJvcGVybHkgZGlkIGFsbCB0aGUKc2NhdGVybGlzdCBy
ZWxhdGVkIGNhbGxzLgoKU2lnbmVkLW9mZi1ieTogTWFyZWsgU3p5cHJvd3NraSA8bS5zenlwcm93
c2tpQHNhbXN1bmcuY29tPgotLS0Kdjg6Ci0gcmViYXNlZCBhZnRlciByZWNlbnQgY2hhbmdlcyBp
biB0aGUgY29kZQotLS0KIC4uLi9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGln
LmMgICB8IDM0ICsrKysrKysrLS0tLS0tLS0tLS0KIC4uLi9tZWRpYS9jb21tb24vdmlkZW9idWYy
L3ZpZGVvYnVmMi1kbWEtc2cuYyB8IDMyICsrKysrKystLS0tLS0tLS0tCiAuLi4vY29tbW9uL3Zp
ZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jICAgICAgfCAxMiArKystLS0tCiAzIGZpbGVzIGNo
YW5nZWQsIDMxIGluc2VydGlvbnMoKyksIDQ3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jIGIvZHJp
dmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMKaW5kZXgg
ZWMzNDQ2Y2M0NWI4Li4xYjI0MmQ4NDRkZGUgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29t
bW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCisrKyBiL2RyaXZlcnMvbWVkaWEv
Y29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCkBAIC01OCwxMCArNTgsMTAg
QEAgc3RhdGljIHVuc2lnbmVkIGxvbmcgdmIyX2RjX2dldF9jb250aWd1b3VzX3NpemUoc3RydWN0
IHNnX3RhYmxlICpzZ3QpCiAJdW5zaWduZWQgaW50IGk7CiAJdW5zaWduZWQgbG9uZyBzaXplID0g
MDsKIAotCWZvcl9lYWNoX3NnKHNndC0+c2dsLCBzLCBzZ3QtPm5lbnRzLCBpKSB7CisJZm9yX2Vh
Y2hfc2d0YWJsZV9kbWFfc2coc2d0LCBzLCBpKSB7CiAJCWlmIChzZ19kbWFfYWRkcmVzcyhzKSAh
PSBleHBlY3RlZCkKIAkJCWJyZWFrOwotCQlleHBlY3RlZCA9IHNnX2RtYV9hZGRyZXNzKHMpICsg
c2dfZG1hX2xlbihzKTsKKwkJZXhwZWN0ZWQgKz0gc2dfZG1hX2xlbihzKTsKIAkJc2l6ZSArPSBz
Z19kbWFfbGVuKHMpOwogCX0KIAlyZXR1cm4gc2l6ZTsKQEAgLTEwMyw4ICsxMDMsNyBAQCBzdGF0
aWMgdm9pZCB2YjJfZGNfcHJlcGFyZSh2b2lkICpidWZfcHJpdikKIAlpZiAoIXNndCkKIAkJcmV0
dXJuOwogCi0JZG1hX3N5bmNfc2dfZm9yX2RldmljZShidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+
b3JpZ19uZW50cywKLQkJCSAgICAgICBidWYtPmRtYV9kaXIpOworCWRtYV9zeW5jX3NndGFibGVf
Zm9yX2RldmljZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwogfQogCiBzdGF0aWMgdm9p
ZCB2YjJfZGNfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQpAQCAtMTE1LDcgKzExNCw3IEBAIHN0YXRp
YyB2b2lkIHZiMl9kY19maW5pc2godm9pZCAqYnVmX3ByaXYpCiAJaWYgKCFzZ3QpCiAJCXJldHVy
bjsKIAotCWRtYV9zeW5jX3NnX2Zvcl9jcHUoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdf
bmVudHMsIGJ1Zi0+ZG1hX2Rpcik7CisJZG1hX3N5bmNfc2d0YWJsZV9mb3JfY3B1KGJ1Zi0+ZGV2
LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9CiAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKiovCkBAIC0yNzUsOCArMjc0LDggQEAgc3RhdGljIHZvaWQgdmIyX2Rj
X2RtYWJ1Zl9vcHNfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVmLAogCQkgKiBtZW1vcnkgbG9j
YXRpb25zIGRvIG5vdCByZXF1aXJlIGFueSBleHBsaWNpdCBjYWNoZQogCQkgKiBtYWludGVuYW5j
ZSBwcmlvciBvciBhZnRlciBiZWluZyB1c2VkIGJ5IHRoZSBkZXZpY2UuCiAJCSAqLwotCQlkbWFf
dW5tYXBfc2dfYXR0cnMoZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMs
Ci0JCQkJICAgYXR0YWNoLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKKwkJZG1h
X3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLAorCQkJ
CSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJc2dfZnJlZV90YWJsZShzZ3QpOwogCWtmcmVl
KGF0dGFjaCk7CiAJZGJfYXR0YWNoLT5wcml2ID0gTlVMTDsKQEAgLTMwMSw4ICszMDAsOCBAQCBz
dGF0aWMgc3RydWN0IHNnX3RhYmxlICp2YjJfZGNfZG1hYnVmX29wc19tYXAoCiAKIAkvKiByZWxl
YXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05P
TkUpIHsKLQkJZG1hX3VubWFwX3NnX2F0dHJzKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0
LT5vcmlnX25lbnRzLAotCQkJCSAgIGF0dGFjaC0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVf
U1lOQyk7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGF0dGFjaC0+
ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwogCQlhdHRhY2gtPmRtYV9k
aXIgPSBETUFfTk9ORTsKIAl9CiAKQEAgLTMxMCw5ICszMDksOCBAQCBzdGF0aWMgc3RydWN0IHNn
X3RhYmxlICp2YjJfZGNfZG1hYnVmX29wc19tYXAoCiAJICogbWFwcGluZyB0byB0aGUgY2xpZW50
IHdpdGggbmV3IGRpcmVjdGlvbiwgbm8gY2FjaGUgc3luYwogCSAqIHJlcXVpcmVkIHNlZSBjb21t
ZW50IGluIHZiMl9kY19kbWFidWZfb3BzX2RldGFjaCgpCiAJICovCi0Jc2d0LT5uZW50cyA9IGRt
YV9tYXBfc2dfYXR0cnMoZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMs
Ci0JCQkJICAgICAgZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7Ci0JaWYgKCFzZ3Qt
Pm5lbnRzKSB7CisJaWYgKGRtYV9tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBkbWFf
ZGlyLAorCQkJICAgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpKSB7CiAJCXByX2VycigiZmFpbGVk
IHRvIG1hcCBzY2F0dGVybGlzdFxuIik7CiAJCW11dGV4X3VubG9jayhsb2NrKTsKIAkJcmV0dXJu
IEVSUl9QVFIoLUVJTyk7CkBAIC00NTUsOCArNDUzLDggQEAgc3RhdGljIHZvaWQgdmIyX2RjX3B1
dF91c2VycHRyKHZvaWQgKmJ1Zl9wcml2KQogCQkgKiBObyBuZWVkIHRvIHN5bmMgdG8gQ1BVLCBp
dCdzIGFscmVhZHkgc3luY2VkIHRvIHRoZSBDUFUKIAkJICogc2luY2UgdGhlIGZpbmlzaCgpIG1l
bW9wIHdpbGwgaGF2ZSBiZWVuIGNhbGxlZCBiZWZvcmUgdGhpcy4KIAkJICovCi0JCWRtYV91bm1h
cF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICBi
dWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOworCQlkbWFfdW5tYXBfc2d0YWJs
ZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkJICBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKIAkJcGFnZXMgPSBmcmFtZV92ZWN0b3JfcGFnZXMoYnVmLT52ZWMpOwogCQkvKiBzZ3Qg
c2hvdWxkIGV4aXN0IG9ubHkgaWYgdmVjdG9yIGNvbnRhaW5zIHBhZ2VzLi4uICovCiAJCUJVR19P
TihJU19FUlIocGFnZXMpKTsKQEAgLTU1Myw5ICs1NTEsOCBAQCBzdGF0aWMgdm9pZCAqdmIyX2Rj
X2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyB2YWRkciwKIAkg
KiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwgdGhpcyB3aWxsIGhhcHBlbiBsYXRlciB3
aGVuIHRoZQogCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBjYWxsZWQuCiAJICovCi0Jc2d0LT5uZW50
cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMs
Ci0JCQkJICAgICAgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKLQlpZiAo
c2d0LT5uZW50cyA8PSAwKSB7CisJaWYgKGRtYV9tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBi
dWYtPmRtYV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpIHsKIAkJcHJfZXJy
KCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJcmV0ID0gLUVJTzsKIAkJZ290byBm
YWlsX3NndF9pbml0OwpAQCAtNTc3LDggKzU3NCw3IEBAIHN0YXRpYyB2b2lkICp2YjJfZGNfZ2V0
X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIHZhZGRyLAogCXJldHVy
biBidWY7CiAKIGZhaWxfbWFwX3NnOgotCWRtYV91bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0
LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCSAgIGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJ
UF9DUFVfU1lOQyk7CisJZG1hX3VubWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFf
ZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAogZmFpbF9zZ3RfaW5pdDoKIAlzZ19mcmVl
X3RhYmxlKHNndCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIv
dmlkZW9idWYyLWRtYS1zZy5jIGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVv
YnVmMi1kbWEtc2cuYwppbmRleCAwYTQwZTAwZjBkN2UuLjBkZDNiMTkwMjVlMCAxMDA2NDQKLS0t
IGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYworKysg
Yi9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jCkBAIC0x
NDgsOSArMTQ4LDggQEAgc3RhdGljIHZvaWQgKnZiMl9kbWFfc2dfYWxsb2Moc3RydWN0IGRldmlj
ZSAqZGV2LCB1bnNpZ25lZCBsb25nIGRtYV9hdHRycywKIAkgKiBObyBuZWVkIHRvIHN5bmMgdG8g
dGhlIGRldmljZSwgdGhpcyB3aWxsIGhhcHBlbiBsYXRlciB3aGVuIHRoZQogCSAqIHByZXBhcmUo
KSBtZW1vcCBpcyBjYWxsZWQuCiAJICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMo
YnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgICAgYnVmLT5kbWFf
ZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKLQlpZiAoIXNndC0+bmVudHMpCisJaWYgKGRt
YV9tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkgICAgRE1BX0FU
VFJfU0tJUF9DUFVfU1lOQykpCiAJCWdvdG8gZmFpbF9tYXA7CiAKIAlidWYtPmhhbmRsZXIucmVm
Y291bnQgPSAmYnVmLT5yZWZjb3VudDsKQEAgLTE4Niw4ICsxODUsOCBAQCBzdGF0aWMgdm9pZCB2
YjJfZG1hX3NnX3B1dCh2b2lkICpidWZfcHJpdikKIAlpZiAocmVmY291bnRfZGVjX2FuZF90ZXN0
KCZidWYtPnJlZmNvdW50KSkgewogCQlkcHJpbnRrKDEsICIlczogRnJlZWluZyBidWZmZXIgb2Yg
JWQgcGFnZXNcbiIsIF9fZnVuY19fLAogCQkJYnVmLT5udW1fcGFnZXMpOwotCQlkbWFfdW5tYXBf
c2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgYnVm
LT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKKwkJZG1hX3VubWFwX3NndGFibGUo
YnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lO
Qyk7CiAJCWlmIChidWYtPnZhZGRyKQogCQkJdm1fdW5tYXBfcmFtKGJ1Zi0+dmFkZHIsIGJ1Zi0+
bnVtX3BhZ2VzKTsKIAkJc2dfZnJlZV90YWJsZShidWYtPmRtYV9zZ3QpOwpAQCAtMjA0LDggKzIw
Myw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfcHJlcGFyZSh2b2lkICpidWZfcHJpdikKIAlz
dHJ1Y3QgdmIyX2RtYV9zZ19idWYgKmJ1ZiA9IGJ1Zl9wcml2OwogCXN0cnVjdCBzZ190YWJsZSAq
c2d0ID0gYnVmLT5kbWFfc2d0OwogCi0JZG1hX3N5bmNfc2dfZm9yX2RldmljZShidWYtPmRldiwg
c2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCSAgICAgICBidWYtPmRtYV9kaXIpOworCWRt
YV9zeW5jX3NndGFibGVfZm9yX2RldmljZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwog
fQogCiBzdGF0aWMgdm9pZCB2YjJfZG1hX3NnX2ZpbmlzaCh2b2lkICpidWZfcHJpdikKQEAgLTIx
Myw3ICsyMTEsNyBAQCBzdGF0aWMgdm9pZCB2YjJfZG1hX3NnX2ZpbmlzaCh2b2lkICpidWZfcHJp
dikKIAlzdHJ1Y3QgdmIyX2RtYV9zZ19idWYgKmJ1ZiA9IGJ1Zl9wcml2OwogCXN0cnVjdCBzZ190
YWJsZSAqc2d0ID0gYnVmLT5kbWFfc2d0OwogCi0JZG1hX3N5bmNfc2dfZm9yX2NwdShidWYtPmRl
diwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywgYnVmLT5kbWFfZGlyKTsKKwlkbWFfc3luY19z
Z3RhYmxlX2Zvcl9jcHUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyKTsKIH0KIAogc3RhdGlj
IHZvaWQgKnZiMl9kbWFfc2dfZ2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25l
ZCBsb25nIHZhZGRyLApAQCAtMjU2LDkgKzI1NCw4IEBAIHN0YXRpYyB2b2lkICp2YjJfZG1hX3Nn
X2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyB2YWRkciwKIAkg
KiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwgdGhpcyB3aWxsIGhhcHBlbiBsYXRlciB3
aGVuIHRoZQogCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBjYWxsZWQuCiAJICovCi0Jc2d0LT5uZW50
cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMs
Ci0JCQkJICAgICAgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKLQlpZiAo
IXNndC0+bmVudHMpCisJaWYgKGRtYV9tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRt
YV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpCiAJCWdvdG8gdXNlcnB0cl9m
YWlsX21hcDsKIAogCXJldHVybiBidWY7CkBAIC0yODQsOCArMjgxLDcgQEAgc3RhdGljIHZvaWQg
dmIyX2RtYV9zZ19wdXRfdXNlcnB0cih2b2lkICpidWZfcHJpdikKIAogCWRwcmludGsoMSwgIiVz
OiBSZWxlYXNpbmcgdXNlcnNwYWNlIGJ1ZmZlciBvZiAlZCBwYWdlc1xuIiwKIAkgICAgICAgX19m
dW5jX18sIGJ1Zi0+bnVtX3BhZ2VzKTsKLQlkbWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNn
dC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2RpciwKLQkJCSAgIERNQV9BVFRSX1NL
SVBfQ1BVX1NZTkMpOworCWRtYV91bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1h
X2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJaWYgKGJ1Zi0+dmFkZHIpCiAJCXZtX3Vu
bWFwX3JhbShidWYtPnZhZGRyLCBidWYtPm51bV9wYWdlcyk7CiAJc2dfZnJlZV90YWJsZShidWYt
PmRtYV9zZ3QpOwpAQCAtNDA4LDggKzQwNCw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZG1h
YnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCiAKIAkvKiByZWxlYXNlIHRoZSBz
Y2F0dGVybGlzdCBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05PTkUpCi0J
CWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCWF0dGFjaC0+ZG1hX2Rpcik7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwgMCk7CiAJc2dfZnJlZV90YWJsZShzZ3QpOwogCWtmcmVl
KGF0dGFjaCk7CiAJZGJfYXR0YWNoLT5wcml2ID0gTlVMTDsKQEAgLTQzNCwxNSArNDI5LDEyIEBA
IHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kbWFfc2dfZG1hYnVmX29wc19tYXAoCiAKIAkv
KiByZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0g
RE1BX05PTkUpIHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0
LT5vcmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUo
ZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAkJYXR0YWNoLT5kbWFf
ZGlyID0gRE1BX05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGggbmV3
IGRpcmVjdGlvbiAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBz
Z3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0LT5uZW50
cykgeworCWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2Rpciwg
MCkpIHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhf
dW5sb2NrKGxvY2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jIGIvZHJpdmVycy9t
ZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMKaW5kZXggYzY2ZmRhNGE2
NWU0Li5iZjVhYzYzYTU3NDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVv
YnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jCisrKyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVv
YnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jCkBAIC0yMjksNyArMjI5LDcgQEAgc3RhdGljIGludCB2
YjJfdm1hbGxvY19kbWFidWZfb3BzX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAkJa2Zy
ZWUoYXR0YWNoKTsKIAkJcmV0dXJuIHJldDsKIAl9Ci0JZm9yX2VhY2hfc2coc2d0LT5zZ2wsIHNn
LCBzZ3QtPm5lbnRzLCBpKSB7CisJZm9yX2VhY2hfc2d0YWJsZV9zZyhzZ3QsIHNnLCBpKSB7CiAJ
CXN0cnVjdCBwYWdlICpwYWdlID0gdm1hbGxvY190b19wYWdlKHZhZGRyKTsKIAogCQlpZiAoIXBh
Z2UpIHsKQEAgLTI1OSw4ICsyNTksNyBAQCBzdGF0aWMgdm9pZCB2YjJfdm1hbGxvY19kbWFidWZf
b3BzX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAogCS8qIHJlbGVhc2UgdGhlIHNjYXR0
ZXJsaXN0IGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9ORSkKLQkJZG1h
X3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJ
YXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNn
dCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAlzZ19mcmVlX3RhYmxlKHNndCk7CiAJa2ZyZWUoYXR0
YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtMjg1LDE1ICsyODQsMTIgQEAgc3Rh
dGljIHN0cnVjdCBzZ190YWJsZSAqdmIyX3ZtYWxsb2NfZG1hYnVmX29wc19tYXAoCiAKIAkvKiBy
ZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1B
X05PTkUpIHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5v
cmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJf
YXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAkJYXR0YWNoLT5kbWFfZGly
ID0gRE1BX05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGggbmV3IGRp
cmVjdGlvbiAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3Qt
PnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0LT5uZW50cykg
eworCWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2RpciwgMCkp
IHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhfdW5s
b2NrKGxvY2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKLS0gCjIuMTcuMQoKX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWls
aW5nIGxpc3QKTGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCmh0dHBzOi8vbGlzdHMubGlu
YXJvLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbmFyby1tbS1zaWcK
