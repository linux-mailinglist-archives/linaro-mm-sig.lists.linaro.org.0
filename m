Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id C70839EED06
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 12 Dec 2024 16:40:49 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E1BA24043F
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 12 Dec 2024 15:40:48 +0000 (UTC)
Received: from nyc.source.kernel.org (nyc.source.kernel.org [147.75.193.91])
	by lists.linaro.org (Postfix) with ESMTPS id D8EF94043F
	for <linaro-mm-sig@lists.linaro.org>; Thu, 12 Dec 2024 15:40:19 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linuxfoundation.org header.s=korg header.b="CrO/ZNU2";
	spf=pass (lists.linaro.org: domain of gregkh@linuxfoundation.org designates 147.75.193.91 as permitted sender) smtp.mailfrom=gregkh@linuxfoundation.org;
	dmarc=pass (policy=none) header.from=linuxfoundation.org
Received: from smtp.kernel.org (transwarp.subspace.kernel.org [100.75.92.58])
	by nyc.source.kernel.org (Postfix) with ESMTP id 6692EA42150;
	Thu, 12 Dec 2024 15:38:28 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id E0B96C4CED0;
	Thu, 12 Dec 2024 15:40:18 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=linuxfoundation.org;
	s=korg; t=1734018019;
	bh=0Q5tPvk0OGeW8zJNpUJUo6YFoo+m7zuOpluXSgK4BkM=;
	h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
	b=CrO/ZNU2WhTixzDVVCjMOVnv7D0sYrgBjnLi44MHSCi6WXdkh4jQnBTfT20wLNk0Z
	 vv6uJKVhjQgLsV6/uc2S7TaFC92f7Of2rOKo+9uNoCZ8gLZkGIrmyy9/ydu9ZjAr8V
	 7X33czRl+NM/dlsF15lihn0NDBrF9nGyJ7pWjny0=
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: stable@vger.kernel.org
Date: Thu, 12 Dec 2024 15:58:14 +0100
Message-ID: <20241212144251.549710679@linuxfoundation.org>
X-Mailer: git-send-email 2.47.1
In-Reply-To: <20241212144244.601729511@linuxfoundation.org>
References: <20241212144244.601729511@linuxfoundation.org>
User-Agent: quilt/0.67
X-stable: review
X-Patchwork-Hint: ignore
MIME-Version: 1.0
X-Rspamd-Queue-Id: D8EF94043F
X-Spamd-Bar: ---------
X-Spamd-Result: default: False [-9.00 / 15.00];
	REPLY(-4.00)[];
	BAYES_HAM(-3.00)[100.00%];
	RBL_SENDERSCORE_REPUT_9(-1.00)[147.75.193.91:from];
	DMARC_POLICY_ALLOW(-0.50)[linuxfoundation.org,none];
	R_DKIM_ALLOW(-0.20)[linuxfoundation.org:s=korg];
	R_SPF_ALLOW(-0.20)[+ip4:147.75.193.91];
	MIME_GOOD(-0.10)[text/plain];
	RCVD_VIA_SMTP_AUTH(0.00)[];
	ARC_NA(0.00)[];
	FROM_HAS_DN(0.00)[];
	MIME_TRACE(0.00)[0:+];
	ASN(0.00)[asn:54825, ipnet:147.75.192.0/21, country:US];
	RCPT_COUNT_TWELVE(0.00)[12];
	FREEMAIL_CC(0.00)[linuxfoundation.org,lists.linux.dev,igalia.com,amd.com,ffwll.ch,linaro.org,padovan.org,gmx.de,vger.kernel.org,lists.freedesktop.org,lists.linaro.org];
	MID_RHS_MATCH_FROM(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	RCVD_COUNT_TWO(0.00)[2];
	TO_DN_SOME(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	DKIM_TRACE(0.00)[linuxfoundation.org:+]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
Message-ID-Hash: 4ZICXXX63X5H5I5DR2LPDVKGRMMOWWUW
X-Message-ID-Hash: 4ZICXXX63X5H5I5DR2LPDVKGRMMOWWUW
X-MailFrom: gregkh@linuxfoundation.org
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
CC: Greg Kroah-Hartman <gregkh@linuxfoundation.org>, patches@lists.linux.dev, Tvrtko Ursulin <tvrtko.ursulin@igalia.com>, =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>, Sumit Semwal <sumit.semwal@linaro.org>, Gustavo Padovan <gustavo@padovan.org>, Friedrich Vock <friedrich.vock@gmx.de>, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 6.6 175/356] dma-fence: Use kernels sort for merging fences
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/4ZICXXX63X5H5I5DR2LPDVKGRMMOWWUW/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

Ni42LXN0YWJsZSByZXZpZXcgcGF0Y2guICBJZiBhbnlvbmUgaGFzIGFueSBvYmplY3Rpb25zLCBw
bGVhc2UgbGV0IG1lIGtub3cuDQoNCi0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpGcm9tOiBUdnJ0a28g
VXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaWdhbGlhLmNvbT4NCg0KY29tbWl0IGZlNTJjNjQ5NDM4
Yjg0ODljOTQ1NjY4MWQ5M2E5YjNkZTNkMzgyNjMgdXBzdHJlYW0uDQoNCk9uZSBhbHRlcm5hdGl2
ZSB0byB0aGUgZml4IENocmlzdGlhbiBwcm9wb3NlZCBpbg0KaHR0cHM6Ly9sb3JlLmtlcm5lbC5v
cmcvZHJpLWRldmVsLzIwMjQxMDI0MTI0MTU5LjQ1MTktMy1jaHJpc3RpYW4ua29lbmlnQGFtZC5j
b20vDQppcyB0byByZXBsYWNlIHRoZSByYXRoZXIgY29tcGxleCBvcGVuIGNvZGVkIHNvcnRpbmcg
bG9vcHMgd2l0aCB0aGUga2VybmVsDQpzdGFuZGFyZCBzb3J0IGZvbGxvd2VkIGJ5IGEgY29udGV4
dCBzcXVhc2hpbmcgcGFzcy4NCg0KUHJvcG9zZWQgYWR2YW50YWdlIG9mIHRoaXMgd291bGQgYmUg
cmVhZGFiaWxpdHkgYnV0IG9uZSBjb25jZXJuIENocmlzdGlhbg0KcmFpc2VkIHdhcyB0aGF0IHRo
ZXJlIGNvdWxkIGJlIG1hbnkgZmVuY2VzLCB0aGF0IHRoZXkgYXJlIHR5cGljYWxseSBtb3N0bHkN
CnNvcnRlZCwgYW5kIHNvIHRoZSBrZXJuZWwncyBoZWFwIHNvcnQgd291bGQgYmUgbXVjaCB3b3Jz
ZSBieSB0aGUgcHJvcG9zZWQNCmFsZ29yaXRobS4NCg0KSSBoYWQgYSBsb29rIHJ1bm5pbmcgc29t
ZSBnYW1lcyBhbmQgdmtjdWJlIHRvIHNlZSB3aGF0IGFyZSB0aGUgdHlwaWNhbA0KbnVtYmVyIG9m
IGlucHV0IGZlbmNlcy4gVGVzdGVkIHNjZW5hcmlvczoNCg0KMSkgSG9nd2FydHMgTGVnYWN5IHVu
ZGVyIEdhbWVzY29wZQ0KDQo0NTAgY2FsbHMgcGVyIHNlY29uZCB0byBfX2RtYV9mZW5jZV91bndy
YXBfbWVyZ2UuDQoNClBlcmNlbnRhZ2VzIHBlciBudW1iZXIgb2YgZmVuY2VzIGJ1Y2tldHMsIGJl
Zm9yZSBhbmQgYWZ0ZXIgY2hlY2tpbmcgZm9yDQpzaWduYWxsZWQgc3RhdHVzLCBzb3J0aW5nIGFu
ZCBmbGF0dGVuaW5nOg0KDQogICBOICAgICAgIEJlZm9yZSAgICAgIEFmdGVyDQogICAwICAgICAg
IDAuOTElDQogICAxICAgICAgNjkuNDAlDQogIDItMyAgICAgMjguNzIlICAgICAgIDkuNCUgICg5
MC42JSByZXNvbHZlZCB0byBvbmUgZmVuY2UpDQogIDQtNSAgICAgIDAuOTMlDQogIDYtOSAgICAg
IDAuMDMlDQogIDEwKw0KDQoyKSBDeWJlcnB1bmsgMjA3NyB1bmRlciBHYW1lc2NvcGUNCg0KMTA1
MCBjYWxscyBwZXIgc2Vjb25kLCBhbW91bnRpbmcgdG8gMC4wMSUgQ1BVIHRpbWUgYWNjb3JkaW5n
IHRvIHBlcmYgdG9wLg0KDQogICBOICAgICAgIEJlZm9yZSAgICAgIEFmdGVyDQogICAwICAgICAg
IDEuMTMlDQogICAxICAgICAgNTIuMzAlDQogIDItMyAgICAgNDAuMzQlICAgICAgIDU1LjU3JQ0K
ICA0LTUgICAgICAxLjQ2JSAgICAgICAgMC41MCUNCiAgNi05ICAgICAgMi40NCUNCiAgMTArICAg
ICAgMi4zNCUNCg0KMykgdmtjdWJlIHVuZGVyIFBsYXNtYQ0KDQo5MCBjYWxscyBwZXIgc2Vjb25k
Lg0KDQogICBOICAgICAgIEJlZm9yZSAgICAgIEFmdGVyDQogICAwDQogICAxDQogIDItMyAgICAg
IDEwMCUgICAgICAgICAwJSAgIChJZS4gYWxsIHJlc29sdmVkIHRvIGEgc2luZ2xlIGZlbmNlKQ0K
ICA0LTUNCiAgNi05DQogIDEwKw0KDQpJbiB0aGUgY2FzZSBvZiB2a2N1YmUgYWxsIGludm9jYXRp
b25zIGluIHRoZSAyLTMgYnVja2V0IHdlcmUgYWN0dWFsbHkNCmp1c3QgdHdvIGlucHV0IGZlbmNl
cy4NCg0KPkZyb20gdGhlc2UgbnVtYmVycyBpdCBsb29rcyBsaWtlIHRoZSBoZWFwIHNvcnQgc2hv
dWxkIG5vdCBiZSBhDQpkaXNhZHZhbnRhZ2UsIGdpdmVuIGhvdyB0aGUgZG9taW5hbnQgY2FzZSBp
cyA8PSAyIGlucHV0IGZlbmNlcyB3aGljaCBoZWFwDQpzb3J0IHNvbHZlcyB3aXRoIGp1c3Qgb25l
IGNvbXBhcmUgYW5kIHN3YXAuIChBbmQgZm9yIHRoZSBjYXNlIG9mIG9uZSBpbnB1dA0KZmVuY2Ug
d2UgaGF2ZSBhIGZhc3QgcGF0aCBpbiB0aGUgcHJldmlvdXMgcGF0Y2guKQ0KDQpBIGNvbXBsZW1l
bnRhcnkgcG9zc2liaWxpdHkgaXMgdG8gaW1wbGVtZW50IGEgZGlmZmVyZW50IHNvcnRpbmcgYWxn
b3JpdGhtDQp1bmRlciB0aGUgc2FtZSBBUEkgYXMgdGhlIGtlcm5lbCdzIHNvcnQoKSBhbmQgc28g
a2VlcCB0aGUgc2ltcGxpY2l0eSwNCnBvdGVudGlhbGx5IG1vdmluZyB0aGUgbmV3IHNvcnQgdW5k
ZXIgbGliLyBpZiBpdCB3b3VsZCBiZSBmb3VuZCBtb3JlDQp3aWRlbHkgdXNlZnVsLg0KDQp2MjoN
CiAqIEhvbGQgb24gdG8gZmVuY2UgcmVmZXJlbmNlcyBhbmQgcmVkdWNlIGNvbW1lbnRhcnkuIChD
aHJpc3RpYW4pDQogKiBSZWNvcmQgYW5kIHVzZSBsYXRlc3Qgc2lnbmFsZWQgdGltZXN0YW1wIGlu
IHRoZSAybmQgbG9vcCB0b28uDQogKiBDb25zb2xpZGF0ZSB6ZXJvIG9yIG9uZSBmZW5jZXMgZmFz
dCBwYXRocy4NCg0KdjM6DQogKiBSZXZlcnNlIHRoZSBzZXFubyBzb3J0IG9yZGVyIGZvciBhIHNp
bXBsZXIgc3F1YXNoaW5nIHBhc3MuIChDaHJpc3RpYW4pDQoNClNpZ25lZC1vZmYtYnk6IFR2cnRr
byBVcnN1bGluIDx0dnJ0a28udXJzdWxpbkBpZ2FsaWEuY29tPg0KRml4ZXM6IDI0NWE0YTdiNTMx
YyAoImRtYS1idWY6IGdlbmVyYWxpemUgZG1hX2ZlbmNlIHVud3JhcCAmIG1lcmdpbmcgdjMiKQ0K
Q2xvc2VzOiBodHRwczovL2dpdGxhYi5mcmVlZGVza3RvcC5vcmcvZHJtL2FtZC8tL2lzc3Vlcy8z
NjE3DQpDYzogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPg0KQ2M6
IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAZmZ3bGwuY2g+DQpDYzogU3VtaXQgU2Vtd2Fs
IDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4NCkNjOiBHdXN0YXZvIFBhZG92YW4gPGd1c3Rhdm9A
cGFkb3Zhbi5vcmc+DQpDYzogRnJpZWRyaWNoIFZvY2sgPGZyaWVkcmljaC52b2NrQGdteC5kZT4N
CkNjOiBsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmcNCkNjOiBkcmktZGV2ZWxAbGlzdHMuZnJl
ZWRlc2t0b3Aub3JnDQpDYzogbGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnDQpDYzogPHN0
YWJsZUB2Z2VyLmtlcm5lbC5vcmc+ICMgdjYuMCsNClJldmlld2VkLWJ5OiBDaHJpc3RpYW4gS8O2
bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+DQpTaWduZWQtb2ZmLWJ5OiBDaHJpc3RpYW4g
S8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+DQpMaW5rOiBodHRwczovL3BhdGNod29y
ay5mcmVlZGVza3RvcC5vcmcvcGF0Y2gvbXNnaWQvMjAyNDExMTUxMDIxNTMuMTk4MC0zLXR1cnN1
bGluQGlnYWxpYS5jb20NClNpZ25lZC1vZmYtYnk6IEdyZWcgS3JvYWgtSGFydG1hbiA8Z3JlZ2to
QGxpbnV4Zm91bmRhdGlvbi5vcmc+DQotLS0NCiBkcml2ZXJzL2RtYS1idWYvZG1hLWZlbmNlLXVu
d3JhcC5jIHwgIDEyNiArKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tDQogMSBm
aWxlIGNoYW5nZWQsIDYwIGluc2VydGlvbnMoKyksIDY2IGRlbGV0aW9ucygtKQ0KDQotLS0gYS9k
cml2ZXJzL2RtYS1idWYvZG1hLWZlbmNlLXVud3JhcC5jDQorKysgYi9kcml2ZXJzL2RtYS1idWYv
ZG1hLWZlbmNlLXVud3JhcC5jDQpAQCAtMTIsNiArMTIsNyBAQA0KICNpbmNsdWRlIDxsaW51eC9k
bWEtZmVuY2UtY2hhaW4uaD4NCiAjaW5jbHVkZSA8bGludXgvZG1hLWZlbmNlLXVud3JhcC5oPg0K
ICNpbmNsdWRlIDxsaW51eC9zbGFiLmg+DQorI2luY2x1ZGUgPGxpbnV4L3NvcnQuaD4NCiANCiAv
KiBJbnRlcm5hbCBoZWxwZXIgdG8gc3RhcnQgbmV3IGFycmF5IGl0ZXJhdGlvbiwgZG9uJ3QgdXNl
IGRpcmVjdGx5ICovDQogc3RhdGljIHN0cnVjdCBkbWFfZmVuY2UgKg0KQEAgLTU5LDYgKzYwLDI1
IEBAIHN0cnVjdCBkbWFfZmVuY2UgKmRtYV9mZW5jZV91bndyYXBfbmV4dCgNCiB9DQogRVhQT1JU
X1NZTUJPTF9HUEwoZG1hX2ZlbmNlX3Vud3JhcF9uZXh0KTsNCiANCisNCitzdGF0aWMgaW50IGZl
bmNlX2NtcChjb25zdCB2b2lkICpfYSwgY29uc3Qgdm9pZCAqX2IpDQorew0KKwlzdHJ1Y3QgZG1h
X2ZlbmNlICphID0gKihzdHJ1Y3QgZG1hX2ZlbmNlICoqKV9hOw0KKwlzdHJ1Y3QgZG1hX2ZlbmNl
ICpiID0gKihzdHJ1Y3QgZG1hX2ZlbmNlICoqKV9iOw0KKw0KKwlpZiAoYS0+Y29udGV4dCA8IGIt
PmNvbnRleHQpDQorCQlyZXR1cm4gLTE7DQorCWVsc2UgaWYgKGEtPmNvbnRleHQgPiBiLT5jb250
ZXh0KQ0KKwkJcmV0dXJuIDE7DQorDQorCWlmIChkbWFfZmVuY2VfaXNfbGF0ZXIoYiwgYSkpDQor
CQlyZXR1cm4gMTsNCisJZWxzZSBpZiAoZG1hX2ZlbmNlX2lzX2xhdGVyKGEsIGIpKQ0KKwkJcmV0
dXJuIC0xOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQogLyogSW1wbGVtZW50YXRpb24gZm9yIHRo
ZSBkbWFfZmVuY2VfbWVyZ2UoKSBtYXJjbywgZG9uJ3QgdXNlIGRpcmVjdGx5ICovDQogc3RydWN0
IGRtYV9mZW5jZSAqX19kbWFfZmVuY2VfdW53cmFwX21lcmdlKHVuc2lnbmVkIGludCBudW1fZmVu
Y2VzLA0KIAkJCQkJICAgc3RydWN0IGRtYV9mZW5jZSAqKmZlbmNlcywNCkBAIC02Nyw4ICs4Nyw3
IEBAIHN0cnVjdCBkbWFfZmVuY2UgKl9fZG1hX2ZlbmNlX3Vud3JhcF9tZXINCiAJc3RydWN0IGRt
YV9mZW5jZV9hcnJheSAqcmVzdWx0Ow0KIAlzdHJ1Y3QgZG1hX2ZlbmNlICp0bXAsICoqYXJyYXk7
DQogCWt0aW1lX3QgdGltZXN0YW1wOw0KLQl1bnNpZ25lZCBpbnQgaTsNCi0Jc2l6ZV90IGNvdW50
Ow0KKwlpbnQgaSwgaiwgY291bnQ7DQogDQogCWNvdW50ID0gMDsNCiAJdGltZXN0YW1wID0gbnNf
dG9fa3RpbWUoMCk7DQpAQCAtOTYsODAgKzExNSw1NSBAQCBzdHJ1Y3QgZG1hX2ZlbmNlICpfX2Rt
YV9mZW5jZV91bndyYXBfbWVyDQogCWlmICghYXJyYXkpDQogCQlyZXR1cm4gTlVMTDsNCiANCi0J
LyoNCi0JICogVGhpcyB0cmFzaGVzIHRoZSBpbnB1dCBmZW5jZSBhcnJheSBhbmQgdXNlcyBpdCBh
cyBwb3NpdGlvbiBmb3IgdGhlDQotCSAqIGZvbGxvd2luZyBtZXJnZSBsb29wLiBUaGlzIHdvcmtz
IGJlY2F1c2UgdGhlIGRtYV9mZW5jZV9tZXJnZSgpDQotCSAqIHdyYXBwZXIgbWFjcm8gaXMgY3Jl
YXRpbmcgdGhpcyB0ZW1wb3JhcnkgYXJyYXkgb24gdGhlIHN0YWNrIHRvZ2V0aGVyDQotCSAqIHdp
dGggdGhlIGl0ZXJhdG9ycy4NCi0JICovDQotCWZvciAoaSA9IDA7IGkgPCBudW1fZmVuY2VzOyAr
K2kpDQotCQlmZW5jZXNbaV0gPSBkbWFfZmVuY2VfdW53cmFwX2ZpcnN0KGZlbmNlc1tpXSwgJml0
ZXJbaV0pOw0KLQ0KIAljb3VudCA9IDA7DQotCWRvIHsNCi0JCXVuc2lnbmVkIGludCBzZWw7DQot
DQotcmVzdGFydDoNCi0JCXRtcCA9IE5VTEw7DQotCQlmb3IgKGkgPSAwOyBpIDwgbnVtX2ZlbmNl
czsgKytpKSB7DQotCQkJc3RydWN0IGRtYV9mZW5jZSAqbmV4dDsNCi0NCi0JCQl3aGlsZSAoZmVu
Y2VzW2ldICYmIGRtYV9mZW5jZV9pc19zaWduYWxlZChmZW5jZXNbaV0pKQ0KLQkJCQlmZW5jZXNb
aV0gPSBkbWFfZmVuY2VfdW53cmFwX25leHQoJml0ZXJbaV0pOw0KLQ0KLQkJCW5leHQgPSBmZW5j
ZXNbaV07DQotCQkJaWYgKCFuZXh0KQ0KLQkJCQljb250aW51ZTsNCi0NCi0JCQkvKg0KLQkJCSAq
IFdlIGNhbid0IGd1YXJhbnRlZSB0aGF0IGlucHV0ZSBmZW5jZXMgYXJlIG9yZGVyZWQgYnkNCi0J
CQkgKiBjb250ZXh0LCBidXQgaXQgaXMgc3RpbGwgcXVpdGUgbGlrZWx5IHdoZW4gdGhpcw0KLQkJ
CSAqIGZ1bmN0aW9uIGlzIHVzZWQgbXVsdGlwbGUgdGltZXMuIFNvIGF0dGVtcHQgdG8gb3JkZXIN
Ci0JCQkgKiB0aGUgZmVuY2VzIGJ5IGNvbnRleHQgYXMgd2UgcGFzcyBvdmVyIHRoZW0gYW5kIG1l
cmdlDQotCQkJICogZmVuY2VzIHdpdGggdGhlIHNhbWUgY29udGV4dC4NCi0JCQkgKi8NCi0JCQlp
ZiAoIXRtcCB8fCB0bXAtPmNvbnRleHQgPiBuZXh0LT5jb250ZXh0KSB7DQotCQkJCXRtcCA9IG5l
eHQ7DQotCQkJCXNlbCA9IGk7DQotDQotCQkJfSBlbHNlIGlmICh0bXAtPmNvbnRleHQgPCBuZXh0
LT5jb250ZXh0KSB7DQotCQkJCWNvbnRpbnVlOw0KLQ0KLQkJCX0gZWxzZSBpZiAoZG1hX2ZlbmNl
X2lzX2xhdGVyKHRtcCwgbmV4dCkpIHsNCi0JCQkJZmVuY2VzW2ldID0gZG1hX2ZlbmNlX3Vud3Jh
cF9uZXh0KCZpdGVyW2ldKTsNCi0JCQkJZ290byByZXN0YXJ0Ow0KKwlmb3IgKGkgPSAwOyBpIDwg
bnVtX2ZlbmNlczsgKytpKSB7DQorCQlkbWFfZmVuY2VfdW53cmFwX2Zvcl9lYWNoKHRtcCwgJml0
ZXJbaV0sIGZlbmNlc1tpXSkgew0KKwkJCWlmICghZG1hX2ZlbmNlX2lzX3NpZ25hbGVkKHRtcCkp
IHsNCisJCQkJYXJyYXlbY291bnQrK10gPSBkbWFfZmVuY2VfZ2V0KHRtcCk7DQogCQkJfSBlbHNl
IHsNCi0JCQkJZmVuY2VzW3NlbF0gPSBkbWFfZmVuY2VfdW53cmFwX25leHQoJml0ZXJbc2VsXSk7
DQotCQkJCWdvdG8gcmVzdGFydDsNCisJCQkJa3RpbWVfdCB0ID0gZG1hX2ZlbmNlX3RpbWVzdGFt
cCh0bXApOw0KKw0KKwkJCQlpZiAoa3RpbWVfYWZ0ZXIodCwgdGltZXN0YW1wKSkNCisJCQkJCXRp
bWVzdGFtcCA9IHQ7DQogCQkJfQ0KIAkJfQ0KKwl9DQogDQotCQlpZiAodG1wKSB7DQotCQkJYXJy
YXlbY291bnQrK10gPSBkbWFfZmVuY2VfZ2V0KHRtcCk7DQotCQkJZmVuY2VzW3NlbF0gPSBkbWFf
ZmVuY2VfdW53cmFwX25leHQoJml0ZXJbc2VsXSk7DQotCQl9DQotCX0gd2hpbGUgKHRtcCk7DQor
CWlmIChjb3VudCA9PSAwIHx8IGNvdW50ID09IDEpDQorCQlnb3RvIHJldHVybl9mYXN0cGF0aDsN
CiANCi0JaWYgKGNvdW50ID09IDApIHsNCi0JCXRtcCA9IGRtYV9mZW5jZV9hbGxvY2F0ZV9wcml2
YXRlX3N0dWIoa3RpbWVfZ2V0KCkpOw0KLQkJZ290byByZXR1cm5fdG1wOw0KLQl9DQorCXNvcnQo
YXJyYXksIGNvdW50LCBzaXplb2YoKmFycmF5KSwgZmVuY2VfY21wLCBOVUxMKTsNCiANCi0JaWYg
KGNvdW50ID09IDEpIHsNCi0JCXRtcCA9IGFycmF5WzBdOw0KLQkJZ290byByZXR1cm5fdG1wOw0K
KwkvKg0KKwkgKiBPbmx5IGtlZXAgdGhlIG1vc3QgcmVjZW50IGZlbmNlIGZvciBlYWNoIGNvbnRl
eHQuDQorCSAqLw0KKwlqID0gMDsNCisJZm9yIChpID0gMTsgaSA8IGNvdW50OyBpKyspIHsNCisJ
CWlmIChhcnJheVtpXS0+Y29udGV4dCA9PSBhcnJheVtqXS0+Y29udGV4dCkNCisJCQlkbWFfZmVu
Y2VfcHV0KGFycmF5W2ldKTsNCisJCWVsc2UNCisJCQlhcnJheVsrK2pdID0gYXJyYXlbaV07DQog
CX0NCisJY291bnQgPSArK2o7DQogDQotCXJlc3VsdCA9IGRtYV9mZW5jZV9hcnJheV9jcmVhdGUo
Y291bnQsIGFycmF5LA0KLQkJCQkJZG1hX2ZlbmNlX2NvbnRleHRfYWxsb2MoMSksDQotCQkJCQkx
LCBmYWxzZSk7DQotCWlmICghcmVzdWx0KSB7DQotCQlmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkr
KykNCi0JCQlkbWFfZmVuY2VfcHV0KGFycmF5W2ldKTsNCi0JCXRtcCA9IE5VTEw7DQotCQlnb3Rv
IHJldHVybl90bXA7DQorCWlmIChjb3VudCA+IDEpIHsNCisJCXJlc3VsdCA9IGRtYV9mZW5jZV9h
cnJheV9jcmVhdGUoY291bnQsIGFycmF5LA0KKwkJCQkJCWRtYV9mZW5jZV9jb250ZXh0X2FsbG9j
KDEpLA0KKwkJCQkJCTEsIGZhbHNlKTsNCisJCWlmICghcmVzdWx0KSB7DQorCQkJZm9yIChpID0g
MDsgaSA8IGNvdW50OyBpKyspDQorCQkJCWRtYV9mZW5jZV9wdXQoYXJyYXlbaV0pOw0KKwkJCXRt
cCA9IE5VTEw7DQorCQkJZ290byByZXR1cm5fdG1wOw0KKwkJfQ0KKwkJcmV0dXJuICZyZXN1bHQt
PmJhc2U7DQogCX0NCi0JcmV0dXJuICZyZXN1bHQtPmJhc2U7DQorDQorcmV0dXJuX2Zhc3RwYXRo
Og0KKwlpZiAoY291bnQgPT0gMCkNCisJCXRtcCA9IGRtYV9mZW5jZV9hbGxvY2F0ZV9wcml2YXRl
X3N0dWIodGltZXN0YW1wKTsNCisJZWxzZQ0KKwkJdG1wID0gYXJyYXlbMF07DQogDQogcmV0dXJu
X3RtcDoNCiAJa2ZyZWUoYXJyYXkpOw0KDQoNCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fCkxpbmFyby1tbS1zaWcgbWFpbGluZyBsaXN0IC0tIGxpbmFyby1t
bS1zaWdAbGlzdHMubGluYXJvLm9yZwpUbyB1bnN1YnNjcmliZSBzZW5kIGFuIGVtYWlsIHRvIGxp
bmFyby1tbS1zaWctbGVhdmVAbGlzdHMubGluYXJvLm9yZwo=
