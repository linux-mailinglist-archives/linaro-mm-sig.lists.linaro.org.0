Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 12B9E1D1722
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 13 May 2020 16:10:49 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 34E3065F8C
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 13 May 2020 14:10:48 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 2750465F8F; Wed, 13 May 2020 14:10:48 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-7.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_HI,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,SPF_HELO_PASS
	autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id A91F566576;
	Wed, 13 May 2020 13:37:29 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id AE2D865FA5
 for <linaro-mm-sig@lists.linaro.org>; Wed, 13 May 2020 13:37:21 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 8DAC36657B; Wed, 13 May 2020 13:37:21 +0000 (UTC)
Received: from mailout1.w1.samsung.com (mailout1.w1.samsung.com
 [210.118.77.11])
 by lists.linaro.org (Postfix) with ESMTPS id E227B65FA5
 for <linaro-mm-sig@lists.linaro.org>; Wed, 13 May 2020 13:33:26 +0000 (UTC)
Received: from eucas1p1.samsung.com (unknown [182.198.249.206])
 by mailout1.w1.samsung.com (KnoxPortal) with ESMTP id
 20200513133326euoutp01db279949b731596451679b916e0b9e54~OmcjLm5LW2150421504euoutp01S
 for <linaro-mm-sig@lists.linaro.org>; Wed, 13 May 2020 13:33:26 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout1.w1.samsung.com
 20200513133326euoutp01db279949b731596451679b916e0b9e54~OmcjLm5LW2150421504euoutp01S
Received: from eusmges2new.samsung.com (unknown [203.254.199.244]) by
 eucas1p1.samsung.com (KnoxPortal) with ESMTP id
 20200513133325eucas1p16a0d8a2b6db49bfbbcb8114295e3fc17~OmcizHp0R0608106081eucas1p1Q;
 Wed, 13 May 2020 13:33:25 +0000 (GMT)
Received: from eucas1p1.samsung.com ( [182.198.249.206]) by
 eusmges2new.samsung.com (EUCPMTA) with SMTP id 2B.11.60679.527FBBE5; Wed, 13
 May 2020 14:33:25 +0100 (BST)
Received: from eusmtrp1.samsung.com (unknown [182.198.249.138]) by
 eucas1p1.samsung.com (KnoxPortal) with ESMTPA id
 20200513133325eucas1p1c8faf557b23b5d171b7c328eca5f6482~Omciakj5y0784607846eucas1p1I;
 Wed, 13 May 2020 13:33:25 +0000 (GMT)
Received: from eusmgms2.samsung.com (unknown [182.198.249.180]) by
 eusmtrp1.samsung.com (KnoxPortal) with ESMTP id
 20200513133325eusmtrp1e4f940dd4a4d1413d24c15726e0540f7~OmciZnsBq1050710507eusmtrp1e;
 Wed, 13 May 2020 13:33:25 +0000 (GMT)
X-AuditID: cbfec7f4-0cbff7000001ed07-7e-5ebbf72576ce
Received: from eusmtip1.samsung.com ( [203.254.199.221]) by
 eusmgms2.samsung.com (EUCPMTA) with SMTP id 41.57.07950.527FBBE5; Wed, 13
 May 2020 14:33:25 +0100 (BST)
Received: from AMDC2765.digital.local (unknown [106.120.51.73]) by
 eusmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200513133324eusmtip1b7de34a68017f5899adbdae6b9962816~OmchmXAM00741507415eusmtip1s;
 Wed, 13 May 2020 13:33:24 +0000 (GMT)
From: Marek Szyprowski <m.szyprowski@samsung.com>
To: dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
Date: Wed, 13 May 2020 15:32:45 +0200
Message-Id: <20200513133245.6408-38-m.szyprowski@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200513133245.6408-1-m.szyprowski@samsung.com>
X-Brightmail-Tracker: H4sIAAAAAAAAA0WSa0gUURTHuzOzM6O4Na5CN42iBYOCNFPimha9GSpCgvoQaW05rZK7yo5a
 1ocWRXPXLewBiYWZRJqv1fWRaWrqppWP8pFmru8s1toerFppWDvOVt9+53/+/3MOl0vjshaJ
 Fx2ljuM0akW0nHQlqlp+dm7w+V4bvrGrbj263PkcQ2WZRgn6XXUVR70zX0j0oPAphnIaglFH
 0icKTfeOYcg00SdBPTW3SWQorZSgYvMQhe6bfmHohu0nhRq/vpNsX8YWZRcBtm42h2BNBTqS
 fTg7KmFH0lsxtvzeRXZwYQJnr7/JA2ztgJZkJ+asJHulogCwdtOqULejriERXHRUAqfx23bC
 NfLu8DwVO3jo3KVbVokWWHbrgQsNmUDY/XiY0gNXWsbkA5j90UyKxTSAXdkdzo4dQHvVZ/xv
 ZHxiyOnKA3AktxIIjcXIiyxMYJLxh3qbnhTYk0kB8NllNyGAM2U4bBkxLk7yYPbD7PmvhMAE
 4wO7S4oogaXMVtjzJdm5bTUsLH2yyC4OfcrSQAiDINNHwUFbKiGadsO2hVxKZA841Vrh5JWw
 7brBGUgGcKyzmBILA4A9SZlAdAVDS+ec41bacd86aKzxE+UdsL/dTAgyZJbCNzZ3QcYdeK3q
 Ji7KUpiWKhPda2FWa8m/tY2vup33s/BH3jwmvlYzgMU940QGWJ31f1kOAAVgORfPq5Qcv0nN
 nfXlFSo+Xq30PRWjMgHH72pbaJ2uBjW/TjYBhgZyNyl6WxsukygS+ERVE4A0LveUHjQ6JGmE
 IvE8p4k5romP5vgm4E0T8uXSgFxrmIxRKuK4MxwXy2n+djHaxUsL9BdMRn+0q31Nsy6fSZ+D
 327ltYeVB/s0z/jvsYY1TnJdcan90vrkl/t0o7rJY9TrvvA7Ge8fKUNnT38IsiyBZcNH+C1B
 KScOXKk1bBvbl5gxEJm2eQWWZnGvzwzJz79UYg6oTn9YEOh9OHQ8San16N9ZTlu8bS72I4Fn
 gpi9qXKCj1T4r8c1vOIPe7I8r1kDAAA=
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrBIsWRmVeSWpSXmKPExsVy+t/xu7qq33fHGdw9x2/Re+4kk8XGGetZ
 Lf5vm8hsceXrezaLlauPMlks2G9tcbbpDbvFlysPmSw2Pb7GanF51xw2i54NW1kt1h65y26x
 bNMfJospb3+yWxz88ITVgd9jzbw1jB57vy1g8di0qpPNY/u3B6we97uPM3lsXlLvcfvfY2aP
 yTeWM3rsvtnA5vH410s2j74tqxg9Pm+SC+CJ0rMpyi8tSVXIyC8usVWKNrQw0jO0tNAzMrHU
 MzQ2j7UyMlXSt7NJSc3JLEst0rdL0MtYeO83e8HtoIr22S9ZGxjvuHQxcnJICJhIPHp8l62L
 kYtDSGApo8Tkw8+ZIRIyEienNbBC2MISf651QRV9YpR43/qcCSTBJmAo0fUWIiEi0MkoMa37
 IzuIwyywm1li3eE9YO3CAt4S835/YAGxWQRUJS6tW8MOYvMK2Epcft8MtU5eYvWGA2A2J1D8
 1Z39YPVCAvkSexfvY5vAyLeAkWEVo0hqaXFuem6xkV5xYm5xaV66XnJ+7iZGYCxtO/Zzyw7G
 rnfBhxgFOBiVeHgtbu2OE2JNLCuuzD3EKMHBrCTC67ceKMSbklhZlVqUH19UmpNafIjRFOio
 icxSosn5wDjPK4k3NDU0t7A0NDc2NzazUBLn7RA4GCMkkJ5YkpqdmlqQWgTTx8TBKdXAWCS0
 /46FmXfv4VmNrY7FKzI2a+yU4OCJue4yr2PzRa1L2k5Svvb75D59LH1lMu/a89iXF75vezrj
 Uvzq2t4J+RusFezDOaK52G6YliR8Lr7f8cjN1qZTb/OsKtswu4oJcVtzbqRwXr69rpx1jXS8
 XTZfSEOhhudM1VTZg32r+Z7NmCg56XauEktxRqKhFnNRcSIA5BMrEbsCAAA=
X-CMS-MailID: 20200513133325eucas1p1c8faf557b23b5d171b7c328eca5f6482
X-Msg-Generator: CA
X-RootMTR: 20200513133325eucas1p1c8faf557b23b5d171b7c328eca5f6482
X-EPHeader: CA
CMS-TYPE: 201P
X-CMS-RootMailID: 20200513133325eucas1p1c8faf557b23b5d171b7c328eca5f6482
References: <20200513132114.6046-1-m.szyprowski@samsung.com>
 <20200513133245.6408-1-m.szyprowski@samsung.com>
 <CGME20200513133325eucas1p1c8faf557b23b5d171b7c328eca5f6482@eucas1p1.samsung.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Pawel Osciak <pawel@osciak.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, linux-media@vger.kernel.org,
 Kyungmin Park <kyungmin.park@samsung.com>, Daniel Vetter <daniel@ffwll.ch>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Robin Murphy <robin.murphy@arm.com>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH v5 38/38] videobuf2: use sgtable-based
	scatterlist wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VXNlIHJlY2VudGx5IGludHJvZHVjZWQgY29tbW9uIHdyYXBwZXJzIG9wZXJhdGluZyBkaXJlY3Rs
eSBvbiB0aGUgc3RydWN0CnNnX3RhYmxlIG9iamVjdHMgYW5kIHNjYXR0ZXJsaXN0IHBhZ2UgaXRl
cmF0b3JzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQKbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2ll
ciB0byBmb2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLCBi
ZWNhdXNlIHRoZSBjb2RlIGFscmVhZHkgcHJvcGVybHkgZGlkIGFsbCB0aGUKc2NhdGVybGlzdCBy
ZWxhdGVkIGNhbGxzLgoKU2lnbmVkLW9mZi1ieTogTWFyZWsgU3p5cHJvd3NraSA8bS5zenlwcm93
c2tpQHNhbXN1bmcuY29tPgotLS0KRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZSAnW1BBVENIIHY1
IDAwLzM4XSBEUk06IGZpeCBzdHJ1Y3Qgc2dfdGFibGUgbmVudHMKdnMuIG9yaWdfbmVudHMgbWlz
dXNlJyB0aHJlYWQ6Cmh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL2xpbnV4LWlvbW11LzIwMjAwNTEz
MTMyMTE0LjYwNDYtMS1tLnN6eXByb3dza2lAc2Ftc3VuZy5jb20vVC8KLS0tCiAuLi4vbWVkaWEv
Y29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jICB8IDQxICsrKysrKysrKyst
LS0tLS0tLS0tLS0KIGRyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1h
LXNnLmMgIHwgMzIgKysrKysrKy0tLS0tLS0tLS0KIGRyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVv
YnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jIHwgMTIgKysrLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCAz
NCBpbnNlcnRpb25zKCspLCA1MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL21l
ZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1jb250aWcuYyBiL2RyaXZlcnMvbWVk
aWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCmluZGV4IGQzYTNlZTUu
LmJmMzFhOWQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRl
b2J1ZjItZG1hLWNvbnRpZy5jCisrKyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92
aWRlb2J1ZjItZG1hLWNvbnRpZy5jCkBAIC00OCwxNiArNDgsMTUgQEAgc3RydWN0IHZiMl9kY19i
dWYgewogCiBzdGF0aWMgdW5zaWduZWQgbG9uZyB2YjJfZGNfZ2V0X2NvbnRpZ3VvdXNfc2l6ZShz
dHJ1Y3Qgc2dfdGFibGUgKnNndCkKIHsKLQlzdHJ1Y3Qgc2NhdHRlcmxpc3QgKnM7CiAJZG1hX2Fk
ZHJfdCBleHBlY3RlZCA9IHNnX2RtYV9hZGRyZXNzKHNndC0+c2dsKTsKLQl1bnNpZ25lZCBpbnQg
aTsKKwlzdHJ1Y3Qgc2dfZG1hX3BhZ2VfaXRlciBkbWFfaXRlcjsKIAl1bnNpZ25lZCBsb25nIHNp
emUgPSAwOwogCi0JZm9yX2VhY2hfc2coc2d0LT5zZ2wsIHMsIHNndC0+bmVudHMsIGkpIHsKLQkJ
aWYgKHNnX2RtYV9hZGRyZXNzKHMpICE9IGV4cGVjdGVkKQorCWZvcl9lYWNoX3NndGFibGVfZG1h
X3BhZ2Uoc2d0LCAmZG1hX2l0ZXIsIDApIHsKKwkJaWYgKHNnX3BhZ2VfaXRlcl9kbWFfYWRkcmVz
cygmZG1hX2l0ZXIpICE9IGV4cGVjdGVkKQogCQkJYnJlYWs7Ci0JCWV4cGVjdGVkID0gc2dfZG1h
X2FkZHJlc3MocykgKyBzZ19kbWFfbGVuKHMpOwotCQlzaXplICs9IHNnX2RtYV9sZW4ocyk7CisJ
CWV4cGVjdGVkICs9IFBBR0VfU0laRTsKKwkJc2l6ZSArPSBQQUdFX1NJWkU7CiAJfQogCXJldHVy
biBzaXplOwogfQpAQCAtOTksOCArOTgsNyBAQCBzdGF0aWMgdm9pZCB2YjJfZGNfcHJlcGFyZSh2
b2lkICpidWZfcHJpdikKIAlpZiAoIXNndCB8fCBidWYtPmRiX2F0dGFjaCkKIAkJcmV0dXJuOwog
Ci0JZG1hX3N5bmNfc2dfZm9yX2RldmljZShidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19u
ZW50cywKLQkJCSAgICAgICBidWYtPmRtYV9kaXIpOworCWRtYV9zeW5jX3NndGFibGVfZm9yX2Rl
dmljZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwogfQogCiBzdGF0aWMgdm9pZCB2YjJf
ZGNfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQpAQCAtMTEyLDcgKzExMCw3IEBAIHN0YXRpYyB2b2lk
IHZiMl9kY19maW5pc2godm9pZCAqYnVmX3ByaXYpCiAJaWYgKCFzZ3QgfHwgYnVmLT5kYl9hdHRh
Y2gpCiAJCXJldHVybjsKIAotCWRtYV9zeW5jX3NnX2Zvcl9jcHUoYnVmLT5kZXYsIHNndC0+c2ds
LCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2Rpcik7CisJZG1hX3N5bmNfc2d0YWJsZV9mb3Jf
Y3B1KGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9CiAKIC8qKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCkBAIC0yNzMsOCArMjcxLDggQEAgc3RhdGlj
IHZvaWQgdmIyX2RjX2RtYWJ1Zl9vcHNfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVmLAogCQkg
KiBtZW1vcnkgbG9jYXRpb25zIGRvIG5vdCByZXF1aXJlIGFueSBleHBsaWNpdCBjYWNoZQogCQkg
KiBtYWludGVuYW5jZSBwcmlvciBvciBhZnRlciBiZWluZyB1c2VkIGJ5IHRoZSBkZXZpY2UuCiAJ
CSAqLwotCQlkbWFfdW5tYXBfc2dfYXR0cnMoZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3Qt
Pm9yaWdfbmVudHMsCi0JCQkJICAgYXR0YWNoLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5k
bWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJc2dfZnJlZV90YWJsZShz
Z3QpOwogCWtmcmVlKGF0dGFjaCk7CiAJZGJfYXR0YWNoLT5wcml2ID0gTlVMTDsKQEAgLTI5OSw4
ICsyOTcsOCBAQCBzdGF0aWMgc3RydWN0IHNnX3RhYmxlICp2YjJfZGNfZG1hYnVmX29wc19tYXAo
CiAKIAkvKiByZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9k
aXIgIT0gRE1BX05PTkUpIHsKLQkJZG1hX3VubWFwX3NnX2F0dHJzKGRiX2F0dGFjaC0+ZGV2LCBz
Z3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgIGF0dGFjaC0+ZG1hX2RpciwgRE1BX0FU
VFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBz
Z3QsIGF0dGFjaC0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwogCQlh
dHRhY2gtPmRtYV9kaXIgPSBETUFfTk9ORTsKIAl9CiAKQEAgLTMwOCw5ICszMDYsOCBAQCBzdGF0
aWMgc3RydWN0IHNnX3RhYmxlICp2YjJfZGNfZG1hYnVmX29wc19tYXAoCiAJICogbWFwcGluZyB0
byB0aGUgY2xpZW50IHdpdGggbmV3IGRpcmVjdGlvbiwgbm8gY2FjaGUgc3luYwogCSAqIHJlcXVp
cmVkIHNlZSBjb21tZW50IGluIHZiMl9kY19kbWFidWZfb3BzX2RldGFjaCgpCiAJICovCi0Jc2d0
LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3Qt
Pm9yaWdfbmVudHMsCi0JCQkJICAgICAgZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7
Ci0JaWYgKCFzZ3QtPm5lbnRzKSB7CisJaWYgKGRtYV9tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRl
diwgc2d0LCBkbWFfZGlyLAorCQkJICAgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpKSB7CiAJCXBy
X2VycigiZmFpbGVkIHRvIG1hcCBzY2F0dGVybGlzdFxuIik7CiAJCW11dGV4X3VubG9jayhsb2Nr
KTsKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTyk7CkBAIC00MjMsOCArNDIwLDggQEAgc3RhdGljIHZv
aWQgdmIyX2RjX3B1dF91c2VycHRyKHZvaWQgKmJ1Zl9wcml2KQogCQkgKiBObyBuZWVkIHRvIHN5
bmMgdG8gQ1BVLCBpdCdzIGFscmVhZHkgc3luY2VkIHRvIHRoZSBDUFUKIAkJICogc2luY2UgdGhl
IGZpbmlzaCgpIG1lbW9wIHdpbGwgaGF2ZSBiZWVuIGNhbGxlZCBiZWZvcmUgdGhpcy4KIAkJICov
Ci0JCWRtYV91bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50
cywKLQkJCQkgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOworCQlkbWFf
dW5tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkJICBETUFfQVRU
Ul9TS0lQX0NQVV9TWU5DKTsKIAkJcGFnZXMgPSBmcmFtZV92ZWN0b3JfcGFnZXMoYnVmLT52ZWMp
OwogCQkvKiBzZ3Qgc2hvdWxkIGV4aXN0IG9ubHkgaWYgdmVjdG9yIGNvbnRhaW5zIHBhZ2VzLi4u
ICovCiAJCUJVR19PTihJU19FUlIocGFnZXMpKTsKQEAgLTUyMSw5ICs1MTgsOCBAQCBzdGF0aWMg
dm9pZCAqdmIyX2RjX2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgbG9u
ZyB2YWRkciwKIAkgKiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwgdGhpcyB3aWxsIGhh
cHBlbiBsYXRlciB3aGVuIHRoZQogCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBjYWxsZWQuCiAJICov
Ci0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3Qt
Pm9yaWdfbmVudHMsCi0JCQkJICAgICAgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKLQlpZiAoc2d0LT5uZW50cyA8PSAwKSB7CisJaWYgKGRtYV9tYXBfc2d0YWJsZShidWYt
PmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykp
IHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJcmV0ID0gLUVJ
TzsKIAkJZ290byBmYWlsX3NndF9pbml0OwpAQCAtNTQ1LDggKzU0MSw3IEBAIHN0YXRpYyB2b2lk
ICp2YjJfZGNfZ2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIHZh
ZGRyLAogCXJldHVybiBidWY7CiAKIGZhaWxfbWFwX3NnOgotCWRtYV91bm1hcF9zZ19hdHRycyhi
dWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCSAgIGJ1Zi0+ZG1hX2Rpciwg
RE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJZG1hX3VubWFwX3NndGFibGUoYnVmLT5kZXYsIHNn
dCwgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAogZmFpbF9zZ3RfaW5p
dDoKIAlzZ19mcmVlX3RhYmxlKHNndCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NvbW1v
bi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jIGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlk
ZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYwppbmRleCA5MjA3MmEwLi42ZGRmOTUzIDEwMDY0NAot
LS0gYS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jCisr
KyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMKQEAg
LTE0Miw5ICsxNDIsOCBAQCBzdGF0aWMgdm9pZCAqdmIyX2RtYV9zZ19hbGxvYyhzdHJ1Y3QgZGV2
aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgZG1hX2F0dHJzLAogCSAqIE5vIG5lZWQgdG8gc3luYyB0
byB0aGUgZGV2aWNlLCB0aGlzIHdpbGwgaGFwcGVuIGxhdGVyIHdoZW4gdGhlCiAJICogcHJlcGFy
ZSgpIG1lbW9wIGlzIGNhbGxlZC4KIAkgKi8KLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZ19hdHRy
cyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICAgICBidWYtPmRt
YV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwotCWlmICghc2d0LT5uZW50cykKKwlpZiAo
ZG1hX21hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCSAgICBETUFf
QVRUUl9TS0lQX0NQVV9TWU5DKSkgewogCQlnb3RvIGZhaWxfbWFwOwogCiAJYnVmLT5oYW5kbGVy
LnJlZmNvdW50ID0gJmJ1Zi0+cmVmY291bnQ7CkBAIC0xODAsOCArMTc5LDggQEAgc3RhdGljIHZv
aWQgdmIyX2RtYV9zZ19wdXQodm9pZCAqYnVmX3ByaXYpCiAJaWYgKHJlZmNvdW50X2RlY19hbmRf
dGVzdCgmYnVmLT5yZWZjb3VudCkpIHsKIAkJZHByaW50aygxLCAiJXM6IEZyZWVpbmcgYnVmZmVy
IG9mICVkIHBhZ2VzXG4iLCBfX2Z1bmNfXywKIAkJCWJ1Zi0+bnVtX3BhZ2VzKTsKLQkJZG1hX3Vu
bWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAg
IGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91bm1hcF9zZ3Rh
YmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRSX1NLSVBfQ1BV
X1NZTkMpOwogCQlpZiAoYnVmLT52YWRkcikKIAkJCXZtX3VubWFwX3JhbShidWYtPnZhZGRyLCBi
dWYtPm51bV9wYWdlcyk7CiAJCXNnX2ZyZWVfdGFibGUoYnVmLT5kbWFfc2d0KTsKQEAgLTIwMiw4
ICsyMDEsNyBAQCBzdGF0aWMgdm9pZCB2YjJfZG1hX3NnX3ByZXBhcmUodm9pZCAqYnVmX3ByaXYp
CiAJaWYgKGJ1Zi0+ZGJfYXR0YWNoKQogCQlyZXR1cm47CiAKLQlkbWFfc3luY19zZ19mb3JfZGV2
aWNlKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJICAgICAgIGJ1Zi0+
ZG1hX2Rpcik7CisJZG1hX3N5bmNfc2d0YWJsZV9mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1
Zi0+ZG1hX2Rpcik7CiB9CiAKIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNoKHZvaWQgKmJ1
Zl9wcml2KQpAQCAtMjE1LDcgKzIxMyw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNo
KHZvaWQgKmJ1Zl9wcml2KQogCWlmIChidWYtPmRiX2F0dGFjaCkKIAkJcmV0dXJuOwogCi0JZG1h
X3N5bmNfc2dfZm9yX2NwdShidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywgYnVm
LT5kbWFfZGlyKTsKKwlkbWFfc3luY19zZ3RhYmxlX2Zvcl9jcHUoYnVmLT5kZXYsIHNndCwgYnVm
LT5kbWFfZGlyKTsKIH0KIAogc3RhdGljIHZvaWQgKnZiMl9kbWFfc2dfZ2V0X3VzZXJwdHIoc3Ry
dWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIHZhZGRyLApAQCAtMjU4LDkgKzI1Niw4IEBA
IHN0YXRpYyB2b2lkICp2YjJfZG1hX3NnX2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwg
dW5zaWduZWQgbG9uZyB2YWRkciwKIAkgKiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwg
dGhpcyB3aWxsIGhhcHBlbiBsYXRlciB3aGVuIHRoZQogCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBj
YWxsZWQuCiAJICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNn
dC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgICAgYnVmLT5kbWFfZGlyLCBETUFfQVRU
Ul9TS0lQX0NQVV9TWU5DKTsKLQlpZiAoIXNndC0+bmVudHMpCisJaWYgKGRtYV9tYXBfc2d0YWJs
ZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVf
U1lOQykpIHsKIAkJZ290byB1c2VycHRyX2ZhaWxfbWFwOwogCiAJcmV0dXJuIGJ1ZjsKQEAgLTI4
Niw4ICsyODMsNyBAQCBzdGF0aWMgdm9pZCB2YjJfZG1hX3NnX3B1dF91c2VycHRyKHZvaWQgKmJ1
Zl9wcml2KQogCiAJZHByaW50aygxLCAiJXM6IFJlbGVhc2luZyB1c2Vyc3BhY2UgYnVmZmVyIG9m
ICVkIHBhZ2VzXG4iLAogCSAgICAgICBfX2Z1bmNfXywgYnVmLT5udW1fcGFnZXMpOwotCWRtYV91
bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywgYnVmLT5k
bWFfZGlyLAotCQkJICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJZG1hX3VubWFwX3NndGFi
bGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsK
IAlpZiAoYnVmLT52YWRkcikKIAkJdm1fdW5tYXBfcmFtKGJ1Zi0+dmFkZHIsIGJ1Zi0+bnVtX3Bh
Z2VzKTsKIAlzZ19mcmVlX3RhYmxlKGJ1Zi0+ZG1hX3NndCk7CkBAIC00MTAsOCArNDA2LDcgQEAg
c3RhdGljIHZvaWQgdmIyX2RtYV9zZ19kbWFidWZfb3BzX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAq
ZGJ1ZiwKIAogCS8qIHJlbGVhc2UgdGhlIHNjYXR0ZXJsaXN0IGNhY2hlICovCiAJaWYgKGF0dGFj
aC0+ZG1hX2RpciAhPSBETUFfTk9ORSkKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBz
Z3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3Vu
bWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyKTsKIAlzZ19m
cmVlX3RhYmxlKHNndCk7CiAJa2ZyZWUoYXR0YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxM
OwpAQCAtNDM2LDE1ICs0MzEsMTIgQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqdmIyX2RtYV9z
Z19kbWFidWZfb3BzX21hcCgKIAogCS8qIHJlbGVhc2UgYW55IHByZXZpb3VzIGNhY2hlICovCiAJ
aWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9ORSkgewotCQlkbWFfdW5tYXBfc2coZGJfYXR0
YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQlhdHRhY2gtPmRtYV9kaXIp
OworCQlkbWFfdW5tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9k
aXIpOwogCQlhdHRhY2gtPmRtYV9kaXIgPSBETUFfTk9ORTsKIAl9CiAKIAkvKiBtYXBwaW5nIHRv
IHRoZSBjbGllbnQgd2l0aCBuZXcgZGlyZWN0aW9uICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBf
c2coZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJZG1hX2Rp
cik7Ci0JaWYgKCFzZ3QtPm5lbnRzKSB7CisJaWYgKGRtYV9tYXBfc2d0YWJsZShkYl9hdHRhY2gt
PmRldiwgc2d0LCBkbWFfZGlyLCAwKSkgewogCQlwcl9lcnIoImZhaWxlZCB0byBtYXAgc2NhdHRl
cmxpc3RcbiIpOwogCQltdXRleF91bmxvY2sobG9jayk7CiAJCXJldHVybiBFUlJfUFRSKC1FSU8p
OwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi12
bWFsbG9jLmMgYi9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLXZtYWxs
b2MuYwppbmRleCBjNjZmZGE0Li5iZjVhYzYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL21lZGlhL2Nv
bW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLXZtYWxsb2MuYworKysgYi9kcml2ZXJzL21lZGlhL2Nv
bW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLXZtYWxsb2MuYwpAQCAtMjI5LDcgKzIyOSw3IEBAIHN0
YXRpYyBpbnQgdmIyX3ZtYWxsb2NfZG1hYnVmX29wc19hdHRhY2goc3RydWN0IGRtYV9idWYgKmRi
dWYsCiAJCWtmcmVlKGF0dGFjaCk7CiAJCXJldHVybiByZXQ7CiAJfQotCWZvcl9lYWNoX3NnKHNn
dC0+c2dsLCBzZywgc2d0LT5uZW50cywgaSkgeworCWZvcl9lYWNoX3NndGFibGVfc2coc2d0LCBz
ZywgaSkgewogCQlzdHJ1Y3QgcGFnZSAqcGFnZSA9IHZtYWxsb2NfdG9fcGFnZSh2YWRkcik7CiAK
IAkJaWYgKCFwYWdlKSB7CkBAIC0yNTksOCArMjU5LDcgQEAgc3RhdGljIHZvaWQgdmIyX3ZtYWxs
b2NfZG1hYnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCiAKIAkvKiByZWxlYXNl
IHRoZSBzY2F0dGVybGlzdCBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05P
TkUpCi0JCWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19u
ZW50cywKLQkJCWF0dGFjaC0+ZG1hX2Rpcik7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFj
aC0+ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwgMCk7CiAJc2dfZnJlZV90YWJsZShzZ3QpOwog
CWtmcmVlKGF0dGFjaCk7CiAJZGJfYXR0YWNoLT5wcml2ID0gTlVMTDsKQEAgLTI4NSwxNSArMjg0
LDEyIEBAIHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl92bWFsbG9jX2RtYWJ1Zl9vcHNfbWFw
KAogCiAJLyogcmVsZWFzZSBhbnkgcHJldmlvdXMgY2FjaGUgKi8KIAlpZiAoYXR0YWNoLT5kbWFf
ZGlyICE9IERNQV9OT05FKSB7Ci0JCWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5z
Z2wsIHNndC0+b3JpZ19uZW50cywKLQkJCWF0dGFjaC0+ZG1hX2Rpcik7CisJCWRtYV91bm1hcF9z
Z3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwgMCk7CiAJCWF0dGFj
aC0+ZG1hX2RpciA9IERNQV9OT05FOwogCX0KIAogCS8qIG1hcHBpbmcgdG8gdGhlIGNsaWVudCB3
aXRoIG5ldyBkaXJlY3Rpb24gKi8KLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZyhkYl9hdHRhY2gt
PmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQlkbWFfZGlyKTsKLQlpZiAoIXNn
dC0+bmVudHMpIHsKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGRt
YV9kaXIsIDApKSB7CiAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBzY2F0dGVybGlzdFxuIik7CiAJ
CW11dGV4X3VubG9jayhsb2NrKTsKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTyk7Ci0tIAoxLjkuMQoK
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1t
LXNpZyBtYWlsaW5nIGxpc3QKTGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCmh0dHBzOi8v
bGlzdHMubGluYXJvLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbmFyby1tbS1zaWcK
