Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id AB668200782
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 19 Jun 2020 13:09:23 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id CBA35665BE
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 19 Jun 2020 11:09:22 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id BEBD7665BF; Fri, 19 Jun 2020 11:09:22 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_BLOCKED,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,
	SPF_HELO_PASS autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 66DAE6670E;
	Fri, 19 Jun 2020 10:40:28 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id DEBF5666EE
 for <linaro-mm-sig@lists.linaro.org>; Fri, 19 Jun 2020 10:39:32 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id C22BA665D9; Fri, 19 Jun 2020 10:39:32 +0000 (UTC)
Received: from mailout1.w1.samsung.com (mailout1.w1.samsung.com
 [210.118.77.11])
 by lists.linaro.org (Postfix) with ESMTPS id 9F484665D9
 for <linaro-mm-sig@lists.linaro.org>; Fri, 19 Jun 2020 10:37:19 +0000 (UTC)
Received: from eucas1p1.samsung.com (unknown [182.198.249.206])
 by mailout1.w1.samsung.com (KnoxPortal) with ESMTP id
 20200619103718euoutp01df193cc8b7517255742bef4aed21e065~Z66VjKzYa1896418964euoutp01S
 for <linaro-mm-sig@lists.linaro.org>; Fri, 19 Jun 2020 10:37:18 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout1.w1.samsung.com
 20200619103718euoutp01df193cc8b7517255742bef4aed21e065~Z66VjKzYa1896418964euoutp01S
Received: from eusmges3new.samsung.com (unknown [203.254.199.245]) by
 eucas1p2.samsung.com (KnoxPortal) with ESMTP id
 20200619103718eucas1p279c5d3b6dd39f8329aaac70fbeea6c28~Z66VSCx1R1012910129eucas1p2E;
 Fri, 19 Jun 2020 10:37:18 +0000 (GMT)
Received: from eucas1p1.samsung.com ( [182.198.249.206]) by
 eusmges3new.samsung.com (EUCPMTA) with SMTP id FE.9C.06318.E559CEE5; Fri, 19
 Jun 2020 11:37:18 +0100 (BST)
Received: from eusmtrp1.samsung.com (unknown [182.198.249.138]) by
 eucas1p1.samsung.com (KnoxPortal) with ESMTPA id
 20200619103718eucas1p11cd577b435672197f48bfcba2d06bc18~Z66U-TWoX1886818868eucas1p1F;
 Fri, 19 Jun 2020 10:37:18 +0000 (GMT)
Received: from eusmgms2.samsung.com (unknown [182.198.249.180]) by
 eusmtrp1.samsung.com (KnoxPortal) with ESMTP id
 20200619103718eusmtrp1fda9e78f890c50ada601e7a901e0c506~Z66U_pH1r1007310073eusmtrp1P;
 Fri, 19 Jun 2020 10:37:18 +0000 (GMT)
X-AuditID: cbfec7f5-38bff700000018ae-92-5eec955e9134
Received: from eusmtip2.samsung.com ( [203.254.199.222]) by
 eusmgms2.samsung.com (EUCPMTA) with SMTP id DC.1B.06017.E559CEE5; Fri, 19
 Jun 2020 11:37:18 +0100 (BST)
Received: from AMDC2765.digital.local (unknown [106.120.51.73]) by
 eusmtip2.samsung.com (KnoxPortal) with ESMTPA id
 20200619103717eusmtip22d49d87032e791d6ea43be27272dd983~Z66USePPR0229502295eusmtip2o;
 Fri, 19 Jun 2020 10:37:17 +0000 (GMT)
From: Marek Szyprowski <m.szyprowski@samsung.com>
To: dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
Date: Fri, 19 Jun 2020 12:36:36 +0200
Message-Id: <20200619103636.11974-37-m.szyprowski@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200619103636.11974-1-m.szyprowski@samsung.com>
X-Brightmail-Tracker: H4sIAAAAAAAAA0VSfUgTYRzuvdvdTtvymoEvFgnri4o0UejStAyto/4wqDCKzJmHSn6xS9OK
 Wn5Eze+sNKkcZs6mZq21UuljYi4bmSuJlZnpRFPTSp2pqOV5av89v+fjfX78eAlUYsKciciY
 k4w8RhYlxe0F+obxpk3B134Eb84ec6YymxoR6mFBFUb91eeiVIvtJ07dK3+FUOYbbQJK9cKb
 GmnpQCit9SNGfai5iVMZDx5jVGV9m5Aq1U4i1NWBcSFl+NWF7XCgK25XAPrZqEpAazWXcfrJ
 6DeMbk83IvSjkvN067QVpfMsakDXflLgtHWiF6ezdBpAD2tX0m9sw8J94sP228KYqMgERu7m
 G2IfYetSI3HVgYmjyV2IAoz4KYEdAUlPaJmeECqBPSEhywC8betB+GEEwLtm3ZwyDKDl9w90
 PlLZkSLgBTWAhlwzthBpr9LPunDSHSoHlDiHl5FpAL7OFHEmlKxC4djXPMAJjuReqM5uRDgs
 INdA3dTgTJggxKQvNLZ6820usPzBy9k37Wbo/lTDbBkkO4Wwq6UB403+sOdC9xx2hH1Gbm8O
 r4CmvAwBH0gBsKOpUsgPGQB+SC4AvMsbfmmawLlmlFwPq2rceNoP6pTNgKMhuQRaBpZyNDoD
 r+jzUZ4Ww0sXJbx7LSw03l+oNTS/n7sWDWvTB3H+QLkAtpqz0BzgUvi/TAWABjgx8Wx0OMN6
 xDCnXFlZNBsfE+56PDZaC2a+mGnaaHsKnk+G1gGSAFKR+PuB/mAJJktgk6LrACRQ6TLxzrem
 YIk4TJZ0mpHHHpPHRzFsHVhOCKROYo/i3qMSMlx2kjnBMHGMfF5FCDtnBfBb7LXmzJayoMaN
 FgfNxGCpR3toAk387LPblZq7W6HyDwwShezfKqyWFY29ObNHl/ZwVb9U8tlH4+m+/Vx7hXGd
 wXtYoUwqLrcm31qUL5o8mDDUeeQsW+8bkJMjUpYoChPDp7IrApBfTl5ZQz6L1P2Oq3tN1J3r
 3a1/rhUdosXvpAI2Qua+AZWzsn9deqhcXgMAAA==
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrNIsWRmVeSWpSXmKPExsVy+t/xe7pxU9/EGTy5zWnRe+4kk8XGGetZ
 Lf5vm8hsceXrezaLlauPMllcnHmXxWLBfmuLL1ceMllsenyN1eLyrjlsFj0btrJarD1yl91i
 2aY/TBZT3v5ktzj44QmrA7/HmnlrGD32flvA4rFpVSebx/ZvD1g97ncfZ/LYvKTe4/a/x8we
 k28sZ/TYfbOBzePxr5dsHn1bVjF6fN4k53Hq62f2AN4oPZui/NKSVIWM/OISW6VoQwsjPUNL
 Cz0jE0s9Q2PzWCsjUyV9O5uU1JzMstQifbsEvYyvT5YzFez0r/jW9ISpgfGLYxcjJ4eEgInE
 2ofNLCC2kMBSRolJh4Mh4jISJ6c1sELYwhJ/rnWxdTFyAdV8YpS4/mMzM0iCTcBQoustREJE
 oJNRYlr3R3YQh1lgJ7PExOstYFXCAt4Sy/tPMoHYLAKqElv+vgOKc3DwCthJHL9tDbFBXmL1
 hgNg5ZxA4dctB1khLrKVWL7gPfMERr4FjAyrGEVSS4tz03OLjfSKE3OLS/PS9ZLzczcxAiNq
 27GfW3Ywdr0LPsQowMGoxMP7IuR1nBBrYllxZe4hRgkOZiURXqezp+OEeFMSK6tSi/Lji0pz
 UosPMZoC3TSRWUo0OR8Y7Xkl8YamhuYWlobmxubGZhZK4rwdAgdjhATSE0tSs1NTC1KLYPqY
 ODilGhjZcqMawr3yimcrJIkvvR54VI/njE3E5skL1H79s5i7e2XxY6er9afXMtxweMTha/xl
 b67vWn+dHYcdbjWK36mqUWY6yPaG28ijr0Sf6RbTtsO/5MWbiqIbJbYvNbOcybr58J8ToXet
 2lmPt5ksFf8gPSPNTlvOwHmaQbSb6q0l0+OUw98JWCixFGckGmoxFxUnAgA336lcvgIAAA==
X-CMS-MailID: 20200619103718eucas1p11cd577b435672197f48bfcba2d06bc18
X-Msg-Generator: CA
X-RootMTR: 20200619103718eucas1p11cd577b435672197f48bfcba2d06bc18
X-EPHeader: CA
CMS-TYPE: 201P
X-CMS-RootMailID: 20200619103718eucas1p11cd577b435672197f48bfcba2d06bc18
References: <20200619103636.11974-1-m.szyprowski@samsung.com>
 <CGME20200619103718eucas1p11cd577b435672197f48bfcba2d06bc18@eucas1p1.samsung.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Pawel Osciak <pawel@osciak.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, linux-media@vger.kernel.org,
 Daniel Vetter <daniel@ffwll.ch>, Hans Verkuil <hverkuil-cisco@xs4all.nl>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Robin Murphy <robin.murphy@arm.com>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH v7 36/36] videobuf2: use sgtable-based
	scatterlist wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VXNlIHJlY2VudGx5IGludHJvZHVjZWQgY29tbW9uIHdyYXBwZXJzIG9wZXJhdGluZyBkaXJlY3Rs
eSBvbiB0aGUgc3RydWN0CnNnX3RhYmxlIG9iamVjdHMgYW5kIHNjYXR0ZXJsaXN0IHBhZ2UgaXRl
cmF0b3JzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQKbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2ll
ciB0byBmb2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLCBi
ZWNhdXNlIHRoZSBjb2RlIGFscmVhZHkgcHJvcGVybHkgZGlkIGFsbCB0aGUKc2NhdGVybGlzdCBy
ZWxhdGVkIGNhbGxzLgoKU2lnbmVkLW9mZi1ieTogTWFyZWsgU3p5cHJvd3NraSA8bS5zenlwcm93
c2tpQHNhbXN1bmcuY29tPgotLS0KIC4uLi9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEt
Y29udGlnLmMgICB8IDM0ICsrKysrKysrLS0tLS0tLS0tLS0KIC4uLi9tZWRpYS9jb21tb24vdmlk
ZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYyB8IDMyICsrKysrKystLS0tLS0tLS0tCiAuLi4vY29t
bW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jICAgICAgfCAxMiArKystLS0tCiAzIGZp
bGVzIGNoYW5nZWQsIDMxIGluc2VydGlvbnMoKyksIDQ3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdp
dCBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5j
IGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMK
aW5kZXggZjRiNGE3YzEzNWViLi4wYTE2YTg1ZjAyODQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVk
aWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCisrKyBiL2RyaXZlcnMv
bWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCkBAIC01MywxMCAr
NTMsMTAgQEAgc3RhdGljIHVuc2lnbmVkIGxvbmcgdmIyX2RjX2dldF9jb250aWd1b3VzX3NpemUo
c3RydWN0IHNnX3RhYmxlICpzZ3QpCiAJdW5zaWduZWQgaW50IGk7CiAJdW5zaWduZWQgbG9uZyBz
aXplID0gMDsKIAotCWZvcl9lYWNoX3NnKHNndC0+c2dsLCBzLCBzZ3QtPm5lbnRzLCBpKSB7CisJ
Zm9yX2VhY2hfc2d0YWJsZV9kbWFfc2coc2d0LCBzLCBpKSB7CiAJCWlmIChzZ19kbWFfYWRkcmVz
cyhzKSAhPSBleHBlY3RlZCkKIAkJCWJyZWFrOwotCQlleHBlY3RlZCA9IHNnX2RtYV9hZGRyZXNz
KHMpICsgc2dfZG1hX2xlbihzKTsKKwkJZXhwZWN0ZWQgKz0gc2dfZG1hX2xlbihzKTsKIAkJc2l6
ZSArPSBzZ19kbWFfbGVuKHMpOwogCX0KIAlyZXR1cm4gc2l6ZTsKQEAgLTk5LDggKzk5LDcgQEAg
c3RhdGljIHZvaWQgdmIyX2RjX3ByZXBhcmUodm9pZCAqYnVmX3ByaXYpCiAJaWYgKCFzZ3QgfHwg
YnVmLT5kYl9hdHRhY2gpCiAJCXJldHVybjsKIAotCWRtYV9zeW5jX3NnX2Zvcl9kZXZpY2UoYnVm
LT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkgICAgICAgYnVmLT5kbWFfZGly
KTsKKwlkbWFfc3luY19zZ3RhYmxlX2Zvcl9kZXZpY2UoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFf
ZGlyKTsKIH0KIAogc3RhdGljIHZvaWQgdmIyX2RjX2ZpbmlzaCh2b2lkICpidWZfcHJpdikKQEAg
LTExMiw3ICsxMTEsNyBAQCBzdGF0aWMgdm9pZCB2YjJfZGNfZmluaXNoKHZvaWQgKmJ1Zl9wcml2
KQogCWlmICghc2d0IHx8IGJ1Zi0+ZGJfYXR0YWNoKQogCQlyZXR1cm47CiAKLQlkbWFfc3luY19z
Z19mb3JfY3B1KGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLCBidWYtPmRtYV9k
aXIpOworCWRtYV9zeW5jX3NndGFibGVfZm9yX2NwdShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9k
aXIpOwogfQogCiAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
LwpAQCAtMjczLDggKzI3Miw4IEBAIHN0YXRpYyB2b2lkIHZiMl9kY19kbWFidWZfb3BzX2RldGFj
aChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAkJICogbWVtb3J5IGxvY2F0aW9ucyBkbyBub3QgcmVx
dWlyZSBhbnkgZXhwbGljaXQgY2FjaGUKIAkJICogbWFpbnRlbmFuY2UgcHJpb3Igb3IgYWZ0ZXIg
YmVpbmcgdXNlZCBieSB0aGUgZGV2aWNlLgogCQkgKi8KLQkJZG1hX3VubWFwX3NnX2F0dHJzKGRi
X2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgIGF0dGFjaC0+
ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRi
X2F0dGFjaC0+ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRSX1NLSVBf
Q1BVX1NZTkMpOwogCXNnX2ZyZWVfdGFibGUoc2d0KTsKIAlrZnJlZShhdHRhY2gpOwogCWRiX2F0
dGFjaC0+cHJpdiA9IE5VTEw7CkBAIC0yOTksOCArMjk4LDggQEAgc3RhdGljIHN0cnVjdCBzZ190
YWJsZSAqdmIyX2RjX2RtYWJ1Zl9vcHNfbWFwKAogCiAJLyogcmVsZWFzZSBhbnkgcHJldmlvdXMg
Y2FjaGUgKi8KIAlpZiAoYXR0YWNoLT5kbWFfZGlyICE9IERNQV9OT05FKSB7Ci0JCWRtYV91bm1h
cF9zZ19hdHRycyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJ
CQkgICBhdHRhY2gtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOworCQlkbWFfdW5t
YXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIsCisJCQkJICBE
TUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAkJYXR0YWNoLT5kbWFfZGlyID0gRE1BX05PTkU7CiAJ
fQogCkBAIC0zMDgsOSArMzA3LDggQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqdmIyX2RjX2Rt
YWJ1Zl9vcHNfbWFwKAogCSAqIG1hcHBpbmcgdG8gdGhlIGNsaWVudCB3aXRoIG5ldyBkaXJlY3Rp
b24sIG5vIGNhY2hlIHN5bmMKIAkgKiByZXF1aXJlZCBzZWUgY29tbWVudCBpbiB2YjJfZGNfZG1h
YnVmX29wc19kZXRhY2goKQogCSAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnX2F0dHJzKGRi
X2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgICAgIGRtYV9k
aXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwotCWlmICghc2d0LT5uZW50cykgeworCWlmIChk
bWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2RpciwKKwkJCSAgICBETUFf
QVRUUl9TS0lQX0NQVV9TWU5DKSkgewogCQlwcl9lcnIoImZhaWxlZCB0byBtYXAgc2NhdHRlcmxp
c3RcbiIpOwogCQltdXRleF91bmxvY2sobG9jayk7CiAJCXJldHVybiBFUlJfUFRSKC1FSU8pOwpA
QCAtNDIzLDggKzQyMSw4IEBAIHN0YXRpYyB2b2lkIHZiMl9kY19wdXRfdXNlcnB0cih2b2lkICpi
dWZfcHJpdikKIAkJICogTm8gbmVlZCB0byBzeW5jIHRvIENQVSwgaXQncyBhbHJlYWR5IHN5bmNl
ZCB0byB0aGUgQ1BVCiAJCSAqIHNpbmNlIHRoZSBmaW5pc2goKSBtZW1vcCB3aWxsIGhhdmUgYmVl
biBjYWxsZWQgYmVmb3JlIHRoaXMuCiAJCSAqLwotCQlkbWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5k
ZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgYnVmLT5kbWFfZGlyLCBETUFf
QVRUUl9TS0lQX0NQVV9TWU5DKTsKKwkJZG1hX3VubWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwg
YnVmLT5kbWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJCXBhZ2VzID0g
ZnJhbWVfdmVjdG9yX3BhZ2VzKGJ1Zi0+dmVjKTsKIAkJLyogc2d0IHNob3VsZCBleGlzdCBvbmx5
IGlmIHZlY3RvciBjb250YWlucyBwYWdlcy4uLiAqLwogCQlCVUdfT04oSVNfRVJSKHBhZ2VzKSk7
CkBAIC01MjEsOSArNTE5LDggQEAgc3RhdGljIHZvaWQgKnZiMl9kY19nZXRfdXNlcnB0cihzdHJ1
Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgdmFkZHIsCiAJICogTm8gbmVlZCB0byBzeW5j
IHRvIHRoZSBkZXZpY2UsIHRoaXMgd2lsbCBoYXBwZW4gbGF0ZXIgd2hlbiB0aGUKIAkgKiBwcmVw
YXJlKCkgbWVtb3AgaXMgY2FsbGVkLgogCSAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnX2F0
dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgICAgIGJ1Zi0+
ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7Ci0JaWYgKHNndC0+bmVudHMgPD0gMCkg
eworCWlmIChkbWFfbWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLAorCQkJ
ICAgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpKSB7CiAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBz
Y2F0dGVybGlzdFxuIik7CiAJCXJldCA9IC1FSU87CiAJCWdvdG8gZmFpbF9zZ3RfaW5pdDsKQEAg
LTU0NSw4ICs1NDIsNyBAQCBzdGF0aWMgdm9pZCAqdmIyX2RjX2dldF91c2VycHRyKHN0cnVjdCBk
ZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyB2YWRkciwKIAlyZXR1cm4gYnVmOwogCiBmYWlsX21h
cF9zZzoKLQlkbWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdf
bmVudHMsCi0JCQkgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOworCWRt
YV91bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJ
UF9DUFVfU1lOQyk7CiAKIGZhaWxfc2d0X2luaXQ6CiAJc2dfZnJlZV90YWJsZShzZ3QpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cu
YyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMKaW5k
ZXggOTIwNzJhMDhhZjI1Li4wOGM0MDMxMWVlYTAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEv
Y29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMKKysrIGIvZHJpdmVycy9tZWRpYS9j
b21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYwpAQCAtMTQyLDkgKzE0Miw4IEBAIHN0
YXRpYyB2b2lkICp2YjJfZG1hX3NnX2FsbG9jKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQg
bG9uZyBkbWFfYXR0cnMsCiAJICogTm8gbmVlZCB0byBzeW5jIHRvIHRoZSBkZXZpY2UsIHRoaXMg
d2lsbCBoYXBwZW4gbGF0ZXIgd2hlbiB0aGUKIAkgKiBwcmVwYXJlKCkgbWVtb3AgaXMgY2FsbGVk
LgogCSAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNn
bCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgICAgIGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJ
UF9DUFVfU1lOQyk7Ci0JaWYgKCFzZ3QtPm5lbnRzKQorCWlmIChkbWFfbWFwX3NndGFibGUoYnVm
LT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLAorCQkJICAgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMp
KQogCQlnb3RvIGZhaWxfbWFwOwogCiAJYnVmLT5oYW5kbGVyLnJlZmNvdW50ID0gJmJ1Zi0+cmVm
Y291bnQ7CkBAIC0xODAsOCArMTc5LDggQEAgc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19wdXQodm9p
ZCAqYnVmX3ByaXYpCiAJaWYgKHJlZmNvdW50X2RlY19hbmRfdGVzdCgmYnVmLT5yZWZjb3VudCkp
IHsKIAkJZHByaW50aygxLCAiJXM6IEZyZWVpbmcgYnVmZmVyIG9mICVkIHBhZ2VzXG4iLCBfX2Z1
bmNfXywKIAkJCWJ1Zi0+bnVtX3BhZ2VzKTsKLQkJZG1hX3VubWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2
LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgIGJ1Zi0+ZG1hX2RpciwgRE1BX0FU
VFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1
Zi0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwogCQlpZiAoYnVmLT52
YWRkcikKIAkJCXZtX3VubWFwX3JhbShidWYtPnZhZGRyLCBidWYtPm51bV9wYWdlcyk7CiAJCXNn
X2ZyZWVfdGFibGUoYnVmLT5kbWFfc2d0KTsKQEAgLTIwMiw4ICsyMDEsNyBAQCBzdGF0aWMgdm9p
ZCB2YjJfZG1hX3NnX3ByZXBhcmUodm9pZCAqYnVmX3ByaXYpCiAJaWYgKGJ1Zi0+ZGJfYXR0YWNo
KQogCQlyZXR1cm47CiAKLQlkbWFfc3luY19zZ19mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QtPnNn
bCwgc2d0LT5vcmlnX25lbnRzLAotCQkJICAgICAgIGJ1Zi0+ZG1hX2Rpcik7CisJZG1hX3N5bmNf
c2d0YWJsZV9mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9CiAKIHN0
YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQpAQCAtMjE1LDcgKzIx
Myw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQogCWlm
IChidWYtPmRiX2F0dGFjaCkKIAkJcmV0dXJuOwogCi0JZG1hX3N5bmNfc2dfZm9yX2NwdShidWYt
PmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywgYnVmLT5kbWFfZGlyKTsKKwlkbWFfc3lu
Y19zZ3RhYmxlX2Zvcl9jcHUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyKTsKIH0KIAogc3Rh
dGljIHZvaWQgKnZiMl9kbWFfc2dfZ2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNp
Z25lZCBsb25nIHZhZGRyLApAQCAtMjU4LDkgKzI1Niw4IEBAIHN0YXRpYyB2b2lkICp2YjJfZG1h
X3NnX2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQgbG9uZyB2YWRkciwK
IAkgKiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwgdGhpcyB3aWxsIGhhcHBlbiBsYXRl
ciB3aGVuIHRoZQogCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBjYWxsZWQuCiAJICovCi0Jc2d0LT5u
ZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVu
dHMsCi0JCQkJICAgICAgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKLQlp
ZiAoIXNndC0+bmVudHMpCisJaWYgKGRtYV9tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYt
PmRtYV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpCiAJCWdvdG8gdXNlcnB0
cl9mYWlsX21hcDsKIAogCXJldHVybiBidWY7CkBAIC0yODYsOCArMjgzLDcgQEAgc3RhdGljIHZv
aWQgdmIyX2RtYV9zZ19wdXRfdXNlcnB0cih2b2lkICpidWZfcHJpdikKIAogCWRwcmludGsoMSwg
IiVzOiBSZWxlYXNpbmcgdXNlcnNwYWNlIGJ1ZmZlciBvZiAlZCBwYWdlc1xuIiwKIAkgICAgICAg
X19mdW5jX18sIGJ1Zi0+bnVtX3BhZ2VzKTsKLQlkbWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5kZXYs
IHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2RpciwKLQkJCSAgIERNQV9BVFRS
X1NLSVBfQ1BVX1NZTkMpOworCWRtYV91bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+
ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJaWYgKGJ1Zi0+dmFkZHIpCiAJCXZt
X3VubWFwX3JhbShidWYtPnZhZGRyLCBidWYtPm51bV9wYWdlcyk7CiAJc2dfZnJlZV90YWJsZShi
dWYtPmRtYV9zZ3QpOwpAQCAtNDEwLDggKzQwNiw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2df
ZG1hYnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCiAKIAkvKiByZWxlYXNlIHRo
ZSBzY2F0dGVybGlzdCBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05PTkUp
Ci0JCWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50
cywKLQkJCWF0dGFjaC0+ZG1hX2Rpcik7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+
ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwgMCk7CiAJc2dfZnJlZV90YWJsZShzZ3QpOwogCWtm
cmVlKGF0dGFjaCk7CiAJZGJfYXR0YWNoLT5wcml2ID0gTlVMTDsKQEAgLTQzNiwxNSArNDMxLDEy
IEBAIHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kbWFfc2dfZG1hYnVmX29wc19tYXAoCiAK
IAkvKiByZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIg
IT0gRE1BX05PTkUpIHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwg
c2d0LT5vcmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFi
bGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAkJYXR0YWNoLT5k
bWFfZGlyID0gRE1BX05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGgg
bmV3IGRpcmVjdGlvbiAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0LT5u
ZW50cykgeworCWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2Rp
ciwgMCkpIHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0
ZXhfdW5sb2NrKGxvY2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jIGIvZHJpdmVy
cy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMKaW5kZXggYzY2ZmRh
NGE2NWU0Li5iZjVhYzYzYTU3NDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3Zp
ZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jCisrKyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3Zp
ZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jCkBAIC0yMjksNyArMjI5LDcgQEAgc3RhdGljIGlu
dCB2YjJfdm1hbGxvY19kbWFidWZfb3BzX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAkJ
a2ZyZWUoYXR0YWNoKTsKIAkJcmV0dXJuIHJldDsKIAl9Ci0JZm9yX2VhY2hfc2coc2d0LT5zZ2ws
IHNnLCBzZ3QtPm5lbnRzLCBpKSB7CisJZm9yX2VhY2hfc2d0YWJsZV9zZyhzZ3QsIHNnLCBpKSB7
CiAJCXN0cnVjdCBwYWdlICpwYWdlID0gdm1hbGxvY190b19wYWdlKHZhZGRyKTsKIAogCQlpZiAo
IXBhZ2UpIHsKQEAgLTI1OSw4ICsyNTksNyBAQCBzdGF0aWMgdm9pZCB2YjJfdm1hbGxvY19kbWFi
dWZfb3BzX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAogCS8qIHJlbGVhc2UgdGhlIHNj
YXR0ZXJsaXN0IGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9ORSkKLQkJ
ZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAot
CQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYs
IHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAlzZ19mcmVlX3RhYmxlKHNndCk7CiAJa2ZyZWUo
YXR0YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtMjg1LDE1ICsyODQsMTIgQEAg
c3RhdGljIHN0cnVjdCBzZ190YWJsZSAqdmIyX3ZtYWxsb2NfZG1hYnVmX29wc19tYXAoCiAKIAkv
KiByZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0g
RE1BX05PTkUpIHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0
LT5vcmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUo
ZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAkJYXR0YWNoLT5kbWFf
ZGlyID0gRE1BX05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGggbmV3
IGRpcmVjdGlvbiAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBz
Z3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0LT5uZW50
cykgeworCWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2Rpciwg
MCkpIHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhf
dW5sb2NrKGxvY2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKLS0gCjIuMTcuMQoKX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBt
YWlsaW5nIGxpc3QKTGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCmh0dHBzOi8vbGlzdHMu
bGluYXJvLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbmFyby1tbS1zaWcK
