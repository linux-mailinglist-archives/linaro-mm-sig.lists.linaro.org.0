Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 9718CB05D5A
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 15 Jul 2025 15:43:29 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id AD275456FD
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 15 Jul 2025 13:43:28 +0000 (UTC)
Received: from dfw.source.kernel.org (dfw.source.kernel.org [139.178.84.217])
	by lists.linaro.org (Postfix) with ESMTPS id D53A244037
	for <linaro-mm-sig@lists.linaro.org>; Tue, 15 Jul 2025 13:43:12 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linuxfoundation.org header.s=korg header.b="WM4etS/x";
	spf=pass (lists.linaro.org: domain of gregkh@linuxfoundation.org designates 139.178.84.217 as permitted sender) smtp.mailfrom=gregkh@linuxfoundation.org;
	dmarc=pass (policy=none) header.from=linuxfoundation.org
Received: from smtp.kernel.org (transwarp.subspace.kernel.org [100.75.92.58])
	by dfw.source.kernel.org (Postfix) with ESMTP id 423845C651C;
	Tue, 15 Jul 2025 13:43:12 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 6B527C4CEE3;
	Tue, 15 Jul 2025 13:43:11 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=linuxfoundation.org;
	s=korg; t=1752586991;
	bh=7YerTNqOXzIZgs1HpEXiEzXdESWh8PU4yrLhBIfwM38=;
	h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
	b=WM4etS/xGjrWpt4kTS6lYTj8XkFP+VgNminUnmZ5ss37sN3BRKSOEPSrStMMvmSM7
	 ZkoReTfUGllM4yk88hRx0C6iIebMroXFtinF1ds05IJNwrW8rlJ79uTGilslsm8WQl
	 Sa2u0NhhZ99OE4b4tq1LJLjXT71T3uBXw+3gj9UA=
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: stable@vger.kernel.org
Date: Tue, 15 Jul 2025 15:13:09 +0200
Message-ID: <20250715130818.676257162@linuxfoundation.org>
X-Mailer: git-send-email 2.50.1
In-Reply-To: <20250715130814.854109770@linuxfoundation.org>
References: <20250715130814.854109770@linuxfoundation.org>
User-Agent: quilt/0.68
X-stable: review
X-Patchwork-Hint: ignore
MIME-Version: 1.0
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: D53A244037
X-Spamd-Bar: ----
X-Spamd-Result: default: False [-4.00 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	DMARC_POLICY_ALLOW(-0.50)[linuxfoundation.org,none];
	R_SPF_ALLOW(-0.20)[+ip4:139.178.84.217];
	R_DKIM_ALLOW(-0.20)[linuxfoundation.org:s=korg];
	MIME_GOOD(-0.10)[text/plain];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	ARC_NA(0.00)[];
	RCVD_VIA_SMTP_AUTH(0.00)[];
	FREEMAIL_CC(0.00)[linuxfoundation.org,lists.linux.dev,suse.de,web.de,kernel.org,alien8.de,redhat.com,amd.com,linux.intel.com,linaro.org,vger.kernel.org,lists.freedesktop.org,lists.linaro.org];
	ASN(0.00)[asn:15830, ipnet:139.178.80.0/21, country:NL];
	RCPT_COUNT_TWELVE(0.00)[15];
	MIME_TRACE(0.00)[0:+];
	RCVD_COUNT_TWO(0.00)[2];
	FROM_HAS_DN(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	RCVD_TLS_LAST(0.00)[];
	DNSWL_BLOCKED(0.00)[100.75.92.58:received,139.178.84.217:from];
	MID_RHS_MATCH_FROM(0.00)[];
	URIBL_BLOCKED(0.00)[linaro.org:email,lists.freedesktop.org:email,suse.de:email,intel.com:email,alien8.de:email,linuxfoundation.org:email,linuxfoundation.org:dkim,linuxfoundation.org:mid,amd.com:email];
	TO_DN_SOME(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	DKIM_TRACE(0.00)[linuxfoundation.org:+]
X-Rspamd-Action: no action
Message-ID-Hash: NU7UCMKIX47U7S7JAGML6FJVKNWCGZFZ
X-Message-ID-Hash: NU7UCMKIX47U7S7JAGML6FJVKNWCGZFZ
X-MailFrom: gregkh@linuxfoundation.org
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
CC: Greg Kroah-Hartman <gregkh@linuxfoundation.org>, patches@lists.linux.dev, Thomas Zimmermann <tzimmermann@suse.de>, Bert Karwatzki <spasswolf@web.de>, Mario Limonciello <superm1@kernel.org>, "Borislav Petkov (AMD)" <bp@alien8.de>, Anusha Srivatsa <asrivats@redhat.com>, =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>, Maarten Lankhorst <maarten.lankhorst@linux.intel.com>, Maxime Ripard <mripard@kernel.org>, Sumit Semwal <sumit.semwal@linaro.org>, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 6.15 094/192] drm/framebuffer: Acquire internal references on GEM handles
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/NU7UCMKIX47U7S7JAGML6FJVKNWCGZFZ/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

Ni4xNS1zdGFibGUgcmV2aWV3IHBhdGNoLiAgSWYgYW55b25lIGhhcyBhbnkgb2JqZWN0aW9ucywg
cGxlYXNlIGxldCBtZSBrbm93Lg0KDQotLS0tLS0tLS0tLS0tLS0tLS0NCg0KRnJvbTogVGhvbWFz
IFppbW1lcm1hbm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+DQoNCmNvbW1pdCBmNmJmYzlhZmM3NTEw
Y2I1ZTZmYmUwYTE3YzUwNzkxN2IwMTIwMjgwIHVwc3RyZWFtLg0KDQpBY3F1aXJlIEdFTSBoYW5k
bGVzIGluIGRybV9mcmFtZWJ1ZmZlcl9pbml0KCkgYW5kIHJlbGVhc2UgdGhlbSBpbg0KdGhlIGNv
cnJlc3BvbmRpbmcgZHJtX2ZyYW1lYnVmZmVyX2NsZWFudXAoKS4gVGllcyB0aGUgaGFuZGxlJ3MN
CmxpZmV0aW1lIHRvIHRoZSBmcmFtZWJ1ZmZlci4gTm90IGFsbCBHRU0gYnVmZmVyIG9iamVjdHMg
aGF2ZSBHRU0NCmhhbmRsZXMuIElmIG5vdCBzZXQsIG5vIHJlZmNvdW50aW5nIHRha2VzIHBsYWNl
LiBUaGlzIGlzIHRoZSBjYXNlDQpmb3Igc29tZSBmYmRldiBlbXVsYXRpb24uIFRoaXMgaXMgbm90
IGEgcHJvYmxlbSBhcyB0aGVzZSBHRU0gb2JqZWN0cw0KZG8gbm90IHVzZSBkbWEtYnVmcyBhbmQg
ZHJpdmVycyB3aWxsIG5vdCByZWxlYXNlIHRoZW0gd2hpbGUgZmJkZXYNCmVtdWxhdGlvbiBpcyBy
dW5uaW5nLiBGcmFtZWJ1ZmZlciBmbGFncyBrZWVwIGEgYml0IHBlciBjb2xvciBwbGFuZQ0Kb2Yg
d2hpY2ggdGhlIGZyYW1lYnVmZmVyIGhvbGRzIGEgR0VNIGhhbmRsZSByZWZlcmVuY2UuDQoNCkFz
IGFsbCBkcml2ZXJzIHVzZSBkcm1fZnJhbWVidWZmZXJfaW5pdCgpLCB0aGV5IHdpbGwgbm93IGFs
bCBob2xkDQpkbWEtYnVmIHJlZmVyZW5jZXMgYXMgZml4ZWQgaW4gY29tbWl0IDUzMDdkY2U4Nzhk
NCAoImRybS9nZW06IEFjcXVpcmUNCnJlZmVyZW5jZXMgb24gR0VNIGhhbmRsZXMgZm9yIGZyYW1l
YnVmZmVycyIpLg0KDQpJbiB0aGUgR0VNIGZyYW1lYnVmZmVyIGhlbHBlcnMsIHJlc3RvcmUgdGhl
IG9yaWdpbmFsIHJlZiBjb3VudGluZw0Kb24gYnVmZmVyIG9iamVjdHMuIEFzIHRoZSBoZWxwZXJz
IGZvciBoYW5kbGUgcmVmY291bnRpbmcgYXJlIG5vdw0Kbm8gbG9uZ2VyIGNhbGxlZCBmcm9tIG91
dHNpZGUgdGhlIERSTSBjb3JlLCB1bmV4cG9ydCB0aGUgc3ltYm9scy4NCg0KdjM6DQotIGRvbid0
IG1peCBpbnRlcm5hbCBmbGFncyB3aXRoIG1vZGUgZmxhZ3MgKENocmlzdGlhbikNCnYyOg0KLSB0
cmFjayBmcmFtZWJ1ZmZlciBoYW5kbGUgcmVmcyBieSBmbGFnDQotIGRyb3AgZ21hNTAwIGNsZWFu
dXAgKENocmlzdGlhbikNCg0KU2lnbmVkLW9mZi1ieTogVGhvbWFzIFppbW1lcm1hbm4gPHR6aW1t
ZXJtYW5uQHN1c2UuZGU+DQpGaXhlczogNTMwN2RjZTg3OGQ0ICgiZHJtL2dlbTogQWNxdWlyZSBy
ZWZlcmVuY2VzIG9uIEdFTSBoYW5kbGVzIGZvciBmcmFtZWJ1ZmZlcnMiKQ0KUmVwb3J0ZWQtYnk6
IEJlcnQgS2Fyd2F0emtpIDxzcGFzc3dvbGZAd2ViLmRlPg0KQ2xvc2VzOiBodHRwczovL2xvcmUu
a2VybmVsLm9yZy9kcmktZGV2ZWwvMjAyNTA3MDMxMTU5MTUuMzA5Ni0xLXNwYXNzd29sZkB3ZWIu
ZGUvDQpUZXN0ZWQtYnk6IEJlcnQgS2Fyd2F0emtpIDxzcGFzc3dvbGZAd2ViLmRlPg0KVGVzdGVk
LWJ5OiBNYXJpbyBMaW1vbmNpZWxsbyA8c3VwZXJtMUBrZXJuZWwub3JnPg0KVGVzdGVkLWJ5OiBC
b3Jpc2xhdiBQZXRrb3YgKEFNRCkgPGJwQGFsaWVuOC5kZT4NCkNjOiBUaG9tYXMgWmltbWVybWFu
biA8dHppbW1lcm1hbm5Ac3VzZS5kZT4NCkNjOiBBbnVzaGEgU3JpdmF0c2EgPGFzcml2YXRzQHJl
ZGhhdC5jb20+DQpDYzogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29t
Pg0KQ2M6IE1hYXJ0ZW4gTGFua2hvcnN0IDxtYWFydGVuLmxhbmtob3JzdEBsaW51eC5pbnRlbC5j
b20+DQpDYzogTWF4aW1lIFJpcGFyZCA8bXJpcGFyZEBrZXJuZWwub3JnPg0KQ2M6IFN1bWl0IFNl
bXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+DQpDYzogIkNocmlzdGlhbiBLw7ZuaWciIDxj
aHJpc3RpYW4ua29lbmlnQGFtZC5jb20+DQpDYzogbGludXgtbWVkaWFAdmdlci5rZXJuZWwub3Jn
DQpDYzogZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9wLm9yZw0KQ2M6IGxpbmFyby1tbS1zaWdA
bGlzdHMubGluYXJvLm9yZw0KQ2M6IDxzdGFibGVAdmdlci5rZXJuZWwub3JnPg0KUmV2aWV3ZWQt
Ynk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4NCkxpbms6IGh0
dHBzOi8vbG9yZS5rZXJuZWwub3JnL3IvMjAyNTA3MDcxMzEyMjQuMjQ5NDk2LTEtdHppbW1lcm1h
bm5Ac3VzZS5kZQ0KU2lnbmVkLW9mZi1ieTogR3JlZyBLcm9haC1IYXJ0bWFuIDxncmVna2hAbGlu
dXhmb3VuZGF0aW9uLm9yZz4NCi0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIu
YyAgICAgICAgICAgIHwgICAzMSArKysrKysrKysrKysrKysrKysrKy0tDQogZHJpdmVycy9ncHUv
ZHJtL2RybV9nZW0uYyAgICAgICAgICAgICAgICAgICAgfCAgIDM4ICsrKysrKysrKysrKysrKysr
LS0tLS0tLS0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5j
IHwgICAxNiArKysrLS0tLS0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9kcm1faW50ZXJuYWwuaCAgICAg
ICAgICAgICAgIHwgICAgMiAtDQogaW5jbHVkZS9kcm0vZHJtX2ZyYW1lYnVmZmVyLmggICAgICAg
ICAgICAgICAgfCAgICA3ICsrKysNCiA1IGZpbGVzIGNoYW5nZWQsIDY4IGluc2VydGlvbnMoKyks
IDI2IGRlbGV0aW9ucygtKQ0KDQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZyYW1lYnVmZmVy
LmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIuYw0KQEAgLTg2MiwxMSAr
ODYyLDIzIEBAIEVYUE9SVF9TWU1CT0xfRk9SX1RFU1RTX09OTFkoZHJtX2ZyYW1lYnUNCiBpbnQg
ZHJtX2ZyYW1lYnVmZmVyX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9m
cmFtZWJ1ZmZlciAqZmIsDQogCQkJIGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXJfZnVuY3Mg
KmZ1bmNzKQ0KIHsNCisJdW5zaWduZWQgaW50IGk7DQogCWludCByZXQ7DQorCWJvb2wgZXhpc3Rz
Ow0KIA0KIAlpZiAoV0FSTl9PTl9PTkNFKGZiLT5kZXYgIT0gZGV2IHx8ICFmYi0+Zm9ybWF0KSkN
CiAJCXJldHVybiAtRUlOVkFMOw0KIA0KKwlmb3IgKGkgPSAwOyBpIDwgZmItPmZvcm1hdC0+bnVt
X3BsYW5lczsgaSsrKSB7DQorCQlpZiAoZHJtX1dBUk5fT05fT05DRShkZXYsIGZiLT5pbnRlcm5h
bF9mbGFncyAmIERSTV9GUkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRihpKSkpDQorCQkJZmItPmlu
dGVybmFsX2ZsYWdzICY9IH5EUk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSk7DQorCQlp
ZiAoZmItPm9ialtpXSkgew0KKwkJCWV4aXN0cyA9IGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRf
aWZfZXhpc3RzX3VubG9ja2VkKGZiLT5vYmpbaV0pOw0KKwkJCWlmIChleGlzdHMpDQorCQkJCWZi
LT5pbnRlcm5hbF9mbGFncyB8PSBEUk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSk7DQor
CQl9DQorCX0NCisNCiAJSU5JVF9MSVNUX0hFQUQoJmZiLT5maWxwX2hlYWQpOw0KIA0KIAlmYi0+
ZnVuY3MgPSBmdW5jczsNCkBAIC04NzUsNyArODg3LDcgQEAgaW50IGRybV9mcmFtZWJ1ZmZlcl9p
bml0KHN0cnVjdCBkcm1fZGV2aQ0KIAlyZXQgPSBfX2RybV9tb2RlX29iamVjdF9hZGQoZGV2LCAm
ZmItPmJhc2UsIERSTV9NT0RFX09CSkVDVF9GQiwNCiAJCQkJICAgIGZhbHNlLCBkcm1fZnJhbWVi
dWZmZXJfZnJlZSk7DQogCWlmIChyZXQpDQotCQlnb3RvIG91dDsNCisJCWdvdG8gZXJyOw0KIA0K
IAltdXRleF9sb2NrKCZkZXYtPm1vZGVfY29uZmlnLmZiX2xvY2spOw0KIAlkZXYtPm1vZGVfY29u
ZmlnLm51bV9mYisrOw0KQEAgLTg4Myw3ICs4OTUsMTYgQEAgaW50IGRybV9mcmFtZWJ1ZmZlcl9p
bml0KHN0cnVjdCBkcm1fZGV2aQ0KIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9jb25maWcuZmJf
bG9jayk7DQogDQogCWRybV9tb2RlX29iamVjdF9yZWdpc3RlcihkZXYsICZmYi0+YmFzZSk7DQot
b3V0Og0KKw0KKwlyZXR1cm4gMDsNCisNCitlcnI6DQorCWZvciAoaSA9IDA7IGkgPCBmYi0+Zm9y
bWF0LT5udW1fcGxhbmVzOyBpKyspIHsNCisJCWlmIChmYi0+aW50ZXJuYWxfZmxhZ3MgJiBEUk1f
RlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSkpIHsNCisJCQlkcm1fZ2VtX29iamVjdF9oYW5k
bGVfcHV0X3VubG9ja2VkKGZiLT5vYmpbaV0pOw0KKwkJCWZiLT5pbnRlcm5hbF9mbGFncyAmPSB+
RFJNX0ZSQU1FQlVGRkVSX0hBU19IQU5ETEVfUkVGKGkpOw0KKwkJfQ0KKwl9DQogCXJldHVybiBy
ZXQ7DQogfQ0KIEVYUE9SVF9TWU1CT0woZHJtX2ZyYW1lYnVmZmVyX2luaXQpOw0KQEAgLTk2MCw2
ICs5ODEsMTIgQEAgRVhQT1JUX1NZTUJPTChkcm1fZnJhbWVidWZmZXJfdW5yZWdpc3Rlcg0KIHZv
aWQgZHJtX2ZyYW1lYnVmZmVyX2NsZWFudXAoc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIpDQog
ew0KIAlzdHJ1Y3QgZHJtX2RldmljZSAqZGV2ID0gZmItPmRldjsNCisJdW5zaWduZWQgaW50IGk7
DQorDQorCWZvciAoaSA9IDA7IGkgPCBmYi0+Zm9ybWF0LT5udW1fcGxhbmVzOyBpKyspIHsNCisJ
CWlmIChmYi0+aW50ZXJuYWxfZmxhZ3MgJiBEUk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYo
aSkpDQorCQkJZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZChmYi0+b2JqW2ldKTsN
CisJfQ0KIA0KIAltdXRleF9sb2NrKCZkZXYtPm1vZGVfY29uZmlnLmZiX2xvY2spOw0KIAlsaXN0
X2RlbCgmZmItPmhlYWQpOw0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW0uYw0KKysrIGIv
ZHJpdmVycy9ncHUvZHJtL2RybV9nZW0uYw0KQEAgLTIyMywyMyArMjIzLDM0IEBAIHN0YXRpYyB2
b2lkIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXQoc3QNCiB9DQogDQogLyoqDQotICogZHJtX2dl
bV9vYmplY3RfaGFuZGxlX2dldF91bmxvY2tlZCAtIGFjcXVpcmUgcmVmZXJlbmNlIG9uIHVzZXIt
c3BhY2UgaGFuZGxlcw0KKyAqIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfaWZfZXhpc3RzX3Vu
bG9ja2VkIC0gYWNxdWlyZSByZWZlcmVuY2Ugb24gdXNlci1zcGFjZSBoYW5kbGUsIGlmIGFueQ0K
ICAqIEBvYmo6IEdFTSBvYmplY3QNCiAgKg0KLSAqIEFjcXVpcmVzIGEgcmVmZXJlbmNlIG9uIHRo
ZSBHRU0gYnVmZmVyIG9iamVjdCdzIGhhbmRsZS4gUmVxdWlyZWQNCi0gKiB0byBrZWVwIHRoZSBH
RU0gb2JqZWN0IGFsaXZlLiBDYWxsIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQo
KQ0KLSAqIHRvIHJlbGVhc2UgdGhlIHJlZmVyZW5jZS4NCisgKiBBY3F1aXJlcyBhIHJlZmVyZW5j
ZSBvbiB0aGUgR0VNIGJ1ZmZlciBvYmplY3QncyBoYW5kbGUuIFJlcXVpcmVkIHRvIGtlZXANCisg
KiB0aGUgR0VNIG9iamVjdCBhbGl2ZS4gQ2FsbCBkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X2lm
X2V4aXN0c191bmxvY2tlZCgpDQorICogdG8gcmVsZWFzZSB0aGUgcmVmZXJlbmNlLiBEb2VzIG5v
dGhpbmcgaWYgdGhlIGJ1ZmZlciBvYmplY3QgaGFzIG5vIGhhbmRsZS4NCisgKg0KKyAqIFJldHVy
bnM6DQorICogVHJ1ZSBpZiBhIGhhbmRsZSBleGlzdHMsIG9yIGZhbHNlIG90aGVyd2lzZQ0KICAq
Lw0KLXZvaWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF91bmxvY2tlZChzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKm9iaikNCitib29sIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfaWZfZXhpc3Rz
X3VubG9ja2VkKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQ0KIHsNCiAJc3RydWN0IGRybV9k
ZXZpY2UgKmRldiA9IG9iai0+ZGV2Ow0KIA0KIAlndWFyZChtdXRleCkoJmRldi0+b2JqZWN0X25h
bWVfbG9jayk7DQogDQotCWRybV9XQVJOX09OKGRldiwgIW9iai0+aGFuZGxlX2NvdW50KTsgLyog
Zmlyc3QgcmVmIHRha2VuIGluIGNyZWF0ZS10YWlsIGhlbHBlciAqLw0KKwkvKg0KKwkgKiBGaXJz
dCByZWYgdGFrZW4gZHVyaW5nIEdFTSBvYmplY3QgY3JlYXRpb24sIGlmIGFueS4gU29tZQ0KKwkg
KiBkcml2ZXJzIHNldCB1cCBpbnRlcm5hbCBmcmFtZWJ1ZmZlcnMgd2l0aCBHRU0gb2JqZWN0cyB0
aGF0DQorCSAqIGRvIG5vdCBoYXZlIGEgR0VNIGhhbmRsZS4gSGVuY2UsIHRoaXMgY291bnRlciBj
YW4gYmUgemVyby4NCisJICovDQorCWlmICghb2JqLT5oYW5kbGVfY291bnQpDQorCQlyZXR1cm4g
ZmFsc2U7DQorDQogCWRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXQob2JqKTsNCisNCisJcmV0dXJu
IHRydWU7DQogfQ0KLUVYUE9SVF9TWU1CT0woZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF91bmxv
Y2tlZCk7DQogDQogLyoqDQogICogZHJtX2dlbV9vYmplY3RfaGFuZGxlX2ZyZWUgLSByZWxlYXNl
IHJlc291cmNlcyBib3VuZCB0byB1c2Vyc3BhY2UgaGFuZGxlcw0KQEAgLTI3Miw3ICsyODMsNyBA
QCBzdGF0aWMgdm9pZCBkcm1fZ2VtX29iamVjdF9leHBvcnRlZF9kbWFfDQogfQ0KIA0KIC8qKg0K
LSAqIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQgLSByZWxlYXNlcyByZWZlcmVu
Y2Ugb24gdXNlci1zcGFjZSBoYW5kbGVzDQorICogZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91
bmxvY2tlZCAtIHJlbGVhc2VzIHJlZmVyZW5jZSBvbiB1c2VyLXNwYWNlIGhhbmRsZQ0KICAqIEBv
Ymo6IEdFTSBvYmplY3QNCiAgKg0KICAqIFJlbGVhc2VzIGEgcmVmZXJlbmNlIG9uIHRoZSBHRU0g
YnVmZmVyIG9iamVjdCdzIGhhbmRsZS4gUG9zc2libHkgcmVsZWFzZXMNCkBAIC0yODMsMTQgKzI5
NCwxNCBAQCB2b2lkIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQoDQogCXN0cnVj
dCBkcm1fZGV2aWNlICpkZXYgPSBvYmotPmRldjsNCiAJYm9vbCBmaW5hbCA9IGZhbHNlOw0KIA0K
LQlpZiAoV0FSTl9PTihSRUFEX09OQ0Uob2JqLT5oYW5kbGVfY291bnQpID09IDApKQ0KKwlpZiAo
ZHJtX1dBUk5fT04oZGV2LCBSRUFEX09OQ0Uob2JqLT5oYW5kbGVfY291bnQpID09IDApKQ0KIAkJ
cmV0dXJuOw0KIA0KIAkvKg0KLQkqIE11c3QgYnVtcCBoYW5kbGUgY291bnQgZmlyc3QgYXMgdGhp
cyBtYXkgYmUgdGhlIGxhc3QNCi0JKiByZWYsIGluIHdoaWNoIGNhc2UgdGhlIG9iamVjdCB3b3Vs
ZCBkaXNhcHBlYXIgYmVmb3JlIHdlDQotCSogY2hlY2tlZCBmb3IgYSBuYW1lDQotCSovDQorCSAq
IE11c3QgYnVtcCBoYW5kbGUgY291bnQgZmlyc3QgYXMgdGhpcyBtYXkgYmUgdGhlIGxhc3QNCisJ
ICogcmVmLCBpbiB3aGljaCBjYXNlIHRoZSBvYmplY3Qgd291bGQgZGlzYXBwZWFyIGJlZm9yZQ0K
KwkgKiB3ZSBjaGVja2VkIGZvciBhIG5hbWUuDQorCSAqLw0KIA0KIAltdXRleF9sb2NrKCZkZXYt
Pm9iamVjdF9uYW1lX2xvY2spOw0KIAlpZiAoLS1vYmotPmhhbmRsZV9jb3VudCA9PSAwKSB7DQpA
QCAtMzAzLDcgKzMxNCw2IEBAIHZvaWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tl
ZCgNCiAJaWYgKGZpbmFsKQ0KIAkJZHJtX2dlbV9vYmplY3RfcHV0KG9iaik7DQogfQ0KLUVYUE9S
VF9TWU1CT0woZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZCk7DQogDQogLyoNCiAg
KiBDYWxsZWQgYXQgZGV2aWNlIG9yIG9iamVjdCBjbG9zZSB0byByZWxlYXNlIHRoZSBmaWxlJ3MN
Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5jDQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuYw0KQEAgLTk5LDcg
Kzk5LDcgQEAgdm9pZCBkcm1fZ2VtX2ZiX2Rlc3Ryb3koc3RydWN0IGRybV9mcmFtZQ0KIAl1bnNp
Z25lZCBpbnQgaTsNCiANCiAJZm9yIChpID0gMDsgaSA8IGZiLT5mb3JtYXQtPm51bV9wbGFuZXM7
IGkrKykNCi0JCWRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQoZmItPm9ialtpXSk7
DQorCQlkcm1fZ2VtX29iamVjdF9wdXQoZmItPm9ialtpXSk7DQogDQogCWRybV9mcmFtZWJ1ZmZl
cl9jbGVhbnVwKGZiKTsNCiAJa2ZyZWUoZmIpOw0KQEAgLTE4MiwxMCArMTgyLDggQEAgaW50IGRy
bV9nZW1fZmJfaW5pdF93aXRoX2Z1bmNzKHN0cnVjdCBkcg0KIAkJaWYgKCFvYmpzW2ldKSB7DQog
CQkJZHJtX2RiZ19rbXMoZGV2LCAiRmFpbGVkIHRvIGxvb2t1cCBHRU0gb2JqZWN0XG4iKTsNCiAJ
CQlyZXQgPSAtRU5PRU5UOw0KLQkJCWdvdG8gZXJyX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxv
Y2tlZDsNCisJCQlnb3RvIGVycl9nZW1fb2JqZWN0X3B1dDsNCiAJCX0NCi0JCWRybV9nZW1fb2Jq
ZWN0X2hhbmRsZV9nZXRfdW5sb2NrZWQob2Jqc1tpXSk7DQotCQlkcm1fZ2VtX29iamVjdF9wdXQo
b2Jqc1tpXSk7DQogDQogCQltaW5fc2l6ZSA9IChoZWlnaHQgLSAxKSAqIG1vZGVfY21kLT5waXRj
aGVzW2ldDQogCQkJICsgZHJtX2Zvcm1hdF9pbmZvX21pbl9waXRjaChpbmZvLCBpLCB3aWR0aCkN
CkBAIC0xOTUsMjIgKzE5MywyMiBAQCBpbnQgZHJtX2dlbV9mYl9pbml0X3dpdGhfZnVuY3Moc3Ry
dWN0IGRyDQogCQkJZHJtX2RiZ19rbXMoZGV2LA0KIAkJCQkgICAgIkdFTSBvYmplY3Qgc2l6ZSAo
JXp1KSBzbWFsbGVyIHRoYW4gbWluaW11bSBzaXplICgldSkgZm9yIHBsYW5lICVkXG4iLA0KIAkJ
CQkgICAgb2Jqc1tpXS0+c2l6ZSwgbWluX3NpemUsIGkpOw0KLQkJCWRybV9nZW1fb2JqZWN0X2hh
bmRsZV9wdXRfdW5sb2NrZWQob2Jqc1tpXSk7DQorCQkJZHJtX2dlbV9vYmplY3RfcHV0KG9ianNb
aV0pOw0KIAkJCXJldCA9IC1FSU5WQUw7DQotCQkJZ290byBlcnJfZ2VtX29iamVjdF9oYW5kbGVf
cHV0X3VubG9ja2VkOw0KKwkJCWdvdG8gZXJyX2dlbV9vYmplY3RfcHV0Ow0KIAkJfQ0KIAl9DQog
DQogCXJldCA9IGRybV9nZW1fZmJfaW5pdChkZXYsIGZiLCBtb2RlX2NtZCwgb2JqcywgaSwgZnVu
Y3MpOw0KIAlpZiAocmV0KQ0KLQkJZ290byBlcnJfZ2VtX29iamVjdF9oYW5kbGVfcHV0X3VubG9j
a2VkOw0KKwkJZ290byBlcnJfZ2VtX29iamVjdF9wdXQ7DQogDQogCXJldHVybiAwOw0KIA0KLWVy
cl9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQ6DQorZXJyX2dlbV9vYmplY3RfcHV0Og0K
IAl3aGlsZSAoaSA+IDApIHsNCiAJCS0taTsNCi0JCWRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRf
dW5sb2NrZWQob2Jqc1tpXSk7DQorCQlkcm1fZ2VtX29iamVjdF9wdXQob2Jqc1tpXSk7DQogCX0N
CiAJcmV0dXJuIHJldDsNCiB9DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ludGVybmFsLmgN
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1faW50ZXJuYWwuaA0KQEAgLTE2MSw3ICsxNjEsNyBA
QCB2b2lkIGRybV9zeXNmc19sZWFzZV9ldmVudChzdHJ1Y3QgZHJtX2RlDQogDQogLyogZHJtX2dl
bS5jICovDQogaW50IGRybV9nZW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsNCi12b2lk
IGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfdW5sb2NrZWQoc3RydWN0IGRybV9nZW1fb2JqZWN0
ICpvYmopOw0KK2Jvb2wgZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF9pZl9leGlzdHNfdW5sb2Nr
ZWQoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopOw0KIHZvaWQgZHJtX2dlbV9vYmplY3RfaGFu
ZGxlX3B1dF91bmxvY2tlZChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaik7DQogaW50IGRybV9n
ZW1faGFuZGxlX2NyZWF0ZV90YWlsKHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LA0KIAkJCSAg
ICAgICBzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwNCi0tLSBhL2luY2x1ZGUvZHJtL2RybV9m
cmFtZWJ1ZmZlci5oDQorKysgYi9pbmNsdWRlL2RybS9kcm1fZnJhbWVidWZmZXIuaA0KQEAgLTIz
LDYgKzIzLDcgQEANCiAjaWZuZGVmIF9fRFJNX0ZSQU1FQlVGRkVSX0hfXw0KICNkZWZpbmUgX19E
Uk1fRlJBTUVCVUZGRVJfSF9fDQogDQorI2luY2x1ZGUgPGxpbnV4L2JpdHMuaD4NCiAjaW5jbHVk
ZSA8bGludXgvY3R5cGUuaD4NCiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPg0KICNpbmNsdWRlIDxs
aW51eC9zY2hlZC5oPg0KQEAgLTEwMCw2ICsxMDEsOCBAQCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVy
X2Z1bmNzIHsNCiAJCSAgICAgdW5zaWduZWQgbnVtX2NsaXBzKTsNCiB9Ow0KIA0KKyNkZWZpbmUg
RFJNX0ZSQU1FQlVGRkVSX0hBU19IQU5ETEVfUkVGKF9pKQlCSVQoMHUgKyAoX2kpKQ0KKw0KIC8q
Kg0KICAqIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgLSBmcmFtZSBidWZmZXIgb2JqZWN0DQogICoN
CkBAIC0xODksNiArMTkyLDEwIEBAIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgew0KIAkgKi8NCiAJ
aW50IGZsYWdzOw0KIAkvKioNCisJICogQGludGVybmFsX2ZsYWdzOiBGcmFtZWJ1ZmZlciBmbGFn
cyBsaWtlIERSTV9GUkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRi4NCisJICovDQorCXVuc2lnbmVk
IGludCBpbnRlcm5hbF9mbGFnczsNCisJLyoqDQogCSAqIEBmaWxwX2hlYWQ6IFBsYWNlZCBvbiAm
ZHJtX2ZpbGUuZmJzLCBwcm90ZWN0ZWQgYnkgJmRybV9maWxlLmZic19sb2NrLg0KIAkgKi8NCiAJ
c3RydWN0IGxpc3RfaGVhZCBmaWxwX2hlYWQ7DQoNCg0KX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QgLS0gbGlu
YXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1haWwg
dG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
