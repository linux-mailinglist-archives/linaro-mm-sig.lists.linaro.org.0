Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 78DCB3E1306
	for <lists+linaro-mm-sig@lfdr.de>; Thu,  5 Aug 2021 12:47:39 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 21DF166050
	for <lists+linaro-mm-sig@lfdr.de>; Thu,  5 Aug 2021 10:47:38 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 550CA61A49; Thu,  5 Aug 2021 10:47:33 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 04785619CF;
	Thu,  5 Aug 2021 10:47:30 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id F0B8466626
 for <linaro-mm-sig@lists.linaro.org>; Thu,  5 Aug 2021 10:47:24 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id D05FE62166; Thu,  5 Aug 2021 10:47:21 +0000 (UTC)
Received: from mail-ej1-f51.google.com (mail-ej1-f51.google.com
 [209.85.218.51])
 by lists.linaro.org (Postfix) with ESMTPS id 18B9761A44
 for <linaro-mm-sig@lists.linaro.org>; Thu,  5 Aug 2021 10:47:19 +0000 (UTC)
Received: by mail-ej1-f51.google.com with SMTP id h9so8823106ejs.4
 for <linaro-mm-sig@lists.linaro.org>; Thu, 05 Aug 2021 03:47:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=K4cBlZbn7rlIAcDhwnlShyKL45Gvt1XxauPJPhq7UAc=;
 b=QgTakxYZNUyOnzDgLm8uiAk3D05UZasE9a0o1Vvji1T1aaakpjRosIawzhhgDvDIay
 dK4INxtVpmNaf1bcbttfv61qXFgPXFO/rr9oxdGrgJnkZ7Eh/U7MOqL09VUcTNXEeocu
 zS5tlAEsRH8iOmhGzWoiL8PO0gQlUFNNpLzsU=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=K4cBlZbn7rlIAcDhwnlShyKL45Gvt1XxauPJPhq7UAc=;
 b=TcgoKSWNgj05nJbfzipnBKM7WM6mqmfaSSliCRo14q7FlnMRqFFdWJEMhpEfDnVM9A
 sJz6y/FlswbMC52vRAhnEozcH+4fJo8UHHBZBy/a1u4nh+tUBzNTWrdnYHlL7xlcW/Q9
 hgqPv6l7qCD/I8Cp7gMNIb/g9hSMQ6zmtQDCzvRIAs3LeC/4JhmpqtCRGVQACxGkFaAf
 MbnAFtIwcCt8sLBJIcn9Kvd/VKBkpR5lCKSYSmG9Hm6qsRS8BNdl++w7WIRMJDpElRSd
 tnDApjX3VdMHDVWR5rra3SIscOhmABLyd6eN1xfTZrypzR/9uNDqhdeUHIYL9KAhWVvH
 5w1Q==
X-Gm-Message-State: AOAM530v7i9MvXNYYE6AanF4hzX7lnPpAJwNsONAmEJzfLrhpSrpW/41
 8vQxw55e9HmuJyrowA7oStKmAQ==
X-Google-Smtp-Source: ABdhPJznNpPDplvGsdBnwPXe6gKmTjl2U7S6EjOcLQjPrgy3iOhkVoglKX93p+YoFm1VS0O9o87I0A==
X-Received: by 2002:a17:906:cd1a:: with SMTP id
 oz26mr4118176ejb.101.1628160438061; 
 Thu, 05 Aug 2021 03:47:18 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:57f4:0:efd0:b9e5:5ae6:c2fa])
 by smtp.gmail.com with ESMTPSA id p5sm1578809ejl.73.2021.08.05.03.47.17
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 05 Aug 2021 03:47:17 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: DRI Development <dri-devel@lists.freedesktop.org>
Date: Thu,  5 Aug 2021 12:46:52 +0200
Message-Id: <20210805104705.862416-8-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.32.0
In-Reply-To: <20210805104705.862416-1-daniel.vetter@ffwll.ch>
References: <20210805104705.862416-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: [Linaro-mm-sig] [PATCH v5 07/20] drm/panfrost: use scheduler
 dependency tracking
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: Rob Herring <robh@kernel.org>, Tomeu Vizoso <tomeu.vizoso@collabora.com>,
 Emma Anholt <emma@anholt.net>,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 Steven Price <steven.price@arm.com>, linaro-mm-sig@lists.linaro.org,
 Alyssa Rosenzweig <alyssa.rosenzweig@collabora.com>,
 Daniel Vetter <daniel.vetter@intel.com>, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

SnVzdCBkZWxldGVzIHNvbWUgY29kZSB0aGF0J3Mgbm93IG1vcmUgc2hhcmVkLgoKTm90ZSB0aGF0
IHRoYW5rcyB0byB0aGUgc3BsaXQgaW50byBkcm1fc2NoZWRfam9iX2luaXQvYXJtIHdlIGNhbiBu
b3cKZWFzaWx5IHB1bGwgdGhlIF9pbml0KCkgcGFydCBmcm9tIHVuZGVyIHRoZSBzdWJtaXNzaW9u
IGxvY2sgd2F5IGFoZWFkCndoZXJlIHdlJ3JlIGFkZGluZyB0aGUgc3luYyBmaWxlIGluLWZlbmNl
cyBhcyBkZXBlbmRlbmNpZXMuCgp2MjogQ29ycmVjdGx5IGNsZWFuIHVwIHRoZSBwYXJ0aWFsbHkg
c2V0IHVwIGpvYiwgbm93IHRoYXQgam9iX2luaXQoKQphbmQgam9iX2FybSgpIGFyZSBhcGFydCAo
RW1tYSkuCgp2MzogUmViYXNlZCBvdmVyIHJlbmFtZWQgZnVuY3Rpb25zIGZvciBhZGRpbmcgZGVw
ZGVuY2llcwoKQWNrZWQtYnk6IEVtbWEgQW5ob2x0IDxlbW1hQGFuaG9sdC5uZXQ+ClJldmlld2Vk
LWJ5OiBTdGV2ZW4gUHJpY2UgPHN0ZXZlbi5wcmljZUBhcm0uY29tPiAodjMpClNpZ25lZC1vZmYt
Ynk6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0ZXJAaW50ZWwuY29tPgpDYzogUm9iIEhlcnJp
bmcgPHJvYmhAa2VybmVsLm9yZz4KQ2M6IFRvbWV1IFZpem9zbyA8dG9tZXUudml6b3NvQGNvbGxh
Ym9yYS5jb20+CkNjOiBTdGV2ZW4gUHJpY2UgPHN0ZXZlbi5wcmljZUBhcm0uY29tPgpDYzogQWx5
c3NhIFJvc2VuendlaWcgPGFseXNzYS5yb3Nlbnp3ZWlnQGNvbGxhYm9yYS5jb20+CkNjOiBTdW1p
dCBTZW13YWwgPHN1bWl0LnNlbXdhbEBsaW5hcm8ub3JnPgpDYzogIkNocmlzdGlhbiBLw7ZuaWci
IDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+CkNjOiBsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5v
cmcKQ2M6IGxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpDYzogRW1tYSBBbmhvbHQgPGVt
bWFAYW5ob2x0Lm5ldD4KLS0tCiBkcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3RfZHJ2
LmMgfCAxNiArKysrKysrKy0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pv
Yi5jIHwgMzggKysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJtL3BhbmZy
b3N0L3BhbmZyb3N0X2pvYi5oIHwgIDUgKy0tLQogMyBmaWxlcyBjaGFuZ2VkLCAxOCBpbnNlcnRp
b25zKCspLCA0MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcGFu
ZnJvc3QvcGFuZnJvc3RfZHJ2LmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rf
ZHJ2LmMKaW5kZXggMWZmYWVmNWVjNWZmLi4xNjIxMmI2YjIwMmUgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9kcnYuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
cGFuZnJvc3QvcGFuZnJvc3RfZHJ2LmMKQEAgLTIxOCw3ICsyMTgsNyBAQCBwYW5mcm9zdF9jb3B5
X2luX3N5bmMoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAkJaWYgKHJldCkKIAkJCWdvdG8gZmFp
bDsKIAotCQlyZXQgPSBkcm1fZ2VtX2ZlbmNlX2FycmF5X2FkZCgmam9iLT5kZXBzLCBmZW5jZSk7
CisJCXJldCA9IGRybV9zY2hlZF9qb2JfYWRkX2RlcGVuZGVuY3koJmpvYi0+YmFzZSwgZmVuY2Up
OwogCiAJCWlmIChyZXQpCiAJCQlnb3RvIGZhaWw7CkBAIC0yMzYsNyArMjM2LDcgQEAgc3RhdGlj
IGludCBwYW5mcm9zdF9pb2N0bF9zdWJtaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAq
ZGF0YSwKIAlzdHJ1Y3QgZHJtX3BhbmZyb3N0X3N1Ym1pdCAqYXJncyA9IGRhdGE7CiAJc3RydWN0
IGRybV9zeW5jb2JqICpzeW5jX291dCA9IE5VTEw7CiAJc3RydWN0IHBhbmZyb3N0X2pvYiAqam9i
OwotCWludCByZXQgPSAwOworCWludCByZXQgPSAwLCBzbG90OwogCiAJaWYgKCFhcmdzLT5qYykK
IAkJcmV0dXJuIC1FSU5WQUw7CkBAIC0yNTgsMTQgKzI1OCwyMCBAQCBzdGF0aWMgaW50IHBhbmZy
b3N0X2lvY3RsX3N1Ym1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCiAJ
a3JlZl9pbml0KCZqb2ItPnJlZmNvdW50KTsKIAotCXhhX2luaXRfZmxhZ3MoJmpvYi0+ZGVwcywg
WEFfRkxBR1NfQUxMT0MpOwotCiAJam9iLT5wZmRldiA9IHBmZGV2OwogCWpvYi0+amMgPSBhcmdz
LT5qYzsKIAlqb2ItPnJlcXVpcmVtZW50cyA9IGFyZ3MtPnJlcXVpcmVtZW50czsKIAlqb2ItPmZs
dXNoX2lkID0gcGFuZnJvc3RfZ3B1X2dldF9sYXRlc3RfZmx1c2hfaWQocGZkZXYpOwogCWpvYi0+
ZmlsZV9wcml2ID0gZmlsZS0+ZHJpdmVyX3ByaXY7CiAKKwlzbG90ID0gcGFuZnJvc3Rfam9iX2dl
dF9zbG90KGpvYik7CisKKwlyZXQgPSBkcm1fc2NoZWRfam9iX2luaXQoJmpvYi0+YmFzZSwKKwkJ
CQkgJmpvYi0+ZmlsZV9wcml2LT5zY2hlZF9lbnRpdHlbc2xvdF0sCisJCQkJIE5VTEwpOworCWlm
IChyZXQpCisJCWdvdG8gZmFpbF9qb2JfcHV0OworCiAJcmV0ID0gcGFuZnJvc3RfY29weV9pbl9z
eW5jKGRldiwgZmlsZSwgYXJncywgam9iKTsKIAlpZiAocmV0KQogCQlnb3RvIGZhaWxfam9iOwpA
QCAtMjgzLDYgKzI4OSw4IEBAIHN0YXRpYyBpbnQgcGFuZnJvc3RfaW9jdGxfc3VibWl0KHN0cnVj
dCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJCWRybV9zeW5jb2JqX3JlcGxhY2VfZmVu
Y2Uoc3luY19vdXQsIGpvYi0+cmVuZGVyX2RvbmVfZmVuY2UpOwogCiBmYWlsX2pvYjoKKwlkcm1f
c2NoZWRfam9iX2NsZWFudXAoJmpvYi0+YmFzZSk7CitmYWlsX2pvYl9wdXQ6CiAJcGFuZnJvc3Rf
am9iX3B1dChqb2IpOwogZmFpbF9vdXRfc3luYzoKIAlpZiAoc3luY19vdXQpCmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMgYi9kcml2ZXJzL2dwdS9k
cm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMKaW5kZXggNGJjOTYyNzYzZTFmLi5hOThmNTA3ZGM3
NzkgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuYwor
KysgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMKQEAgLTEwMiw3ICsx
MDIsNyBAQCBzdGF0aWMgc3RydWN0IGRtYV9mZW5jZSAqcGFuZnJvc3RfZmVuY2VfY3JlYXRlKHN0
cnVjdCBwYW5mcm9zdF9kZXZpY2UgKnBmZGV2LCBpbgogCXJldHVybiAmZmVuY2UtPmJhc2U7CiB9
CiAKLXN0YXRpYyBpbnQgcGFuZnJvc3Rfam9iX2dldF9zbG90KHN0cnVjdCBwYW5mcm9zdF9qb2Ig
KmpvYikKK2ludCBwYW5mcm9zdF9qb2JfZ2V0X3Nsb3Qoc3RydWN0IHBhbmZyb3N0X2pvYiAqam9i
KQogewogCS8qIEpTMDogZnJhZ21lbnQgam9icy4KIAkgKiBKUzE6IHZlcnRleC90aWxlciBqb2Jz
CkBAIC0yNDIsMTMgKzI0MiwxNCBAQCBzdGF0aWMgdm9pZCBwYW5mcm9zdF9qb2JfaHdfc3VibWl0
KHN0cnVjdCBwYW5mcm9zdF9qb2IgKmpvYiwgaW50IGpzKQogCiBzdGF0aWMgaW50IHBhbmZyb3N0
X2FjcXVpcmVfb2JqZWN0X2ZlbmNlcyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKipib3MsCiAJCQkJ
CSAgaW50IGJvX2NvdW50LAotCQkJCQkgIHN0cnVjdCB4YXJyYXkgKmRlcHMpCisJCQkJCSAgc3Ry
dWN0IGRybV9zY2hlZF9qb2IgKmpvYikKIHsKIAlpbnQgaSwgcmV0OwogCiAJZm9yIChpID0gMDsg
aSA8IGJvX2NvdW50OyBpKyspIHsKIAkJLyogcGFuZnJvc3QgYWx3YXlzIHVzZXMgd3JpdGUgbW9k
ZSBpbiBpdHMgY3VycmVudCB1YXBpICovCi0JCXJldCA9IGRybV9nZW1fZmVuY2VfYXJyYXlfYWRk
X2ltcGxpY2l0KGRlcHMsIGJvc1tpXSwgdHJ1ZSk7CisJCXJldCA9IGRybV9zY2hlZF9qb2JfYWRk
X2ltcGxpY2l0X2RlcGVuZGVuY2llcyhqb2IsIGJvc1tpXSwKKwkJCQkJCQkgICAgICB0cnVlKTsK
IAkJaWYgKHJldCkKIAkJCXJldHVybiByZXQ7CiAJfQpAQCAtMjY5LDMxICsyNzAsMjEgQEAgc3Rh
dGljIHZvaWQgcGFuZnJvc3RfYXR0YWNoX29iamVjdF9mZW5jZXMoc3RydWN0IGRybV9nZW1fb2Jq
ZWN0ICoqYm9zLAogaW50IHBhbmZyb3N0X2pvYl9wdXNoKHN0cnVjdCBwYW5mcm9zdF9qb2IgKmpv
YikKIHsKIAlzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldiA9IGpvYi0+cGZkZXY7Ci0JaW50
IHNsb3QgPSBwYW5mcm9zdF9qb2JfZ2V0X3Nsb3Qoam9iKTsKLQlzdHJ1Y3QgZHJtX3NjaGVkX2Vu
dGl0eSAqZW50aXR5ID0gJmpvYi0+ZmlsZV9wcml2LT5zY2hlZF9lbnRpdHlbc2xvdF07CiAJc3Ry
dWN0IHd3X2FjcXVpcmVfY3R4IGFjcXVpcmVfY3R4OwogCWludCByZXQgPSAwOwogCi0KIAlyZXQg
PSBkcm1fZ2VtX2xvY2tfcmVzZXJ2YXRpb25zKGpvYi0+Ym9zLCBqb2ItPmJvX2NvdW50LAogCQkJ
CQkgICAgJmFjcXVpcmVfY3R4KTsKIAlpZiAocmV0KQogCQlyZXR1cm4gcmV0OwogCiAJbXV0ZXhf
bG9jaygmcGZkZXYtPnNjaGVkX2xvY2spOwotCi0JcmV0ID0gZHJtX3NjaGVkX2pvYl9pbml0KCZq
b2ItPmJhc2UsIGVudGl0eSwgTlVMTCk7Ci0JaWYgKHJldCkgewotCQltdXRleF91bmxvY2soJnBm
ZGV2LT5zY2hlZF9sb2NrKTsKLQkJZ290byB1bmxvY2s7Ci0JfQotCiAJZHJtX3NjaGVkX2pvYl9h
cm0oJmpvYi0+YmFzZSk7CiAKIAlqb2ItPnJlbmRlcl9kb25lX2ZlbmNlID0gZG1hX2ZlbmNlX2dl
dCgmam9iLT5iYXNlLnNfZmVuY2UtPmZpbmlzaGVkKTsKIAogCXJldCA9IHBhbmZyb3N0X2FjcXVp
cmVfb2JqZWN0X2ZlbmNlcyhqb2ItPmJvcywgam9iLT5ib19jb3VudCwKLQkJCQkJICAgICAmam9i
LT5kZXBzKTsKKwkJCQkJICAgICAmam9iLT5iYXNlKTsKIAlpZiAocmV0KSB7CiAJCW11dGV4X3Vu
bG9jaygmcGZkZXYtPnNjaGVkX2xvY2spOwogCQlnb3RvIHVubG9jazsKQEAgLTMxOCwxNSArMzA5
LDggQEAgc3RhdGljIHZvaWQgcGFuZnJvc3Rfam9iX2NsZWFudXAoc3RydWN0IGtyZWYgKnJlZikK
IHsKIAlzdHJ1Y3QgcGFuZnJvc3Rfam9iICpqb2IgPSBjb250YWluZXJfb2YocmVmLCBzdHJ1Y3Qg
cGFuZnJvc3Rfam9iLAogCQkJCQkJcmVmY291bnQpOwotCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNl
OwotCXVuc2lnbmVkIGxvbmcgaW5kZXg7CiAJdW5zaWduZWQgaW50IGk7CiAKLQl4YV9mb3JfZWFj
aCgmam9iLT5kZXBzLCBpbmRleCwgZmVuY2UpIHsKLQkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7Ci0J
fQotCXhhX2Rlc3Ryb3koJmpvYi0+ZGVwcyk7Ci0KIAlkbWFfZmVuY2VfcHV0KGpvYi0+ZG9uZV9m
ZW5jZSk7CiAJZG1hX2ZlbmNlX3B1dChqb2ItPnJlbmRlcl9kb25lX2ZlbmNlKTsKIApAQCAtMzY1
LDE3ICszNDksNiBAQCBzdGF0aWMgdm9pZCBwYW5mcm9zdF9qb2JfZnJlZShzdHJ1Y3QgZHJtX3Nj
aGVkX2pvYiAqc2NoZWRfam9iKQogCXBhbmZyb3N0X2pvYl9wdXQoam9iKTsKIH0KIAotc3RhdGlj
IHN0cnVjdCBkbWFfZmVuY2UgKnBhbmZyb3N0X2pvYl9kZXBlbmRlbmN5KHN0cnVjdCBkcm1fc2No
ZWRfam9iICpzY2hlZF9qb2IsCi0JCQkJCQkgc3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKnNfZW50
aXR5KQotewotCXN0cnVjdCBwYW5mcm9zdF9qb2IgKmpvYiA9IHRvX3BhbmZyb3N0X2pvYihzY2hl
ZF9qb2IpOwotCi0JaWYgKCF4YV9lbXB0eSgmam9iLT5kZXBzKSkKLQkJcmV0dXJuIHhhX2VyYXNl
KCZqb2ItPmRlcHMsIGpvYi0+bGFzdF9kZXArKyk7Ci0KLQlyZXR1cm4gTlVMTDsKLX0KLQogc3Rh
dGljIHN0cnVjdCBkbWFfZmVuY2UgKnBhbmZyb3N0X2pvYl9ydW4oc3RydWN0IGRybV9zY2hlZF9q
b2IgKnNjaGVkX2pvYikKIHsKIAlzdHJ1Y3QgcGFuZnJvc3Rfam9iICpqb2IgPSB0b19wYW5mcm9z
dF9qb2Ioc2NoZWRfam9iKTsKQEAgLTc2NSw3ICs3MzgsNiBAQCBzdGF0aWMgdm9pZCBwYW5mcm9z
dF9yZXNldF93b3JrKHN0cnVjdCB3b3JrX3N0cnVjdCAqd29yaykKIH0KIAogc3RhdGljIGNvbnN0
IHN0cnVjdCBkcm1fc2NoZWRfYmFja2VuZF9vcHMgcGFuZnJvc3Rfc2NoZWRfb3BzID0gewotCS5k
ZXBlbmRlbmN5ID0gcGFuZnJvc3Rfam9iX2RlcGVuZGVuY3ksCiAJLnJ1bl9qb2IgPSBwYW5mcm9z
dF9qb2JfcnVuLAogCS50aW1lZG91dF9qb2IgPSBwYW5mcm9zdF9qb2JfdGltZWRvdXQsCiAJLmZy
ZWVfam9iID0gcGFuZnJvc3Rfam9iX2ZyZWUKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9w
YW5mcm9zdC9wYW5mcm9zdF9qb2IuaCBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9z
dF9qb2IuaAppbmRleCA4MjMwNmEwM2I1N2UuLjc3ZTZkMGU2ZjYxMiAxMDA2NDQKLS0tIGEvZHJp
dmVycy9ncHUvZHJtL3BhbmZyb3N0L3BhbmZyb3N0X2pvYi5oCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuaApAQCAtMTksMTAgKzE5LDYgQEAgc3RydWN0IHBhbmZy
b3N0X2pvYiB7CiAJc3RydWN0IHBhbmZyb3N0X2RldmljZSAqcGZkZXY7CiAJc3RydWN0IHBhbmZy
b3N0X2ZpbGVfcHJpdiAqZmlsZV9wcml2OwogCi0JLyogQ29udGFpbnMgYm90aCBleHBsaWNpdCBh
bmQgaW1wbGljaXQgZmVuY2VzICovCi0Jc3RydWN0IHhhcnJheSBkZXBzOwotCXVuc2lnbmVkIGxv
bmcgbGFzdF9kZXA7Ci0KIAkvKiBGZW5jZSB0byBiZSBzaWduYWxlZCBieSBJUlEgaGFuZGxlciB3
aGVuIHRoZSBqb2IgaXMgY29tcGxldGUuICovCiAJc3RydWN0IGRtYV9mZW5jZSAqZG9uZV9mZW5j
ZTsKIApAQCAtNDIsNiArMzgsNyBAQCBpbnQgcGFuZnJvc3Rfam9iX2luaXQoc3RydWN0IHBhbmZy
b3N0X2RldmljZSAqcGZkZXYpOwogdm9pZCBwYW5mcm9zdF9qb2JfZmluaShzdHJ1Y3QgcGFuZnJv
c3RfZGV2aWNlICpwZmRldik7CiBpbnQgcGFuZnJvc3Rfam9iX29wZW4oc3RydWN0IHBhbmZyb3N0
X2ZpbGVfcHJpdiAqcGFuZnJvc3RfcHJpdik7CiB2b2lkIHBhbmZyb3N0X2pvYl9jbG9zZShzdHJ1
Y3QgcGFuZnJvc3RfZmlsZV9wcml2ICpwYW5mcm9zdF9wcml2KTsKK2ludCBwYW5mcm9zdF9qb2Jf
Z2V0X3Nsb3Qoc3RydWN0IHBhbmZyb3N0X2pvYiAqam9iKTsKIGludCBwYW5mcm9zdF9qb2JfcHVz
aChzdHJ1Y3QgcGFuZnJvc3Rfam9iICpqb2IpOwogdm9pZCBwYW5mcm9zdF9qb2JfcHV0KHN0cnVj
dCBwYW5mcm9zdF9qb2IgKmpvYik7CiB2b2lkIHBhbmZyb3N0X2pvYl9lbmFibGVfaW50ZXJydXB0
cyhzdHJ1Y3QgcGFuZnJvc3RfZGV2aWNlICpwZmRldik7Ci0tIAoyLjMyLjAKCl9fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbmFyby1tbS1zaWcgbWFpbGlu
ZyBsaXN0CkxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpodHRwczovL2xpc3RzLmxpbmFy
by5vcmcvbWFpbG1hbi9saXN0aW5mby9saW5hcm8tbW0tc2lnCg==
