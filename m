Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id E7C3242672B
	for <lists+linaro-mm-sig@lfdr.de>; Fri,  8 Oct 2021 11:50:30 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 6B82561A3D
	for <lists+linaro-mm-sig@lfdr.de>; Fri,  8 Oct 2021 09:50:29 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 3F59B617E8; Fri,  8 Oct 2021 09:50:27 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 763DF611F7;
	Fri,  8 Oct 2021 09:50:24 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id AEBBB60375
 for <linaro-mm-sig@lists.linaro.org>; Fri,  8 Oct 2021 09:50:22 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 92AB1611F7; Fri,  8 Oct 2021 09:50:22 +0000 (UTC)
Received: from mga05.intel.com (mga05.intel.com [192.55.52.43])
 by lists.linaro.org (Postfix) with ESMTPS id 40AD060375
 for <linaro-mm-sig@lists.linaro.org>; Fri,  8 Oct 2021 09:50:20 +0000 (UTC)
X-IronPort-AV: E=McAfee;i="6200,9189,10130"; a="312672405"
X-IronPort-AV: E=Sophos;i="5.85,357,1624345200"; d="scan'208";a="312672405"
Received: from orsmga007.jf.intel.com ([10.7.209.58])
 by fmsmga105.fm.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 Oct 2021 02:50:18 -0700
X-IronPort-AV: E=Sophos;i="5.85,357,1624345200"; d="scan'208";a="478920486"
Received: from tocallag-mobl2.ger.corp.intel.com (HELO tursulin-mobl2.home)
 ([10.213.250.80])
 by orsmga007-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 08 Oct 2021 02:50:16 -0700
From: Tvrtko Ursulin <tvrtko.ursulin@linux.intel.com>
To: Intel-gfx@lists.freedesktop.org
Date: Fri,  8 Oct 2021 10:50:07 +0100
Message-Id: <20211008095007.972693-1-tvrtko.ursulin@linux.intel.com>
X-Mailer: git-send-email 2.30.2
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: [Linaro-mm-sig] [PATCH] dma-resv: Fix dma_resv_get_fences and
 dma_resv_copy_fences after conversion
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: Tvrtko Ursulin <tvrtko.ursulin@intel.com>, dri-devel@lists.freedesktop.org,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 linaro-mm-sig@lists.linaro.org, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

RnJvbTogVHZydGtvIFVyc3VsaW4gPHR2cnRrby51cnN1bGluQGludGVsLmNvbT4KCkNhY2hlIHRo
ZSBjb3VudCBvZiBzaGFyZWQgZmVuY2VzIGluIHRoZSBpdGVyYXRvciB0byBhdm9pZCBkZXJlZmVy
ZW5jaW5nCnRoZSBkbWFfcmVzdl9vYmplY3Qgb3V0c2lkZSB0aGUgUkNVIHByb3RlY3Rpb24uIE90
aGVyd2lzZSBpdGVyYXRvciBhbmQgaXRzCnVzZXJzIGNhbiBvYnNlcnZlIGFuIGluY29zaXN0ZW50
IHN0YXRlIHdoaWNoIG1ha2VzIGl0IGltcG9zc2libGUgdG8gdXNlCnNhZmVseS4gU3VjaCBhczoK
Cjw2PiBbMTg3LjUxNzA0MV0gW0lHVF0gZ2VtX3N5bmM6IGV4ZWN1dGluZwo8Nz4gWzE4Ny41MzYz
NDNdIGk5MTUgMDAwMDowMDowMi4wOiBbZHJtOmk5MTVfZ2VtX2NvbnRleHRfY3JlYXRlX2lvY3Rs
IFtpOTE1XV0gSFcgY29udGV4dCAxIGNyZWF0ZWQKPDc+IFsxODcuNTM2NzkzXSBpOTE1IDAwMDA6
MDA6MDIuMDogW2RybTppOTE1X2dlbV9jb250ZXh0X2NyZWF0ZV9pb2N0bCBbaTkxNV1dIEhXIGNv
bnRleHQgMSBjcmVhdGVkCjw2PiBbMTg3LjU1MTIzNV0gW0lHVF0gZ2VtX3N5bmM6IHN0YXJ0aW5n
IHN1YnRlc3QgYmFzaWMtbWFueS1lYWNoCjwxPiBbMTg4LjkzNTQ2Ml0gQlVHOiBrZXJuZWwgTlVM
TCBwb2ludGVyIGRlcmVmZXJlbmNlLCBhZGRyZXNzOiAwMDAwMDAwMDAwMDAwMDEwCjwxPiBbMTg4
LjkzNTQ4NV0gI1BGOiBzdXBlcnZpc29yIHdyaXRlIGFjY2VzcyBpbiBrZXJuZWwgbW9kZQo8MT4g
WzE4OC45MzU0OTVdICNQRjogZXJyb3JfY29kZSgweDAwMDIpIC0gbm90LXByZXNlbnQgcGFnZQo8
Nj4gWzE4OC45MzU1MDRdIFBHRCAwIFA0RCAwCjw0PiBbMTg4LjkzNTUxMl0gT29wczogMDAwMiBb
IzFdIFBSRUVNUFQgU01QIE5PUFRJCjw0PiBbMTg4LjkzNTUyMV0gQ1BVOiAyIFBJRDogMTQ2NyBD
b21tOiBnZW1fc3luYyBOb3QgdGFpbnRlZCA1LjE1LjAtcmM0LUNJLVBhdGNod29ya18yMTI2NCsg
IzEKPDQ+IFsxODguOTM1NTM1XSBIYXJkd2FyZSBuYW1lOiAgL05VQzZDQVlCLCBCSU9TIEFZQVBM
Q0VMLjg2QS4wMDQ5LjIwMTguMDUwOC4xMzU2IDA1LzA4LzIwMTgKPDQ+IFsxODguOTM1NTQ2XSBS
SVA6IDAwMTA6ZG1hX3Jlc3ZfZ2V0X2ZlbmNlcysweDExNi8weDJkMAo8ND4gWzE4OC45MzU1NjBd
IENvZGU6IDEwIDg1IGMwIDdmIGM5IGJlIDAzIDAwIDAwIDAwIGU4IDE1IDhiIGRmIGZmIGViIGJk
IGU4IDhlIGM2IGZmIGZmIGViIGI2IDQxIDhiIDA0IDI0IDQ5IDhiIDU1IDAwIDQ4IDg5IGU3IDhk
IDQ4IDAxIDQxIDg5IDBjIDI0IDw0Yz4gODkgMzQgYzIgZTggNDEgZjIgZmYgZmYgNDkgODkgYzYg
NDggODUgYzAgNzUgOGMgNDggOGIgNDQgMjQgMTAKPDQ+IFsxODguOTM1NTgzXSBSU1A6IDAwMTg6
ZmZmZmM5MDAwMTFkYmNjOCBFRkxBR1M6IDAwMDEwMjAyCjw0PiBbMTg4LjkzNTU5M10gUkFYOiAw
MDAwMDAwMDAwMDAwMDAwIFJCWDogMDAwMDAwMDBmZmZmZmZmZiBSQ1g6IDAwMDAwMDAwMDAwMDAw
MDEKPDQ+IFsxODguOTM1NjAzXSBSRFg6IDAwMDAwMDAwMDAwMDAwMTAgUlNJOiBmZmZmZmZmZjgy
MmUzNDNjIFJESTogZmZmZmM5MDAwMTFkYmNjOAo8ND4gWzE4OC45MzU2MTNdIFJCUDogZmZmZmM5
MDAwMTFkYmQ0OCBSMDg6IGZmZmY4ODgxMmQyNTViYjggUjA5OiAwMDAwMDAwMGZmZmZmZmZlCjw0
PiBbMTg4LjkzNTYyM10gUjEwOiAwMDAwMDAwMDAwMDAwMDAxIFIxMTogMDAwMDAwMDAwMDAwMDAw
MCBSMTI6IGZmZmZjOTAwMDExZGJkNDQKPDQ+IFsxODguOTM1NjMzXSBSMTM6IGZmZmZjOTAwMDEx
ZGJkNTAgUjE0OiBmZmZmODg4MTEzZDI5Y2MwIFIxNTogMDAwMDAwMDAwMDAwMDAwMAo8ND4gWzE4
OC45MzU2NDNdIEZTOiAgMDAwMDdmNjhkMTdlOTcwMCgwMDAwKSBHUzpmZmZmODg4Mjc3OTAwMDAw
KDAwMDApIGtubEdTOjAwMDAwMDAwMDAwMDAwMDAKPDQ+IFsxODguOTM1NjU1XSBDUzogIDAwMTAg
RFM6IDAwMDAgRVM6IDAwMDAgQ1IwOiAwMDAwMDAwMDgwMDUwMDMzCjw0PiBbMTg4LjkzNTY2NV0g
Q1IyOiAwMDAwMDAwMDAwMDAwMDEwIENSMzogMDAwMDAwMDEyZDBhNDAwMCBDUjQ6IDAwMDAwMDAw
MDAzNTA2ZTAKPDQ+IFsxODguOTM1Njc2XSBDYWxsIFRyYWNlOgo8ND4gWzE4OC45MzU2ODVdICBp
OTE1X2dlbV9vYmplY3Rfd2FpdCsweDFmZi8weDQxMCBbaTkxNV0KPDQ+IFsxODguOTM1OTg4XSAg
aTkxNV9nZW1fd2FpdF9pb2N0bCsweGYyLzB4MmEwIFtpOTE1XQo8ND4gWzE4OC45MzYyNzJdICA/
IGk5MTVfZ2VtX29iamVjdF93YWl0KzB4NDEwLzB4NDEwIFtpOTE1XQo8ND4gWzE4OC45MzY1MzNd
ICBkcm1faW9jdGxfa2VybmVsKzB4YWUvMHgxNDAKPDQ+IFsxODguOTM2NTQ2XSAgZHJtX2lvY3Rs
KzB4MjAxLzB4M2QwCjw0PiBbMTg4LjkzNjU1NV0gID8gaTkxNV9nZW1fb2JqZWN0X3dhaXQrMHg0
MTAvMHg0MTAgW2k5MTVdCjw0PiBbMTg4LjkzNjgyMF0gID8gX19mZ2V0X2ZpbGVzKzB4YzIvMHgx
YzAKPDQ+IFsxODguOTM2ODMwXSAgPyBfX2ZnZXRfZmlsZXMrMHhkYS8weDFjMAo8ND4gWzE4OC45
MzY4MzldICBfX3g2NF9zeXNfaW9jdGwrMHg2ZC8weGEwCjw0PiBbMTg4LjkzNjg0OF0gIGRvX3N5
c2NhbGxfNjQrMHgzYS8weGIwCjw0PiBbMTg4LjkzNjg1OV0gIGVudHJ5X1NZU0NBTExfNjRfYWZ0
ZXJfaHdmcmFtZSsweDQ0LzB4YWUKCklmIHRoZSBzaGFyZWQgb2JqZWN0IGhhcyBjaGFuZ2VkIGR1
cmluZyB0aGUgUkNVIHVubG9ja2VkIHBlcmlvZApjYWxsZXJzIHdpbGwgY29ycmVjdGx5IGhhbmRs
ZSB0aGUgcmVzdGFydCBvbiB0aGUgbmV4dCBpdGVyYXRpb24uCgpTaWduZWQtb2ZmLWJ5OiBUdnJ0
a28gVXJzdWxpbiA8dHZydGtvLnVyc3VsaW5AaW50ZWwuY29tPgpGaXhlczogOTY2MDFlOGE0NzU1
ICgiZG1hLWJ1ZjogdXNlIG5ldyBpdGVyYXRvciBpbiBkbWFfcmVzdl9jb3B5X2ZlbmNlcyIpCkZp
eGVzOiBkM2M4MDY5OGM5ZjUgKCJkbWEtYnVmOiB1c2UgbmV3IGl0ZXJhdG9yIGluIGRtYV9yZXN2
X2dldF9mZW5jZXMgdjMiKQpDbG9zZXM6IGh0dHBzOi8vZ2l0bGFiLmZyZWVkZXNrdG9wLm9yZy9k
cm0vaW50ZWwvLS9pc3N1ZXMvNDI3NApDYzogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtv
ZW5pZ0BhbWQuY29tPgpDYzogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBmZndsbC5jaD4K
Q2M6IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+CkNjOiBsaW51eC1tZWRp
YUB2Z2VyLmtlcm5lbC5vcmcKQ2M6IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3RvcC5vcmcKQ2M6
IGxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwotLS0KIGRyaXZlcnMvZG1hLWJ1Zi9kbWEt
cmVzdi5jIHwgMTggKysrKysrKysrKy0tLS0tLS0tCiBpbmNsdWRlL2xpbnV4L2RtYS1yZXN2Lmgg
ICB8ICA1ICsrKystCiAyIGZpbGVzIGNoYW5nZWQsIDE0IGluc2VydGlvbnMoKyksIDkgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2RtYS1yZXN2LmMgYi9kcml2ZXJz
L2RtYS1idWYvZG1hLXJlc3YuYwppbmRleCBhNDgwYWY5NTgxYmQuLjdiNmQ4ODFjODkwNCAxMDA2
NDQKLS0tIGEvZHJpdmVycy9kbWEtYnVmL2RtYS1yZXN2LmMKKysrIGIvZHJpdmVycy9kbWEtYnVm
L2RtYS1yZXN2LmMKQEAgLTMzMywxMCArMzMzLDE0IEBAIHN0YXRpYyB2b2lkIGRtYV9yZXN2X2l0
ZXJfcmVzdGFydF91bmxvY2tlZChzdHJ1Y3QgZG1hX3Jlc3ZfaXRlciAqY3Vyc29yKQogewogCWN1
cnNvci0+c2VxID0gcmVhZF9zZXFjb3VudF9iZWdpbigmY3Vyc29yLT5vYmotPnNlcSk7CiAJY3Vy
c29yLT5pbmRleCA9IC0xOwotCWlmIChjdXJzb3ItPmFsbF9mZW5jZXMpCisJY3Vyc29yLT5zaGFy
ZWRfY291bnQgPSAwOworCWlmIChjdXJzb3ItPmFsbF9mZW5jZXMpIHsKIAkJY3Vyc29yLT5mZW5j
ZXMgPSBkbWFfcmVzdl9zaGFyZWRfbGlzdChjdXJzb3ItPm9iaik7Ci0JZWxzZQorCQlpZiAoY3Vy
c29yLT5mZW5jZXMpCisJCQljdXJzb3ItPnNoYXJlZF9jb3VudCA9IGN1cnNvci0+ZmVuY2VzLT5z
aGFyZWRfY291bnQ7CisJfSBlbHNlIHsKIAkJY3Vyc29yLT5mZW5jZXMgPSBOVUxMOworCX0KIAlj
dXJzb3ItPmlzX3Jlc3RhcnRlZCA9IHRydWU7CiB9CiAKQEAgLTM2Myw3ICszNjcsNyBAQCBzdGF0
aWMgdm9pZCBkbWFfcmVzdl9pdGVyX3dhbGtfdW5sb2NrZWQoc3RydWN0IGRtYV9yZXN2X2l0ZXIg
KmN1cnNvcikKIAkJCQljb250aW51ZTsKIAogCQl9IGVsc2UgaWYgKCFjdXJzb3ItPmZlbmNlcyB8
fAotCQkJICAgY3Vyc29yLT5pbmRleCA+PSBjdXJzb3ItPmZlbmNlcy0+c2hhcmVkX2NvdW50KSB7
CisJCQkgICBjdXJzb3ItPmluZGV4ID49IGN1cnNvci0+c2hhcmVkX2NvdW50KSB7CiAJCQljdXJz
b3ItPmZlbmNlID0gTlVMTDsKIAkJCWJyZWFrOwogCkBAIC00NDgsMTAgKzQ1Miw4IEBAIGludCBk
bWFfcmVzdl9jb3B5X2ZlbmNlcyhzdHJ1Y3QgZG1hX3Jlc3YgKmRzdCwgc3RydWN0IGRtYV9yZXN2
ICpzcmMpCiAJCQlkbWFfcmVzdl9saXN0X2ZyZWUobGlzdCk7CiAJCQlkbWFfZmVuY2VfcHV0KGV4
Y2wpOwogCi0JCQlpZiAoY3Vyc29yLmZlbmNlcykgewotCQkJCXVuc2lnbmVkIGludCBjbnQgPSBj
dXJzb3IuZmVuY2VzLT5zaGFyZWRfY291bnQ7Ci0KLQkJCQlsaXN0ID0gZG1hX3Jlc3ZfbGlzdF9h
bGxvYyhjbnQpOworCQkJaWYgKGN1cnNvci5zaGFyZWRfY291bnQpIHsKKwkJCQlsaXN0ID0gZG1h
X3Jlc3ZfbGlzdF9hbGxvYyhjdXJzb3Iuc2hhcmVkX2NvdW50KTsKIAkJCQlpZiAoIWxpc3QpIHsK
IAkJCQkJZG1hX3Jlc3ZfaXRlcl9lbmQoJmN1cnNvcik7CiAJCQkJCXJldHVybiAtRU5PTUVNOwpA
QCAtNTIyLDcgKzUyNCw3IEBAIGludCBkbWFfcmVzdl9nZXRfZmVuY2VzKHN0cnVjdCBkbWFfcmVz
diAqb2JqLCBzdHJ1Y3QgZG1hX2ZlbmNlICoqZmVuY2VfZXhjbCwKIAkJCWlmIChmZW5jZV9leGNs
KQogCQkJCWRtYV9mZW5jZV9wdXQoKmZlbmNlX2V4Y2wpOwogCi0JCQljb3VudCA9IGN1cnNvci5m
ZW5jZXMgPyBjdXJzb3IuZmVuY2VzLT5zaGFyZWRfY291bnQgOiAwOworCQkJY291bnQgPSBjdXJz
b3Iuc2hhcmVkX2NvdW50OwogCQkJY291bnQgKz0gZmVuY2VfZXhjbCA/IDAgOiAxOwogCiAJCQkv
KiBFdmVudHVhbGx5IHJlLWFsbG9jYXRlIHRoZSBhcnJheSAqLwpkaWZmIC0tZ2l0IGEvaW5jbHVk
ZS9saW51eC9kbWEtcmVzdi5oIGIvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oCmluZGV4IDhiNmMy
MDYzNmE3OS4uM2UxYmZmMTQ3NDI4IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2RtYS1yZXN2
LmgKKysrIGIvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oCkBAIC0xNzAsOSArMTcwLDEyIEBAIHN0
cnVjdCBkbWFfcmVzdl9pdGVyIHsKIAkvKiogQGluZGV4OiBpbmRleCBpbnRvIHRoZSBzaGFyZWQg
ZmVuY2VzICovCiAJdW5zaWduZWQgaW50IGluZGV4OwogCi0JLyoqIEBmZW5jZXM6IHRoZSBzaGFy
ZWQgZmVuY2VzICovCisJLyoqIEBmZW5jZXM6IHRoZSBzaGFyZWQgZmVuY2VzOyBwcml2YXRlLCAq
TVVTVCogbm90IGRlcmVmZXJlbmNlICAqLwogCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpmZW5jZXM7
CiAKKwkvKiogQHNoYXJlZF9jb3VudDogbnVtYmVyIG9mIHNoYXJlZCBmZW5jZXMgKi8KKwl1bnNp
Z25lZCBpbnQgc2hhcmVkX2NvdW50OworCiAJLyoqIEBpc19yZXN0YXJ0ZWQ6IHRydWUgaWYgdGhp
cyBpcyB0aGUgZmlyc3QgcmV0dXJuZWQgZmVuY2UgKi8KIAlib29sIGlzX3Jlc3RhcnRlZDsKIH07
Ci0tIAoyLjMwLjIKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fCkxpbmFyby1tbS1zaWcgbWFpbGluZyBsaXN0CkxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJv
Lm9yZwpodHRwczovL2xpc3RzLmxpbmFyby5vcmcvbWFpbG1hbi9saXN0aW5mby9saW5hcm8tbW0t
c2lnCg==
