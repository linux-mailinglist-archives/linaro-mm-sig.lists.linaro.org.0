Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 8D0E54D6052
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 11 Mar 2022 12:02:50 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 59CB23EEE4
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 11 Mar 2022 11:02:49 +0000 (UTC)
Received: from mail-wm1-f45.google.com (mail-wm1-f45.google.com [209.85.128.45])
	by lists.linaro.org (Postfix) with ESMTPS id 9584A3EE9C
	for <linaro-mm-sig@lists.linaro.org>; Fri, 11 Mar 2022 11:02:47 +0000 (UTC)
Received: by mail-wm1-f45.google.com with SMTP id n33-20020a05600c3ba100b003832caf7f3aso5754837wms.0
        for <linaro-mm-sig@lists.linaro.org>; Fri, 11 Mar 2022 03:02:47 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20210112;
        h=from:to:cc:subject:date:message-id:mime-version
         :content-transfer-encoding;
        bh=GFp62pGudTaAvJCQbs/e68j4lgVVveBITWzF5FI2cio=;
        b=mY5b6auw+fLSBfJsiVWN8aPcW/cROWCyRbyjwtKw3Wm740m1fqoT+fRsAGAue/+WVy
         JLBoFTHAgSliLtogVwFXDZ7YgMto+ZxaTjl5LxiCClliB0akrTmc6WnXJA0b+H5zzDbb
         QtcnN/nIKLFdldn92ktNz/Yn9N7NE+SGj6s+8/Wkl2gA6vSKx3/23sM4AZjViF7U1gKE
         oaBfilvTQwHKVOvmX4K+9bQykcOBpgN6I4Uy2u6975UN7a5hHB/tPH4mhP7rlvhFlxcH
         jdzyOoklBK0DmCPTXRrUWZA/ZGzK04PPSfNGUjkNw0drJKD0CGk66g2WrM08J0ws/sGC
         pxmg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=x-gm-message-state:from:to:cc:subject:date:message-id:mime-version
         :content-transfer-encoding;
        bh=GFp62pGudTaAvJCQbs/e68j4lgVVveBITWzF5FI2cio=;
        b=x/EKlKDQXb5Iw5RHRV6GN8VFUZ8SyfLLy/p50BpS9zd6aSNaRlcP5BTtAQu+d4GBpn
         H5uTCAEQnXGUSmQi1HlS3f9dSw+e0OWwt3aj3IW8uAtM6GCI/mg28fTn3BKwBU01AZnk
         gYzxrsBcud9DCv2CLVw3q3kN0va5x1mJDfOaKU02b8rA7LclstasHbvz4M4Nk9Hk++0L
         sRDCAJ+TwrgkHL38NPl7h8yeOjxU8otrI6UFneu149NUHeWRMebm2o7ahmepph6MGwaC
         njoLGOse3M6/qe0CEkpYc8Yi+mITIzZ69AUFH8BeEczEuzIs3eduYwxHlOcXU+PPOUzZ
         cOXg==
X-Gm-Message-State: AOAM533dYK7UMcOhFOfyiIvPvSreSP6tR0/OCsPlip+6ZXizq4U+nGCv
	TMpKLEw5HcsIIJi1nc1Wf+U=
X-Google-Smtp-Source: ABdhPJyk4yIn1WFbf96nZxzhOJ3I+drGMsJY0s8+/LEosCFddwYZ7RIwF4aZnr2+6CN5MudvPun/NQ==
X-Received: by 2002:a05:600c:3c9c:b0:389:cc3b:9462 with SMTP id bg28-20020a05600c3c9c00b00389cc3b9462mr12281996wmb.105.1646996566458;
        Fri, 11 Mar 2022 03:02:46 -0800 (PST)
Received: from able.fritz.box (p5b0eab60.dip0.t-ipconnect.de. [91.14.171.96])
        by smtp.gmail.com with ESMTPSA id 9-20020a1c0209000000b003868897278asm10170918wmc.23.2022.03.11.03.02.45
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Fri, 11 Mar 2022 03:02:45 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
To: sumit.semwal@linaro.org,
	gustavo@padovan.org,
	linux-media@vger.kernel.org,
	dri-devel@lists.freedesktop.org,
	linaro-mm-sig@lists.linaro.org
Date: Fri, 11 Mar 2022 12:02:43 +0100
Message-Id: <20220311110244.1245-1-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
MIME-Version: 1.0
Message-ID-Hash: X6R2Q27WTG44OSD3MSBVHBYELLN3YNJX
X-Message-ID-Hash: X6R2Q27WTG44OSD3MSBVHBYELLN3YNJX
X-MailFrom: ckoenig.leichtzumerken@gmail.com
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
CC: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 1/2] dma-buf: add dma_fence_unwrap
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/X6R2Q27WTG44OSD3MSBVHBYELLN3YNJX/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

QWRkIGEgZ2VuZXJhbCBwdXJwb3NlIGhlbHBlciB0byBkZWVwIGRpdmUgaW50byBkbWFfZmVuY2Vf
Y2hhaW4vZG1hX2ZlbmNlX2FycmF5DQpzdHJ1Y3R1cmVzIGFuZCBpdGVyYXRlIG92ZXIgYWxsIHRo
ZSBmZW5jZXMgaW4gdGhlbS4NCg0KVGhpcyBpcyB1c2VmdWwgd2hlbiB3ZSBuZWVkIHRvIGZsYXR0
ZW4gb3V0IGFsbCBmZW5jZXMgaW4gdGhvc2Ugc3RydWN0dXJlcy4NCg0KU2lnbmVkLW9mZi1ieTog
Q2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPg0KLS0tDQogRG9jdW1l
bnRhdGlvbi9kcml2ZXItYXBpL2RtYS1idWYucnN0ICB8ICAgNiArDQogZHJpdmVycy9kbWEtYnVm
L01ha2VmaWxlICAgICAgICAgICAgICB8ICAgMSArDQogZHJpdmVycy9kbWEtYnVmL3NlbGZ0ZXN0
cy5oICAgICAgICAgICB8ICAgMSArDQogZHJpdmVycy9kbWEtYnVmL3N0LWRtYS1mZW5jZS11bndy
YXAuYyB8IDI3OSArKysrKysrKysrKysrKysrKysrKysrKysrKw0KIGluY2x1ZGUvbGludXgvZG1h
LWZlbmNlLXVud3JhcC5oICAgICAgfCAgOTkgKysrKysrKysrDQogNSBmaWxlcyBjaGFuZ2VkLCAz
ODYgaW5zZXJ0aW9ucygrKQ0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2RtYS1idWYvc3Qt
ZG1hLWZlbmNlLXVud3JhcC5jDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGluY2x1ZGUvbGludXgvZG1h
LWZlbmNlLXVud3JhcC5oDQoNCmRpZmYgLS1naXQgYS9Eb2N1bWVudGF0aW9uL2RyaXZlci1hcGkv
ZG1hLWJ1Zi5yc3QgYi9Eb2N1bWVudGF0aW9uL2RyaXZlci1hcGkvZG1hLWJ1Zi5yc3QNCmluZGV4
IDJjZDdkYjgyZDlmZS4uNzIwOTUwMGYwOGM4IDEwMDY0NA0KLS0tIGEvRG9jdW1lbnRhdGlvbi9k
cml2ZXItYXBpL2RtYS1idWYucnN0DQorKysgYi9Eb2N1bWVudGF0aW9uL2RyaXZlci1hcGkvZG1h
LWJ1Zi5yc3QNCkBAIC0xOTQsNiArMTk0LDEyIEBAIERNQSBGZW5jZSBDaGFpbg0KIC4uIGtlcm5l
bC1kb2M6OiBpbmNsdWRlL2xpbnV4L2RtYS1mZW5jZS1jaGFpbi5oDQogICAgOmludGVybmFsOg0K
IA0KK0RNQSBGZW5jZSB1bndyYXANCit+fn5+fn5+fn5+fn5+fn5+DQorDQorLi4ga2VybmVsLWRv
Yzo6IGluY2x1ZGUvbGludXgvZG1hLWZlbmNlLXVud3JhcC5oDQorICAgOmludGVybmFsOg0KKw0K
IERNQSBGZW5jZSB1QUJJL1N5bmMgRmlsZQ0KIH5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fg0KIA0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9NYWtlZmlsZSBiL2RyaXZlcnMvZG1hLWJ1Zi9N
YWtlZmlsZQ0KaW5kZXggNTExODA1ZGJlYjc1Li40YzllYjUzYmEzZjggMTAwNjQ0DQotLS0gYS9k
cml2ZXJzL2RtYS1idWYvTWFrZWZpbGUNCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9NYWtlZmlsZQ0K
QEAgLTEyLDYgKzEyLDcgQEAgZG1hYnVmX3NlbGZ0ZXN0cy15IDo9IFwNCiAJc2VsZnRlc3QubyBc
DQogCXN0LWRtYS1mZW5jZS5vIFwNCiAJc3QtZG1hLWZlbmNlLWNoYWluLm8gXA0KKwlzdC1kbWEt
ZmVuY2UtdW53cmFwLm8gXA0KIAlzdC1kbWEtcmVzdi5vDQogDQogb2JqLSQoQ09ORklHX0RNQUJV
Rl9TRUxGVEVTVFMpCSs9IGRtYWJ1Zl9zZWxmdGVzdHMubw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
ZG1hLWJ1Zi9zZWxmdGVzdHMuaCBiL2RyaXZlcnMvZG1hLWJ1Zi9zZWxmdGVzdHMuaA0KaW5kZXgg
OTdkNzNhYWEzMWRhLi44NTE5NjU4NjdkOWMgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2RtYS1idWYv
c2VsZnRlc3RzLmgNCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9zZWxmdGVzdHMuaA0KQEAgLTEyLDQg
KzEyLDUgQEANCiBzZWxmdGVzdChzYW5pdHljaGVjaywgX19zYW5pdHljaGVja19fKSAvKiBrZWVw
IGZpcnN0IChpZ3Qgc2VsZmNoZWNrKSAqLw0KIHNlbGZ0ZXN0KGRtYV9mZW5jZSwgZG1hX2ZlbmNl
KQ0KIHNlbGZ0ZXN0KGRtYV9mZW5jZV9jaGFpbiwgZG1hX2ZlbmNlX2NoYWluKQ0KK3NlbGZ0ZXN0
KGRtYV9mZW5jZV91bndyYXAsIGRtYV9mZW5jZV91bndyYXApDQogc2VsZnRlc3QoZG1hX3Jlc3Ys
IGRtYV9yZXN2KQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtZmVuY2UtdW53
cmFwLmMgYi9kcml2ZXJzL2RtYS1idWYvc3QtZG1hLWZlbmNlLXVud3JhcC5jDQpuZXcgZmlsZSBt
b2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi5kODIxZmFhZWJlOTMNCi0tLSAvZGV2L251
bGwNCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtZmVuY2UtdW53cmFwLmMNCkBAIC0wLDAg
KzEsMjc5IEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVA0KKw0KKy8qDQorICog
Q29weXJpZ2h0IChDKSAyMDIyIEFkdmFuY2VkIE1pY3JvIERldmljZXMsIEluYy4NCisgKi8NCisN
CisjaW5jbHVkZSA8bGludXgvZG1hLWZlbmNlLXVud3JhcC5oPg0KKyNpZiAwDQorI2luY2x1ZGUg
PGxpbnV4L2tlcm5lbC5oPg0KKyNpbmNsdWRlIDxsaW51eC9rdGhyZWFkLmg+DQorI2luY2x1ZGUg
PGxpbnV4L21tLmg+DQorI2luY2x1ZGUgPGxpbnV4L3NjaGVkL3NpZ25hbC5oPg0KKyNpbmNsdWRl
IDxsaW51eC9zbGFiLmg+DQorI2luY2x1ZGUgPGxpbnV4L3NwaW5sb2NrLmg+DQorI2luY2x1ZGUg
PGxpbnV4L3JhbmRvbS5oPg0KKyNlbmRpZg0KKw0KKyNpbmNsdWRlICJzZWxmdGVzdC5oIg0KKw0K
KyNkZWZpbmUgQ0hBSU5fU1ogKDQgPDwgMTApDQorDQorc3RhdGljIHN0cnVjdCBrbWVtX2NhY2hl
ICpzbGFiX2ZlbmNlczsNCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBtb2NrX2ZlbmNlIHsNCisJ
c3RydWN0IGRtYV9mZW5jZSBiYXNlOw0KKwlzcGlubG9ja190IGxvY2s7DQorfSAqdG9fbW9ja19m
ZW5jZShzdHJ1Y3QgZG1hX2ZlbmNlICpmKSB7DQorCXJldHVybiBjb250YWluZXJfb2YoZiwgc3Ry
dWN0IG1vY2tfZmVuY2UsIGJhc2UpOw0KK30NCisNCitzdGF0aWMgY29uc3QgY2hhciAqbW9ja19u
YW1lKHN0cnVjdCBkbWFfZmVuY2UgKmYpDQorew0KKwlyZXR1cm4gIm1vY2siOw0KK30NCisNCitz
dGF0aWMgdm9pZCBtb2NrX2ZlbmNlX3JlbGVhc2Uoc3RydWN0IGRtYV9mZW5jZSAqZikNCit7DQor
CWttZW1fY2FjaGVfZnJlZShzbGFiX2ZlbmNlcywgdG9fbW9ja19mZW5jZShmKSk7DQorfQ0KKw0K
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZG1hX2ZlbmNlX29wcyBtb2NrX29wcyA9IHsNCisJLmdldF9k
cml2ZXJfbmFtZSA9IG1vY2tfbmFtZSwNCisJLmdldF90aW1lbGluZV9uYW1lID0gbW9ja19uYW1l
LA0KKwkucmVsZWFzZSA9IG1vY2tfZmVuY2VfcmVsZWFzZSwNCit9Ow0KKw0KK3N0YXRpYyBzdHJ1
Y3QgZG1hX2ZlbmNlICptb2NrX2ZlbmNlKHZvaWQpDQorew0KKwlzdHJ1Y3QgbW9ja19mZW5jZSAq
ZjsNCisNCisJZiA9IGttZW1fY2FjaGVfYWxsb2Moc2xhYl9mZW5jZXMsIEdGUF9LRVJORUwpOw0K
KwlpZiAoIWYpDQorCQlyZXR1cm4gTlVMTDsNCisNCisJc3Bpbl9sb2NrX2luaXQoJmYtPmxvY2sp
Ow0KKwlkbWFfZmVuY2VfaW5pdCgmZi0+YmFzZSwgJm1vY2tfb3BzLCAmZi0+bG9jaywgMCwgMCk7
DQorDQorCXJldHVybiAmZi0+YmFzZTsNCit9DQorDQorc3RhdGljIHN0cnVjdCBkbWFfZmVuY2Ug
Km1vY2tfYXJyYXkodW5zaWduZWQgaW50IG51bV9mZW5jZXMsIC4uLikNCit7DQorCXN0cnVjdCBk
bWFfZmVuY2VfYXJyYXkgKmFycmF5Ow0KKwlzdHJ1Y3QgZG1hX2ZlbmNlICoqZmVuY2VzOw0KKwl2
YV9saXN0IHZhbGlzdDsNCisJaW50IGk7DQorDQorCWZlbmNlcyA9IGtjYWxsb2MobnVtX2ZlbmNl
cywgc2l6ZW9mKCpmZW5jZXMpLCBHRlBfS0VSTkVMKTsNCisJaWYgKCFmZW5jZXMpDQorCQlyZXR1
cm4gTlVMTDsNCisNCisJdmFfc3RhcnQodmFsaXN0LCBudW1fZmVuY2VzKTsNCisJZm9yIChpID0g
MDsgaSA8IG51bV9mZW5jZXM7ICsraSkNCisJCWZlbmNlc1tpXSA9IHZhX2FyZyh2YWxpc3QsIHR5
cGVvZigqZmVuY2VzKSk7DQorCXZhX2VuZCh2YWxpc3QpOw0KKw0KKwlhcnJheSA9IGRtYV9mZW5j
ZV9hcnJheV9jcmVhdGUobnVtX2ZlbmNlcywgZmVuY2VzLA0KKwkJCQkgICAgICAgZG1hX2ZlbmNl
X2NvbnRleHRfYWxsb2MoMSksDQorCQkJCSAgICAgICAxLCBmYWxzZSk7DQorCWlmICghYXJyYXkp
DQorCQlnb3RvIGNsZWFudXA7DQorCXJldHVybiAmYXJyYXktPmJhc2U7DQorDQorY2xlYW51cDoN
CisJZm9yIChpID0gMDsgaSA8IG51bV9mZW5jZXM7ICsraSkNCisJCWRtYV9mZW5jZV9wdXQoZmVu
Y2VzW2ldKTsNCisJa2ZyZWUoZmVuY2VzKTsNCisJcmV0dXJuIE5VTEw7DQorfQ0KKw0KK3N0YXRp
YyBzdHJ1Y3QgZG1hX2ZlbmNlICptb2NrX2NoYWluKHN0cnVjdCBkbWFfZmVuY2UgKnByZXYsDQor
CQkJCSAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkNCit7DQorCXN0cnVjdCBkbWFfZmVuY2Vf
Y2hhaW4gKmY7DQorDQorCWYgPSBkbWFfZmVuY2VfY2hhaW5fYWxsb2MoKTsNCisJaWYgKCFmKSB7
DQorCQlkbWFfZmVuY2VfcHV0KHByZXYpOw0KKwkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7DQorCQly
ZXR1cm4gTlVMTDsNCisJfQ0KKw0KKwlkbWFfZmVuY2VfY2hhaW5faW5pdChmLCBwcmV2LCBmZW5j
ZSwgMSk7DQorCXJldHVybiAmZi0+YmFzZTsNCit9DQorDQorc3RhdGljIGludCBzYW5pdHljaGVj
ayh2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmLCAqY2hhaW4sICphcnJheTsN
CisJaW50IGVyciA9IDA7DQorDQorCWYgPSBtb2NrX2ZlbmNlKCk7DQorCWlmICghZikNCisJCXJl
dHVybiAtRU5PTUVNOw0KKw0KKwlhcnJheSA9IG1vY2tfYXJyYXkoMSwgZik7DQorCWlmICghYXJy
YXkpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJY2hhaW4gPSBtb2NrX2NoYWluKE5VTEwsIGFy
cmF5KTsNCisJaWYgKCFjaGFpbikNCisJCXJldHVybiAtRU5PTUVNOw0KKw0KKwlkbWFfZmVuY2Vf
c2lnbmFsKGYpOw0KKwlkbWFfZmVuY2VfcHV0KGNoYWluKTsNCisJcmV0dXJuIGVycjsNCit9DQor
DQorc3RhdGljIGludCB1bndyYXBfYXJyYXkodm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRtYV9m
ZW5jZSAqZmVuY2UsICpmMSwgKmYyLCAqYXJyYXk7DQorCXN0cnVjdCBkbWFfZmVuY2VfdW53cmFw
IGl0ZXI7DQorCWludCBlcnIgPSAwOw0KKw0KKwlmMSA9IG1vY2tfZmVuY2UoKTsNCisJaWYgKCFm
MSkNCisJCXJldHVybiAtRU5PTUVNOw0KKw0KKwlmMiA9IG1vY2tfZmVuY2UoKTsNCisJaWYgKCFm
Mikgew0KKwkJZG1hX2ZlbmNlX3B1dChmMSk7DQorCQlyZXR1cm4gLUVOT01FTTsNCisJfQ0KKw0K
KwlhcnJheSA9IG1vY2tfYXJyYXkoMiwgZjEsIGYyKTsNCisJaWYgKCFhcnJheSkNCisJCXJldHVy
biAtRU5PTUVNOw0KKw0KKwlkbWFfZmVuY2VfdW53cmFwX2Zvcl9lYWNoKGZlbmNlLCAmaXRlciwg
YXJyYXkpIHsNCisJCWlmIChmZW5jZSA9PSBmMSkgew0KKwkJCWYxID0gTlVMTDsNCisJCX0gZWxz
ZSBpZiAoZmVuY2UgPT0gZjIpIHsNCisJCQlmMiA9IE5VTEw7DQorCQl9IGVsc2Ugew0KKwkJCXBy
X2VycigiVW5leHBlY3RlZCBmZW5jZSFcbiIpOw0KKwkJCWVyciA9IC1FSU5WQUw7DQorCQl9DQor
CX0NCisNCisJaWYgKGYxIHx8IGYyKSB7DQorCQlwcl9lcnIoIk5vdCBhbGwgZmVuY2VzIHNlZW4h
XG4iKTsNCisJCWVyciA9IC1FSU5WQUw7DQorCX0NCisNCisJZG1hX2ZlbmNlX3NpZ25hbChmMSk7
DQorCWRtYV9mZW5jZV9zaWduYWwoZjIpOw0KKwlkbWFfZmVuY2VfcHV0KGFycmF5KTsNCisJcmV0
dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgdW53cmFwX2NoYWluKHZvaWQgKmFyZykNCit7DQor
CXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLCAqZjEsICpmMiwgKmNoYWluOw0KKwlzdHJ1Y3QgZG1h
X2ZlbmNlX3Vud3JhcCBpdGVyOw0KKwlpbnQgZXJyID0gMDsNCisNCisJZjEgPSBtb2NrX2ZlbmNl
KCk7DQorCWlmICghZjEpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJZjIgPSBtb2NrX2ZlbmNl
KCk7DQorCWlmICghZjIpIHsNCisJCWRtYV9mZW5jZV9wdXQoZjEpOw0KKwkJcmV0dXJuIC1FTk9N
RU07DQorCX0NCisNCisJY2hhaW4gPSBtb2NrX2NoYWluKGYxLCBmMik7DQorCWlmICghY2hhaW4p
DQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJZG1hX2ZlbmNlX3Vud3JhcF9mb3JfZWFjaChmZW5j
ZSwgJml0ZXIsIGNoYWluKSB7DQorCQlpZiAoZmVuY2UgPT0gZjEpIHsNCisJCQlmMSA9IE5VTEw7
DQorCQl9IGVsc2UgaWYgKGZlbmNlID09IGYyKSB7DQorCQkJZjIgPSBOVUxMOw0KKwkJfSBlbHNl
IHsNCisJCQlwcl9lcnIoIlVuZXhwZWN0ZWQgZmVuY2UhXG4iKTsNCisJCQllcnIgPSAtRUlOVkFM
Ow0KKwkJfQ0KKwl9DQorDQorCWlmIChmMSB8fCBmMikgew0KKwkJcHJfZXJyKCJOb3QgYWxsIGZl
bmNlcyBzZWVuIVxuIik7DQorCQllcnIgPSAtRUlOVkFMOw0KKwl9DQorDQorCWRtYV9mZW5jZV9z
aWduYWwoZjEpOw0KKwlkbWFfZmVuY2Vfc2lnbmFsKGYyKTsNCisJZG1hX2ZlbmNlX3B1dChjaGFp
bik7DQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IHVud3JhcF9jaGFpbl9hcnJheSh2
b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSwgKmYxLCAqZjIsICphcnJh
eSwgKmNoYWluOw0KKwlzdHJ1Y3QgZG1hX2ZlbmNlX3Vud3JhcCBpdGVyOw0KKwlpbnQgZXJyID0g
MDsNCisNCisJZjEgPSBtb2NrX2ZlbmNlKCk7DQorCWlmICghZjEpDQorCQlyZXR1cm4gLUVOT01F
TTsNCisNCisJZjIgPSBtb2NrX2ZlbmNlKCk7DQorCWlmICghZjIpIHsNCisJCWRtYV9mZW5jZV9w
dXQoZjEpOw0KKwkJcmV0dXJuIC1FTk9NRU07DQorCX0NCisNCisJYXJyYXkgPSBtb2NrX2FycmF5
KDIsIGYxLCBmMik7DQorCWlmICghYXJyYXkpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJY2hh
aW4gPSBtb2NrX2NoYWluKE5VTEwsIGFycmF5KTsNCisJaWYgKCFjaGFpbikNCisJCXJldHVybiAt
RU5PTUVNOw0KKw0KKwlkbWFfZmVuY2VfdW53cmFwX2Zvcl9lYWNoKGZlbmNlLCAmaXRlciwgY2hh
aW4pIHsNCisJCWlmIChmZW5jZSA9PSBmMSkgew0KKwkJCWYxID0gTlVMTDsNCisJCX0gZWxzZSBp
ZiAoZmVuY2UgPT0gZjIpIHsNCisJCQlmMiA9IE5VTEw7DQorCQl9IGVsc2Ugew0KKwkJCXByX2Vy
cigiVW5leHBlY3RlZCBmZW5jZSFcbiIpOw0KKwkJCWVyciA9IC1FSU5WQUw7DQorCQl9DQorCX0N
CisNCisJaWYgKGYxIHx8IGYyKSB7DQorCQlwcl9lcnIoIk5vdCBhbGwgZmVuY2VzIHNlZW4hXG4i
KTsNCisJCWVyciA9IC1FSU5WQUw7DQorCX0NCisNCisJZG1hX2ZlbmNlX3NpZ25hbChmMSk7DQor
CWRtYV9mZW5jZV9zaWduYWwoZjIpOw0KKwlkbWFfZmVuY2VfcHV0KGNoYWluKTsNCisJcmV0dXJu
IDA7DQorfQ0KKw0KK2ludCBkbWFfZmVuY2VfdW53cmFwKHZvaWQpDQorew0KKwlzdGF0aWMgY29u
c3Qgc3RydWN0IHN1YnRlc3QgdGVzdHNbXSA9IHsNCisJCVNVQlRFU1Qoc2FuaXR5Y2hlY2spLA0K
KwkJU1VCVEVTVCh1bndyYXBfYXJyYXkpLA0KKwkJU1VCVEVTVCh1bndyYXBfY2hhaW4pLA0KKwkJ
U1VCVEVTVCh1bndyYXBfY2hhaW5fYXJyYXkpLA0KKwl9Ow0KKwlpbnQgcmV0Ow0KKw0KKwlzbGFi
X2ZlbmNlcyA9IEtNRU1fQ0FDSEUobW9ja19mZW5jZSwNCisJCQkJIFNMQUJfVFlQRVNBRkVfQllf
UkNVIHwNCisJCQkJIFNMQUJfSFdDQUNIRV9BTElHTik7DQorCWlmICghc2xhYl9mZW5jZXMpDQor
CQlyZXR1cm4gLUVOT01FTTsNCisNCisJcmV0ID0gc3VidGVzdHModGVzdHMsIE5VTEwpOw0KKw0K
KwlrbWVtX2NhY2hlX2Rlc3Ryb3koc2xhYl9mZW5jZXMpOw0KKwlyZXR1cm4gcmV0Ow0KK30NCmRp
ZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2RtYS1mZW5jZS11bndyYXAuaCBiL2luY2x1ZGUvbGlu
dXgvZG1hLWZlbmNlLXVud3JhcC5oDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAw
MDAwMDAwLi41NDk2M2RmMDBjOTgNCi0tLSAvZGV2L251bGwNCisrKyBiL2luY2x1ZGUvbGludXgv
ZG1hLWZlbmNlLXVud3JhcC5oDQpAQCAtMCwwICsxLDk5IEBADQorLyogU1BEWC1MaWNlbnNlLUlk
ZW50aWZpZXI6IEdQTC0yLjAtb25seSAqLw0KKy8qDQorICogZmVuY2UtY2hhaW46IGNoYWluIGZl
bmNlcyB0b2dldGhlciBpbiBhIHRpbWVsaW5lDQorICoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjIg
QWR2YW5jZWQgTWljcm8gRGV2aWNlcywgSW5jLg0KKyAqIEF1dGhvcnM6DQorICoJQ2hyaXN0aWFu
IEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPg0KKyAqLw0KKw0KKyNpZm5kZWYgX19M
SU5VWF9ETUFfRkVOQ0VfVU5XUkFQX0gNCisjZGVmaW5lIF9fTElOVVhfRE1BX0ZFTkNFX1VOV1JB
UF9IDQorDQorI2luY2x1ZGUgPGxpbnV4L2RtYS1mZW5jZS1jaGFpbi5oPg0KKyNpbmNsdWRlIDxs
aW51eC9kbWEtZmVuY2UtYXJyYXkuaD4NCisNCisvKioNCisgKiBzdHJ1Y3QgZG1hX2ZlbmNlX3Vu
d3JhcCAtIGN1cnNvciBpbnRvIHRoZSBjb250YWluZXIgc3RydWN0dXJlDQorICovDQorc3RydWN0
IGRtYV9mZW5jZV91bndyYXAgew0KKwkvKioNCisJICogQGNoYWluOiBwb3RlbnRpYWwgZG1hX2Zl
bmNlX2NoYWluLCBidXQgY2FuIGJlIG90aGVyIGZlbmNlIGFzIHdlbGwNCisJICovDQorCXN0cnVj
dCBkbWFfZmVuY2UgKmNoYWluOw0KKwkvKioNCisJICogQGFycmF5OiBwb3RlbnRpYWwgZG1hX2Zl
bmNlX2FycmF5LCBidXQgY2FuIGJlIG90aGVyIGZlbmNlIGFzIHdlbGwNCisJICovDQorCXN0cnVj
dCBkbWFfZmVuY2UgKmFycmF5Ow0KKwkvKioNCisJICogQGluZGV4OiBsYXN0IHJldHVybmVkIGlu
ZGV4IGlmIEBhcnJheSBpcyByZWFsbHkgYSBkbWFfZmVuY2VfYXJyYXkNCisJICovDQorCXVuc2ln
bmVkIGludCBpbmRleDsNCit9Ow0KKw0KKy8qKg0KKyAqIGRtYV9mZW5jZV91bndyYXBfYXJyYXkg
LSBoZWxwZXIgdG8gdW53cmFwIGRtYV9mZW5jZV9hcnJheXMNCisgKiBAY3Vyc29yOiBjdXJzb3Ig
dG8gaW5pdGlhbGl6ZQ0KKyAqDQorICogSGVscGVyIGZ1bmN0aW9uIHRvIHVud3JhcCBkbWFfZmVu
Y2VfYXJyYXkgY29udGFpbmVycywgZG9uJ3QgdG91Y2ggZGlyZWN0bHkuDQorICogVXNlIGRtYV9m
ZW5jZV91bndyYXBfZmlyc3QvbmV4dCBpbnN0ZWFkLg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUgc3Ry
dWN0IGRtYV9mZW5jZSAqDQorZG1hX2ZlbmNlX3Vud3JhcF9hcnJheShzdHJ1Y3QgZG1hX2ZlbmNl
X3Vud3JhcCAqIGN1cnNvcikNCit7DQorCWN1cnNvci0+YXJyYXkgPSBkbWFfZmVuY2VfY2hhaW5f
Y29udGFpbmVkKGN1cnNvci0+Y2hhaW4pOw0KKwljdXJzb3ItPmluZGV4ID0gMDsNCisJcmV0dXJu
IGRtYV9mZW5jZV9hcnJheV9maXJzdChjdXJzb3ItPmFycmF5KTsNCit9DQorDQorLyoqDQorICog
ZG1hX2ZlbmNlX3Vud3JhcF9maXJzdCAtIHJldHVybiB0aGUgZmlyc3QgZmVuY2UgZnJvbSBmZW5j
ZSBjb250YWluZXJzDQorICogQGhlYWQ6IHRoZSBlbnRyeXBvaW50IGludG8gdGhlIGNvbnRhaW5l
cnMNCisgKiBAY3Vyc29yOiBjdXJyZW50IHBvc2l0aW9uIGluc2lkZSB0aGUgY29udGFpbmVycw0K
KyAqDQorICogVW53cmFwcyBwb3RlbnRpYWwgZG1hX2ZlbmNlX2NoYWluL2RtYV9mZW5jZV9hcnJh
eSBjb250YWluZXJzIGFuZCByZXR1cm4gdGhlDQorICogZmlyc3QgZmVuY2UuDQorICovDQorc3Rh
dGljIGlubGluZSBzdHJ1Y3QgZG1hX2ZlbmNlICoNCitkbWFfZmVuY2VfdW53cmFwX2ZpcnN0KHN0
cnVjdCBkbWFfZmVuY2UgKmhlYWQsIHN0cnVjdCBkbWFfZmVuY2VfdW53cmFwICpjdXJzb3IpDQor
ew0KKwljdXJzb3ItPmNoYWluID0gZG1hX2ZlbmNlX2dldChoZWFkKTsNCisJcmV0dXJuIGRtYV9m
ZW5jZV91bndyYXBfYXJyYXkoY3Vyc29yKTsNCit9DQorDQorLyoqDQorICogZG1hX2ZlbmNlX3Vu
d3JhcF9uZXh0IC0gcmV0dXJuIHRoZSBuZXh0IGZlbmNlIGZyb20gYSBmZW5jZSBjb250YWluZXJz
DQorICogQGN1cnNvcjogY3VycmVudCBwb3NpdGlvbiBpbnNpZGUgdGhlIGNvbnRhaW5lcnMNCisg
Kg0KKyAqIENvbnRpbnVlIHVud3JhcHBpbmcgdGhlIGRtYV9mZW5jZV9jaGFpbi9kbWFfZmVuY2Vf
YXJyYXkgY29udGFpbmVycyBhbmQgcmV0dXJuDQorICogdGhlIG5leHQgZmVuY2UgZnJvbSB0aGVt
Lg0KKyAqLw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGRtYV9mZW5jZSAqDQorZG1hX2ZlbmNlX3Vu
d3JhcF9uZXh0KHN0cnVjdCBkbWFfZmVuY2VfdW53cmFwICpjdXJzb3IpDQorew0KKwlzdHJ1Y3Qg
ZG1hX2ZlbmNlICp0bXA7DQorDQorCSsrY3Vyc29yLT5pbmRleDsNCisJdG1wID0gZG1hX2ZlbmNl
X2FycmF5X25leHQoY3Vyc29yLT5hcnJheSwgY3Vyc29yLT5pbmRleCk7DQorCWlmICh0bXApDQor
CQlyZXR1cm4gdG1wOw0KKw0KKwljdXJzb3ItPmNoYWluID0gZG1hX2ZlbmNlX2NoYWluX3dhbGso
Y3Vyc29yLT5jaGFpbik7DQorCXJldHVybiBkbWFfZmVuY2VfdW53cmFwX2FycmF5KGN1cnNvcik7
DQorfQ0KKw0KKy8qKg0KKyAqIGRtYV9mZW5jZV91bndyYXBfZm9yX2VhY2ggLSBpdGVyYXRlIG92
ZXIgYWxsIGZlbmNlcyBpbiBjb250YWluZXJzDQorICogQGZlbmNlOiBjdXJyZW50IGZlbmNlDQor
ICogQGN1cnNvcjogY3VycmVudCBwb3NpdGlvbiBpbnNpZGUgdGhlIGNvbnRhaW5lcnMNCisgKiBA
aGVhZDogc3RhcnRpbmcgcG9pbnQgZm9yIHRoZSBpdGVyYXRvcg0KKyAqDQorICogVW53cmFwIGRt
YV9mZW5jZV9jaGFpbiBhbmQgZG1hX2ZlbmNlX2FycmF5IGNvbnRhaW5lcnMgYW5kIGRlZXAgZGl2
ZSBpbnRvIGFsbA0KKyAqIHBvdGVudGlhbCBmZW5jZXMgaW4gdGhlbS4gSWYgQGhlYWQgaXMganVz
dCBhIG5vcm1hbCBmZW5jZSBvbmx5IHRoYXQgb25lIGlzDQorICogcmV0dXJuZWQuDQorICovDQor
I2RlZmluZSBkbWFfZmVuY2VfdW53cmFwX2Zvcl9lYWNoKGZlbmNlLCBjdXJzb3IsIGhlYWQpCQkJ
XA0KKwlmb3IgKGZlbmNlID0gZG1hX2ZlbmNlX3Vud3JhcF9maXJzdChoZWFkLCBjdXJzb3IpOyBm
ZW5jZTsJXA0KKwkgICAgIGZlbmNlID0gZG1hX2ZlbmNlX3Vud3JhcF9uZXh0KGN1cnNvcikpDQor
DQorI2VuZGlmDQotLSANCjIuMjUuMQ0KDQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdCAtLSBsaW5hcm8tbW0t
c2lnQGxpc3RzLmxpbmFyby5vcmcKVG8gdW5zdWJzY3JpYmUgc2VuZCBhbiBlbWFpbCB0byBsaW5h
cm8tbW0tc2lnLWxlYXZlQGxpc3RzLmxpbmFyby5vcmcK
