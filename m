Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id DEF4C9E530F
	for <lists+linaro-mm-sig@lfdr.de>; Thu,  5 Dec 2024 11:55:37 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 8235A43C19
	for <lists+linaro-mm-sig@lfdr.de>; Thu,  5 Dec 2024 10:55:35 +0000 (UTC)
Received: from mail-oa1-f52.google.com (mail-oa1-f52.google.com [209.85.160.52])
	by lists.linaro.org (Postfix) with ESMTPS id F298043C19
	for <linaro-mm-sig@lists.linaro.org>; Thu,  5 Dec 2024 10:55:27 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linaro.org header.s=google header.b=wy5bf6tW;
	spf=pass (lists.linaro.org: domain of jens.wiklander@linaro.org designates 209.85.160.52 as permitted sender) smtp.mailfrom=jens.wiklander@linaro.org;
	dmarc=pass (policy=none) header.from=linaro.org
Received: by mail-oa1-f52.google.com with SMTP id 586e51a60fabf-29e3721ded9so518471fac.0
        for <linaro-mm-sig@lists.linaro.org>; Thu, 05 Dec 2024 02:55:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google; t=1733396127; x=1734000927; darn=lists.linaro.org;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:from:to:cc:subject:date
         :message-id:reply-to;
        bh=Mcud7I5JiovuE8Jaohme85mCqGYx3lG0/HsoBiy64I4=;
        b=wy5bf6tWiF8huZRiAaA6oYmsBcM4u/nkMRSyG83l4LccbYwwz2PBCwmunTxvTGnDFJ
         5XMSBlS29cZRWoE81GikcfnaTBq2sh+XlCJz2FJ2MTmynoczLaYBrHOnbSPKa/Tg+Rtf
         ne0yBIT0SIJ0gzTgvxgrLLDWBJIFq6Rx/Uu2zlz/Rm7dTGzYu7HlqHFDswkK3BwwUIJL
         18k56us5T5855eRTA+wng40CgEcRQYVECbNfdWIwXdoXPZMaEmY/llvRDqw8S04pGTuo
         fO2E7fkKbT+kSYJREBb0LI0ki//CSiUax3zyRJKMVqFkinxo20i//BO8FINqXFv+r1NC
         c+Bw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1733396127; x=1734000927;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=Mcud7I5JiovuE8Jaohme85mCqGYx3lG0/HsoBiy64I4=;
        b=CfnQEOQytJDEQShMd72nMmd8Wwie4QMUG1eZZGN37gNqv2TsRpMudSDEpsVeJ6bEo+
         OMhaUGOcHYqF8LdQq0P5Zw72LFeeCCMe9BOf086OQCoLjVPNMWoNVapDfv1Dzpf75elh
         YUXVqYJsL0mCmSr0TGZCjyMg+TFu5Z2kstrzJRPEfPs3K868VxGXyCnyM3tAuFXlUUXo
         cZKkXBEMHyMc4+iRjYPUy40fs1TFs4tO2S1WlE0cUGQRR9M99rF8zoHIEhb85NDtZHwO
         jp+N89oW2vU8ZedAjAiRFoQGtdZeYRs1XapsF2bLhLReXZrcsWb5qBVjDq2BPo85LX1g
         qegw==
X-Forwarded-Encrypted: i=1; AJvYcCWRoqIvJdeAAXzdH8Cyi6vXmDZKVQr1cFbBNGb+iJh1GMJXlxC+f/eVkH4C+r7bVLdEEyNkz1ZvUMOuk2yc@lists.linaro.org
X-Gm-Message-State: AOJu0YxXYaajBe8WVSX2BDxtE7epIo92Li//mj+7DQjRq5tGi0YsnD/f
	pXPBU4+0X0C6LbE79IvJu3TxFpMwGHST/9CemABqQ3bAougx1/Vkzlh1yWnln8mtZRdF1NyH8SU
	h9tZx26AfbOgPdvVijifuAtNjUew4ZYPqZEKK+TGO
X-Gm-Gg: ASbGnctyHWF+pbIVYa8Kog7HyQF933t73t2ewnWpZ0mdW9Cs0Qy66K5XG2KlumrRkqZ
	p0PWxtVVqQkUFzFjaBBxjoSQnMDIiFY0=
X-Google-Smtp-Source: AGHT+IHlwPY5xDLgAp8+7rewqyZjwLcOsvOVnN31rI+fQNuV2Cjqu6sNj+5VwMTxAnipNmlIqTvLbcqCcQ2ahUgu/cw=
X-Received: by 2002:a05:6871:729c:b0:29e:3a95:a25 with SMTP id
 586e51a60fabf-29e886a884fmr9661813fac.19.1733396127233; Thu, 05 Dec 2024
 02:55:27 -0800 (PST)
MIME-Version: 1.0
References: <20241128150927.1377981-1-jens.wiklander@linaro.org>
 <20241128150927.1377981-3-jens.wiklander@linaro.org> <CAFA6WYPEqCWyvD=pCj6DEkZWN9SCfXMnq4tKbSx1-e8UmgXb=Q@mail.gmail.com>
 <CAHUa44H0go3fSMt_jreWz4EQgYvo8GOZ5woc-x5Cyi680oWZWw@mail.gmail.com> <CAFA6WYNJQEjs29AniqC7mdmo7Fe+fCmW1kFcJ1Z2HSjQQ36LBw@mail.gmail.com>
In-Reply-To: <CAFA6WYNJQEjs29AniqC7mdmo7Fe+fCmW1kFcJ1Z2HSjQQ36LBw@mail.gmail.com>
From: Jens Wiklander <jens.wiklander@linaro.org>
Date: Thu, 5 Dec 2024 11:55:14 +0100
Message-ID: <CAHUa44G2=6tCvnJN2xkkg+UHJ58-0sK+BJSJyCU27aXWqPJy9g@mail.gmail.com>
To: Sumit Garg <sumit.garg@linaro.org>
X-Rspamd-Queue-Id: F298043C19
X-Spamd-Bar: ---
X-Spamd-Result: default: False [-3.60 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	RBL_SENDERSCORE_REPUT_9(-1.00)[209.85.160.52:from];
	DMARC_POLICY_ALLOW(-0.50)[linaro.org,none];
	R_DKIM_ALLOW(-0.20)[linaro.org:s=google];
	R_SPF_ALLOW(-0.20)[+ip4:209.85.128.0/17];
	RWL_MAILSPIKE_GOOD(-0.10)[209.85.160.52:from];
	MIME_GOOD(-0.10)[text/plain];
	TAGGED_RCPT(0.00)[];
	ASN(0.00)[asn:15169, ipnet:209.85.128.0/17, country:US];
	MIME_TRACE(0.00)[0:+];
	RCVD_COUNT_ONE(0.00)[1];
	TO_DN_SOME(0.00)[];
	RCPT_COUNT_TWELVE(0.00)[19];
	ARC_NA(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	URIBL_BLOCKED(0.00)[linaro.org:email,linaro.org:dkim,mail-oa1-f52.google.com:rdns,mail-oa1-f52.google.com:helo];
	FROM_HAS_DN(0.00)[];
	FREEMAIL_CC(0.00)[vger.kernel.org,lists.freedesktop.org,lists.linaro.org,lists.trustedfirmware.org,lists.infradead.org,nxp.com,gmail.com,mediatek.com,linaro.org,collabora.com,arm.com,google.com,amd.com,qti.qualcomm.com];
	MISSING_XM_UA(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	PREVIOUSLY_DELIVERED(0.00)[linaro-mm-sig@lists.linaro.org];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	DKIM_TRACE(0.00)[linaro.org:+]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
Message-ID-Hash: JPC6U4H6UMK4X3GQQVAYJLSU3JUD33AF
X-Message-ID-Hash: JPC6U4H6UMK4X3GQQVAYJLSU3JUD33AF
X-MailFrom: jens.wiklander@linaro.org
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: linux-kernel@vger.kernel.org, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, op-tee@lists.trustedfirmware.org, linux-arm-kernel@lists.infradead.org, Olivier Masse <olivier.masse@nxp.com>, Thierry Reding <thierry.reding@gmail.com>, Yong Wu <yong.wu@mediatek.com>, Sumit Semwal <sumit.semwal@linaro.org>, Benjamin Gaignard <benjamin.gaignard@collabora.com>, Brian Starkey <Brian.Starkey@arm.com>, John Stultz <jstultz@google.com>, "T . J . Mercier" <tjmercier@google.com>, =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>, Matthias Brugger <matthias.bgg@gmail.com>, AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>, azarrabi@qti.qualcomm.com
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] Re: [PATCH v3 2/4] optee: account for direction while converting parameters
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/JPC6U4H6UMK4X3GQQVAYJLSU3JUD33AF/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

T24gVHVlLCBEZWMgMywgMjAyNCBhdCAxMTozNeKAr0FNIFN1bWl0IEdhcmcgPHN1bWl0LmdhcmdA
bGluYXJvLm9yZz4gd3JvdGU6DQo+DQo+IE9uIFR1ZSwgMyBEZWMgMjAyNCBhdCAxNTo1OCwgSmVu
cyBXaWtsYW5kZXIgPGplbnMud2lrbGFuZGVyQGxpbmFyby5vcmc+IHdyb3RlOg0KPiA+DQo+ID4g
SGkgU3VtaXQsDQo+ID4NCj4gPiBPbiBUdWUsIERlYyAzLCAyMDI0IGF0IDk6MjfigK9BTSBTdW1p
dCBHYXJnIDxzdW1pdC5nYXJnQGxpbmFyby5vcmc+IHdyb3RlOg0KPiA+ID4NCj4gPiA+IEhpIEpl
bnMsDQo+ID4gPg0KPiA+ID4gT24gVGh1LCAyOCBOb3YgMjAyNCBhdCAyMDozOSwgSmVucyBXaWts
YW5kZXIgPGplbnMud2lrbGFuZGVyQGxpbmFyby5vcmc+IHdyb3RlOg0KPiA+ID4gPg0KPiA+ID4g
PiBUaGUgT1AtVEVFIGJhY2tlbmQgZHJpdmVyIGhhcyB0d28gaW50ZXJuYWwgZnVuY3Rpb24gcG9p
bnRlcnMgdG8gY29udmVydA0KPiA+ID4gPiBiZXR3ZWVuIHRoZSBzdWJzeXN0ZW0gdHlwZSBzdHJ1
Y3QgdGVlX3BhcmFtIGFuZCB0aGUgT1AtVEVFIHR5cGUgc3RydWN0DQo+ID4gPiA+IG9wdGVlX21z
Z19wYXJhbS4NCj4gPiA+ID4NCj4gPiA+ID4gVGhlIGNvbnZlcnNpb24gaXMgZG9uZSBmcm9tIG9u
ZSBvZiB0aGUgdHlwZXMgdG8gdGhlIG90aGVyLCB3aGljaCBpcyB0aGVuDQo+ID4gPiA+IGludm9s
dmVkIGluIHNvbWUgb3BlcmF0aW9uIGFuZCBmaW5hbGx5IGNvbnZlcnRlZCBiYWNrIHRvIHRoZSBv
cmlnaW5hbA0KPiA+ID4gPiB0eXBlLiBXaGVuIGNvbnZlcnRpbmcgdG8gcHJlcGFyZSB0aGUgcGFy
YW1ldGVycyBmb3IgdGhlIG9wZXJhdGlvbiwgYWxsDQo+ID4gPiA+IGZpZWxkcyBtdXN0IGJlIHRh
a2VuIGludG8gYWNjb3VudCwgYnV0IHRoZW4gY29udmVydGluZyBiYWNrLCBpdCdzIGVub3VnaA0K
PiA+ID4gPiB0byB1cGRhdGUgb25seSBvdXQtdmFsdWVzIGFuZCBvdXQtc2l6ZXMuIFNvLCBhbiB1
cGRhdGVfb3V0IHBhcmFtZXRlciBpcw0KPiA+ID4gPiBhZGRlZCB0byB0aGUgY29udmVyc2lvbiBm
dW5jdGlvbnMgdG8gdGVsbCBpZiBhbGwgb3Igb25seSBzb21lIGZpZWxkcw0KPiA+ID4gPiBtdXN0
IGJlIGNvcGllZC4NCj4gPiA+DQo+ID4gPiBJcyB0aGlzIHBhdGNoIGp1c3QgYSByZWZhY3Rvcmlu
ZyBvZiBURUUgcGFyYW1zIGhhbmRsaW5nPyBPciBhcmUgd2UNCj4gPiA+IGZpeGluZyBhIHJlYWwg
QUJJIGlzc3VlIGhlcmU/IEFsc28sIGlzIHRoaXMgcmVxdWlyZWQgZm9yIHJlc3RyaWN0ZWQNCj4g
PiA+IHNoYXJlZCBtZW1vcnkgc3VwcG9ydCB0byB3b3JrPyBKdXN0IGFza2luZyBpZiB3ZSB3YW50
IHRvIGNvbnNpZGVyIGl0DQo+ID4gPiBhcyBhIGZpeCBmb3IgYmFja3BvcnRpbmcgb3IgaWYgd2Ug
Y2FuIGhhbmRsZSB0aGlzIHJlZmFjdG9yaW5nIHBhdGNoDQo+ID4gPiBpbmRlcGVuZGVudGx5IG9m
IHRoaXMgc2VyaWVzPw0KPiA+DQo+ID4gVGhpcyBpcyBuZWVkZWQgaW4gdGhpcyBzZXJpZXMuIFdp
dGhvdXQgdGhpcyBwYXRjaCwgaXQgbWlnaHQgZ2V0DQo+ID4gY29uZnVzaW5nIHdoZW4gY29udmVy
dGluZyBiYWNrIGluIGZyb21fbXNnX3BhcmFtKCkgY2FsbGJhY2sgc2luY2UgYW4NCj4gPiBhbGxv
Y2F0ZWQgcmVzdHJpY3RlZCBTSE0gY2FuIGJlIHVzaW5nIHRoZSBzZWNfd29ybGRfaWQgb2YgdGhl
IHBvb2wgYW5kDQo+ID4gdGhhdCBkb2Vzbid0IHRyYW5zbGF0ZSBiYWNrIHdlbGwuIHBhcmFtc190
b191c2VyKCkgaW4NCj4gPiBkcml2ZXJzL3RlZS90ZWVfY29yZS5jIGFscmVhZHkgdGFrZXMgdGhl
IGRpcmVjdGlvbiBpbnRvIGFjY291bnQgc28gaXQNCj4gPiB3b3VsZG4ndCBzcHJlYWQgdG8gdXNl
ci1zcGFjZS4NCj4NCj4gVGhhbmtzIEplbnMgZm9yIHRoZSBjbGFyaWZpY2F0aW9uLCBpZiB5b3Ug
Y2FuIHVwZGF0ZSB0aGUgY29tbWl0IHRleHQNCj4gYWNjb3JkaW5nbHkgd2lsbCBoZWxwIGNsYXJp
ZnkgdGhlIG1vdGl2YXRpb24gZm9yIHRoZSBjaGFuZ2UuDQoNClN1cmUsIEknbGwgdXBkYXRlLg0K
DQpUaGFua3MsDQpKZW5zDQoNCj4NCj4gLVN1bWl0DQo+DQo+ID4NCj4gPiBDaGVlcnMsDQo+ID4g
SmVucw0KPiA+DQo+ID4gPg0KPiA+ID4gLVN1bWl0DQo+ID4gPg0KPiA+ID4gPg0KPiA+ID4gPiBT
aWduZWQtb2ZmLWJ5OiBKZW5zIFdpa2xhbmRlciA8amVucy53aWtsYW5kZXJAbGluYXJvLm9yZz4N
Cj4gPiA+ID4gLS0tDQo+ID4gPiA+ICBkcml2ZXJzL3RlZS9vcHRlZS9jYWxsLmMgICAgICAgICAg
fCAxMCArKy0tDQo+ID4gPiA+ICBkcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMgICAgICAgfCA0
MyArKysrKysrKysrKysrLS0tLQ0KPiA+ID4gPiAgZHJpdmVycy90ZWUvb3B0ZWUvb3B0ZWVfcHJp
dmF0ZS5oIHwgNDIgKysrKysrKysrKystLS0tLS0NCj4gPiA+ID4gIGRyaXZlcnMvdGVlL29wdGVl
L3JwYy5jICAgICAgICAgICB8IDMxICsrKysrKysrKy0tLS0NCj4gPiA+ID4gIGRyaXZlcnMvdGVl
L29wdGVlL3NtY19hYmkuYyAgICAgICB8IDc2ICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0t
LS0NCj4gPiA+ID4gIDUgZmlsZXMgY2hhbmdlZCwgMTQ0IGluc2VydGlvbnMoKyksIDU4IGRlbGV0
aW9ucygtKQ0KPiA+ID4gPg0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvb3B0ZWUv
Y2FsbC5jIGIvZHJpdmVycy90ZWUvb3B0ZWUvY2FsbC5jDQo+ID4gPiA+IGluZGV4IDE2ZWI5NTNl
MTRiYi4uZjE1MzNiODk0NzI2IDEwMDY0NA0KPiA+ID4gPiAtLS0gYS9kcml2ZXJzL3RlZS9vcHRl
ZS9jYWxsLmMNCj4gPiA+ID4gKysrIGIvZHJpdmVycy90ZWUvb3B0ZWUvY2FsbC5jDQo+ID4gPiA+
IEBAIC00MDAsNyArNDAwLDggQEAgaW50IG9wdGVlX29wZW5fc2Vzc2lvbihzdHJ1Y3QgdGVlX2Nv
bnRleHQgKmN0eCwNCj4gPiA+ID4gICAgICAgICBleHBvcnRfdXVpZChtc2dfYXJnLT5wYXJhbXNb
MV0udS5vY3RldHMsICZjbGllbnRfdXVpZCk7DQo+ID4gPiA+DQo+ID4gPiA+ICAgICAgICAgcmMg
PSBvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0ZWUsIG1zZ19hcmctPnBhcmFtcyArIDIsDQo+
ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFy
YW1zLCBwYXJhbSk7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbSwNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBmYWxzZSAvKiF1cGRhdGVfb3V0Ki8pOw0KPiA+ID4gPiAgICAgICAg
IGlmIChyYykNCj4gPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ID4gPg0KPiA+
ID4gPiBAQCAtNDI3LDcgKzQyOCw4IEBAIGludCBvcHRlZV9vcGVuX3Nlc3Npb24oc3RydWN0IHRl
ZV9jb250ZXh0ICpjdHgsDQo+ID4gPiA+ICAgICAgICAgfQ0KPiA+ID4gPg0KPiA+ID4gPiAgICAg
ICAgIGlmIChvcHRlZS0+b3BzLT5mcm9tX21zZ19wYXJhbShvcHRlZSwgcGFyYW0sIGFyZy0+bnVt
X3BhcmFtcywNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
bXNnX2FyZy0+cGFyYW1zICsgMikpIHsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFyYW1zICsgMiwNCj4gPiA+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKnVwZGF0ZV9vdXQqLykpIHsNCj4gPiA+
ID4gICAgICAgICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9DT01NVU5JQ0FUSU9OOw0K
PiA+ID4gPiAgICAgICAgICAgICAgICAgYXJnLT5yZXRfb3JpZ2luID0gVEVFQ19PUklHSU5fQ09N
TVM7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICAvKiBDbG9zZSBzZXNzaW9uIGFnYWluIHRvIGF2
b2lkIGxlYWthZ2UgKi8NCj4gPiA+ID4gQEAgLTU0MSw3ICs1NDMsNyBAQCBpbnQgb3B0ZWVfaW52
b2tlX2Z1bmMoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsIHN0cnVjdCB0ZWVfaW9jdGxfaW52b2tl
X2FyZyAqYXJnLA0KPiA+ID4gPiAgICAgICAgIG1zZ19hcmctPmNhbmNlbF9pZCA9IGFyZy0+Y2Fu
Y2VsX2lkOw0KPiA+ID4gPg0KPiA+ID4gPiAgICAgICAgIHJjID0gb3B0ZWUtPm9wcy0+dG9fbXNn
X3BhcmFtKG9wdGVlLCBtc2dfYXJnLT5wYXJhbXMsIGFyZy0+bnVtX3BhcmFtcywNCj4gPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbSk7DQo+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0sIGZhbHNlIC8qIXVwZGF0
ZV9vdXQqLyk7DQo+ID4gPiA+ICAgICAgICAgaWYgKHJjKQ0KPiA+ID4gPiAgICAgICAgICAgICAg
ICAgZ290byBvdXQ7DQo+ID4gPiA+DQo+ID4gPiA+IEBAIC01NTEsNyArNTUzLDcgQEAgaW50IG9w
dGVlX2ludm9rZV9mdW5jKHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4LCBzdHJ1Y3QgdGVlX2lvY3Rs
X2ludm9rZV9hcmcgKmFyZywNCj4gPiA+ID4gICAgICAgICB9DQo+ID4gPiA+DQo+ID4gPiA+ICAg
ICAgICAgaWYgKG9wdGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbSwgYXJnLT5u
dW1fcGFyYW1zLA0KPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBtc2dfYXJnLT5wYXJhbXMpKSB7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIG1zZ19hcmctPnBhcmFtcywgdHJ1ZSAvKnVwZGF0ZV9vdXQqLykpIHsNCj4g
PiA+ID4gICAgICAgICAgICAgICAgIG1zZ19hcmctPnJldCA9IFRFRUNfRVJST1JfQ09NTVVOSUNB
VElPTjsNCj4gPiA+ID4gICAgICAgICAgICAgICAgIG1zZ19hcmctPnJldF9vcmlnaW4gPSBURUVD
X09SSUdJTl9DT01NUzsNCj4gPiA+ID4gICAgICAgICB9DQo+ID4gPiA+IGRpZmYgLS1naXQgYS9k
cml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMgYi9kcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMN
Cj4gPiA+ID4gaW5kZXggZjNhZjU2NjZiYjExLi4wMmU2MTc1YWM1ZjAgMTAwNjQ0DQo+ID4gPiA+
IC0tLSBhL2RyaXZlcnMvdGVlL29wdGVlL2ZmYV9hYmkuYw0KPiA+ID4gPiArKysgYi9kcml2ZXJz
L3RlZS9vcHRlZS9mZmFfYWJpLmMNCj4gPiA+ID4gQEAgLTEyMiwxNSArMTIyLDIxIEBAIHN0YXRp
YyBpbnQgb3B0ZWVfc2htX3JlbV9mZmFfaGFuZGxlKHN0cnVjdCBvcHRlZSAqb3B0ZWUsIHU2NCBn
bG9iYWxfaWQpDQo+ID4gPiA+ICAgKi8NCj4gPiA+ID4NCj4gPiA+ID4gIHN0YXRpYyB2b2lkIGZy
b21fbXNnX3BhcmFtX2ZmYV9tZW0oc3RydWN0IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJh
bSAqcCwNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgYXR0
ciwgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXApDQo+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgdTMyIGF0dHIsIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2df
cGFyYW0gKm1wLA0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJv
b2wgdXBkYXRlX291dCkNCj4gPiA+ID4gIHsNCj4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdGVlX3No
bSAqc2htID0gTlVMTDsNCj4gPiA+ID4gICAgICAgICB1NjQgb2Zmc19oaWdoID0gMDsNCj4gPiA+
ID4gICAgICAgICB1NjQgb2Zmc19sb3cgPSAwOw0KPiA+ID4gPg0KPiA+ID4gPiArICAgICAgIGlm
ICh1cGRhdGVfb3V0KSB7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICBpZiAoYXR0ciA9PSBPUFRF
RV9NU0dfQVRUUl9UWVBFX0ZNRU1fSU5QVVQpDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgIHJldHVybjsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ID4gPiAr
ICAgICAgIH0NCj4gPiA+ID4gKw0KPiA+ID4gPiAgICAgICAgIHAtPmF0dHIgPSBURUVfSU9DVExf
UEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVCArDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAg
IGF0dHIgLSBPUFRFRV9NU0dfQVRUUl9UWVBFX0ZNRU1fSU5QVVQ7DQo+ID4gPiA+IC0gICAgICAg
cC0+dS5tZW1yZWYuc2l6ZSA9IG1wLT51LmZtZW0uc2l6ZTsNCj4gPiA+ID4NCj4gPiA+ID4gICAg
ICAgICBpZiAobXAtPnUuZm1lbS5nbG9iYWxfaWQgIT0gT1BURUVfTVNHX0ZNRU1fSU5WQUxJRF9H
TE9CQUxfSUQpDQo+ID4gPiA+ICAgICAgICAgICAgICAgICBzaG0gPSBvcHRlZV9zaG1fZnJvbV9m
ZmFfaGFuZGxlKG9wdGVlLCBtcC0+dS5mbWVtLmdsb2JhbF9pZCk7DQo+ID4gPiA+IEBAIC0xNDEs
NiArMTQ3LDggQEAgc3RhdGljIHZvaWQgZnJvbV9tc2dfcGFyYW1fZmZhX21lbShzdHJ1Y3Qgb3B0
ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwLA0KPiA+ID4gPiAgICAgICAgICAgICAgICAg
b2Zmc19oaWdoID0gbXAtPnUuZm1lbS5vZmZzX2hpZ2g7DQo+ID4gPiA+ICAgICAgICAgfQ0KPiA+
ID4gPiAgICAgICAgIHAtPnUubWVtcmVmLnNobV9vZmZzID0gb2Zmc19sb3cgfCBvZmZzX2hpZ2gg
PDwgMzI7DQo+ID4gPiA+ICtvdXQ6DQo+ID4gPiA+ICsgICAgICAgcC0+dS5tZW1yZWYuc2l6ZSA9
IG1wLT51LmZtZW0uc2l6ZTsNCj4gPiA+ID4gIH0NCj4gPiA+ID4NCj4gPiA+ID4gIC8qKg0KPiA+
ID4gPiBAQCAtMTUwLDEyICsxNTgsMTQgQEAgc3RhdGljIHZvaWQgZnJvbV9tc2dfcGFyYW1fZmZh
X21lbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwLA0KPiA+ID4gPiAg
ICogQHBhcmFtczogICAgc3Vic3lzdGVtIGludGVybmFsIHBhcmFtZXRlciByZXByZXNlbnRhdGlv
bg0KPiA+ID4gPiAgICogQG51bV9wYXJhbXM6ICAgICAgICBudW1iZXIgb2YgZWxlbWVudHMgaW4g
dGhlIHBhcmFtZXRlciBhcnJheXMNCj4gPiA+ID4gICAqIEBtc2dfcGFyYW1zOiAgICAgICAgT1BU
RUVfTVNHIHBhcmFtZXRlcnMNCj4gPiA+ID4gKyAqIEB1cGRhdGVfb3V0OiB1cGRhdGUgcGFyYW1l
dGVyIGZvciBvdXRwdXQgb25seQ0KPiA+ID4gPiAgICoNCj4gPiA+ID4gICAqIFJldHVybnMgMCBv
biBzdWNjZXNzIG9yIDwwIG9uIGZhaWx1cmUNCj4gPiA+ID4gICAqLw0KPiA+ID4gPiAgc3RhdGlj
IGludCBvcHRlZV9mZmFfZnJvbV9tc2dfcGFyYW0oc3RydWN0IG9wdGVlICpvcHRlZSwNCj4gPiA+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHRlZV9wYXJhbSAq
cGFyYW1zLCBzaXplX3QgbnVtX3BhcmFtcywNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXNnX3BhcmFtcykN
Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0
IG9wdGVlX21zZ19wYXJhbSAqbXNnX3BhcmFtcywNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ID4gPiAgew0KPiA+ID4gPiAg
ICAgICAgIHNpemVfdCBuOw0KPiA+ID4gPg0KPiA+ID4gPiBAQCAtMTY2LDE4ICsxNzYsMjAgQEAg
c3RhdGljIGludCBvcHRlZV9mZmFfZnJvbV9tc2dfcGFyYW0oc3RydWN0IG9wdGVlICpvcHRlZSwN
Cj4gPiA+ID4NCj4gPiA+ID4gICAgICAgICAgICAgICAgIHN3aXRjaCAoYXR0cikgew0KPiA+ID4g
PiAgICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX05PTkU6DQo+ID4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVfb3V0KQ0KPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAg
ICAgICAgICBwLT5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOw0KPiA+ID4g
PiAgICAgICAgICAgICAgICAgICAgICAgICBtZW1zZXQoJnAtPnUsIDAsIHNpemVvZihwLT51KSk7
DQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAg
ICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX0lOUFVUOg0KPiA+ID4gPiAg
ICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX09VVFBVVDoNCj4g
PiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9JTk9V
VDoNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgb3B0ZWVfZnJvbV9tc2dfcGFyYW1f
dmFsdWUocCwgYXR0ciwgbXApOw0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBvcHRl
ZV9mcm9tX21zZ19wYXJhbV92YWx1ZShwLCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAg
Y2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX0ZNRU1fSU5QVVQ6DQo+ID4gPiA+ICAgICAgICAgICAg
ICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9PVVRQVVQ6DQo+ID4gPiA+ICAgICAg
ICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9JTk9VVDoNCj4gPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgZnJvbV9tc2dfcGFyYW1fZmZhX21lbShvcHRlZSwgcCwg
YXR0ciwgbXApOw0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBmcm9tX21zZ19wYXJh
bV9mZmFfbWVtKG9wdGVlLCBwLCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgZGVmYXVs
dDoNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4g
PiA+IEBAIC0xODgsMTAgKzIwMCwxNiBAQCBzdGF0aWMgaW50IG9wdGVlX2ZmYV9mcm9tX21zZ19w
YXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4gPiAgfQ0KPiA+ID4gPg0KPiA+ID4gPiAg
c3RhdGljIGludCB0b19tc2dfcGFyYW1fZmZhX21lbShzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICpt
cCwNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
dGVlX3BhcmFtICpwKQ0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnAsIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ID4gIHsNCj4g
PiA+ID4gICAgICAgICBzdHJ1Y3QgdGVlX3NobSAqc2htID0gcC0+dS5tZW1yZWYuc2htOw0KPiA+
ID4gPg0KPiA+ID4gPiArICAgICAgIGlmICh1cGRhdGVfb3V0KSB7DQo+ID4gPiA+ICsgICAgICAg
ICAgICAgICBpZiAocC0+YXR0ciA9PSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9J
TlBVVCkNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQo+ID4gPiA+
ICsgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiA+ID4gKyAgICAgICB9DQo+ID4gPiA+ICsN
Cj4gPiA+ID4gICAgICAgICBtcC0+YXR0ciA9IE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9JTlBV
VCArIHAtPmF0dHIgLQ0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgVEVFX0lPQ1RMX1BBUkFN
X0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQ7DQo+ID4gPiA+DQo+ID4gPiA+IEBAIC0yMTEsNiArMjI5
LDcgQEAgc3RhdGljIGludCB0b19tc2dfcGFyYW1fZmZhX21lbShzdHJ1Y3Qgb3B0ZWVfbXNnX3Bh
cmFtICptcCwNCj4gPiA+ID4gICAgICAgICAgICAgICAgIG1lbXNldCgmbXAtPnUsIDAsIHNpemVv
ZihtcC0+dSkpOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgbXAtPnUuZm1lbS5nbG9iYWxfaWQg
PSBPUFRFRV9NU0dfRk1FTV9JTlZBTElEX0dMT0JBTF9JRDsNCj4gPiA+ID4gICAgICAgICB9DQo+
ID4gPiA+ICtvdXQ6DQo+ID4gPiA+ICAgICAgICAgbXAtPnUuZm1lbS5zaXplID0gcC0+dS5tZW1y
ZWYuc2l6ZTsNCj4gPiA+ID4NCj4gPiA+ID4gICAgICAgICByZXR1cm4gMDsNCj4gPiA+ID4gQEAg
LTIyMiwxMyArMjQxLDE1IEBAIHN0YXRpYyBpbnQgdG9fbXNnX3BhcmFtX2ZmYV9tZW0oc3RydWN0
IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gPiA+ICAgKiBAb3B0ZWU6ICAgICBtYWluIHNlcnZp
Y2Ugc3RydWN0DQo+ID4gPiA+ICAgKiBAbXNnX3BhcmFtczogICAgICAgIE9QVEVFX01TRyBwYXJh
bWV0ZXJzDQo+ID4gPiA+ICAgKiBAbnVtX3BhcmFtczogICAgICAgIG51bWJlciBvZiBlbGVtZW50
cyBpbiB0aGUgcGFyYW1ldGVyIGFycmF5cw0KPiA+ID4gPiAtICogQHBhcmFtczogICAgc3Vic3lz
dGVtIGl0bmVybmFsIHBhcmFtZXRlciByZXByZXNlbnRhdGlvbg0KPiA+ID4gPiArICogQHBhcmFt
czogICAgc3Vic3lzdGVtIGludGVybmFsIHBhcmFtZXRlciByZXByZXNlbnRhdGlvbg0KPiA+ID4g
PiArICogQHVwZGF0ZV9vdXQ6IHVwZGF0ZSBwYXJhbWV0ZXIgZm9yIG91dHB1dCBvbmx5DQo+ID4g
PiA+ICAgKiBSZXR1cm5zIDAgb24gc3VjY2VzcyBvciA8MCBvbiBmYWlsdXJlDQo+ID4gPiA+ICAg
Ki8NCj4gPiA+ID4gIHN0YXRpYyBpbnQgb3B0ZWVfZmZhX3RvX21zZ19wYXJhbShzdHJ1Y3Qgb3B0
ZWUgKm9wdGVlLA0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IG9wdGVlX21zZ19wYXJhbSAqbXNnX3BhcmFtcywNCj4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNpemVfdCBudW1fcGFyYW1zLA0KPiA+ID4gPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zKQ0K
PiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHRl
ZV9wYXJhbSAqcGFyYW1zLA0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ID4gPiAgew0KPiA+ID4gPiAgICAgICAgIHNpemVfdCBu
Ow0KPiA+ID4gPg0KPiA+ID4gPiBAQCAtMjM4LDE4ICsyNTksMjAgQEAgc3RhdGljIGludCBvcHRl
ZV9mZmFfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4gPiA+DQo+ID4gPiA+
ICAgICAgICAgICAgICAgICBzd2l0Y2ggKHAtPmF0dHIpIHsNCj4gPiA+ID4gICAgICAgICAgICAg
ICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOg0KPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICBpZiAodXBkYXRlX291dCkNCj4gPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
bXAtPmF0dHIgPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX05PTkU7DQo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgIG1lbXNldCgmbXAtPnUsIDAsIHNpemVvZihtcC0+dSkpOw0KPiA+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiA+ID4gICAgICAgICAgICAg
ICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTlBVVDoNCj4gPiA+ID4g
ICAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9PVVRQ
VVQ6DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZ
UEVfVkFMVUVfSU5PVVQ6DQo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG9wdGVlX3Rv
X21zZ19wYXJhbV92YWx1ZShtcCwgcCk7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
IG9wdGVlX3RvX21zZ19wYXJhbV92YWx1ZShtcCwgcCwgdXBkYXRlX291dCk7DQo+ID4gPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgY2Fz
ZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVDoNCj4gPiA+ID4gICAgICAg
ICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfT1VUUFVUOg0K
PiA+ID4gPiAgICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01F
TVJFRl9JTk9VVDoNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRvX21zZ19w
YXJhbV9mZmFfbWVtKG1wLCBwKSkNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYg
KHRvX21zZ19wYXJhbV9mZmFfbWVtKG1wLCBwLCB1cGRhdGVfb3V0KSkNCj4gPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gPiA+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBkZWZhdWx0
Og0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvb3B0ZWUvb3B0ZWVfcHJpdmF0ZS5o
IGIvZHJpdmVycy90ZWUvb3B0ZWUvb3B0ZWVfcHJpdmF0ZS5oDQo+ID4gPiA+IGluZGV4IGRjMGYz
NTVlZjcyYS4uMjBlZGE1MDhkYmFjIDEwMDY0NA0KPiA+ID4gPiAtLS0gYS9kcml2ZXJzL3RlZS9v
cHRlZS9vcHRlZV9wcml2YXRlLmgNCj4gPiA+ID4gKysrIGIvZHJpdmVycy90ZWUvb3B0ZWUvb3B0
ZWVfcHJpdmF0ZS5oDQo+ID4gPiA+IEBAIC0xODUsMTAgKzE4NSwxMiBAQCBzdHJ1Y3Qgb3B0ZWVf
b3BzIHsNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHN5c3Rl
bV90aHJlYWQpOw0KPiA+ID4gPiAgICAgICAgIGludCAoKnRvX21zZ19wYXJhbSkoc3RydWN0IG9w
dGVlICpvcHRlZSwNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBv
cHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMsDQo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgICAgICBzaXplX3QgbnVtX3BhcmFtcywgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1z
KTsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBudW1fcGFyYW1z
LCBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsDQo+ID4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpOw0KPiA+ID4gPiAgICAgICAgIGludCAoKmZy
b21fbXNnX3BhcmFtKShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJh
bXMsDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBudW1fcGFy
YW1zLA0KPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qg
b3B0ZWVfbXNnX3BhcmFtICptc2dfcGFyYW1zKTsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXNnX3BhcmFtcywNCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KTsNCj4g
PiA+ID4gIH07DQo+ID4gPiA+DQo+ID4gPiA+ICAvKioNCj4gPiA+ID4gQEAgLTMxNiwyMyArMzE4
LDM1IEBAIHZvaWQgb3B0ZWVfcmVsZWFzZShzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCk7DQo+ID4g
PiA+ICB2b2lkIG9wdGVlX3JlbGVhc2Vfc3VwcChzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCk7DQo+
ID4gPiA+DQo+ID4gPiA+ICBzdGF0aWMgaW5saW5lIHZvaWQgb3B0ZWVfZnJvbV9tc2dfcGFyYW1f
dmFsdWUoc3RydWN0IHRlZV9wYXJhbSAqcCwgdTMyIGF0dHIsDQo+ID4gPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNn
X3BhcmFtICptcCkNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wLA0KPiA+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0
KQ0KPiA+ID4gPiAgew0KPiA+ID4gPiAtICAgICAgIHAtPmF0dHIgPSBURUVfSU9DVExfUEFSQU1f
QVRUUl9UWVBFX1ZBTFVFX0lOUFVUICsNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgYXR0ciAt
IE9QVEVFX01TR19BVFRSX1RZUEVfVkFMVUVfSU5QVVQ7DQo+ID4gPiA+IC0gICAgICAgcC0+dS52
YWx1ZS5hID0gbXAtPnUudmFsdWUuYTsNCj4gPiA+ID4gLSAgICAgICBwLT51LnZhbHVlLmIgPSBt
cC0+dS52YWx1ZS5iOw0KPiA+ID4gPiAtICAgICAgIHAtPnUudmFsdWUuYyA9IG1wLT51LnZhbHVl
LmM7DQo+ID4gPiA+ICsgICAgICAgaWYgKCF1cGRhdGVfb3V0KQ0KPiA+ID4gPiArICAgICAgICAg
ICAgICAgcC0+YXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5QVVQgKw0K
PiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIgLSBPUFRFRV9NU0dfQVRUUl9U
WVBFX1ZBTFVFX0lOUFVUOw0KPiA+ID4gPiArDQo+ID4gPiA+ICsgICAgICAgaWYgKGF0dHIgPT0g
T1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9PVVRQVVQgfHwNCj4gPiA+ID4gKyAgICAgICAgICAg
YXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX0lOT1VUIHx8ICF1cGRhdGVfb3V0KSB7
DQo+ID4gPiA+ICsgICAgICAgICAgICAgICBwLT51LnZhbHVlLmEgPSBtcC0+dS52YWx1ZS5hOw0K
PiA+ID4gPiArICAgICAgICAgICAgICAgcC0+dS52YWx1ZS5iID0gbXAtPnUudmFsdWUuYjsNCj4g
PiA+ID4gKyAgICAgICAgICAgICAgIHAtPnUudmFsdWUuYyA9IG1wLT51LnZhbHVlLmM7DQo+ID4g
PiA+ICsgICAgICAgfQ0KPiA+ID4gPiAgfQ0KPiA+ID4gPg0KPiA+ID4gPiAgc3RhdGljIGlubGlu
ZSB2b2lkIG9wdGVlX3RvX21zZ19wYXJhbV92YWx1ZShzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICpt
cCwNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwKQ0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnAsDQo+ID4gPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVf
b3V0KQ0KPiA+ID4gPiAgew0KPiA+ID4gPiAtICAgICAgIG1wLT5hdHRyID0gT1BURUVfTVNHX0FU
VFJfVFlQRV9WQUxVRV9JTlBVVCArIHAtPmF0dHIgLQ0KPiA+ID4gPiAtICAgICAgICAgICAgICAg
ICAgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTlBVVDsNCj4gPiA+ID4gLSAgICAg
ICBtcC0+dS52YWx1ZS5hID0gcC0+dS52YWx1ZS5hOw0KPiA+ID4gPiAtICAgICAgIG1wLT51LnZh
bHVlLmIgPSBwLT51LnZhbHVlLmI7DQo+ID4gPiA+IC0gICAgICAgbXAtPnUudmFsdWUuYyA9IHAt
PnUudmFsdWUuYzsNCj4gPiA+ID4gKyAgICAgICBpZiAoIXVwZGF0ZV9vdXQpDQo+ID4gPiA+ICsg
ICAgICAgICAgICAgICBtcC0+YXR0ciA9IE9QVEVFX01TR19BVFRSX1RZUEVfVkFMVUVfSU5QVVQg
KyBwLT5hdHRyIC0NCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgVEVFX0lPQ1RM
X1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTlBVVDsNCj4gPiA+ID4gKw0KPiA+ID4gPiArICAgICAg
IGlmIChwLT5hdHRyID09IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUIHx8
DQo+ID4gPiA+ICsgICAgICAgICAgIHAtPmF0dHIgPT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQ
RV9WQUxVRV9JTk9VVCB8fCAhdXBkYXRlX291dCkgew0KPiA+ID4gPiArICAgICAgICAgICAgICAg
bXAtPnUudmFsdWUuYSA9IHAtPnUudmFsdWUuYTsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgIG1w
LT51LnZhbHVlLmIgPSBwLT51LnZhbHVlLmI7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICBtcC0+
dS52YWx1ZS5jID0gcC0+dS52YWx1ZS5jOw0KPiA+ID4gPiArICAgICAgIH0NCj4gPiA+ID4gIH0N
Cj4gPiA+ID4NCj4gPiA+ID4gIHZvaWQgb3B0ZWVfY3FfaW5pdChzdHJ1Y3Qgb3B0ZWVfY2FsbF9x
dWV1ZSAqY3EsIGludCB0aHJlYWRfY291bnQpOw0KPiA+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVy
cy90ZWUvb3B0ZWUvcnBjLmMgYi9kcml2ZXJzL3RlZS9vcHRlZS9ycGMuYw0KPiA+ID4gPiBpbmRl
eCBlYmJiZDQyYjBlM2UuLjU4MGU2YjliMDYwNiAxMDA2NDQNCj4gPiA+ID4gLS0tIGEvZHJpdmVy
cy90ZWUvb3B0ZWUvcnBjLmMNCj4gPiA+ID4gKysrIGIvZHJpdmVycy90ZWUvb3B0ZWUvcnBjLmMN
Cj4gPiA+ID4gQEAgLTYzLDcgKzYzLDcgQEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX2Nt
ZF9pMmNfdHJhbnNmZXIoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsDQo+ID4gPiA+ICAgICAgICAg
fQ0KPiA+ID4gPg0KPiA+ID4gPiAgICAgICAgIGlmIChvcHRlZS0+b3BzLT5mcm9tX21zZ19wYXJh
bShvcHRlZSwgcGFyYW1zLCBhcmctPm51bV9wYXJhbXMsDQo+ID4gPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+cGFyYW1zKSkNCj4gPiA+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMsIGZhbHNlIC8qIXVwZGF0
ZV9vdXQqLykpDQo+ID4gPiA+ICAgICAgICAgICAgICAgICBnb3RvIGJhZDsNCj4gPiA+ID4NCj4g
PiA+ID4gICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJnLT5udW1fcGFyYW1zOyBpKyspIHsNCj4g
PiA+ID4gQEAgLTEwNyw3ICsxMDcsOCBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfY21k
X2kyY190cmFuc2ZlcihzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwNCj4gPiA+ID4gICAgICAgICB9
IGVsc2Ugew0KPiA+ID4gPiAgICAgICAgICAgICAgICAgcGFyYW1zWzNdLnUudmFsdWUuYSA9IG1z
Zy5sZW47DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBpZiAob3B0ZWUtPm9wcy0+dG9fbXNnX3Bh
cmFtKG9wdGVlLCBhcmctPnBhcmFtcywNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMpKQ0KPiA+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPm51bV9wYXJh
bXMsIHBhcmFtcywNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgdHJ1ZSAvKnVwZGF0ZV9vdXQqLykpDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiA+ID4gICAg
ICAgICAgICAgICAgIGVsc2UNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5y
ZXQgPSBURUVDX1NVQ0NFU1M7DQo+ID4gPiA+IEBAIC0xODgsNiArMTg5LDcgQEAgc3RhdGljIHZv
aWQgaGFuZGxlX3JwY19mdW5jX2NtZF93YWl0KHN0cnVjdCBvcHRlZV9tc2dfYXJnICphcmcpDQo+
ID4gPiA+ICBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX3N1cHBfY21kKHN0cnVjdCB0ZWVfY29udGV4
dCAqY3R4LCBzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHN0cnVjdCBvcHRlZV9tc2dfYXJnICphcmcpDQo+ID4gPiA+ICB7DQo+ID4g
PiA+ICsgICAgICAgYm9vbCB1cGRhdGVfb3V0ID0gZmFsc2U7DQo+ID4gPiA+ICAgICAgICAgc3Ry
dWN0IHRlZV9wYXJhbSAqcGFyYW1zOw0KPiA+ID4gPg0KPiA+ID4gPiAgICAgICAgIGFyZy0+cmV0
X29yaWdpbiA9IFRFRUNfT1JJR0lOX0NPTU1TOw0KPiA+ID4gPiBAQCAtMjAwLDE1ICsyMDIsMjEg
QEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19zdXBwX2NtZChzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0
eCwgc3RydWN0IG9wdGVlICpvcHRlZSwNCj4gPiA+ID4gICAgICAgICB9DQo+ID4gPiA+DQo+ID4g
PiA+ICAgICAgICAgaWYgKG9wdGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbXMs
IGFyZy0+bnVtX3BhcmFtcywNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYXJnLT5wYXJhbXMpKSB7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGFyZy0+cGFyYW1zLCB1cGRhdGVfb3V0KSkgew0KPiA+ID4gPiAgICAg
ICAgICAgICAgICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4g
PiAgICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gPiA+ICAgICAgICAgfQ0KPiA+ID4gPg0K
PiA+ID4gPiAgICAgICAgIGFyZy0+cmV0ID0gb3B0ZWVfc3VwcF90aHJkX3JlcShjdHgsIGFyZy0+
Y21kLCBhcmctPm51bV9wYXJhbXMsIHBhcmFtcyk7DQo+ID4gPiA+DQo+ID4gPiA+ICsgICAgICAg
LyoNCj4gPiA+ID4gKyAgICAgICAgKiBTcGVjaWFsIHRyZWF0bWVudCBmb3IgT1BURUVfUlBDX0NN
RF9TSE1fQUxMT0Mgc2luY2UgaW5wdXQgaXMgYQ0KPiA+ID4gPiArICAgICAgICAqIHZhbHVlIHR5
cGUsIGJ1dCB0aGUgb3V0cHV0IGlzIGEgbWVtcmVmIHR5cGUuDQo+ID4gPiA+ICsgICAgICAgICov
DQo+ID4gPiA+ICsgICAgICAgaWYgKGFyZy0+Y21kICE9IE9QVEVFX1JQQ19DTURfU0hNX0FMTE9D
KQ0KPiA+ID4gPiArICAgICAgICAgICAgICAgdXBkYXRlX291dCA9IHRydWU7DQo+ID4gPiA+ICAg
ICAgICAgaWYgKG9wdGVlLT5vcHMtPnRvX21zZ19wYXJhbShvcHRlZSwgYXJnLT5wYXJhbXMsIGFy
Zy0+bnVtX3BhcmFtcywNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHBhcmFtcykpDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBwYXJhbXMsIHVwZGF0ZV9vdXQpKQ0KPiA+ID4gPiAgICAgICAgICAgICAgICAgYXJnLT5yZXQg
PSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gPiAgb3V0Og0KPiA+ID4gPiAgICAg
ICAgIGtmcmVlKHBhcmFtcyk7DQo+ID4gPiA+IEBAIC0yNzAsNyArMjc4LDcgQEAgc3RhdGljIHZv
aWQgaGFuZGxlX3JwY19mdW5jX3JwbWJfcHJvYmVfcmVzZXQoc3RydWN0IHRlZV9jb250ZXh0ICpj
dHgsDQo+ID4gPiA+DQo+ID4gPiA+ICAgICAgICAgaWYgKGFyZy0+bnVtX3BhcmFtcyAhPSBBUlJB
WV9TSVpFKHBhcmFtcykgfHwNCj4gPiA+ID4gICAgICAgICAgICAgb3B0ZWUtPm9wcy0+ZnJvbV9t
c2dfcGFyYW0ob3B0ZWUsIHBhcmFtcywgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPnBhcmFtcykgfHwNCj4gPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMsIGZhbHNl
IC8qIXVwZGF0ZV9vdXQqLykgfHwNCj4gPiA+ID4gICAgICAgICAgICAgcGFyYW1zWzBdLmF0dHIg
IT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9PVVRQVVQpIHsNCj4gPiA+ID4gICAg
ICAgICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiA+
ID4gICAgICAgICAgICAgICAgIHJldHVybjsNCj4gPiA+ID4gQEAgLTI4MCw3ICsyODgsOCBAQCBz
dGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfcnBtYl9wcm9iZV9yZXNldChzdHJ1Y3QgdGVlX2Nv
bnRleHQgKmN0eCwNCj4gPiA+ID4gICAgICAgICBwYXJhbXNbMF0udS52YWx1ZS5iID0gMDsNCj4g
PiA+ID4gICAgICAgICBwYXJhbXNbMF0udS52YWx1ZS5jID0gMDsNCj4gPiA+ID4gICAgICAgICBp
ZiAob3B0ZWUtPm9wcy0+dG9fbXNnX3BhcmFtKG9wdGVlLCBhcmctPnBhcmFtcywNCj4gPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+bnVtX3BhcmFtcywgcGFy
YW1zKSkgew0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJn
LT5udW1fcGFyYW1zLCBwYXJhbXMsDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB0cnVlIC8qdXBkYXRlX291dCovKSkgew0KPiA+ID4gPiAgICAgICAgICAgICAg
ICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gPiAgICAgICAg
ICAgICAgICAgcmV0dXJuOw0KPiA+ID4gPiAgICAgICAgIH0NCj4gPiA+ID4gQEAgLTMyNCw3ICsz
MzMsNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfcnBtYl9wcm9iZV9uZXh0KHN0cnVj
dCB0ZWVfY29udGV4dCAqY3R4LA0KPiA+ID4gPg0KPiA+ID4gPiAgICAgICAgIGlmIChhcmctPm51
bV9wYXJhbXMgIT0gQVJSQVlfU0laRShwYXJhbXMpIHx8DQo+ID4gPiA+ICAgICAgICAgICAgIG9w
dGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbXMsIGFyZy0+bnVtX3BhcmFtcywN
Cj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJh
bXMpIHx8DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFy
Zy0+cGFyYW1zLCBmYWxzZSAvKiF1cGRhdGVfb3V0Ki8pIHx8DQo+ID4gPiA+ICAgICAgICAgICAg
IHBhcmFtc1swXS5hdHRyICE9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVU
IHx8DQo+ID4gPiA+ICAgICAgICAgICAgIHBhcmFtc1sxXS5hdHRyICE9IFRFRV9JT0NUTF9QQVJB
TV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVCkgew0KPiA+ID4gPiAgICAgICAgICAgICAgICAgYXJn
LT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gPiBAQCAtMzU4LDcgKzM2
Nyw4IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV9ycGNfZnVuY19ycG1iX3Byb2JlX25leHQoc3RydWN0
IHRlZV9jb250ZXh0ICpjdHgsDQo+ID4gPiA+ICAgICAgICAgcGFyYW1zWzBdLnUudmFsdWUuYiA9
IHJkZXYtPmRlc2NyLmNhcGFjaXR5Ow0KPiA+ID4gPiAgICAgICAgIHBhcmFtc1swXS51LnZhbHVl
LmMgPSByZGV2LT5kZXNjci5yZWxpYWJsZV93cl9jb3VudDsNCj4gPiA+ID4gICAgICAgICBpZiAo
b3B0ZWUtPm9wcy0+dG9fbXNnX3BhcmFtKG9wdGVlLCBhcmctPnBhcmFtcywNCj4gPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+bnVtX3BhcmFtcywgcGFyYW1z
KSkgew0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5u
dW1fcGFyYW1zLCBwYXJhbXMsDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICB0cnVlIC8qdXBkYXRlX291dCovKSkgew0KPiA+ID4gPiAgICAgICAgICAgICAgICAg
YXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gPiAgICAgICAgICAg
ICAgICAgcmV0dXJuOw0KPiA+ID4gPiAgICAgICAgIH0NCj4gPiA+ID4gQEAgLTM4NCw3ICszOTQs
NyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfcnBtYl9mcmFtZXMoc3RydWN0IHRlZV9j
b250ZXh0ICpjdHgsDQo+ID4gPiA+DQo+ID4gPiA+ICAgICAgICAgaWYgKGFyZy0+bnVtX3BhcmFt
cyAhPSBBUlJBWV9TSVpFKHBhcmFtcykgfHwNCj4gPiA+ID4gICAgICAgICAgICAgb3B0ZWUtPm9w
cy0+ZnJvbV9tc2dfcGFyYW0ob3B0ZWUsIHBhcmFtcywgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPnBhcmFtcykgfHwN
Cj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJh
bXMsIGZhbHNlIC8qIXVwZGF0ZV9vdXQqLykgfHwNCj4gPiA+ID4gICAgICAgICAgICAgcGFyYW1z
WzBdLmF0dHIgIT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQgfHwNCj4g
PiA+ID4gICAgICAgICAgICAgcGFyYW1zWzFdLmF0dHIgIT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJf
VFlQRV9NRU1SRUZfT1VUUFVUKSB7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBhcmctPnJldCA9
IFRFRUNfRVJST1JfQkFEX1BBUkFNRVRFUlM7DQo+ID4gPiA+IEBAIC00MDEsNyArNDExLDggQEAg
c3RhdGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX3JwbWJfZnJhbWVzKHN0cnVjdCB0ZWVfY29udGV4
dCAqY3R4LA0KPiA+ID4gPiAgICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gPiA+ICAgICAg
ICAgfQ0KPiA+ID4gPiAgICAgICAgIGlmIChvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0ZWUs
IGFyZy0+cGFyYW1zLA0KPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMpKSB7DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBhcmctPm51bV9wYXJhbXMsIHBhcmFtcywNCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyp1cGRhdGVfb3V0Ki8pKSB7
DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBhcmctPnJldCA9IFRFRUNfRVJST1JfQkFEX1BBUkFN
RVRFUlM7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiA+ID4gICAgICAg
ICB9DQo+ID4gPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9vcHRlZS9zbWNfYWJpLmMgYi9k
cml2ZXJzL3RlZS9vcHRlZS9zbWNfYWJpLmMNCj4gPiA+ID4gaW5kZXggZTk0NTZlM2U3NGNjLi5k
MWY3OTk0N2Y1OGEgMTAwNjQ0DQo+ID4gPiA+IC0tLSBhL2RyaXZlcnMvdGVlL29wdGVlL3NtY19h
YmkuYw0KPiA+ID4gPiArKysgYi9kcml2ZXJzL3RlZS9vcHRlZS9zbWNfYWJpLmMNCj4gPiA+ID4g
QEAgLTgxLDIwICs4MSwyNiBAQCBzdGF0aWMgaW50IG9wdGVlX2NwdWhwX2Rpc2FibGVfcGNwdV9p
cnEodW5zaWduZWQgaW50IGNwdSkNCj4gPiA+ID4gICAqLw0KPiA+ID4gPg0KPiA+ID4gPiAgc3Rh
dGljIGludCBmcm9tX21zZ19wYXJhbV90bXBfbWVtKHN0cnVjdCB0ZWVfcGFyYW0gKnAsIHUzMiBh
dHRyLA0KPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Ry
dWN0IG9wdGVlX21zZ19wYXJhbSAqbXApDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCwNCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ID4g
IHsNCj4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdGVlX3NobSAqc2htOw0KPiA+ID4gPiAgICAgICAg
IHBoeXNfYWRkcl90IHBhOw0KPiA+ID4gPiAgICAgICAgIGludCByYzsNCj4gPiA+ID4NCj4gPiA+
ID4gKyAgICAgICBpZiAodXBkYXRlX291dCkgew0KPiA+ID4gPiArICAgICAgICAgICAgICAgaWYg
KGF0dHIgPT0gT1BURUVfTVNHX0FUVFJfVFlQRV9UTUVNX0lOUFVUKQ0KPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8g
b3V0Ow0KPiA+ID4gPiArICAgICAgIH0NCj4gPiA+ID4gKw0KPiA+ID4gPiAgICAgICAgIHAtPmF0
dHIgPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVCArDQo+ID4gPiA+ICAg
ICAgICAgICAgICAgICAgIGF0dHIgLSBPUFRFRV9NU0dfQVRUUl9UWVBFX1RNRU1fSU5QVVQ7DQo+
ID4gPiA+IC0gICAgICAgcC0+dS5tZW1yZWYuc2l6ZSA9IG1wLT51LnRtZW0uc2l6ZTsNCj4gPiA+
ID4gICAgICAgICBzaG0gPSAoc3RydWN0IHRlZV9zaG0gKikodW5zaWduZWQgbG9uZyltcC0+dS50
bWVtLnNobV9yZWY7DQo+ID4gPiA+ICAgICAgICAgaWYgKCFzaG0pIHsNCj4gPiA+ID4gICAgICAg
ICAgICAgICAgIHAtPnUubWVtcmVmLnNobV9vZmZzID0gMDsNCj4gPiA+ID4gICAgICAgICAgICAg
ICAgIHAtPnUubWVtcmVmLnNobSA9IE5VTEw7DQo+ID4gPiA+IC0gICAgICAgICAgICAgICByZXR1
cm4gMDsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ID4gPiAgICAgICAg
IH0NCj4gPiA+ID4NCj4gPiA+ID4gICAgICAgICByYyA9IHRlZV9zaG1fZ2V0X3BhKHNobSwgMCwg
JnBhKTsNCj4gPiA+ID4gQEAgLTEwMywxOCArMTA5LDI1IEBAIHN0YXRpYyBpbnQgZnJvbV9tc2df
cGFyYW1fdG1wX21lbShzdHJ1Y3QgdGVlX3BhcmFtICpwLCB1MzIgYXR0ciwNCj4gPiA+ID4NCj4g
PiA+ID4gICAgICAgICBwLT51Lm1lbXJlZi5zaG1fb2ZmcyA9IG1wLT51LnRtZW0uYnVmX3B0ciAt
IHBhOw0KPiA+ID4gPiAgICAgICAgIHAtPnUubWVtcmVmLnNobSA9IHNobTsNCj4gPiA+ID4gLQ0K
PiA+ID4gPiArb3V0Og0KPiA+ID4gPiArICAgICAgIHAtPnUubWVtcmVmLnNpemUgPSBtcC0+dS50
bWVtLnNpemU7DQo+ID4gPiA+ICAgICAgICAgcmV0dXJuIDA7DQo+ID4gPiA+ICB9DQo+ID4gPiA+
DQo+ID4gPiA+ICBzdGF0aWMgdm9pZCBmcm9tX21zZ19wYXJhbV9yZWdfbWVtKHN0cnVjdCB0ZWVf
cGFyYW0gKnAsIHUzMiBhdHRyLA0KPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wKQ0KPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0g
Km1wLA0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBk
YXRlX291dCkNCj4gPiA+ID4gIHsNCj4gPiA+ID4gICAgICAgICBzdHJ1Y3QgdGVlX3NobSAqc2ht
Ow0KPiA+ID4gPg0KPiA+ID4gPiArICAgICAgIGlmICh1cGRhdGVfb3V0KSB7DQo+ID4gPiA+ICsg
ICAgICAgICAgICAgICBpZiAoYXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX1JNRU1fSU5QVVQp
DQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCj4gPiA+ID4gKyAgICAg
ICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ID4gPiArICAgICAgIH0NCj4gPiA+ID4gKw0KPiA+ID4g
PiAgICAgICAgIHAtPmF0dHIgPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBV
VCArDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgIGF0dHIgLSBPUFRFRV9NU0dfQVRUUl9UWVBF
X1JNRU1fSU5QVVQ7DQo+ID4gPiA+IC0gICAgICAgcC0+dS5tZW1yZWYuc2l6ZSA9IG1wLT51LnJt
ZW0uc2l6ZTsNCj4gPiA+ID4gICAgICAgICBzaG0gPSAoc3RydWN0IHRlZV9zaG0gKikodW5zaWdu
ZWQgbG9uZyltcC0+dS5ybWVtLnNobV9yZWY7DQo+ID4gPiA+DQo+ID4gPiA+ICAgICAgICAgaWYg
KHNobSkgew0KPiA+ID4gPiBAQCAtMTI0LDYgKzEzNyw4IEBAIHN0YXRpYyB2b2lkIGZyb21fbXNn
X3BhcmFtX3JlZ19tZW0oc3RydWN0IHRlZV9wYXJhbSAqcCwgdTMyIGF0dHIsDQo+ID4gPiA+ICAg
ICAgICAgICAgICAgICBwLT51Lm1lbXJlZi5zaG1fb2ZmcyA9IDA7DQo+ID4gPiA+ICAgICAgICAg
ICAgICAgICBwLT51Lm1lbXJlZi5zaG0gPSBOVUxMOw0KPiA+ID4gPiAgICAgICAgIH0NCj4gPiA+
ID4gK291dDoNCj4gPiA+ID4gKyAgICAgICBwLT51Lm1lbXJlZi5zaXplID0gbXAtPnUucm1lbS5z
aXplOw0KPiA+ID4gPiAgfQ0KPiA+ID4gPg0KPiA+ID4gPiAgLyoqDQo+ID4gPiA+IEBAIC0xMzMs
MTEgKzE0OCwxMyBAQCBzdGF0aWMgdm9pZCBmcm9tX21zZ19wYXJhbV9yZWdfbWVtKHN0cnVjdCB0
ZWVfcGFyYW0gKnAsIHUzMiBhdHRyLA0KPiA+ID4gPiAgICogQHBhcmFtczogICAgc3Vic3lzdGVt
IGludGVybmFsIHBhcmFtZXRlciByZXByZXNlbnRhdGlvbg0KPiA+ID4gPiAgICogQG51bV9wYXJh
bXM6ICAgICAgICBudW1iZXIgb2YgZWxlbWVudHMgaW4gdGhlIHBhcmFtZXRlciBhcnJheXMNCj4g
PiA+ID4gICAqIEBtc2dfcGFyYW1zOiAgICAgICAgT1BURUVfTVNHIHBhcmFtZXRlcnMNCj4gPiA+
ID4gKyAqIEB1cGRhdGVfb3V0OiAgICAgICAgdXBkYXRlIHBhcmFtZXRlciBmb3Igb3V0cHV0IG9u
bHkNCj4gPiA+ID4gICAqIFJldHVybnMgMCBvbiBzdWNjZXNzIG9yIDwwIG9uIGZhaWx1cmUNCj4g
PiA+ID4gICAqLw0KPiA+ID4gPiAgc3RhdGljIGludCBvcHRlZV9mcm9tX21zZ19wYXJhbShzdHJ1
Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsDQo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bV9wYXJhbXMsDQo+ID4gPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJh
bSAqbXNnX3BhcmFtcykNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptc2dfcGFyYW1zLA0KPiA+ID4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ID4gIHsNCj4g
PiA+ID4gICAgICAgICBpbnQgcmM7DQo+ID4gPiA+ICAgICAgICAgc2l6ZV90IG47DQo+ID4gPiA+
IEBAIC0xNDksMjUgKzE2NiwyNyBAQCBzdGF0aWMgaW50IG9wdGVlX2Zyb21fbXNnX3BhcmFtKHN0
cnVjdCBvcHRlZSAqb3B0ZWUsIHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcywNCj4gPiA+ID4NCj4g
PiA+ID4gICAgICAgICAgICAgICAgIHN3aXRjaCAoYXR0cikgew0KPiA+ID4gPiAgICAgICAgICAg
ICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX05PTkU6DQo+ID4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGlmICh1cGRhdGVfb3V0KQ0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBwLT5h
dHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOw0KPiA+ID4gPiAgICAgICAgICAg
ICAgICAgICAgICAgICBtZW1zZXQoJnAtPnUsIDAsIHNpemVvZihwLT51KSk7DQo+ID4gPiA+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgY2Fz
ZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX0lOUFVUOg0KPiA+ID4gPiAgICAgICAgICAgICAg
ICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX09VVFBVVDoNCj4gPiA+ID4gICAgICAg
ICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9JTk9VVDoNCj4gPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgb3B0ZWVfZnJvbV9tc2dfcGFyYW1fdmFsdWUocCwgYXR0
ciwgbXApOw0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV9mcm9tX21zZ19w
YXJhbV92YWx1ZShwLCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+ID4gPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9N
U0dfQVRUUl9UWVBFX1RNRU1fSU5QVVQ6DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9Q
VEVFX01TR19BVFRSX1RZUEVfVE1FTV9PVVRQVVQ6DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBj
YXNlIE9QVEVFX01TR19BVFRSX1RZUEVfVE1FTV9JTk9VVDoNCj4gPiA+ID4gLSAgICAgICAgICAg
ICAgICAgICAgICAgcmMgPSBmcm9tX21zZ19wYXJhbV90bXBfbWVtKHAsIGF0dHIsIG1wKTsNCj4g
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgcmMgPSBmcm9tX21zZ19wYXJhbV90bXBfbWVt
KHAsIGF0dHIsIG1wLCB1cGRhdGVfb3V0KTsNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKHJjKQ0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biByYzsNCj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gPiA+ICAg
ICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfUk1FTV9JTlBVVDoNCj4gPiA+
ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9STUVNX09VVFBVVDoN
Cj4gPiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9STUVNX0lO
T1VUOg0KPiA+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBmcm9tX21zZ19wYXJhbV9yZWdf
bWVtKHAsIGF0dHIsIG1wKTsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgZnJvbV9t
c2dfcGFyYW1fcmVnX21lbShwLCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+ID4gPiA+ICAgICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gPg0KPiA+ID4gPiAgICAgICAgICAgICAg
ICAgZGVmYXVsdDoNCj4gPiA+ID4gQEAgLTE3OCwyMCArMTk3LDI1IEBAIHN0YXRpYyBpbnQgb3B0
ZWVfZnJvbV9tc2dfcGFyYW0oc3RydWN0IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAq
cGFyYW1zLA0KPiA+ID4gPiAgfQ0KPiA+ID4gPg0KPiA+ID4gPiAgc3RhdGljIGludCB0b19tc2df
cGFyYW1fdG1wX21lbShzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCwNCj4gPiA+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwKQ0KPiA+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFy
YW0gKnAsIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ID4gIHsNCj4gPiA+ID4gICAgICAgICBpbnQg
cmM7DQo+ID4gPiA+ICAgICAgICAgcGh5c19hZGRyX3QgcGE7DQo+ID4gPiA+DQo+ID4gPiA+ICsg
ICAgICAgaWYgKHVwZGF0ZV9vdXQpIHsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChwLT5h
dHRyID09IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOUFVUKQ0KPiA+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4gPiA+ID4gKyAgICAgICAgICAgICAg
IGdvdG8gb3V0Ow0KPiA+ID4gPiArICAgICAgIH0NCj4gPiA+ID4gKw0KPiA+ID4gPiAgICAgICAg
IG1wLT5hdHRyID0gT1BURUVfTVNHX0FUVFJfVFlQRV9UTUVNX0lOUFVUICsgcC0+YXR0ciAtDQo+
ID4gPiA+ICAgICAgICAgICAgICAgICAgICBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJF
Rl9JTlBVVDsNCj4gPiA+ID4NCj4gPiA+ID4gICAgICAgICBtcC0+dS50bWVtLnNobV9yZWYgPSAo
dW5zaWduZWQgbG9uZylwLT51Lm1lbXJlZi5zaG07DQo+ID4gPiA+IC0gICAgICAgbXAtPnUudG1l
bS5zaXplID0gcC0+dS5tZW1yZWYuc2l6ZTsNCj4gPiA+ID4NCj4gPiA+ID4gICAgICAgICBpZiAo
IXAtPnUubWVtcmVmLnNobSkgew0KPiA+ID4gPiAgICAgICAgICAgICAgICAgbXAtPnUudG1lbS5i
dWZfcHRyID0gMDsNCj4gPiA+ID4gLSAgICAgICAgICAgICAgIHJldHVybiAwOw0KPiA+ID4gPiAr
ICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gPiA+ICAgICAgICAgfQ0KPiA+ID4gPg0KPiA+
ID4gPiAgICAgICAgIHJjID0gdGVlX3NobV9nZXRfcGEocC0+dS5tZW1yZWYuc2htLCBwLT51Lm1l
bXJlZi5zaG1fb2ZmcywgJnBhKTsNCj4gPiA+ID4gQEAgLTIwMSwxOSArMjI1LDI3IEBAIHN0YXRp
YyBpbnQgdG9fbXNnX3BhcmFtX3RtcF9tZW0oc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+
ID4gPiA+ICAgICAgICAgbXAtPnUudG1lbS5idWZfcHRyID0gcGE7DQo+ID4gPiA+ICAgICAgICAg
bXAtPmF0dHIgfD0gT1BURUVfTVNHX0FUVFJfQ0FDSEVfUFJFREVGSU5FRCA8PA0KPiA+ID4gPiAg
ICAgICAgICAgICAgICAgICAgIE9QVEVFX01TR19BVFRSX0NBQ0hFX1NISUZUOw0KPiA+ID4gPiAt
DQo+ID4gPiA+ICtvdXQ6DQo+ID4gPiA+ICsgICAgICAgbXAtPnUudG1lbS5zaXplID0gcC0+dS5t
ZW1yZWYuc2l6ZTsNCj4gPiA+ID4gICAgICAgICByZXR1cm4gMDsNCj4gPiA+ID4gIH0NCj4gPiA+
ID4NCj4gPiA+ID4gIHN0YXRpYyBpbnQgdG9fbXNnX3BhcmFtX3JlZ19tZW0oc3RydWN0IG9wdGVl
X21zZ19wYXJhbSAqbXAsDQo+ID4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcCkNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwLCBib29sIHVwZGF0ZV9vdXQpDQo+
ID4gPiA+ICB7DQo+ID4gPiA+ICsgICAgICAgaWYgKHVwZGF0ZV9vdXQpIHsNCj4gPiA+ID4gKyAg
ICAgICAgICAgICAgIGlmIChwLT5hdHRyID09IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVN
UkVGX0lOUFVUKQ0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsNCj4g
PiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ID4gPiArICAgICAgIH0NCj4gPiA+
ID4gKw0KPiA+ID4gPiAgICAgICAgIG1wLT5hdHRyID0gT1BURUVfTVNHX0FUVFJfVFlQRV9STUVN
X0lOUFVUICsgcC0+YXR0ciAtDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICBURUVfSU9DVExf
UEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVDsNCj4gPiA+ID4NCj4gPiA+ID4gICAgICAgICBt
cC0+dS5ybWVtLnNobV9yZWYgPSAodW5zaWduZWQgbG9uZylwLT51Lm1lbXJlZi5zaG07DQo+ID4g
PiA+IC0gICAgICAgbXAtPnUucm1lbS5zaXplID0gcC0+dS5tZW1yZWYuc2l6ZTsNCj4gPiA+ID4g
ICAgICAgICBtcC0+dS5ybWVtLm9mZnMgPSBwLT51Lm1lbXJlZi5zaG1fb2ZmczsNCj4gPiA+ID4g
K291dDoNCj4gPiA+ID4gKyAgICAgICBtcC0+dS5ybWVtLnNpemUgPSBwLT51Lm1lbXJlZi5zaXpl
Ow0KPiA+ID4gPiAgICAgICAgIHJldHVybiAwOw0KPiA+ID4gPiAgfQ0KPiA+ID4gPg0KPiA+ID4g
PiBAQCAtMjIzLDExICsyNTUsMTMgQEAgc3RhdGljIGludCB0b19tc2dfcGFyYW1fcmVnX21lbShz
dHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCwNCj4gPiA+ID4gICAqIEBtc2dfcGFyYW1zOiAgICAg
ICAgT1BURUVfTVNHIHBhcmFtZXRlcnMNCj4gPiA+ID4gICAqIEBudW1fcGFyYW1zOiAgICAgICAg
bnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBwYXJhbWV0ZXIgYXJyYXlzDQo+ID4gPiA+ICAgKiBA
cGFyYW1zOiAgICBzdWJzeXN0ZW0gaXRuZXJuYWwgcGFyYW1ldGVyIHJlcHJlc2VudGF0aW9uDQo+
ID4gPiA+ICsgKiBAdXBkYXRlX291dDogICAgICAgIHVwZGF0ZSBwYXJhbWV0ZXIgZm9yIG91dHB1
dCBvbmx5DQo+ID4gPiA+ICAgKiBSZXR1cm5zIDAgb24gc3VjY2VzcyBvciA8MCBvbiBmYWlsdXJl
DQo+ID4gPiA+ICAgKi8NCj4gPiA+ID4gIHN0YXRpYyBpbnQgb3B0ZWVfdG9fbXNnX3BhcmFtKHN0
cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMsDQo+ID4gPiA+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNpemVfdCBudW1fcGFyYW1zLCBjb25zdCBzdHJ1Y3QgdGVlX3Bh
cmFtICpwYXJhbXMpDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVf
dCBudW1fcGFyYW1zLCBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsDQo+ID4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ID4gIHsN
Cj4gPiA+ID4gICAgICAgICBpbnQgcmM7DQo+ID4gPiA+ICAgICAgICAgc2l6ZV90IG47DQo+ID4g
PiA+IEBAIC0yMzgsMjEgKzI3MiwyMyBAQCBzdGF0aWMgaW50IG9wdGVlX3RvX21zZ19wYXJhbShz
dHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4gPg0KPiA+ID4gPiAgICAgICAgICAgICAgICAgc3dp
dGNoIChwLT5hdHRyKSB7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9Q
QVJBTV9BVFRSX1RZUEVfTk9ORToNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYg
KHVwZGF0ZV9vdXQpDQo+ID4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJl
YWs7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIG1wLT5hdHRyID0gVEVFX0lPQ1RM
X1BBUkFNX0FUVFJfVFlQRV9OT05FOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBt
ZW1zZXQoJm1wLT51LCAwLCBzaXplb2YobXAtPnUpKTsNCj4gPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9Q
QVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5QVVQ6DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBjYXNl
IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUOg0KPiA+ID4gPiAgICAgICAg
ICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX0lOT1VUOg0KPiA+
ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV90b19tc2dfcGFyYW1fdmFsdWUobXAs
IHApOw0KPiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV90b19tc2dfcGFyYW1f
dmFsdWUobXAsIHAsIHVwZGF0ZV9vdXQpOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAg
ICBicmVhazsNCj4gPiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FU
VFJfVFlQRV9NRU1SRUZfSU5QVVQ6DQo+ID4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVDoNCj4gPiA+ID4gICAgICAgICAgICAg
ICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5PVVQ6DQo+ID4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZWVfc2htX2lzX2R5bmFtaWMocC0+dS5tZW1y
ZWYuc2htKSkNCj4gPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYyA9IHRv
X21zZ19wYXJhbV9yZWdfbWVtKG1wLCBwKTsNCj4gPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICByYyA9IHRvX21zZ19wYXJhbV9yZWdfbWVtKG1wLCBwLCB1cGRhdGVfb3V0KTsN
Cj4gPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQ0KPiA+ID4gPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJjID0gdG9fbXNnX3BhcmFtX3RtcF9tZW0obXAsIHApOw0K
PiA+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJjID0gdG9fbXNnX3BhcmFt
X3RtcF9tZW0obXAsIHAsIHVwZGF0ZV9vdXQpOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICBpZiAocmMpDQo+ID4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIHJjOw0KPiA+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiA+ID4g
LS0NCj4gPiA+ID4gMi40My4wDQo+ID4gPiA+DQpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdCAtLSBsaW5hcm8t
bW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKVG8gdW5zdWJzY3JpYmUgc2VuZCBhbiBlbWFpbCB0byBs
aW5hcm8tbW0tc2lnLWxlYXZlQGxpc3RzLmxpbmFyby5vcmcK
