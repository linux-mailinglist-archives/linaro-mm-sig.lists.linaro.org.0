Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 4E358A64410
	for <lists+linaro-mm-sig@lfdr.de>; Mon, 17 Mar 2025 08:42:34 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 62605446E8
	for <lists+linaro-mm-sig@lfdr.de>; Mon, 17 Mar 2025 07:42:33 +0000 (UTC)
Received: from mail-oo1-f42.google.com (mail-oo1-f42.google.com [209.85.161.42])
	by lists.linaro.org (Postfix) with ESMTPS id D27293F616
	for <linaro-mm-sig@lists.linaro.org>; Mon, 17 Mar 2025 07:42:14 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linaro.org header.s=google header.b=WzxaH0hm;
	spf=pass (lists.linaro.org: domain of jens.wiklander@linaro.org designates 209.85.161.42 as permitted sender) smtp.mailfrom=jens.wiklander@linaro.org;
	dmarc=pass (policy=none) header.from=linaro.org
Received: by mail-oo1-f42.google.com with SMTP id 006d021491bc7-601ff283d4aso77560eaf.0
        for <linaro-mm-sig@lists.linaro.org>; Mon, 17 Mar 2025 00:42:14 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google; t=1742197334; x=1742802134; darn=lists.linaro.org;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:from:to:cc:subject:date
         :message-id:reply-to;
        bh=S87FYJVYasOFZel8FyJt4M1p1h0+/LChHwqkIzmjOvc=;
        b=WzxaH0hmdDd78OyGLzSPZYTowpukNdZDwi6zIseCNfGJsmHkh4rrZDhJAYkm7U0P5r
         cs6gFUD5RIgBgLTnnn4mtwI/a6M4Mk9dx9OJFR4/0xYZXj5UeW7eqOYZtqRHyAKdnsul
         oV0ObnpnhbtSJsnreBv5vIVgtXJgeSq2A9n9ZRtr/cGcxKgo0vbSDOWlqgqddhFgAysS
         AWSoQkOLPqDREdl76CjhE4uhL8pNmv9HtTDMUy6tJf3UZZ5QcCvNozSE9ZLZ3+N6520H
         qFR3LjFa2WI2XhJSJlLQFDl4h0YOVekDP/C1XgvIpd2uffSzmMiDsqH9ALC3aZScPX5x
         QIgw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1742197334; x=1742802134;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=S87FYJVYasOFZel8FyJt4M1p1h0+/LChHwqkIzmjOvc=;
        b=Wh/4+KMtYuE43HLdV0vBaLpy0Kar2lshwvbtpPKQo5WOiMdQTr5EPaz2qTrw0KOjLs
         Qsq53K/3UvkMxLg6S4DRd1qcixX+aD1GJvGQPT/tzarz8r1FWmGdVULYXgnOH5gAilMN
         upbRfprpy+T2ogNgllLQ/swpS0rQX3OBlF81uEQb1WB98NUuG47aYw8a591SzrxBwRK5
         nhTg2YqFogVYyuTw20CzytU6EeGCQIgLMNj33K/5MQYAVL0/hjjK14Hd51poTvmGPTRX
         1i3BlJhJ+q1Yvg2uuxI2N27VomKW8K1bYpI40LVKTULxcnQBX4XI9CgpwooUrqeRM0ub
         06cg==
X-Forwarded-Encrypted: i=1; AJvYcCXYGBH07GNb1TU7SBaS+F3Fj2HtlsuXpLXHUnkz/iWkMKGKCH56LdXmNCNTipJkAYIbtdjbShTmugTf0HBd@lists.linaro.org
X-Gm-Message-State: AOJu0Yx7Q6IUza8DUzZW8dUnMr39P2hWzvOSKaIZwMZbazfYYTclURBr
	nuChULvgFO51XliFSlWOS0UoHSWN2tk/KTiTdqfu/iq5Y8HCEWMzP8rZCsL7MR2Tgr20/qiVsxg
	czJ0iTBSt0xK3zCDkWQBoQ2x6JTiZcL8gtwB/ZD8g
X-Gm-Gg: ASbGnctA5sspRKxY6L1eITPmw0I4EHkptu8Pyr+tZt9ut5mDmv0XgFnjes6i+7PPCgY
	t6IO8wNuLPy7MTsykzArnXcoVyiYaIdZVXrkzHfrXfe3wRAjJt6MqwrQUxEBXyb+RpP7/rrazzq
	nEs8IVpqxYDW26GX4Lkp29GKaaKnE=
X-Google-Smtp-Source: AGHT+IF5qmiPcbVgGq6qfgo2IsNs98w0EMaO3kwYiY6yV0dvNH2dHkX94ORuWjJ6//2l0CXtQdHUeVpZQ6I5bcjIBJU=
X-Received: by 2002:a05:6820:a03:b0:601:d595:3b1f with SMTP id
 006d021491bc7-601e45f8dc7mr6807329eaf.6.1742197333957; Mon, 17 Mar 2025
 00:42:13 -0700 (PDT)
MIME-Version: 1.0
References: <20250305130634.1850178-1-jens.wiklander@linaro.org>
 <20250305130634.1850178-4-jens.wiklander@linaro.org> <Z9K2RQYuXSJc8Y1E@sumit-X1>
In-Reply-To: <Z9K2RQYuXSJc8Y1E@sumit-X1>
From: Jens Wiklander <jens.wiklander@linaro.org>
Date: Mon, 17 Mar 2025 08:42:01 +0100
X-Gm-Features: AQ5f1Jq1V8IGfzt5sd2CMPdy0tNGpGmHTta8LIyXEvOJk6evD6xBH3E9bSwXumo
Message-ID: <CAHUa44H5Zc_POJ_RWaVd4iFVagRkFaN+8Ajs=19FKboZapbQHw@mail.gmail.com>
To: Sumit Garg <sumit.garg@kernel.org>
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: D27293F616
X-Spamd-Bar: --
X-Spamd-Result: default: False [-2.60 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	DMARC_POLICY_ALLOW(-0.50)[linaro.org,none];
	R_DKIM_ALLOW(-0.20)[linaro.org:s=google];
	R_SPF_ALLOW(-0.20)[+ip4:209.85.128.0/17];
	RWL_MAILSPIKE_GOOD(-0.10)[209.85.161.42:from];
	MIME_GOOD(-0.10)[text/plain];
	RBL_SENDERSCORE_REPUT_8(0.00)[209.85.161.42:from];
	URIBL_BLOCKED(0.00)[linaro.org:email,linaro.org:dkim,mail.gmail.com:mid,mail-oo1-f42.google.com:helo,mail-oo1-f42.google.com:rdns];
	ASN(0.00)[asn:15169, ipnet:209.85.128.0/17, country:US];
	MIME_TRACE(0.00)[0:+];
	RCVD_COUNT_ONE(0.00)[1];
	TO_DN_SOME(0.00)[];
	RCPT_COUNT_TWELVE(0.00)[21];
	TAGGED_RCPT(0.00)[];
	ARC_NA(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	FROM_HAS_DN(0.00)[];
	FREEMAIL_CC(0.00)[vger.kernel.org,lists.freedesktop.org,lists.linaro.org,lists.trustedfirmware.org,lists.infradead.org,nxp.com,gmail.com,mediatek.com,linaro.org,collabora.com,arm.com,google.com,amd.com,qti.qualcomm.com,ffwll.ch,fooishbar.org];
	MISSING_XM_UA(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	PREVIOUSLY_DELIVERED(0.00)[linaro-mm-sig@lists.linaro.org];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	DKIM_TRACE(0.00)[linaro.org:+]
X-Rspamd-Action: no action
Message-ID-Hash: 3ABOF7ECI5LIQEAV3QUHBD4NKTN2BFVA
X-Message-ID-Hash: 3ABOF7ECI5LIQEAV3QUHBD4NKTN2BFVA
X-MailFrom: jens.wiklander@linaro.org
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: linux-kernel@vger.kernel.org, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, op-tee@lists.trustedfirmware.org, linux-arm-kernel@lists.infradead.org, Olivier Masse <olivier.masse@nxp.com>, Thierry Reding <thierry.reding@gmail.com>, Yong Wu <yong.wu@mediatek.com>, Sumit Semwal <sumit.semwal@linaro.org>, Benjamin Gaignard <benjamin.gaignard@collabora.com>, Brian Starkey <Brian.Starkey@arm.com>, John Stultz <jstultz@google.com>, "T . J . Mercier" <tjmercier@google.com>, =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>, Matthias Brugger <matthias.bgg@gmail.com>, AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>, azarrabi@qti.qualcomm.com, Simona Vetter <simona.vetter@ffwll.ch>, Daniel Stone <daniel@fooishbar.org>
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] Re: [PATCH v6 03/10] optee: account for direction while converting parameters
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/3ABOF7ECI5LIQEAV3QUHBD4NKTN2BFVA/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

SGkgU3VtaXQsDQoNCk9uIFRodSwgTWFyIDEzLCAyMDI1IGF0IDExOjQx4oCvQU0gU3VtaXQgR2Fy
ZyA8c3VtaXQuZ2FyZ0BrZXJuZWwub3JnPiB3cm90ZToNCj4NCj4gSGkgSmVucywNCj4NCj4gT24g
V2VkLCBNYXIgMDUsIDIwMjUgYXQgMDI6MDQ6MDlQTSArMDEwMCwgSmVucyBXaWtsYW5kZXIgd3Jv
dGU6DQo+ID4gVGhlIE9QLVRFRSBiYWNrZW5kIGRyaXZlciBoYXMgdHdvIGludGVybmFsIGZ1bmN0
aW9uIHBvaW50ZXJzIHRvIGNvbnZlcnQNCj4gPiBiZXR3ZWVuIHRoZSBzdWJzeXN0ZW0gdHlwZSBz
dHJ1Y3QgdGVlX3BhcmFtIGFuZCB0aGUgT1AtVEVFIHR5cGUgc3RydWN0DQo+ID4gb3B0ZWVfbXNn
X3BhcmFtLg0KPiA+DQo+ID4gVGhlIGNvbnZlcnNpb24gaXMgZG9uZSBmcm9tIG9uZSBvZiB0aGUg
dHlwZXMgdG8gdGhlIG90aGVyLCB3aGljaCBpcyB0aGVuDQo+ID4gaW52b2x2ZWQgaW4gc29tZSBv
cGVyYXRpb24gYW5kIGZpbmFsbHkgY29udmVydGVkIGJhY2sgdG8gdGhlIG9yaWdpbmFsDQo+ID4g
dHlwZS4gV2hlbiBjb252ZXJ0aW5nIHRvIHByZXBhcmUgdGhlIHBhcmFtZXRlcnMgZm9yIHRoZSBv
cGVyYXRpb24sIGFsbA0KPiA+IGZpZWxkcyBtdXN0IGJlIHRha2VuIGludG8gYWNjb3VudCwgYnV0
IHRoZW4gY29udmVydGluZyBiYWNrLCBpdCdzIGVub3VnaA0KPiA+IHRvIHVwZGF0ZSBvbmx5IG91
dC12YWx1ZXMgYW5kIG91dC1zaXplcy4gU28sIGFuIHVwZGF0ZV9vdXQgcGFyYW1ldGVyIGlzDQo+
ID4gYWRkZWQgdG8gdGhlIGNvbnZlcnNpb24gZnVuY3Rpb25zIHRvIHRlbGwgaWYgYWxsIG9yIG9u
bHkgc29tZSBmaWVsZHMNCj4gPiBtdXN0IGJlIGNvcGllZC4NCj4gPg0KPiA+IFRoaXMgaXMgbmVl
ZGVkIGluIGEgbGF0ZXIgcGF0Y2ggd2hlcmUgaXQgbWlnaHQgZ2V0IGNvbmZ1c2luZyB3aGVuDQo+
ID4gY29udmVydGluZyBiYWNrIGluIGZyb21fbXNnX3BhcmFtKCkgY2FsbGJhY2sgc2luY2UgYW4g
YWxsb2NhdGVkDQo+ID4gcmVzdHJpY3RlZCBTSE0gY2FuIGJlIHVzaW5nIHRoZSBzZWNfd29ybGRf
aWQgb2YgdGhlIHVzZWQgcmVzdHJpY3RlZA0KPiA+IG1lbW9yeSBwb29sIGFuZCB0aGF0IGRvZXNu
J3QgdHJhbnNsYXRlIGJhY2sgd2VsbC4NCj4gPg0KPiA+IFNpZ25lZC1vZmYtYnk6IEplbnMgV2lr
bGFuZGVyIDxqZW5zLndpa2xhbmRlckBsaW5hcm8ub3JnPg0KPiA+IC0tLQ0KPiA+ICBkcml2ZXJz
L3RlZS9vcHRlZS9jYWxsLmMgICAgICAgICAgfCAxMCArKy0tDQo+ID4gIGRyaXZlcnMvdGVlL29w
dGVlL2ZmYV9hYmkuYyAgICAgICB8IDQzICsrKysrKysrKysrKystLS0tDQo+ID4gIGRyaXZlcnMv
dGVlL29wdGVlL29wdGVlX3ByaXZhdGUuaCB8IDQyICsrKysrKysrKysrLS0tLS0tDQo+ID4gIGRy
aXZlcnMvdGVlL29wdGVlL3JwYy5jICAgICAgICAgICB8IDMxICsrKysrKysrKy0tLS0NCj4gPiAg
ZHJpdmVycy90ZWUvb3B0ZWUvc21jX2FiaS5jICAgICAgIHwgNzYgKysrKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLQ0KPiA+ICA1IGZpbGVzIGNoYW5nZWQsIDE0NCBpbnNlcnRpb25zKCspLCA1
OCBkZWxldGlvbnMoLSkNCj4gPg0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9vcHRlZS9j
YWxsLmMgYi9kcml2ZXJzL3RlZS9vcHRlZS9jYWxsLmMNCj4gPiBpbmRleCAxNmViOTUzZTE0YmIu
LmYxNTMzYjg5NDcyNiAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL3RlZS9vcHRlZS9jYWxsLmMN
Cj4gPiArKysgYi9kcml2ZXJzL3RlZS9vcHRlZS9jYWxsLmMNCj4gPiBAQCAtNDAwLDcgKzQwMCw4
IEBAIGludCBvcHRlZV9vcGVuX3Nlc3Npb24oc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsDQo+ID4g
ICAgICAgZXhwb3J0X3V1aWQobXNnX2FyZy0+cGFyYW1zWzFdLnUub2N0ZXRzLCAmY2xpZW50X3V1
aWQpOw0KPiA+DQo+ID4gICAgICAgcmMgPSBvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0ZWUs
IG1zZ19hcmctPnBhcmFtcyArIDIsDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbSk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbSwNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBmYWxzZSAvKiF1cGRhdGVfb3V0Ki8pOw0KPiA+ICAgICAg
IGlmIChyYykNCj4gPiAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+DQo+ID4gQEAgLTQyNyw3
ICs0MjgsOCBAQCBpbnQgb3B0ZWVfb3Blbl9zZXNzaW9uKHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4
LA0KPiA+ICAgICAgIH0NCj4gPg0KPiA+ICAgICAgIGlmIChvcHRlZS0+b3BzLT5mcm9tX21zZ19w
YXJhbShvcHRlZSwgcGFyYW0sIGFyZy0+bnVtX3BhcmFtcywNCj4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFyYW1zICsgMikpIHsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFyYW1zICsgMiwNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKnVwZGF0ZV9vdXQqLykp
IHsNCj4gPiAgICAgICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9DT01NVU5JQ0FUSU9O
Ow0KPiA+ICAgICAgICAgICAgICAgYXJnLT5yZXRfb3JpZ2luID0gVEVFQ19PUklHSU5fQ09NTVM7
DQo+ID4gICAgICAgICAgICAgICAvKiBDbG9zZSBzZXNzaW9uIGFnYWluIHRvIGF2b2lkIGxlYWth
Z2UgKi8NCj4gPiBAQCAtNTQxLDcgKzU0Myw3IEBAIGludCBvcHRlZV9pbnZva2VfZnVuYyhzdHJ1
Y3QgdGVlX2NvbnRleHQgKmN0eCwgc3RydWN0IHRlZV9pb2N0bF9pbnZva2VfYXJnICphcmcsDQo+
ID4gICAgICAgbXNnX2FyZy0+Y2FuY2VsX2lkID0gYXJnLT5jYW5jZWxfaWQ7DQo+ID4NCj4gPiAg
ICAgICByYyA9IG9wdGVlLT5vcHMtPnRvX21zZ19wYXJhbShvcHRlZSwgbXNnX2FyZy0+cGFyYW1z
LCBhcmctPm51bV9wYXJhbXMsDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcGFyYW0pOw0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFt
LCBmYWxzZSAvKiF1cGRhdGVfb3V0Ki8pOw0KPiA+ICAgICAgIGlmIChyYykNCj4gPiAgICAgICAg
ICAgICAgIGdvdG8gb3V0Ow0KPiA+DQo+ID4gQEAgLTU1MSw3ICs1NTMsNyBAQCBpbnQgb3B0ZWVf
aW52b2tlX2Z1bmMoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsIHN0cnVjdCB0ZWVfaW9jdGxfaW52
b2tlX2FyZyAqYXJnLA0KPiA+ICAgICAgIH0NCj4gPg0KPiA+ICAgICAgIGlmIChvcHRlZS0+b3Bz
LT5mcm9tX21zZ19wYXJhbShvcHRlZSwgcGFyYW0sIGFyZy0+bnVtX3BhcmFtcywNCj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFyYW1zKSkgew0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2dfYXJnLT5wYXJhbXMsIHRy
dWUgLyp1cGRhdGVfb3V0Ki8pKSB7DQo+ID4gICAgICAgICAgICAgICBtc2dfYXJnLT5yZXQgPSBU
RUVDX0VSUk9SX0NPTU1VTklDQVRJT047DQo+ID4gICAgICAgICAgICAgICBtc2dfYXJnLT5yZXRf
b3JpZ2luID0gVEVFQ19PUklHSU5fQ09NTVM7DQo+ID4gICAgICAgfQ0KPiA+IGRpZmYgLS1naXQg
YS9kcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMgYi9kcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJp
LmMNCj4gPiBpbmRleCA0Y2ExZDUxNjFiODIuLmU0YjA4Y2QxOTVmMyAxMDA2NDQNCj4gPiAtLS0g
YS9kcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMNCj4gPiArKysgYi9kcml2ZXJzL3RlZS9vcHRl
ZS9mZmFfYWJpLmMNCj4gPiBAQCAtMTIyLDE1ICsxMjIsMjEgQEAgc3RhdGljIGludCBvcHRlZV9z
aG1fcmVtX2ZmYV9oYW5kbGUoc3RydWN0IG9wdGVlICpvcHRlZSwgdTY0IGdsb2JhbF9pZCkNCj4g
PiAgICovDQo+ID4NCj4gPiAgc3RhdGljIHZvaWQgZnJvbV9tc2dfcGFyYW1fZmZhX21lbShzdHJ1
Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwLA0KPiA+IC0gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHUzMiBhdHRyLCBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFt
ICptcCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1MzIgYXR0ciwgY29u
c3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ICB7DQo+ID4gICAgICAgc3RydWN0IHRl
ZV9zaG0gKnNobSA9IE5VTEw7DQo+ID4gICAgICAgdTY0IG9mZnNfaGlnaCA9IDA7DQo+ID4gICAg
ICAgdTY0IG9mZnNfbG93ID0gMDsNCj4gPg0KPiA+ICsgICAgIGlmICh1cGRhdGVfb3V0KSB7DQo+
ID4gKyAgICAgICAgICAgICBpZiAoYXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX0ZNRU1fSU5Q
VVQpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCj4gPiArICAgICAgICAgICAg
IGdvdG8gb3V0Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gICAgICAgcC0+YXR0ciA9IFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOUFVUICsNCj4gPiAgICAgICAgICAgICAgICAg
YXR0ciAtIE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9JTlBVVDsNCj4gPiAtICAgICBwLT51Lm1l
bXJlZi5zaXplID0gbXAtPnUuZm1lbS5zaXplOw0KPiA+DQo+ID4gICAgICAgaWYgKG1wLT51LmZt
ZW0uZ2xvYmFsX2lkICE9IE9QVEVFX01TR19GTUVNX0lOVkFMSURfR0xPQkFMX0lEKQ0KPiA+ICAg
ICAgICAgICAgICAgc2htID0gb3B0ZWVfc2htX2Zyb21fZmZhX2hhbmRsZShvcHRlZSwgbXAtPnUu
Zm1lbS5nbG9iYWxfaWQpOw0KPiA+IEBAIC0xNDEsNiArMTQ3LDggQEAgc3RhdGljIHZvaWQgZnJv
bV9tc2dfcGFyYW1fZmZhX21lbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFt
ICpwLA0KPiA+ICAgICAgICAgICAgICAgb2Zmc19oaWdoID0gbXAtPnUuZm1lbS5vZmZzX2hpZ2g7
DQo+ID4gICAgICAgfQ0KPiA+ICAgICAgIHAtPnUubWVtcmVmLnNobV9vZmZzID0gb2Zmc19sb3cg
fCBvZmZzX2hpZ2ggPDwgMzI7DQo+ID4gK291dDoNCj4gPiArICAgICBwLT51Lm1lbXJlZi5zaXpl
ID0gbXAtPnUuZm1lbS5zaXplOw0KPiA+ICB9DQo+ID4NCj4gPiAgLyoqDQo+ID4gQEAgLTE1MCwx
MiArMTU4LDE0IEBAIHN0YXRpYyB2b2lkIGZyb21fbXNnX3BhcmFtX2ZmYV9tZW0oc3RydWN0IG9w
dGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAqcCwNCj4gPiAgICogQHBhcmFtczogIHN1YnN5
c3RlbSBpbnRlcm5hbCBwYXJhbWV0ZXIgcmVwcmVzZW50YXRpb24NCj4gPiAgICogQG51bV9wYXJh
bXM6ICAgICAgbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBwYXJhbWV0ZXIgYXJyYXlzDQo+ID4g
ICAqIEBtc2dfcGFyYW1zOiAgICAgIE9QVEVFX01TRyBwYXJhbWV0ZXJzDQo+ID4gKyAqIEB1cGRh
dGVfb3V0OiB1cGRhdGUgcGFyYW1ldGVyIGZvciBvdXRwdXQgb25seQ0KPiA+ICAgKg0KPiA+ICAg
KiBSZXR1cm5zIDAgb24gc3VjY2VzcyBvciA8MCBvbiBmYWlsdXJlDQo+ID4gICAqLw0KPiA+ICBz
dGF0aWMgaW50IG9wdGVlX2ZmYV9mcm9tX21zZ19wYXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0K
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX3BhcmFtICpw
YXJhbXMsIHNpemVfdCBudW1fcGFyYW1zLA0KPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptc2dfcGFyYW1zKQ0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3Bh
cmFtICptc2dfcGFyYW1zLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBi
b29sIHVwZGF0ZV9vdXQpDQo+ID4gIHsNCj4gPiAgICAgICBzaXplX3QgbjsNCj4gPg0KPiA+IEBA
IC0xNjYsMTggKzE3NiwyMCBAQCBzdGF0aWMgaW50IG9wdGVlX2ZmYV9mcm9tX21zZ19wYXJhbShz
dHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+DQo+ID4gICAgICAgICAgICAgICBzd2l0Y2ggKGF0dHIp
IHsNCj4gPiAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9OT05FOg0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlX291dCkNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgcC0+YXR0
ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTk9ORTsNCj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgbWVtc2V0KCZwLT51LCAwLCBzaXplb2YocC0+dSkpOw0KPiA+ICAgICAgICAgICAgICAg
ICAgICAgICBicmVhazsNCj4gPiAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQ
RV9WQUxVRV9JTlBVVDoNCj4gPiAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQ
RV9WQUxVRV9PVVRQVVQ6DQo+ID4gICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZ
UEVfVkFMVUVfSU5PVVQ6DQo+ID4gLSAgICAgICAgICAgICAgICAgICAgIG9wdGVlX2Zyb21fbXNn
X3BhcmFtX3ZhbHVlKHAsIGF0dHIsIG1wKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgb3B0
ZWVfZnJvbV9tc2dfcGFyYW1fdmFsdWUocCwgYXR0ciwgbXAsIHVwZGF0ZV9vdXQpOw0KPiA+ICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiAgICAgICAgICAgICAgIGNhc2UgT1BURUVf
TVNHX0FUVFJfVFlQRV9GTUVNX0lOUFVUOg0KPiA+ICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9N
U0dfQVRUUl9UWVBFX0ZNRU1fT1VUUFVUOg0KPiA+ICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9N
U0dfQVRUUl9UWVBFX0ZNRU1fSU5PVVQ6DQo+ID4gLSAgICAgICAgICAgICAgICAgICAgIGZyb21f
bXNnX3BhcmFtX2ZmYV9tZW0ob3B0ZWUsIHAsIGF0dHIsIG1wKTsNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgZnJvbV9tc2dfcGFyYW1fZmZhX21lbShvcHRlZSwgcCwgYXR0ciwgbXAsIHVwZGF0
ZV9vdXQpOw0KPiA+ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiAgICAgICAgICAg
ICAgIGRlZmF1bHQ6DQo+ID4gICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0K
PiA+IEBAIC0xODgsMTAgKzIwMCwxNiBAQCBzdGF0aWMgaW50IG9wdGVlX2ZmYV9mcm9tX21zZ19w
YXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ICB9DQo+ID4NCj4gPiAgc3RhdGljIGludCB0
b19tc2dfcGFyYW1fZmZhX21lbShzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCwNCj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwKQ0KPiA+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnAs
IGJvb2wgdXBkYXRlX291dCkNCj4gPiAgew0KPiA+ICAgICAgIHN0cnVjdCB0ZWVfc2htICpzaG0g
PSBwLT51Lm1lbXJlZi5zaG07DQo+ID4NCj4gPiArICAgICBpZiAodXBkYXRlX291dCkgew0KPiA+
ICsgICAgICAgICAgICAgaWYgKHAtPmF0dHIgPT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9N
RU1SRUZfSU5QVVQpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KPiA+ICsg
ICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiAgICAgICBtcC0+
YXR0ciA9IE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9JTlBVVCArIHAtPmF0dHIgLQ0KPiA+ICAg
ICAgICAgICAgICAgICAgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQ7DQo+
ID4NCj4gPiBAQCAtMjExLDYgKzIyOSw3IEBAIHN0YXRpYyBpbnQgdG9fbXNnX3BhcmFtX2ZmYV9t
ZW0oc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gICAgICAgICAgICAgICBtZW1zZXQo
Jm1wLT51LCAwLCBzaXplb2YobXAtPnUpKTsNCj4gPiAgICAgICAgICAgICAgIG1wLT51LmZtZW0u
Z2xvYmFsX2lkID0gT1BURUVfTVNHX0ZNRU1fSU5WQUxJRF9HTE9CQUxfSUQ7DQo+ID4gICAgICAg
fQ0KPiA+ICtvdXQ6DQo+ID4gICAgICAgbXAtPnUuZm1lbS5zaXplID0gcC0+dS5tZW1yZWYuc2l6
ZTsNCj4gPg0KPiA+ICAgICAgIHJldHVybiAwOw0KPiA+IEBAIC0yMjIsMTMgKzI0MSwxNSBAQCBz
dGF0aWMgaW50IHRvX21zZ19wYXJhbV9mZmFfbWVtKHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1w
LA0KPiA+ICAgKiBAb3B0ZWU6ICAgbWFpbiBzZXJ2aWNlIHN0cnVjdA0KPiA+ICAgKiBAbXNnX3Bh
cmFtczogICAgICBPUFRFRV9NU0cgcGFyYW1ldGVycw0KPiA+ICAgKiBAbnVtX3BhcmFtczogICAg
ICBudW1iZXIgb2YgZWxlbWVudHMgaW4gdGhlIHBhcmFtZXRlciBhcnJheXMNCj4gPiAtICogQHBh
cmFtczogIHN1YnN5c3RlbSBpdG5lcm5hbCBwYXJhbWV0ZXIgcmVwcmVzZW50YXRpb24NCj4gPiAr
ICogQHBhcmFtczogIHN1YnN5c3RlbSBpbnRlcm5hbCBwYXJhbWV0ZXIgcmVwcmVzZW50YXRpb24N
Cj4gPiArICogQHVwZGF0ZV9vdXQ6IHVwZGF0ZSBwYXJhbWV0ZXIgZm9yIG91dHB1dCBvbmx5DQo+
ID4gICAqIFJldHVybnMgMCBvbiBzdWNjZXNzIG9yIDwwIG9uIGZhaWx1cmUNCj4gPiAgICovDQo+
ID4gIHN0YXRpYyBpbnQgb3B0ZWVfZmZhX3RvX21zZ19wYXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVl
LA0KPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IG9wdGVlX21zZ19w
YXJhbSAqbXNnX3BhcmFtcywNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNp
emVfdCBudW1fcGFyYW1zLA0KPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLA0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ICB7DQo+ID4gICAgICAg
c2l6ZV90IG47DQo+ID4NCj4gPiBAQCAtMjM4LDE4ICsyNTksMjAgQEAgc3RhdGljIGludCBvcHRl
ZV9mZmFfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4NCj4gPiAgICAgICAg
ICAgICAgIHN3aXRjaCAocC0+YXR0cikgew0KPiA+ICAgICAgICAgICAgICAgY2FzZSBURUVfSU9D
VExfUEFSQU1fQVRUUl9UWVBFX05PTkU6DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGlmICh1
cGRhdGVfb3V0KQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+
ICAgICAgICAgICAgICAgICAgICAgICBtcC0+YXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZ
UEVfTk9ORTsNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgbWVtc2V0KCZtcC0+dSwgMCwgc2l6
ZW9mKG1wLT51KSk7DQo+ID4gICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICAgICAg
ICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX0lOUFVUOg0KPiA+
ICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX09VVFBV
VDoNCj4gPiAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxV
RV9JTk9VVDoNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgb3B0ZWVfdG9fbXNnX3BhcmFtX3Zh
bHVlKG1wLCBwKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAgb3B0ZWVfdG9fbXNnX3BhcmFt
X3ZhbHVlKG1wLCBwLCB1cGRhdGVfb3V0KTsNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgYnJl
YWs7DQo+ID4gICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVN
UkVGX0lOUFVUOg0KPiA+ICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9U
WVBFX01FTVJFRl9PVVRQVVQ6DQo+ID4gICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJB
TV9BVFRSX1RZUEVfTUVNUkVGX0lOT1VUOg0KPiA+IC0gICAgICAgICAgICAgICAgICAgICBpZiAo
dG9fbXNnX3BhcmFtX2ZmYV9tZW0obXAsIHApKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBp
ZiAodG9fbXNnX3BhcmFtX2ZmYV9tZW0obXAsIHAsIHVwZGF0ZV9vdXQpKQ0KPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiA+ICAgICAgICAgICAgICAg
ICAgICAgICBicmVhazsNCj4gPiAgICAgICAgICAgICAgIGRlZmF1bHQ6DQo+DQo+IENhbiB3ZSBy
YXRoZXIgaGFuZGxlIGl0IGFzIGZvbGxvd3MgdG8gaW1wcm92ZSBjb2RlIHJlYWRhYmlsaXR5IGFu
ZA0KPiBtYWludGFpbmVuY2UgbG9uZyB0ZXJtPyBEaXR0byBmb3IgYWxsIG90aGVyIHBsYWNlcy4N
Cj4NCj4gc3RhdGljIGludCBvcHRlZV9mZmFfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0
ZWUsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0ZWVfbXNn
X3BhcmFtICptc2dfcGFyYW1zLA0KPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c2l6ZV90IG51bV9wYXJhbXMsDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsDQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpDQo+IHsNCj4gICAgICAgICBzaXplX3QgbjsNCj4N
Cj4gICAgICAgICBmb3IgKG4gPSAwOyBuIDwgbnVtX3BhcmFtczsgbisrKSB7DQo+ICAgICAgICAg
ICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwID0gcGFyYW1zICsgbjsNCj4gICAgICAg
ICAgICAgICAgIHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wID0gbXNnX3BhcmFtcyArIG47DQo+
DQo+ICAgICAgICAgICAgICAgICBpZiAodXBkYXRlX291dCAmJiAocC0+YXR0ciA9PSBURUVfSU9D
VExfUEFSQU1fQVRUUl9UWVBFX05PTkUgfHwNCj4gICAgICAgICAgICAgICAgICAgICAgcC0+YXR0
ciA9PSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX0lOUFVUIHx8DQo+ICAgICAgICAg
ICAgICAgICAgICAgIHAtPmF0dHIgPT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZf
SU5QVVQpKQ0KPiAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KDQpZb3UncmUgbWlzc2lu
ZyB1cGRhdGluZyB0aGUgbGVuZ3RoIGZpZWxkIGZvciBtZW1yZWZzLg0KDQpDaGVlcnMsDQpKZW5z
DQoNCj4NCj4gICAgICAgICAgICAgICAgIHN3aXRjaCAocC0+YXR0cikgew0KPiAgICAgICAgICAg
ICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX05PTkU6DQo+ICAgICAgICAgICAg
ICAgICAgICAgICAgIG1wLT5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOw0K
PiAgICAgICAgICAgICAgICAgICAgICAgICBtZW1zZXQoJm1wLT51LCAwLCBzaXplb2YobXAtPnUp
KTsNCj4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICAgICAgICAgICAgICAgICBj
YXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5QVVQ6DQo+ICAgICAgICAgICAg
ICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUOg0KPiAgICAg
ICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX0lOT1VUOg0K
PiAgICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV90b19tc2dfcGFyYW1fdmFsdWUobXAsIHAp
Ow0KPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gICAgICAgICAgICAgICAgIGNh
c2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQ6DQo+ICAgICAgICAgICAg
ICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVDoNCj4gICAg
ICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5PVVQ6
DQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b19tc2dfcGFyYW1fZmZhX21lbShtcCwg
cCkpDQo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAgICAgICAgICAgICAgICAgZGVmYXVs
dDoNCj4gICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ICAgICAgICAg
ICAgICAgICB9DQo+ICAgICAgICAgfQ0KPg0KPiAgICAgICAgIHJldHVybiAwOw0KPiB9DQo+DQo+
IC1TdW1pdA0KPg0KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9vcHRlZS9vcHRlZV9wcml2
YXRlLmggYi9kcml2ZXJzL3RlZS9vcHRlZS9vcHRlZV9wcml2YXRlLmgNCj4gPiBpbmRleCBkYzBm
MzU1ZWY3MmEuLjIwZWRhNTA4ZGJhYyAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL3RlZS9vcHRl
ZS9vcHRlZV9wcml2YXRlLmgNCj4gPiArKysgYi9kcml2ZXJzL3RlZS9vcHRlZS9vcHRlZV9wcml2
YXRlLmgNCj4gPiBAQCAtMTg1LDEwICsxODUsMTIgQEAgc3RydWN0IG9wdGVlX29wcyB7DQo+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCBzeXN0ZW1fdGhyZWFkKTsNCj4gPiAg
ICAgICBpbnQgKCp0b19tc2dfcGFyYW0pKHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4gICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptc2dfcGFyYW1zLA0K
PiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bV9wYXJhbXMsIGNvbnN0IHN0
cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcyk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICBz
aXplX3QgbnVtX3BhcmFtcywgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLA0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KTsNCj4gPiAgICAgICBpbnQg
KCpmcm9tX21zZ19wYXJhbSkoc3RydWN0IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAq
cGFyYW1zLA0KPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgbnVtX3BhcmFt
cywNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21z
Z19wYXJhbSAqbXNnX3BhcmFtcyk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMsDQo+ID4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCk7DQo+ID4gIH07DQo+ID4NCj4gPiAgLyoq
DQo+ID4gQEAgLTMxNiwyMyArMzE4LDM1IEBAIHZvaWQgb3B0ZWVfcmVsZWFzZShzdHJ1Y3QgdGVl
X2NvbnRleHQgKmN0eCk7DQo+ID4gIHZvaWQgb3B0ZWVfcmVsZWFzZV9zdXBwKHN0cnVjdCB0ZWVf
Y29udGV4dCAqY3R4KTsNCj4gPg0KPiA+ICBzdGF0aWMgaW5saW5lIHZvaWQgb3B0ZWVfZnJvbV9t
c2dfcGFyYW1fdmFsdWUoc3RydWN0IHRlZV9wYXJhbSAqcCwgdTMyIGF0dHIsDQo+ID4gLSAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0ZWVf
bXNnX3BhcmFtICptcCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wLA0KPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ICB7
DQo+ID4gLSAgICAgcC0+YXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5Q
VVQgKw0KPiA+IC0gICAgICAgICAgICAgICBhdHRyIC0gT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxV
RV9JTlBVVDsNCj4gPiAtICAgICBwLT51LnZhbHVlLmEgPSBtcC0+dS52YWx1ZS5hOw0KPiA+IC0g
ICAgIHAtPnUudmFsdWUuYiA9IG1wLT51LnZhbHVlLmI7DQo+ID4gLSAgICAgcC0+dS52YWx1ZS5j
ID0gbXAtPnUudmFsdWUuYzsNCj4gPiArICAgICBpZiAoIXVwZGF0ZV9vdXQpDQo+ID4gKyAgICAg
ICAgICAgICBwLT5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTlBVVCAr
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgYXR0ciAtIE9QVEVFX01TR19BVFRSX1RZUEVf
VkFMVUVfSU5QVVQ7DQo+ID4gKw0KPiA+ICsgICAgIGlmIChhdHRyID09IE9QVEVFX01TR19BVFRS
X1RZUEVfVkFMVUVfT1VUUFVUIHx8DQo+ID4gKyAgICAgICAgIGF0dHIgPT0gT1BURUVfTVNHX0FU
VFJfVFlQRV9WQUxVRV9JTk9VVCB8fCAhdXBkYXRlX291dCkgew0KPiA+ICsgICAgICAgICAgICAg
cC0+dS52YWx1ZS5hID0gbXAtPnUudmFsdWUuYTsNCj4gPiArICAgICAgICAgICAgIHAtPnUudmFs
dWUuYiA9IG1wLT51LnZhbHVlLmI7DQo+ID4gKyAgICAgICAgICAgICBwLT51LnZhbHVlLmMgPSBt
cC0+dS52YWx1ZS5jOw0KPiA+ICsgICAgIH0NCj4gPiAgfQ0KPiA+DQo+ID4gIHN0YXRpYyBpbmxp
bmUgdm9pZCBvcHRlZV90b19tc2dfcGFyYW1fdmFsdWUoc3RydWN0IG9wdGVlX21zZ19wYXJhbSAq
bXAsDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
c3RydWN0IHRlZV9wYXJhbSAqcCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwLA0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4gPiAgew0KPiA+
IC0gICAgIG1wLT5hdHRyID0gT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9JTlBVVCArIHAtPmF0
dHIgLQ0KPiA+IC0gICAgICAgICAgICAgICAgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxV
RV9JTlBVVDsNCj4gPiAtICAgICBtcC0+dS52YWx1ZS5hID0gcC0+dS52YWx1ZS5hOw0KPiA+IC0g
ICAgIG1wLT51LnZhbHVlLmIgPSBwLT51LnZhbHVlLmI7DQo+ID4gLSAgICAgbXAtPnUudmFsdWUu
YyA9IHAtPnUudmFsdWUuYzsNCj4gPiArICAgICBpZiAoIXVwZGF0ZV9vdXQpDQo+ID4gKyAgICAg
ICAgICAgICBtcC0+YXR0ciA9IE9QVEVFX01TR19BVFRSX1RZUEVfVkFMVUVfSU5QVVQgKyBwLT5h
dHRyIC0NCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgVEVFX0lPQ1RMX1BBUkFNX0FUVFJf
VFlQRV9WQUxVRV9JTlBVVDsNCj4gPiArDQo+ID4gKyAgICAgaWYgKHAtPmF0dHIgPT0gVEVFX0lP
Q1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9PVVRQVVQgfHwNCj4gPiArICAgICAgICAgcC0+YXR0
ciA9PSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX0lOT1VUIHx8ICF1cGRhdGVfb3V0
KSB7DQo+ID4gKyAgICAgICAgICAgICBtcC0+dS52YWx1ZS5hID0gcC0+dS52YWx1ZS5hOw0KPiA+
ICsgICAgICAgICAgICAgbXAtPnUudmFsdWUuYiA9IHAtPnUudmFsdWUuYjsNCj4gPiArICAgICAg
ICAgICAgIG1wLT51LnZhbHVlLmMgPSBwLT51LnZhbHVlLmM7DQo+ID4gKyAgICAgfQ0KPiA+ICB9
DQo+ID4NCj4gPiAgdm9pZCBvcHRlZV9jcV9pbml0KHN0cnVjdCBvcHRlZV9jYWxsX3F1ZXVlICpj
cSwgaW50IHRocmVhZF9jb3VudCk7DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdGVlL29wdGVl
L3JwYy5jIGIvZHJpdmVycy90ZWUvb3B0ZWUvcnBjLmMNCj4gPiBpbmRleCBlYmJiZDQyYjBlM2Uu
LjU4MGU2YjliMDYwNiAxMDA2NDQNCj4gPiAtLS0gYS9kcml2ZXJzL3RlZS9vcHRlZS9ycGMuYw0K
PiA+ICsrKyBiL2RyaXZlcnMvdGVlL29wdGVlL3JwYy5jDQo+ID4gQEAgLTYzLDcgKzYzLDcgQEAg
c3RhdGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX2NtZF9pMmNfdHJhbnNmZXIoc3RydWN0IHRlZV9j
b250ZXh0ICpjdHgsDQo+ID4gICAgICAgfQ0KPiA+DQo+ID4gICAgICAgaWYgKG9wdGVlLT5vcHMt
PmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbXMsIGFyZy0+bnVtX3BhcmFtcywNCj4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMpKQ0KPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPnBhcmFtcywgZmFsc2UgLyohdXBk
YXRlX291dCovKSkNCj4gPiAgICAgICAgICAgICAgIGdvdG8gYmFkOw0KPiA+DQo+ID4gICAgICAg
Zm9yIChpID0gMDsgaSA8IGFyZy0+bnVtX3BhcmFtczsgaSsrKSB7DQo+ID4gQEAgLTEwNyw3ICsx
MDcsOCBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfY21kX2kyY190cmFuc2ZlcihzdHJ1
Y3QgdGVlX2NvbnRleHQgKmN0eCwNCj4gPiAgICAgICB9IGVsc2Ugew0KPiA+ICAgICAgICAgICAg
ICAgcGFyYW1zWzNdLnUudmFsdWUuYSA9IG1zZy5sZW47DQo+ID4gICAgICAgICAgICAgICBpZiAo
b3B0ZWUtPm9wcy0+dG9fbXNnX3BhcmFtKG9wdGVlLCBhcmctPnBhcmFtcywNCj4gPiAtICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJh
bXMpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmct
Pm51bV9wYXJhbXMsIHBhcmFtcywNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgdHJ1ZSAvKnVwZGF0ZV9vdXQqLykpDQo+ID4gICAgICAgICAgICAgICAgICAg
ICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiAgICAgICAgICAg
ICAgIGVsc2UNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5yZXQgPSBURUVDX1NVQ0NF
U1M7DQo+ID4gQEAgLTE4OCw2ICsxODksNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNf
Y21kX3dhaXQoc3RydWN0IG9wdGVlX21zZ19hcmcgKmFyZykNCj4gPiAgc3RhdGljIHZvaWQgaGFu
ZGxlX3JwY19zdXBwX2NtZChzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwgc3RydWN0IG9wdGVlICpv
cHRlZSwNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0ZWVfbXNn
X2FyZyAqYXJnKQ0KPiA+ICB7DQo+ID4gKyAgICAgYm9vbCB1cGRhdGVfb3V0ID0gZmFsc2U7DQo+
ID4gICAgICAgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zOw0KPiA+DQo+ID4gICAgICAgYXJnLT5y
ZXRfb3JpZ2luID0gVEVFQ19PUklHSU5fQ09NTVM7DQo+ID4gQEAgLTIwMCwxNSArMjAyLDIxIEBA
IHN0YXRpYyB2b2lkIGhhbmRsZV9ycGNfc3VwcF9jbWQoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgs
IHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4gICAgICAgfQ0KPiA+DQo+ID4gICAgICAgaWYgKG9w
dGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbXMsIGFyZy0+bnVtX3BhcmFtcywN
Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMpKSB7
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+cGFyYW1zLCB1
cGRhdGVfb3V0KSkgew0KPiA+ICAgICAgICAgICAgICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JB
RF9QQVJBTUVURVJTOw0KPiA+ICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gICAgICAgfQ0K
PiA+DQo+ID4gICAgICAgYXJnLT5yZXQgPSBvcHRlZV9zdXBwX3RocmRfcmVxKGN0eCwgYXJnLT5j
bWQsIGFyZy0+bnVtX3BhcmFtcywgcGFyYW1zKTsNCj4gPg0KPiA+ICsgICAgIC8qDQo+ID4gKyAg
ICAgICogU3BlY2lhbCB0cmVhdG1lbnQgZm9yIE9QVEVFX1JQQ19DTURfU0hNX0FMTE9DIHNpbmNl
IGlucHV0IGlzIGENCj4gPiArICAgICAgKiB2YWx1ZSB0eXBlLCBidXQgdGhlIG91dHB1dCBpcyBh
IG1lbXJlZiB0eXBlLg0KPiA+ICsgICAgICAqLw0KPiA+ICsgICAgIGlmIChhcmctPmNtZCAhPSBP
UFRFRV9SUENfQ01EX1NITV9BTExPQykNCj4gPiArICAgICAgICAgICAgIHVwZGF0ZV9vdXQgPSB0
cnVlOw0KPiA+ICAgICAgIGlmIChvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0ZWUsIGFyZy0+
cGFyYW1zLCBhcmctPm51bV9wYXJhbXMsDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBwYXJhbXMpKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
cGFyYW1zLCB1cGRhdGVfb3V0KSkNCj4gPiAgICAgICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19F
UlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiAgb3V0Og0KPiA+ICAgICAgIGtmcmVlKHBhcmFtcyk7
DQo+ID4gQEAgLTI3MCw3ICsyNzgsNyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfcnBt
Yl9wcm9iZV9yZXNldChzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwNCj4gPg0KPiA+ICAgICAgIGlm
IChhcmctPm51bV9wYXJhbXMgIT0gQVJSQVlfU0laRShwYXJhbXMpIHx8DQo+ID4gICAgICAgICAg
IG9wdGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbXMsIGFyZy0+bnVtX3BhcmFt
cywNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMp
IHx8DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+cGFyYW1z
LCBmYWxzZSAvKiF1cGRhdGVfb3V0Ki8pIHx8DQo+ID4gICAgICAgICAgIHBhcmFtc1swXS5hdHRy
ICE9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUKSB7DQo+ID4gICAgICAg
ICAgICAgICBhcmctPnJldCA9IFRFRUNfRVJST1JfQkFEX1BBUkFNRVRFUlM7DQo+ID4gICAgICAg
ICAgICAgICByZXR1cm47DQo+ID4gQEAgLTI4MCw3ICsyODgsOCBAQCBzdGF0aWMgdm9pZCBoYW5k
bGVfcnBjX2Z1bmNfcnBtYl9wcm9iZV9yZXNldChzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwNCj4g
PiAgICAgICBwYXJhbXNbMF0udS52YWx1ZS5iID0gMDsNCj4gPiAgICAgICBwYXJhbXNbMF0udS52
YWx1ZS5jID0gMDsNCj4gPiAgICAgICBpZiAob3B0ZWUtPm9wcy0+dG9fbXNnX3BhcmFtKG9wdGVl
LCBhcmctPnBhcmFtcywNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFy
Zy0+bnVtX3BhcmFtcywgcGFyYW1zKSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMsDQo+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB0cnVlIC8qdXBkYXRlX291dCovKSkgew0KPiA+ICAgICAgICAgICAg
ICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ICAgICAgICAgICAg
ICAgcmV0dXJuOw0KPiA+ICAgICAgIH0NCj4gPiBAQCAtMzI0LDcgKzMzMyw3IEBAIHN0YXRpYyB2
b2lkIGhhbmRsZV9ycGNfZnVuY19ycG1iX3Byb2JlX25leHQoc3RydWN0IHRlZV9jb250ZXh0ICpj
dHgsDQo+ID4NCj4gPiAgICAgICBpZiAoYXJnLT5udW1fcGFyYW1zICE9IEFSUkFZX1NJWkUocGFy
YW1zKSB8fA0KPiA+ICAgICAgICAgICBvcHRlZS0+b3BzLT5mcm9tX21zZ19wYXJhbShvcHRlZSwg
cGFyYW1zLCBhcmctPm51bV9wYXJhbXMsDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGFyZy0+cGFyYW1zKSB8fA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBhcmctPnBhcmFtcywgZmFsc2UgLyohdXBkYXRlX291dCovKSB8fA0KPiA+ICAg
ICAgICAgICBwYXJhbXNbMF0uYXR0ciAhPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVF
X09VVFBVVCB8fA0KPiA+ICAgICAgICAgICBwYXJhbXNbMV0uYXR0ciAhPSBURUVfSU9DVExfUEFS
QU1fQVRUUl9UWVBFX01FTVJFRl9PVVRQVVQpIHsNCj4gPiAgICAgICAgICAgICAgIGFyZy0+cmV0
ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiBAQCAtMzU4LDcgKzM2Nyw4IEBAIHN0
YXRpYyB2b2lkIGhhbmRsZV9ycGNfZnVuY19ycG1iX3Byb2JlX25leHQoc3RydWN0IHRlZV9jb250
ZXh0ICpjdHgsDQo+ID4gICAgICAgcGFyYW1zWzBdLnUudmFsdWUuYiA9IHJkZXYtPmRlc2NyLmNh
cGFjaXR5Ow0KPiA+ICAgICAgIHBhcmFtc1swXS51LnZhbHVlLmMgPSByZGV2LT5kZXNjci5yZWxp
YWJsZV93cl9jb3VudDsNCj4gPiAgICAgICBpZiAob3B0ZWUtPm9wcy0+dG9fbXNnX3BhcmFtKG9w
dGVlLCBhcmctPnBhcmFtcywNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGFyZy0+bnVtX3BhcmFtcywgcGFyYW1zKSkgew0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMsDQo+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB0cnVlIC8qdXBkYXRlX291dCovKSkgew0KPiA+ICAgICAgICAg
ICAgICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ICAgICAgICAg
ICAgICAgcmV0dXJuOw0KPiA+ICAgICAgIH0NCj4gPiBAQCAtMzg0LDcgKzM5NCw3IEBAIHN0YXRp
YyB2b2lkIGhhbmRsZV9ycGNfZnVuY19ycG1iX2ZyYW1lcyhzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0
eCwNCj4gPg0KPiA+ICAgICAgIGlmIChhcmctPm51bV9wYXJhbXMgIT0gQVJSQVlfU0laRShwYXJh
bXMpIHx8DQo+ID4gICAgICAgICAgIG9wdGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVlLCBw
YXJhbXMsIGFyZy0+bnVtX3BhcmFtcywNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYXJnLT5wYXJhbXMpIHx8DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGFyZy0+cGFyYW1zLCBmYWxzZSAvKiF1cGRhdGVfb3V0Ki8pIHx8DQo+ID4gICAg
ICAgICAgIHBhcmFtc1swXS5hdHRyICE9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVG
X0lOUFVUIHx8DQo+ID4gICAgICAgICAgIHBhcmFtc1sxXS5hdHRyICE9IFRFRV9JT0NUTF9QQVJB
TV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVCkgew0KPiA+ICAgICAgICAgICAgICAgYXJnLT5yZXQg
PSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+IEBAIC00MDEsNyArNDExLDggQEAgc3Rh
dGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX3JwbWJfZnJhbWVzKHN0cnVjdCB0ZWVfY29udGV4dCAq
Y3R4LA0KPiA+ICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gICAgICAgfQ0KPiA+ICAgICAg
IGlmIChvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0ZWUsIGFyZy0+cGFyYW1zLA0KPiA+IC0g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMp
KSB7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPm51bV9wYXJh
bXMsIHBhcmFtcywNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUg
Lyp1cGRhdGVfb3V0Ki8pKSB7DQo+ID4gICAgICAgICAgICAgICBhcmctPnJldCA9IFRFRUNfRVJS
T1JfQkFEX1BBUkFNRVRFUlM7DQo+ID4gICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiAgICAg
ICB9DQo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdGVlL29wdGVlL3NtY19hYmkuYyBiL2RyaXZl
cnMvdGVlL29wdGVlL3NtY19hYmkuYw0KPiA+IGluZGV4IDE2NWZhZGQ5YWJjOS4uY2ZkYWUyNjY1
NDhiIDEwMDY0NA0KPiA+IC0tLSBhL2RyaXZlcnMvdGVlL29wdGVlL3NtY19hYmkuYw0KPiA+ICsr
KyBiL2RyaXZlcnMvdGVlL29wdGVlL3NtY19hYmkuYw0KPiA+IEBAIC04MSwyMCArODEsMjYgQEAg
c3RhdGljIGludCBvcHRlZV9jcHVocF9kaXNhYmxlX3BjcHVfaXJxKHVuc2lnbmVkIGludCBjcHUp
DQo+ID4gICAqLw0KPiA+DQo+ID4gIHN0YXRpYyBpbnQgZnJvbV9tc2dfcGFyYW1fdG1wX21lbShz
dHJ1Y3QgdGVlX3BhcmFtICpwLCB1MzIgYXR0ciwNCj4gPiAtICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wKQ0KPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAs
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpDQo+
ID4gIHsNCj4gPiAgICAgICBzdHJ1Y3QgdGVlX3NobSAqc2htOw0KPiA+ICAgICAgIHBoeXNfYWRk
cl90IHBhOw0KPiA+ICAgICAgIGludCByYzsNCj4gPg0KPiA+ICsgICAgIGlmICh1cGRhdGVfb3V0
KSB7DQo+ID4gKyAgICAgICAgICAgICBpZiAoYXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX1RN
RU1fSU5QVVQpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwOw0KPiA+ICsgICAg
ICAgICAgICAgZ290byBvdXQ7DQo+ID4gKyAgICAgfQ0KPiA+ICsNCj4gPiAgICAgICBwLT5hdHRy
ID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQgKw0KPiA+ICAgICAgICAg
ICAgICAgICBhdHRyIC0gT1BURUVfTVNHX0FUVFJfVFlQRV9UTUVNX0lOUFVUOw0KPiA+IC0gICAg
IHAtPnUubWVtcmVmLnNpemUgPSBtcC0+dS50bWVtLnNpemU7DQo+ID4gICAgICAgc2htID0gKHN0
cnVjdCB0ZWVfc2htICopKHVuc2lnbmVkIGxvbmcpbXAtPnUudG1lbS5zaG1fcmVmOw0KPiA+ICAg
ICAgIGlmICghc2htKSB7DQo+ID4gICAgICAgICAgICAgICBwLT51Lm1lbXJlZi5zaG1fb2ZmcyA9
IDA7DQo+ID4gICAgICAgICAgICAgICBwLT51Lm1lbXJlZi5zaG0gPSBOVUxMOw0KPiA+IC0gICAg
ICAgICAgICAgcmV0dXJuIDA7DQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiAgICAg
ICB9DQo+ID4NCj4gPiAgICAgICByYyA9IHRlZV9zaG1fZ2V0X3BhKHNobSwgMCwgJnBhKTsNCj4g
PiBAQCAtMTAzLDE4ICsxMDksMjUgQEAgc3RhdGljIGludCBmcm9tX21zZ19wYXJhbV90bXBfbWVt
KHN0cnVjdCB0ZWVfcGFyYW0gKnAsIHUzMiBhdHRyLA0KPiA+DQo+ID4gICAgICAgcC0+dS5tZW1y
ZWYuc2htX29mZnMgPSBtcC0+dS50bWVtLmJ1Zl9wdHIgLSBwYTsNCj4gPiAgICAgICBwLT51Lm1l
bXJlZi5zaG0gPSBzaG07DQo+ID4gLQ0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgcC0+dS5tZW1yZWYu
c2l6ZSA9IG1wLT51LnRtZW0uc2l6ZTsNCj4gPiAgICAgICByZXR1cm4gMDsNCj4gPiAgfQ0KPiA+
DQo+ID4gIHN0YXRpYyB2b2lkIGZyb21fbXNnX3BhcmFtX3JlZ19tZW0oc3RydWN0IHRlZV9wYXJh
bSAqcCwgdTMyIGF0dHIsDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29u
c3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXApDQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ICB7DQo+ID4g
ICAgICAgc3RydWN0IHRlZV9zaG0gKnNobTsNCj4gPg0KPiA+ICsgICAgIGlmICh1cGRhdGVfb3V0
KSB7DQo+ID4gKyAgICAgICAgICAgICBpZiAoYXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX1JN
RU1fSU5QVVQpDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCj4gPiArICAgICAg
ICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgIH0NCj4gPiArDQo+ID4gICAgICAgcC0+YXR0ciA9
IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOUFVUICsNCj4gPiAgICAgICAgICAg
ICAgICAgYXR0ciAtIE9QVEVFX01TR19BVFRSX1RZUEVfUk1FTV9JTlBVVDsNCj4gPiAtICAgICBw
LT51Lm1lbXJlZi5zaXplID0gbXAtPnUucm1lbS5zaXplOw0KPiA+ICAgICAgIHNobSA9IChzdHJ1
Y3QgdGVlX3NobSAqKSh1bnNpZ25lZCBsb25nKW1wLT51LnJtZW0uc2htX3JlZjsNCj4gPg0KPiA+
ICAgICAgIGlmIChzaG0pIHsNCj4gPiBAQCAtMTI0LDYgKzEzNyw4IEBAIHN0YXRpYyB2b2lkIGZy
b21fbXNnX3BhcmFtX3JlZ19tZW0oc3RydWN0IHRlZV9wYXJhbSAqcCwgdTMyIGF0dHIsDQo+ID4g
ICAgICAgICAgICAgICBwLT51Lm1lbXJlZi5zaG1fb2ZmcyA9IDA7DQo+ID4gICAgICAgICAgICAg
ICBwLT51Lm1lbXJlZi5zaG0gPSBOVUxMOw0KPiA+ICAgICAgIH0NCj4gPiArb3V0Og0KPiA+ICsg
ICAgIHAtPnUubWVtcmVmLnNpemUgPSBtcC0+dS5ybWVtLnNpemU7DQo+ID4gIH0NCj4gPg0KPiA+
ICAvKioNCj4gPiBAQCAtMTMzLDExICsxNDgsMTMgQEAgc3RhdGljIHZvaWQgZnJvbV9tc2dfcGFy
YW1fcmVnX21lbShzdHJ1Y3QgdGVlX3BhcmFtICpwLCB1MzIgYXR0ciwNCj4gPiAgICogQHBhcmFt
czogIHN1YnN5c3RlbSBpbnRlcm5hbCBwYXJhbWV0ZXIgcmVwcmVzZW50YXRpb24NCj4gPiAgICog
QG51bV9wYXJhbXM6ICAgICAgbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBwYXJhbWV0ZXIgYXJy
YXlzDQo+ID4gICAqIEBtc2dfcGFyYW1zOiAgICAgIE9QVEVFX01TRyBwYXJhbWV0ZXJzDQo+ID4g
KyAqIEB1cGRhdGVfb3V0OiAgICAgIHVwZGF0ZSBwYXJhbWV0ZXIgZm9yIG91dHB1dCBvbmx5DQo+
ID4gICAqIFJldHVybnMgMCBvbiBzdWNjZXNzIG9yIDwwIG9uIGZhaWx1cmUNCj4gPiAgICovDQo+
ID4gIHN0YXRpYyBpbnQgb3B0ZWVfZnJvbV9tc2dfcGFyYW0oc3RydWN0IG9wdGVlICpvcHRlZSwg
c3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLA0KPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHNpemVfdCBudW1fcGFyYW1zLA0KPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMpDQo+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXNnX3Bh
cmFtcywNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQp
DQo+ID4gIHsNCj4gPiAgICAgICBpbnQgcmM7DQo+ID4gICAgICAgc2l6ZV90IG47DQo+ID4gQEAg
LTE0OSwyNSArMTY2LDI3IEBAIHN0YXRpYyBpbnQgb3B0ZWVfZnJvbV9tc2dfcGFyYW0oc3RydWN0
IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLA0KPiA+DQo+ID4gICAgICAg
ICAgICAgICBzd2l0Y2ggKGF0dHIpIHsNCj4gPiAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNH
X0FUVFJfVFlQRV9OT05FOg0KPiA+ICsgICAgICAgICAgICAgICAgICAgICBpZiAodXBkYXRlX291
dCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiAgICAgICAg
ICAgICAgICAgICAgICAgcC0+YXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTk9ORTsN
Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgbWVtc2V0KCZwLT51LCAwLCBzaXplb2YocC0+dSkp
Ow0KPiA+ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiAgICAgICAgICAgICAgIGNh
c2UgT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9JTlBVVDoNCj4gPiAgICAgICAgICAgICAgIGNh
c2UgT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9PVVRQVVQ6DQo+ID4gICAgICAgICAgICAgICBj
YXNlIE9QVEVFX01TR19BVFRSX1RZUEVfVkFMVUVfSU5PVVQ6DQo+ID4gLSAgICAgICAgICAgICAg
ICAgICAgIG9wdGVlX2Zyb21fbXNnX3BhcmFtX3ZhbHVlKHAsIGF0dHIsIG1wKTsNCj4gPiArICAg
ICAgICAgICAgICAgICAgICAgb3B0ZWVfZnJvbV9tc2dfcGFyYW1fdmFsdWUocCwgYXR0ciwgbXAs
IHVwZGF0ZV9vdXQpOw0KPiA+ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiAgICAg
ICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9UTUVNX0lOUFVUOg0KPiA+ICAgICAg
ICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1RNRU1fT1VUUFVUOg0KPiA+ICAgICAg
ICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1RNRU1fSU5PVVQ6DQo+ID4gLSAgICAg
ICAgICAgICAgICAgICAgIHJjID0gZnJvbV9tc2dfcGFyYW1fdG1wX21lbShwLCBhdHRyLCBtcCk7
DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIHJjID0gZnJvbV9tc2dfcGFyYW1fdG1wX21lbShw
LCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+ID4gICAgICAgICAgICAgICAgICAgICAgIGlmIChy
YykNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmM7DQo+ID4gICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9N
U0dfQVRUUl9UWVBFX1JNRU1fSU5QVVQ6DQo+ID4gICAgICAgICAgICAgICBjYXNlIE9QVEVFX01T
R19BVFRSX1RZUEVfUk1FTV9PVVRQVVQ6DQo+ID4gICAgICAgICAgICAgICBjYXNlIE9QVEVFX01T
R19BVFRSX1RZUEVfUk1FTV9JTk9VVDoNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgZnJvbV9t
c2dfcGFyYW1fcmVnX21lbShwLCBhdHRyLCBtcCk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAg
IGZyb21fbXNnX3BhcmFtX3JlZ19tZW0ocCwgYXR0ciwgbXAsIHVwZGF0ZV9vdXQpOw0KPiA+ICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPg0KPiA+ICAgICAgICAgICAgICAgZGVmYXVs
dDoNCj4gPiBAQCAtMTc4LDIwICsxOTcsMjUgQEAgc3RhdGljIGludCBvcHRlZV9mcm9tX21zZ19w
YXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsDQo+ID4g
IH0NCj4gPg0KPiA+ICBzdGF0aWMgaW50IHRvX21zZ19wYXJhbV90bXBfbWVtKHN0cnVjdCBvcHRl
ZV9tc2dfcGFyYW0gKm1wLA0KPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0
IHN0cnVjdCB0ZWVfcGFyYW0gKnApDQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcCwgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ICB7DQo+ID4g
ICAgICAgaW50IHJjOw0KPiA+ICAgICAgIHBoeXNfYWRkcl90IHBhOw0KPiA+DQo+ID4gKyAgICAg
aWYgKHVwZGF0ZV9vdXQpIHsNCj4gPiArICAgICAgICAgICAgIGlmIChwLT5hdHRyID09IFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOUFVUKQ0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gMDsNCj4gPiArICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ICsgICAgIH0N
Cj4gPiArDQo+ID4gICAgICAgbXAtPmF0dHIgPSBPUFRFRV9NU0dfQVRUUl9UWVBFX1RNRU1fSU5Q
VVQgKyBwLT5hdHRyIC0NCj4gPiAgICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9BVFRS
X1RZUEVfTUVNUkVGX0lOUFVUOw0KPiA+DQo+ID4gICAgICAgbXAtPnUudG1lbS5zaG1fcmVmID0g
KHVuc2lnbmVkIGxvbmcpcC0+dS5tZW1yZWYuc2htOw0KPiA+IC0gICAgIG1wLT51LnRtZW0uc2l6
ZSA9IHAtPnUubWVtcmVmLnNpemU7DQo+ID4NCj4gPiAgICAgICBpZiAoIXAtPnUubWVtcmVmLnNo
bSkgew0KPiA+ICAgICAgICAgICAgICAgbXAtPnUudG1lbS5idWZfcHRyID0gMDsNCj4gPiAtICAg
ICAgICAgICAgIHJldHVybiAwOw0KPiA+ICsgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gICAg
ICAgfQ0KPiA+DQo+ID4gICAgICAgcmMgPSB0ZWVfc2htX2dldF9wYShwLT51Lm1lbXJlZi5zaG0s
IHAtPnUubWVtcmVmLnNobV9vZmZzLCAmcGEpOw0KPiA+IEBAIC0yMDEsMTkgKzIyNSwyNyBAQCBz
dGF0aWMgaW50IHRvX21zZ19wYXJhbV90bXBfbWVtKHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1w
LA0KPiA+ICAgICAgIG1wLT51LnRtZW0uYnVmX3B0ciA9IHBhOw0KPiA+ICAgICAgIG1wLT5hdHRy
IHw9IE9QVEVFX01TR19BVFRSX0NBQ0hFX1BSRURFRklORUQgPDwNCj4gPiAgICAgICAgICAgICAg
ICAgICBPUFRFRV9NU0dfQVRUUl9DQUNIRV9TSElGVDsNCj4gPiAtDQo+ID4gK291dDoNCj4gPiAr
ICAgICBtcC0+dS50bWVtLnNpemUgPSBwLT51Lm1lbXJlZi5zaXplOw0KPiA+ICAgICAgIHJldHVy
biAwOw0KPiA+ICB9DQo+ID4NCj4gPiAgc3RhdGljIGludCB0b19tc2dfcGFyYW1fcmVnX21lbShz
dHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCwNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwKQ0KPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnAsIGJvb2wgdXBkYXRlX291dCkNCj4g
PiAgew0KPiA+ICsgICAgIGlmICh1cGRhdGVfb3V0KSB7DQo+ID4gKyAgICAgICAgICAgICBpZiAo
cC0+YXR0ciA9PSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVCkNCj4gPiAr
ICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQo+ID4gKyAgICAgICAgICAgICBnb3RvIG91
dDsNCj4gPiArICAgICB9DQo+ID4gKw0KPiA+ICAgICAgIG1wLT5hdHRyID0gT1BURUVfTVNHX0FU
VFJfVFlQRV9STUVNX0lOUFVUICsgcC0+YXR0ciAtDQo+ID4gICAgICAgICAgICAgICAgICBURUVf
SU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVDsNCj4gPg0KPiA+ICAgICAgIG1wLT51
LnJtZW0uc2htX3JlZiA9ICh1bnNpZ25lZCBsb25nKXAtPnUubWVtcmVmLnNobTsNCj4gPiAtICAg
ICBtcC0+dS5ybWVtLnNpemUgPSBwLT51Lm1lbXJlZi5zaXplOw0KPiA+ICAgICAgIG1wLT51LnJt
ZW0ub2ZmcyA9IHAtPnUubWVtcmVmLnNobV9vZmZzOw0KPiA+ICtvdXQ6DQo+ID4gKyAgICAgbXAt
PnUucm1lbS5zaXplID0gcC0+dS5tZW1yZWYuc2l6ZTsNCj4gPiAgICAgICByZXR1cm4gMDsNCj4g
PiAgfQ0KPiA+DQo+ID4gQEAgLTIyMywxMSArMjU1LDEzIEBAIHN0YXRpYyBpbnQgdG9fbXNnX3Bh
cmFtX3JlZ19tZW0oc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gICAqIEBtc2dfcGFy
YW1zOiAgICAgIE9QVEVFX01TRyBwYXJhbWV0ZXJzDQo+ID4gICAqIEBudW1fcGFyYW1zOiAgICAg
IG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgcGFyYW1ldGVyIGFycmF5cw0KPiA+ICAgKiBAcGFy
YW1zOiAgc3Vic3lzdGVtIGl0bmVybmFsIHBhcmFtZXRlciByZXByZXNlbnRhdGlvbg0KPiA+ICsg
KiBAdXBkYXRlX291dDogICAgICB1cGRhdGUgcGFyYW1ldGVyIGZvciBvdXRwdXQgb25seQ0KPiA+
ICAgKiBSZXR1cm5zIDAgb24gc3VjY2VzcyBvciA8MCBvbiBmYWlsdXJlDQo+ID4gICAqLw0KPiA+
ICBzdGF0aWMgaW50IG9wdGVlX3RvX21zZ19wYXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptc2df
cGFyYW1zLA0KPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3QgbnVtX3BhcmFt
cywgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zKQ0KPiA+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzaXplX3QgbnVtX3BhcmFtcywgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAqcGFy
YW1zLA0KPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpDQo+
ID4gIHsNCj4gPiAgICAgICBpbnQgcmM7DQo+ID4gICAgICAgc2l6ZV90IG47DQo+ID4gQEAgLTIz
OCwyMSArMjcyLDIzIEBAIHN0YXRpYyBpbnQgb3B0ZWVfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRl
ZSAqb3B0ZWUsDQo+ID4NCj4gPiAgICAgICAgICAgICAgIHN3aXRjaCAocC0+YXR0cikgew0KPiA+
ICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX05PTkU6DQo+ID4g
KyAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRhdGVfb3V0KQ0KPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ICAgICAgICAgICAgICAgICAgICAgICBtcC0+YXR0
ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTk9ORTsNCj4gPiAgICAgICAgICAgICAgICAg
ICAgICAgbWVtc2V0KCZtcC0+dSwgMCwgc2l6ZW9mKG1wLT51KSk7DQo+ID4gICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOw0KPiA+ICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1f
QVRUUl9UWVBFX1ZBTFVFX0lOUFVUOg0KPiA+ICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExf
UEFSQU1fQVRUUl9UWVBFX1ZBTFVFX09VVFBVVDoNCj4gPiAgICAgICAgICAgICAgIGNhc2UgVEVF
X0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTk9VVDoNCj4gPiAtICAgICAgICAgICAgICAg
ICAgICAgb3B0ZWVfdG9fbXNnX3BhcmFtX3ZhbHVlKG1wLCBwKTsNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgb3B0ZWVfdG9fbXNnX3BhcmFtX3ZhbHVlKG1wLCBwLCB1cGRhdGVfb3V0KTsNCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gICAgICAgICAgICAgICBjYXNlIFRF
RV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOUFVUOg0KPiA+ICAgICAgICAgICAgICAg
Y2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9PVVRQVVQ6DQo+ID4gICAgICAg
ICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOT1VUOg0KPiA+
ICAgICAgICAgICAgICAgICAgICAgICBpZiAodGVlX3NobV9pc19keW5hbWljKHAtPnUubWVtcmVm
LnNobSkpDQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSB0b19tc2dfcGFy
YW1fcmVnX21lbShtcCwgcCk7DQo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMg
PSB0b19tc2dfcGFyYW1fcmVnX21lbShtcCwgcCwgdXBkYXRlX291dCk7DQo+ID4gICAgICAgICAg
ICAgICAgICAgICAgIGVsc2UNCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYyA9
IHRvX21zZ19wYXJhbV90bXBfbWVtKG1wLCBwKTsNCj4gPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICByYyA9IHRvX21zZ19wYXJhbV90bXBfbWVtKG1wLCBwLCB1cGRhdGVfb3V0KTsNCj4g
PiAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjKQ0KPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiByYzsNCj4gPiAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+
ID4gLS0NCj4gPiAyLjQzLjANCj4gPg0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QgLS0gbGluYXJvLW1tLXNp
Z0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1haWwgdG8gbGluYXJv
LW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
