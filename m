Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id CE373463430
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 30 Nov 2021 13:25:27 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id D2C6A61A46
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 30 Nov 2021 12:25:25 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 7442C615B3; Tue, 30 Nov 2021 12:25:23 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 294D560B82;
	Tue, 30 Nov 2021 12:25:20 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 91A3F60581
 for <linaro-mm-sig@lists.linaro.org>; Tue, 30 Nov 2021 12:25:17 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 8C54C60B82; Tue, 30 Nov 2021 12:25:17 +0000 (UTC)
Received: from mga06.intel.com (mga06.intel.com [134.134.136.31])
 by lists.linaro.org (Postfix) with ESMTPS id 306E060581
 for <linaro-mm-sig@lists.linaro.org>; Tue, 30 Nov 2021 12:25:15 +0000 (UTC)
X-IronPort-AV: E=McAfee;i="6200,9189,10183"; a="297006708"
X-IronPort-AV: E=Sophos;i="5.87,275,1631602800"; d="scan'208";a="297006708"
Received: from orsmga008.jf.intel.com ([10.7.209.65])
 by orsmga104.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 30 Nov 2021 04:25:13 -0800
X-IronPort-AV: E=Sophos;i="5.87,275,1631602800"; d="scan'208";a="512153579"
Received: from dcondura-mobl.ger.corp.intel.com (HELO [10.252.36.49])
 ([10.252.36.49])
 by orsmga008-auth.jf.intel.com with ESMTP/TLS/ECDHE-RSA-AES256-GCM-SHA384;
 30 Nov 2021 04:25:11 -0800
Message-ID: <c7502701-e85c-39f0-c249-702d029faa9e@linux.intel.com>
Date: Tue, 30 Nov 2021 13:25:08 +0100
MIME-Version: 1.0
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101
 Firefox/91.0 Thunderbird/91.3.2
Content-Language: en-US
To: =?UTF-8?Q?Thomas_Hellstr=c3=b6m?= <thomas.hellstrom@linux.intel.com>,
 intel-gfx@lists.freedesktop.org, dri-devel@lists.freedesktop.org
References: <20211130121936.586031-1-thomas.hellstrom@linux.intel.com>
 <20211130121936.586031-2-thomas.hellstrom@linux.intel.com>
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
In-Reply-To: <20211130121936.586031-2-thomas.hellstrom@linux.intel.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: Re: [Linaro-mm-sig] [RFC PATCH 1/2] dma-fence: Avoid establishing a
 locking order between fence classes
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: linaro-mm-sig@lists.linaro.org, matthew.auld@intel.com,
 =?UTF-8?Q?Christian_K=c3=b6nig?= <christian.koenig@amd.com>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

T24gMzAtMTEtMjAyMSAxMzoxOSwgVGhvbWFzIEhlbGxzdHLDtm0gd3JvdGU6Cj4gVGhlIGxvY2tp
bmcgb3JkZXIgZm9yIHRha2luZyB0d28gZmVuY2UgbG9ja3MgaXMgaW1wbGljaXRseSBkZWZpbmVk
IGluCj4gYXQgbGVhc3QgdHdvIHdheXMgaW4gdGhlIGNvZGU6Cj4KPiAxKSBGZW5jZSBjb250YWlu
ZXJzIGZpcnN0IGFuZCBvdGhlciBmZW5jZXMgbmV4dCwgd2hpY2ggaXMgZGVmaW5lZCBieQo+IHRo
ZSBlbmFibGVfc2lnbmFsaW5nKCkgY2FsbGJhY2tzIG9mIGRtYV9mZW5jZV9jaGFpbiBhbmQKPiBk
bWFfZmVuY2VfYXJyYXkuCj4gMikgUmV2ZXJzZSBzaWduYWwgb3JkZXIsIHdoaWNoIGlzIHVzZWQg
YnkgX19pOTE1X2FjdGl2ZV9mZW5jZV9zZXQoKS4KPgo+IE5vdyAxKSBpbXBsaWVzIDIpLCBleGNl
cHQgZm9yIHRoZSBzaWduYWxfb25fYW55IG1vZGUgb2YgZG1hX2ZlbmNlX2FycmF5Cj4gYW5kIDIp
IGRvZXMgbm90IGltcGx5IDEpLCBhbmQgYWxzbyAxKSBtYWtlcyBsb2NraW5nIG9yZGVyIGJldHdl
ZW4KPiBkaWZmZXJlbnQgY29udGFpbmVycyBjb25mdXNpbmcuCj4KPiBFc3RhYmxpc2ggMikgYW5k
IGZpeCB1cCB0aGUgc2lnbmFsX29uX2FueSBtb2RlIGJ5IGNhbGxpbmcKPiBlbmFibGVfc2lnbmFs
aW5nKCkgb24gc3VjaCBmZW5jZXMgdW5sb2NrZWQgYXQgY3JlYXRpb24uCj4KPiBDYzogbGluYXJv
LW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCj4gQ2M6IGRyaS1kZXZlbEBsaXN0cy5mcmVlZGVza3Rv
cC5vcmcKPiBDYzogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgo+
IFNpZ25lZC1vZmYtYnk6IFRob21hcyBIZWxsc3Ryw7ZtIDx0aG9tYXMuaGVsbHN0cm9tQGxpbnV4
LmludGVsLmNvbT4KPiAtLS0KPiAgZHJpdmVycy9kbWEtYnVmL2RtYS1mZW5jZS1hcnJheS5jIHwg
MTMgKysrLS0KPiAgZHJpdmVycy9kbWEtYnVmL2RtYS1mZW5jZS1jaGFpbi5jIHwgIDMgKy0KPiAg
ZHJpdmVycy9kbWEtYnVmL2RtYS1mZW5jZS5jICAgICAgIHwgNzkgKysrKysrKysrKysrKysrKysr
KysrLS0tLS0tLS0tLQo+ICBpbmNsdWRlL2xpbnV4L2RtYS1mZW5jZS5oICAgICAgICAgfCAgMyAr
Kwo+ICA0IGZpbGVzIGNoYW5nZWQsIDY5IGluc2VydGlvbnMoKyksIDI5IGRlbGV0aW9ucygtKQo+
Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UtYXJyYXkuYyBiL2RyaXZl
cnMvZG1hLWJ1Zi9kbWEtZmVuY2UtYXJyYXkuYwo+IGluZGV4IDNlMDdmOTYxZTJmMy4uMDMyMmI5
MjkwOWZlIDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UtYXJyYXkuYwo+
ICsrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UtYXJyYXkuYwo+IEBAIC04NCw4ICs4NCw4
IEBAIHN0YXRpYyBib29sIGRtYV9mZW5jZV9hcnJheV9lbmFibGVfc2lnbmFsaW5nKHN0cnVjdCBk
bWFfZmVuY2UgKmZlbmNlKQo+ICAJCSAqIGluc3VmZmljaWVudCkuCj4gIAkJICovCj4gIAkJZG1h
X2ZlbmNlX2dldCgmYXJyYXktPmJhc2UpOwo+IC0JCWlmIChkbWFfZmVuY2VfYWRkX2NhbGxiYWNr
KGFycmF5LT5mZW5jZXNbaV0sICZjYltpXS5jYiwKPiAtCQkJCQkgICBkbWFfZmVuY2VfYXJyYXlf
Y2JfZnVuYykpIHsKPiArCQlpZiAoZG1hX2ZlbmNlX2FkZF9jYWxsYmFja19uZXN0ZWQoYXJyYXkt
PmZlbmNlc1tpXSwgJmNiW2ldLmNiLAo+ICsJCQkJCQkgIGRtYV9mZW5jZV9hcnJheV9jYl9mdW5j
KSkgewo+ICAJCQlpbnQgZXJyb3IgPSBhcnJheS0+ZmVuY2VzW2ldLT5lcnJvcjsKPiAgCj4gIAkJ
CWRtYV9mZW5jZV9hcnJheV9zZXRfcGVuZGluZ19lcnJvcihhcnJheSwgZXJyb3IpOwo+IEBAIC0x
NTgsNiArMTU4LDcgQEAgc3RydWN0IGRtYV9mZW5jZV9hcnJheSAqZG1hX2ZlbmNlX2FycmF5X2Ny
ZWF0ZShpbnQgbnVtX2ZlbmNlcywKPiAgewo+ICAJc3RydWN0IGRtYV9mZW5jZV9hcnJheSAqYXJy
YXk7Cj4gIAlzaXplX3Qgc2l6ZSA9IHNpemVvZigqYXJyYXkpOwo+ICsJc3RydWN0IGRtYV9mZW5j
ZSAqZmVuY2U7Cj4gIAo+ICAJLyogQWxsb2NhdGUgdGhlIGNhbGxiYWNrIHN0cnVjdHVyZXMgYmVo
aW5kIHRoZSBhcnJheS4gKi8KPiAgCXNpemUgKz0gbnVtX2ZlbmNlcyAqIHNpemVvZihzdHJ1Y3Qg
ZG1hX2ZlbmNlX2FycmF5X2NiKTsKPiBAQCAtMTY1LDggKzE2Niw5IEBAIHN0cnVjdCBkbWFfZmVu
Y2VfYXJyYXkgKmRtYV9mZW5jZV9hcnJheV9jcmVhdGUoaW50IG51bV9mZW5jZXMsCj4gIAlpZiAo
IWFycmF5KQo+ICAJCXJldHVybiBOVUxMOwo+ICAKPiArCWZlbmNlID0gJmFycmF5LT5iYXNlOwo+
ICAJc3Bpbl9sb2NrX2luaXQoJmFycmF5LT5sb2NrKTsKPiAtCWRtYV9mZW5jZV9pbml0KCZhcnJh
eS0+YmFzZSwgJmRtYV9mZW5jZV9hcnJheV9vcHMsICZhcnJheS0+bG9jaywKPiArCWRtYV9mZW5j
ZV9pbml0KGZlbmNlLCAmZG1hX2ZlbmNlX2FycmF5X29wcywgJmFycmF5LT5sb2NrLAo+ICAJCSAg
ICAgICBjb250ZXh0LCBzZXFubyk7Cj4gIAlpbml0X2lycV93b3JrKCZhcnJheS0+d29yaywgaXJx
X2RtYV9mZW5jZV9hcnJheV93b3JrKTsKPiAgCj4gQEAgLTE3NCw3ICsxNzYsMTAgQEAgc3RydWN0
IGRtYV9mZW5jZV9hcnJheSAqZG1hX2ZlbmNlX2FycmF5X2NyZWF0ZShpbnQgbnVtX2ZlbmNlcywK
PiAgCWF0b21pY19zZXQoJmFycmF5LT5udW1fcGVuZGluZywgc2lnbmFsX29uX2FueSA/IDEgOiBu
dW1fZmVuY2VzKTsKPiAgCWFycmF5LT5mZW5jZXMgPSBmZW5jZXM7Cj4gIAo+IC0JYXJyYXktPmJh
c2UuZXJyb3IgPSBQRU5ESU5HX0VSUk9SOwo+ICsJZmVuY2UtPmVycm9yID0gUEVORElOR19FUlJP
UjsKPiArCj4gKwlpZiAoc2lnbmFsX29uX2FueSkKPiArCQlkbWFfZmVuY2VfZW5hYmxlX3N3X3Np
Z25hbGluZyhmZW5jZSk7Cj4gIAo+ICAJcmV0dXJuIGFycmF5Owo+ICB9Cj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UtY2hhaW4uYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEt
ZmVuY2UtY2hhaW4uYwo+IGluZGV4IDFiNGNiM2U1Y2VjOS4uMDUxOGU1Mzg4MGY2IDEwMDY0NAo+
IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UtY2hhaW4uYwo+ICsrKyBiL2RyaXZlcnMv
ZG1hLWJ1Zi9kbWEtZmVuY2UtY2hhaW4uYwo+IEBAIC0xNTIsNyArMTUyLDggQEAgc3RhdGljIGJv
b2wgZG1hX2ZlbmNlX2NoYWluX2VuYWJsZV9zaWduYWxpbmcoc3RydWN0IGRtYV9mZW5jZSAqZmVu
Y2UpCj4gIAkJc3RydWN0IGRtYV9mZW5jZSAqZiA9IGNoYWluID8gY2hhaW4tPmZlbmNlIDogZmVu
Y2U7Cj4gIAo+ICAJCWRtYV9mZW5jZV9nZXQoZik7Cj4gLQkJaWYgKCFkbWFfZmVuY2VfYWRkX2Nh
bGxiYWNrKGYsICZoZWFkLT5jYiwgZG1hX2ZlbmNlX2NoYWluX2NiKSkgewo+ICsJCWlmICghZG1h
X2ZlbmNlX2FkZF9jYWxsYmFja19uZXN0ZWQoZiwgJmhlYWQtPmNiLAo+ICsJCQkJCQkgICBkbWFf
ZmVuY2VfY2hhaW5fY2IpKSB7Cj4gIAkJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOwo+ICAJCQlyZXR1
cm4gdHJ1ZTsKPiAgCQl9Cj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2Uu
YyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYwo+IGluZGV4IDA2NjQwMGVkODg0MS4uOTBh
M2Q1MTIxNzQ2IDEwMDY0NAo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYwo+ICsr
KyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtZmVuY2UuYwo+IEBAIC02MTAsNiArNjEwLDM3IEBAIHZv
aWQgZG1hX2ZlbmNlX2VuYWJsZV9zd19zaWduYWxpbmcoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2Up
Cj4gIH0KPiAgRVhQT1JUX1NZTUJPTChkbWFfZmVuY2VfZW5hYmxlX3N3X3NpZ25hbGluZyk7Cj4g
IAo+ICtzdGF0aWMgaW50IF9fZG1hX2ZlbmNlX2FkZF9jYWxsYmFjayhzdHJ1Y3QgZG1hX2ZlbmNl
ICpmZW5jZSwKPiArCQkJCSAgICBzdHJ1Y3QgZG1hX2ZlbmNlX2NiICpjYiwKPiArCQkJCSAgICBk
bWFfZmVuY2VfZnVuY190IGZ1bmMsCj4gKwkJCQkgICAgaW50IG5lc3RfbGV2ZWwpCj4gK3sKPiAr
CXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gKwlpbnQgcmV0ID0gMDsKPiArCj4gKwlpZiAoV0FSTl9P
TighZmVuY2UgfHwgIWZ1bmMpKQo+ICsJCXJldHVybiAtRUlOVkFMOwo+ICsKPiArCWlmICh0ZXN0
X2JpdChETUFfRkVOQ0VfRkxBR19TSUdOQUxFRF9CSVQsICZmZW5jZS0+ZmxhZ3MpKSB7Cj4gKwkJ
SU5JVF9MSVNUX0hFQUQoJmNiLT5ub2RlKTsKPiArCQlyZXR1cm4gLUVOT0VOVDsKPiArCX0KPiAr
Cj4gKwlzcGluX2xvY2tfaXJxc2F2ZV9uZXN0ZWQoZmVuY2UtPmxvY2ssIGZsYWdzLCAwKTsKRm9y
Z290IHRvIGhvb2sgdXAgbmVzdF9sZXZlbCBoZXJlPwo+ICsKPiArCWlmIChfX2RtYV9mZW5jZV9l
bmFibGVfc2lnbmFsaW5nKGZlbmNlKSkgewo+ICsJCWNiLT5mdW5jID0gZnVuYzsKPiArCQlsaXN0
X2FkZF90YWlsKCZjYi0+bm9kZSwgJmZlbmNlLT5jYl9saXN0KTsKPiArCX0gZWxzZSB7Cj4gKwkJ
SU5JVF9MSVNUX0hFQUQoJmNiLT5ub2RlKTsKPiArCQlyZXQgPSAtRU5PRU5UOwo+ICsJfQo+ICsK
PiArCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPiArCj4gKwly
ZXR1cm4gcmV0Owo+ICt9Cj4gKwo+ICAvKioKPiAgICogZG1hX2ZlbmNlX2FkZF9jYWxsYmFjayAt
IGFkZCBhIGNhbGxiYWNrIHRvIGJlIGNhbGxlZCB3aGVuIHRoZSBmZW5jZQo+ICAgKiBpcyBzaWdu
YWxlZAo+IEBAIC02MzUsMzMgKzY2NiwzMyBAQCBFWFBPUlRfU1lNQk9MKGRtYV9mZW5jZV9lbmFi
bGVfc3dfc2lnbmFsaW5nKTsKPiAgaW50IGRtYV9mZW5jZV9hZGRfY2FsbGJhY2soc3RydWN0IGRt
YV9mZW5jZSAqZmVuY2UsIHN0cnVjdCBkbWFfZmVuY2VfY2IgKmNiLAo+ICAJCQkgICBkbWFfZmVu
Y2VfZnVuY190IGZ1bmMpCj4gIHsKPiAtCXVuc2lnbmVkIGxvbmcgZmxhZ3M7Cj4gLQlpbnQgcmV0
ID0gMDsKPiAtCj4gLQlpZiAoV0FSTl9PTighZmVuY2UgfHwgIWZ1bmMpKQo+IC0JCXJldHVybiAt
RUlOVkFMOwo+IC0KPiAtCWlmICh0ZXN0X2JpdChETUFfRkVOQ0VfRkxBR19TSUdOQUxFRF9CSVQs
ICZmZW5jZS0+ZmxhZ3MpKSB7Cj4gLQkJSU5JVF9MSVNUX0hFQUQoJmNiLT5ub2RlKTsKPiAtCQly
ZXR1cm4gLUVOT0VOVDsKPiAtCX0KPiAtCj4gLQlzcGluX2xvY2tfaXJxc2F2ZShmZW5jZS0+bG9j
aywgZmxhZ3MpOwo+IC0KPiAtCWlmIChfX2RtYV9mZW5jZV9lbmFibGVfc2lnbmFsaW5nKGZlbmNl
KSkgewo+IC0JCWNiLT5mdW5jID0gZnVuYzsKPiAtCQlsaXN0X2FkZF90YWlsKCZjYi0+bm9kZSwg
JmZlbmNlLT5jYl9saXN0KTsKPiAtCX0gZWxzZSB7Cj4gLQkJSU5JVF9MSVNUX0hFQUQoJmNiLT5u
b2RlKTsKPiAtCQlyZXQgPSAtRU5PRU5UOwo+IC0JfQo+IC0KPiAtCXNwaW5fdW5sb2NrX2lycXJl
c3RvcmUoZmVuY2UtPmxvY2ssIGZsYWdzKTsKPiAtCj4gLQlyZXR1cm4gcmV0Owo+ICsJcmV0dXJu
IF9fZG1hX2ZlbmNlX2FkZF9jYWxsYmFjayhmZW5jZSwgY2IsIGZ1bmMsIDApOwo+ICB9Cj4gIEVY
UE9SVF9TWU1CT0woZG1hX2ZlbmNlX2FkZF9jYWxsYmFjayk7Cj4gIAoKT3RoZXIgdGhhbiB0aGF0
LCBJIGRpZG4ndCBpbnZlc3RpZ2F0ZSB0aGUgbmVzdGluZyBmYWlscyBlbm91Z2ggdG8gc2F5IEkg
Y2FuIGFjY3VyYXRlbHkgcmV2aWV3IHRoaXMuIDopCgp+TWFhcnRlbgoKCl9fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbmFyby1tbS1zaWcgbWFpbGluZyBs
aXN0CkxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpodHRwczovL2xpc3RzLmxpbmFyby5v
cmcvbWFpbG1hbi9saXN0aW5mby9saW5hcm8tbW0tc2lnCg==
