Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 2311D3BE719
	for <lists+linaro-mm-sig@lfdr.de>; Wed,  7 Jul 2021 13:26:59 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id C833166942
	for <lists+linaro-mm-sig@lfdr.de>; Wed,  7 Jul 2021 11:26:57 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 80E8A66941; Wed,  7 Jul 2021 11:26:57 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id AC4836687E;
	Wed,  7 Jul 2021 11:26:54 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 174F0611F5
 for <linaro-mm-sig@lists.linaro.org>; Wed,  7 Jul 2021 11:26:52 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 134F06687E; Wed,  7 Jul 2021 11:26:52 +0000 (UTC)
Received: from mail-ot1-f51.google.com (mail-ot1-f51.google.com
 [209.85.210.51])
 by lists.linaro.org (Postfix) with ESMTPS id 0BFC8611F5
 for <linaro-mm-sig@lists.linaro.org>; Wed,  7 Jul 2021 11:26:50 +0000 (UTC)
Received: by mail-ot1-f51.google.com with SMTP id
 f12-20020a056830204cb029048bcf4c6bd9so1867908otp.8
 for <linaro-mm-sig@lists.linaro.org>; Wed, 07 Jul 2021 04:26:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ffwll.ch; s=google;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=jcSjBfaiu3twifvMjOLwr3lER8+MJ4OJvgdqFOc7u3Q=;
 b=XY2nYSOxjEBjINEtvN0nUkC5iL8CR9/PEShuRalRalyz6qDEsOP2c7bP94D/CGuhI5
 g0b30C4B64wyYYJ8tIh32U+MRH0ZOSAQI9mWaYfVEETBFBlI9BjJIfJSzLsFtpfirRBA
 RbyR2DxBvyo4DTQw/PEvOCCUip4mzhbJg61Rw=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=jcSjBfaiu3twifvMjOLwr3lER8+MJ4OJvgdqFOc7u3Q=;
 b=VYpQGWE1+GruOJ5zrusThgBF4F50paAEEJ/s0q1wfwGEbV3F6dPPIgkcfch7DCujEi
 M7N+FYI6hKsx/eKwPgRes9JN2mH6oo/2OqktVC/6qvmW9h6qBkTqv4k0xs69NBqzO4+S
 Yi7BrfZYSJeorxfMiMthc3SIkOWwFFfAEPa/+DsaRq6JO2Tr6ZLymIiqlemCjSoev5Pm
 0McHKyBWfhO71Qg0tP9+UvSW3/bIObSE35G5nX13jdwRL4ItlrTgCwCe6VuW8BvhYUsF
 SxJLAm1LTAlv4xU5c5B0ijVknHa4uVUkc3pGgdEGvPPYF9Wen2bCXQAz7K8ryirPGFv7
 enJA==
X-Gm-Message-State: AOAM530MLMeRHH6hPe55RSz8eIEJYYVWOP9aHx4c0VKUBAG0Q9FEJSRj
 WLBRhqabJJQLichSgAx0+i4cRp2V8MpCosZIIvgEVw==
X-Google-Smtp-Source: ABdhPJyNgJFNofGkXrmeybkWO+4qnzCZoW903Z1oPPX4NrBQMFiHBo/J0/j8g3g/k6zOnEtRQOUdHbviXyYTmlQmITY=
X-Received: by 2002:a05:6830:1f19:: with SMTP id
 u25mr15628162otg.303.1625657209545; 
 Wed, 07 Jul 2021 04:26:49 -0700 (PDT)
MIME-Version: 1.0
References: <20210702213815.2249499-1-daniel.vetter@ffwll.ch>
 <20210702213815.2249499-9-daniel.vetter@ffwll.ch>
 <006dc4538e906b548eac0acfaf62211b83de4927.camel@pengutronix.de>
In-Reply-To: <006dc4538e906b548eac0acfaf62211b83de4927.camel@pengutronix.de>
From: Daniel Vetter <daniel.vetter@ffwll.ch>
Date: Wed, 7 Jul 2021 13:26:38 +0200
Message-ID: <CAKMK7uEwszSpcdk2BSasOD-9gpnm=UhKR8-K40zQCCLSyk=Q_Q@mail.gmail.com>
To: Lucas Stach <l.stach@pengutronix.de>
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: Re: [Linaro-mm-sig] [PATCH v2 08/11] drm/etnaviv: Use scheduler
 dependency handling
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: The etnaviv authors <etnaviv@lists.freedesktop.org>,
 DRI Development <dri-devel@lists.freedesktop.org>,
 "moderated list:DMA BUFFER SHARING FRAMEWORK" <linaro-mm-sig@lists.linaro.org>,
 Christian Gmeiner <christian.gmeiner@gmail.com>,
 Russell King <linux+etnaviv@armlinux.org.uk>,
 Daniel Vetter <daniel.vetter@intel.com>,
 =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>,
 "open list:DMA BUFFER SHARING FRAMEWORK" <linux-media@vger.kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

T24gV2VkLCBKdWwgNywgMjAyMSBhdCAxMTowOCBBTSBMdWNhcyBTdGFjaCA8bC5zdGFjaEBwZW5n
dXRyb25peC5kZT4gd3JvdGU6Cj4gQW0gRnJlaXRhZywgZGVtIDAyLjA3LjIwMjEgdW0gMjM6Mzgg
KzAyMDAgc2NocmllYiBEYW5pZWwgVmV0dGVyOgo+ID4gV2UgbmVlZCB0byBwdWxsIHRoZSBkcm1f
c2NoZWRfam9iX2luaXQgbXVjaCBlYXJsaWVyLCBidXQgdGhhdCdzIHZlcnkKPiA+IG1pbm9yIHN1
cmdlcnkuCj4gPgo+ID4gU2lnbmVkLW9mZi1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRl
ckBpbnRlbC5jb20+Cj4gPiBDYzogTHVjYXMgU3RhY2ggPGwuc3RhY2hAcGVuZ3V0cm9uaXguZGU+
Cj4gPiBDYzogUnVzc2VsbCBLaW5nIDxsaW51eCtldG5hdml2QGFybWxpbnV4Lm9yZy51az4KPiA+
IENjOiBDaHJpc3RpYW4gR21laW5lciA8Y2hyaXN0aWFuLmdtZWluZXJAZ21haWwuY29tPgo+ID4g
Q2M6IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+Cj4gPiBDYzogIkNocmlz
dGlhbiBLw7ZuaWciIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+Cj4gPiBDYzogZXRuYXZpdkBs
aXN0cy5mcmVlZGVza3RvcC5vcmcKPiA+IENjOiBsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmcK
PiA+IENjOiBsaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKPiA+IC0tLQo+ID4gIGRyaXZl
cnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtLmggICAgICAgIHwgIDUgKy0KPiA+ICBkcml2
ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYyB8IDMyICsrKysrLS0tLS0K
PiA+ICBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmMgICAgICB8IDYxICst
LS0tLS0tLS0tLS0tLS0tLS0tCj4gPiAgZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9z
Y2hlZC5oICAgICAgfCAgMyArLQo+ID4gIDQgZmlsZXMgY2hhbmdlZCwgMjAgaW5zZXJ0aW9ucygr
KSwgODEgZGVsZXRpb25zKC0pCj4gPgo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9l
dG5hdml2L2V0bmF2aXZfZ2VtLmggYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dl
bS5oCj4gPiBpbmRleCA5OGU2MGRmODgyYjYuLjYzNjg4ZTZlNDU4MCAxMDA2NDQKPiA+IC0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtLmgKPiA+ICsrKyBiL2RyaXZlcnMv
Z3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtLmgKPiA+IEBAIC04MCw5ICs4MCw2IEBAIHN0cnVj
dCBldG5hdml2X2dlbV9zdWJtaXRfYm8gewo+ID4gICAgICAgdTY0IHZhOwo+ID4gICAgICAgc3Ry
dWN0IGV0bmF2aXZfZ2VtX29iamVjdCAqb2JqOwo+ID4gICAgICAgc3RydWN0IGV0bmF2aXZfdnJh
bV9tYXBwaW5nICptYXBwaW5nOwo+ID4gLSAgICAgc3RydWN0IGRtYV9mZW5jZSAqZXhjbDsKPiA+
IC0gICAgIHVuc2lnbmVkIGludCBucl9zaGFyZWQ7Cj4gPiAtICAgICBzdHJ1Y3QgZG1hX2ZlbmNl
ICoqc2hhcmVkOwo+ID4gIH07Cj4gPgo+ID4gIC8qIENyZWF0ZWQgcGVyIHN1Ym1pdC1pb2N0bCwg
dG8gdHJhY2sgYm8ncyBhbmQgY21kc3RyZWFtIGJ1ZnMsIGV0YywKPiA+IEBAIC05NSw3ICs5Miw3
IEBAIHN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXQgewo+ID4gICAgICAgc3RydWN0IGV0bmF2aXZf
ZmlsZV9wcml2YXRlICpjdHg7Cj4gPiAgICAgICBzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdTsKPiA+
ICAgICAgIHN0cnVjdCBldG5hdml2X2lvbW11X2NvbnRleHQgKm1tdV9jb250ZXh0LCAqcHJldl9t
bXVfY29udGV4dDsKPiA+IC0gICAgIHN0cnVjdCBkbWFfZmVuY2UgKm91dF9mZW5jZSwgKmluX2Zl
bmNlOwo+ID4gKyAgICAgc3RydWN0IGRtYV9mZW5jZSAqb3V0X2ZlbmNlOwo+ID4gICAgICAgaW50
IG91dF9mZW5jZV9pZDsKPiA+ICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgbm9kZTsgLyogR1BVIGFj
dGl2ZSBzdWJtaXQgbGlzdCAqLwo+ID4gICAgICAgc3RydWN0IGV0bmF2aXZfY21kYnVmIGNtZGJ1
ZjsKPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9z
dWJtaXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jCj4g
PiBpbmRleCA0ZGQ3ZDlkNTQxYzAuLjkyNDc4YTUwYTU4MCAxMDA2NDQKPiA+IC0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jCj4gPiArKysgYi9kcml2ZXJz
L2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYwo+ID4gQEAgLTE4OCwxNiArMTg4
LDEwIEBAIHN0YXRpYyBpbnQgc3VibWl0X2ZlbmNlX3N5bmMoc3RydWN0IGV0bmF2aXZfZ2VtX3N1
Ym1pdCAqc3VibWl0KQo+ID4gICAgICAgICAgICAgICBpZiAoc3VibWl0LT5mbGFncyAmIEVUTkFf
U1VCTUlUX05PX0lNUExJQ0lUKQo+ID4gICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+
ID4KPiA+IC0gICAgICAgICAgICAgaWYgKGJvLT5mbGFncyAmIEVUTkFfU1VCTUlUX0JPX1dSSVRF
KSB7Cj4gPiAtICAgICAgICAgICAgICAgICAgICAgcmV0ID0gZG1hX3Jlc3ZfZ2V0X2ZlbmNlcyhy
b2JqLCAmYm8tPmV4Y2wsCj4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAmYm8tPm5yX3NoYXJlZCwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICZiby0+c2hhcmVkKTsKPiA+IC0gICAgICAgICAgICAgICAg
ICAgICBpZiAocmV0KQo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJl
dDsKPiA+IC0gICAgICAgICAgICAgfSBlbHNlIHsKPiA+IC0gICAgICAgICAgICAgICAgICAgICBi
by0+ZXhjbCA9IGRtYV9yZXN2X2dldF9leGNsX3VubG9ja2VkKHJvYmopOwo+ID4gLSAgICAgICAg
ICAgICB9Cj4gPiAtCj4gPiArICAgICAgICAgICAgIHJldCA9IGRybV9zY2hlZF9qb2JfYXdhaXRf
aW1wbGljaXQoJnN1Ym1pdC0+c2NoZWRfam9iLCAmYm8tPm9iai0+YmFzZSwKPiA+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiby0+ZmxhZ3MgJiBFVE5B
X1NVQk1JVF9CT19XUklURSk7Cj4gPiArICAgICAgICAgICAgIGlmIChyZXQpCj4gPiArICAgICAg
ICAgICAgICAgICAgICAgcmV0dXJuIHJldDsKPiA+ICAgICAgIH0KPiA+Cj4gPiAgICAgICByZXR1
cm4gcmV0Owo+ID4gQEAgLTQwMyw4ICszOTcsNiBAQCBzdGF0aWMgdm9pZCBzdWJtaXRfY2xlYW51
cChzdHJ1Y3Qga3JlZiAqa3JlZikKPiA+Cj4gPiAgICAgICB3YWtlX3VwX2FsbCgmc3VibWl0LT5n
cHUtPmZlbmNlX2V2ZW50KTsKPiA+Cj4gPiAtICAgICBpZiAoc3VibWl0LT5pbl9mZW5jZSkKPiA+
IC0gICAgICAgICAgICAgZG1hX2ZlbmNlX3B1dChzdWJtaXQtPmluX2ZlbmNlKTsKPiA+ICAgICAg
IGlmIChzdWJtaXQtPm91dF9mZW5jZSkgewo+ID4gICAgICAgICAgICAgICAvKiBmaXJzdCByZW1v
dmUgZnJvbSBJRFIsIHNvIGZlbmNlIGNhbiBub3QgYmUgZm91bmQgYW55bW9yZSAqLwo+ID4gICAg
ICAgICAgICAgICBtdXRleF9sb2NrKCZzdWJtaXQtPmdwdS0+ZmVuY2VfbG9jayk7Cj4gPiBAQCAt
NTM3LDYgKzUyOSwxMiBAQCBpbnQgZXRuYXZpdl9pb2N0bF9nZW1fc3VibWl0KHN0cnVjdCBkcm1f
ZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgICAgICBzdWJtaXQtPmV4ZWNfc3RhdGUgPSBh
cmdzLT5leGVjX3N0YXRlOwo+ID4gICAgICAgc3VibWl0LT5mbGFncyA9IGFyZ3MtPmZsYWdzOwo+
ID4KPiA+ICsgICAgIHJldCA9IGRybV9zY2hlZF9qb2JfaW5pdCgmc3VibWl0LT5zY2hlZF9qb2Is
Cj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJmN0eC0+c2NoZWRfZW50aXR5W2Fy
Z3MtPnBpcGVdLAo+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Ym1pdC0+Y3R4
KTsKPiA+ICsgICAgIGlmIChyZXQpCj4gPiArICAgICAgICAgICAgIGdvdG8gZXJyX3N1Ym1pdF9v
YmplY3RzOwo+ID4gKwo+Cj4gV2l0aCB0aGUgaW5pdCBtb3ZlZCBoZXJlIHlvdSBhbHNvIG5lZWQg
dG8gbW92ZSB0aGUKPiBkcm1fc2NoZWRfam9iX2NsZWFudXAgY2FsbCBmcm9tIGV0bmF2aXZfc2No
ZWRfZnJlZV9qb2IgaW50bwo+IHN1Ym1pdF9jbGVhbnVwIHRvIGF2b2lkIHRoZSBwb3RlbnRpYWwg
bWVtb3J5IGxlYWsgd2hlbiB3ZSBiYWlsIG91dAo+IGJlZm9yZSBwdXNoaW5nIHRoZSBqb2IgdG8g
dGhlIHNjaGVkdWxlci4KClVoIGFwb2xvZ2llcyBmb3IgbWlzc2luZyB0aGlzIGFnYWluLCB0aGUg
ZW50aXJlIHBvaW50IG9mIHYyIHdhcyB0byBmaXgKdGhpcyBhY3Jvc3MgYWxsIGRyaXZlcnMuIEJ1
dCBzb21laG93IHRoZSBmaXh1cCBmb3IgZXRuYXZpdiBnb3QgbG9zdC4KSSdsbCBkbyBpdCBub3cg
Zm9yIHYzLgoKVGhhbmtzLCBEYW5pZWwKCj4KPiBSZWdhcmRzLAo+IEx1Y2FzCj4KPiA+ICAgICAg
IHJldCA9IHN1Ym1pdF9sb29rdXBfb2JqZWN0cyhzdWJtaXQsIGZpbGUsIGJvcywgYXJncy0+bnJf
Ym9zKTsKPiA+ICAgICAgIGlmIChyZXQpCj4gPiAgICAgICAgICAgICAgIGdvdG8gZXJyX3N1Ym1p
dF9vYmplY3RzOwo+ID4gQEAgLTU0OSwxMSArNTQ3LDE1IEBAIGludCBldG5hdml2X2lvY3RsX2dl
bV9zdWJtaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiA+ICAgICAgIH0K
PiA+Cj4gPiAgICAgICBpZiAoYXJncy0+ZmxhZ3MgJiBFVE5BX1NVQk1JVF9GRU5DRV9GRF9JTikg
ewo+ID4gLSAgICAgICAgICAgICBzdWJtaXQtPmluX2ZlbmNlID0gc3luY19maWxlX2dldF9mZW5j
ZShhcmdzLT5mZW5jZV9mZCk7Cj4gPiAtICAgICAgICAgICAgIGlmICghc3VibWl0LT5pbl9mZW5j
ZSkgewo+ID4gKyAgICAgICAgICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICppbl9mZW5jZSA9IHN5bmNf
ZmlsZV9nZXRfZmVuY2UoYXJncy0+ZmVuY2VfZmQpOwo+ID4gKyAgICAgICAgICAgICBpZiAoIWlu
X2ZlbmNlKSB7Cj4gPiAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsKPiA+ICAg
ICAgICAgICAgICAgICAgICAgICBnb3RvIGVycl9zdWJtaXRfb2JqZWN0czsKPiA+ICAgICAgICAg
ICAgICAgfQo+ID4gKwo+ID4gKyAgICAgICAgICAgICByZXQgPSBkcm1fc2NoZWRfam9iX2F3YWl0
X2ZlbmNlKCZzdWJtaXQtPnNjaGVkX2pvYiwgaW5fZmVuY2UpOwo+ID4gKyAgICAgICAgICAgICBp
ZiAocmV0KQo+ID4gKyAgICAgICAgICAgICAgICAgICAgIGdvdG8gZXJyX3N1Ym1pdF9vYmplY3Rz
Owo+ID4gICAgICAgfQo+ID4KPiA+ICAgICAgIHJldCA9IHN1Ym1pdF9waW5fb2JqZWN0cyhzdWJt
aXQpOwo+ID4gQEAgLTU3OSw3ICs1ODEsNyBAQCBpbnQgZXRuYXZpdl9pb2N0bF9nZW1fc3VibWl0
KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCj4gPiAgICAgICBpZiAocmV0KQo+
ID4gICAgICAgICAgICAgICBnb3RvIGVycl9zdWJtaXRfb2JqZWN0czsKPiA+Cj4gPiAtICAgICBy
ZXQgPSBldG5hdml2X3NjaGVkX3B1c2hfam9iKCZjdHgtPnNjaGVkX2VudGl0eVthcmdzLT5waXBl
XSwgc3VibWl0KTsKPiA+ICsgICAgIHJldCA9IGV0bmF2aXZfc2NoZWRfcHVzaF9qb2Ioc3VibWl0
KTsKPiA+ICAgICAgIGlmIChyZXQpCj4gPiAgICAgICAgICAgICAgIGdvdG8gZXJyX3N1Ym1pdF9v
YmplY3RzOwo+ID4KPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5h
dml2X3NjaGVkLmMgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmMKPiA+
IGluZGV4IDE4MGJiNjMzZDVjNS4uYzk4ZDY3MzIwYmUzIDEwMDY0NAo+ID4gLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9zY2hlZC5jCj4gPiArKysgYi9kcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmMKPiA+IEBAIC0xNyw1OCArMTcsNiBAQCBtb2R1bGVf
cGFyYW1fbmFtZWQoam9iX2hhbmdfbGltaXQsIGV0bmF2aXZfam9iX2hhbmdfbGltaXQsIGludCAs
IDA0NDQpOwo+ID4gIHN0YXRpYyBpbnQgZXRuYXZpdl9od19qb2JzX2xpbWl0ID0gNDsKPiA+ICBt
b2R1bGVfcGFyYW1fbmFtZWQoaHdfam9iX2xpbWl0LCBldG5hdml2X2h3X2pvYnNfbGltaXQsIGlu
dCAsIDA0NDQpOwo+ID4KPiA+IC1zdGF0aWMgc3RydWN0IGRtYV9mZW5jZSAqCj4gPiAtZXRuYXZp
dl9zY2hlZF9kZXBlbmRlbmN5KHN0cnVjdCBkcm1fc2NoZWRfam9iICpzY2hlZF9qb2IsCj4gPiAt
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBkcm1fc2NoZWRfZW50aXR5ICplbnRpdHkpCj4g
PiAtewo+ID4gLSAgICAgc3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqc3VibWl0ID0gdG9fZXRu
YXZpdl9zdWJtaXQoc2NoZWRfam9iKTsKPiA+IC0gICAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNl
Owo+ID4gLSAgICAgaW50IGk7Cj4gPiAtCj4gPiAtICAgICBpZiAodW5saWtlbHkoc3VibWl0LT5p
bl9mZW5jZSkpIHsKPiA+IC0gICAgICAgICAgICAgZmVuY2UgPSBzdWJtaXQtPmluX2ZlbmNlOwo+
ID4gLSAgICAgICAgICAgICBzdWJtaXQtPmluX2ZlbmNlID0gTlVMTDsKPiA+IC0KPiA+IC0gICAg
ICAgICAgICAgaWYgKCFkbWFfZmVuY2VfaXNfc2lnbmFsZWQoZmVuY2UpKQo+ID4gLSAgICAgICAg
ICAgICAgICAgICAgIHJldHVybiBmZW5jZTsKPiA+IC0KPiA+IC0gICAgICAgICAgICAgZG1hX2Zl
bmNlX3B1dChmZW5jZSk7Cj4gPiAtICAgICB9Cj4gPiAtCj4gPiAtICAgICBmb3IgKGkgPSAwOyBp
IDwgc3VibWl0LT5ucl9ib3M7IGkrKykgewo+ID4gLSAgICAgICAgICAgICBzdHJ1Y3QgZXRuYXZp
dl9nZW1fc3VibWl0X2JvICpibyA9ICZzdWJtaXQtPmJvc1tpXTsKPiA+IC0gICAgICAgICAgICAg
aW50IGo7Cj4gPiAtCj4gPiAtICAgICAgICAgICAgIGlmIChiby0+ZXhjbCkgewo+ID4gLSAgICAg
ICAgICAgICAgICAgICAgIGZlbmNlID0gYm8tPmV4Y2w7Cj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgYm8tPmV4Y2wgPSBOVUxMOwo+ID4gLQo+ID4gLSAgICAgICAgICAgICAgICAgICAgIGlmICgh
ZG1hX2ZlbmNlX2lzX3NpZ25hbGVkKGZlbmNlKSkKPiA+IC0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHJldHVybiBmZW5jZTsKPiA+IC0KPiA+IC0gICAgICAgICAgICAgICAgICAgICBkbWFf
ZmVuY2VfcHV0KGZlbmNlKTsKPiA+IC0gICAgICAgICAgICAgfQo+ID4gLQo+ID4gLSAgICAgICAg
ICAgICBmb3IgKGogPSAwOyBqIDwgYm8tPm5yX3NoYXJlZDsgaisrKSB7Cj4gPiAtICAgICAgICAg
ICAgICAgICAgICAgaWYgKCFiby0+c2hhcmVkW2pdKQo+ID4gLSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgY29udGludWU7Cj4gPiAtCj4gPiAtICAgICAgICAgICAgICAgICAgICAgZmVuY2Ug
PSBiby0+c2hhcmVkW2pdOwo+ID4gLSAgICAgICAgICAgICAgICAgICAgIGJvLT5zaGFyZWRbal0g
PSBOVUxMOwo+ID4gLQo+ID4gLSAgICAgICAgICAgICAgICAgICAgIGlmICghZG1hX2ZlbmNlX2lz
X3NpZ25hbGVkKGZlbmNlKSkKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
biBmZW5jZTsKPiA+IC0KPiA+IC0gICAgICAgICAgICAgICAgICAgICBkbWFfZmVuY2VfcHV0KGZl
bmNlKTsKPiA+IC0gICAgICAgICAgICAgfQo+ID4gLSAgICAgICAgICAgICBrZnJlZShiby0+c2hh
cmVkKTsKPiA+IC0gICAgICAgICAgICAgYm8tPm5yX3NoYXJlZCA9IDA7Cj4gPiAtICAgICAgICAg
ICAgIGJvLT5zaGFyZWQgPSBOVUxMOwo+ID4gLSAgICAgfQo+ID4gLQo+ID4gLSAgICAgcmV0dXJu
IE5VTEw7Cj4gPiAtfQo+ID4gLQo+ID4gIHN0YXRpYyBzdHJ1Y3QgZG1hX2ZlbmNlICpldG5hdml2
X3NjaGVkX3J1bl9qb2Ioc3RydWN0IGRybV9zY2hlZF9qb2IgKnNjaGVkX2pvYikKPiA+ICB7Cj4g
PiAgICAgICBzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQgPSB0b19ldG5hdml2X3N1
Ym1pdChzY2hlZF9qb2IpOwo+ID4gQEAgLTE0MCwxNCArODgsMTIgQEAgc3RhdGljIHZvaWQgZXRu
YXZpdl9zY2hlZF9mcmVlX2pvYihzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc2NoZWRfam9iKQo+ID4g
IH0KPiA+Cj4gPiAgc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fc2NoZWRfYmFja2VuZF9vcHMgZXRu
YXZpdl9zY2hlZF9vcHMgPSB7Cj4gPiAtICAgICAuZGVwZW5kZW5jeSA9IGV0bmF2aXZfc2NoZWRf
ZGVwZW5kZW5jeSwKPiA+ICAgICAgIC5ydW5fam9iID0gZXRuYXZpdl9zY2hlZF9ydW5fam9iLAo+
ID4gICAgICAgLnRpbWVkb3V0X2pvYiA9IGV0bmF2aXZfc2NoZWRfdGltZWRvdXRfam9iLAo+ID4g
ICAgICAgLmZyZWVfam9iID0gZXRuYXZpdl9zY2hlZF9mcmVlX2pvYiwKPiA+ICB9Owo+ID4KPiA+
IC1pbnQgZXRuYXZpdl9zY2hlZF9wdXNoX2pvYihzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eSAqc2No
ZWRfZW50aXR5LAo+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBldG5hdml2X2dl
bV9zdWJtaXQgKnN1Ym1pdCkKPiA+ICtpbnQgZXRuYXZpdl9zY2hlZF9wdXNoX2pvYihzdHJ1Y3Qg
ZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQpCj4gPiAgewo+ID4gICAgICAgaW50IHJldCA9IDA7
Cj4gPgo+ID4gQEAgLTE1OCwxMSArMTA0LDYgQEAgaW50IGV0bmF2aXZfc2NoZWRfcHVzaF9qb2Io
c3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKnNjaGVkX2VudGl0eSwKPiA+ICAgICAgICAqLwo+ID4g
ICAgICAgbXV0ZXhfbG9jaygmc3VibWl0LT5ncHUtPmZlbmNlX2xvY2spOwo+ID4KPiA+IC0gICAg
IHJldCA9IGRybV9zY2hlZF9qb2JfaW5pdCgmc3VibWl0LT5zY2hlZF9qb2IsIHNjaGVkX2VudGl0
eSwKPiA+IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJtaXQtPmN0eCk7Cj4gPiAt
ICAgICBpZiAocmV0KQo+ID4gLSAgICAgICAgICAgICBnb3RvIG91dF91bmxvY2s7Cj4gPiAtCj4g
PiAgICAgICBkcm1fc2NoZWRfam9iX2FybSgmc3VibWl0LT5zY2hlZF9qb2IpOwo+ID4KPiA+ICAg
ICAgIHN1Ym1pdC0+b3V0X2ZlbmNlID0gZG1hX2ZlbmNlX2dldCgmc3VibWl0LT5zY2hlZF9qb2Iu
c19mZW5jZS0+ZmluaXNoZWQpOwo+ID4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ldG5h
dml2L2V0bmF2aXZfc2NoZWQuaCBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfc2No
ZWQuaAo+ID4gaW5kZXggYzBhNjc5NmUyMmM5Li5iYWViZmEwNjlhZmMgMTAwNjQ0Cj4gPiAtLS0g
YS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmgKPiA+ICsrKyBiL2RyaXZl
cnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfc2NoZWQuaAo+ID4gQEAgLTE4LDcgKzE4LDYgQEAg
c3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqdG9fZXRuYXZpdl9zdWJtaXQoc3RydWN0IGRybV9z
Y2hlZF9qb2IgKnNjaGVkX2pvYikKPiA+Cj4gPiAgaW50IGV0bmF2aXZfc2NoZWRfaW5pdChzdHJ1
Y3QgZXRuYXZpdl9ncHUgKmdwdSk7Cj4gPiAgdm9pZCBldG5hdml2X3NjaGVkX2Zpbmkoc3RydWN0
IGV0bmF2aXZfZ3B1ICpncHUpOwo+ID4gLWludCBldG5hdml2X3NjaGVkX3B1c2hfam9iKHN0cnVj
dCBkcm1fc2NoZWRfZW50aXR5ICpzY2hlZF9lbnRpdHksCj4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqc3VibWl0KTsKPiA+ICtpbnQgZXRuYXZp
dl9zY2hlZF9wdXNoX2pvYihzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQpOwo+ID4K
PiA+ICAjZW5kaWYgLyogX19FVE5BVklWX1NDSEVEX0hfXyAqLwo+Cj4KCgotLSAKRGFuaWVsIFZl
dHRlcgpTb2Z0d2FyZSBFbmdpbmVlciwgSW50ZWwgQ29ycG9yYXRpb24KaHR0cDovL2Jsb2cuZmZ3
bGwuY2gKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGlu
YXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QKTGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCmh0
dHBzOi8vbGlzdHMubGluYXJvLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2xpbmFyby1tbS1zaWcK
