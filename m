Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id C49C070A761
	for <lists+linaro-mm-sig@lfdr.de>; Sat, 20 May 2023 12:55:20 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id D3791443BC
	for <lists+linaro-mm-sig@lfdr.de>; Sat, 20 May 2023 10:55:19 +0000 (UTC)
Received: from loongson.cn (mail.loongson.cn [114.242.206.163])
	by lists.linaro.org (Postfix) with ESMTP id CB73F43D21
	for <linaro-mm-sig@lists.linaro.org>; Sat, 20 May 2023 10:54:37 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=none;
	spf=pass (lists.linaro.org: domain of suijingfeng@loongson.cn designates 114.242.206.163 as permitted sender) smtp.mailfrom=suijingfeng@loongson.cn;
	dmarc=none
Received: from loongson.cn (unknown [10.20.42.43])
	by gateway (Coremail) with SMTP id _____8Cx9ejspmhkFmkKAA--.18287S3;
	Sat, 20 May 2023 18:54:36 +0800 (CST)
Received: from openarena.loongson.cn (unknown [10.20.42.43])
	by localhost.localdomain (Coremail) with SMTP id AQAAf8BxkrDmpmhkOaFrAA--.51434S3;
	Sat, 20 May 2023 18:54:33 +0800 (CST)
From: Sui Jingfeng <suijingfeng@loongson.cn>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
	Maxime Ripard <mripard@kernel.org>,
	Thomas Zimmermann <tzimmermann@suse.de>,
	David Airlie <airlied@gmail.com>,
	Daniel Vetter <daniel@ffwll.ch>,
	Sui Jingfeng <suijingfeng@loongson.cn>,
	Li Yi <liyi@loongson.cn>,
	suijingfeng <15330273260@189.cn>,
	Sumit Semwal <sumit.semwal@linaro.org>,
	Christian Koenig <christian.koenig@amd.com>,
	Emil Velikov <emil.l.velikov@gmail.com>
Date: Sat, 20 May 2023 18:54:29 +0800
Message-Id: <20230520105430.325685-2-suijingfeng@loongson.cn>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230520105430.325685-1-suijingfeng@loongson.cn>
References: <20230520105430.325685-1-suijingfeng@loongson.cn>
MIME-Version: 1.0
X-CM-TRANSID: AQAAf8BxkrDmpmhkOaFrAA--.51434S3
X-CM-SenderInfo: xvxlyxpqjiv03j6o00pqjv00gofq/
X-Coremail-Antispam: 1Uk129KBjvtXoWkAryUtw1xCF4xWFyfuryUKFg_yoW8Zr47ZF
	g_CFy2vr1DGw1Du34Fqw1UGw1xtF93Cry7XF4DWFWIyFZ7tr4DX345ArW3Xr1xuFyUu3W8
	tF98J34kCry0yF1IgjkaLaAFLSUrUUUU5b8apTn2vfkv8UJUUUU8wcxFpf9Il3svdxBIda
	Vrn0xqx4xG64xvF2IEw4CE5I8CrVC2j2Jv73VFW2AGmfu7bjvjm3AaLaJ3UjIYCTnIWjp_
	UUUYC7kC6x804xWl14x267AKxVWUJVW8JwAFc2x0x2IEx4CE42xK8VAvwI8IcIk0rVWrJV
	Cq3wAFIxvE14AKwVWUXVWUAwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84AC
	jcxK6xIIjxv20xvE14v26ryj6F1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26r4j6F4UM2
	8EF7xvwVC2z280aVAFwI0_Gr1j6F4UJwA2z4x0Y4vEx4A2jsIEc7CjxVAFwI0_Gr1j6F4U
	JwAaw2AFwI0_JF0_Jw1le2I262IYc4CY6c8Ij28IcVAaY2xG8wAqjxCEc2xF0cIa020Ex4
	CE44I27wAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_Wrv_ZF1lYx0E
	x4A2jsIE14v26r4j6F4UMcvjeVCFs4IE7xkEbVWUJVW8JwACjcxG0xvY0x0EwIxGrwCY1x
	0262kKe7AKxVWUtVW8ZwCF04k20xvY0x0EwIxGrwCFx2IqxVCFs4IE7xkEbVWUJVW8JwCF
	I7km07C267AKxVWUAVWUtwC20s026c02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r
	106r1rMI8E67AF67kF1VAFwI0_GFv_WrylIxkGc2Ij64vIr41lIxAIcVC0I7IYx2IY67AK
	xVW5JVW7JwCI42IY6xIIjxv20xvEc7CjxVAFwI0_Gr0_Cr1lIxAIcVCF04k26cxKx2IYs7
	xG6r1j6r1xMIIF0xvEx4A2jsIE14v26r4j6F4UMIIF0xvEx4A2jsIEc7CjxVAFwI0_Gr0_
	Gr1UYxBIdaVFxhVjvjDU0xZFpf9x07jfHUhUUUUU=
X-Spamd-Result: default: False [-5.20 / 15.00];
	REPLY(-4.00)[];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	MID_CONTAINS_FROM(1.00)[];
	RCVD_IN_DNSWL_HI(-0.50)[114.242.206.163:from];
	R_SPF_ALLOW(-0.20)[+ip4:114.242.206.163:c];
	RCVD_NO_TLS_LAST(0.10)[];
	MIME_GOOD(-0.10)[text/plain];
	R_DKIM_NA(0.00)[];
	RCVD_COUNT_TWO(0.00)[2];
	MIME_TRACE(0.00)[0:+];
	ASN(0.00)[asn:4808, ipnet:114.242.192.0/18, country:CN];
	FROM_EQ_ENVFROM(0.00)[];
	FREEMAIL_TO(0.00)[linux.intel.com,kernel.org,suse.de,gmail.com,ffwll.ch,loongson.cn,189.cn,linaro.org,amd.com];
	RCPT_COUNT_TWELVE(0.00)[20];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	FROM_HAS_DN(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	TO_DN_SOME(0.00)[];
	DMARC_NA(0.00)[loongson.cn];
	TAGGED_RCPT(0.00)[renesas];
	ARC_NA(0.00)[]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: CB73F43D21
X-Spamd-Bar: -----
Message-ID-Hash: ZHOECKNWA2ICU4D2XZRNOHKBSK2WHEKM
X-Message-ID-Hash: ZHOECKNWA2ICU4D2XZRNOHKBSK2WHEKM
X-MailFrom: suijingfeng@loongson.cn
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: Nathan Chancellor <nathan@kernel.org>, linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org, linux-media@vger.kernel.org, linaro-mm-sig@lists.linaro.org, loongson-kernel@lists.loongnix.cn, Liu Peibao <liupeibao@loongson.cn>, Geert Uytterhoeven <geert+renesas@glider.be>, Javier Martinez Canillas <javierm@redhat.com>
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH v14 1/2] drm: add kms driver for loongson display controller
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/ZHOECKNWA2ICU4D2XZRNOHKBSK2WHEKM/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

TG9vbmdzb24gZGlzcGxheSBjb250cm9sbGVyIElQIGhhcyBiZWVuIGludGVncmF0ZWQgaW4gYm90
aCBMb29uZ3NvbiBub3J0aA0KYnJpZGdlIGNoaXBzZXQobHM3YTEwMDAvbHM3YTIwMDApIGFuZCBM
b29uZ3NvbiBTb0NzKGxzMmsxMDAwL2xzMmsyMDAwKSwgaXQNCmhhcyBiZWVuIGV2ZW4gaW5jbHVk
ZWQgaW4gTG9vbmdzb24gc2VsZi1tYWRlIEJNQyBwcm9kdWN0cy4NCg0KVGhpcyBkaXNwbGF5IGNv
bnRyb2xsZXIgaXMgYSBQQ0kgZGV2aWNlLiBJdCBoYXMgdHdvIGRpc3BsYXkgcGlwZXMgYW5kIGVh
Y2gNCmRpc3BsYXkgcGlwZSBzdXBwb3J0IGEgcHJpbWFyeSBwbGFuZSBhbmQgYSBjdXJzb3IgcGxh
bmUuIEZvciB0aGUgREMgaW4gdGhlDQpsczdhMTAwMCBhbmQgbHMyazEwMDAsIGVhY2ggZGlzcGxh
eSBwaXBlIGhhcyBhIERWTyBvdXRwdXQgaW50ZXJmYWNlIHdoaWNoDQpwcm92aWRlIFJHQjg4OCBz
aWduYWxzLCB2ZXJ0aWNhbCAmIGhvcml6b250YWwgc3luY2hyb25pc2F0aW9ucyBhbmQgcGl4ZWwN
CmNsb2NrLiBFYWNoIENSVEMgaXMgYWJsZSB0byBzdXBwb3J0IDE5MjB4MTA4MEA2MEh6LCB0aGUg
bWF4aW11bSByZXNvbHV0aW9uDQpvZiBlYWNoIGRpc3BsYXkgcGlwZSBpcyAyMDQ4eDIwNDggYWNj
b3JkaW5nIHRvIHRoZSBoYXJkd2FyZSBzcGVjLg0KDQpGb3IgdGhlIERDIGluIExTN0EyMDAwLCBl
YWNoIGRpc3BsYXkgcGlwZSBpcyBlcXVpcHBlZCB3aXRoIGEgYnVpbHQtaW4gSERNSQ0KZW5jb2Rl
ciB3aGljaCBpcyBjb21wbGlhbnQgd2l0aCB0aGUgSERNSSAxLjQgc3BlY2lmaWNhdGlvbiwgdGh1
cyBpdCBzdXBwb3J0DQozODQweDIxNjBAMzBIei4gVGhlIGZpcnN0IGRpc3BsYXkgcGlwZSBpcyBh
bHNvIGVxdWlwcGVkIHdpdGggYSB0cmFuc3BhcmVudA0KdmdhIGVuY29kZXIgd2hpY2ggaXMgcGFy
YWxsZWwgd2l0aCB0aGUgSERNSSBlbmNvZGVyLiBUaGUgREMgaW4gTFM3QTIwMDAgaXMNCm1vcmUg
Y29tcGxldGUgY29tcGFyZSB3aXRoIHRoZSBvbmUgaW4gb2xkIGNoaXBzLCBiZXNpZGVzIGFib3Zl
IGZlYXR1cmUsIGl0DQpoYXMgdHdvIGhhcmR3YXJlIGN1cnNvcnMsIHR3byBoYXJkd2FyZSB2Ymxh
bmsgY291bnRlciBhbmQgdHdvIHNjYW5vdXQNCnBvc2l0aW9uIHJlY29yZGVycyB1bml0LiBJdCBh
bHNvIHN1cHBvcnQgdGlsZWQgZnJhbWVidWZmZXIgZm9ybWF0IHdoaWNoDQpjYW4gYmUgc2Nhbm91
dCB0aGUgdGlsZWQgZnJhbWVidWZmZXIgcmVuZGVyZWQgYnkgdGhlIExvb25nR1BVIGRpcmVjdGx5
Lg0KDQp2MSAtPiB2MjoNCiAxKSBVc2UgaHBkIHN0YXR1cyByZWcgd2hlbiBwb2xsaW5nIGZvciBs
czdhMjAwMA0KIDIpIEZpeCBhbGwgd2FybmluZ3MgZW1lcmdlZCB3aGVuIGNvbXBpbGUgd2l0aCBX
PTENCg0KdjIgLT4gdjM6DQogMSkgQWRkIENPTVBJTEVfVEVTVCBpbiBLY29uZmlnIGFuZCBtYWtl
IHRoZSBkcml2ZXIgb2ZmIGJ5IGRlZmF1bHQNCiAyKSBBbHBoYWJldGljYWwgc29ydGluZyBoZWFk
ZXJzIChUaG9tYXMpDQogMykgVW50YW5nbGUgcmVnaXN0ZXIgYWNjZXNzIGZ1bmN0aW9ucyBhcyBt
dWNoIGFzIHBvc3NpYmxlIChUaG9tYXMpDQogNCkgU3dpdGNoIHRvIFRUTSBiYXNlZCBtZW1vcnkg
bWFuYWdlciBhbmQgcHJlZmVyIGNhY2hlZCBtYXBwaW5nDQogICAgZm9yIExvb25nc29uIFNvQyAo
VGhvbWFzKQ0KIDUpIEFkZCBjaGlwIGlkIGRldGVjdGlvbiBtZXRob2QsIG5vdyBhbGwgbW9kZWxz
IGFyZSBkaXN0aW5ndWlzaGFibGUuDQogNikgUmV2aXNlIGJ1aWx0aW4gSERNSSBwaHkgZHJpdmVy
LCBuZWFybHkgYWxsIG1haW4gc3RyZWFtIG1vZGUNCiAgICBiZWxvdyA0S0AzMEh6IGlzIHRlc3Rl
ZCwgdGhpcyBkcml2ZXIgc3VwcG9ydGVkIHRoZXNlIG1vZGUgdmVyeQ0KICAgIHdlbGwgaW5jbHVk
aW5nIGNsb25lIGRpc3BsYXkgbW9kZSBhbmQgZXh0ZW5kIGRpc3BsYXkgbW9kZS4NCg0KdjMgLT4g
djQ6DQogMSkgUXVpY2tseSBmaXggYSBzbWFsbCBtaXN0YWtlLg0KDQp2NCAtPiB2NToNCiAxKSBE
cm9wIHBvdGVudGlhbCBzdXBwb3J0IGZvciBMb29uZ3NvbiAySyBzZXJpZXMgU29DIHRlbXBvcmFy
eSwNCiAgICB0aGlzIHBhcnQgc2hvdWxkIGJlIHJlc2VuZCB3aXRoIHRoZSBEVCBiaW5kaW5nIHBh
dGNoIGluIHRoZSBmdXR1cmUuDQogMikgQWRkIHBlciBkaXNwbGF5IHBpcGUgZGVidWdmcyBzdXBw
b3J0IHRvIHRoZSBidWlsdGluIEhETUkgZW5jb2Rlci4NCiAzKSBSZXdyaXRlIGF0b21pY191cGRh
dGUoKSBmb3IgaGFyZHdhcmUgY3Vyc29ycyBwbGFuZShUaG9tYXMpDQogNCkgUmV3cml0ZSBlbmNv
ZGVyIGFuZCBjb25uZWN0b3IgaW5pdGlhbGl6YXRpb24gcGFydCwgdW50YW5nbGUgaXQNCiAgICBh
Y2NvcmRpbmcgdG8gdGhlIGNoaXAoVGhvbWFzKS4NCg0KdjUgLT4gdjY6DQogMSkgUmVtb3ZlIHN0
cmF5IGNvZGUgd2hpY2ggZGlkbid0IGdldCB1c2VkLCBzYXkgbHNkY19vZl9nZXRfcmVzZXJ2ZWRf
cmFtDQogMikgRml4IGFsbCB0eXBvcyBJIGNvdWxkIGZvdW5kLCBtYWtlIHNlbnRlbmNlcyBhbmQg
Y29kZSBtb3JlIHJlYWRhYmxlDQogMykgVW50YW5nbGUgbHNkY19oZG1pKl9jb25uZWN0b3JfZGV0
ZWN0KCkgZnVuY3Rpb24gYWNjb3JkaW5nIHRvIHRoZSBwaXBlDQogNCkgQWZ0ZXIgYSBzZXJpb3Vz
IGNvbnNpZGVyYXRpb24sIHdlIHJlbmFtZSB0aGlzIGRyaXZlciBhcyBsb29uZ3Nvbi4NCiAgICBC
ZWNhdXNlIHdlIGFsc28gaGF2ZSBkcml2ZXJzIHRvd2FyZCB0aGUgTG9vbmdHUFUgSVAgaW4gTFM3
QTIwMDAgYW5kDQogICAgTFMySzIwMDAuIEJlc2lkZXMsIHRoZXJlIGFyZSBhbHNvIGRyaXZlcnMg
YWJvdXQgdGhlIGV4dGVybmFsIGVuY29kZXIsDQogICAgSERNSSBhdWRpbyBkcml2ZXIgYW5kIHZi
aW9zIHN1cHBvcnQgZXRjLiBUaGlzIHBhdGNoIG9ubHkgcHJvdmlkZSBEQw0KICAgIGRyaXZlciBw
YXJ0LCBteSB0ZWFtbWF0ZSBMaSBZaSBiZWxpZXZlIHRoYXQgbG9vbmdzb24gd2lsbCBiZSBtb3Jl
DQogICAgc3VpdGFibGUgZm9yIGxvb25nc29uIGdyYXBoaWNzIHRoYW4gbHNkYyBpbiB0aGUgbG9u
ZyBydW4uDQoNCiAgICBsb29uZ3Nvbi5rbyA9IExTREMgKyBMb29uZ0dQVSArIGVuY29kZXJzIGRy
aXZlciArIHZiaW9zL0RUIC4uLg0KDQp2NiAtPiB2NzoNCiAxKSBBZGQgcHJpbWUgc3VwcG9ydCwg
c2VsZi1zaGFyaW5nIGlzIHdvcmtzLiBzaGFyaW5nIGJ1ZmZlciB3aXRoIGV0bmF2aXYNCiAgICBp
cyBhbHNvIHRlc3RlZCwgYW5kIGl0cyB3b3JrcyB3aXRoIGxpbWl0YXRpb24uDQogMikgSW1wbGVt
ZW50IGJ1ZmZlciBvYmplY3RzIHRyYWNraW5nIHdpdGggbGlzdF9oZWFkLg0KIDMpIFMzKHNsZWVw
IHRvIFJBTSkgaXMgdGVzdGVkIG9uIGxzM2E1MDAwK2xzN2EyMDAwIGV2YiBhbmQgaXQgd29ya3Mu
DQogNCkgUmV3cml0ZSBsc2RjX2JvX21vdmUsIHNpbmNlIHR0bSBjb3JlIHN0b3AgYWxsb2NhdGlu
ZyByZXNvdXJjZXMNCiAgICBkdXJpbmcgQk8gY3JlYXRpb24uIFBhdGNoIFYxIH4gVjYgb2YgdGhp
cyBzZXJpZXMgbm8gbG9uZ2VyIHdvcmtzDQogICAgb24gbGF0ZXN0IGtlcm5lbC4gVGh1cywgd2Ug
c2VuZCBWNyB0byByZXZpdmFsIHRoZW0uDQoNCnY3IC0+IHY4Og0KIDEpIFplcm8gYSBjb21waWxl
IHdhcm5uaW5ncyBvbiAzMi1iaXQgcGxhdGZvcm0sIGNvbXBpbGUgd2l0aCBXPTENCiAyKSBSZXZp
c2UgbHNkY19ib19ncHVfb2Zmc2V0KCkgYW5kIG1pbm9yIGNsZWFudXANCiAzKSBQYWdlZmxpcCB0
ZXN0ZWQgb24gdGhlIHZpcnR1YWwgdGVybWluYWwgd2l0aCBmb2xsb3dpbmcgY29tbWFuZHMNCg0K
ICAgIG1vZGV0ZXN0IC1NIGxvb25nc29uIC1zIDMyOjE5MjB4MTA4MCAtdg0KICAgIG1vZGV0ZXN0
IC1NIGxvb25nc29uIC1zIDM0OjE5MjB4MTA4MCAtdiAtRiB0aWxlcw0KDQogICBJdCB3b3JrcyBs
aWtlIGEgY2hhcm0sIHdoZW4gcnVubmluZyBwYWdlZmxpcCB0ZXN0IHdpdGggZHVhbCBzY3Jlbm4N
CiAgIGNvbmZpZ3VyYXRpb24sIGFub3RoZXIgdHdvIGFkZGl0aW9uYWwgYm8gY3JlYXRlZCBieSB0
aGUgbW9kZXRlc3QNCiAgIGVtZXJnZWQsIFZSQU0gdXNhZ2UgdXAgdG8gNDArTUIsIHdlbGwgd2Ug
aGF2ZSBhdCBsZWFzdCA2NE1CLCBzdGlsbA0KICAgZW5vdWdoLg0KDQogICAjIGNhdCBib3MNCg0K
ICAgICAgIGJvWzAwMDBdOiBzaXplOiAgICAgODExMmtCIFZSQU0NCiAgICAgICBib1swMDAxXTog
c2l6ZTogICAgICAgMTZrQiBWUkFNDQogICAgICAgYm9bMDAwMl06IHNpemU6ICAgICAgIDE2a0Ig
VlJBTQ0KICAgICAgIGJvWzAwMDNdOiBzaXplOiAgICAxNjIwOGtCIFZSQU0NCiAgICAgICBib1sw
MDA0XTogc2l6ZTogICAgIDgxMTJrQiBWUkFNDQogICAgICAgYm9bMDAwNV06IHNpemU6ICAgICA4
MTEya0IgVlJBTQ0KDQp2OCAtPiB2OToNCiAxKSBTZWxlY3QgSTJDIGFuZCBJMkNfQUxHT0JJVCBp
biBLY29uZmlnIGFuZCBzaG91bGQgZGVwZW5kIG9uIE1NVS4NCiAyKSBVc2luZyBwY2lfZ2V0X2Rv
bWFpbl9idXNfYW5kX3Nsb3QgdG8gZ2V0IHRoZSBHUFUgZGV2aWNlLg0KIDMpIE90aGVyIG1pbm9y
IGltcHJvdmVtZW50cy4NCg0KIFRob3NlIHBhdGNoZXMgYXJlIHRlc3RlZCBvbiBsczNhNTAwMCAr
IGxzN2ExMDAwIENSQiwgbHMzYTUwMDAgKyBsczdhMjAwMA0KIGV2YiwgYW5kIGxlbW90ZSBhMTkw
MSBib2FyZChsczNhNDAwMCArIGxzN2ExMDAwKS4gT24gbG9vbmdzb24gbWlwcyBDUFUsDQogdGhl
IHdyaXRlIGNvbWJpbmUgc3VwcG9ydCBzaG91bGQgYmUgZW5hYmxlZCwgdG8gZ2V0IGEgZGVjZW50
IHBlcmZvcm1hbmNlDQogZm9yIHdyaXRpbmcgZnJhbWVidWZmZXIgZGF0YSB0byB0aGUgVlJBTS4N
Cg0KdjkgLT4gdjEwOg0KIDEpIFJldmlzZSBsc2RjX2RybV9mcmVlemUoKSB0byBpbXBsZW1lbnQg
UzMgY29tcGxldGVseSBhbmQgY29ycmVjdGx5Lg0KICAgIEkgc3VkZGVubHkgcmVhbGl6ZWQgdGhh
dCBwaW5uZWQgYnVmZmVyIGNhbiBub3QgbW92ZSBhbmQgVlJBTSBsb3N0DQogICAgcG93ZXIgd2hl
biBzbGVlcCB0byBSQU0uIFRodXMsIHRoZSBkYXRhIGluIHRoZSBidWZmZXIgd2hvIGlzIHBpbm5l
ZA0KICAgIGluIFZSQU0gd2lsbCBnZXQgbG9zdCB3aGVuIHJlc3VtZS4gWWV0IGl0J3Mgbm90IGJp
ZyBwcm9ibGVtIGJlY2F1c2UNCiAgICB3ZSBhcmUgc29mdHdhcmUgcmVuZGVyaW5nIHNvbHV0aW9u
IHdoaWNoIHJlbGF5IG9uIHRoZSBDUFUgdXBkYXRlIHRoZQ0KICAgIGZyb250IGZyYW1lYnVmZmVy
LiBXZSBjYW4gc2VlIHRoZSBnYXJiYWdlIGRhdGEgd2hlbiByZXN1bWUgZnJvbSBTMywNCiAgICBi
dXQgdGhlIHNjcmVlbiB3aWxsIHNob3cgY29ycmVjdCBpbWFnZSBhcyBJIG1vdmUgdGhlIGN1cnNv
ci4gVGhpcyBpcw0KICAgIGR1ZSB0byB0aGUgY3B1IHJlcGFpbnQuIHYxMCBvZiB0aGlzIHBhdGNo
IG1ha2UgUzMgcGVyZmVjdCBieSB1bnBpbg0KICAgIGFsbCBvZiBCT3MgaW4gVlJBTSwgZXZpY3Qg
dGhlbSBhbGwgdG8gc3lzdGVtIFJBTS4NCg0KdjEwIC0+IHYxMToNCiAxKSBPbiBkb3VibGUgc2Ny
ZWVuIGNhc2UsIHRoZSBzaW5nbGUgZ2lhbnQgZnJhbWVidWZmZXIgaXMgcmVmZXJlbmNlZCBieQ0K
ICAgIHR3byBHRU0gb2JqZWN0LCBoZW5jZSwgaXQgd2lsbCBiZSBwaW5uZWQgYnkgcHJlcGFyZV9m
YigpIGF0IGxlYXNlIHR3bw0KICAgIHRpbWVzLiBUaGlzIGNhdXNlIGl0cyBwaW4gY291bnQgPiAx
LiBWMTAgb2YgdGhpcyBwYXRjaCBvbmx5IHVucGluIFZSQU0NCiAgICBCT3Mgb25jZSB3aGVuIHN1
c3BlbmQsIHdoaWNoIGlzIG5vdCBjb3JyZWN0IG9uIGRvdWJsZSBzY3JlZW4gY2FzZS4gVjExDQog
ICAgb2YgdGhpcyBwYXRjaCB1bnBpbiBCT3MgdW50aWwgaXRzIHBpbiBjb3VudCByZWFjaCB0byB6
ZXJvIHdoZW4gc3VzcGVuZC4NCiAgICBUaGVuLCB3ZSBtYWtlIHRoZSBTMyBzdXBwb3J0IGNvbXBs
ZXRlIGZpbmFsbHkuIFdpdGggdjExLCBJIGNhbid0IHNlZQ0KICAgIGFueSBnYXJiYWdlIGRhdGEg
YWZ0ZXIgcmVzdW1lLiBUZXN0ZWQgb24gYm90aCBsczdhMTAwMCBhbmQgbHM3YTIwMDANCiAgICBw
bGF0Zm9ybSwgd2l0aCBzaW5nbGUgc2NyZWVuIGFuZCBkb3VibGUgc2NyZWVuIGNvbmZpZ3VyYXRp
b24uDQogMikgRml4IHZibGFuayB3YWl0IHRpbWVvdXQgd2hlbiBkaXNhYmxlIENSVEMuDQogMykg
VGVzdCBhZ2FpbnN0IElHVCwgYXQgbGVhc3QgZmJkZXYgdGVzdCBhbmQga21zX2ZsaXAgdGVzdCBw
YXNzZWQuDQogNCkgUmV3cml0ZSBwaXhlbCBQTEwgdXBkYXRlIGZ1bmN0aW9uLCBtYWdpYyBudW1i
ZXJzIGVsaW1pbmF0ZWQgKEVtaWwpDQogNSkgRHJvcCBhIGZldyBjb21tb24gaGFyZHdhcmUgZmVh
dHVyZXMgZGVzY3JpcHRpb24gaW4gbHNkY19kZXNjIChFbWlsKQ0KIDYpIERyb3AgbHNkY19tb2Rl
X2NvbmZpZ19tb2RlX3ZhbGlkKCksIGluc3RlYWQgYWRkIHJlc3RyaWN0aW9ucyBpbiBkdW1iDQog
ICAgY3JlYXRlIGZ1bmN0aW9uLiAoRW1pbCkNCiA3KSBVbnRhbmdsZSB0aGUgbHM3YTEwMDAgY2Fz
ZSBhbmQgbHM3YTIwMDAgY2FzZSBjb21wbGV0ZWx5IChUaG9tYXMpDQoNCnYxMSAtPiB2MTI6DQog
bm9uZQ0KDQp2MTIgLT4gdjEzOg0KIDEpIEFkZCBiZW5jaG1hcmsgdG8gZmlndXJlIG91dCB0aGUg
YmFuZHdpZHRoIG9mIHRoZSBoYXJkd2FyZSBwbGF0Zm9ybS4NCiAgICBVc2FnZToNCiAgICAjIGNk
IC9zeXMva2VybmVsL2RlYnVnL2RyaS8wLw0KICAgICMgY2F0IGJlbmNobWFyaw0KDQogMikgVlJB
TSBpcyBmaWxsZWQgd2l0aCBnYXJiYWdlIGRhdGEgaWYgdW5pbml0aWFsaXplZCwgYWRkIGEgYnVm
ZmVyDQogICAgY2xlYXJpbmcgcHJvY2VkdXJlLCBjbGVhciBpdCBvbiB0aGUgQk8gY3JlYXRpb24g
dGltZS4NCiAzKSBVcGRhdGUgY29weXJpZ2h0cyBhbmQgYWRqdXN0IGNvZGluZyBzdHlsZSAoSHVh
Y2FpKQ0KDQp2MTMgLT4gdjE0Og0KIDEpIFRyeWluZyB0byBhZGQgYXN5bmMgdXBkYXRlIHN1cHBv
cnQgZm9yIGN1cnNvciBwbGFuZS4NCg0KU2lnbmVkLW9mZi1ieTogTGkgWWkgPGxpeWlAbG9vbmdz
b24uY24+DQpTaWduZWQtb2ZmLWJ5OiBTdWkgSmluZ2ZlbmcgPHN1aWppbmdmZW5nQGxvb25nc29u
LmNuPg0KVGVzdGVkLWJ5OiBMaXUgUGVpYmFvIDxsaXVwZWliYW9AbG9vbmdzb24uY24+DQpDYzog
TWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4NCkNj
OiBNYXhpbWUgUmlwYXJkIDxtcmlwYXJkQGtlcm5lbC5vcmc+DQpDYzogVGhvbWFzIFppbW1lcm1h
bm4gPHR6aW1tZXJtYW5uQHN1c2UuZGU+DQpDYzogRGF2aWQgQWlybGllIDxhaXJsaWVkQGdtYWls
LmNvbT4NCkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWxAZmZ3bGwuY2g+DQpDYzogU3VtaXQgU2Vt
d2FsIDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4NCkNjOiAiQ2hyaXN0aWFuIEvDtm5pZyIgPGNo
cmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4NCkNjOiBOYXRoYW4gQ2hhbmNlbGxvciA8bmF0aGFuQGtl
cm5lbC5vcmc+DQpDYzogRW1pbCBWZWxpa292IDxlbWlsLmwudmVsaWtvdkBnbWFpbC5jb20+DQpD
YzogR2VlcnQgVXl0dGVyaG9ldmVuIDxnZWVydCtyZW5lc2FzQGdsaWRlci5iZT4NCkNjOiBKYXZp
ZXIgTWFydGluZXogQ2FuaWxsYXMgPGphdmllcm1AcmVkaGF0LmNvbT4NCi0tLQ0KIGRyaXZlcnMv
Z3B1L2RybS9LY29uZmlnICAgICAgICAgICAgICAgICAgICAgICB8ICAgIDIgKw0KIGRyaXZlcnMv
Z3B1L2RybS9NYWtlZmlsZSAgICAgICAgICAgICAgICAgICAgICB8ICAgIDEgKw0KIGRyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9LY29uZmlnICAgICAgICAgICAgICB8ICAgMTcgKw0KIGRyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9NYWtlZmlsZSAgICAgICAgICAgICB8ICAgMjAgKw0KIGRyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5jICAgICB8ICAxMzMgKysNCiBkcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaCAgICAgfCAgIDEzICsNCiBkcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19jcnRjLmMgICAgICAgICAgfCAxMDY2ICsrKysrKysrKysr
KysrKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGVidWdmcy5jICAgICAgIHwg
ICA5MSArKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2RldmljZS5jICAgICAgICB8
ICAxMDQgKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kcnYuYyAgICAgICAgICAg
fCAgNDk1ICsrKysrKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmggICAg
ICAgICAgIHwgIDQ1MSArKysrKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2Vt
LmMgICAgICAgICAgIHwgIDMyNCArKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X2dlbS5oICAgICAgICAgICB8ICAgMzcgKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X2dmeHBsbC5jICAgICAgICB8ICAxOTkgKysrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfZ2Z4cGxsLmggICAgICAgIHwgICA1MiArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfaTJjLmMgICAgICAgICAgIHwgIDE3OSArKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24v
bHNkY19pMmMuaCAgICAgICAgICAgfCAgIDI5ICsNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24v
bHNkY19pcnEuYyAgICAgICAgICAgfCAgIDcxICsrDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfaXJxLmggICAgICAgICAgIHwgICAxNiArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfb3V0cHV0LmggICAgICAgIHwgICAyMSArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfb3V0cHV0XzdhMTAwMC5jIHwgIDE2MSArKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19vdXRwdXRfN2EyMDAwLmMgfCAgNTMxICsrKysrKysrDQogZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfcGl4cGxsLmMgICAgICAgIHwgIDQ4MSArKysrKysrKw0KIGRyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX3BpeHBsbC5oICAgICAgICB8ICAgODYgKysNCiBkcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19wbGFuZS5jICAgICAgICAgfCAgNzgxICsrKysrKysrKysr
Kw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMgICAgICAgICB8ICAgNTYg
Kw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmggICAgICAgICB8ICAgMTIg
Kw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3JlZ3MuaCAgICAgICAgICB8ICA0MDIg
KysrKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3R0bS5jICAgICAgICAgICB8
ICA2MTAgKysrKysrKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3R0bS5oICAg
ICAgICAgICB8ICAgOTkgKysNCiAzMCBmaWxlcyBjaGFuZ2VkLCA2NTQwIGluc2VydGlvbnMoKykN
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25maWcNCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL01ha2VmaWxlDQogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5j
DQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNo
bWFyay5oDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X2NydGMuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19kZWJ1Z2ZzLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfZGV2aWNlLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZHJ2LmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZHJ2LmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZ2VtLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZ2VtLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZ2Z4cGxsLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfZ2Z4cGxsLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfaTJjLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfaTJjLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfaXJxLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfaXJxLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfb3V0cHV0LmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0XzdhMTAwMC5jDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRy
aXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX291dHB1dF83YTIwMDAuYw0KIGNyZWF0ZSBtb2Rl
IDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19waXhwbGwuYw0KIGNyZWF0ZSBt
b2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19waXhwbGwuaA0KIGNyZWF0
ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19wbGFuZS5jDQogY3Jl
YXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMNCiBj
cmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuaA0K
IGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19yZWdzLmgN
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmMN
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmgN
Cg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJt
L0tjb25maWcNCmluZGV4IGJhM2ZiMDRiYjY5MS4uZDFmYTg3ZDJhY2I3IDEwMDY0NA0KLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL0tjb25maWcNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnDQpA
QCAtMzMxLDYgKzMzMSw4IEBAIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL3YzZC9LY29uZmlnIg0K
IA0KIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL3ZjNC9LY29uZmlnIg0KIA0KK3NvdXJjZSAiZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25maWciDQorDQogc291cmNlICJkcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9LY29uZmlnIg0KIA0KIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNv
bi9LY29uZmlnIg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZSBiL2RyaXZl
cnMvZ3B1L2RybS9NYWtlZmlsZQ0KaW5kZXggYTMzMjU3ZDJiYzdmLi4xMzE1MzE0NTNiOGUgMTAw
NjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUNCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9NYWtlZmlsZQ0KQEAgLTE5NCwzICsxOTQsNCBAQCBvYmoteQkJCSs9IGd1ZC8NCiBvYmotJChD
T05GSUdfRFJNX0hZUEVSVikgKz0gaHlwZXJ2Lw0KIG9iai15CQkJKz0gc29sb21vbi8NCiBvYmot
JChDT05GSUdfRFJNX1NQUkQpICs9IHNwcmQvDQorb2JqLSQoQ09ORklHX0RSTV9MT09OR1NPTikg
Kz0gbG9vbmdzb24vDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25m
aWcgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vS2NvbmZpZw0KbmV3IGZpbGUgbW9kZSAxMDA2
NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZGY2OTQ2ZDUwNWZhDQotLS0gL2Rldi9udWxsDQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vS2NvbmZpZw0KQEAgLTAsMCArMSwxNyBAQA0KKyMg
U1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisNCitjb25maWcgRFJNX0xPT05HU09O
DQorCXRyaXN0YXRlICJEUk0gc3VwcG9ydCBmb3IgTG9vbmdzb24gR3JhcGhpY3MiDQorCWRlcGVu
ZHMgb24gRFJNICYmIFBDSSAmJiBNTVUNCisJc2VsZWN0IERSTV9LTVNfSEVMUEVSDQorCXNlbGVj
dCBEUk1fVFRNDQorCXNlbGVjdCBJMkMNCisJc2VsZWN0IEkyQ19BTEdPQklUDQorCWhlbHANCisJ
ICBUaGlzIGlzIGEgRFJNIGRyaXZlciBmb3IgTG9vbmdzb24gR3JhcGhpY3MsIGl0IG1heSBpbmNs
dWRpbmcNCisJICBMUzdBMjAwMCwgTFM3QTEwMDAsIExTMksyMDAwIGFuZCBMUzJLMTAwMCBldGMu
IExvb25nc29uIExTN0ENCisJICBzZXJpZXMgYXJlIGJyaWRnZSBjaGlwc2V0LCB3aGlsZSBMb29u
Z3NvbiBMUzJLIHNlcmllcyBhcmUgU29DLg0KKw0KKwkgIElmICJNIiBpcyBzZWxlY3RlZCwgdGhl
IG1vZHVsZSB3aWxsIGJlIGNhbGxlZCBsb29uZ3Nvbi4NCisNCisJICBJZiBpbiBkb3VidCwgc2F5
ICJOIi4NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vTWFrZWZpbGUgYi9k
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vTWFrZWZpbGUNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQpp
bmRleCAwMDAwMDAwMDAwMDAuLjkxNTg4MTZlY2U4ZQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL01ha2VmaWxlDQpAQCAtMCwwICsxLDIwIEBADQorIyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKw0KK2xvb25nc29uLXkgOj0gXA0KKwlsc2Rj
X2JlbmNobWFyay5vIFwNCisJbHNkY19jcnRjLm8gXA0KKwlsc2RjX2RlYnVnZnMubyBcDQorCWxz
ZGNfZGV2aWNlLm8gXA0KKwlsc2RjX2Rydi5vIFwNCisJbHNkY19nZW0ubyBcDQorCWxzZGNfZ2Z4
cGxsLm8gXA0KKwlsc2RjX2kyYy5vIFwNCisJbHNkY19pcnEubyBcDQorCWxzZGNfb3V0cHV0Xzdh
MTAwMC5vIFwNCisJbHNkY19vdXRwdXRfN2EyMDAwLm8gXA0KKwlsc2RjX3BsYW5lLm8gXA0KKwls
c2RjX3BpeHBsbC5vIFwNCisJbHNkY19wcm9iZS5vIFwNCisJbHNkY190dG0ubw0KKw0KK29iai0k
KENPTkZJR19EUk1fTE9PTkdTT04pICs9IGxvb25nc29uLm8NCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29u
Z3Nvbi9sc2RjX2JlbmNobWFyay5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAw
MDAwMDAwLi44Mjk2MTUzMWQ4NGMNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5jDQpAQCAtMCwwICsxLDEzMyBAQA0KKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIz
IExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNs
dWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisNCisjaW5jbHVkZSAibHNkY19iZW5jaG1hcmsuaCIN
CisjaW5jbHVkZSAibHNkY19kcnYuaCINCisjaW5jbHVkZSAibHNkY19nZW0uaCINCisjaW5jbHVk
ZSAibHNkY190dG0uaCINCisNCit0eXBlZGVmIHZvaWQgKCpsc2RjX2NvcHlfcHJvY190KShzdHJ1
Y3QgbHNkY19ibyAqc3JjX2JvLA0KKwkJCQkgc3RydWN0IGxzZGNfYm8gKmRzdF9ibywNCisJCQkJ
IHVuc2lnbmVkIGludCBzaXplLA0KKwkJCQkgaW50IG4pOw0KKw0KK3N0YXRpYyB2b2lkIGxzZGNf
Y29weV9ndHRfdG9fdnJhbV9jcHUoc3RydWN0IGxzZGNfYm8gKnNyY19ibywNCisJCQkJICAgICAg
c3RydWN0IGxzZGNfYm8gKmRzdF9ibywNCisJCQkJICAgICAgdW5zaWduZWQgaW50IHNpemUsDQor
CQkJCSAgICAgIGludCBuKQ0KK3sNCisJbHNkY19ib19rbWFwKHNyY19ibyk7DQorCWxzZGNfYm9f
a21hcChkc3RfYm8pOw0KKw0KKwl3aGlsZSAobi0tKQ0KKwkJbWVtY3B5X3RvaW8oZHN0X2JvLT5r
cHRyLCBzcmNfYm8tPmtwdHIsIHNpemUpOw0KKw0KKwlsc2RjX2JvX2t1bm1hcChzcmNfYm8pOw0K
Kwlsc2RjX2JvX2t1bm1hcChkc3RfYm8pOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NvcHlf
dnJhbV90b19ndHRfY3B1KHN0cnVjdCBsc2RjX2JvICpzcmNfYm8sDQorCQkJCSAgICAgIHN0cnVj
dCBsc2RjX2JvICpkc3RfYm8sDQorCQkJCSAgICAgIHVuc2lnbmVkIGludCBzaXplLA0KKwkJCQkg
ICAgICBpbnQgbikNCit7DQorCWxzZGNfYm9fa21hcChzcmNfYm8pOw0KKwlsc2RjX2JvX2ttYXAo
ZHN0X2JvKTsNCisNCisJd2hpbGUgKG4tLSkNCisJCW1lbWNweV9mcm9taW8oZHN0X2JvLT5rcHRy
LCBzcmNfYm8tPmtwdHIsIHNpemUpOw0KKw0KKwlsc2RjX2JvX2t1bm1hcChzcmNfYm8pOw0KKwls
c2RjX2JvX2t1bm1hcChkc3RfYm8pOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NvcHlfZ3R0
X3RvX2d0dF9jcHUoc3RydWN0IGxzZGNfYm8gKnNyY19ibywNCisJCQkJICAgICBzdHJ1Y3QgbHNk
Y19ibyAqZHN0X2JvLA0KKwkJCQkgICAgIHVuc2lnbmVkIGludCBzaXplLA0KKwkJCQkgICAgIGlu
dCBuKQ0KK3sNCisJbHNkY19ib19rbWFwKHNyY19ibyk7DQorCWxzZGNfYm9fa21hcChkc3RfYm8p
Ow0KKw0KKwl3aGlsZSAobi0tKQ0KKwkJbWVtY3B5KGRzdF9iby0+a3B0ciwgc3JjX2JvLT5rcHRy
LCBzaXplKTsNCisNCisJbHNkY19ib19rdW5tYXAoc3JjX2JvKTsNCisJbHNkY19ib19rdW5tYXAo
ZHN0X2JvKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19iZW5jaG1hcmtfY29weShzdHJ1Y3Qg
bHNkY19kZXZpY2UgKmxkZXYsDQorCQkJCXVuc2lnbmVkIGludCBzaXplLA0KKwkJCQl1bnNpZ25l
ZCBpbnQgbiwNCisJCQkJdTMyIHNyY19kb21haW4sDQorCQkJCXUzMiBkc3RfZG9tYWluLA0KKwkJ
CQlsc2RjX2NvcHlfcHJvY190IGNvcHlfcHJvYywNCisJCQkJc3RydWN0IGRybV9wcmludGVyICpw
KQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSAmbGRldi0+YmFzZTsNCisJc3RydWN0
IGxzZGNfYm8gKnNyY19ibzsNCisJc3RydWN0IGxzZGNfYm8gKmRzdF9ibzsNCisJdW5zaWduZWQg
bG9uZyBzdGFydF9qaWZmaWVzOw0KKwl1bnNpZ25lZCBsb25nIGVuZF9qaWZmaWVzOw0KKwl1bnNp
Z25lZCBpbnQgdGhyb3VnaHB1dDsNCisJdW5zaWduZWQgaW50IHRpbWU7DQorDQorCXNyY19ibyA9
IGxzZGNfYm9fY3JlYXRlX2tlcm5lbF9waW5uZWQoZGRldiwgc3JjX2RvbWFpbiwgc2l6ZSk7DQor
CWRzdF9ibyA9IGxzZGNfYm9fY3JlYXRlX2tlcm5lbF9waW5uZWQoZGRldiwgZHN0X2RvbWFpbiwg
c2l6ZSk7DQorDQorCXN0YXJ0X2ppZmZpZXMgPSBqaWZmaWVzOw0KKw0KKwljb3B5X3Byb2Moc3Jj
X2JvLCBkc3RfYm8sIHNpemUsIG4pOw0KKw0KKwllbmRfamlmZmllcyA9IGppZmZpZXM7DQorDQor
CWxzZGNfYm9fZnJlZV9rZXJuZWxfcGlubmVkKHNyY19ibyk7DQorCWxzZGNfYm9fZnJlZV9rZXJu
ZWxfcGlubmVkKGRzdF9ibyk7DQorDQorCXRpbWUgPSBqaWZmaWVzX3RvX21zZWNzKGVuZF9qaWZm
aWVzIC0gc3RhcnRfamlmZmllcyk7DQorDQorCXRocm91Z2hwdXQgPSAobiAqIChzaXplID4+IDEw
KSkgLyB0aW1lOw0KKw0KKwlkcm1fcHJpbnRmKHAsDQorCQkgICAiQ29weSBibyBvZiAldWtCICV1
IHRpbWVzIGZyb20gJXMgdG8gJXMgaW4gJXVtczogJXVNQi9zXG4iLA0KKwkJICAgc2l6ZSA+PiAx
MCwgbiwNCisJCSAgIGxzZGNfZG9tYWluX3RvX3N0cihzcmNfZG9tYWluKSwNCisJCSAgIGxzZGNf
ZG9tYWluX3RvX3N0cihkc3RfZG9tYWluKSwNCisJCSAgIHRpbWUsIHRocm91Z2hwdXQpOw0KK30N
CisNCitpbnQgbHNkY19zaG93X2JlbmNobWFya19jb3B5KHN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diwgc3RydWN0IGRybV9wcmludGVyICpwKQ0KK3sNCisJdW5zaWduZWQgaW50IGJ1ZmZlcl9zaXpl
ID0gMTkyMCAqIDEwODAgKiA0Ow0KKwl1bnNpZ25lZCBpbnQgaXRlcmF0aW9uID0gNjA7DQorDQor
CWxzZGNfYmVuY2htYXJrX2NvcHkobGRldiwNCisJCQkgICAgYnVmZmVyX3NpemUsDQorCQkJICAg
IGl0ZXJhdGlvbiwNCisJCQkgICAgTFNEQ19HRU1fRE9NQUlOX0dUVCwNCisJCQkgICAgTFNEQ19H
RU1fRE9NQUlOX0dUVCwNCisJCQkgICAgbHNkY19jb3B5X2d0dF90b19ndHRfY3B1LA0KKwkJCSAg
ICBwKTsNCisNCisJbHNkY19iZW5jaG1hcmtfY29weShsZGV2LA0KKwkJCSAgICBidWZmZXJfc2l6
ZSwNCisJCQkgICAgaXRlcmF0aW9uLA0KKwkJCSAgICBMU0RDX0dFTV9ET01BSU5fR1RULA0KKwkJ
CSAgICBMU0RDX0dFTV9ET01BSU5fVlJBTSwNCisJCQkgICAgbHNkY19jb3B5X2d0dF90b192cmFt
X2NwdSwNCisJCQkgICAgcCk7DQorDQorCWxzZGNfYmVuY2htYXJrX2NvcHkobGRldiwNCisJCQkg
ICAgYnVmZmVyX3NpemUsDQorCQkJICAgIGl0ZXJhdGlvbiwNCisJCQkgICAgTFNEQ19HRU1fRE9N
QUlOX1ZSQU0sDQorCQkJICAgIExTRENfR0VNX0RPTUFJTl9HVFQsDQorCQkJICAgIGxzZGNfY29w
eV92cmFtX3RvX2d0dF9jcHUsDQorCQkJICAgIHApOw0KKw0KKwlyZXR1cm4gMDsNCit9DQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfYmVuY2htYXJrLmggYi9kcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaA0KbmV3IGZpbGUgbW9kZSAxMDA2
NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uMmJmOTQwNmVhZTljDQotLS0gL2Rldi9udWxsDQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaA0KQEAgLTAsMCArMSwx
MyBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBD
b3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVk
DQorICovDQorDQorI2lmbmRlZiBfX0xTRENfQkVOQ0hNQVJLX0hfXw0KKyNkZWZpbmUgX19MU0RD
X0JFTkNITUFSS19IX18NCisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisNCitpbnQgbHNkY19z
aG93X2JlbmNobWFya19jb3B5KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwgc3RydWN0IGRybV9w
cmludGVyICpwKTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19jcnRjLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19jcnRjLmMN
Cm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmRlMmMxZDUxNGJhYQ0K
LS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfY3J0Yy5j
DQpAQCAtMCwwICsxLDEwNjYgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIu
MA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9y
YXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51eC9kZWxheS5oPg0KKw0KKyNp
bmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxw
ZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9kZWJ1Z2ZzLmg+DQorI2luY2x1ZGUgPGRybS9kcm1f
dmJsYW5rLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQorLyoNCisgKiBUaGUgc29m
dCByZXNldCBjYXVzZSB0aGUgdmJsYW5rIGNvdW50ZXIgcmVzZXQgdG8gemVybywgYnV0IHRoZSBh
ZGRyZXNzDQorICogYW5kIG90aGVyIHNldHRpbmdzIGluIHRoZSBjcnRjIHJlZ2lzdGVyIHJlbWFp
bnMuDQorICovDQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9zb2Z0X3Jlc2V0KHN0cnVjdCBs
c2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMt
PmxkZXY7DQorCXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JU
QzBfQ0ZHX1JFRyk7DQorDQorCXZhbCAmPSBDRkdfVkFMSURfQklUU19NQVNLOw0KKw0KKwkvKiBz
b2Z0IHJlc2V0IGJpdCwgYWN0aXZlIGxvdyAqLw0KKwl2YWwgJj0gfkNGR19SRVNFVF9OOw0KKw0K
Kwl2YWwgJj0gfkNGR19QSVhfRk1UX01BU0s7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENf
Q1JUQzBfQ0ZHX1JFRywgdmFsKTsNCisNCisJdWRlbGF5KDUpOw0KKw0KKwl2YWwgfD0gQ0ZHX1JF
U0VUX04gfCBMU0RDX1BGX1hSR0I4ODg4IHwgQ0ZHX09VVFBVVF9FTkFCTEU7DQorDQorCWxzZGNf
d3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRywgdmFsKTsNCisNCisJbWRlbGF5KDIwKTsN
Cit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9zb2Z0X3Jlc2V0KHN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7
DQorCXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZH
X1JFRyk7DQorDQorCXZhbCAmPSBDRkdfVkFMSURfQklUU19NQVNLOw0KKw0KKwkvKiBzb2Z0IHJl
c2V0IGJpdCwgYWN0aXZlIGxvdyAqLw0KKwl2YWwgJj0gfkNGR19SRVNFVF9OOw0KKw0KKwl2YWwg
Jj0gfkNGR19QSVhfRk1UX01BU0s7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFf
Q0ZHX1JFRywgdmFsKTsNCisNCisJdWRlbGF5KDUpOw0KKw0KKwl2YWwgfD0gQ0ZHX1JFU0VUX04g
fCBMU0RDX1BGX1hSR0I4ODg4IHwgQ0ZHX09VVFBVVF9FTkFCTEU7DQorDQorCWxzZGNfd3JlZzMy
KGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRywgdmFsKTsNCisNCisJbXNsZWVwKDIwKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9lbmFibGUoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMp
DQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisJdTMyIHZh
bDsNCisNCisJdmFsID0gbHNkY19ycmVnMzIobGRldiwgTFNEQ19DUlRDMF9DRkdfUkVHKTsNCisN
CisJLyoNCisJICogVGhpcyBtYXkgaGFwcGVucyBvbiBleHRyZW1lbHkgcmFyZSBjYXNlLCBsdWNr
aWx5LCBhIHNvZnQgcmVzZXQNCisJICogY2FuIGhlbHBzIHRvIGJyaW5nIGl0IGJhY2sgdG8gbm9y
bWFsLiBXZSBhZGQgYSB3YXJuIGhlcmUsIGhvcGUNCisJICogdG8gY2F0Y2ggc29tZXRoaW5nIGlm
IGl0IGhhcHBlbnMuDQorCSAqLw0KKw0KKwlpZiAodmFsICYgQ1JUQ19BTkNIT1JFRCkgew0KKwkJ
ZHJtX3dhcm4oJmxkZXYtPmJhc2UsICIlcyBhbmNob3JlZFxuIiwgbGNydGMtPmJhc2UubmFtZSk7
DQorCQlyZXR1cm4gbHNkY19jcnRjMF9zb2Z0X3Jlc2V0KGxjcnRjKTsNCisJfQ0KKw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIHZhbCB8IENGR19PVVRQVVRfRU5BQkxF
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9kaXNhYmxlKHN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7
DQorDQorCWxzZGNfdXJlZzMyX2NscihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIENGR19PVVRQ
VVRfRU5BQkxFKTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2Ny
dGMxX2VuYWJsZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2Rl
dmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3Jy
ZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcpOw0KKwlpZiAodmFsICYgQ1JUQ19BTkNIT1JF
RCkgew0KKwkJZHJtX3dhcm4oJmxkZXYtPmJhc2UsICIlcyBhbmNob3JlZFxuIiwgbGNydGMtPmJh
c2UubmFtZSk7DQorCQlyZXR1cm4gbHNkY19jcnRjMV9zb2Z0X3Jlc2V0KGxjcnRjKTsNCisJfQ0K
Kw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHZhbCB8IENGR19PVVRQ
VVRfRU5BQkxFKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9kaXNhYmxlKHN0cnVj
dCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNy
dGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX2NscihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcs
IENGR19PVVRQVVRfRU5BQkxFKTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCisvKiBBbGwgbG9v
bmdzb24gZGlzcGxheSBjb250cm9sbGVyIHN1cHBvcnQgc2Nhbm91dCBwb3NpdGlvbiBoYXJkd2Fy
ZSAqLw0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzBfc2Nhbl9wb3Moc3RydWN0IGxzZGNfY3J0
YyAqbGNydGMsIGludCAqaHBvcywgaW50ICp2cG9zKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gbGNydGMtPmxkZXY7DQorCXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMy
KGxkZXYsIExTRENfQ1JUQzBfU0NBTl9QT1NfUkVHKTsNCisNCisJKmhwb3MgPSB2YWwgPj4gMTY7
DQorCSp2cG9zID0gdmFsICYgMHhmZmZmOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMx
X3NjYW5fcG9zKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjLCBpbnQgKmhwb3MsIGludCAqdnBvcykN
Cit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKwl1MzIgdmFs
Ow0KKw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX1NDQU5fUE9TX1JFRyk7
DQorDQorCSpocG9zID0gdmFsID4+IDE2Ow0KKwkqdnBvcyA9IHZhbCAmIDB4ZmZmZjsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9lbmFibGVfdmJsYW5rKHN0cnVjdCBsc2RjX2NydGMg
KmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQor
DQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0lOVF9SRUcsIElOVF9DUlRDMF9WU1lOQ19F
Tik7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzBfZGlzYWJsZV92Ymxhbmsoc3RydWN0
IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0
Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfY2xyKGxkZXYsIExTRENfSU5UX1JFRywgSU5UX0NS
VEMwX1ZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9lbmFibGVfdmJs
YW5rKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICps
ZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0lOVF9S
RUcsIElOVF9DUlRDMV9WU1lOQ19FTik7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzFf
ZGlzYWJsZV92Ymxhbmsoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNk
Y19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfY2xyKGxkZXYs
IExTRENfSU5UX1JFRywgSU5UX0NSVEMxX1ZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQg
bHNkY19jcnRjMF9mbGlwKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxz
ZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2
LCBMU0RDX0NSVEMwX0NGR19SRUcsIENGR19QQUdFX0ZMSVApOw0KK30NCisNCitzdGF0aWMgdm9p
ZCBsc2RjX2NydGMxX2ZsaXAoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3Qg
bHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfc2V0KGxk
ZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRywgQ0ZHX1BBR0VfRkxJUCk7DQorfQ0KKw0KKy8qDQorICog
Q1JUQzAgY2xvbmUgZnJvbSBDUlRDMSBvciBDUlRDMSBjbG9uZSBmcm9tIENSVEMwIHVzaW5nIGhh
cmR3YXJlIGxvZ2ljLg0KKyAqIEhhcmR3YXJlIGVuZ2luZWVyIHNheSB0aGlzIHdvdWxkIGhlbHAg
dG8gc2F2aW5nIGJhbmR3aWR0aCBvbiBjbG9uZSBtb2RlLg0KKyAqDQorICogVGhpcyBtYXkgdXNl
ZnVsIG9uIGN1c3RvbSBjbG9uZSBhcHBsaWNhdGlvbi4NCisgKi8NCisNCitzdGF0aWMgdm9pZCBs
c2RjX2NydGMwX2Nsb25lKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxz
ZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2
LCBMU0RDX0NSVEMwX0NGR19SRUcsIENGR19IV19DTE9ORSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lk
IGxzZGNfY3J0YzFfY2xvbmUoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3Qg
bHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfc2V0KGxk
ZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRywgQ0ZHX0hXX0NMT05FKTsNCit9DQorDQorc3RhdGljIHZv
aWQgbHNkY19jcnRjMF9zZXRfbW9kZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJY29u
c3Qgc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRD
MF9IRElTUExBWV9SRUcsDQorCQkgICAgKG1vZGUtPmNydGNfaHRvdGFsIDw8IDE2KSB8IG1vZGUt
PmNydGNfaGRpc3BsYXkpOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1ZESVNQ
TEFZX1JFRywNCisJCSAgICAobW9kZS0+Y3J0Y192dG90YWwgPDwgMTYpIHwgbW9kZS0+Y3J0Y192
ZGlzcGxheSk7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfSFNZTkNfUkVHLA0K
KwkJICAgIChtb2RlLT5jcnRjX2hzeW5jX2VuZCA8PCAxNikgfCBtb2RlLT5jcnRjX2hzeW5jX3N0
YXJ0IHwgSFNZTkNfRU4pOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1ZTWU5D
X1JFRywNCisJCSAgICAobW9kZS0+Y3J0Y192c3luY19lbmQgPDwgMTYpIHwgbW9kZS0+Y3J0Y192
c3luY19zdGFydCB8IFZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9z
ZXRfbW9kZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKm1vZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0
Yy0+bGRldjsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMV9IRElTUExBWV9SRUcs
DQorCQkgICAgKG1vZGUtPmNydGNfaHRvdGFsIDw8IDE2KSB8IG1vZGUtPmNydGNfaGRpc3BsYXkp
Ow0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZESVNQTEFZX1JFRywNCisJCSAg
ICAobW9kZS0+Y3J0Y192dG90YWwgPDwgMTYpIHwgbW9kZS0+Y3J0Y192ZGlzcGxheSk7DQorDQor
CWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFfSFNZTkNfUkVHLA0KKwkJICAgIChtb2RlLT5j
cnRjX2hzeW5jX2VuZCA8PCAxNikgfCBtb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IHwgSFNZTkNfRU4p
Ow0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZTWU5DX1JFRywNCisJCSAgICAo
bW9kZS0+Y3J0Y192c3luY19lbmQgPDwgMTYpIHwgbW9kZS0+Y3J0Y192c3luY19zdGFydCB8IFZT
WU5DX0VOKTsNCit9DQorDQorLyoNCisgKiBUaGlzIGlzIHJlcXVpcmVkIGZvciBTMyBzdXBwb3J0
Lg0KKyAqDQorICogQWZ0ZXIgcmVzdW1lIGZyb20gc3VzcGVuZCwgTFNEQ19DUlRDeF9DRkdfUkVH
ICh4PTAgb3IgMSlpcyBmaWxsZWQgd2l0aA0KKyAqIGdhcmJhcmdlIHZhbHVlIHdoaWNoIG1heSBj
YXVzZSB0aGUgQ1JUQyBjb21wbGV0ZWx5IGhhbmcuIFRoaXMgZnVuY3Rpb24NCisgKiBnaXZlIGEg
bWluaW1hbCBzZXR0aW5nIHRvIHRoZSBhZmZlY3RlZCByZWdpc3RlcnMuIFRoaXMgYWxzbyBvdmVy
cmlkZQ0KKyAqIHRoZSBmaXJtd2FyZSdzIHNldHRpbmcgb24gc3RhcnR1cCwgZWxpbWluYXRlIHBv
dGVudGlhbCBibGluZGluZyBzZXR0aW5nLg0KKyAqDQorICogTWFraW5nIHRoZSBDUlRDIHdvcmtz
IG9uIG91ciBvd24gbm93LCB0aGlzIGlzIHNpbWlsYXIgd2l0aCB0aGUgZnVuY3Rpb25hbA0KKyAq
IG9mIEdQVSBQT1NUKFBvd2VyIE9uIFNlbGYgVGVzdCkuIE9ubHkgdG91Y2ggQ1JUQyBoYXJkd2Fy
ZSByZWxhdGVkIHBhcnQuDQorICovDQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9yZXNldChz
dHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9
IGxjcnRjLT5sZGV2Ow0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmbGNydGMtPmJhc2U7DQor
CXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JF
Ryk7DQorDQorCS8qIFRoaXMgaGVscCB0byBzZWUgd2hhdCBpcyBpdCAqLw0KKwlkcm1fZGJnKCZs
ZGV2LT5iYXNlLCAidmFsdWUgb2YgJXMgY29uZmlndXJlIHJlZ2lzdGVyOiAleFxuIiwNCisJCWNy
dGMtPm5hbWUsIHZhbCk7DQorDQorCS8qDQorCSAqIEhlbHAgdGhlIENSVEMgZ2V0IG91dCBvZiBz
b2Z0IHJlc2V0IHNhdGUsIGFzIHRoZSBDUlRDIGlzIGNvbXBsZXRlbHkNCisJICogaGFsdCBvbiBz
b2Z0IHJlc2V0IG1vZGUgKEJJVCgyMCkgPSAwKS4gSXQgZG9lcyBub3QgZXZlbnQgZ2VuZXJhdGUN
CisJICogdmJsYW5rLCBjYXVzZSB2Ymxhbmsgd2FpdCB0aW1lb3V0LiBUaGlzIGhhcHBlbmRzIHdo
ZW4gcmVzdW1lIGZyb20NCisJICogUzMuDQorCSAqDQorCSAqIEFsc28gZ2l2ZSBhIHNhbmUgZm9y
bWF0LCBhZnRlciByZXN1bWUgZnJvbSBzdXNwZW5kIFMzLCB0aGlzDQorCSAqIHJlZ2lzdGVyIGlz
IGZpbGxlZCB3aXRoIGdhcmJhcmdlIHZhbHVlLiBBIG1lYW5pbmdsZXNzIHZhbHVlIG1heQ0KKwkg
KiBhbHNvIGNhdXNlIHRoZSBDUlRDIGhhbHQgb3Igc3RhbGwuDQorCSAqLw0KKw0KKwl2YWwgPSBD
RkdfUkVTRVRfTiB8IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1JUQzBfQ0ZHX1JFRywgdmFsKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9y
ZXNldChzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAq
bGRldiA9IGxjcnRjLT5sZGV2Ow0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmbGNydGMtPmJh
c2U7DQorCXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzFf
Q0ZHX1JFRyk7DQorDQorCWRybV9kYmcoJmxkZXYtPmJhc2UsICJ2YWx1ZSBvZiAlcyBjb25maWd1
ZSByZWdpc3RlcjogJXhcbiIsDQorCQljcnRjLT5uYW1lLCB2YWwpOw0KKw0KKwkvKg0KKwkgKiBI
ZWxwIHRoZSBDUlRDIGdldCBvdXQgb2Ygc29mdCByZXNldCBzYXRlLCBnaXZlIGEgc2FuZSBmb3Jt
YXQsDQorCSAqIE90aGVyd2lzZSBpdCB3aWxsIGhhbHQgb3Igc3RhbGwgdGhlcmUuDQorCSAqLw0K
Kwl2YWwgPSBDRkdfUkVTRVRfTiB8IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMy
KGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRywgdmFsKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0
cnVjdCBsc2RjX2NydGNfaHdfb3BzIGxzN2ExMDAwX2NydGNfaHdfb3BzWzJdID0gew0KKwl7DQor
CQkuZW5hYmxlID0gbHNkY19jcnRjMF9lbmFibGUsDQorCQkuZGlzYWJsZSA9IGxzZGNfY3J0YzBf
ZGlzYWJsZSwNCisJCS5lbmFibGVfdmJsYW5rID0gbHNkY19jcnRjMF9lbmFibGVfdmJsYW5rLA0K
KwkJLmRpc2FibGVfdmJsYW5rID0gbHNkY19jcnRjMF9kaXNhYmxlX3ZibGFuaywNCisJCS5mbGlw
ID0gbHNkY19jcnRjMF9mbGlwLA0KKwkJLmNsb25lID0gbHNkY19jcnRjMF9jbG9uZSwNCisJCS5z
ZXRfbW9kZSA9IGxzZGNfY3J0YzBfc2V0X21vZGUsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19j
cnRjMF9zY2FuX3BvcywNCisJCS5zb2Z0X3Jlc2V0ID0gbHNkY19jcnRjMF9zb2Z0X3Jlc2V0LA0K
KwkJLnJlc2V0ID0gbHNkY19jcnRjMF9yZXNldCwNCisJfSwNCisJew0KKwkJLmVuYWJsZSA9IGxz
ZGNfY3J0YzFfZW5hYmxlLA0KKwkJLmRpc2FibGUgPSBsc2RjX2NydGMxX2Rpc2FibGUsDQorCQku
ZW5hYmxlX3ZibGFuayA9IGxzZGNfY3J0YzFfZW5hYmxlX3ZibGFuaywNCisJCS5kaXNhYmxlX3Zi
bGFuayA9IGxzZGNfY3J0YzFfZGlzYWJsZV92YmxhbmssDQorCQkuZmxpcCA9IGxzZGNfY3J0YzFf
ZmxpcCwNCisJCS5jbG9uZSA9IGxzZGNfY3J0YzFfY2xvbmUsDQorCQkuc2V0X21vZGUgPSBsc2Rj
X2NydGMxX3NldF9tb2RlLA0KKwkJLmdldF9zY2FuX3BvcyA9IGxzZGNfY3J0YzFfc2Nhbl9wb3Ms
DQorCQkuc29mdF9yZXNldCA9IGxzZGNfY3J0YzFfc29mdF9yZXNldCwNCisJCS5yZXNldCA9IGxz
ZGNfY3J0YzFfcmVzZXQsDQorCX0sDQorfTsNCisNCisvKg0KKyAqIFRoZSAzMi1iaXQgaGFyZHdh
cmUgdmJsYW5rIGNvdW50ZXIgaXMgYXZhaWxhYmxlIHNpbmNlIGxzN2EyMDAwL2xzMmsyMDAwLA0K
KyAqIFRoZSBjb3VudGVyIGdyb3cgdXAgZXZlbiB0aGUgQ1JUQyBpcyBiZWluZyBkaXNhYmxlZCwg
aXQgd2lsbCBnb3QgcmVzZXQNCisgKiBpZiB0aGUgY3J0YyBpcyBiZWluZyBzb2Z0IHJlc2V0Lg0K
KyAqDQorICogVGhvc2UgcmVnaXN0ZXJzIGFyZSBhbHNvIHJlYWRhYmxlIGZvciBsczdhMTAwMCwg
YnV0IGl0cyB2YWx1ZSBkb2VzIG5vdA0KKyAqIGNoYW5nZS4NCisgKi8NCisNCitzdGF0aWMgdTMy
IGxzZGNfY3J0YzBfZ2V0X3ZibGFua19jb3VudChzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7
DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKw0KKwlyZXR1cm4g
bHNkY19ycmVnMzIobGRldiwgTFNEQ19DUlRDMF9WU1lOQ19DT1VOVEVSX1JFRyk7DQorfQ0KKw0K
K3N0YXRpYyB1MzIgbHNkY19jcnRjMV9nZXRfdmJsYW5rX2NvdW50KHN0cnVjdCBsc2RjX2NydGMg
KmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQor
DQorCXJldHVybiBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZTWU5DX0NPVU5URVJfUkVH
KTsNCit9DQorDQorLyoNCisgKiBUaGUgRE1BIHN0ZXAgYml0IGZpZWxkIGlzIGF2YWlsYWJsZSBz
aW5jZSBsczdhMjAwMC9sczJrMjAwMCwgZm9yIHN1cHBvcnQNCisgKiBvZGQgcmVzb2x1dGlvbnMu
IEJ1dCBhIGxhcmdlIERNQSBzdGVwIG1heSBzYXZlIGJhbmR3aWR0aC4gQmVoYXZpb3Igb2YNCisg
KiB3cml0aW5nIHRob2VzIGJpdHMgZmllbGQgb24gbHM3YTEwMDAvbHMyazEwMDAgaXMgdW5kZXJm
aW5lZC4NCisgKi8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMwX3NldF9kbWFfc3RlcChzdHJ1
Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJICAgIGVudW0gbHNkY19kbWFfc3RlcHMgZG1hX3N0
ZXApDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisJdTMy
IHZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRyk7DQorDQorCXZhbCAm
PSB+Q0ZHX0RNQV9TVEVQX01BU0s7DQorCXZhbCB8PSBkbWFfc3RlcCA8PCBDRkdfRE1BX1NURVBf
U0hJRlQ7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRywgdmFsKTsN
Cit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9zZXRfZG1hX3N0ZXAoc3RydWN0IGxzZGNf
Y3J0YyAqbGNydGMsDQorCQkJCSAgICBlbnVtIGxzZGNfZG1hX3N0ZXBzIGRtYV9zdGVwKQ0KK3sN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorCXUzMiB2YWwgPSBs
c2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcpOw0KKw0KKwl2YWwgJj0gfkNGR19E
TUFfU1RFUF9NQVNLOw0KKwl2YWwgfD0gZG1hX3N0ZXAgPDwgQ0ZHX0RNQV9TVEVQX1NISUZUOw0K
Kw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHZhbCk7DQorfQ0KKw0K
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyBsczdhMjAwMF9jcnRjX2h3X29w
c1syXSA9IHsNCisJew0KKwkJLmVuYWJsZSA9IGxzZGNfY3J0YzBfZW5hYmxlLA0KKwkJLmRpc2Fi
bGUgPSBsc2RjX2NydGMwX2Rpc2FibGUsDQorCQkuZW5hYmxlX3ZibGFuayA9IGxzZGNfY3J0YzBf
ZW5hYmxlX3ZibGFuaywNCisJCS5kaXNhYmxlX3ZibGFuayA9IGxzZGNfY3J0YzBfZGlzYWJsZV92
YmxhbmssDQorCQkuZmxpcCA9IGxzZGNfY3J0YzBfZmxpcCwNCisJCS5jbG9uZSA9IGxzZGNfY3J0
YzBfY2xvbmUsDQorCQkuc2V0X21vZGUgPSBsc2RjX2NydGMwX3NldF9tb2RlLA0KKwkJLnNvZnRf
cmVzZXQgPSBsc2RjX2NydGMwX3NvZnRfcmVzZXQsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19j
cnRjMF9zY2FuX3BvcywNCisJCS5zZXRfZG1hX3N0ZXAgPSBsc2RjX2NydGMwX3NldF9kbWFfc3Rl
cCwNCisJCS5nZXRfdmJsYW5rX2NvdW50ZXIgPSBsc2RjX2NydGMwX2dldF92YmxhbmtfY291bnQs
DQorCQkucmVzZXQgPSBsc2RjX2NydGMwX3Jlc2V0LA0KKwl9LA0KKwl7DQorCQkuZW5hYmxlID0g
bHNkY19jcnRjMV9lbmFibGUsDQorCQkuZGlzYWJsZSA9IGxzZGNfY3J0YzFfZGlzYWJsZSwNCisJ
CS5lbmFibGVfdmJsYW5rID0gbHNkY19jcnRjMV9lbmFibGVfdmJsYW5rLA0KKwkJLmRpc2FibGVf
dmJsYW5rID0gbHNkY19jcnRjMV9kaXNhYmxlX3ZibGFuaywNCisJCS5mbGlwID0gbHNkY19jcnRj
MV9mbGlwLA0KKwkJLmNsb25lID0gbHNkY19jcnRjMV9jbG9uZSwNCisJCS5zZXRfbW9kZSA9IGxz
ZGNfY3J0YzFfc2V0X21vZGUsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMV9zY2FuX3Bv
cywNCisJCS5zb2Z0X3Jlc2V0ID0gbHNkY19jcnRjMV9zb2Z0X3Jlc2V0LA0KKwkJLnNldF9kbWFf
c3RlcCA9IGxzZGNfY3J0YzFfc2V0X2RtYV9zdGVwLA0KKwkJLmdldF92YmxhbmtfY291bnRlciA9
IGxzZGNfY3J0YzFfZ2V0X3ZibGFua19jb3VudCwNCisJCS5yZXNldCA9IGxzZGNfY3J0YzFfcmVz
ZXQsDQorCX0sDQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfcmVzZXQoc3RydWN0IGRy
bV9jcnRjICpjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2Ny
dGMoY3J0Yyk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+
aHdfb3BzOw0KKwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X2NydGNfc3RhdGU7DQorDQor
CWlmIChjcnRjLT5zdGF0ZSkNCisJCWNydGMtPmZ1bmNzLT5hdG9taWNfZGVzdHJveV9zdGF0ZShj
cnRjLCBjcnRjLT5zdGF0ZSk7DQorDQorCXByaXZfY3J0Y19zdGF0ZSA9IGt6YWxsb2Moc2l6ZW9m
KCpwcml2X2NydGNfc3RhdGUpLCBHRlBfS0VSTkVMKTsNCisNCisJaWYgKCFwcml2X2NydGNfc3Rh
dGUpDQorCQlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoY3J0YywgTlVMTCk7DQorCWVs
c2UNCisJCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNldChjcnRjLCAmcHJpdl9jcnRjX3N0
YXRlLT5iYXNlKTsNCisNCisJLyoNCisJICogUmVzZXQgdGhlIGNydGMgaGFyZHdhcmUsIHRoaXMg
aXMgbmVlZCBmb3IgUzMgc3VwcG9ydCwNCisJICogb3RoZXJ3aXNlLCB3YWl0IGZvciB2Ymxhbmsg
dGltZW91dCBtYXkgaGFwcGVuLg0KKwkgKi8NCisJb3BzLT5yZXNldChsY3J0Yyk7DQorfQ0KKw0K
K3N0YXRpYyB2b2lkIGxzZGNfY3J0Y19hdG9taWNfZGVzdHJveV9zdGF0ZShzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMsDQorCQkJCQkgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJ
c3RydWN0IGxzZGNfY3J0Y19zdGF0ZSAqcHJpdl9zdGF0ZSA9IHRvX2xzZGNfY3J0Y19zdGF0ZShz
dGF0ZSk7DQorDQorCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZwcml2
X3N0YXRlLT5iYXNlKTsNCisNCisJa2ZyZWUocHJpdl9zdGF0ZSk7DQorfQ0KKw0KK3N0YXRpYyBz
dHJ1Y3QgZHJtX2NydGNfc3RhdGUgKg0KK2xzZGNfY3J0Y19hdG9taWNfZHVwbGljYXRlX3N0YXRl
KHN0cnVjdCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2NydGNfc3RhdGUgKm5l
d19wcml2X3N0YXRlOw0KKwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpvbGRfcHJpdl9zdGF0ZTsN
CisNCisJbmV3X3ByaXZfc3RhdGUgPSBremFsbG9jKHNpemVvZigqbmV3X3ByaXZfc3RhdGUpLCBH
RlBfS0VSTkVMKTsNCisJaWYgKCFuZXdfcHJpdl9zdGF0ZSkNCisJCXJldHVybiBOVUxMOw0KKw0K
KwlfX2RybV9hdG9taWNfaGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlKGNydGMsICZuZXdfcHJp
dl9zdGF0ZS0+YmFzZSk7DQorDQorCW9sZF9wcml2X3N0YXRlID0gdG9fbHNkY19jcnRjX3N0YXRl
KGNydGMtPnN0YXRlKTsNCisNCisJbWVtY3B5KCZuZXdfcHJpdl9zdGF0ZS0+cHBhcm1zLCAmb2xk
X3ByaXZfc3RhdGUtPnBwYXJtcywNCisJICAgICAgIHNpemVvZihuZXdfcHJpdl9zdGF0ZS0+cHBh
cm1zKSk7DQorDQorCXJldHVybiAmbmV3X3ByaXZfc3RhdGUtPmJhc2U7DQorfQ0KKw0KK3N0YXRp
YyB1MzIgbHNkY19jcnRjX2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMp
DQorew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJ
Y29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQor
CXJldHVybiBvcHMtPmdldF92YmxhbmtfY291bnRlcihsY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyBp
bnQgbHNkY19jcnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJ
c3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCWNvbnN0IHN0
cnVjdCBsc2RjX2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+aHdfb3BzOw0KKw0KKwlvcHMtPmVu
YWJsZV92YmxhbmsobGNydGMpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQg
bHNkY19jcnRjX2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXN0
cnVjdCBsc2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBzdHJ1
Y3QgbHNkY19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisNCisJb3BzLT5kaXNh
YmxlX3ZibGFuayhsY3J0Yyk7DQorfQ0KKw0KKy8qDQorICogQ1JUQyByZWxhdGVkIGRlYnVnZnMN
CisgKg0KKyAqIFByaW1hcnkgcGxhbmVzIGFuZCBjdXJzb3IgcGxhbmVzIGFyZSBhbHNvIGJlbG9u
ZyB0byB0aGUgQ1JUQyBmb3Igb3VyIGNhc2UsDQorICogc28gYWxzbyBhcHBlbmQgb3RoZXIgcmVn
aXN0ZXJzIHRvIGhlcmUsIGZvciBzYWtlIG9mIGNvbnZlbmllbnQuDQorICovDQorDQorI2RlZmlu
ZSBSRUdfREVGKHJlZykgeyBcDQorCS5uYW1lID0gX19zdHJpbmdpZnlfMShMU0RDXyMjcmVnIyNf
UkVHKSwgXA0KKwkub2Zmc2V0ID0gTFNEQ18jI3JlZyMjX1JFRywgXA0KK30NCisNCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGxzZGNfcmVnMzIgbHNkY19jcnRjX3JlZ3NfYXJyYXlbMl1bMjFdID0gew0K
KwlbMF0gPSB7DQorCQlSRUdfREVGKENSVEMwX0NGRyksDQorCQlSRUdfREVGKENSVEMwX0ZCX09S
SUdJTiksDQorCQlSRUdfREVGKENSVEMwX1BBTkVMX0NPTkYpLA0KKwkJUkVHX0RFRihDUlRDMF9I
RElTUExBWSksDQorCQlSRUdfREVGKENSVEMwX0hTWU5DKSwNCisJCVJFR19ERUYoQ1JUQzBfVkRJ
U1BMQVkpLA0KKwkJUkVHX0RFRihDUlRDMF9WU1lOQyksDQorCQlSRUdfREVGKENSVEMwX0dBTU1B
X0lOREVYKSwNCisJCVJFR19ERUYoQ1JUQzBfR0FNTUFfREFUQSksDQorCQlSRUdfREVGKENSVEMw
X1NZTkNfREVWSUFUSU9OKSwNCisJCVJFR19ERUYoQ1JUQzBfVlNZTkNfQ09VTlRFUiksDQorCQlS
RUdfREVGKENSVEMwX1NDQU5fUE9TKSwNCisJCVJFR19ERUYoQ1JUQzBfU1RSSURFKSwNCisJCVJF
R19ERUYoQ1JUQzBfRkIxX0FERFJfSEkpLA0KKwkJUkVHX0RFRihDUlRDMF9GQjFfQUREUl9MTyks
DQorCQlSRUdfREVGKENSVEMwX0ZCMF9BRERSX0hJKSwNCisJCVJFR19ERUYoQ1JUQzBfRkIwX0FE
RFJfTE8pLA0KKwkJUkVHX0RFRihDVVJTT1IwX0NGRyksDQorCQlSRUdfREVGKENVUlNPUjBfUE9T
SVRJT04pLA0KKwkJUkVHX0RFRihDVVJTT1IwX0JHX0NPTE9SKSwNCisJCVJFR19ERUYoQ1VSU09S
MF9GR19DT0xPUiksDQorCX0sDQorCVsxXSA9IHsNCisJCVJFR19ERUYoQ1JUQzFfQ0ZHKSwNCisJ
CVJFR19ERUYoQ1JUQzFfRkJfT1JJR0lOKSwNCisJCVJFR19ERUYoQ1JUQzFfUEFORUxfQ09ORiks
DQorCQlSRUdfREVGKENSVEMxX0hESVNQTEFZKSwNCisJCVJFR19ERUYoQ1JUQzFfSFNZTkMpLA0K
KwkJUkVHX0RFRihDUlRDMV9WRElTUExBWSksDQorCQlSRUdfREVGKENSVEMxX1ZTWU5DKSwNCisJ
CVJFR19ERUYoQ1JUQzFfR0FNTUFfSU5ERVgpLA0KKwkJUkVHX0RFRihDUlRDMV9HQU1NQV9EQVRB
KSwNCisJCVJFR19ERUYoQ1JUQzFfU1lOQ19ERVZJQVRJT04pLA0KKwkJUkVHX0RFRihDUlRDMV9W
U1lOQ19DT1VOVEVSKSwNCisJCVJFR19ERUYoQ1JUQzFfU0NBTl9QT1MpLA0KKwkJUkVHX0RFRihD
UlRDMV9TVFJJREUpLA0KKwkJUkVHX0RFRihDUlRDMV9GQjFfQUREUl9ISSksDQorCQlSRUdfREVG
KENSVEMxX0ZCMV9BRERSX0xPKSwNCisJCVJFR19ERUYoQ1JUQzFfRkIwX0FERFJfSEkpLA0KKwkJ
UkVHX0RFRihDUlRDMV9GQjBfQUREUl9MTyksDQorCQlSRUdfREVGKENVUlNPUjFfQ0ZHKSwNCisJ
CVJFR19ERUYoQ1VSU09SMV9QT1NJVElPTiksDQorCQlSRUdfREVGKENVUlNPUjFfQkdfQ09MT1Ip
LA0KKwkJUkVHX0RFRihDVVJTT1IxX0ZHX0NPTE9SKSwNCisJfSwNCit9Ow0KKw0KK3N0YXRpYyBp
bnQgbHNkY19jcnRjX3Nob3dfcmVncyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmFyZykNCit7
DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1faW5mb19ub2RlICop
bS0+cHJpdmF0ZTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSAoc3RydWN0IGxzZGNfY3J0
YyAqKW5vZGUtPmluZm9fZW50LT5kYXRhOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBs
Y3J0Yy0+bGRldjsNCisJdW5zaWduZWQgaW50IGk7DQorDQorCWZvciAoaSA9IDA7IGkgPCBsY3J0
Yy0+bnJlZzsgaSsrKSB7DQorCQljb25zdCBzdHJ1Y3QgbHNkY19yZWczMiAqcHJlZyA9ICZsY3J0
Yy0+cHJlZ1tpXTsNCisJCXUzMiBvZmZzZXQgPSBwcmVnLT5vZmZzZXQ7DQorDQorCQlzZXFfcHJp
bnRmKG0sICIlcyAoMHglMDR4KTogMHglMDh4XG4iLA0KKwkJCSAgIHByZWctPm5hbWUsIG9mZnNl
dCwgbHNkY19ycmVnMzIobGRldiwgb2Zmc2V0KSk7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0K
Kw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX3Nob3dfc2Nhbl9wb3NpdGlvbihzdHJ1Y3Qgc2VxX2Zp
bGUgKm0sIHZvaWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0
cnVjdCBkcm1faW5mb19ub2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNy
dGMgPSAoc3RydWN0IGxzZGNfY3J0YyAqKW5vZGUtPmluZm9fZW50LT5kYXRhOw0KKwljb25zdCBz
dHJ1Y3QgbHNkY19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisJaW50IHgsIHk7
DQorDQorCW9wcy0+Z2V0X3NjYW5fcG9zKGxjcnRjLCAmeCwgJnkpOw0KKw0KKwlzZXFfcHJpbnRm
KG0sICJzY2Fub3V0IHBvc2l0aW9uOiB4OiAlMDh1LCB5OiAlMDh1XG4iLCB4LCB5KTsNCisNCisJ
cmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50
ZXIoc3RydWN0IHNlcV9maWxlICptLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9f
bm9kZSAqbm9kZSA9IChzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVj
dCBsc2RjX2NydGMgKmxjcnRjID0gKHN0cnVjdCBsc2RjX2NydGMgKilub2RlLT5pbmZvX2VudC0+
ZGF0YTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19v
cHM7DQorDQorCWlmIChvcHMtPmdldF92YmxhbmtfY291bnRlcikNCisJCXNlcV9wcmludGYobSwg
IiVzIHZibGFuayBjb3VudGVyOiAlMDh1XG5cbiIsDQorCQkJICAgbGNydGMtPmJhc2UubmFtZSwN
CisJCQkgICBvcHMtPmdldF92YmxhbmtfY291bnRlcihsY3J0YykpOw0KKw0KKwlyZXR1cm4gMDsN
Cit9DQorDQorc3RhdGljIGludCBsc2RjX3BpeHBsbF9zaG93X2Nsb2NrKHN0cnVjdCBzZXFfZmls
ZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUgPSAoc3Ry
dWN0IGRybV9pbmZvX25vZGUgKiltLT5wcml2YXRlOw0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0
YyA9IChzdHJ1Y3QgbHNkY19jcnRjICopbm9kZS0+aW5mb19lbnQtPmRhdGE7DQorCXN0cnVjdCBs
c2RjX3BpeHBsbCAqcGl4cGxsID0gJmxjcnRjLT5waXhwbGw7DQorCWNvbnN0IHN0cnVjdCBsc2Rj
X3BpeHBsbF9mdW5jcyAqZnVuY3MgPSBwaXhwbGwtPmZ1bmNzOw0KKwlzdHJ1Y3QgZHJtX2NydGMg
KmNydGMgPSAmbGNydGMtPmJhc2U7DQorCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0g
JmNydGMtPnN0YXRlLT5tb2RlOw0KKwlzdHJ1Y3QgZHJtX3ByaW50ZXIgcHJpbnRlciA9IGRybV9z
ZXFfZmlsZV9wcmludGVyKG0pOw0KKwl1bnNpZ25lZCBpbnQgb3V0X2toejsNCisNCisJb3V0X2to
eiA9IGZ1bmNzLT5nZXRfcmF0ZShwaXhwbGwpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICIlczogJWR4
JWRAJWRcbiIsIGNydGMtPm5hbWUsDQorCQkgICBtb2RlLT5oZGlzcGxheSwgbW9kZS0+dmRpc3Bs
YXksIGRybV9tb2RlX3ZyZWZyZXNoKG1vZGUpKTsNCisNCisJc2VxX3ByaW50ZihtLCAiUGl4ZWwg
Y2xvY2sgcmVxdWlyZWQ6ICVkIGtIelxuIiwgbW9kZS0+Y2xvY2spOw0KKwlzZXFfcHJpbnRmKG0s
ICJBY3R1YWwgZnJlcXVlbmN5IG91dHB1dDogJXUga0h6XG4iLCBvdXRfa2h6KTsNCisJc2VxX3By
aW50ZihtLCAiRGlmZjogJWQga0h6XG4iLCBvdXRfa2h6IC0gbW9kZS0+Y2xvY2spOw0KKw0KKwlm
dW5jcy0+cHJpbnQocGl4cGxsLCAmcHJpbnRlcik7DQorDQorCXJldHVybiAwOw0KK30NCisNCitz
dGF0aWMgc3RydWN0IGRybV9pbmZvX2xpc3QgbHNkY19jcnRjX2RlYnVnZnNfbGlzdFsyXVs0XSA9
IHsNCisJWzBdID0gew0KKwkJeyAicmVncyIsIGxzZGNfY3J0Y19zaG93X3JlZ3MsIDAsIE5VTEwg
fSwNCisJCXsgInBpeGNsayIsIGxzZGNfcGl4cGxsX3Nob3dfY2xvY2ssIDAsIE5VTEwgfSwNCisJ
CXsgInNjYW5wb3MiLCBsc2RjX2NydGNfc2hvd19zY2FuX3Bvc2l0aW9uLCAwLCBOVUxMIH0sDQor
CQl7ICJ2YmxhbmtzIiwgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50ZXIsIDAsIE5VTEwgfSwN
CisJfSwNCisJWzFdID0gew0KKwkJeyAicmVncyIsIGxzZGNfY3J0Y19zaG93X3JlZ3MsIDAsIE5V
TEwgfSwNCisJCXsgInBpeGNsayIsIGxzZGNfcGl4cGxsX3Nob3dfY2xvY2ssIDAsIE5VTEwgfSwN
CisJCXsgInNjYW5wb3MiLCBsc2RjX2NydGNfc2hvd19zY2FuX3Bvc2l0aW9uLCAwLCBOVUxMIH0s
DQorCQl7ICJ2YmxhbmtzIiwgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50ZXIsIDAsIE5VTEwg
fSwNCisJfSwNCit9Ow0KKw0KKy8qIG9wZXJhdGUgbWFudWFsbHkgKi8NCisNCitzdGF0aWMgaW50
IGxzZGNfY3J0Y19tYW5fb3Bfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmRhdGEpDQor
ew0KKwlzZXFfcHV0cyhtLCAic29mdF9yZXNldDogc29mdCByZXNldCB0aGlzIENSVENcbiIpOw0K
KwlzZXFfcHV0cyhtLCAiZW5hYmxlOiBlbmFibGUgdGhpcyBDUlRDXG4iKTsNCisJc2VxX3B1dHMo
bSwgImRpc2FibGU6IGRpc2FibGUgdGhpcyBDUlRDXG4iKTsNCisJc2VxX3B1dHMobSwgImZsaXA6
IHRyaWdnZXIgdGhlIHBhZ2UgZmxpcFxuIik7DQorCXNlcV9wdXRzKG0sICJjbG9uZTogY2xvbmUg
dGhlIGFub3RoZXIgY3J0YyB3aXRoIGhhcmR3YXJlIGxvZ2ljXG4iKTsNCisNCisJcmV0dXJuIDA7
DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX21hbl9vcF9vcGVuKHN0cnVjdCBpbm9kZSAq
aW5vZGUsIHN0cnVjdCBmaWxlICpmaWxlKQ0KK3sNCisJc3RydWN0IGRybV9jcnRjICpjcnRjID0g
aW5vZGUtPmlfcHJpdmF0ZTsNCisNCisJcmV0dXJuIHNpbmdsZV9vcGVuKGZpbGUsIGxzZGNfY3J0
Y19tYW5fb3Bfc2hvdywgY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyBzc2l6ZV90IGxzZGNfY3J0Y19t
YW5fb3Bfd3JpdGUoc3RydWN0IGZpbGUgKmZpbGUsDQorCQkJCSAgICAgIGNvbnN0IGNoYXIgX191
c2VyICp1YnVmLA0KKwkJCQkgICAgICBzaXplX3QgbGVuLA0KKwkJCQkgICAgICBsb2ZmX3QgKm9m
ZnApDQorew0KKwlzdHJ1Y3Qgc2VxX2ZpbGUgKm0gPSBmaWxlLT5wcml2YXRlX2RhdGE7DQorCXN0
cnVjdCBsc2RjX2NydGMgKmxjcnRjID0gbS0+cHJpdmF0ZTsNCisJY29uc3Qgc3RydWN0IGxzZGNf
Y3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQorCWNoYXIgYnVmWzE2XTsNCisN
CisJaWYgKGxlbiA+IHNpemVvZihidWYpIC0gMSkNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwlp
ZiAoY29weV9mcm9tX3VzZXIoYnVmLCB1YnVmLCBsZW4pKQ0KKwkJcmV0dXJuIC1FRkFVTFQ7DQor
DQorCWJ1ZltsZW5dID0gJ1wwJzsNCisNCisJaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgInNvZnRfcmVz
ZXQiKSkNCisJCW9wcy0+c29mdF9yZXNldChsY3J0Yyk7DQorCWVsc2UgaWYgKHN5c2ZzX3N0cmVx
KGJ1ZiwgImVuYWJsZSIpKQ0KKwkJb3BzLT5lbmFibGUobGNydGMpOw0KKwllbHNlIGlmIChzeXNm
c19zdHJlcShidWYsICJkaXNhYmxlIikpDQorCQlvcHMtPmRpc2FibGUobGNydGMpOw0KKwllbHNl
IGlmIChzeXNmc19zdHJlcShidWYsICJmbGlwIikpDQorCQlvcHMtPmZsaXAobGNydGMpOw0KKwll
bHNlIGlmIChzeXNmc19zdHJlcShidWYsICJjbG9uZSIpKQ0KKwkJb3BzLT5jbG9uZShsY3J0Yyk7
DQorDQorCXJldHVybiBsZW47DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZmlsZV9vcGVy
YXRpb25zIGxzZGNfY3J0Y19tYW5fb3BfZm9wcyA9IHsNCisJLm93bmVyID0gVEhJU19NT0RVTEUs
DQorCS5vcGVuID0gbHNkY19jcnRjX21hbl9vcF9vcGVuLA0KKwkucmVhZCA9IHNlcV9yZWFkLA0K
KwkubGxzZWVrID0gc2VxX2xzZWVrLA0KKwkucmVsZWFzZSA9IHNpbmdsZV9yZWxlYXNlLA0KKwku
d3JpdGUgPSBsc2RjX2NydGNfbWFuX29wX3dyaXRlLA0KK307DQorDQorc3RhdGljIGludCBsc2Rj
X2NydGNfbGF0ZV9yZWdpc3RlcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMpDQorew0KKwlzdHJ1Y3Qg
bHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUgPSBjcnRjX3RvX2Rpc3BsYXlfcGlwZShjcnRjKTsN
CisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCXN0cnVj
dCBkcm1fbWlub3IgKm1pbm9yID0gY3J0Yy0+ZGV2LT5wcmltYXJ5Ow0KKwl1bnNpZ25lZCBpbnQg
aW5kZXggPSBkaXNwaXBlLT5pbmRleDsNCisJdW5zaWduZWQgaW50IGk7DQorDQorCWxjcnRjLT5w
cmVnID0gbHNkY19jcnRjX3JlZ3NfYXJyYXlbaW5kZXhdOw0KKwlsY3J0Yy0+bnJlZyA9IEFSUkFZ
X1NJWkUobHNkY19jcnRjX3JlZ3NfYXJyYXlbaW5kZXhdKTsNCisJbGNydGMtPnBfaW5mb19saXN0
ID0gbHNkY19jcnRjX2RlYnVnZnNfbGlzdFtpbmRleF07DQorCWxjcnRjLT5uX2luZm9fbGlzdCA9
IEFSUkFZX1NJWkUobHNkY19jcnRjX2RlYnVnZnNfbGlzdFtpbmRleF0pOw0KKw0KKwlmb3IgKGkg
PSAwOyBpIDwgbGNydGMtPm5faW5mb19saXN0OyArK2kpDQorCQlsY3J0Yy0+cF9pbmZvX2xpc3Rb
aV0uZGF0YSA9IGxjcnRjOw0KKw0KKwlkcm1fZGVidWdmc19jcmVhdGVfZmlsZXMobGNydGMtPnBf
aW5mb19saXN0LA0KKwkJCQkgbGNydGMtPm5faW5mb19saXN0LA0KKwkJCQkgY3J0Yy0+ZGVidWdm
c19lbnRyeSwNCisJCQkJIG1pbm9yKTsNCisNCisJLyogc3VwcG9ydGVkIG1hbnVhbCBvcGVyYXRp
b25zICovDQorCWRlYnVnZnNfY3JlYXRlX2ZpbGUoIm9wcyIsIDA2NDQsIGNydGMtPmRlYnVnZnNf
ZW50cnksIGxjcnRjLA0KKwkJCSAgICAmbHNkY19jcnRjX21hbl9vcF9mb3BzKTsNCisNCisJcmV0
dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0Y19hdG9taWNfcHJpbnRfc3RhdGUo
c3RydWN0IGRybV9wcmludGVyICpwLA0KKwkJCQkJIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19zdGF0
ZSAqc3RhdGUpDQorew0KKwljb25zdCBzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X3N0YXRl
Ow0KKwljb25zdCBzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtczsNCisNCisJcHJpdl9z
dGF0ZSA9IGNvbnRhaW5lcl9vZl9jb25zdChzdGF0ZSwgc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSwg
YmFzZSk7DQorCXBwYXJtcyA9ICZwcml2X3N0YXRlLT5wcGFybXM7DQorDQorCWRybV9wcmludGYo
cCwgIlx0SW5wdXQgY2xvY2sgZGl2aWRlciA9ICV1XG4iLCBwcGFybXMtPmRpdl9yZWYpOw0KKwlk
cm1fcHJpbnRmKHAsICJcdE1lZGl1bSBjbG9jayBNdWx0aXBsaWVyID0gJXVcbiIsIHBwYXJtcy0+
bG9vcGMpOw0KKwlkcm1fcHJpbnRmKHAsICJcdE91dHB1dCBjbG9jayBkaXZpZGVyID0gJXVcbiIs
IHBwYXJtcy0+ZGl2X291dCk7DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2NydGNf
ZnVuY3MgbHM3YTEwMDBfY3J0Y19mdW5jcyA9IHsNCisJLnJlc2V0ID0gbHNkY19jcnRjX3Jlc2V0
LA0KKwkuZGVzdHJveSA9IGRybV9jcnRjX2NsZWFudXAsDQorCS5zZXRfY29uZmlnID0gZHJtX2F0
b21pY19oZWxwZXJfc2V0X2NvbmZpZywNCisJLnBhZ2VfZmxpcCA9IGRybV9hdG9taWNfaGVscGVy
X3BhZ2VfZmxpcCwNCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWlj
X2R1cGxpY2F0ZV9zdGF0ZSwNCisJLmF0b21pY19kZXN0cm95X3N0YXRlID0gbHNkY19jcnRjX2F0
b21pY19kZXN0cm95X3N0YXRlLA0KKwkubGF0ZV9yZWdpc3RlciA9IGxzZGNfY3J0Y19sYXRlX3Jl
Z2lzdGVyLA0KKwkuZW5hYmxlX3ZibGFuayA9IGxzZGNfY3J0Y19lbmFibGVfdmJsYW5rLA0KKwku
ZGlzYWJsZV92YmxhbmsgPSBsc2RjX2NydGNfZGlzYWJsZV92YmxhbmssDQorCS5nZXRfdmJsYW5r
X3RpbWVzdGFtcCA9IGRybV9jcnRjX3ZibGFua19oZWxwZXJfZ2V0X3ZibGFua190aW1lc3RhbXAs
DQorCS5hdG9taWNfcHJpbnRfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWljX3ByaW50X3N0YXRlLA0K
K307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBsczdhMjAwMF9jcnRj
X2Z1bmNzID0gew0KKwkucmVzZXQgPSBsc2RjX2NydGNfcmVzZXQsDQorCS5kZXN0cm95ID0gZHJt
X2NydGNfY2xlYW51cCwNCisJLnNldF9jb25maWcgPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29u
ZmlnLA0KKwkucGFnZV9mbGlwID0gZHJtX2F0b21pY19oZWxwZXJfcGFnZV9mbGlwLA0KKwkuYXRv
bWljX2R1cGxpY2F0ZV9zdGF0ZSA9IGxzZGNfY3J0Y19hdG9taWNfZHVwbGljYXRlX3N0YXRlLA0K
KwkuYXRvbWljX2Rlc3Ryb3lfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWljX2Rlc3Ryb3lfc3RhdGUs
DQorCS5sYXRlX3JlZ2lzdGVyID0gbHNkY19jcnRjX2xhdGVfcmVnaXN0ZXIsDQorCS5nZXRfdmJs
YW5rX2NvdW50ZXIgPSBsc2RjX2NydGNfZ2V0X3ZibGFua19jb3VudGVyLA0KKwkuZW5hYmxlX3Zi
bGFuayA9IGxzZGNfY3J0Y19lbmFibGVfdmJsYW5rLA0KKwkuZGlzYWJsZV92YmxhbmsgPSBsc2Rj
X2NydGNfZGlzYWJsZV92YmxhbmssDQorCS5nZXRfdmJsYW5rX3RpbWVzdGFtcCA9IGRybV9jcnRj
X3ZibGFua19oZWxwZXJfZ2V0X3ZibGFua190aW1lc3RhbXAsDQorCS5hdG9taWNfcHJpbnRfc3Rh
dGUgPSBsc2RjX2NydGNfYXRvbWljX3ByaW50X3N0YXRlLA0KK307DQorDQorc3RhdGljIGVudW0g
ZHJtX21vZGVfc3RhdHVzDQorbHNkY19jcnRjX21vZGVfdmFsaWQoc3RydWN0IGRybV9jcnRjICpj
cnRjLCBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkNCit7DQorCXN0cnVjdCBk
cm1fZGV2aWNlICpkZGV2ID0gY3J0Yy0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSB0b19sc2RjKGRkZXYpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19kZXNjICpkZXNjcCA9IGxkZXYt
PmRlc2NwOw0KKwl1bnNpZ25lZCBpbnQgcGl0Y2g7DQorDQorCWlmIChtb2RlLT5oZGlzcGxheSA+
IGRlc2NwLT5tYXhfd2lkdGgpDQorCQlyZXR1cm4gTU9ERV9CQURfSFZBTFVFOw0KKw0KKwlpZiAo
bW9kZS0+dmRpc3BsYXkgPiBkZXNjcC0+bWF4X2hlaWdodCkNCisJCXJldHVybiBNT0RFX0JBRF9W
VkFMVUU7DQorDQorCWlmIChtb2RlLT5jbG9jayA+IGRlc2NwLT5tYXhfcGl4ZWxfY2xrKSB7DQor
CQlkcm1fZGJnX2ttcyhkZGV2LCAibW9kZSAlZHglZCwgcGl4ZWwgY2xvY2s9JWQgaXMgdG9vIGhp
Z2hcbiIsDQorCQkJICAgIG1vZGUtPmhkaXNwbGF5LCBtb2RlLT52ZGlzcGxheSwgbW9kZS0+Y2xv
Y2spOw0KKwkJcmV0dXJuIE1PREVfQ0xPQ0tfSElHSDsNCisJfQ0KKw0KKwkvKiA0IGZvciBEUk1f
Rk9STUFUX1hSR0I4ODg4ICovDQorCXBpdGNoID0gbW9kZS0+aGRpc3BsYXkgKiA0Ow0KKw0KKwlp
ZiAocGl0Y2ggJSBkZXNjcC0+cGl0Y2hfYWxpZ24pIHsNCisJCWRybV9kYmdfa21zKGRkZXYsICJh
bGlnbmVkIHRvICV1IGJ5dGVzIGlzIHJlcXVpcmVkOiAldVxuIiwNCisJCQkgICAgZGVzY3AtPnBp
dGNoX2FsaWduLCBwaXRjaCk7DQorCQlyZXR1cm4gTU9ERV9CQURfV0lEVEg7DQorCX0NCisNCisJ
cmV0dXJuIE1PREVfT0s7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19waXhwbGxfYXRvbWljX2No
ZWNrKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJICAgIHN0cnVjdCBkcm1fY3J0Y19zdGF0
ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0Yyhj
cnRjKTsNCisJc3RydWN0IGxzZGNfcGl4cGxsICpwaXhwbGwgPSAmbGNydGMtPnBpeHBsbDsNCisJ
Y29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpwZnVuY3MgPSBwaXhwbGwtPmZ1bmNzOw0K
KwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X3N0YXRlID0gdG9fbHNkY19jcnRjX3N0YXRl
KHN0YXRlKTsNCisJdW5zaWduZWQgaW50IGNsb2NrID0gc3RhdGUtPm1vZGUuY2xvY2s7DQorCWlu
dCByZXQ7DQorDQorCXJldCA9IHBmdW5jcy0+Y29tcHV0ZShwaXhwbGwsIGNsb2NrLCAmcHJpdl9z
dGF0ZS0+cHBhcm1zKTsNCisJaWYgKHJldCkgew0KKwkJZHJtX3dhcm4oY3J0Yy0+ZGV2LCAiZmlu
ZCBQTEwgcGFybXMgZm9yICV1a0h6IGZhaWxlZFxuIiwgY2xvY2spOw0KKwkJcmV0dXJuIC1FSU5W
QUw7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX2hl
bHBlcl9hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLA0KKwkJCQkJIHN0cnVjdCBk
cm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqY3J0
Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19jcnRjX3N0YXRlKHN0YXRlLCBjcnRjKTsNCisN
CisJaWYgKCFjcnRjX3N0YXRlLT5lbmFibGUpDQorCQlyZXR1cm4gMDsNCisNCisJcmV0dXJuIGxz
ZGNfcGl4cGxsX2F0b21pY19jaGVjayhjcnRjLCBjcnRjX3N0YXRlKTsNCit9DQorDQorc3RhdGlj
IHZvaWQgbHNkY19jcnRjX21vZGVfc2V0X25vZmIoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sN
CisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCWNvbnN0
IHN0cnVjdCBsc2RjX2NydGNfaHdfb3BzICpjcnRjX2h3X29wcyA9IGxjcnRjLT5od19vcHM7DQor
CXN0cnVjdCBsc2RjX3BpeHBsbCAqcGl4cGxsID0gJmxjcnRjLT5waXhwbGw7DQorCWNvbnN0IHN0
cnVjdCBsc2RjX3BpeHBsbF9mdW5jcyAqcGl4cGxsX2Z1bmNzID0gcGl4cGxsLT5mdW5jczsNCisJ
c3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSA9IGNydGMtPnN0YXRlOw0KKwlzdHJ1Y3QgZHJt
X2Rpc3BsYXlfbW9kZSAqbW9kZSA9ICZzdGF0ZS0+bW9kZTsNCisJc3RydWN0IGxzZGNfY3J0Y19z
dGF0ZSAqcHJpdl9zdGF0ZSA9IHRvX2xzZGNfY3J0Y19zdGF0ZShzdGF0ZSk7DQorDQorCXBpeHBs
bF9mdW5jcy0+dXBkYXRlKHBpeHBsbCwgJnByaXZfc3RhdGUtPnBwYXJtcyk7DQorDQorCWlmIChj
cnRjX2h3X29wcy0+c2V0X2RtYV9zdGVwKSB7DQorCQl1bnNpZ25lZCBpbnQgd2lkdGhfaW5fYnl0
ZXMgPSBtb2RlLT5oZGlzcGxheSAqIDQ7DQorCQllbnVtIGxzZGNfZG1hX3N0ZXBzIGRtYV9zdGVw
Ow0KKw0KKwkJLyoNCisJCSAqIFVzaW5nIGxhcmdlIGRtYSBzdGVwIGFzIG11Y2ggYXMgcG9zc2li
bGUsIGZvciBpbXByb3ZpbmcNCisJCSAqIGhhcmR3YXJlIERNQSBlZmZpY2llbmN5Lg0KKwkJICov
DQorCQlpZiAod2lkdGhfaW5fYnl0ZXMgJSAyNTYgPT0gMCkNCisJCQlkbWFfc3RlcCA9IExTRENf
RE1BX1NURVBfMjU2X0JZVEVTOw0KKwkJZWxzZSBpZiAod2lkdGhfaW5fYnl0ZXMgJSAxMjggPT0g
MCkNCisJCQlkbWFfc3RlcCA9IExTRENfRE1BX1NURVBfMTI4X0JZVEVTOw0KKwkJZWxzZSBpZiAo
d2lkdGhfaW5fYnl0ZXMgJSA2NCA9PSAwKQ0KKwkJCWRtYV9zdGVwID0gTFNEQ19ETUFfU1RFUF82
NF9CWVRFUzsNCisJCWVsc2UgIC8qIHdpZHRoX2luX2J5dGVzICUgMzIgPT0gMCAqLw0KKwkJCWRt
YV9zdGVwID0gTFNEQ19ETUFfU1RFUF8zMl9CWVRFUzsNCisNCisJCWNydGNfaHdfb3BzLT5zZXRf
ZG1hX3N0ZXAobGNydGMsIGRtYV9zdGVwKTsNCisJfQ0KKw0KKwljcnRjX2h3X29wcy0+c2V0X21v
ZGUobGNydGMsIG1vZGUpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfc2VuZF92Ymxh
bmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYg
PSBjcnRjLT5kZXY7DQorCXVuc2lnbmVkIGxvbmcgZmxhZ3M7DQorDQorCWlmICghY3J0Yy0+c3Rh
dGUgfHwgIWNydGMtPnN0YXRlLT5ldmVudCkNCisJCXJldHVybjsNCisNCisJZHJtX2RiZyhkZGV2
LCAic2VuZCB2YmxhbmsgbWFudWFsbHlcbiIpOw0KKw0KKwlzcGluX2xvY2tfaXJxc2F2ZSgmZGRl
di0+ZXZlbnRfbG9jaywgZmxhZ3MpOw0KKwlkcm1fY3J0Y19zZW5kX3ZibGFua19ldmVudChjcnRj
LCBjcnRjLT5zdGF0ZS0+ZXZlbnQpOw0KKwljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOw0KKwlz
cGluX3VubG9ja19pcnFyZXN0b3JlKCZkZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7DQorfQ0KKw0K
K3N0YXRpYyB2b2lkIGxzZGNfY3J0Y19hdG9taWNfZW5hYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0
YywNCisJCQkJICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVj
dCBsc2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBzdHJ1Y3Qg
bHNkY19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisNCisJZHJtX2NydGNfdmJs
YW5rX29uKGNydGMpOw0KKw0KKwlkcm1fZGJnKGNydGMtPmRldiwgIiVzIGVuYWJsZVxuIiwgY3J0
Yy0+bmFtZSk7DQorDQorCW9wcy0+ZW5hYmxlKGxjcnRjKTsNCit9DQorDQorc3RhdGljIHZvaWQg
bHNkY19jcnRjX2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJICAg
ICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jcnRj
ICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3J0Y19o
d19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQorCWRybV9jcnRjX3ZibGFua19vZmYoY3J0
Yyk7DQorDQorCW9wcy0+ZGlzYWJsZShsY3J0Yyk7DQorDQorCWRybV9kYmcoY3J0Yy0+ZGV2LCAi
JXMgZGlzYWJsZVxuIiwgY3J0Yy0+bmFtZSk7DQorDQorCS8qDQorCSAqIE1ha2Ugc3VyZSB3ZSBp
c3N1ZSBhIHZibGFuayBldmVudCBhZnRlciBkaXNhYmxpbmcgdGhlIENSVEMgaWYNCisJICogc29t
ZW9uZSB3YXMgd2FpdGluZyBpdC4NCisJICovDQorCWxzZGNfY3J0Y19zZW5kX3ZibGFuayhjcnRj
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjX2F0b21pY19mbHVzaChzdHJ1Y3QgZHJt
X2NydGMgKmNydGMsDQorCQkJCSAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7
DQorCXNwaW5fbG9ja19pcnEoJmNydGMtPmRldi0+ZXZlbnRfbG9jayk7DQorCWlmIChjcnRjLT5z
dGF0ZS0+ZXZlbnQpIHsNCisJCWlmIChkcm1fY3J0Y192YmxhbmtfZ2V0KGNydGMpID09IDApDQor
CQkJZHJtX2NydGNfYXJtX3ZibGFua19ldmVudChjcnRjLCBjcnRjLT5zdGF0ZS0+ZXZlbnQpOw0K
KwkJZWxzZQ0KKwkJCWRybV9jcnRjX3NlbmRfdmJsYW5rX2V2ZW50KGNydGMsIGNydGMtPnN0YXRl
LT5ldmVudCk7DQorCQljcnRjLT5zdGF0ZS0+ZXZlbnQgPSBOVUxMOw0KKwl9DQorCXNwaW5fdW5s
b2NrX2lycSgmY3J0Yy0+ZGV2LT5ldmVudF9sb2NrKTsNCit9DQorDQorc3RhdGljIGJvb2wgbHNk
Y19jcnRjX2dldF9zY2Fub3V0X3Bvc2l0aW9uKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJ
CSAgIGJvb2wgaW5fdmJsYW5rX2lycSwNCisJCQkJCSAgIGludCAqdnBvcywNCisJCQkJCSAgIGlu
dCAqaHBvcywNCisJCQkJCSAgIGt0aW1lX3QgKnN0aW1lLA0KKwkJCQkJICAga3RpbWVfdCAqZXRp
bWUsDQorCQkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkNCit7DQor
CXN0cnVjdCBsc2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBz
dHJ1Y3QgbHNkY19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisJaW50IHZzdywg
dmJwLCB2YWN0aXZlX3N0YXJ0LCB2YWN0aXZlX2VuZCwgdmZwX2VuZDsNCisJaW50IHgsIHk7DQor
DQorCXZzdyA9IG1vZGUtPmNydGNfdnN5bmNfZW5kIC0gbW9kZS0+Y3J0Y192c3luY19zdGFydDsN
CisJdmJwID0gbW9kZS0+Y3J0Y192dG90YWwgLSBtb2RlLT5jcnRjX3ZzeW5jX2VuZDsNCisNCisJ
dmFjdGl2ZV9zdGFydCA9IHZzdyArIHZicCArIDE7DQorCXZhY3RpdmVfZW5kID0gdmFjdGl2ZV9z
dGFydCArIG1vZGUtPmNydGNfdmRpc3BsYXk7DQorDQorCS8qIGxhc3Qgc2NhbiBsaW5lIGJlZm9y
ZSBWU1lOQyAqLw0KKwl2ZnBfZW5kID0gbW9kZS0+Y3J0Y192dG90YWw7DQorDQorCWlmIChzdGlt
ZSkNCisJCSpzdGltZSA9IGt0aW1lX2dldCgpOw0KKw0KKwlvcHMtPmdldF9zY2FuX3BvcyhsY3J0
YywgJngsICZ5KTsNCisNCisJaWYgKHkgPiB2YWN0aXZlX2VuZCkNCisJCXkgPSB5IC0gdmZwX2Vu
ZCAtIHZhY3RpdmVfc3RhcnQ7DQorCWVsc2UNCisJCXkgLT0gdmFjdGl2ZV9zdGFydDsNCisNCisJ
KnZwb3MgPSB5Ow0KKwkqaHBvcyA9IHg7DQorDQorCWlmIChldGltZSkNCisJCSpldGltZSA9IGt0
aW1lX2dldCgpOw0KKw0KKwlyZXR1cm4gdHJ1ZTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVj
dCBkcm1fY3J0Y19oZWxwZXJfZnVuY3MgbHNkY19jcnRjX2hlbHBlcl9mdW5jcyA9IHsNCisJLm1v
ZGVfdmFsaWQgPSBsc2RjX2NydGNfbW9kZV92YWxpZCwNCisJLm1vZGVfc2V0X25vZmIgPSBsc2Rj
X2NydGNfbW9kZV9zZXRfbm9mYiwNCisJLmF0b21pY19lbmFibGUgPSBsc2RjX2NydGNfYXRvbWlj
X2VuYWJsZSwNCisJLmF0b21pY19kaXNhYmxlID0gbHNkY19jcnRjX2F0b21pY19kaXNhYmxlLA0K
KwkuYXRvbWljX2NoZWNrID0gbHNkY19jcnRjX2hlbHBlcl9hdG9taWNfY2hlY2ssDQorCS5hdG9t
aWNfZmx1c2ggPSBsc2RjX2NydGNfYXRvbWljX2ZsdXNoLA0KKwkuZ2V0X3NjYW5vdXRfcG9zaXRp
b24gPSBsc2RjX2NydGNfZ2V0X3NjYW5vdXRfcG9zaXRpb24sDQorfTsNCisNCitpbnQgbHM3YTEw
MDBfY3J0Y19pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJICAgICAgIHN0cnVjdCBk
cm1fY3J0YyAqY3J0YywNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwcmltYXJ5LA0KKwkJ
ICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKmN1cnNvciwNCisJCSAgICAgICB1bnNpZ25lZCBpbnQg
aW5kZXgpDQorew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRj
KTsNCisJaW50IHJldDsNCisNCisJcmV0ID0gbHNkY19waXhwbGxfaW5pdCgmbGNydGMtPnBpeHBs
bCwgZGRldiwgaW5kZXgpOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKGRkZXYsICJjcnRjIGlu
aXQgd2l0aCBwbGwgZmFpbGVkOiAlZFxuIiwgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisN
CisJbGNydGMtPmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlsY3J0Yy0+aHdfb3BzID0gJmxzN2Ex
MDAwX2NydGNfaHdfb3BzW2luZGV4XTsNCisNCisJcmV0ID0gZHJtX2NydGNfaW5pdF93aXRoX3Bs
YW5lcyhkZGV2LA0KKwkJCQkJY3J0YywNCisJCQkJCXByaW1hcnksDQorCQkJCQljdXJzb3IsDQor
CQkJCQkmbHM3YTEwMDBfY3J0Y19mdW5jcywNCisJCQkJCSJDUlRDLSVkIiwNCisJCQkJCWluZGV4
KTsNCisJaWYgKHJldCkgew0KKwkJZHJtX2VycihkZGV2LCAiY3J0YyBpbml0IHdpdGggcGxhbmVz
IGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQlyZXR1cm4gcmV0Ow0KKwl9DQorDQorCWRybV9jcnRj
X2hlbHBlcl9hZGQoY3J0YywgJmxzZGNfY3J0Y19oZWxwZXJfZnVuY3MpOw0KKw0KKwlyZXQgPSBk
cm1fbW9kZV9jcnRjX3NldF9nYW1tYV9zaXplKGNydGMsIDI1Nik7DQorCWlmIChyZXQpDQorCQly
ZXR1cm4gcmV0Ow0KKw0KKwlkcm1fY3J0Y19lbmFibGVfY29sb3JfbWdtdChjcnRjLCAwLCBmYWxz
ZSwgMjU2KTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK2ludCBsczdhMjAwMF9jcnRjX2luaXQo
c3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRj
LA0KKwkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnksDQorCQkgICAgICAgc3RydWN0
IGRybV9wbGFuZSAqY3Vyc29yLA0KKwkJICAgICAgIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQor
CXN0cnVjdCBsc2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwlpbnQgcmV0
Ow0KKw0KKwlyZXQgPSBsc2RjX3BpeHBsbF9pbml0KCZsY3J0Yy0+cGl4cGxsLCBkZGV2LCBpbmRl
eCk7DQorCWlmIChyZXQpIHsNCisJCWRybV9lcnIoZGRldiwgImNydGMgaW5pdCB3aXRoIHBsbCBm
YWlsZWQ6ICVkXG4iLCByZXQpOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlsY3J0Yy0+bGRl
diA9IHRvX2xzZGMoZGRldik7DQorCWxjcnRjLT5od19vcHMgPSAmbHM3YTIwMDBfY3J0Y19od19v
cHNbaW5kZXhdOw0KKw0KKwlyZXQgPSBkcm1fY3J0Y19pbml0X3dpdGhfcGxhbmVzKGRkZXYsDQor
CQkJCQljcnRjLA0KKwkJCQkJcHJpbWFyeSwNCisJCQkJCWN1cnNvciwNCisJCQkJCSZsczdhMjAw
MF9jcnRjX2Z1bmNzLA0KKwkJCQkJIkNSVEMtJWQiLA0KKwkJCQkJaW5kZXgpOw0KKwlpZiAocmV0
KSB7DQorCQlkcm1fZXJyKGRkZXYsICJjcnRjIGluaXQgd2l0aCBwbGFuZXMgZmFpbGVkOiAlZFxu
IiwgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJZHJtX2NydGNfaGVscGVyX2FkZChj
cnRjLCAmbHNkY19jcnRjX2hlbHBlcl9mdW5jcyk7DQorDQorCXJldCA9IGRybV9tb2RlX2NydGNf
c2V0X2dhbW1hX3NpemUoY3J0YywgMjU2KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQor
DQorCWRybV9jcnRjX2VuYWJsZV9jb2xvcl9tZ210KGNydGMsIDAsIGZhbHNlLCAyNTYpOw0KKw0K
KwlyZXR1cm4gMDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfZGVidWdmcy5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGVidWdmcy5jDQpu
ZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi45YWQyYzVhMGFkZDINCi0t
LSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2RlYnVnZnMu
Yw0KQEAgLTAsMCArMSw5MSBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4w
Kw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9y
YXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisN
CisjaW5jbHVkZSAibHNkY19iZW5jaG1hcmsuaCINCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisj
aW5jbHVkZSAibHNkY19nZW0uaCINCisjaW5jbHVkZSAibHNkY19wcm9iZS5oIg0KKyNpbmNsdWRl
ICJsc2RjX3R0bS5oIg0KKw0KKy8qIGRldmljZSBsZXZlbCBkZWJ1Z2ZzICovDQorDQorc3RhdGlj
IGludCBsc2RjX2lkZW50aWZ5KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJ
c3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUgPSAoc3RydWN0IGRybV9pbmZvX25vZGUgKiltLT5w
cml2YXRlOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSAoc3RydWN0IGxzZGNfZGV2aWNl
ICopbm9kZS0+aW5mb19lbnQtPmRhdGE7DQorCWNvbnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVz
YyAqZ2Z4ID0gdG9fbG9vbmdzb25fZ2Z4KGxkZXYtPmRlc2NwKTsNCisJdTggaW1wbCwgcmV2Ow0K
Kw0KKwlsb29uZ3Nvbl9jcHVfZ2V0X3ByaWQoJmltcGwsICZyZXYpOw0KKw0KKwlzZXFfcHJpbnRm
KG0sICJSdW5uaW5nIG9uIGNwdSAweCV4LCBjcHUgcmV2aXNpb246IDB4JXhcbiIsDQorCQkgICBp
bXBsLCByZXYpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICJDb250YWluZWQgaW46ICVzXG4iLCBnZngt
Pm1vZGVsKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19zaG93X21t
KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRybV9pbmZvX25v
ZGUgKm5vZGUgPSAoc3RydWN0IGRybV9pbmZvX25vZGUgKiltLT5wcml2YXRlOw0KKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiA9IG5vZGUtPm1pbm9yLT5kZXY7DQorCXN0cnVjdCBkcm1fcHJpbnRl
ciBwID0gZHJtX3NlcV9maWxlX3ByaW50ZXIobSk7DQorDQorCWRybV9tbV9wcmludCgmZGRldi0+
dm1hX29mZnNldF9tYW5hZ2VyLT52bV9hZGRyX3NwYWNlX21tLCAmcCk7DQorDQorCXJldHVybiAw
Ow0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfc2hvd19nZnhwbGxfY2xvY2soc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSA9IChz
dHJ1Y3QgZHJtX2luZm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBsc2RjX2RldmljZSAq
bGRldiA9IChzdHJ1Y3QgbHNkY19kZXZpY2UgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisJc3Ry
dWN0IGRybV9wcmludGVyIHByaW50ZXIgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsNCisJc3Ry
dWN0IGxvb25nc29uX2dmeHBsbCAqZ2Z4cGxsID0gbGRldi0+Z2Z4cGxsOw0KKw0KKwlnZnhwbGwt
PmZ1bmNzLT5wcmludChnZnhwbGwsICZwcmludGVyLCB0cnVlKTsNCisNCisJcmV0dXJuIDA7DQor
fQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19zaG93X2JlbmNobWFyayhzdHJ1Y3Qgc2VxX2ZpbGUgKm0s
IHZvaWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBk
cm1faW5mb19ub2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
KHN0cnVjdCBsc2RjX2RldmljZSAqKW5vZGUtPmluZm9fZW50LT5kYXRhOw0KKwlzdHJ1Y3QgZHJt
X3ByaW50ZXIgcHJpbnRlciA9IGRybV9zZXFfZmlsZV9wcmludGVyKG0pOw0KKw0KKwlsc2RjX3No
b3dfYmVuY2htYXJrX2NvcHkobGRldiwgJnByaW50ZXIpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQor
DQorc3RhdGljIHN0cnVjdCBkcm1faW5mb19saXN0IGxzZGNfZGVidWdmc19saXN0W10gPSB7DQor
CXsgImNoaXBzIiwgICAgICAgbHNkY19pZGVudGlmeSwgMCwgTlVMTCB9LA0KKwl7ICJjbG9ja3Mi
LCAgICAgIGxzZGNfc2hvd19nZnhwbGxfY2xvY2ssIDAsIE5VTEwgfSwNCisJeyAibW0iLCAgICAg
ICAgICBsc2RjX3Nob3dfbW0sIDAsIE5VTEwgfSwNCisJeyAiYm9zIiwgICAgICAgICBsc2RjX3No
b3dfYnVmZmVyX29iamVjdCwgMCwgTlVMTCB9LA0KKwl7ICJiZW5jaG1hcmsiLCAgIGxzZGNfc2hv
d19iZW5jaG1hcmssIDAsIE5VTEwgfSwNCit9Ow0KKw0KK3ZvaWQgbHNkY19kZWJ1Z2ZzX2luaXQo
c3RydWN0IGRybV9taW5vciAqbWlub3IpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9
IG1pbm9yLT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7
DQorCXVuc2lnbmVkIGludCBOID0gQVJSQVlfU0laRShsc2RjX2RlYnVnZnNfbGlzdCk7DQorCXVu
c2lnbmVkIGludCBpOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgTjsgKytpKQ0KKwkJbHNkY19kZWJ1
Z2ZzX2xpc3RbaV0uZGF0YSA9IGxkZXY7DQorDQorCWRybV9kZWJ1Z2ZzX2NyZWF0ZV9maWxlcyhs
c2RjX2RlYnVnZnNfbGlzdCwNCisJCQkJIE4sDQorCQkJCSBtaW5vci0+ZGVidWdmc19yb290LA0K
KwkJCQkgbWlub3IpOw0KKw0KKwlsc2RjX3R0bV9kZWJ1Z2ZzX2luaXQobGRldik7DQorfQ0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2RldmljZS5jIGIvZHJpdmVy
cy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGV2aWNlLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQpp
bmRleCAwMDAwMDAwMDAwMDAuLmI0MTUyZjIyOGJlYg0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZGV2aWNlLmMNCkBAIC0wLDAgKzEsMTA0IEBADQor
Ly8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArDQorLyoNCisgKiBDb3B5cmlnaHQg
KEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQor
DQorI2luY2x1ZGUgPGxpbnV4L3BjaS5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKw0K
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19rbXNfZnVuY3MgbHM3YTEwMDBfa21zX2Z1bmNzID0g
ew0KKwkuY3JlYXRlX2kyYyA9IGxzZGNfY3JlYXRlX2kyY19jaGFuLA0KKwkuaXJxX2hhbmRsZXIg
PSBsczdhMTAwMF9kY19pcnFfaGFuZGxlciwNCisJLm91dHB1dF9pbml0ID0gbHM3YTEwMDBfb3V0
cHV0X2luaXQsDQorCS5jdXJzb3JfcGxhbmVfaW5pdCA9IGxzN2ExMDAwX2N1cnNvcl9wbGFuZV9p
bml0LA0KKwkucHJpbWFyeV9wbGFuZV9pbml0ID0gbHNkY19wcmltYXJ5X3BsYW5lX2luaXQsDQor
CS5jcnRjX2luaXQgPSBsczdhMTAwMF9jcnRjX2luaXQsDQorfTsNCisNCitzdGF0aWMgY29uc3Qg
c3RydWN0IGxzZGNfa21zX2Z1bmNzIGxzN2EyMDAwX2ttc19mdW5jcyA9IHsNCisJLmNyZWF0ZV9p
MmMgPSBsc2RjX2NyZWF0ZV9pMmNfY2hhbiwNCisJLmlycV9oYW5kbGVyID0gbHM3YTIwMDBfZGNf
aXJxX2hhbmRsZXIsDQorCS5vdXRwdXRfaW5pdCA9IGxzN2EyMDAwX291dHB1dF9pbml0LA0KKwku
Y3Vyc29yX3BsYW5lX2luaXQgPSBsczdhMjAwMF9jdXJzb3JfcGxhbmVfaW5pdCwNCisJLnByaW1h
cnlfcGxhbmVfaW5pdCA9IGxzZGNfcHJpbWFyeV9wbGFuZV9pbml0LA0KKwkuY3J0Y19pbml0ID0g
bHM3YTIwMDBfY3J0Y19pbml0LA0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsb29uZ3Nv
bl9nZnhfZGVzYyBsczdhMTAwMF9nZnggPSB7DQorCS5kYyA9IHsNCisJCS5udW1fb2ZfY3J0YyA9
IDIsDQorCQkubWF4X3BpeGVsX2NsayA9IDIwMDAwMCwNCisJCS5tYXhfd2lkdGggPSAyMDQ4LA0K
KwkJLm1heF9oZWlnaHQgPSAyMDQ4LA0KKwkJLm51bV9vZl9od19jdXJzb3IgPSAxLA0KKwkJLmh3
X2N1cnNvcl93ID0gMzIsDQorCQkuaHdfY3Vyc29yX2ggPSAzMiwNCisJCS5waXRjaF9hbGlnbiA9
IDI1NiwNCisJCS5tY19iaXRzID0gNDAsDQorCQkuaGFzX3ZibGFua19jb3VudGVyID0gZmFsc2Us
DQorCQkuZnVuY3MgPSAmbHM3YTEwMDBfa21zX2Z1bmNzLA0KKwl9LA0KKwkuY29uZl9yZWdfYmFz
ZSA9IExTN0ExMDAwX0NPTkZfUkVHX0JBU0UsDQorCS5nZnhwbGwgPSB7DQorCQkucmVnX29mZnNl
dCA9IExTN0ExMDAwX1BMTF9HRlhfUkVHLA0KKwkJLnJlZ19zaXplID0gOCwNCisJfSwNCisJLnBp
eHBsbCA9IHsNCisJCVswXSA9IHsNCisJCQkucmVnX29mZnNldCA9IExTN0ExMDAwX1BJWFBMTDBf
UkVHLA0KKwkJCS5yZWdfc2l6ZSA9IDgsDQorCQl9LA0KKwkJWzFdID0gew0KKwkJCS5yZWdfb2Zm
c2V0ID0gTFM3QTEwMDBfUElYUExMMV9SRUcsDQorCQkJLnJlZ19zaXplID0gOCwNCisJCX0sDQor
CX0sDQorCS5jaGlwX2lkID0gQ0hJUF9MUzdBMTAwMCwNCisJLm1vZGVsID0gIkxTN0ExMDAwIGJy
aWRnZSBjaGlwc2V0IiwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4
X2Rlc2MgbHM3YTIwMDBfZ2Z4ID0gew0KKwkuZGMgPSB7DQorCQkubnVtX29mX2NydGMgPSAyLA0K
KwkJLm1heF9waXhlbF9jbGsgPSAzNTAwMDAsDQorCQkubWF4X3dpZHRoID0gNDA5NiwNCisJCS5t
YXhfaGVpZ2h0ID0gNDA5NiwNCisJCS5udW1fb2ZfaHdfY3Vyc29yID0gMiwNCisJCS5od19jdXJz
b3JfdyA9IDY0LA0KKwkJLmh3X2N1cnNvcl9oID0gNjQsDQorCQkucGl0Y2hfYWxpZ24gPSA2NCwN
CisJCS5tY19iaXRzID0gNDAsIC8qIFN1cHBvcnQgNDggYnV0IHVzaW5nIDQwIGZvciBiYWNrd2Fy
ZCBjb21wYXRpYmlsaXR5ICovDQorCQkuaGFzX3ZibGFua19jb3VudGVyID0gdHJ1ZSwNCisJCS5m
dW5jcyA9ICZsczdhMjAwMF9rbXNfZnVuY3MsDQorCX0sDQorCS5jb25mX3JlZ19iYXNlID0gTFM3
QTIwMDBfQ09ORl9SRUdfQkFTRSwNCisJLmdmeHBsbCA9IHsNCisJCS5yZWdfb2Zmc2V0ID0gTFM3
QTIwMDBfUExMX0dGWF9SRUcsDQorCQkucmVnX3NpemUgPSA4LA0KKwl9LA0KKwkucGl4cGxsID0g
ew0KKwkJWzBdID0gew0KKwkJCS5yZWdfb2Zmc2V0ID0gTFM3QTIwMDBfUElYUExMMF9SRUcsDQor
CQkJLnJlZ19zaXplID0gOCwNCisJCX0sDQorCQlbMV0gPSB7DQorCQkJLnJlZ19vZmZzZXQgPSBM
UzdBMjAwMF9QSVhQTEwxX1JFRywNCisJCQkucmVnX3NpemUgPSA4LA0KKwkJfSwNCisJfSwNCisJ
LmNoaXBfaWQgPSBDSElQX0xTN0EyMDAwLA0KKwkubW9kZWwgPSAiTFM3QTIwMDAgYnJpZGdlIGNo
aXBzZXQiLA0KK307DQorDQorY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqDQorbHNkY19kZXZpY2Vf
cHJvYmUoc3RydWN0IHBjaV9kZXYgKnBkZXYsIGVudW0gbG9vbmdzb25fY2hpcF9pZCBjaGlwX2lk
KQ0KK3sNCisJaWYgKGNoaXBfaWQgPT0gQ0hJUF9MUzdBMTAwMCkNCisJCXJldHVybiAmbHM3YTEw
MDBfZ2Z4LmRjOw0KKw0KKwlpZiAoY2hpcF9pZCA9PSBDSElQX0xTN0EyMDAwKQ0KKwkJcmV0dXJu
ICZsczdhMjAwMF9nZnguZGM7DQorDQorCXJldHVybiBFUlJfUFRSKC1FTk9ERVYpOw0KK30NCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kcnYuYyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2Rydi5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXgg
MDAwMDAwMDAwMDAwLi45OGUyYzI4Zjg4NmYNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2Rydi5jDQpAQCAtMCwwICsxLDQ5NSBAQA0KKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIz
IExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNs
dWRlIDxsaW51eC9wY2kuaD4NCisNCisjaW5jbHVkZSA8dmlkZW8vbm9tb2Rlc2V0Lmg+DQorDQor
I2luY2x1ZGUgPGRybS9kcm1fYXBlcnR1cmUuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWMu
aD4NCisjaW5jbHVkZSA8ZHJtL2RybV9hdG9taWNfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRybS9k
cm1fZHJ2Lmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZmJkZXZfZ2VuZXJpYy5oPg0KKyNpbmNsdWRl
IDxkcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9p
b2N0bC5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX21vZGVzZXRfaGVscGVyLmg+DQorI2luY2x1ZGUg
PGRybS9kcm1fcHJvYmVfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+DQor
DQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfZ2VtLmgiDQorI2luY2x1
ZGUgImxzZGNfaTJjLmgiDQorI2luY2x1ZGUgImxzZGNfaXJxLmgiDQorI2luY2x1ZGUgImxzZGNf
b3V0cHV0LmgiDQorI2luY2x1ZGUgImxzZGNfcHJvYmUuaCINCisjaW5jbHVkZSAibHNkY190dG0u
aCINCisNCisjZGVmaW5lIERSSVZFUl9BVVRIT1IgICAgICAgICAgICJTdWkgSmluZ2ZlbmcgPHN1
aWppbmdmZW5nQGxvb25nc29uLmNuPiINCisjZGVmaW5lIERSSVZFUl9OQU1FICAgICAgICAgICAg
ICJsb29uZ3NvbiINCisjZGVmaW5lIERSSVZFUl9ERVNDICAgICAgICAgICAgICJkcm0gZHJpdmVy
IGZvciBsb29uZ3NvbiBncmFwaGljcyINCisjZGVmaW5lIERSSVZFUl9EQVRFICAgICAgICAgICAg
ICIyMDIyMDcwMSINCisjZGVmaW5lIERSSVZFUl9NQUpPUiAgICAgICAgICAgIDENCisjZGVmaW5l
IERSSVZFUl9NSU5PUiAgICAgICAgICAgIDANCisjZGVmaW5lIERSSVZFUl9QQVRDSExFVkVMICAg
ICAgIDANCisNCitERUZJTkVfRFJNX0dFTV9GT1BTKGxzZGNfZ2VtX2ZvcHMpOw0KKw0KK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2RyaXZlciBsc2RjX2RybV9kcml2ZXIgPSB7DQorCS5kcml2ZXJf
ZmVhdHVyZXMgPSBEUklWRVJfTU9ERVNFVCB8IERSSVZFUl9SRU5ERVIgfCBEUklWRVJfR0VNIHwg
RFJJVkVSX0FUT01JQywNCisJLmZvcHMgPSAmbHNkY19nZW1fZm9wcywNCisNCisJLm5hbWUgPSBE
UklWRVJfTkFNRSwNCisJLmRlc2MgPSBEUklWRVJfREVTQywNCisJLmRhdGUgPSBEUklWRVJfREFU
RSwNCisJLm1ham9yID0gRFJJVkVSX01BSk9SLA0KKwkubWlub3IgPSBEUklWRVJfTUlOT1IsDQor
CS5wYXRjaGxldmVsID0gRFJJVkVSX1BBVENITEVWRUwsDQorDQorCS5kZWJ1Z2ZzX2luaXQgPSBs
c2RjX2RlYnVnZnNfaW5pdCwNCisJLmR1bWJfY3JlYXRlID0gbHNkY19kdW1iX2NyZWF0ZSwNCisJ
LmR1bWJfbWFwX29mZnNldCA9IGxzZGNfZHVtYl9tYXBfb2Zmc2V0LA0KKwkucHJpbWVfaGFuZGxl
X3RvX2ZkID0gZHJtX2dlbV9wcmltZV9oYW5kbGVfdG9fZmQsDQorCS5wcmltZV9mZF90b19oYW5k
bGUgPSBkcm1fZ2VtX3ByaW1lX2ZkX3RvX2hhbmRsZSwNCisJLmdlbV9wcmltZV9pbXBvcnRfc2df
dGFibGUgPSBsc2RjX3ByaW1lX2ltcG9ydF9zZ190YWJsZSwNCisJLmdlbV9wcmltZV9tbWFwID0g
ZHJtX2dlbV9wcmltZV9tbWFwLA0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fbW9k
ZV9jb25maWdfZnVuY3MgbHNkY19tb2RlX2NvbmZpZ19mdW5jcyA9IHsNCisJLmZiX2NyZWF0ZSA9
IGRybV9nZW1fZmJfY3JlYXRlLA0KKwkuYXRvbWljX2NoZWNrID0gZHJtX2F0b21pY19oZWxwZXJf
Y2hlY2ssDQorCS5hdG9taWNfY29tbWl0ID0gZHJtX2F0b21pY19oZWxwZXJfY29tbWl0LA0KK307
DQorDQorLyogRGlzcGxheSByZWxhdGVkICovDQorDQorc3RhdGljIGludCBsc2RjX21vZGVzZXRf
aW5pdChzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQorCQkJICAgICB1bnNpZ25lZCBpbnQgbnVt
X2NydGMsDQorCQkJICAgICBjb25zdCBzdHJ1Y3QgbHNkY19rbXNfZnVuY3MgKmZ1bmNzKQ0KK3sN
CisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSAmbGRldi0+YmFzZTsNCisJc3RydWN0IGxzZGNf
ZGlzcGxheV9waXBlICpkaXNwaXBlOw0KKwl1bnNpZ25lZCBpbnQgaTsNCisJaW50IHJldDsNCisN
CisJZm9yIChpID0gMDsgaSA8IG51bV9jcnRjOyBpKyspIHsNCisJCWRpc3BpcGUgPSAmbGRldi0+
ZGlzcGlwZVtpXTsNCisNCisJCS8qIFdlIG5lZWQgYSBpbmRleCBiZWZvcmUgY3J0YyBpcyBpbml0
aWFsaXplZCAqLw0KKwkJZGlzcGlwZS0+aW5kZXggPSBpOw0KKw0KKwkJcmV0ID0gZnVuY3MtPmNy
ZWF0ZV9pMmMoZGRldiwgZGlzcGlwZSwgaSk7DQorCQlpZiAocmV0KQ0KKwkJCXJldHVybiByZXQ7
DQorCX0NCisNCisJZm9yIChpID0gMDsgaSA8IG51bV9jcnRjOyBpKyspIHsNCisJCXN0cnVjdCBp
MmNfYWRhcHRlciAqZGRjID0gTlVMTDsNCisNCisJCWRpc3BpcGUgPSAmbGRldi0+ZGlzcGlwZVtp
XTsNCisJCWlmIChkaXNwaXBlLT5saTJjKQ0KKwkJCWRkYyA9ICZkaXNwaXBlLT5saTJjLT5hZGFw
dGVyOw0KKw0KKwkJcmV0ID0gZnVuY3MtPm91dHB1dF9pbml0KGRkZXYsIGRpc3BpcGUsIGRkYywg
aSk7DQorCQlpZiAocmV0KQ0KKwkJCXJldHVybiByZXQ7DQorDQorCQlsZGV2LT5udW1fb3V0cHV0
Kys7DQorCX0NCisNCisJZm9yIChpID0gMDsgaSA8IG51bV9jcnRjOyBpKyspIHsNCisJCWRpc3Bp
cGUgPSAmbGRldi0+ZGlzcGlwZVtpXTsNCisNCisJCXJldCA9IGZ1bmNzLT5wcmltYXJ5X3BsYW5l
X2luaXQoZGRldiwgJmRpc3BpcGUtPnByaW1hcnkuYmFzZSwgaSk7DQorCQlpZiAocmV0KQ0KKwkJ
CXJldHVybiByZXQ7DQorDQorCQlyZXQgPSBmdW5jcy0+Y3Vyc29yX3BsYW5lX2luaXQoZGRldiwg
JmRpc3BpcGUtPmN1cnNvci5iYXNlLCBpKTsNCisJCWlmIChyZXQpDQorCQkJcmV0dXJuIHJldDsN
CisNCisJCXJldCA9IGZ1bmNzLT5jcnRjX2luaXQoZGRldiwNCisJCQkJICAgICAgICZkaXNwaXBl
LT5jcnRjLmJhc2UsDQorCQkJCSAgICAgICAmZGlzcGlwZS0+cHJpbWFyeS5iYXNlLA0KKwkJCQkg
ICAgICAgJmRpc3BpcGUtPmN1cnNvci5iYXNlLA0KKwkJCQkgICAgICAgaSk7DQorCQlpZiAocmV0
KQ0KKwkJCXJldHVybiByZXQ7DQorCX0NCisNCisJZHJtX2luZm8oZGRldiwgInRvdGFsICV1IG91
dHB1dHNcbiIsIGxkZXYtPm51bV9vdXRwdXQpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fbW9kZV9jb25maWdfaGVscGVyX2Z1bmNzDQorbHNkY19tb2Rl
X2NvbmZpZ19oZWxwZXJfZnVuY3MgPSB7DQorCS5hdG9taWNfY29tbWl0X3RhaWwgPSBkcm1fYXRv
bWljX2hlbHBlcl9jb21taXRfdGFpbCwNCit9Ow0KKw0KK3N0YXRpYyBpbnQgbHNkY19tb2RlX2Nv
bmZpZ19pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCQkgY29uc3Qgc3RydWN0IGxz
ZGNfZGVzYyAqZGVzY3ApDQorew0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBkcm1tX21vZGVfY29u
ZmlnX2luaXQoZGRldik7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkZGV2LT5t
b2RlX2NvbmZpZy5mdW5jcyA9ICZsc2RjX21vZGVfY29uZmlnX2Z1bmNzOw0KKwlkZGV2LT5tb2Rl
X2NvbmZpZy5taW5fd2lkdGggPSAxOw0KKwlkZGV2LT5tb2RlX2NvbmZpZy5taW5faGVpZ2h0ID0g
MTsNCisJZGRldi0+bW9kZV9jb25maWcubWF4X3dpZHRoID0gZGVzY3AtPm1heF93aWR0aCAqIExT
RENfTlVNX0NSVEM7DQorCWRkZXYtPm1vZGVfY29uZmlnLm1heF9oZWlnaHQgPSBkZXNjcC0+bWF4
X2hlaWdodCAqIExTRENfTlVNX0NSVEM7DQorCWRkZXYtPm1vZGVfY29uZmlnLnByZWZlcnJlZF9k
ZXB0aCA9IDI0Ow0KKwlkZGV2LT5tb2RlX2NvbmZpZy5wcmVmZXJfc2hhZG93ID0gMTsNCisNCisJ
ZGRldi0+bW9kZV9jb25maWcuY3Vyc29yX3dpZHRoID0gZGVzY3AtPmh3X2N1cnNvcl9oOw0KKwlk
ZGV2LT5tb2RlX2NvbmZpZy5jdXJzb3JfaGVpZ2h0ID0gZGVzY3AtPmh3X2N1cnNvcl9oOw0KKw0K
KwkvKiBJbmRpY2F0ZXMgc3VwcG9ydCBmb3IgaW1tZWRpYXRlIGZsaXAgKi8NCisJZGRldi0+bW9k
ZV9jb25maWcuYXN5bmNfcGFnZV9mbGlwID0gdHJ1ZTsNCisNCisJZGRldi0+bW9kZV9jb25maWcu
aGVscGVyX3ByaXZhdGUgPSAmbHNkY19tb2RlX2NvbmZpZ19oZWxwZXJfZnVuY3M7DQorDQorCWlm
IChkZXNjcC0+aGFzX3ZibGFua19jb3VudGVyKQ0KKwkJZGRldi0+bWF4X3ZibGFua19jb3VudCA9
IDB4ZmZmZmZmZmY7DQorDQorCXJldHVybiByZXQ7DQorfQ0KKw0KKy8qDQorICogVGhlIEdQVSBh
bmQgZGlzcGxheSBjb250cm9sbGVyIGluIExTN0ExMDAwL0xTN0EyMDAwIGFyZSBzZXBhcmF0ZWQN
CisgKiBQQ0lFIGRldmljZXMsIHRoZXkgYXJlIHR3byBkZXZpY2VzIG5vdCBvbmUuIFRoZSBEQyBk
b2VzIG5vdCBoYXMgYQ0KKyAqIGRlZGljYXRlIFZSQU0gYmFyLCBiZWNhdXNlIHRoZSBCSU9TIGVu
Z2luZWVyIGNob29zZSB0byBhc3NpZ24gdGhlDQorICogVlJBTSB0byB0aGUgR1BVIGRldmljZS4g
U2FkbHksIGFmdGVyIHllYXJzIGFwcGxpY2F0aW9uLCB0aGlzIGZvcm0NCisgKiBhcyBhIGNvbnZl
bnRpb24gZm9yIGxvb25nc29uIGludGVncmF0ZWQgZ3JhcGhpY3MuIEJhciAyIG9mIHRoZSBHUFUN
CisgKiBkZXZpY2UgY29udGFpbiB0aGUgYmFzZSBhZGRyZXNzIGFuZCBzaXplIG9mIHRoZSBWUkFN
LCBib3RoIHRoZSBHUFUNCisgKiBhbmQgdGhlIERDIGNhbiBhY2Nlc3MgdGhlIG9uLWJvYXJkIFZS
QU0gYXMgbG9uZyBhcyB0aGUgRE1BIGFkZHJlc3MNCisgKiBlbWl0dGVkIGZhbGwgaW4gW2Jhc2Us
IGJhc2UgKyBzaXplKS4NCisgKi8NCitzdGF0aWMgaW50IGxzZGNfZ2V0X2RlZGljYXRlZF92cmFt
KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwNCisJCQkJICAgc3RydWN0IHBjaV9kZXYgKnBkZXZf
ZGMsDQorCQkJCSAgIGNvbnN0IHN0cnVjdCBsc2RjX2Rlc2MgKmRlc2NwKQ0KK3sNCisJc3RydWN0
IGRybV9kZXZpY2UgKmRkZXYgPSAmbGRldi0+YmFzZTsNCisJc3RydWN0IHBjaV9kZXYgKnBkZXZf
Z3B1Ow0KKwlyZXNvdXJjZV9zaXplX3QgYmFzZSwgc2l6ZTsNCisNCisJLyoNCisJICogVGhlIEdQ
VSBoYXMgMDA6MDYuMCBhcyBpdHMgQkRGLCB3aGlsZSB0aGUgREMgaGFzIDAwOjA2LjEsDQorCSAq
IFRoaXMgaXMgc3VyZSBmb3IgTFM3QTEwMDAsIExTN0EyMDAwIGFuZCBMUzJLMjAwMC4NCisJICov
DQorCXBkZXZfZ3B1ID0gcGNpX2dldF9kb21haW5fYnVzX2FuZF9zbG90KHBjaV9kb21haW5fbnIo
cGRldl9kYy0+YnVzKSwNCisJCQkJCSAgICAgICBwZGV2X2RjLT5idXMtPm51bWJlciwNCisJCQkJ
CSAgICAgICBQQ0lfREVWRk4oNiwgMCkpOw0KKwlpZiAoIXBkZXZfZ3B1KSB7DQorCQlkcm1fZXJy
KGRkZXYsICJObyBHUFUgZGV2aWNlLCB0aGVuIG5vIFZSQU1cbiIpOw0KKwkJcmV0dXJuIC1FTk9E
RVY7DQorCX0NCisNCisJYmFzZSA9IHBjaV9yZXNvdXJjZV9zdGFydChwZGV2X2dwdSwgMik7DQor
CXNpemUgPSBwY2lfcmVzb3VyY2VfbGVuKHBkZXZfZ3B1LCAyKTsNCisNCisJbGRldi0+dnJhbV9i
YXNlID0gYmFzZTsNCisJbGRldi0+dnJhbV9zaXplID0gc2l6ZTsNCisJbGRldi0+Z3B1ID0gcGRl
dl9ncHU7DQorDQorCWRybV9pbmZvKGRkZXYsICJkZWRpY2F0ZWQgdnJhbSBzdGFydDogMHglbGx4
LCBzaXplOiAldU1CXG4iLA0KKwkJICh1NjQpYmFzZSwgKHUzMikoc2l6ZSA+PiAyMCkpOw0KKw0K
KwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHN0cnVjdCBsc2RjX2RldmljZSAqDQorbHNkY19j
cmVhdGVfZGV2aWNlKHN0cnVjdCBwY2lfZGV2ICpwZGV2LA0KKwkJICAgY29uc3Qgc3RydWN0IGxz
ZGNfZGVzYyAqZGVzY3AsDQorCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2RyaXZlciAqZHJ2KQ0KK3sN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldjsN
CisJaW50IHJldDsNCisNCisJbGRldiA9IGRldm1fZHJtX2Rldl9hbGxvYygmcGRldi0+ZGV2LCBk
cnYsIHN0cnVjdCBsc2RjX2RldmljZSwgYmFzZSk7DQorCWlmIChJU19FUlIobGRldikpDQorCQly
ZXR1cm4gbGRldjsNCisNCisJZGRldiA9ICZsZGV2LT5iYXNlOw0KKw0KKwlsZGV2LT5kZXNjcCA9
IGRlc2NwOw0KKw0KKwlsb29uZ3Nvbl9nZnhwbGxfY3JlYXRlKGRkZXYsICZsZGV2LT5nZnhwbGwp
Ow0KKw0KKwlyZXQgPSBsc2RjX2dldF9kZWRpY2F0ZWRfdnJhbShsZGV2LCBwZGV2LCBkZXNjcCk7
DQorCWlmIChyZXQpIHsNCisJCWRybV9lcnIoZGRldiwgIkluaXQgVlJBTSBmYWlsZWQ6ICVkXG4i
LCByZXQpOw0KKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisJfQ0KKw0KKwlyZXQgPSBkcm1fYXBl
cnR1cmVfcmVtb3ZlX2NvbmZsaWN0aW5nX2ZyYW1lYnVmZmVycyhsZGV2LT52cmFtX2Jhc2UsDQor
CQkJCQkJCSAgIGxkZXYtPnZyYW1fc2l6ZSwNCisJCQkJCQkJICAgZHJ2KTsNCisJaWYgKHJldCkg
ew0KKwkJZHJtX2VycihkZGV2LCAicmVtb3ZlIGZpcm13YXJlIGZyYW1lYnVmZmVycyBmYWlsZWQ6
ICVkXG4iLCByZXQpOw0KKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisJfQ0KKw0KKwlyZXQgPSBs
c2RjX3R0bV9pbml0KGxkZXYpOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKGRkZXYsICJtZW1v
cnkgbWFuYWdlciBpbml0IGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQlyZXR1cm4gRVJSX1BUUihy
ZXQpOw0KKwl9DQorDQorCWxzZGNfZ2VtX2luaXQoZGRldik7DQorDQorCS8qIEJBUiAwIG9mIHRo
ZSBEQyBkZXZpY2UgY29udGFpbiByZWdpc3RlcnMgYmFzZSBhZGRyZXNzICovDQorCWxkZXYtPnJl
Z19iYXNlID0gcGNpbV9pb21hcChwZGV2LCAwLCAwKTsNCisJaWYgKCFsZGV2LT5yZWdfYmFzZSkN
CisJCXJldHVybiBFUlJfUFRSKC1FTk9ERVYpOw0KKw0KKwlzcGluX2xvY2tfaW5pdCgmbGRldi0+
cmVnbG9jayk7DQorDQorCXJldCA9IGxzZGNfbW9kZV9jb25maWdfaW5pdChkZGV2LCBkZXNjcCk7
DQorCWlmIChyZXQpDQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKw0KKwlyZXQgPSBsc2RjX21v
ZGVzZXRfaW5pdChsZGV2LCBkZXNjcC0+bnVtX29mX2NydGMsIGRlc2NwLT5mdW5jcyk7DQorCWlm
IChyZXQpDQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKw0KKwlkcm1fbW9kZV9jb25maWdfcmVz
ZXQoZGRldik7DQorDQorCXJldCA9IGRybV92YmxhbmtfaW5pdChkZGV2LCBkZXNjcC0+bnVtX29m
X2NydGMpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisNCisJZHJtX2tt
c19oZWxwZXJfcG9sbF9pbml0KGRkZXYpOw0KKw0KKwlyZXR1cm4gbGRldjsNCit9DQorDQorc3Rh
dGljIGludCBsc2RjX3BjaV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgY29uc3Qgc3RydWN0
IHBjaV9kZXZpY2VfaWQgKmVudCkNCit7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2Rlc2MgKmRlc2Nw
Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2
Ow0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBwY2ltX2VuYWJsZV9kZXZpY2UocGRldik7DQorCWlm
IChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlwY2lfc2V0X21hc3RlcihwZGV2KTsNCisNCisJ
cmV0ID0gZG1hX3NldF9tYXNrX2FuZF9jb2hlcmVudCgmcGRldi0+ZGV2LCBETUFfQklUX01BU0so
NDApKTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWRlc2NwID0gbHNkY19kZXZp
Y2VfcHJvYmUocGRldiwgZW50LT5kcml2ZXJfZGF0YSk7DQorCWlmIChJU19FUlJfT1JfTlVMTChk
ZXNjcCkpDQorCQlyZXR1cm4gLUVOT0RFVjsNCisNCisJZGV2X2luZm8oJnBkZXYtPmRldiwgIkZv
dW5kICVzLCByZXZpc2lvbjogJXUiLA0KKwkJIHRvX2xvb25nc29uX2dmeChkZXNjcCktPm1vZGVs
LCBwZGV2LT5yZXZpc2lvbik7DQorDQorCWxkZXYgPSBsc2RjX2NyZWF0ZV9kZXZpY2UocGRldiwg
ZGVzY3AsICZsc2RjX2RybV9kcml2ZXIpOw0KKwlpZiAoSVNfRVJSKGxkZXYpKQ0KKwkJcmV0dXJu
IFBUUl9FUlIobGRldik7DQorDQorCWxkZXYtPmRjID0gcGRldjsNCisNCisJZGRldiA9ICZsZGV2
LT5iYXNlOw0KKw0KKwlwY2lfc2V0X2RydmRhdGEocGRldiwgZGRldik7DQorDQorCXJldCA9IGRl
dm1fcmVxdWVzdF9pcnEoJnBkZXYtPmRldiwNCisJCQkgICAgICAgcGRldi0+aXJxLA0KKwkJCSAg
ICAgICBkZXNjcC0+ZnVuY3MtPmlycV9oYW5kbGVyLA0KKwkJCSAgICAgICBJUlFGX1NIQVJFRCwN
CisJCQkgICAgICAgZGV2X25hbWUoJnBkZXYtPmRldiksDQorCQkJICAgICAgIGRkZXYpOw0KKwlp
ZiAocmV0KSB7DQorCQlkcm1fZXJyKGRkZXYsICJGYWlsZWQgdG8gcmVnaXN0ZXIgaW50ZXJydXB0
OiAlZFxuIiwgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJcmV0ID0gZHJtX2Rldl9y
ZWdpc3RlcihkZGV2LCAwKTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWRybV9m
YmRldl9nZW5lcmljX3NldHVwKGRkZXYsIDMyKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGxzZGNfcGNpX3JlbW92ZShzdHJ1Y3QgcGNpX2RldiAqcGRldikNCit7DQorCXN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOw0KKw0KKwlkcm1f
ZGV2X3VucmVnaXN0ZXIoZGRldik7DQorCWRybV9hdG9taWNfaGVscGVyX3NodXRkb3duKGRkZXYp
Ow0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfZHJtX2ZyZWV6ZShzdHJ1Y3QgZHJtX2RldmljZSAq
ZGRldikNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQor
CXN0cnVjdCBsc2RjX2JvICpsYm87DQorCWludCByZXQ7DQorDQorCS8qIHVucGluIGFsbCBvZiBi
dWZmZXJzIGluIHRoZSB2cmFtICovDQorCW11dGV4X2xvY2soJmxkZXYtPmdlbS5tdXRleCk7DQor
CWxpc3RfZm9yX2VhY2hfZW50cnkobGJvLCAmbGRldi0+Z2VtLm9iamVjdHMsIGxpc3QpIHsNCisJ
CXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwkJc3RydWN0IHR0
bV9yZXNvdXJjZSAqcmVzb3VyY2UgPSB0Ym8tPnJlc291cmNlOw0KKwkJdW5zaWduZWQgaW50IHBp
bl9jb3VudCA9IHRiby0+cGluX2NvdW50Ow0KKw0KKwkJZHJtX2RiZyhkZGV2LA0KKwkJCSJib1sl
cF0sIHNpemU6ICV6dUtCLCB0eXBlOiAlcywgcGluIGNvdW50OiAldVxuIiwNCisJCQlsYm8sDQor
CQkJbHNkY19ib19zaXplKGxibykgPj4gMTAsDQorCQkJbHNkY19tZW1fdHlwZV90b19zdHIocmVz
b3VyY2UtPm1lbV90eXBlKSwNCisJCQlwaW5fY291bnQpOw0KKw0KKwkJaWYgKCFwaW5fY291bnQp
DQorCQkJY29udGludWU7DQorDQorCQlpZiAocmVzb3VyY2UtPm1lbV90eXBlID09IFRUTV9QTF9W
UkFNKSB7DQorCQkJcmV0ID0gbHNkY19ib19yZXNlcnZlKGxibyk7DQorCQkJaWYgKHVubGlrZWx5
KHJldCkpIHsNCisJCQkJZHJtX2VycihkZGV2LCAiYm8gcmVzZXJ2ZSBmYWlsZWQ6ICVkXG4iLCBy
ZXQpOw0KKwkJCQljb250aW51ZTsNCisJCQl9DQorDQorCQkJLyoNCisJCQkgKiBGb3IgZG91Ymxl
IHNjcmVlbiB1c2FnZSBjYXNlLCBtdWx0aXBsZSBjcnRjIG1heQ0KKwkJCSAqIHJlZmVyZW5jZSB0
byB0aGUgc2luZ2xlIGdpYW50IGZyYW1lYnVmZmVyIGJvLg0KKwkJCSAqIFRoZSBzaW5nbGUgZ2lh
bnQgZmIgYm8gZ2V0IHBpbm5lZCBieSBtdWx0aXBsZSB0aW1lLg0KKwkJCSAqIHRodXMsIGl0IG5l
ZWQgdG8gdW5waW4gdW50aWwgaXRzIHBpbiBjb3VudGVyIHJlYWNoDQorCQkJICogemVyby4NCisJ
CQkgKi8NCisJCQlkbyB7DQorCQkJCWxzZGNfYm9fdW5waW4obGJvKTsNCisJCQkJLS1waW5fY291
bnQ7DQorCQkJfSB3aGlsZSAocGluX2NvdW50KTsNCisNCisJCQlsc2RjX2JvX3VucmVzZXJ2ZShs
Ym8pOw0KKwkJfQ0KKwl9DQorCW11dGV4X3VubG9jaygmbGRldi0+Z2VtLm11dGV4KTsNCisNCisJ
bHNkY19ib19ldmljdF92cmFtKGRkZXYpOw0KKw0KKwlyZXQgPSBkcm1fbW9kZV9jb25maWdfaGVs
cGVyX3N1c3BlbmQoZGRldik7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fZXJyKGRk
ZXYsICJmcmVlemUgZXJyb3I6ICVkIiwgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJ
cmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19kcm1fcmVzdW1lKHN0cnVjdCBkZXZp
Y2UgKmRldikNCit7DQorCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gdG9fcGNpX2RldihkZXYpOw0K
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IHBjaV9nZXRfZHJ2ZGF0YShwZGV2KTsNCisNCisJ
cmV0dXJuIGRybV9tb2RlX2NvbmZpZ19oZWxwZXJfcmVzdW1lKGRkZXYpOw0KK30NCisNCitzdGF0
aWMgaW50IGxzZGNfcG1fZnJlZXplKHN0cnVjdCBkZXZpY2UgKmRldikNCit7DQorCXN0cnVjdCBw
Y2lfZGV2ICpwZGV2ID0gdG9fcGNpX2RldihkZXYpOw0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRl
diA9IHBjaV9nZXRfZHJ2ZGF0YShwZGV2KTsNCisNCisJcmV0dXJuIGxzZGNfZHJtX2ZyZWV6ZShk
ZGV2KTsNCit9DQorDQorc3RhdGljIGludCBsc2RjX3BtX3RoYXcoc3RydWN0IGRldmljZSAqZGV2
KQ0KK3sNCisJcmV0dXJuIGxzZGNfZHJtX3Jlc3VtZShkZXYpOw0KK30NCisNCitzdGF0aWMgaW50
IGxzZGNfcG1fc3VzcGVuZChzdHJ1Y3QgZGV2aWNlICpkZXYpDQorew0KKwlzdHJ1Y3QgcGNpX2Rl
diAqcGRldiA9IHRvX3BjaV9kZXYoZGV2KTsNCisJaW50IGVycm9yOw0KKw0KKwllcnJvciA9IGxz
ZGNfcG1fZnJlZXplKGRldik7DQorCWlmIChlcnJvcikNCisJCXJldHVybiBlcnJvcjsNCisNCisJ
cGNpX3NhdmVfc3RhdGUocGRldik7DQorCS8qIFNodXQgZG93biB0aGUgZGV2aWNlICovDQorCXBj
aV9kaXNhYmxlX2RldmljZShwZGV2KTsNCisJcGNpX3NldF9wb3dlcl9zdGF0ZShwZGV2LCBQQ0lf
RDNob3QpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX3BtX3Jlc3Vt
ZShzdHJ1Y3QgZGV2aWNlICpkZXYpDQorew0KKwlzdHJ1Y3QgcGNpX2RldiAqcGRldiA9IHRvX3Bj
aV9kZXYoZGV2KTsNCisNCisJcGNpX3NldF9wb3dlcl9zdGF0ZShwZGV2LCBQQ0lfRDApOw0KKw0K
KwlwY2lfcmVzdG9yZV9zdGF0ZShwZGV2KTsNCisNCisJaWYgKHBjaW1fZW5hYmxlX2RldmljZShw
ZGV2KSkNCisJCXJldHVybiAtRUlPOw0KKw0KKwlyZXR1cm4gbHNkY19wbV90aGF3KGRldik7DQor
fQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZGV2X3BtX29wcyBsc2RjX3BtX29wcyA9IHsNCisJ
LnN1c3BlbmQgPSBsc2RjX3BtX3N1c3BlbmQsDQorCS5yZXN1bWUgPSBsc2RjX3BtX3Jlc3VtZSwN
CisJLmZyZWV6ZSA9IGxzZGNfcG1fZnJlZXplLA0KKwkudGhhdyA9IGxzZGNfcG1fdGhhdywNCisJ
LnBvd2Vyb2ZmID0gbHNkY19wbV9mcmVlemUsDQorCS5yZXN0b3JlID0gbHNkY19wbV9yZXN1bWUs
DQorfTsNCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IHBjaV9kZXZpY2VfaWQgbHNkY19wY2lpZF9s
aXN0W10gPSB7DQorCXtQQ0lfVkVORE9SX0lEX0xPT05HU09OLCAweDdhMDYsIFBDSV9BTllfSUQs
IFBDSV9BTllfSUQsIDAsIDAsIENISVBfTFM3QTEwMDB9LA0KKwl7UENJX1ZFTkRPUl9JRF9MT09O
R1NPTiwgMHg3YTM2LCBQQ0lfQU5ZX0lELCBQQ0lfQU5ZX0lELCAwLCAwLCBDSElQX0xTN0EyMDAw
fSwNCisJezAsIDAsIDAsIDAsIDAsIDAsIDB9DQorfTsNCisNCitzdGF0aWMgc3RydWN0IHBjaV9k
cml2ZXIgbHNkY19wY2lfZHJpdmVyID0gew0KKwkubmFtZSA9IERSSVZFUl9OQU1FLA0KKwkuaWRf
dGFibGUgPSBsc2RjX3BjaWlkX2xpc3QsDQorCS5wcm9iZSA9IGxzZGNfcGNpX3Byb2JlLA0KKwku
cmVtb3ZlID0gbHNkY19wY2lfcmVtb3ZlLA0KKwkuZHJpdmVyLnBtID0gJmxzZGNfcG1fb3BzLA0K
K307DQorDQorc3RhdGljIGludCBfX2luaXQgbG9vbmdzb25fbW9kdWxlX2luaXQodm9pZCkNCit7
DQorCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gTlVMTDsNCisNCisJaWYgKHZpZGVvX2Zpcm13YXJl
X2RyaXZlcnNfb25seSgpKQ0KKwkJcmV0dXJuIC1FTk9ERVY7DQorDQorCS8qIE11bHRpcGxlIHZp
ZGVvIGNhcmQgd29ya2Fyb3VuZCAqLw0KKwl3aGlsZSAoKHBkZXYgPSBwY2lfZ2V0X2NsYXNzKFBD
SV9DTEFTU19ESVNQTEFZX1ZHQSA8PCA4LCBwZGV2KSkpIHsNCisJCWlmIChwZGV2LT52ZW5kb3Ig
IT0gUENJX1ZFTkRPUl9JRF9MT09OR1NPTikgew0KKwkJCXByX2luZm8oIkRpc2NyZXRlIGdyYXBo
aWMgY2FyZCBkZXRlY3RlZCwgYWJvcnRcbiIpOw0KKwkJCXJldHVybiAwOw0KKwkJfQ0KKwl9DQor
DQorCXJldHVybiBwY2lfcmVnaXN0ZXJfZHJpdmVyKCZsc2RjX3BjaV9kcml2ZXIpOw0KK30NCitt
b2R1bGVfaW5pdChsb29uZ3Nvbl9tb2R1bGVfaW5pdCk7DQorDQorc3RhdGljIHZvaWQgX19leGl0
IGxvb25nc29uX21vZHVsZV9leGl0KHZvaWQpDQorew0KKwlwY2lfdW5yZWdpc3Rlcl9kcml2ZXIo
JmxzZGNfcGNpX2RyaXZlcik7DQorfQ0KK21vZHVsZV9leGl0KGxvb25nc29uX21vZHVsZV9leGl0
KTsNCisNCitNT0RVTEVfREVWSUNFX1RBQkxFKHBjaSwgbHNkY19wY2lpZF9saXN0KTsNCitNT0RV
TEVfQVVUSE9SKERSSVZFUl9BVVRIT1IpOw0KK01PRFVMRV9ERVNDUklQVElPTihEUklWRVJfREVT
Qyk7DQorTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX2Rydi5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2
LmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjI1NjM2Nzg3MTkx
Zg0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2
LmgNCkBAIC0wLDAgKzEsNDUxIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAgKi8NCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENv
cnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19EUlZfSF9fDQorI2Rl
ZmluZSBfX0xTRENfRFJWX0hfXw0KKw0KKyNpbmNsdWRlIDxsaW51eC9wY2kuaD4NCisNCisjaW5j
bHVkZSA8ZHJtL2RybV9jb25uZWN0b3IuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9jcnRjLmg+DQor
I2luY2x1ZGUgPGRybS9kcm1fZGV2aWNlLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZW5jb2Rlci5o
Pg0KKyNpbmNsdWRlIDxkcm0vZHJtX2ZpbGUuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9wbGFuZS5o
Pg0KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9kZXZpY2UuaD4NCisNCisjaW5jbHVkZSAibHNkY19p
MmMuaCINCisjaW5jbHVkZSAibHNkY19pcnEuaCINCisjaW5jbHVkZSAibHNkY19nZnhwbGwuaCIN
CisjaW5jbHVkZSAibHNkY19vdXRwdXQuaCINCisjaW5jbHVkZSAibHNkY19waXhwbGwuaCINCisj
aW5jbHVkZSAibHNkY19yZWdzLmgiDQorDQorLyogQ3VycmVudGx5LCBhbGwgbG9vbmdzb24gZGlz
cGxheSBjb250cm9sbGVyIGhhcyB0d28gZGlzcGxheSBwaXBlcyAqLw0KKyNkZWZpbmUgTFNEQ19O
VU1fQ1JUQyAgICAgICAgICAgMg0KKw0KKy8qDQorICogTFM3QTEwMDAvTFM3QTIwMDAgYnJpZGdl
IGNoaXBzZXQgZnVuY3Rpb24gYXMgc291dGggJiBub3J0aCBvZiB0aGUgTG9vbmdzb24NCisgKiBM
UzNBNDAwMC9MUzNBNTAwMC9MUzNBNjAwMCBDUFUsIHRoZXkgYXJlIGVxdWlwcGVkIHdpdGggb24t
Ym9hcmQgdmlkZW8gUkFNDQorICogdHlwaWNhbGx5LiBXaGlsZSBMUzJLMDUwMC9MUzJLMTAwMC9M
UzJLMjAwMCBhcmUgbG93IGNvc3QgU29DcyB3aGljaCBzaGFyZQ0KKyAqIHRoZSBzeXN0ZW0gUkFN
IGFzIHZpZGVvIFJBTSwgdGhleSBkb24ndCBoYXMgYSBkZWRpYWNhdGVkIFZSQU0uDQorICoNCisg
KiBMUzdBMjAwMCBpbnRlZ3JhdGVkIGEgMzItYml0IEREUjRAMjQwMCB2aWRlbyBtZW10b3J5IGNv
bnRyb2xsZXIsIHdoaWxlDQorICogaXQgaXMganVzdCAxNi1iaXQgRERSMyBmb3IgTFM3QTEwMDAu
IExTN0EyMDAwIGludGVncmF0ZSBMb29uZ3NvbiBzZWxmDQorICogbWFkZWQgTG9vbmdHUFUsIExT
N0ExMDAwIGludGVncmF0ZSBHQzEwMDAgZHVlIHRvIGhpc3RvcmljYWwgcmVhc29ucy4NCisgKg0K
KyAqIFRoZSBkaXNwbGF5IGNvbnRyb2xsZXIgaW4gTFM3QTEwMDAgaGFzIG9ubHkgdHdvLXdheSBE
Vk8gaW50ZXJmYWNlIGV4cG9ydGVkLA0KKyAqIHRodXMsIGV4dGVybmFsIGVuY29kZXIoVFggY2hp
cCkgaXMgcmVxdWlyZWQgZXhjZXB0IGNvbm5lY3RlZCB3aXRoIERQSSBwYW5lbA0KKyAqIGRpcmVj
dGx5Lg0KKyAqICAgICAgIF9fX19fX19fX19fX19fX19fX18gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgX19fX19fX19fDQorICogICAgICB8ICAgICAgICAgICAgLS0tLS0tLXwg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICB8DQorICogICAgICB8
ICBDUlRDMCAtLT4gfCBEVk8wIC0tLS0+IEVuY29kZXIwIC0tLT4gQ29ubmVjdG9yMCAtLS0+IHwg
RGlzcGxheSB8DQorICogICAgICB8ICBfICAgXyAgICAgLS0tLS0tLXwgICAgICAgIF4gICAgICAg
ICAgICAgXiAgICAgICAgICAgIHxfX19fX19fX198DQorICogICAgICB8IHwgfCB8IHwgICstLS0t
LS0rIHwgICAgICAgIHwgICAgICAgICAgICAgfA0KKyAqICAgICAgfCB8X3wgfF98ICB8IGkyYzYg
fCA8LS0tLS0tLS0rLS0tLS0tLS0tLS0tLSsNCisgKiAgICAgIHwgICAgICAgICAgKy0tLS0tLSsg
fA0KKyAqICAgICAgfCAgICAgICAgICAgICAgICAgICB8DQorICogICAgICB8ICBEQyBpbiBMUzdB
MTAwMCAgIHwNCisgKiAgICAgIHwgICAgICAgICAgICAgICAgICAgfA0KKyAqICAgICAgfCAgXyAg
IF8gICArLS0tLS0tKyB8DQorICogICAgICB8IHwgfCB8IHwgIHwgaTJjNyB8IDwtLS0tLS0tLSst
LS0tLS0tLS0tLS0tKw0KKyAqICAgICAgfCB8X3wgfF98ICArLS0tLS0tKyB8ICAgICAgICB8ICAg
ICAgICAgICAgIHwgICAgICAgICAgICAgX19fX19fX19fDQorICogICAgICB8ICAgICAgICAgICAg
LS0tLS0tLXwgICAgICAgIHwgICAgICAgICAgICAgfCAgICAgICAgICAgIHwgICAgICAgICB8DQor
ICogICAgICB8ICBDUlRDMSAtLT4gfCBEVk8xIC0tLS0+IEVuY29kZXIxIC0tLT4gQ29ubmVjdG9y
MSAtLS0+IHwgIFBhbmVsICB8DQorICogICAgICB8ICAgICAgICAgICAgLS0tLS0tLXwgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHxfX19fX19fX198DQorICogICAgICB8X19fX19f
X19fX19fX19fX19fX3wNCisgKg0KKyAqIFRoZSBkaXNwbGF5IGNvbnRyb2xsZXIgaW4gTFM3QTIw
MDAgaGFzIHR3byBkaXNwbGF5IHBpcGUsIHlldCBpdCBoYXMNCisgKiBpbnRlZ3JhdGVkIHRocmVl
IGVuY29kZXJzLCBkaXNwbGF5IHBpcGUgMCBpcyBhdHRhY2hlZCB3aXRoIGEgdHJhbnNwYXJlbnQN
CisgKiBWR0EgZW5jb2RlciBhbmQgYSBIRE1JIGVuY29kZXIsIHRoZXkgYXJlIHBhcmFsbGVsLiBE
aXNwbGF5IHBpcGUgMSBoYXMNCisgKiBvbmx5IG9uZSBIRE1JIHBoeSBjb25uZWN0ZWQuDQorICoN
CisgKiAgICAgICBfX19fX19fX19fX19fX19fX19fX19fICAgICAgICAgICAgICAgICAgICAgICAg
ICBfX19fX19fX19fX19fDQorICogICAgICB8ICAgICAgICAgICAgICstLS0tLSsgIHwgICAgICAg
ICAgICAgICAgICAgICAgICB8ICAgICAgICAgICAgIHwNCisgKiAgICAgIHwgQ1JUQzAgLSstLT4g
fCBWR0EgfCAgLS0tLT4gVkdBIENvbm5lY3RvciAtLS0+IHwgVkdBIE1vbml0b3IgfDwtLS0rDQor
ICogICAgICB8ICAgICAgICB8ICAgICstLS0tLSsgIHwgICAgICAgICAgICAgICAgICAgICAgICB8
X19fX19fX19fX19fX3wgICAgfA0KKyAqICAgICAgfCAgICAgICAgfCAgICAgICAgICAgICB8ICAg
ICAgICAgICAgICAgICAgICAgICAgIF9fX19fX19fX19fX19fICAgIHwNCisgKiAgICAgIHwgICAg
ICAgIHwgICAgKy0tLS0tLSsgfCAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAg
IHwgICB8DQorICogICAgICB8ICAgICAgICArLS0+IHwgSERNSSB8IC0tLS0+IEhETUkgQ29ubmVj
dG9yIC0tPiB8IEhETUkgTW9uaXRvciB8PC0tKw0KKyAqICAgICAgfCAgICAgICAgICAgICArLS0t
LS0tKyB8ICAgICAgICAgICAgICAgICAgICAgICAgfF9fX19fX19fX19fX19ffCAgIHwNCisgKiAg
ICAgIHwgICAgICAgICAgICArLS0tLS0tKyAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8DQorICogICAgICB8ICAgICAgICAgICAgfCBpMmM2IHwgIDwtLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KKyAqICAgICAgfCAgICAgICAg
ICAgICstLS0tLS0rICB8DQorICogICAgICB8ICAgICAgICAgICAgICAgICAgICAgIHwNCisgKiAg
ICAgIHwgICAgREMgaW4gTFM3QTIwMDAgICAgfA0KKyAqICAgICAgfCAgICAgICAgICAgICAgICAg
ICAgICB8DQorICogICAgICB8ICAgICAgICAgICAgKy0tLS0tLSsgIHwNCisgKiAgICAgIHwgICAg
ICAgICAgICB8IGkyYzcgfCAgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KKyAq
ICAgICAgfCAgICAgICAgICAgICstLS0tLS0rICB8ICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8DQorICogICAgICB8ICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAg
ICAgICAgICAgIF9fX19fX3xfX19fX19fDQorICogICAgICB8ICAgICAgICAgICAgKy0tLS0tLSsg
IHwgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgfA0KKyAqICAgICAgfCBD
UlRDMSAtLS0+IHwgSERNSSB8ICAtLS0tPiBIRE1JIENvbm5lY3RvciAtLS0+IHwgSERNSSBNb25p
dG9yIHwNCisgKiAgICAgIHwgICAgICAgICAgICArLS0tLS0tKyAgfCAgICAgICAgICAgICAgICAg
ICAgICAgICB8X19fX19fX19fX19fX198DQorICogICAgICB8X19fX19fX19fX19fX19fX19fX19f
X3wNCisgKg0KKyAqDQorICogVGhlcmUgaXMgb25seSBhIDE6MSBtYXBwaW5nIG9mIGNydGNzLCBl
bmNvZGVycyBhbmQgY29ubmVjdG9ycyBmb3IgdGhlIERDLA0KKyAqIGRpc3BsYXkgcGlwZSAwID0g
Y3J0YzAgKyBkdm8wICsgZW5jb2RlcjAgKyBjb25uZWN0b3IwICsgY3Vyc29yMCArIHByaW1hcnkw
DQorICogZGlzcGxheSBwaXBlIDEgPSBjcnRjMSArIGR2bzEgKyBlbmNvZGVyMSArIGNvbm5lY3Ry
bzEgKyBjdXJzb3IxICsgcHJpbWFyeTENCisgKiBFYWNoIENSVEMgaGFzIHR3byBGQiBhZGRyZXNz
IHJlZ2lzdGVycy4NCisgKg0KKyAqIFRoZSBEQyBpbiBMUzdBMTAwMC9MUzJLMTAwMCBoYXMgdGhl
IHBjaSB2ZW5kb3IvZGV2aWNlIElEOiAweDAwMTQ6MHg3YTA2LA0KKyAqIFRoZSBEQyBpbiBMUzdB
MjAwMC9MUzJLMjAwMCBoYXMgdGhlIHBjaSB2ZW5kb3IvZGV2aWNlIElEOiAweDAwMTQ6MHg3YTM2
Lg0KKyAqDQorICogVGhlIEdQVSBpbiBMUzdBMTAwMCBoYXMgdGhlIHBjaSB2ZW5kb3IvZGV2aWNl
IElEOiAweDAwMTQ6MHg3YTE1LA0KKyAqIFRoZSBHUFUgaW4gTFM3QTIwMDAgaGFzIHRoZSBwY2kg
dmVuZG9yL2RldmljZSBJRDogMHgwMDE0OjB4N2EyNS4NCisgKg0KKyAqIExTN0ExMDAwL0xTN0Ey
MDAwIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCBkZXNrdG9wIG9yIHNlcnZlciBjbGFzcyBDUFVzLCBz
dWNoDQorICogYXMgTFMzQTQwMDAsIExTM0E1MDAwIGFuZCBMUzNBNjAwMC4gVGh1cywgQ1BVIFBS
SUQgY2FuIGJlIHVzZWQgdG8NCisgKiBkaXN0aW5ndWlzaCBMb29uZ3NvbiBTb0MgZnJvbSB0aG9z
ZSB0aGUgZGVza3RvcCBjbGFzcyBDUFUgb24gdGhlIHJ1bnRpbWUuDQorICovDQorZW51bSBsb29u
Z3Nvbl9jaGlwX2lkIHsNCisJQ0hJUF9MUzdBMTAwMCA9IDAsDQorCUNISVBfTFM3QTIwMDAgPSAx
LA0KKwlDSElQX0xTX0xBU1QsDQorfTsNCisNCitjb25zdCBzdHJ1Y3QgbHNkY19kZXNjICoNCits
c2RjX2RldmljZV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgZW51bSBsb29uZ3Nvbl9jaGlw
X2lkIGNoaXApOw0KKw0KK3N0cnVjdCBsc2RjX2ttc19mdW5jczsNCisNCisvKiBEQyBzcGVjaWZp
YyAqLw0KKw0KK3N0cnVjdCBsc2RjX2Rlc2Mgew0KKwl1MzIgbnVtX29mX2NydGM7DQorCXUzMiBt
YXhfcGl4ZWxfY2xrOw0KKwl1MzIgbWF4X3dpZHRoOw0KKwl1MzIgbWF4X2hlaWdodDsNCisJdTMy
IG51bV9vZl9od19jdXJzb3I7DQorCXUzMiBod19jdXJzb3JfdzsNCisJdTMyIGh3X2N1cnNvcl9o
Ow0KKwl1MzIgcGl0Y2hfYWxpZ247ICAgICAgICAgLyogQ1JUQyBETUEgYWxpZ25tZW50IGNvbnN0
cmFpbnQgKi8NCisJdTY0IG1jX2JpdHM7ICAgICAgICAgICAgIC8qIHBoeXNpY2FsIGFkZHJlc3Mg
YnVzIGJpdCB3aWR0aCAqLw0KKwlib29sIGhhc192YmxhbmtfY291bnRlcjsgLyogMzIgYml0IGh3
IHZzeW5jIGNvdW50ZXIgKi8NCisNCisJLyogZGV2aWNlIGRlcGVuZGVudCBvcHMsIGRjIHNpZGUg
Ki8NCisJY29uc3Qgc3RydWN0IGxzZGNfa21zX2Z1bmNzICpmdW5jczsNCit9Ow0KKw0KKy8qIEdG
WCByZWxhdGVkIHJlc291cmNlcyB3cmFuZ2xlciAqLw0KKw0KK3N0cnVjdCBsb29uZ3Nvbl9nZnhf
ZGVzYyB7DQorCXN0cnVjdCBsc2RjX2Rlc2MgZGM7DQorDQorCXUzMiBjb25mX3JlZ19iYXNlOw0K
Kw0KKwkvKiBHRlhQTEwgc2hhcmVkIGJ5IHRoZSBEQywgR01DIGFuZCBHUFUgKi8NCisJc3RydWN0
IHsNCisJCXUzMiByZWdfb2Zmc2V0Ow0KKwkJdTMyIHJlZ19zaXplOw0KKwl9IGdmeHBsbDsNCisN
CisJLyogUGl4ZWwgUExMLCBwZXIgZGlzcGxheSBwaXBlICovDQorCXN0cnVjdCB7DQorCQl1MzIg
cmVnX29mZnNldDsNCisJCXUzMiByZWdfc2l6ZTsNCisJfSBwaXhwbGxbTFNEQ19OVU1fQ1JUQ107
DQorDQorCWVudW0gbG9vbmdzb25fY2hpcF9pZCBjaGlwX2lkOw0KKwljaGFyIG1vZGVsWzY0XTsN
Cit9Ow0KKw0KK3N0YXRpYyBpbmxpbmUgY29uc3Qgc3RydWN0IGxvb25nc29uX2dmeF9kZXNjICoN
Cit0b19sb29uZ3Nvbl9nZngoY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqZGNwKQ0KK3sNCisJcmV0
dXJuIGNvbnRhaW5lcl9vZl9jb25zdChkY3AsIHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVzYywgZGMp
Ow0KK307DQorDQorc3RydWN0IGxzZGNfcmVnMzIgew0KKwljaGFyICpuYW1lOw0KKwl1MzIgb2Zm
c2V0Ow0KK307DQorDQorLyogY3J0YyBoYXJkd2FyZSByZWxhdGVkIG9wcyAqLw0KKw0KK3N0cnVj
dCBsc2RjX2NydGM7DQorDQorc3RydWN0IGxzZGNfY3J0Y19od19vcHMgew0KKwl2b2lkICgqZW5h
YmxlKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCpkaXNhYmxlKShzdHJ1Y3Qg
bHNkY19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCplbmFibGVfdmJsYW5rKShzdHJ1Y3QgbHNkY19j
cnRjICpsY3J0Yyk7DQorCXZvaWQgKCpkaXNhYmxlX3ZibGFuaykoc3RydWN0IGxzZGNfY3J0YyAq
bGNydGMpOw0KKwl2b2lkICgqZmxpcCkoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpOw0KKwl2b2lk
ICgqY2xvbmUpKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisJdm9pZCAoKmdldF9zY2FuX3Bv
cykoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMsIGludCAqaHBvcywgaW50ICp2cG9zKTsNCisJdm9p
ZCAoKnNldF9tb2RlKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywgY29uc3Qgc3RydWN0IGRybV9k
aXNwbGF5X21vZGUgKm1vZGUpOw0KKwl2b2lkICgqc29mdF9yZXNldCkoc3RydWN0IGxzZGNfY3J0
YyAqbGNydGMpOw0KKwl2b2lkICgqcmVzZXQpKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisN
CisJdTMyICAoKmdldF92YmxhbmtfY291bnRlcikoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpOw0K
Kwl2b2lkICgqc2V0X2RtYV9zdGVwKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywgZW51bSBsc2Rj
X2RtYV9zdGVwcyBzdGVwKTsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX2NydGMgew0KKwlzdHJ1Y3Qg
ZHJtX2NydGMgYmFzZTsNCisJc3RydWN0IGxzZGNfcGl4cGxsIHBpeHBsbDsNCisJc3RydWN0IGxz
ZGNfZGV2aWNlICpsZGV2Ow0KKwljb25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyAqaHdfb3Bz
Ow0KKwljb25zdCBzdHJ1Y3QgbHNkY19yZWczMiAqcHJlZzsNCisJdW5zaWduZWQgaW50IG5yZWc7
DQorCXN0cnVjdCBkcm1faW5mb19saXN0ICpwX2luZm9fbGlzdDsNCisJdW5zaWduZWQgaW50IG5f
aW5mb19saXN0Ow0KK307DQorDQorLyogcHJpbWFyeSBwbGFuZSBoYXJkd2FyZSByZWxhdGVkIG9w
cyAqLw0KKw0KK3N0cnVjdCBsc2RjX3ByaW1hcnk7DQorDQorc3RydWN0IGxzZGNfcHJpbWFyeV9w
bGFuZV9vcHMgew0KKwl2b2lkICgqdXBkYXRlX2ZiX2FkZHIpKHN0cnVjdCBsc2RjX3ByaW1hcnkg
KnBsYW5lLCB1NjQgYWRkcik7DQorCXZvaWQgKCp1cGRhdGVfZmJfc3RyaWRlKShzdHJ1Y3QgbHNk
Y19wcmltYXJ5ICpwbGFuZSwgdTMyIHN0cmlkZSk7DQorCXZvaWQgKCp1cGRhdGVfZmJfZm9ybWF0
KShzdHJ1Y3QgbHNkY19wcmltYXJ5ICpwbGFuZSwNCisJCQkJIGNvbnN0IHN0cnVjdCBkcm1fZm9y
bWF0X2luZm8gKmZvcm1hdCk7DQorfTsNCisNCitzdHJ1Y3QgbHNkY19wcmltYXJ5IHsNCisJc3Ry
dWN0IGRybV9wbGFuZSBiYXNlOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19wcmltYXJ5X3BsYW5lX29w
cyAqb3BzOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXY7DQorfTsNCisNCisvKiBjdXJzb3Ig
cGxhbmUgaGFyZHdhcmUgcmVsYXRlZCBvcHMgKi8NCisNCitzdHJ1Y3QgbHNkY19jdXJzb3I7DQor
DQorc3RydWN0IGxzZGNfY3Vyc29yX3BsYW5lX29wcyB7DQorCXZvaWQgKCp1cGRhdGVfYm9fYWRk
cikoc3RydWN0IGxzZGNfY3Vyc29yICpwbGFuZSwgdTY0IGFkZHIpOw0KKwl2b2lkICgqdXBkYXRl
X2NmZykoc3RydWN0IGxzZGNfY3Vyc29yICpwbGFuZSwNCisJCQkgICBlbnVtIGxzZGNfY3Vyc29y
X3NpemUgY3Vyc29yX3NpemUsDQorCQkJICAgZW51bSBsc2RjX2N1cnNvcl9mb3JtYXQpOw0KKwl2
b2lkICgqdXBkYXRlX3Bvc2l0aW9uKShzdHJ1Y3QgbHNkY19jdXJzb3IgKnBsYW5lLCBpbnQgeCwg
aW50IHkpOw0KK307DQorDQorc3RydWN0IGxzZGNfY3Vyc29yIHsNCisJc3RydWN0IGRybV9wbGFu
ZSBiYXNlOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19jdXJzb3JfcGxhbmVfb3BzICpvcHM7DQorCXN0
cnVjdCBsc2RjX2RldmljZSAqbGRldjsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX291dHB1dCB7DQor
CXN0cnVjdCBkcm1fZW5jb2RlciBlbmNvZGVyOw0KKwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciBjb25u
ZWN0b3I7DQorfTsNCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX291dHB1dCAqDQorY29u
bmVjdG9yX3RvX2xzZGNfb3V0cHV0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IpDQor
ew0KKwlyZXR1cm4gY29udGFpbmVyX29mKGNvbm5lY3Rvciwgc3RydWN0IGxzZGNfb3V0cHV0LCBj
b25uZWN0b3IpOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX291dHB1dCAqDQor
ZW5jb2Rlcl90b19sc2RjX291dHB1dChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpDQorew0K
KwlyZXR1cm4gY29udGFpbmVyX29mKGVuY29kZXIsIHN0cnVjdCBsc2RjX291dHB1dCwgZW5jb2Rl
cik7DQorfQ0KKw0KK3N0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZSB7DQorCXN0cnVjdCBsc2RjX2Ny
dGMgY3J0YzsNCisJc3RydWN0IGxzZGNfcHJpbWFyeSBwcmltYXJ5Ow0KKwlzdHJ1Y3QgbHNkY19j
dXJzb3IgY3Vyc29yOw0KKwlzdHJ1Y3QgbHNkY19vdXRwdXQgb3V0cHV0Ow0KKwlzdHJ1Y3QgbHNk
Y19pMmMgKmxpMmM7DQorCXVuc2lnbmVkIGludCBpbmRleDsNCit9Ow0KKw0KK3N0YXRpYyBpbmxp
bmUgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICoNCitvdXRwdXRfdG9fZGlzcGxheV9waXBlKHN0
cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0KQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9vZihvdXRw
dXQsIHN0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZSwgb3V0cHV0KTsNCit9DQorDQorc3RydWN0IGxz
ZGNfa21zX2Z1bmNzIHsNCisJaXJxcmV0dXJuX3QgKCppcnFfaGFuZGxlcikoaW50IGlycSwgdm9p
ZCAqYXJnKTsNCisNCisJaW50ICgqY3JlYXRlX2kyYykoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYs
DQorCQkJICBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJICB1bnNpZ25l
ZCBpbnQgaW5kZXgpOw0KKw0KKwlpbnQgKCpvdXRwdXRfaW5pdCkoc3RydWN0IGRybV9kZXZpY2Ug
KmRkZXYsDQorCQkJICAgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBlLA0KKwkJCSAg
IHN0cnVjdCBpMmNfYWRhcHRlciAqZGRjLA0KKwkJCSAgIHVuc2lnbmVkIGludCBpbmRleCk7DQor
DQorCWludCAoKmN1cnNvcl9wbGFuZV9pbml0KShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJ
CQkJIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0KKwkJCQkgdW5zaWduZWQgaW50IGluZGV4KTsN
CisNCisJaW50ICgqcHJpbWFyeV9wbGFuZV9pbml0KShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwN
CisJCQkJICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJICB1bnNpZ25lZCBpbnQgaW5k
ZXgpOw0KKw0KKwlpbnQgKCpjcnRjX2luaXQpKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJ
CSBzdHJ1Y3QgZHJtX2NydGMgKmNydGMsDQorCQkJIHN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnks
DQorCQkJIHN0cnVjdCBkcm1fcGxhbmUgKmN1cnNvciwNCisJCQkgdW5zaWduZWQgaW50IGluZGV4
KTsNCit9Ow0KKw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGxzZGNfY3J0YyAqDQordG9fbHNkY19j
cnRjKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoY3J0
Yywgc3RydWN0IGxzZGNfY3J0YywgYmFzZSk7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0
IGxzZGNfZGlzcGxheV9waXBlICoNCitjcnRjX3RvX2Rpc3BsYXlfcGlwZShzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMpDQorew0KKwlyZXR1cm4gY29udGFpbmVyX29mKGNydGMsIHN0cnVjdCBsc2RjX2Rp
c3BsYXlfcGlwZSwgY3J0Yy5iYXNlKTsNCit9DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNk
Y19wcmltYXJ5ICoNCit0b19sc2RjX3ByaW1hcnkoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUpDQor
ew0KKwlyZXR1cm4gY29udGFpbmVyX29mKHBsYW5lLCBzdHJ1Y3QgbHNkY19wcmltYXJ5LCBiYXNl
KTsNCit9DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19jdXJzb3IgKg0KK3RvX2xzZGNf
Y3Vyc29yKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lKQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9v
ZihwbGFuZSwgc3RydWN0IGxzZGNfY3Vyc29yLCBiYXNlKTsNCit9DQorDQorc3RydWN0IGxzZGNf
Y3J0Y19zdGF0ZSB7DQorCXN0cnVjdCBkcm1fY3J0Y19zdGF0ZSBiYXNlOw0KKwlzdHJ1Y3QgbHNk
Y19waXhwbGxfcGFybXMgcHBhcm1zOw0KK307DQorDQorc3RydWN0IGxzZGNfZ2VtIHsNCisJLyog
QG11dGV4OiBwcm90ZWN0IG9iamVjdHMgbGlzdCAqLw0KKwlzdHJ1Y3QgbXV0ZXggbXV0ZXg7DQor
CXN0cnVjdCBsaXN0X2hlYWQgb2JqZWN0czsNCit9Ow0KKw0KK3N0cnVjdCBsc2RjX2RldmljZSB7
DQorCXN0cnVjdCBkcm1fZGV2aWNlIGJhc2U7DQorCXN0cnVjdCB0dG1fZGV2aWNlIGJkZXY7DQor
DQorCS8qIEBkZXNjcDogZmVhdHVyZXMgZGVzY3JpcHRpb24gb2YgdGhlIERDIHZhcmlhbnQgKi8N
CisJY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqZGVzY3A7DQorCXN0cnVjdCBwY2lfZGV2ICpkYzsN
CisJc3RydWN0IHBjaV9kZXYgKmdwdTsNCisNCisJc3RydWN0IGxvb25nc29uX2dmeHBsbCAqZ2Z4
cGxsOw0KKw0KKwkvKiBAcmVnbG9jazogcHJvdGVjdHMgY29uY3VycmVudCBhY2Nlc3MgKi8NCisJ
c3BpbmxvY2tfdCByZWdsb2NrOw0KKw0KKwl2b2lkIF9faW9tZW0gKnJlZ19iYXNlOw0KKwlyZXNv
dXJjZV9zaXplX3QgdnJhbV9iYXNlOw0KKwlyZXNvdXJjZV9zaXplX3QgdnJhbV9zaXplOw0KKw0K
KwlyZXNvdXJjZV9zaXplX3QgZ3R0X2Jhc2U7DQorCXJlc291cmNlX3NpemVfdCBndHRfc2l6ZTsN
CisNCisJc3RydWN0IGxzZGNfZGlzcGxheV9waXBlIGRpc3BpcGVbTFNEQ19OVU1fQ1JUQ107DQor
DQorCXN0cnVjdCBsc2RjX2dlbSBnZW07DQorDQorCXUzMiBpcnFfc3RhdHVzOw0KKw0KKwkvKiB0
cmFja2luZyBwaW5uZWQgbWVtb3J5ICovDQorCXNpemVfdCB2cmFtX3Bpbm5lZF9zaXplOw0KKwlz
aXplX3QgZ3R0X3Bpbm5lZF9zaXplOw0KKw0KKwkvKiBAbnVtX291dHB1dDogY291bnQgdGhlIG51
bWJlciBvZiBhY3RpdmUgZGlzcGxheSBwaXBlICovDQorCXVuc2lnbmVkIGludCBudW1fb3V0cHV0
Ow0KK307DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19kZXZpY2UgKnRkZXZfdG9fbGRl
dihzdHJ1Y3QgdHRtX2RldmljZSAqYmRldikNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoYmRl
diwgc3RydWN0IGxzZGNfZGV2aWNlLCBiZGV2KTsNCit9DQorDQorc3RhdGljIGlubGluZSBzdHJ1
Y3QgbHNkY19kZXZpY2UgKnRvX2xzZGMoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYpDQorew0KKwly
ZXR1cm4gY29udGFpbmVyX29mKGRkZXYsIHN0cnVjdCBsc2RjX2RldmljZSwgYmFzZSk7DQorfQ0K
Kw0KK3N0YXRpYyBpbmxpbmUgc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSAqDQordG9fbHNkY19jcnRj
X3N0YXRlKHN0cnVjdCBkcm1fY3J0Y19zdGF0ZSAqYmFzZSkNCit7DQorCXJldHVybiBjb250YWlu
ZXJfb2YoYmFzZSwgc3RydWN0IGxzZGNfY3J0Y19zdGF0ZSwgYmFzZSk7DQorfQ0KKw0KK3ZvaWQg
bHNkY19kZWJ1Z2ZzX2luaXQoc3RydWN0IGRybV9taW5vciAqbWlub3IpOw0KKw0KK2ludCBsczdh
MTAwMF9jcnRjX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkgICAgICAgc3RydWN0
IGRybV9jcnRjICpjcnRjLA0KKwkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKnByaW1hcnksDQor
CQkgICAgICAgc3RydWN0IGRybV9wbGFuZSAqY3Vyc29yLA0KKwkJICAgICAgIHVuc2lnbmVkIGlu
dCBpbmRleCk7DQorDQoraW50IGxzN2EyMDAwX2NydGNfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGRldiwNCisJCSAgICAgICBzdHJ1Y3QgZHJtX2NydGMgKmNydGMsDQorCQkgICAgICAgc3RydWN0
IGRybV9wbGFuZSAqcHJpbWFyeSwNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpjdXJzb3Is
DQorCQkgICAgICAgdW5zaWduZWQgaW50IGluZGV4KTsNCisNCitpbnQgbHNkY19wcmltYXJ5X3Bs
YW5lX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICAgIHN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lLA0KKwkJCSAgICB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0KK2ludCBsczdhMTAw
MF9jdXJzb3JfcGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgICAg
c3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJICAgICAgIHVuc2lnbmVkIGludCBpbmRleCk7
DQorDQoraW50IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpk
ZGV2LA0KKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkgICAgICAgdW5z
aWduZWQgaW50IGluZGV4KTsNCisNCisvKiByZWdpc3RlcnMgYWNjZXNzIGhlbHBlcnMgKi8NCisN
CitzdGF0aWMgaW5saW5lIHUzMiBsc2RjX3JyZWczMihzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYs
IHUzMiBvZmZzZXQpDQorew0KKwlyZXR1cm4gcmVhZGwobGRldi0+cmVnX2Jhc2UgKyBvZmZzZXQp
Ow0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgbHNkY193cmVnMzIoc3RydWN0IGxzZGNfZGV2
aWNlICpsZGV2LCB1MzIgb2Zmc2V0LCB1MzIgdmFsKQ0KK3sNCisJd3JpdGVsKHZhbCwgbGRldi0+
cmVnX2Jhc2UgKyBvZmZzZXQpOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHZvaWQgbHNkY191cmVn
MzJfc2V0KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwNCisJCQkJICAgdTMyIG9mZnNldCwNCisJ
CQkJICAgdTMyIG1hc2spDQorew0KKwl2b2lkIF9faW9tZW0gKmFkZHIgPSBsZGV2LT5yZWdfYmFz
ZSArIG9mZnNldDsNCisJdTMyIHZhbCA9IHJlYWRsKGFkZHIpOw0KKw0KKwl3cml0ZWwodmFsIHwg
bWFzaywgYWRkcik7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBsc2RjX3VyZWczMl9jbHIo
c3RydWN0IGxzZGNfZGV2aWNlICpsZGV2LA0KKwkJCQkgICB1MzIgb2Zmc2V0LA0KKwkJCQkgICB1
MzIgbWFzaykNCit7DQorCXZvaWQgX19pb21lbSAqYWRkciA9IGxkZXYtPnJlZ19iYXNlICsgb2Zm
c2V0Ow0KKwl1MzIgdmFsID0gcmVhZGwoYWRkcik7DQorDQorCXdyaXRlbCh2YWwgJiB+bWFzaywg
YWRkcik7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgdTMyIGxzZGNfcGlwZV9ycmVnMzIoc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2LA0KKwkJCQkgICB1MzIgb2Zmc2V0LA0KKwkJCQkgICB1MzIgcGlw
ZSkNCit7DQorCXJldHVybiByZWFkbChsZGV2LT5yZWdfYmFzZSArIG9mZnNldCArIHBpcGUgKiBD
UlRDX1BJUEVfT0ZGU0VUKTsNCit9DQorDQorc3RhdGljIGlubGluZSB2b2lkIGxzZGNfcGlwZV93
cmVnMzIoc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2LA0KKwkJCQkgICAgdTMyIG9mZnNldCwNCisJ
CQkJICAgIHUzMiBwaXBlLA0KKwkJCQkgICAgdTMyIHZhbCkNCit7DQorCXdyaXRlbCh2YWwsIGxk
ZXYtPnJlZ19iYXNlICsgb2Zmc2V0ICsgcGlwZSAqIENSVENfUElQRV9PRkZTRVQpOw0KK30NCisN
CisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19nZW0u
YyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5jDQpuZXcgZmlsZSBtb2RlIDEw
MDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi5mMjE5NDJiMmEzYjgNCi0tLSAvZGV2L251bGwNCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5jDQpAQCAtMCwwICsxLDMyNCBA
QA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8qDQorICogQ29weXJp
Z2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAq
Lw0KKw0KKyNpbmNsdWRlIDxsaW51eC9kbWEtYnVmLmg+DQorDQorI2luY2x1ZGUgPGRybS9kcm1f
ZGVidWdmcy5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2ZpbGUuaD4NCisjaW5jbHVkZSA8ZHJtL2Ry
bV9nZW0uaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9wcmltZS5oPg0KKw0KKyNpbmNsdWRlICJsc2Rj
X2Rydi5oIg0KKyNpbmNsdWRlICJsc2RjX2dlbS5oIg0KKyNpbmNsdWRlICJsc2RjX3R0bS5oIg0K
Kw0KK3N0YXRpYyBpbnQgbHNkY19nZW1fcHJpbWVfcGluKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAq
b2JqKQ0KK3sNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9IGdlbV90b19sc2RjX2JvKG9iaik7DQor
CWludCByZXQ7DQorDQorCXJldCA9IGxzZGNfYm9fcmVzZXJ2ZShsYm8pOw0KKwlpZiAodW5saWtl
bHkocmV0KSkNCisJCXJldHVybiByZXQ7DQorDQorCXJldCA9IGxzZGNfYm9fcGluKGxibywgTFNE
Q19HRU1fRE9NQUlOX0dUVCwgTlVMTCk7DQorCWlmIChsaWtlbHkocmV0ID09IDApKQ0KKwkJbGJv
LT5zaGFyaW5nX2NvdW50Kys7DQorDQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorDQorCXJl
dHVybiByZXQ7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfZ2VtX3ByaW1lX3VucGluKHN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqb2JqKQ0KK3sNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9IGdlbV90
b19sc2RjX2JvKG9iaik7DQorCWludCByZXQ7DQorDQorCXJldCA9IGxzZGNfYm9fcmVzZXJ2ZShs
Ym8pOw0KKwlpZiAodW5saWtlbHkocmV0KSkNCisJCXJldHVybjsNCisNCisJbHNkY19ib191bnBp
bihsYm8pOw0KKwlpZiAobGJvLT5zaGFyaW5nX2NvdW50KQ0KKwkJbGJvLT5zaGFyaW5nX2NvdW50
LS07DQorDQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3Qg
c2dfdGFibGUgKmxzZGNfZ2VtX3ByaW1lX2dldF9zZ190YWJsZShzdHJ1Y3QgZHJtX2dlbV9vYmpl
Y3QgKm9iaikNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gdG9fdHRtX2Jv
KG9iaik7DQorCXN0cnVjdCB0dG1fdHQgKnR0ID0gdGJvLT50dG07DQorDQorCWlmICghdHQpIHsN
CisJCWRybV9lcnIob2JqLT5kZXYsICJzaGFyaW5nIGEgYnVmZmVyIHdpdGhvdXQgYmFja2luZyBt
ZW1vcnlcbiIpOw0KKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7DQorCX0NCisNCisJcmV0dXJu
IGRybV9wcmltZV9wYWdlc190b19zZyhvYmotPmRldiwgdHQtPnBhZ2VzLCB0dC0+bnVtX3BhZ2Vz
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19nZW1fb2JqZWN0X2ZyZWUoc3RydWN0IGRybV9n
ZW1fb2JqZWN0ICpvYmopDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9IHRv
X3R0bV9ibyhvYmopOw0KKw0KKwlpZiAodGJvKQ0KKwkJdHRtX2JvX3B1dCh0Ym8pOw0KK30NCisN
CitzdGF0aWMgaW50IGxzZGNfZ2VtX29iamVjdF92bWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAq
b2JqLA0KKwkJCQlzdHJ1Y3QgaW9zeXNfbWFwICptYXApDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKnRibyA9IHRvX3R0bV9ibyhvYmopOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvID0g
dG9fbHNkY19ibyh0Ym8pOw0KKwlpbnQgcmV0Ow0KKw0KKwlpZiAobGJvLT52bWFwX2NvdW50ID4g
MCkgew0KKwkJKytsYm8tPnZtYXBfY291bnQ7DQorCQlnb3RvIG91dDsNCisJfQ0KKw0KKwlyZXQg
PSBsc2RjX2JvX3BpbihsYm8sIDAsIE5VTEwpOw0KKwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJ
ZHJtX2VycihvYmotPmRldiwgInBpbiAlcCBmb3Igdm1hcCBmYWlsZWRcbiIsIGxibyk7DQorCQly
ZXR1cm4gcmV0Ow0KKwl9DQorDQorCXJldCA9IHR0bV9ib192bWFwKHRibywgJmxiby0+bWFwKTsN
CisJaWYgKHJldCkgew0KKwkJZHJtX2VycihvYmotPmRldiwgInR0bSBibyB2bWFwIGZhaWxlZFxu
Iik7DQorCQlsc2RjX2JvX3VucGluKGxibyk7DQorCQlyZXR1cm4gcmV0Ow0KKwl9DQorDQorCWxi
by0+dm1hcF9jb3VudCA9IDE7DQorDQorb3V0Og0KKwkqbWFwID0gbGJvLT5tYXA7DQorDQorCXJl
dHVybiAwOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2dlbV9vYmplY3RfdnVubWFwKHN0cnVj
dCBkcm1fZ2VtX29iamVjdCAqb2JqLA0KKwkJCQkgICBzdHJ1Y3QgaW9zeXNfbWFwICptYXApDQor
ew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9IHRvX3R0bV9ibyhvYmopOw0KKwlz
dHJ1Y3QgbHNkY19ibyAqbGJvID0gdG9fbHNkY19ibyh0Ym8pOw0KKw0KKwlpZiAodW5saWtlbHko
IWxiby0+dm1hcF9jb3VudCkpIHsNCisJCWRybV93YXJuKG9iai0+ZGV2LCAiJXAgaXMgbm90IG1h
cHBlZFxuIiwgbGJvKTsNCisJCXJldHVybjsNCisJfQ0KKw0KKwktLWxiby0+dm1hcF9jb3VudDsN
CisJaWYgKGxiby0+dm1hcF9jb3VudCA9PSAwKSB7DQorCQl0dG1fYm9fdnVubWFwKHRibywgJmxi
by0+bWFwKTsNCisNCisJCWxzZGNfYm9fdW5waW4obGJvKTsNCisJfQ0KK30NCisNCitzdGF0aWMg
aW50IGxzZGNfZ2VtX29iamVjdF9tbWFwKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLA0KKwkJ
CQlzdHJ1Y3Qgdm1fYXJlYV9zdHJ1Y3QgKnZtYSkNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqdGJvID0gdG9fdHRtX2JvKG9iaik7DQorCWludCByZXQ7DQorDQorCXJldCA9IHR0bV9i
b19tbWFwX29iaih2bWEsIHRibyk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fd2Fy
bihvYmotPmRldiwgIm1tYXAgJXAgZmFpbGVkXG4iLCB0Ym8pOw0KKwkJcmV0dXJuIHJldDsNCisJ
fQ0KKw0KKwlkcm1fZ2VtX29iamVjdF9wdXQob2JqKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0K
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2dlbV9vYmplY3RfZnVuY3MgbHNkY19nZW1fb2JqZWN0
X2Z1bmNzID0gew0KKwkuZnJlZSA9IGxzZGNfZ2VtX29iamVjdF9mcmVlLA0KKwkuZXhwb3J0ID0g
ZHJtX2dlbV9wcmltZV9leHBvcnQsDQorCS5waW4gPSBsc2RjX2dlbV9wcmltZV9waW4sDQorCS51
bnBpbiA9IGxzZGNfZ2VtX3ByaW1lX3VucGluLA0KKwkuZ2V0X3NnX3RhYmxlID0gbHNkY19nZW1f
cHJpbWVfZ2V0X3NnX3RhYmxlLA0KKwkudm1hcCA9IGxzZGNfZ2VtX29iamVjdF92bWFwLA0KKwku
dnVubWFwID0gbHNkY19nZW1fb2JqZWN0X3Z1bm1hcCwNCisJLm1tYXAgPSBsc2RjX2dlbV9vYmpl
Y3RfbW1hcCwNCit9Ow0KKw0KK3N0cnVjdCBkcm1fZ2VtX29iamVjdCAqDQorbHNkY19nZW1fb2Jq
ZWN0X2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCSAgICAgICB1MzIgZG9tYWlu
LA0KKwkJICAgICAgIHNpemVfdCBzaXplLA0KKwkJICAgICAgIGJvb2wga2VyZW5sLA0KKwkJICAg
ICAgIHN0cnVjdCBzZ190YWJsZSAqc2csDQorCQkgICAgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2
KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJc3Ry
dWN0IGRybV9nZW1fb2JqZWN0ICpnb2JqOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvOw0KKwlpbnQg
cmV0Ow0KKw0KKwlsYm8gPSBsc2RjX2JvX2NyZWF0ZShkZGV2LCBkb21haW4sIHNpemUsIGtlcmVu
bCwgc2csIHJlc3YpOw0KKwlpZiAoSVNfRVJSKGxibykpIHsNCisJCXJldCA9IFBUUl9FUlIobGJv
KTsNCisJCXJldHVybiBFUlJfUFRSKHJldCk7DQorCX0NCisNCisJLyogVlJBTSBpcyBmaWxsZWQg
d2l0aCByYW5kb20gZGF0YSAqLw0KKwlsc2RjX2JvX2NsZWFyKGxibyk7DQorDQorCWdvYmogPSAm
bGJvLT50Ym8uYmFzZTsNCisJZ29iai0+ZnVuY3MgPSAmbHNkY19nZW1fb2JqZWN0X2Z1bmNzOw0K
Kw0KKwkvKiB0cmFja2luZyB0aGUgQk9zIHdlIGNyZWF0ZWQgKi8NCisJbXV0ZXhfbG9jaygmbGRl
di0+Z2VtLm11dGV4KTsNCisJbGlzdF9hZGRfdGFpbCgmbGJvLT5saXN0LCAmbGRldi0+Z2VtLm9i
amVjdHMpOw0KKwltdXRleF91bmxvY2soJmxkZXYtPmdlbS5tdXRleCk7DQorDQorCXJldHVybiBn
b2JqOw0KK30NCisNCitzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKg0KK2xzZGNfcHJpbWVfaW1wb3J0
X3NnX3RhYmxlKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSAgIHN0cnVjdCBkbWFfYnVm
X2F0dGFjaG1lbnQgKmF0dGFjaCwNCisJCQkgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnKQ0KK3sNCisJ
c3RydWN0IGRtYV9yZXN2ICpyZXN2ID0gYXR0YWNoLT5kbWFidWYtPnJlc3Y7DQorCXU2NCBzaXpl
ID0gYXR0YWNoLT5kbWFidWYtPnNpemU7DQorCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ29iajsN
CisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisNCisJZG1hX3Jlc3ZfbG9jayhyZXN2LCBOVUxMKTsN
CisJZ29iaiA9IGxzZGNfZ2VtX29iamVjdF9jcmVhdGUoZGRldiwgTFNEQ19HRU1fRE9NQUlOX0dU
VCwgc2l6ZSwgZmFsc2UsDQorCQkJCSAgICAgIHNnLCByZXN2KTsNCisJZG1hX3Jlc3ZfdW5sb2Nr
KHJlc3YpOw0KKw0KKwlpZiAoSVNfRVJSKGdvYmopKSB7DQorCQlkcm1fZXJyKGRkZXYsICJGYWls
ZWQgdG8gaW1wb3J0IHNnIHRhYmxlXG4iKTsNCisJCXJldHVybiBnb2JqOw0KKwl9DQorDQorCWxi
byA9IGdlbV90b19sc2RjX2JvKGdvYmopOw0KKwlsYm8tPnNoYXJpbmdfY291bnQgPSAxOw0KKw0K
KwlyZXR1cm4gZ29iajsNCit9DQorDQoraW50IGxzZGNfZHVtYl9jcmVhdGUoc3RydWN0IGRybV9m
aWxlICpmaWxlLA0KKwkJICAgICBzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCSAgICAgc3Ry
dWN0IGRybV9tb2RlX2NyZWF0ZV9kdW1iICphcmdzKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAqZGVzY3Ag
PSBsZGV2LT5kZXNjcDsNCisJdTMyIGRvbWFpbiA9IExTRENfR0VNX0RPTUFJTl9WUkFNOw0KKwlz
dHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmo7DQorCXNpemVfdCBzaXplOw0KKwl1MzIgcGl0Y2g7
DQorCXUzMiBoYW5kbGU7DQorCWludCByZXQ7DQorDQorCWlmICghYXJncy0+d2lkdGggfHwgIWFy
Z3MtPmhlaWdodCkNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwkvKiBMb29uZ3NvbiBkaWFwbGF5
IGNvbnRyb2xsZXIgb25seSBzdXBwb3J0IDMyLWJpdCBhbmQgMTYtYml0IEZCICovDQorCWlmIChh
cmdzLT5icHAgIT0gMzIgJiYgYXJncy0+YnBwICE9IDE2KQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQor
DQorCXBpdGNoID0gYXJncy0+d2lkdGggKiBhcmdzLT5icHAgLyA4Ow0KKwlwaXRjaCA9IEFMSUdO
KHBpdGNoLCBkZXNjcC0+cGl0Y2hfYWxpZ24pOw0KKwlzaXplID0gcGl0Y2ggKiBhcmdzLT5oZWln
aHQ7DQorCXNpemUgPSBBTElHTihzaXplLCBQQUdFX1NJWkUpOw0KKw0KKwkvKiBNYXhpbXVtIGJv
IHNpemUgYWxsb3dlZCBpcyB0aGUgaGFsZiB2cmFtIHNpemUgYXZhaWxhYmxlICovDQorCWlmIChz
aXplID4gbGRldi0+dnJhbV9zaXplIC8gMikgew0KKwkJZHJtX2VycihkZGV2LCAiUmVxdWVzdGlu
ZyglenVNQikgbW9yZSB0aGFuIG93bmVkKCV1TUIpXG4iLA0KKwkJCXNpemUgPj4gMjAsICh1MzIp
KGxkZXYtPnZyYW1fc2l6ZSA+PiAyMCkpOw0KKwkJcmV0dXJuIC1FTk9NRU07DQorCX0NCisNCisJ
Z29iaiA9IGxzZGNfZ2VtX29iamVjdF9jcmVhdGUoZGRldiwNCisJCQkJICAgICAgZG9tYWluLA0K
KwkJCQkgICAgICBzaXplLA0KKwkJCQkgICAgICBmYWxzZSwNCisJCQkJICAgICAgTlVMTCwNCisJ
CQkJICAgICAgTlVMTCk7DQorCWlmIChJU19FUlIoZ29iaikpIHsNCisJCWRybV9lcnIoZGRldiwg
IkZhaWxlZCB0byBjcmVhdGUgZ2VtIG9iamVjdFxuIik7DQorCQlyZXR1cm4gUFRSX0VSUihnb2Jq
KTsNCisJfQ0KKw0KKwlyZXQgPSBkcm1fZ2VtX2hhbmRsZV9jcmVhdGUoZmlsZSwgZ29iaiwgJmhh
bmRsZSk7DQorDQorCS8qIGRyb3AgcmVmZXJlbmNlIGZyb20gYWxsb2NhdGUsIGhhbmRsZSBob2xk
cyBpdCBub3cgKi8NCisJZHJtX2dlbV9vYmplY3RfcHV0KGdvYmopOw0KKwlpZiAocmV0KQ0KKwkJ
cmV0dXJuIHJldDsNCisNCisJYXJncy0+cGl0Y2ggPSBwaXRjaDsNCisJYXJncy0+c2l6ZSA9IHNp
emU7DQorCWFyZ3MtPmhhbmRsZSA9IGhhbmRsZTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK2lu
dCBsc2RjX2R1bWJfbWFwX29mZnNldChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbHAsDQorCQkJIHN0cnVj
dCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSB1MzIgaGFuZGxlLA0KKwkJCSB1aW50NjRfdCAqb2Zm
c2V0KQ0KK3sNCisJc3RydWN0IGRybV9nZW1fb2JqZWN0ICpnb2JqOw0KKw0KKwlnb2JqID0gZHJt
X2dlbV9vYmplY3RfbG9va3VwKGZpbHAsIGhhbmRsZSk7DQorCWlmICghZ29iaikNCisJCXJldHVy
biAtRU5PRU5UOw0KKw0KKwkqb2Zmc2V0ID0gZHJtX3ZtYV9ub2RlX29mZnNldF9hZGRyKCZnb2Jq
LT52bWFfbm9kZSk7DQorDQorCWRybV9nZW1fb2JqZWN0X3B1dChnb2JqKTsNCisNCisJcmV0dXJu
IDA7DQorfQ0KKw0KK3ZvaWQgbHNkY19nZW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldikN
Cit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorDQorCW11
dGV4X2luaXQoJmxkZXYtPmdlbS5tdXRleCk7DQorCUlOSVRfTElTVF9IRUFEKCZsZGV2LT5nZW0u
b2JqZWN0cyk7DQorfQ0KKw0KK2ludCBsc2RjX3Nob3dfYnVmZmVyX29iamVjdChzdHJ1Y3Qgc2Vx
X2ZpbGUgKm0sIHZvaWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0g
KHN0cnVjdCBkcm1faW5mb19ub2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGRybV9kZXZpY2Ug
KmRkZXYgPSBub2RlLT5taW5vci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0
b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvOw0KKwl1bnNpZ25lZCBpbnQgaTsN
CisNCisJbXV0ZXhfbG9jaygmbGRldi0+Z2VtLm11dGV4KTsNCisNCisJaSA9IDA7DQorDQorCWxp
c3RfZm9yX2VhY2hfZW50cnkobGJvLCAmbGRldi0+Z2VtLm9iamVjdHMsIGxpc3QpIHsNCisJCXN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwkJc3RydWN0IHR0bV9y
ZXNvdXJjZSAqcmVzb3VyY2UgPSB0Ym8tPnJlc291cmNlOw0KKw0KKwkJc2VxX3ByaW50ZihtLCAi
Ym9bJTA0dV1bJXBdOiBzaXplOiAlOHp1IEtCICVzIG9mZnNldDogJThsbHhcbiIsDQorCQkJICAg
aSwgbGJvLA0KKwkJCSAgIGxzZGNfYm9fc2l6ZShsYm8pID4+IDEwLA0KKwkJCSAgIGxzZGNfbWVt
X3R5cGVfdG9fc3RyKHJlc291cmNlLT5tZW1fdHlwZSksDQorCQkJICAgbHNkY19ib19ncHVfb2Zm
c2V0KGxibykpOw0KKwkJaSsrOw0KKwl9DQorDQorCW11dGV4X3VubG9jaygmbGRldi0+Z2VtLm11
dGV4KTsNCisNCisJc2VxX3ByaW50ZihtLCAiUGlubmVkIEJPIHNpemU6IFZSQU06ICV6dSBLQiwg
R1RUOiAlenUgS0JcbiIsDQorCQkgICBsZGV2LT52cmFtX3Bpbm5lZF9zaXplID4+IDEwLCBsZGV2
LT5ndHRfcGlubmVkX3NpemUgPj4gMTApOw0KKw0KKwlyZXR1cm4gMDsNCit9DQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2VtLmggYi9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19nZW0uaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAw
MDAwMC4uN2UwNWU0NTNiNzMzDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19nZW0uaA0KQEAgLTAsMCArMSwzNyBAQA0KKy8qIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdz
b24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xT
RENfR0VNX0hfXw0KKyNkZWZpbmUgX19MU0RDX0dFTV9IX18NCisNCisjaW5jbHVkZSA8ZHJtL2Ry
bV9kZXZpY2UuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9nZW0uaD4NCisNCitzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKg0KK2xzZGNfcHJpbWVfaW1wb3J0X3NnX3RhYmxlKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2LA0KKwkJCSAgIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwNCisJCQkg
ICBzdHJ1Y3Qgc2dfdGFibGUgKnNnKTsNCisNCitpbnQgbHNkY19kdW1iX21hcF9vZmZzZXQoc3Ry
dWN0IGRybV9maWxlICpmaWxlLA0KKwkJCSBzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LA0KKwkJCSB1
MzIgaGFuZGxlLA0KKwkJCSB1aW50NjRfdCAqb2Zmc2V0KTsNCisNCitpbnQgbHNkY19kdW1iX2Ny
ZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsDQorCQkgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpk
ZGV2LA0KKwkJICAgICBzdHJ1Y3QgZHJtX21vZGVfY3JlYXRlX2R1bWIgKmFyZ3MpOw0KKw0KK3Zv
aWQgbHNkY19nZW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldik7DQoraW50IGxzZGNfc2hv
d19idWZmZXJfb2JqZWN0KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKTsNCisNCitzdHJ1
Y3QgZHJtX2dlbV9vYmplY3QgKg0KK2xzZGNfZ2VtX29iamVjdF9jcmVhdGUoc3RydWN0IGRybV9k
ZXZpY2UgKmRkZXYsDQorCQkgICAgICAgdTMyIGRvbWFpbiwNCisJCSAgICAgICBzaXplX3Qgc2l6
ZSwNCisJCSAgICAgICBib29sIGtlcmVubCwNCisJCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNn
LA0KKwkJICAgICAgIHN0cnVjdCBkbWFfcmVzdiAqcmVzdik7DQorDQorI2VuZGlmDQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2Z4cGxsLmMgYi9kcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19nZnhwbGwuYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4
IDAwMDAwMDAwMDAwMC4uOTc3YjEyZGNiNzNjDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19nZnhwbGwuYw0KQEAgLTAsMCArMSwxOTkgQEANCisvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAy
MDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNp
bmNsdWRlIDxsaW51eC9kZWxheS5oPg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2ZpbGUuaD4NCisj
aW5jbHVkZSA8ZHJtL2RybV9tYW5hZ2VkLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fcHJpbnQuaD4N
CisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisNCisvKg0KKyAqIEdGWCBQTEwgaXMgdGhlIFBM
TCB1c2VkIGJ5IERDLCBHTUMgYW5kIEdQVSwgdGhlIHN0cnVjdHVyZSBvZiB0aGUgR0ZYIFBMTA0K
KyAqIG1heSBzdWZmZXIgZnJvbSBjaGFuZ2UgYWNyb3NzIGNoaXAgdmFyaWFudHMuDQorICoNCisg
Kg0KKyAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICArLS0tLS0t
LS0tLS0tLSsgIHNlbF9vdXRfZGMNCisgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICstLS0tfCAvIGRpdl9vdXRfMCB8IF9fX19fLyBfX19fXyBEQw0KKyAqICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgICArLS0tLS0tLS0tLS0tLSsNCisgKiBy
ZWZjbGsgICArLS0tLS0tLS0tKyAgICAgICstLS0tLS0tKyAgIHwgICAgKy0tLS0tLS0tLS0tLS0r
ICBzZWxfb3V0X2dtYw0KKyAqIC0tLSstLS0+IHwgZGl2X3JlZiB8IC0tLT4gfCBsb29wYyB8IC0t
Ky0tPiB8IC8gZGl2X291dF8xIHwgX19fX18vIF9fX19fIEdNQw0KKyAqICAgIHwgICAgICstLS0t
LS0tLS0rICAgICAgKy0tLS0tLS0rICAgfCAgICArLS0tLS0tLS0tLS0tLSsNCisgKiAgICB8ICAg
ICAgICAgIC8gICAgICAgICAgICAgICAqICAgICAgIHwgICAgKy0tLS0tLS0tLS0tLS0rICBzZWxf
b3V0X2dwdQ0KKyAqICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKy0tLS18
IC8gZGl2X291dF8yIHwgX19fX18vIF9fX19fIEdQVQ0KKyAqICAgIHwgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICArLS0tLS0tLS0tLS0tLSsNCisgKiAgICB8ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXg0KKyAqICAg
IHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB8DQorICogICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBieXBhc3MgLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLSsNCisgKi8NCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2JpdG1hcCB7
DQorCS8qIEJ5dGUgMCB+IEJ5dGUgMyAqLw0KKwl1bnNpZ25lZCBkaXZfb3V0X2RjICAgIDogNzsg
IC8qICA2IDogMCAgICBEQyBvdXRwdXQgY2xvY2sgZGl2aWRlciAgKi8NCisJdW5zaWduZWQgZGl2
X291dF9nbWMgICA6IDc7ICAvKiAxMyA6IDcgICAgR01DIG91dHB1dCBjbG9jayBkaXZpZGVyICov
DQorCXVuc2lnbmVkIGRpdl9vdXRfZ3B1ICAgOiA3OyAgLyogMjAgOiAxNCAgIEdQVSBvdXRwdXQg
Y2xvY2sgZGl2aWRlciAqLw0KKwl1bnNpZ25lZCBsb29wYyAgICAgICAgIDogOTsgIC8qIDI5IDog
MjEgICBjbG9jayBtdWx0aXBsaWVyICAgICAgICAgKi8NCisJdW5zaWduZWQgX3Jlc2VydmVkXzFf
ICA6IDI7ICAvKiAzMSA6IDMwICAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorDQorCS8q
IEJ5dGUgNCB+IEJ5dGUgNyAqLw0KKwl1bnNpZ25lZCBkaXZfcmVmICAgICAgIDogNzsgICAvKiAz
OCA6IDMyICAgSW5wdXQgY2xvY2sgZGl2aWRlciAgICAqLw0KKwl1bnNpZ25lZCBsb2NrZWQgICAg
ICAgIDogMTsgICAvKiAzOSAgICAgICAgUExMIGxvY2tlZCBpbmRpY2F0b3IgICAqLw0KKwl1bnNp
Z25lZCBzZWxfb3V0X2RjICAgIDogMTsgICAvKiA0MCAgICAgICAgZGMgb3V0cHV0IGNsayBlbmFi
bGUgICAqLw0KKwl1bnNpZ25lZCBzZWxfb3V0X2dtYyAgIDogMTsgICAvKiA0MSAgICAgICAgZ21j
IG91dHB1dCBjbGsgZW5hYmxlICAqLw0KKwl1bnNpZ25lZCBzZWxfb3V0X2dwdSAgIDogMTsgICAv
KiA0MiAgICAgICAgZ3B1IG91dHB1dCBjbGsgZW5hYmxlICAqLw0KKwl1bnNpZ25lZCBzZXRfcGFy
YW0gICAgIDogMTsgICAvKiA0MyAgICAgICAgVHJpZ2dlciB0aGUgdXBkYXRlICAgICAqLw0KKwl1
bnNpZ25lZCBieXBhc3MgICAgICAgIDogMTsgICAvKiA0NCAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAqLw0KKwl1bnNpZ25lZCBwb3dlcmRvd24gICAgIDogMTsgICAvKiA0NSAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1bnNpZ25lZCBfcmVzZXJ2ZWRfMl8gIDogMTg7
ICAvKiA0NiA6IDYzICAgbm8gdXNlICAgICAgICAgICAgICAgICAqLw0KK307DQorDQordW5pb24g
bG9vbmdzb25fZ2Z4cGxsX3JlZ19iaXRtYXAgew0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2Jp
dG1hcCBiaXRtYXA7DQorCXUzMiB3WzJdOw0KKwl1NjQgZDsNCit9Ow0KKw0KK3N0YXRpYyB2b2lk
IF9fZ2Z4cGxsX3JyZWcoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqdGhpcywNCisJCQkgIHVuaW9u
IGxvb25nc29uX2dmeHBsbF9yZWdfYml0bWFwICpyZWcpDQorew0KKyNpZiBkZWZpbmVkKENPTkZJ
R182NEJJVCkNCisJcmVnLT5kID0gcmVhZHEodGhpcy0+bW1pbyk7DQorI2Vsc2UNCisJcmVnLT53
WzBdID0gcmVhZGwodGhpcy0+bW1pbyk7DQorCXJlZy0+d1sxXSA9IHJlYWRsKHRoaXMtPm1taW8g
KyA0KTsNCisjZW5kaWYNCit9DQorDQorLyogVXBkYXRlIG5ldyBwYXJhbWV0ZXJzIHRvIHRoZSBo
YXJkd2FyZSAqLw0KKw0KK3N0YXRpYyBpbnQgbG9vbmdzb25fZ2Z4cGxsX3VwZGF0ZShzdHJ1Y3Qg
bG9vbmdzb25fZ2Z4cGxsICogY29uc3QgdGhpcywNCisJCQkJICBzdHJ1Y3QgbG9vbmdzb25fZ2Z4
cGxsX3Bhcm1zIGNvbnN0ICpwaW4pDQorew0KKwkvKiBOb25lLCBUT0RPICovDQorDQorCXJldHVy
biAwOw0KK30NCisNCitzdGF0aWMgdm9pZCBsb29uZ3Nvbl9nZnhwbGxfZ2V0X3JhdGVzKHN0cnVj
dCBsb29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJCQkgICAgICB1bnNpZ25lZCBpbnQg
KmRjLA0KKwkJCQkgICAgICB1bnNpZ25lZCBpbnQgKmdtYywNCisJCQkJICAgICAgdW5zaWduZWQg
aW50ICpncHUpDQorew0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1zICpwcGFybXMgPSAm
dGhpcy0+cGFybXM7DQorCXVuaW9uIGxvb25nc29uX2dmeHBsbF9yZWdfYml0bWFwIGdmeHBsbF9y
ZWc7DQorCXVuc2lnbmVkIGludCBwcmVfb3V0cHV0Ow0KKwl1bnNpZ25lZCBpbnQgZGNfbWh6Ow0K
Kwl1bnNpZ25lZCBpbnQgZ21jX21oejsNCisJdW5zaWduZWQgaW50IGdwdV9taHo7DQorDQorCV9f
Z2Z4cGxsX3JyZWcodGhpcywgJmdmeHBsbF9yZWcpOw0KKw0KKwlwcGFybXMtPmRpdl9yZWYgPSBn
ZnhwbGxfcmVnLmJpdG1hcC5kaXZfcmVmOw0KKwlwcGFybXMtPmxvb3BjID0gZ2Z4cGxsX3JlZy5i
aXRtYXAubG9vcGM7DQorDQorCXBwYXJtcy0+ZGl2X291dF9kYyA9IGdmeHBsbF9yZWcuYml0bWFw
LmRpdl9vdXRfZGM7DQorCXBwYXJtcy0+ZGl2X291dF9nbWMgPSBnZnhwbGxfcmVnLmJpdG1hcC5k
aXZfb3V0X2dtYzsNCisJcHBhcm1zLT5kaXZfb3V0X2dwdSA9IGdmeHBsbF9yZWcuYml0bWFwLmRp
dl9vdXRfZ3B1Ow0KKw0KKwlwcmVfb3V0cHV0ID0gcHBhcm1zLT5yZWZfY2xvY2sgLyBwcGFybXMt
PmRpdl9yZWYgKiBwcGFybXMtPmxvb3BjOw0KKw0KKwlkY19taHogPSBwcmVfb3V0cHV0IC8gcHBh
cm1zLT5kaXZfb3V0X2RjIC8gMTAwMDsNCisJZ21jX21oeiA9IHByZV9vdXRwdXQgLyBwcGFybXMt
PmRpdl9vdXRfZ21jIC8gMTAwMDsNCisJZ3B1X21oeiA9IHByZV9vdXRwdXQgLyBwcGFybXMtPmRp
dl9vdXRfZ3B1IC8gMTAwMDsNCisNCisJaWYgKGRjKQ0KKwkJKmRjID0gZGNfbWh6Ow0KKw0KKwlp
ZiAoZ21jKQ0KKwkJKmdtYyA9IGdtY19taHo7DQorDQorCWlmIChncHUpDQorCQkqZ3B1ID0gZ3B1
X21oejsNCit9DQorDQorc3RhdGljIHZvaWQgbG9vbmdzb25fZ2Z4cGxsX3ByaW50KHN0cnVjdCBs
b29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJCQkgIHN0cnVjdCBkcm1fcHJpbnRlciAq
cCwNCisJCQkJICBib29sIHZlcmJvc2UpDQorew0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bh
cm1zICpwYXJtcyA9ICZ0aGlzLT5wYXJtczsNCisJdW5zaWduZWQgaW50IGRjLCBnbWMsIGdwdTsN
CisNCisJaWYgKHZlcmJvc2UpIHsNCisJCWRybV9wcmludGYocCwgInJlZmVyZW5jZSBjbG9jazog
JXVcbiIsIHBhcm1zLT5yZWZfY2xvY2spOw0KKwkJZHJtX3ByaW50ZihwLCAiZGl2X3JlZiA9ICV1
XG4iLCBwYXJtcy0+ZGl2X3JlZik7DQorCQlkcm1fcHJpbnRmKHAsICJsb29wYyA9ICV1XG4iLCBw
YXJtcy0+bG9vcGMpOw0KKw0KKwkJZHJtX3ByaW50ZihwLCAiZGl2X291dF9kYyA9ICV1XG4iLCBw
YXJtcy0+ZGl2X291dF9kYyk7DQorCQlkcm1fcHJpbnRmKHAsICJkaXZfb3V0X2dtYyA9ICV1XG4i
LCBwYXJtcy0+ZGl2X291dF9nbWMpOw0KKwkJZHJtX3ByaW50ZihwLCAiZGl2X291dF9ncHUgPSAl
dVxuIiwgcGFybXMtPmRpdl9vdXRfZ3B1KTsNCisJfQ0KKw0KKwl0aGlzLT5mdW5jcy0+Z2V0X3Jh
dGVzKHRoaXMsICZkYywgJmdtYywgJmdwdSk7DQorDQorCWRybV9wcmludGYocCwgImRjOiAldU1I
eiwgZ21jOiAldU1IeiwgZ3B1OiAldU1IelxuIiwgZGMsIGdtYywgZ3B1KTsNCit9DQorDQorLyog
R0ZYIChEQywgR1BVLCBHTUMpIFBMTCBpbml0aWFsaXphdGlvbiBhbmQgZGVzdHJveSBmdW5jdGlv
biAqLw0KKw0KK3N0YXRpYyB2b2lkIGxvb25nc29uX2dmeHBsbF9maW5pKHN0cnVjdCBkcm1fZGV2
aWNlICpkZGV2LCB2b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0IGxvb25nc29uX2dmeHBsbCAqdGhp
cyA9IChzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsICopZGF0YTsNCisNCisJaW91bm1hcCh0aGlzLT5t
bWlvKTsNCisNCisJa2ZyZWUodGhpcyk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbG9vbmdzb25fZ2Z4
cGxsX2luaXQoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMpDQorew0KKwlzdHJ1
Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1zICpwcGFybXMgPSAmdGhpcy0+cGFybXM7DQorCXN0cnVj
dCBkcm1fcHJpbnRlciBwcmludGVyID0gZHJtX2luZm9fcHJpbnRlcih0aGlzLT5kZGV2LT5kZXYp
Ow0KKw0KKwlwcGFybXMtPnJlZl9jbG9jayA9IExTRENfUExMX1JFRl9DTEs7DQorDQorCXRoaXMt
Pm1taW8gPSBpb3JlbWFwKHRoaXMtPnJlZ19iYXNlLCB0aGlzLT5yZWdfc2l6ZSk7DQorCWlmIChJ
U19FUlJfT1JfTlVMTCh0aGlzLT5tbWlvKSkNCisJCXJldHVybiAtRU5PTUVNOw0KKw0KKwl0aGlz
LT5mdW5jcy0+cHJpbnQodGhpcywgJnByaW50ZXIsIGZhbHNlKTsNCisNCisJcmV0dXJuIDA7DQor
fQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2Z1bmNzIGxzZGNfZ21j
X2dwdV9mdW5jcyA9IHsNCisJLmluaXQgPSBsb29uZ3Nvbl9nZnhwbGxfaW5pdCwNCisJLnVwZGF0
ZSA9IGxvb25nc29uX2dmeHBsbF91cGRhdGUsDQorCS5nZXRfcmF0ZXMgPSBsb29uZ3Nvbl9nZnhw
bGxfZ2V0X3JhdGVzLA0KKwkucHJpbnQgPSBsb29uZ3Nvbl9nZnhwbGxfcHJpbnQsDQorfTsNCisN
CitpbnQgbG9vbmdzb25fZ2Z4cGxsX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJ
CQkgICBzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsICoqcHBvdXQpDQorew0KKwlzdHJ1Y3QgbHNkY19k
ZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwljb25zdCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4
X2Rlc2MgKmdmeCA9IHRvX2xvb25nc29uX2dmeChsZGV2LT5kZXNjcCk7DQorCXN0cnVjdCBsb29u
Z3Nvbl9nZnhwbGwgKnRoaXM7DQorCWludCByZXQ7DQorDQorCXRoaXMgPSBremFsbG9jKHNpemVv
ZigqdGhpcyksIEdGUF9LRVJORUwpOw0KKwlpZiAoSVNfRVJSX09SX05VTEwodGhpcykpDQorCQly
ZXR1cm4gLUVOT01FTTsNCisNCisJdGhpcy0+ZGRldiA9IGRkZXY7DQorCXRoaXMtPnJlZ19zaXpl
ID0gZ2Z4LT5nZnhwbGwucmVnX3NpemU7DQorCXRoaXMtPnJlZ19iYXNlID0gZ2Z4LT5jb25mX3Jl
Z19iYXNlICsgZ2Z4LT5nZnhwbGwucmVnX29mZnNldDsNCisJdGhpcy0+ZnVuY3MgPSAmbHNkY19n
bWNfZ3B1X2Z1bmNzOw0KKw0KKwlyZXQgPSB0aGlzLT5mdW5jcy0+aW5pdCh0aGlzKTsNCisJaWYg
KHVubGlrZWx5KHJldCkpIHsNCisJCWtmcmVlKHRoaXMpOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0K
Kw0KKwkqcHBvdXQgPSB0aGlzOw0KKw0KKwlyZXR1cm4gZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0
KGRkZXYsIGxvb25nc29uX2dmeHBsbF9maW5pLCB0aGlzKTsNCit9DQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZ2Z4cGxsLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19nZnhwbGwuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAw
MDAwMC4uZjVlYmE2NzY1ODEyDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19nZnhwbGwuaA0KQEAgLTAsMCArMSw1MiBAQA0KKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9v
bmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBf
X0xTRENfR0ZYUExMX0hfXw0KKyNkZWZpbmUgX19MU0RDX0dGWFBMTF9IX18NCisNCisjaW5jbHVk
ZSA8ZHJtL2RybV9kZXZpY2UuaD4NCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsOw0KKw0KK3N0
cnVjdCBsb29uZ3Nvbl9nZnhwbGxfcGFybXMgew0KKwl1bnNpZ25lZCBpbnQgcmVmX2Nsb2NrOw0K
Kwl1bnNpZ25lZCBpbnQgZGl2X3JlZjsNCisJdW5zaWduZWQgaW50IGxvb3BjOw0KKwl1bnNpZ25l
ZCBpbnQgZGl2X291dF9kYzsNCisJdW5zaWduZWQgaW50IGRpdl9vdXRfZ21jOw0KKwl1bnNpZ25l
ZCBpbnQgZGl2X291dF9ncHU7DQorfTsNCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX2Z1bmNz
IHsNCisJaW50ICgqaW5pdCkoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMpOw0K
Kw0KKwlpbnQgKCp1cGRhdGUpKHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0aGlzLA0K
KwkJICAgICAgc3RydWN0IGxvb25nc29uX2dmeHBsbF9wYXJtcyBjb25zdCAqcGluKTsNCisNCisJ
dm9pZCAoKmdldF9yYXRlcykoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMsDQor
CQkJICB1bnNpZ25lZCBpbnQgKmRjLCB1bnNpZ25lZCBpbnQgKmdtYywgdW5zaWduZWQgaW50ICpn
cHUpOw0KKw0KKwl2b2lkICgqcHJpbnQpKHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0
aGlzLA0KKwkJICAgICAgc3RydWN0IGRybV9wcmludGVyICpwcmludGVyLCBib29sIHZlcmJvc2Up
Ow0KK307DQorDQorc3RydWN0IGxvb25nc29uX2dmeHBsbCB7DQorCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2Ow0KKwl2b2lkIF9faW9tZW0gKm1taW87DQorDQorCS8qIFBMTCByZWdpc3RlciBvZmZz
ZXQgKi8NCisJdTMyIHJlZ19iYXNlOw0KKwkvKiBQTEwgcmVnaXN0ZXIgc2l6ZSBpbiBieXRlcyAq
Lw0KKwl1MzIgcmVnX3NpemU7DQorDQorCWNvbnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGxfZnVu
Y3MgKmZ1bmNzOw0KKw0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bhcm1zIHBhcm1zOw0KK307
DQorDQoraW50IGxvb25nc29uX2dmeHBsbF9jcmVhdGUoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYs
DQorCQkJICAgc3RydWN0IGxvb25nc29uX2dmeHBsbCAqKnBwb3V0KTsNCisNCisjZW5kaWYNCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pMmMuYyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2kyYy5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXgg
MDAwMDAwMDAwMDAwLi5kNjQ3MTJhNDYwOTgNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2kyYy5jDQpAQCAtMCwwICsxLDE3OSBAQA0KKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMg
TG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1
ZGUgPGRybS9kcm1fbWFuYWdlZC5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKyNpbmNs
dWRlICJsc2RjX291dHB1dC5oIg0KKw0KKy8qDQorICogX19sc2RjX2dwaW9faTJjX3NldCAtIHNl
dCB0aGUgc3RhdGUgb2YgYSBncGlvIHBpbiBpbmRpY2F0ZWQgYnkgbWFzaw0KKyAqIEBtYXNrOiBn
cGlvIHBpbiBtYXNrDQorICogQHN0YXRlOiAiMCIgZm9yIGxvdywgIjEiIGZvciBoaWdoDQorICov
DQorc3RhdGljIHZvaWQgX19sc2RjX2dwaW9faTJjX3NldChzdHJ1Y3QgbHNkY19pMmMgKiBjb25z
dCBsaTJjLCBpbnQgbWFzaywgaW50IHN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICps
ZGV2ID0gdG9fbHNkYyhsaTJjLT5kZGV2KTsNCisJdW5zaWduZWQgbG9uZyBmbGFnczsNCisJdTgg
dmFsOw0KKw0KKwlzcGluX2xvY2tfaXJxc2F2ZSgmbGRldi0+cmVnbG9jaywgZmxhZ3MpOw0KKw0K
KwlpZiAoc3RhdGUpIHsNCisJCS8qDQorCQkgKiBTZXR0aW5nIHRoaXMgcGluIGFzIGlucHV0IGRp
cmVjdGx5LCB3cml0ZSAxIGZvciBpbnB1dC4NCisJCSAqIFRoZSBleHRlcm5hbCBwdWxsLXVwIHJl
c2lzdG9yIHdpbGwgcHVsbCB0aGUgbGV2ZWwgdXANCisJCSAqLw0KKwkJdmFsID0gcmVhZGIobGky
Yy0+ZGlyX3JlZyk7DQorCQl2YWwgfD0gbWFzazsNCisJCXdyaXRlYih2YWwsIGxpMmMtPmRpcl9y
ZWcpOw0KKwl9IGVsc2Ugew0KKwkJLyogRmlyc3Qgc2V0IHRoaXMgcGluIGFzIG91dHB1dCwgd3Jp
dGUgMCBmb3Igb3V0cHV0ICovDQorCQl2YWwgPSByZWFkYihsaTJjLT5kaXJfcmVnKTsNCisJCXZh
bCAmPSB+bWFzazsNCisJCXdyaXRlYih2YWwsIGxpMmMtPmRpcl9yZWcpOw0KKw0KKwkJLyogVGhl
biwgbWFrZSB0aGlzIHBpbiBvdXRwdXQgMCAqLw0KKwkJdmFsID0gcmVhZGIobGkyYy0+ZGF0X3Jl
Zyk7DQorCQl2YWwgJj0gfm1hc2s7DQorCQl3cml0ZWIodmFsLCBsaTJjLT5kYXRfcmVnKTsNCisJ
fQ0KKw0KKwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZsZGV2LT5yZWdsb2NrLCBmbGFncyk7DQor
fQ0KKw0KKy8qDQorICogX19sc2RjX2dwaW9faTJjX2dldCAtIHJlYWQgdmFsdWUgYmFjayBmcm9t
IHRoZSBncGlvIHBpbiBpbmRpY2F0ZWQgYnkgbWFzaw0KKyAqIEBtYXNrOiBncGlvIHBpbiBtYXNr
DQorICogcmV0dXJuICIwIiBmb3IgbG93LCAiMSIgZm9yIGhpZ2gNCisgKi8NCitzdGF0aWMgaW50
IF9fbHNkY19ncGlvX2kyY19nZXQoc3RydWN0IGxzZGNfaTJjICogY29uc3QgbGkyYywgaW50IG1h
c2spDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGxpMmMtPmRkZXYp
Ow0KKwl1bnNpZ25lZCBsb25nIGZsYWdzOw0KKwl1OCB2YWw7DQorDQorCXNwaW5fbG9ja19pcnFz
YXZlKCZsZGV2LT5yZWdsb2NrLCBmbGFncyk7DQorDQorCS8qIEZpcnN0IHNldCB0aGlzIHBpbiBh
cyBpbnB1dCAqLw0KKwl2YWwgPSByZWFkYihsaTJjLT5kaXJfcmVnKTsNCisJdmFsIHw9IG1hc2s7
DQorCXdyaXRlYih2YWwsIGxpMmMtPmRpcl9yZWcpOw0KKw0KKwkvKiBUaGVuIGdldCBsZXZlbCBz
dGF0ZSBmcm9tIHRoaXMgcGluICovDQorCXZhbCA9IHJlYWRiKGxpMmMtPmRhdF9yZWcpOw0KKw0K
KwlzcGluX3VubG9ja19pcnFyZXN0b3JlKCZsZGV2LT5yZWdsb2NrLCBmbGFncyk7DQorDQorCXJl
dHVybiAodmFsICYgbWFzaykgPyAxIDogMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19ncGlv
X2kyY19zZXRfc2RhKHZvaWQgKmkyYywgaW50IHN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfaTJj
ICogY29uc3QgbGkyYyA9IChzdHJ1Y3QgbHNkY19pMmMgKilpMmM7DQorCS8qIHNldCBzdGF0ZSBv
biB0aGUgbGkyYy0+c2RhIHBpbiAqLw0KKwlyZXR1cm4gX19sc2RjX2dwaW9faTJjX3NldChsaTJj
LCBsaTJjLT5zZGEsIHN0YXRlKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19ncGlvX2kyY19z
ZXRfc2NsKHZvaWQgKmkyYywgaW50IHN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfaTJjICogY29u
c3QgbGkyYyA9IChzdHJ1Y3QgbHNkY19pMmMgKilpMmM7DQorCS8qIHNldCBzdGF0ZSBvbiB0aGUg
bGkyYy0+c2NsIHBpbiAqLw0KKwlyZXR1cm4gX19sc2RjX2dwaW9faTJjX3NldChsaTJjLCBsaTJj
LT5zY2wsIHN0YXRlKTsNCit9DQorDQorc3RhdGljIGludCBsc2RjX2dwaW9faTJjX2dldF9zZGEo
dm9pZCAqaTJjKQ0KK3sNCisJc3RydWN0IGxzZGNfaTJjICogY29uc3QgbGkyYyA9IChzdHJ1Y3Qg
bHNkY19pMmMgKilpMmM7DQorCS8qIHJlYWQgdmFsdWUgZnJvbSB0aGUgbGkyYy0+c2RhIHBpbiAq
Lw0KKwlyZXR1cm4gX19sc2RjX2dwaW9faTJjX2dldChsaTJjLCBsaTJjLT5zZGEpOw0KK30NCisN
CitzdGF0aWMgaW50IGxzZGNfZ3Bpb19pMmNfZ2V0X3NjbCh2b2lkICppMmMpDQorew0KKwlzdHJ1
Y3QgbHNkY19pMmMgKiBjb25zdCBsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAqKWkyYzsNCisJLyog
cmVhZCB0aGUgdmFsdWUgZnJvbSB0aGUgbGkyYy0+c2NsIHBpbiAqLw0KKwlyZXR1cm4gX19sc2Rj
X2dwaW9faTJjX2dldChsaTJjLCBsaTJjLT5zY2wpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2Rj
X2Rlc3Ryb3lfaTJjKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LCB2b2lkICpkYXRhKQ0KK3sNCisJ
c3RydWN0IGxzZGNfaTJjICpsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAqKWRhdGE7DQorDQorCWlm
IChsaTJjKSB7DQorCQlpMmNfZGVsX2FkYXB0ZXIoJmxpMmMtPmFkYXB0ZXIpOw0KKwkJa2ZyZWUo
bGkyYyk7DQorCX0NCit9DQorDQorLyoNCisgKiBUaGUgREMgaW4gbHM3YTEwMDAvbHM3YTIwMDAv
bHMyazIwMDAgaGFzIGJ1aWx0aW4gZ3BpbyBoYXJkd2FyZQ0KKyAqDQorICogQHJlZ19iYXNlOiBn
cGlvIHJlZyBiYXNlDQorICogQGluZGV4OiBvdXRwdXQgY2hhbm5lbCBpbmRleCwgMCBmb3IgUElQ
RTAsIDEgZm9yIFBJUEUxDQorICovDQoraW50IGxzZGNfY3JlYXRlX2kyY19jaGFuKHN0cnVjdCBk
cm1fZGV2aWNlICpkZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUs
DQorCQkJIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diA9IHRvX2xzZGMoZGRldik7DQorCXN0cnVjdCBpMmNfYWRhcHRlciAqYWRhcHRlcjsNCisJc3Ry
dWN0IGxzZGNfaTJjICpsaTJjOw0KKwlpbnQgcmV0Ow0KKw0KKwlsaTJjID0ga3phbGxvYyhzaXpl
b2YoKmxpMmMpLCBHRlBfS0VSTkVMKTsNCisJaWYgKCFsaTJjKQ0KKwkJcmV0dXJuIC1FTk9NRU07
DQorDQorCWRpc3BpcGUtPmxpMmMgPSBsaTJjOw0KKw0KKwlpZiAoaW5kZXggPT0gMCkgew0KKwkJ
bGkyYy0+c2RhID0gMHgwMTsgIC8qIHBpbiAwICovDQorCQlsaTJjLT5zY2wgPSAweDAyOyAgLyog
cGluIDEgKi8NCisJfSBlbHNlIGlmIChpbmRleCA9PSAxKSB7DQorCQlsaTJjLT5zZGEgPSAweDA0
OyAgLyogcGluIDIgKi8NCisJCWxpMmMtPnNjbCA9IDB4MDg7ICAvKiBwaW4gMyAqLw0KKwl9IGVs
c2Ugew0KKwkJcmV0dXJuIC1FTk9FTlQ7DQorCX0NCisNCisJbGkyYy0+ZGRldiA9IGRkZXY7DQor
CWxpMmMtPmRpcl9yZWcgPSBsZGV2LT5yZWdfYmFzZSArIExTN0FfRENfR1BJT19ESVJfUkVHOw0K
KwlsaTJjLT5kYXRfcmVnID0gbGRldi0+cmVnX2Jhc2UgKyBMUzdBX0RDX0dQSU9fREFUX1JFRzsN
CisNCisJbGkyYy0+Yml0LnNldHNkYSA9IGxzZGNfZ3Bpb19pMmNfc2V0X3NkYTsNCisJbGkyYy0+
Yml0LnNldHNjbCA9IGxzZGNfZ3Bpb19pMmNfc2V0X3NjbDsNCisJbGkyYy0+Yml0LmdldHNkYSA9
IGxzZGNfZ3Bpb19pMmNfZ2V0X3NkYTsNCisJbGkyYy0+Yml0LmdldHNjbCA9IGxzZGNfZ3Bpb19p
MmNfZ2V0X3NjbDsNCisJbGkyYy0+Yml0LnVkZWxheSA9IDU7DQorCWxpMmMtPmJpdC50aW1lb3V0
ID0gdXNlY3NfdG9famlmZmllcygyMjAwKTsNCisJbGkyYy0+Yml0LmRhdGEgPSBsaTJjOw0KKw0K
KwlhZGFwdGVyID0gJmxpMmMtPmFkYXB0ZXI7DQorCWFkYXB0ZXItPmFsZ29fZGF0YSA9ICZsaTJj
LT5iaXQ7DQorCWFkYXB0ZXItPm93bmVyID0gVEhJU19NT0RVTEU7DQorCWFkYXB0ZXItPmNsYXNz
ID0gSTJDX0NMQVNTX0REQzsNCisJYWRhcHRlci0+ZGV2LnBhcmVudCA9IGRkZXYtPmRldjsNCisJ
YWRhcHRlci0+bnIgPSAtMTsNCisNCisJc25wcmludGYoYWRhcHRlci0+bmFtZSwgc2l6ZW9mKGFk
YXB0ZXItPm5hbWUpLCAibHNkYy1pMmMldSIsIGluZGV4KTsNCisNCisJaTJjX3NldF9hZGFwZGF0
YShhZGFwdGVyLCBsaTJjKTsNCisNCisJcmV0ID0gaTJjX2JpdF9hZGRfYnVzKGFkYXB0ZXIpOw0K
KwlpZiAocmV0KSB7DQorCQlrZnJlZShsaTJjKTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJ
cmV0ID0gZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0KGRkZXYsIGxzZGNfZGVzdHJveV9pMmMsIGxp
MmMpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZHJtX2luZm8oZGRldiwgIiVz
KHNkYSBwaW4gbWFzaz0ldSwgc2NsIHBpbiBtYXNrPSV1KSBjcmVhdGVkXG4iLA0KKwkJIGFkYXB0
ZXItPm5hbWUsIGxpMmMtPnNkYSwgbGkyYy0+c2NsKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2kyYy5oIGIvZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzZGNfaTJjLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAw
MDAwMDAwMDAwMDAuLmMzZGFkYzJjNDIzZA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzZGNfaTJjLmgNCkBAIC0wLDAgKzEsMjkgQEANCisvKiBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIz
IExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5k
ZWYgX19MU0RDX0kyQ19IX18NCisjZGVmaW5lIF9fTFNEQ19JMkNfSF9fDQorDQorI2luY2x1ZGUg
PGxpbnV4L2kyYy5oPg0KKyNpbmNsdWRlIDxsaW51eC9pMmMtYWxnby1iaXQuaD4NCisNCitzdHJ1
Y3QgbHNkY19pMmMgew0KKwlzdHJ1Y3QgaTJjX2FkYXB0ZXIgYWRhcHRlcjsNCisJc3RydWN0IGky
Y19hbGdvX2JpdF9kYXRhIGJpdDsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXY7DQorCXZvaWQg
X19pb21lbSAqZGlyX3JlZzsNCisJdm9pZCBfX2lvbWVtICpkYXRfcmVnOw0KKwkvKiBwaW4gYml0
IG1hc2sgKi8NCisJdTggc2RhOw0KKwl1OCBzY2w7DQorfTsNCisNCitzdHJ1Y3QgbHNkY19kaXNw
bGF5X3BpcGU7DQorDQoraW50IGxzZGNfY3JlYXRlX2kyY19jaGFuKHN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJIHVu
c2lnbmVkIGludCBpbmRleCk7DQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfaXJxLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19p
cnEuYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZTRlZTBiNjA4
MDIzDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19p
cnEuYw0KQEAgLTAsMCArMSw3MSBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwt
Mi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jw
b3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGRybS9kcm1fdmJsYW5rLmg+DQor
DQorI2luY2x1ZGUgImxzZGNfaXJxLmgiDQorDQorLyoNCisgKiBGb3IgdGhlIERDIGluIGxzN2Ey
MDAwLCBjbGVhcmluZyBpbnRlcnJ1cHQgc3RhdHVzIGlzIGFjaGlldmVkIGJ5DQorICogd3JpdGUg
IjEiIHRvIExTRENfSU5UX1JFRywgRm9yIHRoZSBEQyBpbiBsczdhMTAwMCwgY2xlYXIgaW50ZXJy
dXB0DQorICogc3RhdHVzIGlzIGFjaGlldmVkIGJ5IHdyaXRlICIwIiB0byBMU0RDX0lOVF9SRUcu
IFR3byBkaWZmZXJlbnQgaGFyZHdhcmUNCisgKiBlbmdpbmVlciBvZiBMb29uZ3NvbiBtb2RpZnkg
aXQgYXMgdGhlaXIgd2lsbC4NCisgKi8NCisNCitpcnFyZXR1cm5fdCBsczdhMjAwMF9kY19pcnFf
aGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRl
diA9IGFyZzsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJ
dTMyIHZhbDsNCisNCisJLyogUmVhZCB0aGUgaW50ZXJydXB0IHN0YXR1cyAqLw0KKwl2YWwgPSBs
c2RjX3JyZWczMihsZGV2LCBMU0RDX0lOVF9SRUcpOw0KKwlpZiAoKHZhbCAmIElOVF9TVEFUVVNf
TUFTSykgPT0gMCkgew0KKwkJZHJtX3dhcm4oZGRldiwgIm5vIGludGVycnVwdCBvY2N1cnNcbiIp
Ow0KKwkJcmV0dXJuIElSUV9OT05FOw0KKwl9DQorDQorCWxkZXYtPmlycV9zdGF0dXMgPSB2YWw7
DQorDQorCS8qIHdyaXRlICIxIiB0byBjbGVhciB0aGUgaW50ZXJydXB0IHN0YXR1cyAqLw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0lOVF9SRUcsIHZhbCk7DQorDQorCWlmIChsZGV2LT5pcnFf
c3RhdHVzICYgSU5UX0NSVEMwX1ZTWU5DKQ0KKwkJZHJtX2hhbmRsZV92YmxhbmsoZGRldiwgMCk7
DQorDQorCWlmIChsZGV2LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMxX1ZTWU5DKQ0KKwkJZHJtX2hh
bmRsZV92YmxhbmsoZGRldiwgMSk7DQorDQorCXJldHVybiBJUlFfSEFORExFRDsNCit9DQorDQor
LyogRm9yIHRoZSBEQyBpbiBMUzdBMTAwMCBhbmQgTFMySzEwMDAgKi8NCitpcnFyZXR1cm5fdCBs
czdhMTAwMF9kY19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiA9IGFyZzsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9f
bHNkYyhkZGV2KTsNCisJdTMyIHZhbDsNCisNCisJLyogUmVhZCB0aGUgaW50ZXJydXB0IHN0YXR1
cyAqLw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0lOVF9SRUcpOw0KKwlpZiAoKHZh
bCAmIElOVF9TVEFUVVNfTUFTSykgPT0gMCkgew0KKwkJZHJtX3dhcm4oZGRldiwgIm5vIGludGVy
cnVwdCBvY2N1cnNcbiIpOw0KKwkJcmV0dXJuIElSUV9OT05FOw0KKwl9DQorDQorCWxkZXYtPmly
cV9zdGF0dXMgPSB2YWw7DQorDQorCS8qIHdyaXRlICIwIiB0byBjbGVhciB0aGUgaW50ZXJydXB0
IHN0YXR1cyAqLw0KKwl2YWwgJj0gfihJTlRfQ1JUQzBfVlNZTkMgfCBJTlRfQ1JUQzFfVlNZTkMp
Ow0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0lOVF9SRUcsIHZhbCk7DQorDQorCWlmIChsZGV2
LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMwX1ZTWU5DKQ0KKwkJZHJtX2hhbmRsZV92YmxhbmsoZGRl
diwgMCk7DQorDQorCWlmIChsZGV2LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMxX1ZTWU5DKQ0KKwkJ
ZHJtX2hhbmRsZV92YmxhbmsoZGRldiwgMSk7DQorDQorCXJldHVybiBJUlFfSEFORExFRDsNCit9
DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfaXJxLmggYi9kcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmlu
ZGV4IDAwMDAwMDAwMDAwMC4uYzcwMDM0NjEwNTFlDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEuaA0KQEAgLTAsMCArMSwxNiBAQA0KKy8qIFNQ
RFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMp
IDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQor
I2lmbmRlZiBfX0xTRENfSVJRX0hfXw0KKyNkZWZpbmUgX19MU0RDX0lSUV9IX18NCisNCisjaW5j
bHVkZSA8bGludXgvaXJxcmV0dXJuLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQor
aXJxcmV0dXJuX3QgbHM3YTEwMDBfZGNfaXJxX2hhbmRsZXIoaW50IGlycSwgdm9pZCAqYXJnKTsN
CitpcnFyZXR1cm5fdCBsczdhMjAwMF9kY19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcp
Ow0KKw0KKyNlbmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X291dHB1dC5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0LmgNCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmUzYzM3NTI5ODU2OA0KLS0tIC9k
ZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0LmgNCkBA
IC0wLDAgKzEsMjEgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLw0K
Ky8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRp
b24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5kZWYgX19MU0RDX09VVFBVVF9IX18NCisjZGVmaW5l
IF9fTFNEQ19PVVRQVVRfSF9fDQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQoraW50IGxz
N2ExMDAwX291dHB1dF9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSBzdHJ1Y3Qg
bHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQorCQkJIHN0cnVjdCBpMmNfYWRhcHRlciAqZGRj
LA0KKwkJCSB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0KK2ludCBsczdhMjAwMF9vdXRwdXRfaW5p
dChzdHJ1Y3QgZHJtX2RldmljZSAqbGRldiwNCisJCQkgc3RydWN0IGxzZGNfZGlzcGxheV9waXBl
ICpkaXNwaXBlLA0KKwkJCSBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmRkYywNCisJCQkgdW5zaWduZWQg
aW50IGluZGV4KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19vdXRwdXRfN2ExMDAwLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19vdXRwdXRfN2ExMDAwLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAw
MDAuLjQ1NjAyY2M3Y2NmOQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfb3V0cHV0XzdhMTAwMC5jDQpAQCAtMCwwICsxLDE2MSBAQA0KKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMg
TG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1
ZGUgPGRybS9kcm1fYXRvbWljX2hlbHBlci5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2VkaWQuaD4N
CisjaW5jbHVkZSA8ZHJtL2RybV9wcm9iZV9oZWxwZXIuaD4NCisNCisjaW5jbHVkZSAibHNkY19k
cnYuaCINCisjaW5jbHVkZSAibHNkY19vdXRwdXQuaCINCisNCisvKg0KKyAqIEN1cnJlbnRseSwg
d2UgYXNzdW1lIHRoZSBleHRlcm5hbCBlbmNvZGVycyBjb25uZWN0ZWQgd2l0aCB0aGUgRFZPIGlz
DQorICogdHJhbnNwYXJlbnQuIExvb25nc29uIERWTyBpbnRlcmZhY2UgY2FuIGRpcmVjdGx5IGRy
aXZlIFJHQjg4OCBwYW5lbHMuDQorICoNCisgKiAgVE9ETzogQWRkIHN1cHBvcnQgZm9yIG5vbi10
cmFuc3BhcmVudCBlbmNvZGVycyAuLi4NCisgKi8NCisNCitzdGF0aWMgaW50IGxzN2ExMDAwX2Rw
aV9jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uKQ0KK3sNCisJ
dW5zaWduZWQgaW50IG51bSA9IDA7DQorCXN0cnVjdCBlZGlkICplZGlkOw0KKw0KKwlpZiAoY29u
bi0+ZGRjKSB7DQorCQllZGlkID0gZHJtX2dldF9lZGlkKGNvbm4sIGNvbm4tPmRkYyk7DQorCQlp
ZiAoZWRpZCkgew0KKwkJCWRybV9jb25uZWN0b3JfdXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubiwg
ZWRpZCk7DQorCQkJbnVtID0gZHJtX2FkZF9lZGlkX21vZGVzKGNvbm4sIGVkaWQpOw0KKwkJCWtm
cmVlKGVkaWQpOw0KKwkJfQ0KKw0KKwkJcmV0dXJuIG51bTsNCisJfQ0KKw0KKwludW0gPSBkcm1f
YWRkX21vZGVzX25vZWRpZChjb25uLCAxOTIwLCAxMjAwKTsNCisNCisJZHJtX3NldF9wcmVmZXJy
ZWRfbW9kZShjb25uLCAxMDI0LCA3NjgpOw0KKw0KKwlyZXR1cm4gbnVtOw0KK30NCisNCitzdGF0
aWMgc3RydWN0IGRybV9lbmNvZGVyICoNCitsczdhMTAwMF9kcGlfY29ubmVjdG9yX2dldF9iZXN0
X2VuY29kZXIoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwNCisJCQkJCXN0cnVjdCBk
cm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0
ID0gY29ubmVjdG9yX3RvX2xzZGNfb3V0cHV0KGNvbm5lY3Rvcik7DQorDQorCXJldHVybiAmb3V0
cHV0LT5lbmNvZGVyOw0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3Jf
aGVscGVyX2Z1bmNzDQorbHM3YTEwMDBfZHBpX2Nvbm5lY3Rvcl9oZWxwZXJzID0gew0KKwkuYXRv
bWljX2Jlc3RfZW5jb2RlciA9IGxzN2ExMDAwX2RwaV9jb25uZWN0b3JfZ2V0X2Jlc3RfZW5jb2Rl
ciwNCisJLmdldF9tb2RlcyA9IGxzN2ExMDAwX2RwaV9jb25uZWN0b3JfZ2V0X21vZGVzLA0KK307
DQorDQorc3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMNCitsczdhMTAwMF9kcGlfY29u
bmVjdG9yX2RldGVjdChzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNl
KQ0KK3sNCisJc3RydWN0IGkyY19hZGFwdGVyICpkZGMgPSBjb25uZWN0b3ItPmRkYzsNCisNCisJ
aWYgKGRkYykgew0KKwkJaWYgKGRybV9wcm9iZV9kZGMoZGRjKSkNCisJCQlyZXR1cm4gY29ubmVj
dG9yX3N0YXR1c19jb25uZWN0ZWQ7DQorDQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19kaXNj
b25uZWN0ZWQ7DQorCX0NCisNCisJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfdW5rbm93bjsNCit9
DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGxzN2ExMDAwX2Rw
aV9jb25uZWN0b3JfZnVuY3MgPSB7DQorCS5kZXRlY3QgPSBsczdhMTAwMF9kcGlfY29ubmVjdG9y
X2RldGVjdCwNCisJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0
b3JfbW9kZXMsDQorCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLA0KKwkucmVzZXQg
PSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfcmVzZXQsDQorCS5hdG9taWNfZHVwbGljYXRl
X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwNCisJ
LmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2Rlc3Ry
b3lfc3RhdGUNCit9Ow0KKw0KK3N0YXRpYyB2b2lkIGxzN2ExMDAwX3BpcGUwX2VuY29kZXJfcmVz
ZXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2Ug
KmRkZXYgPSBlbmNvZGVyLT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xz
ZGMoZGRldik7DQorDQorCS8qDQorCSAqIFdlIG5lZWQgdGhpcywgZm9yIFMzIHJlc3VtZSwgc2Ny
ZWVuIHdpbGwgbm90IGxpZ2h0dXAgaWYgZG9uJ3Qgc2V0DQorCSAqIGNvcnJlY3RseS4NCisJICov
DQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfUEFORUxfQ09ORl9SRUcsDQorCQkgICAg
UEhZX0NMT0NLX1BPTCB8IFBIWV9DTE9DS19FTiB8IFBIWV9EQVRBX0VOKTsNCit9DQorDQorc3Rh
dGljIHZvaWQgbHM3YTEwMDBfcGlwZTFfZW5jb2Rlcl9yZXNldChzdHJ1Y3QgZHJtX2VuY29kZXIg
KmVuY29kZXIpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29kZXItPmRldjsN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisNCisJLyoNCisJ
ICogV2UgbmVlZCB0aGlzLCBmb3IgUzMgcmVzdW1lLCBzY3JlZW4gd2lsbCBub3QgbGlnaHQgdXAN
CisJICogaWYgd2UgZG9uJ3Qgc2V0IHNldHRpbmcgdGhpcyByZWdpc3RlciBjb3JyZWN0bHkuDQor
CSAqLw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1BBTkVMX0NPTkZfUkVHLA0KKwkJ
ICAgIFBIWV9DTE9DS19QT0wgfCBQSFlfQ0xPQ0tfRU4gfCBQSFlfREFUQV9FTik7DQorfQ0KKw0K
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfZnVuY3MgbHM3YTEwMDBfZW5jb2Rlcl9m
dW5jc1syXSA9IHsNCisJew0KKwkJLnJlc2V0ID0gbHM3YTEwMDBfcGlwZTBfZW5jb2Rlcl9yZXNl
dCwNCisJCS5kZXN0cm95ID0gZHJtX2VuY29kZXJfY2xlYW51cCwNCisJfSwNCisJew0KKwkJLnJl
c2V0ID0gbHM3YTEwMDBfcGlwZTFfZW5jb2Rlcl9yZXNldCwNCisJCS5kZXN0cm95ID0gZHJtX2Vu
Y29kZXJfY2xlYW51cCwNCisJfSwNCit9Ow0KKw0KK2ludCBsczdhMTAwMF9vdXRwdXRfaW5pdChz
dHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpk
aXNwaXBlLA0KKwkJCSBzdHJ1Y3QgaTJjX2FkYXB0ZXIgKmRkYywNCisJCQkgdW5zaWduZWQgaW50
IGluZGV4KQ0KK3sNCisJc3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQgPSAmZGlzcGlwZS0+b3V0
cHV0Ow0KKwlzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIgPSAmb3V0cHV0LT5lbmNvZGVyOw0K
KwlzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yID0gJm91dHB1dC0+Y29ubmVjdG9yOw0K
KwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBkcm1fZW5jb2Rlcl9pbml0KGRkZXYsDQorCQkJICAgICAg
IGVuY29kZXIsDQorCQkJICAgICAgICZsczdhMTAwMF9lbmNvZGVyX2Z1bmNzW2luZGV4XSwNCisJ
CQkgICAgICAgRFJNX01PREVfRU5DT0RFUl9UTURTLA0KKwkJCSAgICAgICAiZW5jb2Rlci0ldSIs
DQorCQkJICAgICAgIGluZGV4KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWVu
Y29kZXItPnBvc3NpYmxlX2NydGNzID0gQklUKGluZGV4KTsNCisNCisJcmV0ID0gZHJtX2Nvbm5l
Y3Rvcl9pbml0X3dpdGhfZGRjKGRkZXYsDQorCQkJCQkgIGNvbm5lY3RvciwNCisJCQkJCSAgJmxz
N2ExMDAwX2RwaV9jb25uZWN0b3JfZnVuY3MsDQorCQkJCQkgIERSTV9NT0RFX0NPTk5FQ1RPUl9E
UEksDQorCQkJCQkgIGRkYyk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1f
aW5mbyhkZGV2LCAiZGlzcGxheSBwaXBlLSV1IGhhcyBhIERWT1xuIiwgaW5kZXgpOw0KKw0KKwlk
cm1fY29ubmVjdG9yX2hlbHBlcl9hZGQoY29ubmVjdG9yLCAmbHM3YTEwMDBfZHBpX2Nvbm5lY3Rv
cl9oZWxwZXJzKTsNCisNCisJZHJtX2Nvbm5lY3Rvcl9hdHRhY2hfZW5jb2Rlcihjb25uZWN0b3Is
IGVuY29kZXIpOw0KKw0KKwljb25uZWN0b3ItPnBvbGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9D
T05ORUNUIHwNCisJCQkgICAgRFJNX0NPTk5FQ1RPUl9QT0xMX0RJU0NPTk5FQ1Q7DQorDQorCWNv
bm5lY3Rvci0+aW50ZXJsYWNlX2FsbG93ZWQgPSAwOw0KKwljb25uZWN0b3ItPmRvdWJsZXNjYW5f
YWxsb3dlZCA9IDA7DQorDQorCXJldHVybiAwOw0KK30NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19vdXRwdXRfN2EyMDAwLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19vdXRwdXRfN2EyMDAwLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAw
MDAwMDAwMDAwMDAuLmNjYzM1MjgzZTFkYw0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0XzdhMjAwMC5jDQpAQCAtMCwwICsxLDUzMSBAQA0K
Ky8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQg
KEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQor
DQorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+DQorDQorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWlj
X2hlbHBlci5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisjaW5jbHVkZSA8ZHJt
L2RybV9lZGlkLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+DQorDQorI2lu
Y2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfb3V0cHV0LmgiDQorDQorc3RhdGlj
IGludCBsczdhMjAwMF9jb25uZWN0b3JfZ2V0X21vZGVzKHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IpDQorew0KKwl1bnNpZ25lZCBpbnQgbnVtID0gMDsNCisJc3RydWN0IGVkaWQgKmVk
aWQ7DQorDQorCWlmIChjb25uZWN0b3ItPmRkYykgew0KKwkJZWRpZCA9IGRybV9nZXRfZWRpZChj
b25uZWN0b3IsIGNvbm5lY3Rvci0+ZGRjKTsNCisJCWlmIChlZGlkKSB7DQorCQkJZHJtX2Nvbm5l
Y3Rvcl91cGRhdGVfZWRpZF9wcm9wZXJ0eShjb25uZWN0b3IsIGVkaWQpOw0KKwkJCW51bSA9IGRy
bV9hZGRfZWRpZF9tb2Rlcyhjb25uZWN0b3IsIGVkaWQpOw0KKwkJCWtmcmVlKGVkaWQpOw0KKwkJ
fQ0KKw0KKwkJcmV0dXJuIG51bTsNCisJfQ0KKw0KKwludW0gPSBkcm1fYWRkX21vZGVzX25vZWRp
ZChjb25uZWN0b3IsIDE5MjAsIDEyMDApOw0KKw0KKwlkcm1fc2V0X3ByZWZlcnJlZF9tb2RlKGNv
bm5lY3RvciwgMTAyNCwgNzY4KTsNCisNCisJcmV0dXJuIG51bTsNCit9DQorDQorc3RhdGljIHN0
cnVjdCBkcm1fZW5jb2RlciAqDQorbHM3YTIwMDBfY29ubmVjdG9yX2dldF9iZXN0X2VuY29kZXIo
c3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwNCisJCQkJICAgIHN0cnVjdCBkcm1fYXRv
bWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0ID0gY29u
bmVjdG9yX3RvX2xzZGNfb3V0cHV0KGNvbm5lY3Rvcik7DQorDQorCXJldHVybiAmb3V0cHV0LT5l
bmNvZGVyOw0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jb25uZWN0b3JfaGVscGVy
X2Z1bmNzIGxzN2EyMDAwX2Nvbm5lY3Rvcl9oZWxwZXJzID0gew0KKwkuYXRvbWljX2Jlc3RfZW5j
b2RlciA9IGxzN2EyMDAwX2Nvbm5lY3Rvcl9nZXRfYmVzdF9lbmNvZGVyLA0KKwkuZ2V0X21vZGVz
ID0gbHM3YTIwMDBfY29ubmVjdG9yX2dldF9tb2RlcywNCit9Ow0KKw0KKy8qIGRlYnVnZnMgKi8N
CisNCisjZGVmaW5lIExTRENfSERNSV9SRUcoaSwgcmVnKSB7ICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIFwNCisJLm5hbWUgPSBfX3N0cmluZ2lmeV8xKExTRENfSERNSSMjaSMjXyMjcmVn
IyNfUkVHKSwgICAgXA0KKwkub2Zmc2V0ID0gTFNEQ19IRE1JIyNpIyNfIyNyZWcjI19SRUcsICAg
ICAgICAgICAgICAgICBcDQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19yZWczMiBs
czdhMjAwMF9oZG1pMF9lbmNvZGVyX3JlZ3NbXSA9IHsNCisJTFNEQ19IRE1JX1JFRygwLCBaT05F
KSwNCisJTFNEQ19IRE1JX1JFRygwLCBJTlRGX0NUUkwpLA0KKwlMU0RDX0hETUlfUkVHKDAsIFBI
WV9DVFJMKSwNCisJTFNEQ19IRE1JX1JFRygwLCBQSFlfUExMKSwNCisJTFNEQ19IRE1JX1JFRygw
LCBBVklfSU5GT19DUlRMKSwNCisJTFNEQ19IRE1JX1JFRygwLCBQSFlfQ0FMKSwNCisJTFNEQ19I
RE1JX1JFRygwLCBBVURJT19QTExfTE8pLA0KKwlMU0RDX0hETUlfUkVHKDAsIEFVRElPX1BMTF9I
SSksDQorCXtOVUxMLCAwfSwgIC8qIE1VU1QgYmUge05VTEwsIDB9IHRlcm1pbmF0ZWQgKi8NCit9
Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19yZWczMiBsczdhMjAwMF9oZG1pMV9lbmNv
ZGVyX3JlZ3NbXSA9IHsNCisJTFNEQ19IRE1JX1JFRygxLCBaT05FKSwNCisJTFNEQ19IRE1JX1JF
RygxLCBJTlRGX0NUUkwpLA0KKwlMU0RDX0hETUlfUkVHKDEsIFBIWV9DVFJMKSwNCisJTFNEQ19I
RE1JX1JFRygxLCBQSFlfUExMKSwNCisJTFNEQ19IRE1JX1JFRygxLCBBVklfSU5GT19DUlRMKSwN
CisJTFNEQ19IRE1JX1JFRygxLCBQSFlfQ0FMKSwNCisJTFNEQ19IRE1JX1JFRygxLCBBVURJT19Q
TExfTE8pLA0KKwlMU0RDX0hETUlfUkVHKDEsIEFVRElPX1BMTF9ISSksDQorCXtOVUxMLCAwfSwg
IC8qIE1VU1QgYmUge05VTEwsIDB9IHRlcm1pbmF0ZWQgKi8NCit9Ow0KKw0KK3N0YXRpYyBpbnQg
bHM3YTIwMDBfaGRtaV9lbmNvZGVyX3JlZ3Nfc2hvdyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQg
KmRhdGEpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSA9IChzdHJ1Y3QgZHJtX2lu
Zm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gbm9kZS0+
bWlub3ItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsN
CisJY29uc3Qgc3RydWN0IGxzZGNfcmVnMzIgKnByZWc7DQorDQorCXByZWcgPSAoY29uc3Qgc3Ry
dWN0IGxzZGNfcmVnMzIgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisNCisJd2hpbGUgKHByZWct
Pm5hbWUpIHsNCisJCXUzMiBvZmZzZXQgPSBwcmVnLT5vZmZzZXQ7DQorDQorCQlzZXFfcHJpbnRm
KG0sICIlcyAoMHglMDR4KTogMHglMDh4XG4iLA0KKwkJCSAgIHByZWctPm5hbWUsIG9mZnNldCwg
bHNkY19ycmVnMzIobGRldiwgb2Zmc2V0KSk7DQorCQkrK3ByZWc7DQorCX0NCisNCisJcmV0dXJu
IDA7DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBsczdhMjAwMF9o
ZG1pMF9kZWJ1Z2ZzX2ZpbGVzW10gPSB7DQorCXsgInJlZ3MiLCBsczdhMjAwMF9oZG1pX2VuY29k
ZXJfcmVnc19zaG93LCAwLCAodm9pZCAqKWxzN2EyMDAwX2hkbWkwX2VuY29kZXJfcmVncyB9LA0K
K307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1faW5mb19saXN0IGxzN2EyMDAwX2hkbWkx
X2RlYnVnZnNfZmlsZXNbXSA9IHsNCisJeyAicmVncyIsIGxzN2EyMDAwX2hkbWlfZW5jb2Rlcl9y
ZWdzX3Nob3csIDAsICh2b2lkICopbHM3YTIwMDBfaGRtaTFfZW5jb2Rlcl9yZWdzIH0sDQorfTsN
CisNCitzdGF0aWMgdm9pZCBsczdhMjAwMF9oZG1pMF9sYXRlX3JlZ2lzdGVyKHN0cnVjdCBkcm1f
Y29ubmVjdG9yICpjb25uZWN0b3IsDQorCQkJCQkgc3RydWN0IGRlbnRyeSAqcm9vdCkNCit7DQor
CXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gY29ubmVjdG9yLT5kZXY7DQorCXN0cnVjdCBkcm1f
bWlub3IgKm1pbm9yID0gZGRldi0+cHJpbWFyeTsNCisNCisJZHJtX2RlYnVnZnNfY3JlYXRlX2Zp
bGVzKGxzN2EyMDAwX2hkbWkwX2RlYnVnZnNfZmlsZXMsDQorCQkJCSBBUlJBWV9TSVpFKGxzN2Ey
MDAwX2hkbWkwX2RlYnVnZnNfZmlsZXMpLA0KKwkJCQkgcm9vdCwNCisJCQkJIG1pbm9yKTsNCit9
DQorDQorc3RhdGljIHZvaWQgbHM3YTIwMDBfaGRtaTFfbGF0ZV9yZWdpc3RlcihzdHJ1Y3QgZHJt
X2Nvbm5lY3RvciAqY29ubmVjdG9yLA0KKwkJCQkJIHN0cnVjdCBkZW50cnkgKnJvb3QpDQorew0K
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGNvbm5lY3Rvci0+ZGV2Ow0KKwlzdHJ1Y3QgZHJt
X21pbm9yICptaW5vciA9IGRkZXYtPnByaW1hcnk7DQorDQorCWRybV9kZWJ1Z2ZzX2NyZWF0ZV9m
aWxlcyhsczdhMjAwMF9oZG1pMV9kZWJ1Z2ZzX2ZpbGVzLA0KKwkJCQkgQVJSQVlfU0laRShsczdh
MjAwMF9oZG1pMV9kZWJ1Z2ZzX2ZpbGVzKSwNCisJCQkJIHJvb3QsDQorCQkJCSBtaW5vcik7DQor
fQ0KKw0KKy8qIG1vbml0b3IgcHJlc2VudCBkZXRlY3Rpb24gKi8NCisNCitzdGF0aWMgZW51bSBk
cm1fY29ubmVjdG9yX3N0YXR1cw0KK2xzN2EyMDAwX2hkbWkwX3ZnYV9jb25uZWN0b3JfZGV0ZWN0
KHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsIGJvb2wgZm9yY2UpDQorew0KKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldiA9IGNvbm5lY3Rvci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3Jy
ZWczMihsZGV2LCBMU0RDX0hETUlfSFBEX1NUQVRVU19SRUcpOw0KKw0KKwlpZiAodmFsICYgSERN
STBfSFBEX0ZMQUcpDQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7DQorDQor
CWlmIChjb25uZWN0b3ItPmRkYykgew0KKwkJaWYgKGRybV9wcm9iZV9kZGMoY29ubmVjdG9yLT5k
ZGMpKQ0KKwkJCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Nvbm5lY3RlZDsNCisNCisJCXJldHVy
biBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsNCisJfQ0KKw0KKwlyZXR1cm4gY29ubmVj
dG9yX3N0YXR1c191bmtub3duOw0KK30NCisNCitzdGF0aWMgZW51bSBkcm1fY29ubmVjdG9yX3N0
YXR1cw0KK2xzN2EyMDAwX2hkbWkxX2Nvbm5lY3Rvcl9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0
b3IgKmNvbm5lY3RvciwgYm9vbCBmb3JjZSkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diA9IHRvX2xzZGMoY29ubmVjdG9yLT5kZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2Rj
X3JyZWczMihsZGV2LCBMU0RDX0hETUlfSFBEX1NUQVRVU19SRUcpOw0KKw0KKwlpZiAodmFsICYg
SERNSTFfSFBEX0ZMQUcpDQorCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7DQor
DQorCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX2Rpc2Nvbm5lY3RlZDsNCit9DQorDQorc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2Z1bmNzIGxzN2EyMDAwX2hkbWlfY29ubmVjdG9y
X2Z1bmNzWzJdID0gew0KKwl7DQorCQkuZGV0ZWN0ID0gbHM3YTIwMDBfaGRtaTBfdmdhX2Nvbm5l
Y3Rvcl9kZXRlY3QsDQorCQkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nv
bm5lY3Rvcl9tb2RlcywNCisJCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLA0KKwkJ
LnJlc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LA0KKwkJLmF0b21pY19k
dXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0
YXRlLA0KKwkJLmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVj
dG9yX2Rlc3Ryb3lfc3RhdGUsDQorCQkuZGVidWdmc19pbml0ID0gbHM3YTIwMDBfaGRtaTBfbGF0
ZV9yZWdpc3RlciwNCisJfSwNCisJew0KKwkJLmRldGVjdCA9IGxzN2EyMDAwX2hkbWkxX2Nvbm5l
Y3Rvcl9kZXRlY3QsDQorCQkuZmlsbF9tb2RlcyA9IGRybV9oZWxwZXJfcHJvYmVfc2luZ2xlX2Nv
bm5lY3Rvcl9tb2RlcywNCisJCS5kZXN0cm95ID0gZHJtX2Nvbm5lY3Rvcl9jbGVhbnVwLA0KKwkJ
LnJlc2V0ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LA0KKwkJLmF0b21pY19k
dXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9jb25uZWN0b3JfZHVwbGljYXRlX3N0
YXRlLA0KKwkJLmF0b21pY19kZXN0cm95X3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVj
dG9yX2Rlc3Ryb3lfc3RhdGUsDQorCQkuZGVidWdmc19pbml0ID0gbHM3YTIwMDBfaGRtaTFfbGF0
ZV9yZWdpc3RlciwNCisJfSwNCit9Ow0KKw0KKy8qIEV2ZW4gdGhvdWdoIHNvbWUgYm9hcmQgaGFz
IG9ubHkgb25lIGhkbWkgb24gZGlzcGxheSBwaXBlIDEsDQorICogV2Ugc3RpbGwgbmVlZCBob29r
IGxzZGNfZW5jb2Rlcl9mdW5jcyB1cCBvbiBkaXNwbGF5IHBpcGUgMCwNCisgKiBUaGlzIGlzIGJl
Y2F1c2Ugd2UgbmVlZCBpdHMgcmVzZXQoKSBjYWxsYmFjayBnZXQgY2FsbGVkLCB0bw0KKyAqIHNl
dCB0aGUgTFNEQ19IRE1JeF9DVFJMX1JFRyB1c2luZyBzb2Z0d2FyZSBncGlvIGVtdWxhdGVkIGky
Yy4NCisgKiBPdGhlcndpc2UsIHRoZSBmaXJtd2FyZSBtYXkgc2V0IExTRENfSERNSXhfQ1RSTF9S
RUcgYmxpbmRseS4NCisgKi8NCitzdGF0aWMgdm9pZCBsczdhMjAwMF9oZG1pMF9lbmNvZGVyX3Jl
c2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikNCit7DQorCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2ID0gZW5jb2Rlci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19s
c2RjKGRkZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBQSFlfQ0xPQ0tfUE9MIHwgUEhZX0NM
T0NLX0VOIHwgUEhZX0RBVEFfRU47DQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfUEFO
RUxfQ09ORl9SRUcsIHZhbCk7DQorDQorCS8qIHVzaW5nIHNvZnR3YXJlIGdwaW8gZW11bGF0ZWQg
aTJjICovDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfSERNSTBfSU5URl9DVFJMX1JF
Ryk7DQorCXZhbCAmPSB+SFdfSTJDX0VOOw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0hETUkw
X0lOVEZfQ1RSTF9SRUcsIHZhbCk7DQorDQorCS8qIGhlbHAgdGhlIGhkbWkgcGh5IHRvIGdldCBv
dXQgb2YgcmVzZXQgc3RhdGUgKi8NCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19IRE1JMF9QSFlf
Q1RSTF9SRUcsIEhETUlfUEhZX1JFU0VUX04pOw0KKw0KKwltZGVsYXkoMjApOw0KKw0KKwlkcm1f
ZGJnKGRkZXYsICJIRE1JLTAgUmVzZXRcbiIpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsczdhMjAw
MF9oZG1pMV9lbmNvZGVyX3Jlc2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikNCit7DQor
CXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gZW5jb2Rlci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19k
ZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBQSFlf
Q0xPQ0tfUE9MIHwgUEhZX0NMT0NLX0VOIHwgUEhZX0RBVEFfRU47DQorCWxzZGNfd3JlZzMyKGxk
ZXYsIExTRENfQ1JUQzFfUEFORUxfQ09ORl9SRUcsIHZhbCk7DQorDQorCS8qIHVzaW5nIHNvZnR3
YXJlIGdwaW8gZW11bGF0ZWQgaTJjICovDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENf
SERNSTFfSU5URl9DVFJMX1JFRyk7DQorCXZhbCAmPSB+SFdfSTJDX0VOOw0KKwlsc2RjX3dyZWcz
MihsZGV2LCBMU0RDX0hETUkxX0lOVEZfQ1RSTF9SRUcsIHZhbCk7DQorDQorCS8qICBoZWxwIHRo
ZSBoZG1pIHBoeSB0byBnZXQgb3V0IG9mIHJlc2V0IHN0YXRlICovDQorCWxzZGNfd3JlZzMyKGxk
ZXYsIExTRENfSERNSTFfUEhZX0NUUkxfUkVHLCBIRE1JX1BIWV9SRVNFVF9OKTsNCisNCisJbWRl
bGF5KDIwKTsNCisNCisJZHJtX2RiZyhkZGV2LCAiSERNSS0xIFJlc2V0XG4iKTsNCit9DQorDQor
c3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9mdW5jcyBsczdhMjAwMF9lbmNvZGVyX2Z1
bmNzWzJdID0gew0KKwl7DQorCQkucmVzZXQgPSBsczdhMjAwMF9oZG1pMF9lbmNvZGVyX3Jlc2V0
LA0KKwkJLmRlc3Ryb3kgPSBkcm1fZW5jb2Rlcl9jbGVhbnVwLA0KKwl9LA0KKwl7DQorCQkucmVz
ZXQgPSBsczdhMjAwMF9oZG1pMV9lbmNvZGVyX3Jlc2V0LA0KKwkJLmRlc3Ryb3kgPSBkcm1fZW5j
b2Rlcl9jbGVhbnVwLA0KKwl9LA0KK307DQorDQorc3RhdGljIGludCBsczdhMjAwMF9oZG1pX3Nl
dF9hdmlfaW5mb2ZyYW1lKHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwNCisJCQkJCSAgIHN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlKQ0KK3sNCisJc3RydWN0IGxzZGNfb3V0cHV0ICpv
dXRwdXQgPSBlbmNvZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlzdHJ1Y3QgbHNkY19k
aXNwbGF5X3BpcGUgKmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlzcGxheV9waXBlKG91dHB1dCk7DQor
CXVuc2lnbmVkIGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGRldiA9IGVuY29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9f
bHNkYyhkZGV2KTsNCisJc3RydWN0IGhkbWlfYXZpX2luZm9mcmFtZSBpbmZvZnJhbWU7DQorCXU4
IGJ1ZmZlcltIRE1JX0lORk9GUkFNRV9TSVpFKEFWSSldOw0KKwl1bnNpZ25lZCBjaGFyICpwdHIg
PSAmYnVmZmVyW0hETUlfSU5GT0ZSQU1FX0hFQURFUl9TSVpFXTsNCisJdW5zaWduZWQgaW50IGNv
bnRlbnQwLCBjb250ZW50MSwgY29udGVudDIsIGNvbnRlbnQzOw0KKwlpbnQgZXJyOw0KKw0KKwll
cnIgPSBkcm1faGRtaV9hdmlfaW5mb2ZyYW1lX2Zyb21fZGlzcGxheV9tb2RlKCZpbmZvZnJhbWUs
DQorCQkJCQkJICAgICAgICZvdXRwdXQtPmNvbm5lY3RvciwNCisJCQkJCQkgICAgICAgbW9kZSk7
DQorCWlmIChlcnIgPCAwKSB7DQorCQlkcm1fZXJyKGRkZXYsICJmYWlsZWQgdG8gc2V0dXAgQVZJ
IGluZm9mcmFtZTogJWRcbiIsIGVycik7DQorCQlyZXR1cm4gZXJyOw0KKwl9DQorDQorCS8qIEZp
eGVkIGluZm9mcmFtZSBjb25maWd1cmF0aW9uIG5vdCBsaW5rZWQgdG8gdGhlIG1vZGUgKi8NCisJ
aW5mb2ZyYW1lLmNvbG9yc3BhY2UgPSBIRE1JX0NPTE9SU1BBQ0VfUkdCOw0KKwlpbmZvZnJhbWUu
cXVhbnRpemF0aW9uX3JhbmdlID0gSERNSV9RVUFOVElaQVRJT05fUkFOR0VfREVGQVVMVDsNCisJ
aW5mb2ZyYW1lLmNvbG9yaW1ldHJ5ID0gSERNSV9DT0xPUklNRVRSWV9OT05FOw0KKw0KKwllcnIg
PSBoZG1pX2F2aV9pbmZvZnJhbWVfcGFjaygmaW5mb2ZyYW1lLCBidWZmZXIsIHNpemVvZihidWZm
ZXIpKTsNCisJaWYgKGVyciA8IDApIHsNCisJCWRybV9lcnIoZGRldiwgImZhaWxlZCB0byBwYWNr
IEFWSSBpbmZvZnJhbWU6ICVkXG4iLCBlcnIpOw0KKwkJCXJldHVybiBlcnI7DQorCX0NCisNCisJ
Y29udGVudDAgPSAqKHVuc2lnbmVkIGludCAqKXB0cjsNCisJY29udGVudDEgPSAqKHB0ciArIDQp
Ow0KKwljb250ZW50MiA9ICoodW5zaWduZWQgaW50ICopKHB0ciArIDUpOw0KKwljb250ZW50MyA9
ICoodW5zaWduZWQgaW50ICopKHB0ciArIDkpOw0KKw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYs
IExTRENfSERNSTBfQVZJX0NPTlRFTlQwLCBpbmRleCwgY29udGVudDApOw0KKwlsc2RjX3BpcGVf
d3JlZzMyKGxkZXYsIExTRENfSERNSTBfQVZJX0NPTlRFTlQxLCBpbmRleCwgY29udGVudDEpOw0K
Kwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfQVZJX0NPTlRFTlQyLCBpbmRleCwg
Y29udGVudDIpOw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfQVZJX0NPTlRF
TlQzLCBpbmRleCwgY29udGVudDMpOw0KKw0KKwlsc2RjX3BpcGVfd3JlZzMyKGxkZXYsIExTRENf
SERNSTBfQVZJX0lORk9fQ1JUTF9SRUcsIGluZGV4LA0KKwkJCSBBVklfUEtUX0VOQUJMRSB8IEFW
SV9QS1RfVVBEQVRFKTsNCisNCisJZHJtX2RiZyhkZGV2LCAiVXBkYXRlIEhETUktJXUgYXZpIGlu
Zm9mcmFtZVxuIiwgaW5kZXgpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQg
bHM3YTIwMDBfaGRtaV9hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIs
DQorCQkJCQkgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxz
ZGNfb3V0cHV0ICpvdXRwdXQgPSBlbmNvZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlz
dHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlzcGxheV9waXBl
KG91dHB1dCk7DQorCXVuc2lnbmVkIGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJdTMyIHZhbDsNCisNCisJLyogRGlzYWJsZSB0aGUg
aGRtaSBwaHkgKi8NCisJdmFsID0gbHNkY19waXBlX3JyZWczMihsZGV2LCBMU0RDX0hETUkwX1BI
WV9DVFJMX1JFRywgaW5kZXgpOw0KKwl2YWwgJj0gfkhETUlfUEhZX0VOOw0KKwlsc2RjX3BpcGVf
d3JlZzMyKGxkZXYsIExTRENfSERNSTBfUEhZX0NUUkxfUkVHLCBpbmRleCwgdmFsKTsNCisNCisJ
LyogRGlzYWJsZSB0aGUgaGRtaSBpbnRlcmZhY2UgKi8NCisJdmFsID0gbHNkY19waXBlX3JyZWcz
MihsZGV2LCBMU0RDX0hETUkwX0lOVEZfQ1RSTF9SRUcsIGluZGV4KTsNCisJdmFsICY9IH5IRE1J
X0lOVEVSRkFDRV9FTjsNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX0lOVEZf
Q1RSTF9SRUcsIGluZGV4LCB2YWwpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJIRE1JLSV1IGRpc2Fi
bGVkXG4iLCBpbmRleCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzN2EyMDAwX2hkbWlfYXRvbWlj
X2VuYWJsZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsDQorCQkJCQlzdHJ1Y3QgZHJtX2F0
b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29k
ZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJ
c3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQgPSBlbmNvZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29k
ZXIpOw0KKwlzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlz
cGxheV9waXBlKG91dHB1dCk7DQorCXVuc2lnbmVkIGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4
Ow0KKwl1MzIgdmFsOw0KKw0KKwkvKiBkYXRhc2hlZXQgc2F5IGl0IHNob3VsZCBsYXJnZXIgdGhh
biA0OCAqLw0KKwl2YWwgPSA2NCA8PCBIRE1JX0hfWk9ORV9JRExFX1NISUZUIHwgNjQgPDwgSERN
SV9WX1pPTkVfSURMRV9TSElGVDsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hE
TUkwX1pPTkVfUkVHLCBpbmRleCwgdmFsKTsNCisNCisJdmFsID0gSERNSV9QSFlfVEVSTV9TVEFU
VVMgfA0KKwkgICAgICBIRE1JX1BIWV9URVJNX0RFVF9FTiB8DQorCSAgICAgIEhETUlfUEhZX1RF
Uk1fSF9FTiB8DQorCSAgICAgIEhETUlfUEhZX1RFUk1fTF9FTiB8DQorCSAgICAgIEhETUlfUEhZ
X1JFU0VUX04gfA0KKwkgICAgICBIRE1JX1BIWV9FTjsNCisNCisJbHNkY19waXBlX3dyZWczMihs
ZGV2LCBMU0RDX0hETUkwX1BIWV9DVFJMX1JFRywgaW5kZXgsIHZhbCk7DQorDQorCXVkZWxheSgy
KTsNCisNCisJdmFsID0gSERNSV9DVExfUEVSSU9EX01PREUgfA0KKwkgICAgICBIRE1JX0FVRElP
X0VOIHwNCisJICAgICAgSERNSV9QQUNLRVRfRU4gfA0KKwkgICAgICBIRE1JX0lOVEVSRkFDRV9F
TiB8DQorCSAgICAgICg4IDw8IEhETUlfVklERU9fUFJFQU1CTEVfU0hJRlQpOw0KKw0KKwlsc2Rj
X3BpcGVfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfSU5URl9DVFJMX1JFRywgaW5kZXgsIHZhbCk7
DQorDQorCWRybV9kYmcoZGRldiwgIkhETUktJXUgZW5hYmxlZFxuIiwgaW5kZXgpOw0KK30NCisN
CisvKg0KKyAqICBGb3V0ID0gTSAqIEZpbg0KKyAqDQorICogIE0gPSAoNCAqIExGKSAvIChJREYg
KiBPREYpDQorICoNCisgKiAgSURGOiBJbnB1dCBEaXZpc2lvbiBGYWN0b3INCisgKiAgT0RGOiBP
dXRwdXQgRGl2aXNpb24gRmFjdG9yDQorICogICBMRjogTG9vcCBGYWN0b3INCisgKiAgICBNOiBS
ZXF1aXJlZCBNdWx0DQorICoNCisgKiAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KKyAqICB8ICAgICBGaW4gKGtIWikgICAgIHwgTSAg
fCBJREYgfCBMRiB8IE9ERiB8ICAgRm91dChNaHopICB8DQorICogIHwtLS0tLS0tLS0tLS0tLS0t
LS0tKy0tLS0rLS0tLS0rLS0tLSstLS0tLSstLS0tLS0tLS0tLS0tLXwNCisgKiAgfCAgMTcwMDAw
IH4gMzQwMDAwICB8IDEwIHwgMTYgIHwgNDAgfCAgMSAgfCAxNzAwIH4gMzQwMCAgfA0KKyAqICB8
ICAgODUwMDAgfiAxNzAwMDAgIHwgMTAgfCAgOCAgfCA0MCB8ICAyICB8ICA4NTAgfiAxNzAwICB8
DQorICogIHwgICA0MjUwMCB+ICA4NTAwMCAgfCAxMCB8ICA0ICB8IDQwIHwgIDQgIHwgIDQyNSB+
IDg1MCAgIHwNCisgKiAgfCAgIDIxMjUwIH4gIDQyNTAwICB8IDEwIHwgIDIgIHwgNDAgfCAgOCAg
fCAyMTIuNSB+IDQyNSAgfA0KKyAqICB8ICAgMjAwMDAgfiAgMjEyNTAgIHwgMTAgfCAgMSAgfCA0
MCB8IDE2ICB8ICAyMDAgfiAyMTIuNSB8DQorICogICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsNCisgKi8NCitzdGF0aWMgdm9pZCBsczdh
MjAwMF9oZG1pX3BoeV9wbGxfY29uZmlnKHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwNCisJCQkJ
CSBpbnQgZmluLA0KKwkJCQkJIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBkcm1f
ZGV2aWNlICpkZGV2ID0gJmxkZXYtPmJhc2U7DQorCWludCBjb3VudCA9IDA7DQorCXUzMiB2YWw7
DQorDQorCS8qIEZpcnN0bHksIGRpc2FibGUgcGh5IHBsbCAqLw0KKwlsc2RjX3BpcGVfd3JlZzMy
KGxkZXYsIExTRENfSERNSTBfUEhZX1BMTF9SRUcsIGluZGV4LCAweDApOw0KKw0KKwkvKg0KKwkg
KiBNb3N0IG9mIHRpbWUsIGxvb25nc29uIEhETUkgcmVxdWlyZSBNID0gMTANCisJICogZm9yIGV4
YW1wbGUsIDEwID0gKDQgKiA0MCkgLyAoOCAqIDIpDQorCSAqIGhlcmUsIHdyaXRlICIxIiB0byB0
aGUgT0RGIHdpbGwgZ2V0ICIyIg0KKwkgKi8NCisNCisJaWYgKGZpbiA+PSAxNzAwMDApDQorCQl2
YWwgPSAoMTYgPDwgSERNSV9QTExfSURGX1NISUZUKSB8DQorCQkgICAgICAoNDAgPDwgSERNSV9Q
TExfTEZfU0hJRlQpIHwNCisJCSAgICAgICgwIDw8IEhETUlfUExMX09ERl9TSElGVCk7DQorCWVs
c2UgaWYgKGZpbiA+PSA4NTAwMCkNCisJCXZhbCA9ICg4IDw8IEhETUlfUExMX0lERl9TSElGVCkg
fA0KKwkJICAgICAgKDQwIDw8IEhETUlfUExMX0xGX1NISUZUKSB8DQorCQkgICAgICAoMSA8PCBI
RE1JX1BMTF9PREZfU0hJRlQpOw0KKwllbHNlIGlmIChmaW4gPj0gNDI1MDApDQorCQl2YWwgPSAo
NCA8PCBIRE1JX1BMTF9JREZfU0hJRlQpIHwNCisJCSAgICAgICg0MCA8PCBIRE1JX1BMTF9MRl9T
SElGVCkgfA0KKwkJICAgICAgKDIgPDwgSERNSV9QTExfT0RGX1NISUZUKTsNCisJZWxzZSBpZiAg
KGZpbiA+PSAyMTI1MCkNCisJCXZhbCA9ICgyIDw8IEhETUlfUExMX0lERl9TSElGVCkgfA0KKwkJ
ICAgICAgKDQwIDw8IEhETUlfUExMX0xGX1NISUZUKSB8DQorCQkgICAgICAoMyA8PCBIRE1JX1BM
TF9PREZfU0hJRlQpOw0KKwllbHNlDQorCQl2YWwgPSAoMSA8PCBIRE1JX1BMTF9JREZfU0hJRlQp
IHwNCisJCSAgICAgICg0MCA8PCBIRE1JX1BMTF9MRl9TSElGVCkgfA0KKwkJICAgICAgKDQgPDwg
SERNSV9QTExfT0RGX1NISUZUKTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hE
TUkwX1BIWV9QTExfUkVHLCBpbmRleCwgdmFsKTsNCisNCisJdmFsIHw9IEhETUlfUExMX0VOQUJM
RTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX1BIWV9QTExfUkVHLCBp
bmRleCwgdmFsKTsNCisNCisJdWRlbGF5KDIpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJGaW4gb2Yg
SERNSS0ldTogJWQga0h6XG4iLCBpbmRleCwgZmluKTsNCisNCisJLyogV2FpdCBoZG1pIHBoeSBw
bGwgbG9jayAqLw0KKwlkbyB7DQorCQl2YWwgPSBsc2RjX3BpcGVfcnJlZzMyKGxkZXYsIExTRENf
SERNSTBfUEhZX1BMTF9SRUcsIGluZGV4KTsNCisNCisJCWlmICh2YWwgJiBIRE1JX1BMTF9MT0NL
RUQpIHsNCisJCQlkcm1fZGJnKGRkZXYsICJTZXR0aW5nIEhETUktJXUgUExMIHRha2UgJWQgY3lj
bGVzXG4iLA0KKwkJCQlpbmRleCwgY291bnQpOw0KKwkJCWJyZWFrOw0KKwkJfQ0KKwkJKytjb3Vu
dDsNCisJfSB3aGlsZSAoY291bnQgPCAxMDAwKTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2
LCBMU0RDX0hETUkwX1BIWV9DQUxfUkVHLCBpbmRleCwgMHgwZjAwMGZmMCk7DQorDQorCWlmIChj
b3VudCA+PSAxMDAwKQ0KKwkJZHJtX2VycihkZGV2LCAiU2V0dGluZyBIRE1JLSV1IFBMTCBmYWls
ZWRcbiIsIGluZGV4KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTIwMDBfaGRtaV9hdG9taWNf
bW9kZV9zZXQoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLA0KKwkJCQkJICBzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKmNydGNfc3RhdGUsDQorCQkJCQkgIHN0cnVjdCBkcm1fY29ubmVjdG9yX3N0
YXRlICpjb25uX3N0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQgPSBlbmNv
ZGVyX3RvX2xzZGNfb3V0cHV0KGVuY29kZXIpOw0KKwlzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUg
KmRpc3BpcGUgPSBvdXRwdXRfdG9fZGlzcGxheV9waXBlKG91dHB1dCk7DQorCXVuc2lnbmVkIGlu
dCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGVu
Y29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsN
CisJc3RydWN0IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Y19zdGF0ZS0+bW9kZTsNCisN
CisJbHM3YTIwMDBfaGRtaV9waHlfcGxsX2NvbmZpZyhsZGV2LCBtb2RlLT5jbG9jaywgaW5kZXgp
Ow0KKw0KKwlsczdhMjAwMF9oZG1pX3NldF9hdmlfaW5mb2ZyYW1lKGVuY29kZXIsIG1vZGUpOw0K
Kw0KKwlkcm1fZGJnKGRkZXYsICIlcyBtb2Rlc2V0IGZpbmlzaGVkXG4iLCBlbmNvZGVyLT5uYW1l
KTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZW5jb2Rlcl9oZWxwZXJfZnVuY3Mg
bHM3YTIwMDBfZW5jb2Rlcl9oZWxwZXJfZnVuY3MgPSB7DQorCS5hdG9taWNfZGlzYWJsZSA9IGxz
N2EyMDAwX2hkbWlfYXRvbWljX2Rpc2FibGUsDQorCS5hdG9taWNfZW5hYmxlID0gbHM3YTIwMDBf
aGRtaV9hdG9taWNfZW5hYmxlLA0KKwkuYXRvbWljX21vZGVfc2V0ID0gbHM3YTIwMDBfaGRtaV9h
dG9taWNfbW9kZV9zZXQsDQorfTsNCisNCisvKg0KKyAqIEZvciBMUzdBMjAwMDoNCisgKg0KKyAq
IDEpIE1vc3Qgb2YgYm9hcmQgZXhwb3J0IG9uZSB2Z2EgKyBoZG1pIG91dHB1dCBpbnRlcmZhY2Uu
DQorICogMikgWWV0LCBTb21lIGJvYXJkcyBleHBvcnQgZG91YmxlIGhkbWkgb3V0cHV0IGludGVy
ZmFjZS4NCisgKiAzKSBTdGlsbCBoYXZlIGJvYXJkcyBleHBvcnQgdGhyZWUgb3V0cHV0KDIgaGRt
aSArIDEgdmdhKS4NCisgKg0KKyAqIFNvIGxldCdzIGhvb2sgaGRtaSBoZWxwZXIgZnVuY3MgdG8g
YWxsIGRpc3BsYXkgcGlwZSwgZG9uJ3QgbWlzcy4NCisgKiB3cml0aW5nIGhkbWkgcmVnaXN0ZXIg
ZG8gbm8gaGFybXMuDQorICovDQoraW50IGxzN2EyMDAwX291dHB1dF9pbml0KHN0cnVjdCBkcm1f
ZGV2aWNlICpkZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUsDQor
CQkJIHN0cnVjdCBpMmNfYWRhcHRlciAqZGRjLA0KKwkJCSB1bnNpZ25lZCBpbnQgcGlwZSkNCit7
DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0ID0gJmRpc3BpcGUtPm91dHB1dDsNCisJc3Ry
dWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gJm91dHB1dC0+ZW5jb2RlcjsNCisJc3RydWN0IGRy
bV9jb25uZWN0b3IgKmNvbm5lY3RvciA9ICZvdXRwdXQtPmNvbm5lY3RvcjsNCisJaW50IHJldDsN
CisNCisJcmV0ID0gZHJtX2VuY29kZXJfaW5pdChkZGV2LA0KKwkJCSAgICAgICBlbmNvZGVyLA0K
KwkJCSAgICAgICAmbHM3YTIwMDBfZW5jb2Rlcl9mdW5jc1twaXBlXSwNCisJCQkgICAgICAgRFJN
X01PREVfRU5DT0RFUl9UTURTLA0KKwkJCSAgICAgICAiZW5jb2Rlci0ldSIsDQorCQkJICAgICAg
IHBpcGUpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZW5jb2Rlci0+cG9zc2li
bGVfY3J0Y3MgPSBCSVQocGlwZSk7DQorDQorCWRybV9lbmNvZGVyX2hlbHBlcl9hZGQoZW5jb2Rl
ciwgJmxzN2EyMDAwX2VuY29kZXJfaGVscGVyX2Z1bmNzKTsNCisNCisJcmV0ID0gZHJtX2Nvbm5l
Y3Rvcl9pbml0X3dpdGhfZGRjKGRkZXYsDQorCQkJCQkgIGNvbm5lY3RvciwNCisJCQkJCSAgJmxz
N2EyMDAwX2hkbWlfY29ubmVjdG9yX2Z1bmNzW3BpcGVdLA0KKwkJCQkJICBEUk1fTU9ERV9DT05O
RUNUT1JfSERNSUEsDQorCQkJCQkgIGRkYyk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0K
Kw0KKwlkcm1faW5mbyhkZGV2LCAiZGlzcGxheSBwaXBlLSV1IGhhcyBIRE1JICVzXG4iLCBwaXBl
LCBwaXBlID8gIiIgOiAiYW5kL29yIFZHQSIpOw0KKw0KKwlkcm1fY29ubmVjdG9yX2hlbHBlcl9h
ZGQoY29ubmVjdG9yLCAmbHM3YTIwMDBfY29ubmVjdG9yX2hlbHBlcnMpOw0KKw0KKwlkcm1fY29u
bmVjdG9yX2F0dGFjaF9lbmNvZGVyKGNvbm5lY3RvciwgZW5jb2Rlcik7DQorDQorCWNvbm5lY3Rv
ci0+cG9sbGVkID0gRFJNX0NPTk5FQ1RPUl9QT0xMX0NPTk5FQ1QgfA0KKwkJCSAgICBEUk1fQ09O
TkVDVE9SX1BPTExfRElTQ09OTkVDVDsNCisNCisJY29ubmVjdG9yLT5pbnRlcmxhY2VfYWxsb3dl
ZCA9IDA7DQorCWNvbm5lY3Rvci0+ZG91Ymxlc2Nhbl9hbGxvd2VkID0gMDsNCisNCisJcmV0dXJu
IDA7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3BpeHBs
bC5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmMNCm5ldyBmaWxlIG1v
ZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjAzNjRjNDk1ODVkYw0KLS0tIC9kZXYvbnVs
bA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmMNCkBAIC0wLDAg
KzEsNDgxIEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisvKg0KKyAq
IENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0
ZWQNCisgKi8NCisNCisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4NCisNCisjaW5jbHVkZSA8ZHJt
L2RybV9tYW5hZ2VkLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQorLyoNCisgKiBU
aGUgc3RydWN0dXJlIG9mIHRoZSBwaXhlbCBQTEwgcmVnaXN0ZXJzIGlzIGV2b2x2ZWQgd2l0aCB0
aW1lcywNCisgKiBpdCBjYW4gYmUgZGlmZmVyZW50IGFjcm9zcyBkaWZmZXJlbnQgY2hpcCBhbHNv
Lg0KKyAqLw0KKw0KKy8qIHNpemUgaXMgdTY0LCBub3RlIHRoYXQgYWxsIGxvb25nc29uJ3MgY3B1
IGlzIGxpdHRsZSBlbmRpYW4uDQorICogVGhpcyBzdHJ1Y3R1cmUgaXMgc2FtZSBmb3IgbHM3YTIw
MDAsIGxzN2ExMDAwIGFuZCBsczJrMjAwMC4NCisgKi8NCitzdHJ1Y3QgbHNkY19waXhwbGxfcmVn
IHsNCisJLyogQnl0ZSAwIH4gQnl0ZSAzICovDQorCXVuc2lnbmVkIGRpdl9vdXQgICAgICAgOiA3
OyAgIC8qICA2IDogMCAgICAgT3V0cHV0IGNsb2NrIGRpdmlkZXIgICovDQorCXVuc2lnbmVkIF9y
ZXNlcnZlZF8xXyAgOiAxNDsgIC8qIDIwIDogNyAgICAgICAgICAgICAgICAgICAgICAgICAgICov
DQorCXVuc2lnbmVkIGxvb3BjICAgICAgICAgOiA5OyAgIC8qIDI5IDogMjEgICAgQ2xvY2sgbXVs
dGlwbGllciAgICAgICovDQorCXVuc2lnbmVkIF9yZXNlcnZlZF8yXyAgOiAyOyAgIC8qIDMxIDog
MzAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorDQorCS8qIEJ5dGUgNCB+IEJ5dGUgNyAq
Lw0KKwl1bnNpZ25lZCBkaXZfcmVmICAgICAgIDogNzsgICAvKiAzOCA6IDMyICAgIElucHV0IGNs
b2NrIGRpdmlkZXIgICAqLw0KKwl1bnNpZ25lZCBsb2NrZWQgICAgICAgIDogMTsgICAvKiAzOSAg
ICAgICAgIFBMTCBsb2NrZWQgaW5kaWNhdG9yICAqLw0KKwl1bnNpZ25lZCBzZWxfb3V0ICAgICAg
IDogMTsgICAvKiA0MCAgICAgICAgIG91dHB1dCBjbGsgc2VsZWN0b3IgICAqLw0KKwl1bnNpZ25l
ZCBfcmVzZXJ2ZWRfM18gIDogMjsgICAvKiA0MiA6IDQxICAgICAgICAgICAgICAgICAgICAgICAg
ICAqLw0KKwl1bnNpZ25lZCBzZXRfcGFyYW0gICAgIDogMTsgICAvKiA0MyAgICAgICAgIFRyaWdn
ZXIgdGhlIHVwZGF0ZSAgICAqLw0KKwl1bnNpZ25lZCBieXBhc3MgICAgICAgIDogMTsgICAvKiA0
NCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1bnNpZ25lZCBwb3dlcmRvd24g
ICAgIDogMTsgICAvKiA0NSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1bnNp
Z25lZCBfcmVzZXJ2ZWRfNF8gIDogMTg7ICAvKiA0NiA6IDYzICAgIG5vIHVzZSAgICAgICAgICAg
ICAgICAqLw0KK307DQorDQordW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCB7DQorCXN0cnVj
dCBsc2RjX3BpeHBsbF9yZWcgYml0bWFwOw0KKwl1MzIgd1syXTsNCisJdTY0IGQ7DQorfTsNCisN
CitzdHJ1Y3QgY2xrX3RvX3BpeHBsbF9wYXJtc19sb29rdXBfdCB7DQorCXVuc2lnbmVkIGludCBj
bG9jazsgICAgICAgIC8qIGtIeiAqLw0KKw0KKwl1bnNpZ25lZCBzaG9ydCB3aWR0aDsNCisJdW5z
aWduZWQgc2hvcnQgaGVpZ2h0Ow0KKwl1bnNpZ25lZCBzaG9ydCB2cmVmcmVzaDsNCisNCisJLyog
U3RvcmVzIHBhcmFtZXRlcnMgZm9yIHByb2dyYW1taW5nIHRoZSBIYXJkd2FyZSBQTExzICovDQor
CXVuc2lnbmVkIHNob3J0IGRpdl9vdXQ7DQorCXVuc2lnbmVkIHNob3J0IGxvb3BjOw0KKwl1bnNp
Z25lZCBzaG9ydCBkaXZfcmVmOw0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBjbGtfdG9f
cGl4cGxsX3Bhcm1zX2xvb2t1cF90IHBpeHBsbF9wYXJtc190YWJsZVtdID0gew0KKwl7MTQ4NTAw
LCAxOTIwLCAxMDgwLCA2MCwgIDExLCA0OSwgIDN9LCAgIC8qIDE5MjB4MTA4MEA2MEh6ICovDQor
CXsxNDE3NTAsIDE5MjAsIDEwODAsIDYwLCAgMTEsIDc4LCAgNX0sICAgLyogMTkyMHgxMDgwQDYw
SHogKi8NCisJCQkJCQkgLyogMTkyMHgxMDgwQDUwSHogKi8NCisJezE3NDUwMCwgMTkyMCwgMTA4
MCwgNzUsICAxNywgODksICAzfSwgICAvKiAxOTIweDEwODBANzVIeiAqLw0KKwl7MTgxMjUwLCAy
NTYwLCAxMDgwLCA3NSwgIDgsICA1OCwgIDR9LCAgIC8qIDI1NjB4MTA4MEA3NUh6ICovDQorCXsy
OTcwMDAsIDI1NjAsIDEwODAsIDMwLCAgOCwgIDk1LCAgNH0sICAgLyogMzg0MHgyMTYwQDMwSHog
Ki8NCisJezMwMTk5MiwgMTkyMCwgMTA4MCwgMTAwLCAxMCwgMTUxLCA1fSwgICAvKiAxOTIweDEw
ODBAMTAwSHogKi8NCisJezE0NjI1MCwgMTY4MCwgMTA1MCwgNjAsICAxNiwgMTE3LCA1fSwgICAv
KiAxNjgweDEwNTBANjBIeiAqLw0KKwl7MTM1MDAwLCAxMjgwLCAxMDI0LCA3NSwgIDEwLCA1NCwg
IDR9LCAgIC8qIDEyODB4MTAyNEA3NUh6ICovDQorCXsxMTkwMDAsIDE2ODAsIDEwNTAsIDYwLCAg
MjAsIDExOSwgNX0sICAgLyogMTY4MHgxMDUwQDYwSHogKi8NCisJezEwODAwMCwgMTYwMCwgOTAw
LCAgNjAsICAxNSwgODEsICA1fSwgICAvKiAxNjAweDkwMEA2MEh6ICAqLw0KKwkJCQkJCSAvKiAx
MjgweDEwMjRANjBIeiAqLw0KKwkJCQkJCSAvKiAxMjgweDk2MEA2MEh6ICovDQorCQkJCQkJIC8q
IDExNTJ4ODY0QDc1SHogKi8NCisNCisJezEwNjUwMCwgMTQ0MCwgOTAwLCAgNjAsICAxOSwgODEs
ICA0fSwgICAvKiAxNDQweDkwMEA2MEh6ICovDQorCXs4ODc1MCwgIDE0NDAsIDkwMCwgIDYwLCAg
MTYsIDcxLCAgNX0sICAgLyogMTQ0MHg5MDBANjBIeiAqLw0KKwl7ODM1MDAsICAxMjgwLCA4MDAs
ICA2MCwgIDE3LCA3MSwgIDV9LCAgIC8qIDEyODB4ODAwQDYwSHogKi8NCisJezcxMDAwLCAgMTI4
MCwgODAwLCAgNjAsICAyMCwgNzEsICA1fSwgICAvKiAxMjgweDgwMEA2MEh6ICovDQorDQorCXs3
NDI1MCwgIDEyODAsIDcyMCwgIDYwLCAgMjIsIDQ5LCAgM30sICAgLyogMTI4MHg3MjBANjBIeiAq
Lw0KKwkJCQkJCSAvKiAxMjgweDcyMEA1MEh6ICovDQorDQorCXs3ODc1MCwgIDEwMjQsIDc2OCwg
IDc1LCAgMTYsIDYzLCAgNX0sICAgLyogMTAyNHg3NjhANzVIeiAqLw0KKwl7NzUwMDAsICAxMDI0
LCA3NjgsICA3MCwgIDI5LCA4NywgIDR9LCAgIC8qIDEwMjR4NzY4QDcwSHogKi8NCisJezY1MDAw
LCAgMTAyNCwgNzY4LCAgNjAsICAyMCwgMzksICAzfSwgICAvKiAxMDI0eDc2OEA2MEh6ICovDQor
DQorCXs1MTIwMCwgIDEwMjQsIDYwMCwgIDYwLCAgMjUsIDY0LCAgNX0sICAgLyogMTAyNHg2MDBA
NjBIeiAqLw0KKw0KKwl7NTcyODQsICA4MzIsICA2MjQsICA3NSwgIDI0LCA1NSwgIDR9LCAgIC8q
IDgzMng2MjRANzVIeiAqLw0KKwl7NDk1MDAsICA4MDAsICA2MDAsICA3NSwgIDQwLCA5OSwgIDV9
LCAgIC8qIDgwMHg2MDBANzVIeiAqLw0KKwl7NTAwMDAsICA4MDAsICA2MDAsICA3MiwgIDQ0LCA4
OCwgIDR9LCAgIC8qIDgwMHg2MDBANzJIeiAqLw0KKwl7NDAwMDAsICA4MDAsICA2MDAsICA2MCwg
IDMwLCAzNiwgIDN9LCAgIC8qIDgwMHg2MDBANjBIeiAqLw0KKwl7MzYwMDAsICA4MDAsICA2MDAs
ICA1NiwgIDUwLCA3MiwgIDR9LCAgIC8qIDgwMHg2MDBANTZIeiAqLw0KKwl7MzE1MDAsICA2NDAs
ICA0ODAsICA3NSwgIDQwLCA2MywgIDV9LCAgIC8qIDY0MHg0ODBANzVIeiAqLw0KKwkJCQkJCSAv
KiA2NDB4NDgwQDczSHogKi8NCisNCisJezMwMjQwLCAgNjQwLCAgNDgwLCAgNjcsICA2MiwgNzUs
ICA0fSwgICAvKiA2NDB4NDgwQDY3SHogKi8NCisJezI3MDAwLCAgNzIwLCAgNTc2LCAgNTAsICA1
MCwgNTQsICA0fSwgICAvKiA3MjB4NTc2QDYwSHogKi8NCisJezI1MTc1LCAgNjQwLCAgNDgwLCAg
NjAsICA4NSwgMTA3LCA1fSwgICAvKiA2NDB4NDgwQDYwSHogKi8NCisJezI1MjAwLCAgNjQwLCAg
NDgwLCAgNjAsICA1MCwgNjMsICA1fSwgICAvKiA2NDB4NDgwQDYwSHogKi8NCisJCQkJCQkgLyog
NzIweDQ4MEA2MEh6ICovDQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2RjX3BpeGVsX3BsbF9mcmVl
KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LCB2b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0IGxzZGNf
cGl4cGxsICp0aGlzID0gKHN0cnVjdCBsc2RjX3BpeHBsbCAqKWRhdGE7DQorDQorCWlvdW5tYXAo
dGhpcy0+bW1pbyk7DQorDQorCWtmcmVlKHRoaXMtPnByaXYpOw0KKw0KKwlkcm1fZGJnKGRkZXYs
ICJwaXhwbGwgcHJpdmF0ZSBkYXRhIGZyZWVkXG4iKTsNCit9DQorDQorLyoNCisgKiBpb3JlbWFw
IHRoZSBkZXZpY2UgZGVwZW5kZW50IFBMTCByZWdpc3RlcnMNCisgKg0KKyAqIEB0aGlzOiBwb2lu
dCB0byB0aGUgb2JqZWN0IHdoZXJlIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20NCisgKi8N
CitzdGF0aWMgaW50IGxzZGNfcGl4ZWxfcGxsX3NldHVwKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNv
bnN0IHRoaXMpDQorew0KKwlzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtczsNCisNCisJ
dGhpcy0+bW1pbyA9IGlvcmVtYXAodGhpcy0+cmVnX2Jhc2UsIHRoaXMtPnJlZ19zaXplKTsNCisJ
aWYgKElTX0VSUl9PUl9OVUxMKHRoaXMtPm1taW8pKQ0KKwkJcmV0dXJuIC1FTk9NRU07DQorDQor
CXBwYXJtcyA9IGt6YWxsb2Moc2l6ZW9mKCpwcGFybXMpLCBHRlBfS0VSTkVMKTsNCisJaWYgKElT
X0VSUl9PUl9OVUxMKHBwYXJtcykpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJcHBhcm1zLT5y
ZWZfY2xvY2sgPSBMU0RDX1BMTF9SRUZfQ0xLOw0KKw0KKwl0aGlzLT5wcml2ID0gcHBhcm1zOw0K
Kw0KKwlyZXR1cm4gZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0KHRoaXMtPmRkZXYsIGxzZGNfcGl4
ZWxfcGxsX2ZyZWUsIHRoaXMpOw0KK30NCisNCisvKg0KKyAqIEZpbmQgYSBzZXQgb2YgcGxsIHBh
cmFtZXRlcnMgZnJvbSBhIHN0YXRpYyBsb2NhbCB0YWJsZSB3aGljaCBhdm9pZA0KKyAqIGNvbXB1
dGluZyB0aGUgcGxsIHBhcmFtZXRlciBlYWNodGltZSBhIG1vZGVzZXQgaXMgdHJpZ2dlcmVkLg0K
KyAqDQorICogQHRoaXM6IHBvaW50IHRvIHRoZSBvYmplY3Qgd2hlcmUgdGhpcyBmdW5jdGlvbiBp
cyBjYWxsZWQgZnJvbQ0KKyAqIEBjbG9jazogdGhlIGRlc2lyZWQgb3V0cHV0IHBpeGVsIGNsb2Nr
LCB0aGUgdW5pdCBpcyBrSHoNCisgKiBAcG91dDogcG9pbnQgdG8gd2hlcmUgdGhlIHBhcmFtZXRl
cnMgdG8gc3RvcmUgaWYgZm91bmQNCisgKg0KKyAqIFJldHVybiAwIGlmIHN1Y2Nlc3MsIHJldHVy
biAtMSBpZiBub3QgZm91bmQuDQorICovDQorc3RhdGljIGludCBsc2RjX3BpeHBsbF9maW5kKHN0
cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJICAgIHVuc2lnbmVkIGludCBjbG9j
aywNCisJCQkgICAgc3RydWN0IGxzZGNfcGl4cGxsX3Bhcm1zICpwb3V0KQ0KK3sNCisJdW5zaWdu
ZWQgaW50IG51bSA9IEFSUkFZX1NJWkUocGl4cGxsX3Bhcm1zX3RhYmxlKTsNCisJY29uc3Qgc3Ry
dWN0IGNsa190b19waXhwbGxfcGFybXNfbG9va3VwX3QgKnB0Ow0KKwl1bnNpZ25lZCBpbnQgaTsN
CisNCisJZm9yIChpID0gMDsgaSA8IG51bTsgKytpKSB7DQorCQlwdCA9ICZwaXhwbGxfcGFybXNf
dGFibGVbaV07DQorDQorCQlpZiAoY2xvY2sgPT0gcHQtPmNsb2NrKSB7DQorCQkJcG91dC0+ZGl2
X3JlZiA9IHB0LT5kaXZfcmVmOw0KKwkJCXBvdXQtPmxvb3BjICAgPSBwdC0+bG9vcGM7DQorCQkJ
cG91dC0+ZGl2X291dCA9IHB0LT5kaXZfb3V0Ow0KKw0KKwkJCXJldHVybiAwOw0KKwkJfQ0KKwl9
DQorDQorCWRybV9kYmdfa21zKHRoaXMtPmRkZXYsICJwaXhlbCBjbG9jayAldTogbWlzc1xuIiwg
Y2xvY2spOw0KKw0KKwlyZXR1cm4gLTE7DQorfQ0KKw0KKy8qDQorICogRmluZCBhIHNldCBvZiBw
bGwgcGFyYW1ldGVycyB3aGljaCBoYXZlIG1pbmltYWwgZGlmZmVyZW5jZSB3aXRoIHRoZQ0KKyAq
IGRlc2lyZWQgcGl4ZWwgY2xvY2sgZnJlcXVlbmN5LiBJdCBkb2VzIHRoYXQgYnkgY29tcHV0aW5n
IGFsbCBvZiB0aGUNCisgKiBwb3NzaWJsZSBjb21iaW5hdGlvbi4gQ29tcHV0ZSB0aGUgZGlmZiBh
bmQgZmluZCB0aGUgY29tYmluYXRpb24gd2l0aA0KKyAqIG1pbmltYWwgZGlmZi4NCisgKg0KKyAq
IGNsb2NrX291dCA9IHJlZmNsayAvIGRpdl9yZWYgKiBsb29wYyAvIGRpdl9vdXQNCisgKg0KKyAq
IHJlZmNsayBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBvc2NpbGxhdG9yIG1vdW50ZWQgb24gbW90aGVy
Ym9hcmQoMTAwTUh6DQorICogaW4gYWxtb3N0IGFsbCBib2FyZCkNCisgKg0KKyAqIEB0aGlzOiBw
b2ludCB0byB0aGUgb2JqZWN0IGZyb20gd2hlcmUgdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQNCisg
KiBAY2xvY2s6IHRoZSBkZXNpcmVkIG91dHB1dCBwaXhlbCBjbG9jaywgdGhlIHVuaXQgaXMga0h6
DQorICogQHBvdXQ6IHBvaW50IHRvIHRoZSBvdXQgc3RydWN0IG9mIGxzZGNfcGl4cGxsX3Bhcm1z
DQorICoNCisgKiBSZXR1cm4gMCBpZiBhIHNldCBvZiBwYXJhbWV0ZXIgaXMgZm91bmQsIG90aGVy
d2lzZSByZXR1cm4gdGhlIGVycm9yDQorICogYmV0d2VlbiBjbG9ja19rSHogd2Ugd2FudGVkIGFu
ZCB0aGUgbW9zdCBjbG9zZXN0IGNhbmRpZGF0ZSB3aXRoIGl0Lg0KKyAqLw0KK3N0YXRpYyBpbnQg
bHNkY19waXhlbF9wbGxfY29tcHV0ZShzdHJ1Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0aGlzLA0K
KwkJCQkgIHVuc2lnbmVkIGludCBjbG9jaywNCisJCQkJICBzdHJ1Y3QgbHNkY19waXhwbGxfcGFy
bXMgKnBvdXQpDQorew0KKwlzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtcyA9IHRoaXMt
PnByaXY7DQorCXVuc2lnbmVkIGludCByZWZjbGsgPSBwcGFybXMtPnJlZl9jbG9jazsNCisJY29u
c3QgdW5zaWduZWQgaW50IHRvbGVyYW5jZSA9IDEwMDA7DQorCXVuc2lnbmVkIGludCBtaW4gPSB0
b2xlcmFuY2U7DQorCXVuc2lnbmVkIGludCBkaXZfb3V0LCBsb29wYywgZGl2X3JlZjsNCisJdW5z
aWduZWQgaW50IGNvbXB1dGVkOw0KKw0KKwlpZiAoIWxzZGNfcGl4cGxsX2ZpbmQodGhpcywgY2xv
Y2ssIHBvdXQpKQ0KKwkJcmV0dXJuIDA7DQorDQorCWZvciAoZGl2X291dCA9IDY7IGRpdl9vdXQg
PCA2NDsgZGl2X291dCsrKSB7DQorCQlmb3IgKGRpdl9yZWYgPSAzOyBkaXZfcmVmIDwgNjsgZGl2
X3JlZisrKSB7DQorCQkJZm9yIChsb29wYyA9IDY7IGxvb3BjIDwgMTYxOyBsb29wYysrKSB7DQor
CQkJCXVuc2lnbmVkIGludCBkaWZmID0gMDsNCisNCisJCQkJaWYgKGxvb3BjIDwgMTIgKiBkaXZf
cmVmKQ0KKwkJCQkJY29udGludWU7DQorCQkJCWlmIChsb29wYyA+IDMyICogZGl2X3JlZikNCisJ
CQkJCWNvbnRpbnVlOw0KKw0KKwkJCQljb21wdXRlZCA9IHJlZmNsayAvIGRpdl9yZWYgKiBsb29w
YyAvIGRpdl9vdXQ7DQorDQorCQkJCWlmIChjbG9jayA+PSBjb21wdXRlZCkNCisJCQkJCWRpZmYg
PSBjbG9jayAtIGNvbXB1dGVkOw0KKwkJCQllbHNlDQorCQkJCQlkaWZmID0gY29tcHV0ZWQgLSBj
bG9jazsNCisNCisJCQkJaWYgKGRpZmYgPCBtaW4pIHsNCisJCQkJCW1pbiA9IGRpZmY7DQorCQkJ
CQlwcGFybXMtPmRpdl9yZWYgPSBkaXZfcmVmOw0KKwkJCQkJcHBhcm1zLT5kaXZfb3V0ID0gZGl2
X291dDsNCisJCQkJCXBwYXJtcy0+bG9vcGMgPSBsb29wYzsNCisNCisJCQkJCWlmIChkaWZmID09
IDApIHsNCisJCQkJCQkqcG91dCA9ICpwcGFybXM7DQorCQkJCQkJcmV0dXJuIDA7DQorCQkJCQl9
DQorCQkJCX0NCisJCQl9DQorCQl9DQorCX0NCisNCisJLyogc3RpbGwgYWNjZXB0YWJsZSAqLw0K
KwlpZiAobWluIDwgdG9sZXJhbmNlKSB7DQorCQkqcG91dCA9ICpwcGFybXM7DQorCQlyZXR1cm4g
MDsNCisJfQ0KKw0KKwlkcm1fZGJnKHRoaXMtPmRkZXYsICJjYW4ndCBmaW5kIHN1aXRhYmxlIHBh
cmFtcyBmb3IgJXUga2h6XG4iLCBjbG9jayk7DQorDQorCXJldHVybiBtaW47DQorfQ0KKw0KKy8q
IFBpeGVsIHBsbCBoYXJkd2FyZSByZWxhdGVkIG9wcywgcGVyIGRpc3BsYXkgcGlwZSAqLw0KKw0K
K3N0YXRpYyB2b2lkIF9fcGl4cGxsX3JyZWcoc3RydWN0IGxzZGNfcGl4cGxsICp0aGlzLA0KKwkJ
CSAgdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCAqZHN0KQ0KK3sNCisjaWYgZGVmaW5lZChD
T05GSUdfNjRCSVQpDQorCWRzdC0+ZCA9IHJlYWRxKHRoaXMtPm1taW8pOw0KKyNlbHNlDQorCWRz
dC0+d1swXSA9IHJlYWRsKHRoaXMtPm1taW8pOw0KKwlkc3QtPndbMV0gPSByZWFkbCh0aGlzLT5t
bWlvICsgNCk7DQorI2VuZGlmDQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX3dyZWcoc3Ry
dWN0IGxzZGNfcGl4cGxsICp0aGlzLA0KKwkJCSAgdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1h
cCAqc3JjKQ0KK3sNCisjaWYgZGVmaW5lZChDT05GSUdfNjRCSVQpDQorCXdyaXRlcShzcmMtPmQs
IHRoaXMtPm1taW8pOw0KKyNlbHNlDQorCXdyaXRlbChzcmMtPndbMF0sIHRoaXMtPm1taW8pOw0K
Kwl3cml0ZWwoc3JjLT53WzFdLCB0aGlzLT5tbWlvICsgNCk7DQorI2VuZGlmDQorfQ0KKw0KK3N0
YXRpYyB2b2lkIF9fcGl4cGxsX29wc19wb3dlcnVwKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0
IHRoaXMpDQorew0KKwl1bmlvbiBsc2RjX3BpeHBsbF9yZWdfYml0bWFwIHBpeHBsbF9yZWc7DQor
DQorCV9fcGl4cGxsX3JyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KKw0KKwlwaXhwbGxfcmVnLmJp
dG1hcC5wb3dlcmRvd24gPSAwOw0KKw0KKwlfX3BpeHBsbF93cmVnKHRoaXMsICZwaXhwbGxfcmVn
KTsNCit9DQorDQorc3RhdGljIHZvaWQgX19waXhwbGxfb3BzX3Bvd2VyZG93bihzdHJ1Y3QgbHNk
Y19waXhwbGwgKiBjb25zdCB0aGlzKQ0KK3sNCisJdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1h
cCBwaXhwbGxfcmVnOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVnKTsNCisN
CisJcGl4cGxsX3JlZy5iaXRtYXAucG93ZXJkb3duID0gMTsNCisNCisJX19waXhwbGxfd3JlZyh0
aGlzLCAmcGl4cGxsX3JlZyk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29wc19vbihz
dHJ1Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0aGlzKQ0KK3sNCisJdW5pb24gbHNkY19waXhwbGxf
cmVnX2JpdG1hcCBwaXhwbGxfcmVnOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxf
cmVnKTsNCisNCisJcGl4cGxsX3JlZy5iaXRtYXAuc2VsX291dCA9IDE7DQorDQorCV9fcGl4cGxs
X3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9v
cHNfb2ZmKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpDQorew0KKwl1bmlvbiBsc2Rj
X3BpeHBsbF9yZWdfYml0bWFwIHBpeHBsbF9yZWc7DQorDQorCV9fcGl4cGxsX3JyZWcodGhpcywg
JnBpeHBsbF9yZWcpOw0KKw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5zZWxfb3V0ID0gMDsNCisNCisJ
X19waXhwbGxfd3JlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9f
cGl4cGxsX29wc19ieXBhc3Moc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQor
CXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxf
cnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLmJ5cGFzcyA9
IDE7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0
aWMgdm9pZCBfX3BpeHBsbF9vcHNfdW5ieXBhc3Moc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3Qg
dGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisN
CisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9yZWcuYml0
bWFwLmJ5cGFzcyA9IDA7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0K
K30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfdW50b2dnbGVfcGFyYW0oc3RydWN0IGxz
ZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRt
YXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQor
DQorCXBpeHBsbF9yZWcuYml0bWFwLnNldF9wYXJhbSA9IDA7DQorDQorCV9fcGl4cGxsX3dyZWco
dGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfc2V0
X3BhcmFtKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJCSAgIHN0cnVjdCBs
c2RjX3BpeHBsbF9wYXJtcyBjb25zdCAqcCkNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19i
aXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7
DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLmRpdl9yZWYgPSBwLT5kaXZfcmVmOw0KKwlwaXhwbGxf
cmVnLmJpdG1hcC5sb29wYyA9IHAtPmxvb3BjOw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5kaXZfb3V0
ID0gcC0+ZGl2X291dDsNCisNCisJX19waXhwbGxfd3JlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQor
fQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29wc190b2dnbGVfcGFyYW0oc3RydWN0IGxzZGNf
cGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAg
cGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQor
CXBpeHBsbF9yZWcuYml0bWFwLnNldF9wYXJhbSA9IDE7DQorDQorCV9fcGl4cGxsX3dyZWcodGhp
cywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfd2FpdF9s
b2NrZWQoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNf
cGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisJdW5zaWduZWQgaW50IGNvdW50ZXIgPSAw
Ow0KKw0KKwlkbyB7DQorCQlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVnKTsNCisNCisJ
CWlmIChwaXhwbGxfcmVnLmJpdG1hcC5sb2NrZWQpDQorCQkJYnJlYWs7DQorDQorCQkrK2NvdW50
ZXI7DQorCX0gd2hpbGUgKGNvdW50ZXIgPCAyMDAwKTsNCisNCisJZHJtX2RiZyh0aGlzLT5kZGV2
LCAiJXUgbG9vcCB3YWl0ZWRcbiIsIGNvdW50ZXIpOw0KK30NCisNCisvKg0KKyAqIFVwZGF0ZSB0
aGUgUExMIHBhcmFtZXRlcnMgdG8gdGhlIFBMTCBoYXJkd2FyZQ0KKyAqDQorICogQHRoaXM6IHBv
aW50IHRvIHRoZSBvYmplY3QgZnJvbSB3aGljaCB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZA0KKyAq
IEBwaW46IHBvaW50IHRvIHRoZSBzdHJ1Y3Qgb2YgbHNkY19waXhwbGxfcGFybXMgcGFzc2VkIGlu
DQorICoNCisgKiByZXR1cm4gMCBpZiBzdWNjZXNzZnVsLg0KKyAqLw0KK3N0YXRpYyBpbnQgbHNk
Y19waXhwbGxfdXBkYXRlKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJICAg
ICAgc3RydWN0IGxzZGNfcGl4cGxsX3Bhcm1zIGNvbnN0ICpwaW4pDQorew0KKwlfX3BpeHBsbF9v
cHNfYnlwYXNzKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfb2ZmKHRoaXMpOw0KKw0KKwlfX3Bp
eHBsbF9vcHNfcG93ZXJkb3duKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfdG9nZ2xlX3BhcmFt
KHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfc2V0X3BhcmFtKHRoaXMsIHBpbik7DQorDQorCV9f
cGl4cGxsX29wc191bnRvZ2dsZV9wYXJhbSh0aGlzKTsNCisNCisJX19waXhwbGxfb3BzX3Bvd2Vy
dXAodGhpcyk7DQorDQorCXVkZWxheSgyKTsNCisNCisJX19waXhwbGxfb3BzX3dhaXRfbG9ja2Vk
KHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfb24odGhpcyk7DQorDQorCV9fcGl4cGxsX29wc191
bmJ5cGFzcyh0aGlzKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB1bnNpZ25lZCBp
bnQgbHNkY19waXhwbGxfZ2V0X2ZyZXEoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykN
Cit7DQorCXN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcHBhciA9IHRoaXMtPnByaXY7DQorCXVu
aW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4X3BsbF9yZWc7DQorCXVuc2lnbmVkIGludCBm
cmVxOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhfcGxsX3JlZyk7DQorDQorCXBwYXIt
PmRpdl9yZWYgPSBwaXhfcGxsX3JlZy5iaXRtYXAuZGl2X3JlZjsNCisJcHBhci0+bG9vcGMgPSBw
aXhfcGxsX3JlZy5iaXRtYXAubG9vcGM7DQorCXBwYXItPmRpdl9vdXQgPSBwaXhfcGxsX3JlZy5i
aXRtYXAuZGl2X291dDsNCisNCisJZnJlcSA9IHBwYXItPnJlZl9jbG9jayAvIHBwYXItPmRpdl9y
ZWYgKiBwcGFyLT5sb29wYyAvIHBwYXItPmRpdl9vdXQ7DQorDQorCXJldHVybiBmcmVxOw0KK30N
CisNCitzdGF0aWMgdm9pZCBsc2RjX3BpeHBsbF9wcmludChzdHJ1Y3QgbHNkY19waXhwbGwgKiBj
b25zdCB0aGlzLA0KKwkJCSAgICAgIHN0cnVjdCBkcm1fcHJpbnRlciAqcCkNCit7DQorCXN0cnVj
dCBsc2RjX3BpeHBsbF9wYXJtcyAqcGFybXMgPSB0aGlzLT5wcml2Ow0KKw0KKwlkcm1fcHJpbnRm
KHAsICJkaXZfcmVmOiAldSwgbG9vcGM6ICV1LCBkaXZfb3V0OiAldVxuIiwNCisJCSAgIHBhcm1z
LT5kaXZfcmVmLCBwYXJtcy0+bG9vcGMsIHBhcm1zLT5kaXZfb3V0KTsNCit9DQorDQorLyoNCisg
KiBMUzdBMTAwMCwgTFM3QTIwMDAgYW5kIGxzMmsyMDAwJ3MgcGl4ZWwgcGxsIHNldHRpbmcgcmVn
aXN0ZXIgaXMgc2FtZSwNCisgKiB3ZSB0YWtlIHRoaXMgYXMgZGVmYXVsdCwgY3JlYXRlIGEgbmV3
IGluc3RhbmNlIGlmIGEgZGlmZmVyZW50IG1vZGVsIGlzDQorICogaW50cm9kdWNlZC4NCisgKi8N
CitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzIF9fcGl4cGxsX2RlZmF1bHRf
ZnVuY3MgPSB7DQorCS5zZXR1cCA9IGxzZGNfcGl4ZWxfcGxsX3NldHVwLA0KKwkuY29tcHV0ZSA9
IGxzZGNfcGl4ZWxfcGxsX2NvbXB1dGUsDQorCS51cGRhdGUgPSBsc2RjX3BpeHBsbF91cGRhdGUs
DQorCS5nZXRfcmF0ZSA9IGxzZGNfcGl4cGxsX2dldF9mcmVxLA0KKwkucHJpbnQgPSBsc2RjX3Bp
eHBsbF9wcmludCwNCit9Ow0KKw0KKy8qIHBpeGVsIHBsbCBpbml0aWFsaXphdGlvbiAqLw0KKw0K
K2ludCBsc2RjX3BpeHBsbF9pbml0KHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQor
CQkgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJICAgICB1bnNpZ25lZCBpbnQgaW5k
ZXgpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlj
b25zdCBzdHJ1Y3QgbHNkY19kZXNjICpkZXNjcCA9IGxkZXYtPmRlc2NwOw0KKwljb25zdCBzdHJ1
Y3QgbG9vbmdzb25fZ2Z4X2Rlc2MgKmdmeCA9IHRvX2xvb25nc29uX2dmeChkZXNjcCk7DQorDQor
CXRoaXMtPmRkZXYgPSBkZGV2Ow0KKwl0aGlzLT5yZWdfc2l6ZSA9IDg7DQorCXRoaXMtPnJlZ19i
YXNlID0gZ2Z4LT5jb25mX3JlZ19iYXNlICsgZ2Z4LT5waXhwbGxbaW5kZXhdLnJlZ19vZmZzZXQ7
DQorCXRoaXMtPmZ1bmNzID0gJl9fcGl4cGxsX2RlZmF1bHRfZnVuY3M7DQorDQorCXJldHVybiB0
aGlzLT5mdW5jcy0+c2V0dXAodGhpcyk7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX3BpeHBsbC5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
cGl4cGxsLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjA2ZWJj
ZGZjMTczMw0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfcGl4cGxsLmgNCkBAIC0wLDAgKzEsODYgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMCAqLw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hu
b2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5kZWYgX19MU0RDX1BJWFBM
TF9IX18NCisjZGVmaW5lIF9fTFNEQ19QSVhQTExfSF9fDQorDQorI2luY2x1ZGUgPGRybS9kcm1f
ZGV2aWNlLmg+DQorDQorLyoNCisgKiBMb29uZ3NvbiBQaXhlbCBQTEwgaGFyZHdhcmUgc3RydWN0
dXJlDQorICoNCisgKiByZWZjbGs6IHJlZmVyZW5jZSBmcmVxdWVuY3ksIDEwMCBNSHogZnJvbSBl
eHRlcm5hbCBvc2NpbGxhdG9yDQorICogb3V0Y2xrOiBvdXRwdXQgZnJlcXVlbmN5IGRlc2lyZWQu
DQorICoNCisgKg0KKyAqICAgICAgICAgICAgICAgTDEgICAgICAgRnJlZiAgICAgICAgICAgICAg
ICAgICAgICBGdmNvICAgICBMMg0KKyAqIHJlZmNsayAgICstLS0tLS0tLS0tLSsgICAgICArLS0t
LS0tLS0tLS0tLS0tLS0tKyAgICAgICstLS0tLS0tLS0rICAgb3V0Y2xrDQorICogLS0tKy0tLT4g
fCBQcmVzY2FsZXIgfCAtLS0+IHwgQ2xvY2sgTXVsdGlwbGllciB8IC0tLT4gfCBkaXZpZGVyIHwg
LS0tLS0tLS0+DQorICogICAgfCAgICAgKy0tLS0tLS0tLS0tKyAgICAgICstLS0tLS0tLS0tLS0t
LS0tLS0rICAgICAgKy0tLS0tLS0tLSsgICAgIF4NCisgKiAgICB8ICAgICAgICAgICBeICAgICAg
ICAgICAgICAgICAgICAgIF4gICAgICAgICAgICAgICAgICAgIF4gICAgICAgICAgfA0KKyAqICAg
IHwgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAg
fCAgICAgICAgICB8DQorICogICAgfCAgICAgICAgICAgfCAgICAgICAgICAgICAgICAgICAgICB8
ICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgIHwNCisgKiAgICB8ICAgICAgICBkaXZfcmVm
ICAgICAgICAgICAgICAgICBsb29wYyAgICAgICAgICAgICAgIGRpdl9vdXQgICAgICAgfA0KKyAq
ICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB8DQorICogICAgKy0tLS0gYnlwYXNzIChieXBhc3MgYWJvdmUgc29mdHdh
cmUgY29uZmlndXJhYmxlIGNsb2NrIGlmIHNldCkgLS0tLSsNCisgKg0KKyAqICAgb3V0Y2xrID0g
cmVmY2xrIC8gZGl2X3JlZiAqIGxvb3BjIC8gZGl2X291dDsNCisgKg0KKyAqICAgc2VsX291dDog
UExMIGNsb2NrIG91dHB1dCBzZWxlY3RvcihlbmFibGUpLg0KKyAqDQorICogICBJZiBzZWxfb3V0
ID09IDEsIHRoZW4gZW5hYmxlIG91dHB1dCBjbG9jayAodHVybiBPbik7DQorICogICBJZiBzZWxf
b3V0ID09IDAsIHRoZW4gZGlzYWJsZSBvdXRwdXQgY2xvY2sgKHR1cm4gT2ZmKTsNCisgKg0KKyAq
IFBMTCB3b3JraW5nIHJlcXVpcmVtZW50czoNCisgKg0KKyAqICAxKSAyMCBNSHogPD0gcmVmY2xr
IC8gZGl2X3JlZiA8PSA0ME1oeg0KKyAqICAyKSAxLjIgR0h6IDw9IHJlZmNsayAvZGl2X291dCAq
IGxvb3BjIDw9IDMuMiBHaHoNCisgKi8NCisNCitzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgew0K
Kwl1bnNpZ25lZCBpbnQgcmVmX2Nsb2NrOw0KKwl1bnNpZ25lZCBpbnQgZGl2X3JlZjsNCisJdW5z
aWduZWQgaW50IGxvb3BjOw0KKwl1bnNpZ25lZCBpbnQgZGl2X291dDsNCit9Ow0KKw0KK3N0cnVj
dCBsc2RjX3BpeHBsbDsNCisNCitzdHJ1Y3QgbHNkY19waXhwbGxfZnVuY3Mgew0KKwlpbnQgKCpz
ZXR1cCkoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcyk7DQorDQorCWludCAoKmNvbXB1
dGUpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICAgdW5zaWduZWQg
aW50IGNsb2NrLA0KKwkJICAgICAgIHN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcG91dCk7DQor
DQorCWludCAoKnVwZGF0ZSkoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcywNCisJCSAg
ICAgIHN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyBjb25zdCAqcGluKTsNCisNCisJdW5zaWduZWQg
aW50ICgqZ2V0X3JhdGUpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpOw0KKw0KKwl2
b2lkICgqcHJpbnQpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICBz
dHJ1Y3QgZHJtX3ByaW50ZXIgKnByaW50ZXIpOw0KK307DQorDQorc3RydWN0IGxzZGNfcGl4cGxs
IHsNCisJY29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpmdW5jczsNCisNCisJc3RydWN0
IGRybV9kZXZpY2UgKmRkZXY7DQorDQorCS8qIFBMTCByZWdpc3RlciBvZmZzZXQgKi8NCisJdTMy
IHJlZ19iYXNlOw0KKwkvKiBQTEwgcmVnaXN0ZXIgc2l6ZSBpbiBieXRlcyAqLw0KKwl1MzIgcmVn
X3NpemU7DQorDQorCXZvaWQgX19pb21lbSAqbW1pbzsNCisNCisJc3RydWN0IGxzZGNfcGl4cGxs
X3Bhcm1zICpwcml2Ow0KK307DQorDQoraW50IGxzZGNfcGl4cGxsX2luaXQoc3RydWN0IGxzZGNf
cGl4cGxsICogY29uc3QgdGhpcywNCisJCSAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQor
CQkgICAgIHVuc2lnbmVkIGludCBpbmRleCk7DQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGxhbmUuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29u
Z3Nvbi9sc2RjX3BsYW5lLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAw
MDAuLjZkMTQ0N2M3YmZmMQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfcGxhbmUuYw0KQEAgLTAsMCArMSw3ODEgQEANCisvLyBTUERYLUxpY2Vuc2Ut
SWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29u
IFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxsaW51
eC9kZWxheS5oPg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPg0KKyNpbmNsdWRlIDxk
cm0vZHJtX2F0b21pY19oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9mcmFtZWJ1ZmZlci5o
Pg0KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9hdG9taWNfaGVscGVyLmg+DQorI2luY2x1ZGUgPGRy
bS9kcm1fcGxhbmVfaGVscGVyLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1
ZGUgImxzZGNfcmVncy5oIg0KKyNpbmNsdWRlICJsc2RjX3R0bS5oIg0KKw0KK3N0YXRpYyBjb25z
dCB1MzIgbHNkY19wcmltYXJ5X2Zvcm1hdHNbXSA9IHsNCisJRFJNX0ZPUk1BVF9YUkdCODg4OCwN
Cit9Ow0KKw0KK3N0YXRpYyBjb25zdCB1MzIgbHNkY19jdXJzb3JfZm9ybWF0c1tdID0gew0KKwlE
Uk1fRk9STUFUX0FSR0I4ODg4LA0KK307DQorDQorc3RhdGljIGNvbnN0IHU2NCBsc2RjX2ZiX2Zv
cm1hdF9tb2RpZmllcnNbXSA9IHsNCisJRFJNX0ZPUk1BVF9NT0RfTElORUFSLA0KKwlEUk1fRk9S
TUFUX01PRF9JTlZBTElEDQorfTsNCisNCitzdGF0aWMgdW5zaWduZWQgaW50IGxzZGNfZ2V0X2Zi
X29mZnNldChzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwNCisJCQkJICAgICAgIHN0cnVjdCBk
cm1fcGxhbmVfc3RhdGUgKnN0YXRlKQ0KK3sNCisJdW5zaWduZWQgaW50IG9mZnNldCA9IGZiLT5v
ZmZzZXRzWzBdOw0KKw0KKwlvZmZzZXQgKz0gZmItPmZvcm1hdC0+Y3BwWzBdICogKHN0YXRlLT5z
cmNfeCA+PiAxNik7DQorCW9mZnNldCArPSBmYi0+cGl0Y2hlc1swXSAqIChzdGF0ZS0+c3JjX3kg
Pj4gMTYpOw0KKw0KKwlyZXR1cm4gb2Zmc2V0Ow0KK30NCisNCitzdGF0aWMgdTY0IGxzZGNfZmJf
YmFzZV9hZGRyKHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiKQ0KK3sNCisJc3RydWN0IGxzZGNf
ZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhmYi0+ZGV2KTsNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9
IGdlbV90b19sc2RjX2JvKGZiLT5vYmpbMF0pOw0KKw0KKwlyZXR1cm4gbHNkY19ib19ncHVfb2Zm
c2V0KGxibykgKyBsZGV2LT52cmFtX2Jhc2U7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19wcmlt
YXJ5X2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJICAgICBzdHJ1
Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRl
ICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUs
IHBsYW5lKTsNCisJc3RydWN0IGRybV9jcnRjICpjcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRj
Ow0KKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOw0KKw0KKwlpZiAoIWNy
dGMpDQorCQlyZXR1cm4gMDsNCisNCisJbmV3X2NydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9u
ZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7DQorDQorCXJldHVybiBkcm1fYXRvbWljX2hlbHBl
cl9jaGVja19wbGFuZV9zdGF0ZShuZXdfcGxhbmVfc3RhdGUsDQorCQkJCQkJICAgbmV3X2NydGNf
c3RhdGUsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgRFJNX1BM
QU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgZmFsc2UsDQorCQkJCQkJICAgdHJ1ZSk7DQorfQ0K
Kw0KK3N0YXRpYyB2b2lkIGxzZGNfcHJpbWFyeV9hdG9taWNfdXBkYXRlKHN0cnVjdCBkcm1fcGxh
bmUgKnBsYW5lLA0KKwkJCQkgICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0K
K3sNCisJc3RydWN0IGxzZGNfcHJpbWFyeSAqcHJpbWFyeSA9IHRvX2xzZGNfcHJpbWFyeShwbGFu
ZSk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX3ByaW1hcnlfcGxhbmVfb3BzICpvcHMgPSBwcmltYXJ5
LT5vcHM7DQorCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSA9IGRybV9h
dG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX3Bs
YW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3Rh
dGUoc3RhdGUsIHBsYW5lKTsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqbmV3X2ZiID0gbmV3
X3BsYW5lX3N0YXRlLT5mYjsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqb2xkX2ZiID0gb2xk
X3BsYW5lX3N0YXRlLT5mYjsNCisJdTY0IGZiX2FkZHIgPSBsc2RjX2ZiX2Jhc2VfYWRkcihuZXdf
ZmIpOw0KKw0KKwlmYl9hZGRyICs9IGxzZGNfZ2V0X2ZiX29mZnNldChuZXdfZmIsIG5ld19wbGFu
ZV9zdGF0ZSk7DQorDQorCWRybV9kYmcocGxhbmUtPmRldiwgImZiIGRtYSBhZGRyOiAlbGx4XG4i
LCBmYl9hZGRyKTsNCisNCisJb3BzLT51cGRhdGVfZmJfYWRkcihwcmltYXJ5LCBmYl9hZGRyKTsN
CisJb3BzLT51cGRhdGVfZmJfc3RyaWRlKHByaW1hcnksIG5ld19mYi0+cGl0Y2hlc1swXSk7DQor
DQorCWlmICghb2xkX2ZiIHx8IG9sZF9mYi0+Zm9ybWF0ICE9IG5ld19mYi0+Zm9ybWF0KQ0KKwkJ
b3BzLT51cGRhdGVfZmJfZm9ybWF0KHByaW1hcnksIG5ld19mYi0+Zm9ybWF0KTsNCit9DQorDQor
c3RhdGljIHZvaWQgbHNkY19wcmltYXJ5X2F0b21pY19kaXNhYmxlKHN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lLA0KKwkJCQkJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJLyog
RG8gbm90aGluZywganVzdCBwcmV2ZW50IGNhbGwgaW50byBhdG9taWNfdXBkYXRlKCkuDQorCSAq
IFdyaXRpbmcgdGhlIGZvcm1hdCBhcyBMU0RDX1BGX05PTkUgY2FuIGRpc2FibGUgdGhlIHByaW1h
cnksDQorCSAqIEJ1dCBpdCBzZWVtcyBub3QgbmVjZXNzYXJ5Li4uDQorCSAqLw0KKwlkcm1fZGJn
KHBsYW5lLT5kZXYsICIlcyBkaXNhYmxlZFxuIiwgcGxhbmUtPm5hbWUpOw0KK30NCisNCitzdGF0
aWMgaW50IGxzZGNfcGxhbmVfcHJlcGFyZV9mYihzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJ
CQkJIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19zdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiID0gbmV3X3N0YXRlLT5mYjsNCisJc3RydWN0IGxzZGNfYm8gKmxibzsN
CisJdTY0IGdwdV92YWRkcjsNCisJaW50IHJldDsNCisNCisJaWYgKCFmYikNCisJCXJldHVybiAw
Ow0KKw0KKwlsYm8gPSBnZW1fdG9fbHNkY19ibyhmYi0+b2JqWzBdKTsNCisNCisJcmV0ID0gbHNk
Y19ib19yZXNlcnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fZXJyKHBs
YW5lLT5kZXYsICJibyAlcCByZXNlcnZlIGZhaWxlZFxuIiwgbGJvKTsNCisJCXJldHVybiByZXQ7
DQorCX0NCisNCisJcmV0ID0gbHNkY19ib19waW4obGJvLCBMU0RDX0dFTV9ET01BSU5fVlJBTSwg
JmdwdV92YWRkcik7DQorDQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorDQorCWlmICh1bmxp
a2VseShyZXQpKSB7DQorCQlkcm1fZXJyKHBsYW5lLT5kZXYsICJibyAlcCBwaW4gZmFpbGVkXG4i
LCBsYm8pOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlsc2RjX2JvX3JlZihsYm8pOw0KKw0K
KwlpZiAocGxhbmUtPnR5cGUgIT0gRFJNX1BMQU5FX1RZUEVfQ1VSU09SKQ0KKwkJZHJtX2RiZyhw
bGFuZS0+ZGV2LA0KKwkJCSIlc1slcF0gcGluIGF0IDB4JWxseCwgYm8gc2l6ZTogJXp1XG4iLA0K
KwkJCXBsYW5lLT5uYW1lLCBsYm8sIGdwdV92YWRkciwgbHNkY19ib19zaXplKGxibykpOw0KKw0K
KwlyZXR1cm4gZHJtX2dlbV9wbGFuZV9oZWxwZXJfcHJlcGFyZV9mYihwbGFuZSwgbmV3X3N0YXRl
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19wbGFuZV9jbGVhbnVwX2ZiKHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lLA0KKwkJCQkgIHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSkN
Cit7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0gb2xkX3N0YXRlLT5mYjsNCisJc3Ry
dWN0IGxzZGNfYm8gKmxibzsNCisJaW50IHJldDsNCisNCisJaWYgKCFmYikNCisJCXJldHVybjsN
CisNCisJbGJvID0gZ2VtX3RvX2xzZGNfYm8oZmItPm9ialswXSk7DQorDQorCXJldCA9IGxzZGNf
Ym9fcmVzZXJ2ZShsYm8pOw0KKwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJZHJtX2VycihwbGFu
ZS0+ZGV2LCAiJXAgcmVzZXJ2ZSBmYWlsZWRcbiIsIGxibyk7DQorCQlyZXR1cm47DQorCX0NCisN
CisJbHNkY19ib191bnBpbihsYm8pOw0KKw0KKwlsc2RjX2JvX3VucmVzZXJ2ZShsYm8pOw0KKw0K
Kwlsc2RjX2JvX3VucmVmKGxibyk7DQorDQorCWlmIChwbGFuZS0+dHlwZSAhPSBEUk1fUExBTkVf
VFlQRV9DVVJTT1IpDQorCQlkcm1fZGJnKHBsYW5lLT5kZXYsICIlcyB1bnBpblxuIiwgcGxhbmUt
Pm5hbWUpOw0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wbGFuZV9oZWxwZXJfZnVu
Y3MgbHNkY19wcmltYXJ5X2hlbHBlcl9mdW5jcyA9IHsNCisJLnByZXBhcmVfZmIgPSBsc2RjX3Bs
YW5lX3ByZXBhcmVfZmIsDQorCS5jbGVhbnVwX2ZiID0gbHNkY19wbGFuZV9jbGVhbnVwX2ZiLA0K
KwkuYXRvbWljX2NoZWNrID0gbHNkY19wcmltYXJ5X2F0b21pY19jaGVjaywNCisJLmF0b21pY191
cGRhdGUgPSBsc2RjX3ByaW1hcnlfYXRvbWljX3VwZGF0ZSwNCisJLmF0b21pY19kaXNhYmxlID0g
bHNkY19wcmltYXJ5X2F0b21pY19kaXNhYmxlLA0KK307DQorDQorc3RhdGljIGludCBsc2RjX2N1
cnNvcl9wbGFuZV9hdG9taWNfYXN5bmNfY2hlY2soc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQor
CQkJCQkJc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGRybV9w
bGFuZV9zdGF0ZSAqbmV3X3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKmNydGNfc3Rh
dGU7DQorDQorCW5ld19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0ZShzdGF0
ZSwgcGxhbmUpOw0KKw0KKwlpZiAoIXBsYW5lLT5zdGF0ZSB8fCAhcGxhbmUtPnN0YXRlLT5mYikg
ew0KKwkJZHJtX2RiZyhwbGFuZS0+ZGV2LCAiJXM6IHN0YXRlIGlzIE5VTExcbiIsIHBsYW5lLT5u
YW1lKTsNCisJCXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCWlmIChzdGF0ZSkgew0KKwkJY3J0
Y19zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X2V4aXN0aW5nX2NydGNfc3RhdGUoc3RhdGUsIG5ld19z
dGF0ZS0+Y3J0Yyk7DQorCX0gZWxzZSB7DQorCQljcnRjX3N0YXRlID0gcGxhbmUtPmNydGMtPnN0
YXRlOw0KKwkJZHJtX2RiZyhwbGFuZS0+ZGV2LCAiJXM6IGF0b21pYyBzdGF0ZSBpcyBOVUxMXG4i
LCBwbGFuZS0+bmFtZSk7DQorCX0NCisNCisJaWYgKCFjcnRjX3N0YXRlLT5hY3RpdmUpDQorCQly
ZXR1cm4gLUVJTlZBTDsNCisNCisJaWYgKHBsYW5lLT5zdGF0ZS0+Y3J0YyAhPSBuZXdfc3RhdGUt
PmNydGMgfHwNCisJICAgIHBsYW5lLT5zdGF0ZS0+c3JjX3cgIT0gbmV3X3N0YXRlLT5zcmNfdyB8
fA0KKwkgICAgcGxhbmUtPnN0YXRlLT5zcmNfaCAhPSBuZXdfc3RhdGUtPnNyY19oIHx8DQorCSAg
ICBwbGFuZS0+c3RhdGUtPmNydGNfdyAhPSBuZXdfc3RhdGUtPmNydGNfdyB8fA0KKwkgICAgcGxh
bmUtPnN0YXRlLT5jcnRjX2ggIT0gbmV3X3N0YXRlLT5jcnRjX2gpDQorCQlyZXR1cm4gLUVJTlZB
TDsNCisNCisJcmV0dXJuIGRybV9hdG9taWNfaGVscGVyX2NoZWNrX3BsYW5lX3N0YXRlKHBsYW5l
LT5zdGF0ZSwNCisJCQkJCQkgICBjcnRjX3N0YXRlLA0KKwkJCQkJCSAgIERSTV9QTEFORV9OT19T
Q0FMSU5HLA0KKwkJCQkJCSAgIERSTV9QTEFORV9OT19TQ0FMSU5HLA0KKwkJCQkJCSAgIHRydWUs
DQorCQkJCQkJICAgdHJ1ZSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3Vyc29yX3BsYW5l
X2F0b21pY19hc3luY191cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJICBz
dHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJzb3Ig
KmN1cnNvciA9IHRvX2xzZGNfY3Vyc29yKHBsYW5lKTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3Vy
c29yX3BsYW5lX29wcyAqb3BzID0gY3Vyc29yLT5vcHM7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZm
ZXIgKm9sZF9mYiA9IHBsYW5lLT5zdGF0ZS0+ZmI7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIg
Km5ld19mYjsNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3N0YXRlOw0KKw0KKwluZXdf
c3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsNCisN
CisJbmV3X2ZiID0gcGxhbmUtPnN0YXRlLT5mYjsNCisNCisJcGxhbmUtPnN0YXRlLT5jcnRjX3gg
PSBuZXdfc3RhdGUtPmNydGNfeDsNCisJcGxhbmUtPnN0YXRlLT5jcnRjX3kgPSBuZXdfc3RhdGUt
PmNydGNfeTsNCisJcGxhbmUtPnN0YXRlLT5jcnRjX2ggPSBuZXdfc3RhdGUtPmNydGNfaDsNCisJ
cGxhbmUtPnN0YXRlLT5jcnRjX3cgPSBuZXdfc3RhdGUtPmNydGNfdzsNCisJcGxhbmUtPnN0YXRl
LT5zcmNfeCA9IG5ld19zdGF0ZS0+c3JjX3g7DQorCXBsYW5lLT5zdGF0ZS0+c3JjX3kgPSBuZXdf
c3RhdGUtPnNyY195Ow0KKwlwbGFuZS0+c3RhdGUtPnNyY19oID0gbmV3X3N0YXRlLT5zcmNfaDsN
CisJcGxhbmUtPnN0YXRlLT5zcmNfdyA9IG5ld19zdGF0ZS0+c3JjX3c7DQorCXN3YXAocGxhbmUt
PnN0YXRlLT5mYiwgbmV3X3N0YXRlLT5mYik7DQorDQorCWlmIChuZXdfc3RhdGUtPnZpc2libGUp
IHsNCisJCWVudW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6ZTsNCisNCisJCXN3aXRjaCAo
bmV3X3N0YXRlLT5jcnRjX3cpIHsNCisJCWNhc2UgNjQ6DQorCQkJY3Vyc29yX3NpemUgPSBDVVJT
T1JfU0laRV82NFg2NDsNCisJCQlicmVhazsNCisJCWNhc2UgMzI6DQorCQkJY3Vyc29yX3NpemUg
PSBDVVJTT1JfU0laRV8zMlgzMjsNCisJCQlicmVhazsNCisJCWRlZmF1bHQ6DQorCQkJY3Vyc29y
X3NpemUgPSBDVVJTT1JfU0laRV8zMlgzMjsNCisJCQlicmVhazsNCisJCX0NCisNCisJCW9wcy0+
dXBkYXRlX3Bvc2l0aW9uKGN1cnNvciwgbmV3X3N0YXRlLT5jcnRjX3gsIG5ld19zdGF0ZS0+Y3J0
Y195KTsNCisNCisJCW9wcy0+dXBkYXRlX2NmZyhjdXJzb3IsIGN1cnNvcl9zaXplLCBDVVJTT1Jf
Rk9STUFUX0FSR0I4ODg4KTsNCisNCisJCWlmICghb2xkX2ZiIHx8IG9sZF9mYiAhPSBuZXdfZmIp
DQorCQkJb3BzLT51cGRhdGVfYm9fYWRkcihjdXJzb3IsIGxzZGNfZmJfYmFzZV9hZGRyKG5ld19m
YikpOw0KKwl9DQorfQ0KKw0KKy8qIGxzN2ExMDAwIGN1cnNvciBwbGFuZSBoZWxwZXJzICovDQor
DQorc3RhdGljIGludCBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2NoZWNrKHN0cnVjdCBk
cm1fcGxhbmUgKnBsYW5lLA0KKwkJCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0
YXRlKQ0KK3sNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlOw0KKwlz
dHJ1Y3QgZHJtX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2NydGMg
KmNydGM7DQorDQorCW5ld19wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9z
dGF0ZShzdGF0ZSwgcGxhbmUpOw0KKw0KKwljcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjOw0K
KwlpZiAoIWNydGMpIHsNCisJCWRybV9kYmcocGxhbmUtPmRldiwgIiVzIGlzIG5vdCBiaW5kIHRv
IGEgY3J0Y1xuIiwgcGxhbmUtPm5hbWUpOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJaWYgKG5l
d19wbGFuZV9zdGF0ZS0+Y3J0Y193ID4gMzIgfHwgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX2ggPiAz
Mikgew0KKwkJZHJtX2RiZyhwbGFuZS0+ZGV2LCAiJXMgaXMgdG9vIGxhcmdlICV1eCV1XG4iLCBw
bGFuZS0+bmFtZSwNCisJCQluZXdfcGxhbmVfc3RhdGUtPmNydGNfdywgbmV3X3BsYW5lX3N0YXRl
LT5jcnRjX2gpOw0KKwkJcmV0dXJuIC1FSU5WQUw7DQorCX0NCisNCisJbmV3X2NydGNfc3RhdGUg
PSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7DQorDQorCXJldHVy
biBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9zdGF0ZShuZXdfcGxhbmVfc3RhdGUsDQor
CQkJCQkJICAgbmV3X2NydGNfc3RhdGUsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcs
DQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgdHJ1ZSwNCisJCQkJ
CQkgICB0cnVlKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTEwMDBfY3Vyc29yX3BsYW5lX2F0
b21pY191cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJc3RydWN0IGRybV9h
dG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3IgPSB0
b19sc2RjX2N1cnNvcihwbGFuZSk7DQorCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFu
ZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0K
KwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dl
dF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqbmV3X2ZiID0gbmV3X3BsYW5lX3N0YXRlLT5mYjsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZl
ciAqb2xkX2ZiID0gb2xkX3BsYW5lX3N0YXRlLT5mYjsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3Vy
c29yX3BsYW5lX29wcyAqb3BzID0gY3Vyc29yLT5vcHM7DQorCXU2NCBhZGRyID0gbHNkY19mYl9i
YXNlX2FkZHIobmV3X2ZiKTsNCisNCisJaWYgKCFuZXdfcGxhbmVfc3RhdGUtPnZpc2libGUpDQor
CQlyZXR1cm47DQorDQorCW9wcy0+dXBkYXRlX3Bvc2l0aW9uKGN1cnNvciwgbmV3X3BsYW5lX3N0
YXRlLT5jcnRjX3gsIG5ld19wbGFuZV9zdGF0ZS0+Y3J0Y195KTsNCisNCisJaWYgKCFvbGRfZmIg
fHwgb2xkX2ZiICE9IG5ld19mYikNCisJCW9wcy0+dXBkYXRlX2JvX2FkZHIoY3Vyc29yLCBhZGRy
KTsNCisNCisJb3BzLT51cGRhdGVfY2ZnKGN1cnNvciwgQ1VSU09SX1NJWkVfMzJYMzIsIENVUlNP
Ul9GT1JNQVRfQVJHQjg4ODgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsczdhMTAwMF9jdXJzb3Jf
cGxhbmVfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkJIHN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX2N1cnNvciAq
Y3Vyc29yID0gdG9fbHNkY19jdXJzb3IocGxhbmUpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19jdXJz
b3JfcGxhbmVfb3BzICpvcHMgPSBjdXJzb3ItPm9wczsNCisNCisJb3BzLT51cGRhdGVfY2ZnKGN1
cnNvciwgQ1VSU09SX1NJWkVfMzJYMzIsIENVUlNPUl9GT1JNQVRfRElTQUJMRSk7DQorfQ0KKw0K
K3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX3BsYW5lX2hlbHBlcl9mdW5jcyBsczdhMTAwMF9jdXJz
b3JfcGxhbmVfaGVscGVyX2Z1bmNzID0gew0KKwkucHJlcGFyZV9mYiA9IGxzZGNfcGxhbmVfcHJl
cGFyZV9mYiwNCisJLmNsZWFudXBfZmIgPSBsc2RjX3BsYW5lX2NsZWFudXBfZmIsDQorCS5hdG9t
aWNfY2hlY2sgPSBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2NoZWNrLA0KKwkuYXRvbWlj
X3VwZGF0ZSA9IGxzN2ExMDAwX2N1cnNvcl9wbGFuZV9hdG9taWNfdXBkYXRlLA0KKwkuYXRvbWlj
X2Rpc2FibGUgPSBsczdhMTAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2Rpc2FibGUsDQorCS5hdG9t
aWNfYXN5bmNfY2hlY2sgPSBsc2RjX2N1cnNvcl9wbGFuZV9hdG9taWNfYXN5bmNfY2hlY2ssDQor
CS5hdG9taWNfYXN5bmNfdXBkYXRlID0gbHNkY19jdXJzb3JfcGxhbmVfYXRvbWljX2FzeW5jX3Vw
ZGF0ZSwNCit9Ow0KKw0KKy8qIGxzN2EyMDAwIGN1cnNvciBwbGFuZSBoZWxwZXJzICovDQorDQor
c3RhdGljIGludCBsczdhMjAwMF9jdXJzb3JfcGxhbmVfYXRvbWljX2NoZWNrKHN0cnVjdCBkcm1f
cGxhbmUgKnBsYW5lLA0KKwkJCQkJICAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
KQ0KK3sNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlOw0KKwlzdHJ1
Y3QgZHJtX2NydGNfc3RhdGUgKm5ld19jcnRjX3N0YXRlOw0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNy
dGM7DQorDQorCW5ld19wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNfZ2V0X25ld19wbGFuZV9zdGF0
ZShzdGF0ZSwgcGxhbmUpOw0KKw0KKwljcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjOw0KKwlp
ZiAoIWNydGMpIHsNCisJCWRybV9kYmcocGxhbmUtPmRldiwgIiVzIGlzIG5vdCBiaW5kIHRvIGEg
Y3J0Y1xuIiwgcGxhbmUtPm5hbWUpOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJaWYgKG5ld19w
bGFuZV9zdGF0ZS0+Y3J0Y193ID4gNjQgfHwgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX2ggPiA2NCkg
ew0KKwkJZHJtX2RiZyhwbGFuZS0+ZGV2LCAiJXMgaXMgdG9vIGxhcmdlICV1eCV1XG4iLCBwbGFu
ZS0+bmFtZSwNCisJCQluZXdfcGxhbmVfc3RhdGUtPmNydGNfdywgbmV3X3BsYW5lX3N0YXRlLT5j
cnRjX2gpOw0KKwkJcmV0dXJuIC1FSU5WQUw7DQorCX0NCisNCisJbmV3X2NydGNfc3RhdGUgPSBk
cm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0Yyk7DQorDQorCXJldHVybiBk
cm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9zdGF0ZShuZXdfcGxhbmVfc3RhdGUsDQorCQkJ
CQkJICAgbmV3X2NydGNfc3RhdGUsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQor
CQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgdHJ1ZSwNCisJCQkJCQkg
ICB0cnVlKTsNCit9DQorDQorLyogdXBkYXRlIHRoZSBmb3JtYXQsIHNpemUgYW5kIGxvY2F0aW9u
IG9mIHRoZSBjdXJzb3IgKi8NCisNCitzdGF0aWMgdm9pZCBsczdhMjAwMF9jdXJzb3JfcGxhbmVf
YXRvbWljX3VwZGF0ZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJCQlzdHJ1Y3QgZHJt
X2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciA9
IHRvX2xzZGNfY3Vyc29yKHBsYW5lKTsNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqb2xkX3Bs
YW5lX3N0YXRlID0gZHJtX2F0b21pY19nZXRfb2xkX3BsYW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7
DQorCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm5ld19wbGFuZV9zdGF0ZSA9IGRybV9hdG9taWNf
Z2V0X25ld19wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpuZXdfZmIgPSBuZXdfcGxhbmVfc3RhdGUtPmZiOw0KKwlzdHJ1Y3QgZHJtX2ZyYW1lYnVm
ZmVyICpvbGRfZmIgPSBvbGRfcGxhbmVfc3RhdGUtPmZiOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19j
dXJzb3JfcGxhbmVfb3BzICpvcHMgPSBjdXJzb3ItPm9wczsNCisJdTY0IGFkZHIgPSBsc2RjX2Zi
X2Jhc2VfYWRkcihuZXdfZmIpOw0KKw0KKwlpZiAoIW5ld19wbGFuZV9zdGF0ZS0+dmlzaWJsZSkN
CisJCXJldHVybjsNCisNCisJb3BzLT51cGRhdGVfcG9zaXRpb24oY3Vyc29yLCBuZXdfcGxhbmVf
c3RhdGUtPmNydGNfeCwgbmV3X3BsYW5lX3N0YXRlLT5jcnRjX3kpOw0KKw0KKwlpZiAoIW9sZF9m
YiB8fCBuZXdfZmIgIT0gb2xkX2ZiKQ0KKwkJb3BzLT51cGRhdGVfYm9fYWRkcihjdXJzb3IsIGFk
ZHIpOw0KKw0KKwlvcHMtPnVwZGF0ZV9jZmcoY3Vyc29yLCBDVVJTT1JfU0laRV82NFg2NCwgQ1VS
U09SX0ZPUk1BVF9BUkdCODg4OCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzN2EyMDAwX2N1cnNv
cl9wbGFuZV9hdG9taWNfZGlzYWJsZShzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJCQkg
c3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29y
ICpjdXJzb3IgPSB0b19sc2RjX2N1cnNvcihwbGFuZSk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2N1
cnNvcl9wbGFuZV9vcHMgKmh3X29wcyA9IGN1cnNvci0+b3BzOw0KKw0KKwlod19vcHMtPnVwZGF0
ZV9jZmcoY3Vyc29yLCBDVVJTT1JfU0laRV82NFg2NCwgQ1VSU09SX0ZPUk1BVF9ESVNBQkxFKTsN
Cit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfaGVscGVyX2Z1bmNzIGxzN2Ey
MDAwX2N1cnNvcl9wbGFuZV9oZWxwZXJfZnVuY3MgPSB7DQorCS5wcmVwYXJlX2ZiID0gbHNkY19w
bGFuZV9wcmVwYXJlX2ZiLA0KKwkuY2xlYW51cF9mYiA9IGxzZGNfcGxhbmVfY2xlYW51cF9mYiwN
CisJLmF0b21pY19jaGVjayA9IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9hdG9taWNfY2hlY2ssDQor
CS5hdG9taWNfdXBkYXRlID0gbHM3YTIwMDBfY3Vyc29yX3BsYW5lX2F0b21pY191cGRhdGUsDQor
CS5hdG9taWNfZGlzYWJsZSA9IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9hdG9taWNfZGlzYWJsZSwN
CisJLmF0b21pY19hc3luY19jaGVjayA9IGxzZGNfY3Vyc29yX3BsYW5lX2F0b21pY19hc3luY19j
aGVjaywNCisJLmF0b21pY19hc3luY191cGRhdGUgPSBsc2RjX2N1cnNvcl9wbGFuZV9hdG9taWNf
YXN5bmNfdXBkYXRlLA0KK307DQorDQorc3RhdGljIHZvaWQgbHNkY19wbGFuZV9hdG9taWNfcHJp
bnRfc3RhdGUoc3RydWN0IGRybV9wcmludGVyICpwLA0KKwkJCQkJICBjb25zdCBzdHJ1Y3QgZHJt
X3BsYW5lX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiID0g
c3RhdGUtPmZiOw0KKwl1NjQgYWRkcjsNCisNCisJaWYgKCFmYikNCisJCXJldHVybjsNCisNCisJ
YWRkciA9IGxzZGNfZmJfYmFzZV9hZGRyKGZiKTsNCisNCisJZHJtX3ByaW50ZihwLCAiXHRkbWEg
YWRkcj0lbGx4XG4iLCBhZGRyKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fcGxh
bmVfZnVuY3MgbHNkY19wbGFuZV9mdW5jcyA9IHsNCisJLnVwZGF0ZV9wbGFuZSA9IGRybV9hdG9t
aWNfaGVscGVyX3VwZGF0ZV9wbGFuZSwNCisJLmRpc2FibGVfcGxhbmUgPSBkcm1fYXRvbWljX2hl
bHBlcl9kaXNhYmxlX3BsYW5lLA0KKwkuZGVzdHJveSA9IGRybV9wbGFuZV9jbGVhbnVwLA0KKwku
cmVzZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9yZXNldCwNCisJLmF0b21pY19kdXBsaWNh
dGVfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9kdXBsaWNhdGVfc3RhdGUsDQorCS5h
dG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX3BsYW5lX2Rlc3Ryb3lfc3Rh
dGUsDQorCS5hdG9taWNfcHJpbnRfc3RhdGUgPSBsc2RjX3BsYW5lX2F0b21pY19wcmludF9zdGF0
ZSwNCit9Ow0KKw0KKy8qIHByaW1hcnkgcGxhbmUgMCBoYXJkd2FyZSByZWxhdGVkIG9wcyAgKi8N
CisNCitzdGF0aWMgdm9pZCBsc2RjX3ByaW1hcnkwX3VwZGF0ZV9mYl9hZGRyKHN0cnVjdCBsc2Rj
X3ByaW1hcnkgKnByaW1hcnksIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICps
ZGV2ID0gcHJpbWFyeS0+bGRldjsNCisJdTMyIHN0YXR1czsNCisJdTMyIGxvLCBoaTsNCisNCisJ
LyogNDAtYml0IHdpZHRoIHBoeXNpY2FsIGFkZHJlc3MgYnVzICovDQorCWxvID0gYWRkciAmIDB4
RkZGRkZGRkY7DQorCWhpID0gKGFkZHIgPj4gMzIpICYgMHhGRjsNCisNCisJc3RhdHVzID0gbHNk
Y19ycmVnMzIobGRldiwgTFNEQ19DUlRDMF9DRkdfUkVHKTsNCisJaWYgKHN0YXR1cyAmIEZCX1JF
R19JTl9VU0lORykgew0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9GQjFfQUREUl9M
T19SRUcsIGxvKTsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfRkIxX0FERFJfSElf
UkVHLCBoaSk7DQorCX0gZWxzZSB7DQorCQlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX0ZC
MF9BRERSX0xPX1JFRywgbG8pOw0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9GQjBf
QUREUl9ISV9SRUcsIGhpKTsNCisJfQ0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3ByaW1hcnkw
X3VwZGF0ZV9mYl9zdHJpZGUoc3RydWN0IGxzZGNfcHJpbWFyeSAqcHJpbWFyeSwgdTMyIHN0cmlk
ZSkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHByaW1hcnktPmxkZXY7DQorDQor
CWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfU1RSSURFX1JFRywgc3RyaWRlKTsNCit9DQor
DQorc3RhdGljIHZvaWQgbHNkY19wcmltYXJ5MF91cGRhdGVfZmJfZm9ybWF0KHN0cnVjdCBsc2Rj
X3ByaW1hcnkgKnByaW1hcnksDQorCQkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZv
ICpmb3JtYXQpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBwcmltYXJ5LT5sZGV2
Ow0KKwl1MzIgc3RhdHVzOw0KKw0KKwlzdGF0dXMgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NS
VEMwX0NGR19SRUcpOw0KKw0KKwkvKg0KKwkgKiBUT0RPOiBhZGQgUkdCNTY1IHN1cHBvcnQsIG9u
bHkgc3VwcG9ydCBYUkJHODg4OCBhdCBwcmVzZW50DQorCSAqLw0KKwlzdGF0dXMgJj0gfkNGR19Q
SVhfRk1UX01BU0s7DQorCXN0YXR1cyB8PSBMU0RDX1BGX1hSR0I4ODg4Ow0KKw0KKwlsc2RjX3dy
ZWczMihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIHN0YXR1cyk7DQorDQorCXVkZWxheSg5KTsN
Cit9DQorDQorLyogcHJpbWFyeSBwbGFuZSAxIGhhcmR3YXJlIHJlbGF0ZWQgb3BzICovDQorDQor
c3RhdGljIHZvaWQgbHNkY19wcmltYXJ5MV91cGRhdGVfZmJfYWRkcihzdHJ1Y3QgbHNkY19wcmlt
YXJ5ICpwcmltYXJ5LCB1NjQgYWRkcikNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9
IHByaW1hcnktPmxkZXY7DQorCXUzMiBzdGF0dXM7DQorCXUzMiBsbywgaGk7DQorDQorCS8qIDQw
LWJpdCB3aWR0aCBwaHlzaWNhbCBhZGRyZXNzIGJ1cyAqLw0KKwlsbyA9IGFkZHIgJiAweEZGRkZG
RkZGOw0KKwloaSA9IChhZGRyID4+IDMyKSAmIDB4RkY7DQorDQorCXN0YXR1cyA9IGxzZGNfcnJl
ZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRyk7DQorCWlmIChzdGF0dXMgJiBGQl9SRUdfSU5f
VVNJTkcpIHsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFfRkIxX0FERFJfTE9fUkVH
LCBsbyk7DQorCQlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0ZCMV9BRERSX0hJX1JFRywg
aGkpOw0KKwl9IGVsc2Ugew0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMV9GQjBfQURE
Ul9MT19SRUcsIGxvKTsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzFfRkIwX0FERFJf
SElfUkVHLCBoaSk7DQorCX0NCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19wcmltYXJ5MV91cGRh
dGVfZmJfc3RyaWRlKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnByaW1hcnksIHUzMiBzdHJpZGUpDQor
ew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBwcmltYXJ5LT5sZGV2Ow0KKw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1NUUklERV9SRUcsIHN0cmlkZSk7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGxzZGNfcHJpbWFyeTFfdXBkYXRlX2ZiX2Zvcm1hdChzdHJ1Y3QgbHNkY19wcmlt
YXJ5ICpwcmltYXJ5LA0KKwkJCQkJICAgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9y
bWF0KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gcHJpbWFyeS0+bGRldjsNCisJ
dTMyIHN0YXR1czsNCisNCisJc3RhdHVzID0gbHNkY19ycmVnMzIobGRldiwgTFNEQ19DUlRDMV9D
RkdfUkVHKTsNCisNCisJLyoNCisJICogVE9ETzogYWRkIFJHQjU2NSBzdXBwb3J0LCBvbmx5IHN1
cHBvcnQgWFJCRzg4ODggYXQgcHJlc2VudA0KKwkgKi8NCisJc3RhdHVzICY9IH5DRkdfUElYX0ZN
VF9NQVNLOw0KKwlzdGF0dXMgfD0gTFNEQ19QRl9YUkdCODg4ODsNCisNCisJbHNkY193cmVnMzIo
bGRldiwgTFNEQ19DUlRDMV9DRkdfUkVHLCBzdGF0dXMpOw0KKw0KKwl1ZGVsYXkoOSk7DQorfQ0K
Kw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19wcmltYXJ5X3BsYW5lX29wcyBsc2RjX3ByaW1h
cnlfcGxhbmVfaHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBkYXRlX2ZiX2FkZHIgPSBsc2RjX3By
aW1hcnkwX3VwZGF0ZV9mYl9hZGRyLA0KKwkJLnVwZGF0ZV9mYl9zdHJpZGUgPSBsc2RjX3ByaW1h
cnkwX3VwZGF0ZV9mYl9zdHJpZGUsDQorCQkudXBkYXRlX2ZiX2Zvcm1hdCA9IGxzZGNfcHJpbWFy
eTBfdXBkYXRlX2ZiX2Zvcm1hdCwNCisJfSwNCisJew0KKwkJLnVwZGF0ZV9mYl9hZGRyID0gbHNk
Y19wcmltYXJ5MV91cGRhdGVfZmJfYWRkciwNCisJCS51cGRhdGVfZmJfc3RyaWRlID0gbHNkY19w
cmltYXJ5MV91cGRhdGVfZmJfc3RyaWRlLA0KKwkJLnVwZGF0ZV9mYl9mb3JtYXQgPSBsc2RjX3By
aW1hcnkxX3VwZGF0ZV9mYl9mb3JtYXQsDQorCX0sDQorfTsNCisNCisvKg0KKyAqIFVwZGF0ZSBs
b2NhdGlvbiwgZm9ybWF0LCBlbmFibGUgYW5kIGRpc2FibGUgc3RhdGUgb2YgdGhlIGN1cnNvciwN
CisgKiBGb3IgdGhvc2Ugd2hvIGhhdmUgdHdvIGhhcmR3YXJlIGN1cnNvciwgY3Vyc29yIDAgaXMg
YXR0YWNoIGl0IHRvIENSVEMtMCwNCisgKiBjdXJzb3IgMSBpcyBhdHRhY2hlZCB0byBDUlRDLTEu
IENvbXBvc2l0aW5nIHRoZSBwcmltYXJ5IGFuZCBjdXJzb3IgcGxhbmUNCisgKiBpcyBhdXRvbWF0
aWNhbGx5IGRvbmUgYnkgaGFyZHdhcmUsIHRoZSBjdXJzb3IgaXMgYWx3YXkgb24gdGhlIHRvcCBv
ZiB0aGUNCisgKiBwcmltYXJ5LiBJbiBvdGhlciB3b3JkLCB6LW9yZGVyIGlzIGZpeGVkIGluIGhh
cmR3YXJlIGFuZCBjYW5ub3QgYmUgY2hhbmdlZC4NCisgKiBGb3IgdGhvc2Ugb2xkIERDIHdobyBo
YXMgb25seSBvbmUgaGFyZHdhcmUgY3Vyc29yLCB3ZSBtYWRlIGl0IHNoYXJlZCBieQ0KKyAqIHRo
ZSB0d28gc2NyZWVuLCB0aGlzIHdvcmtzIG9uIGV4dGVuZCBzY3JlZW4gbW9kZS4NCisgKi8NCisN
CisvKiBjdXJzb3IgcGxhbmUgMCAoZm9yIHBpcGUgMCkgcmVsYXRlZCBoYXJkd2FyZSBvcHMgKi8N
CisNCitzdGF0aWMgdm9pZCBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIoc3RydWN0IGxzZGNf
Y3Vyc29yICpjdXJzb3IsIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2
ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwkvKiA0MC1iaXQgd2lkdGggcGh5c2ljYWwgYWRkcmVzcyBi
dXMgKi8NCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJfSElfUkVHLCAoYWRk
ciA+PiAzMikgJiAweEZGKTsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJf
TE9fUkVHLCBhZGRyKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IwX3VwZGF0ZV9w
b3NpdGlvbihzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwgaW50IHgsIGludCB5KQ0KK3sNCisJ
c3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwlpZiAoeCA8IDAp
DQorCQl4ID0gMDsNCisNCisJaWYgKHkgPCAwKQ0KKwkJeSA9IDA7DQorDQorCWxzZGNfd3JlZzMy
KGxkZXYsIExTRENfQ1VSU09SMF9QT1NJVElPTl9SRUcsICh5IDw8IDE2KSB8IHgpOw0KK30NCisN
CitzdGF0aWMgdm9pZCBsc2RjX2N1cnNvcjBfdXBkYXRlX2NmZyhzdHJ1Y3QgbHNkY19jdXJzb3Ig
KmN1cnNvciwNCisJCQkJICAgIGVudW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6ZSwNCisJ
CQkJICAgIGVudW0gbHNkY19jdXJzb3JfZm9ybWF0IGZtdCkNCit7DQorCXN0cnVjdCBsc2RjX2Rl
dmljZSAqbGRldiA9IGN1cnNvci0+bGRldjsNCisJdTMyIGNmZzsNCisNCisJY2ZnID0gQ1VSU09S
X09OX0NSVEMwIDw8IENVUlNPUl9MT0NBVElPTl9TSElGVCB8DQorCSAgICAgIGN1cnNvcl9zaXpl
IDw8IENVUlNPUl9TSVpFX1NISUZUIHwNCisJICAgICAgZm10IDw8IENVUlNPUl9GT1JNQVRfU0hJ
RlQ7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1VSU09SMF9DRkdfUkVHLCBjZmcpOw0K
K30NCisNCisvKiBjdXJzb3IgcGxhbmUgMSAoZm9yIHBpcGUgMSkgcmVsYXRlZCBoYXJkd2FyZSBv
cHMgKi8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2N1cnNvcjFfdXBkYXRlX2JvX2FkZHIoc3RydWN0
IGxzZGNfY3Vyc29yICpjdXJzb3IsIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwkvKiA0MC1iaXQgd2lkdGggcGh5c2ljYWwgYWRk
cmVzcyBidXMgKi8NCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IxX0FERFJfSElfUkVH
LCAoYWRkciA+PiAzMikgJiAweEZGKTsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1Ix
X0FERFJfTE9fUkVHLCBhZGRyKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IxX3Vw
ZGF0ZV9wb3NpdGlvbihzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwgaW50IHgsIGludCB5KQ0K
K3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwlpZiAo
eCA8IDApDQorCQl4ID0gMDsNCisNCisJaWYgKHkgPCAwKQ0KKwkJeSA9IDA7DQorDQorCWxzZGNf
d3JlZzMyKGxkZXYsIExTRENfQ1VSU09SMV9QT1NJVElPTl9SRUcsICh5IDw8IDE2KSB8IHgpOw0K
K30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2N1cnNvcjFfdXBkYXRlX2NmZyhzdHJ1Y3QgbHNkY19j
dXJzb3IgKmN1cnNvciwNCisJCQkJICAgIGVudW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6
ZSwNCisJCQkJICAgIGVudW0gbHNkY19jdXJzb3JfZm9ybWF0IGZtdCkNCit7DQorCXN0cnVjdCBs
c2RjX2RldmljZSAqbGRldiA9IGN1cnNvci0+bGRldjsNCisJdTMyIGNmZzsNCisNCisJY2ZnID0g
Q1VSU09SX09OX0NSVEMxIDw8IENVUlNPUl9MT0NBVElPTl9TSElGVCB8DQorCSAgICAgIGN1cnNv
cl9zaXplIDw8IENVUlNPUl9TSVpFX1NISUZUIHwNCisJICAgICAgZm10IDw8IENVUlNPUl9GT1JN
QVRfU0hJRlQ7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1VSU09SMV9DRkdfUkVHLCBj
ZmcpOw0KK30NCisNCisvKiBUaGUgaGFyZHdhcmUgY3Vyc29ycyBiZWNvbWUgbm9ybWFsIHNpbmNl
IGxzN2EyMDAwL2xzMmsyMDAwLCAgKi8NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfY3Vy
c29yX3BsYW5lX29wcyBsczdhMjAwMF9jdXJzb3JfaHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBk
YXRlX2JvX2FkZHIgPSBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIsDQorCQkudXBkYXRlX2Nm
ZyA9IGxzZGNfY3Vyc29yMF91cGRhdGVfY2ZnLA0KKwkJLnVwZGF0ZV9wb3NpdGlvbiA9IGxzZGNf
Y3Vyc29yMF91cGRhdGVfcG9zaXRpb24sDQorCX0sDQorCXsNCisJCS51cGRhdGVfYm9fYWRkciA9
IGxzZGNfY3Vyc29yMV91cGRhdGVfYm9fYWRkciwNCisJCS51cGRhdGVfY2ZnID0gbHNkY19jdXJz
b3IxX3VwZGF0ZV9jZmcsDQorCQkudXBkYXRlX3Bvc2l0aW9uID0gbHNkY19jdXJzb3IxX3VwZGF0
ZV9wb3NpdGlvbiwNCisJfSwNCit9Ow0KKw0KKy8qIHF1aXJrcyBmb3IgY3Vyc29yIDEsIG9ubHkg
Zm9yIG9sZCBsb29uZ3NvbiBkaXNwbGF5IGNvbnRyb2xsZXIgKi8NCisNCitzdGF0aWMgdm9pZCBs
c2RjX2N1cnNvcjFfdXBkYXRlX2JvX2FkZHJfcXVpcmsoc3RydWN0IGxzZGNfY3Vyc29yICpjdXJz
b3IsIHU2NCBhZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5s
ZGV2Ow0KKw0KKwkvKiA0MC1iaXQgd2lkdGggcGh5c2ljYWwgYWRkcmVzcyBidXMgKi8NCisJbHNk
Y193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJfSElfUkVHLCAoYWRkciA+PiAzMikgJiAw
eEZGKTsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX0FERFJfTE9fUkVHLCBhZGRy
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IxX3VwZGF0ZV9wb3NpdGlvbl9xdWly
ayhzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwgaW50IHgsIGludCB5KQ0KK3sNCisJc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKw0KKwlpZiAoeCA8IDApDQorCQl4
ID0gMDsNCisNCisJaWYgKHkgPCAwKQ0KKwkJeSA9IDA7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYs
IExTRENfQ1VSU09SMF9QT1NJVElPTl9SRUcsICh5IDw8IDE2KSB8IHgpOw0KK30NCisNCitzdGF0
aWMgdm9pZCBsc2RjX2N1cnNvcjFfdXBkYXRlX2NmZ19xdWlyayhzdHJ1Y3QgbHNkY19jdXJzb3Ig
KmN1cnNvciwNCisJCQkJCSAgZW51bSBsc2RjX2N1cnNvcl9zaXplIGN1cnNvcl9zaXplLA0KKwkJ
CQkJICBlbnVtIGxzZGNfY3Vyc29yX2Zvcm1hdCBmbXQpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSBjdXJzb3ItPmxkZXY7DQorCXUzMiBjZmc7DQorDQorCWNmZyA9IENVUlNPUl9P
Tl9DUlRDMSA8PCBDVVJTT1JfTE9DQVRJT05fU0hJRlQgfA0KKwkgICAgICBjdXJzb3Jfc2l6ZSA8
PCBDVVJTT1JfU0laRV9TSElGVCB8DQorCSAgICAgIGZtdCA8PCBDVVJTT1JfRk9STUFUX1NISUZU
Ow0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NVUlNPUjBfQ0ZHX1JFRywgY2ZnKTsNCit9
DQorDQorLyoNCisgKiBUaGUgdW5mb3JnaXZpbmcgTFM3QTEwMDAvTFMySzEwMDAgaGFzIG9ubHkg
b25lIGhhcmR3YXJlIGN1cnNvcnMgcGxhbmUNCisgKi8NCitzdGF0aWMgY29uc3Qgc3RydWN0IGxz
ZGNfY3Vyc29yX3BsYW5lX29wcyBsczdhMTAwMF9jdXJzb3JfaHdfb3BzWzJdID0gew0KKwl7DQor
CQkudXBkYXRlX2JvX2FkZHIgPSBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIsDQorCQkudXBk
YXRlX2NmZyA9IGxzZGNfY3Vyc29yMF91cGRhdGVfY2ZnLA0KKwkJLnVwZGF0ZV9wb3NpdGlvbiA9
IGxzZGNfY3Vyc29yMF91cGRhdGVfcG9zaXRpb24sDQorCX0sDQorCXsNCisJCS51cGRhdGVfYm9f
YWRkciA9IGxzZGNfY3Vyc29yMV91cGRhdGVfYm9fYWRkcl9xdWlyaywNCisJCS51cGRhdGVfY2Zn
ID0gbHNkY19jdXJzb3IxX3VwZGF0ZV9jZmdfcXVpcmssDQorCQkudXBkYXRlX3Bvc2l0aW9uID0g
bHNkY19jdXJzb3IxX3VwZGF0ZV9wb3NpdGlvbl9xdWlyaywNCisJfSwNCit9Ow0KKw0KK2ludCBs
c2RjX3ByaW1hcnlfcGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAg
c3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJICAgIHVuc2lnbmVkIGludCBpbmRleCkNCit7
DQorCXN0cnVjdCBsc2RjX3ByaW1hcnkgKnByaW1hcnkgPSB0b19sc2RjX3ByaW1hcnkocGxhbmUp
Ow0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoZGRldiwN
CisJCQkJICAgICAgIHBsYW5lLA0KKwkJCQkgICAgICAgMSA8PCBpbmRleCwNCisJCQkJICAgICAg
ICZsc2RjX3BsYW5lX2Z1bmNzLA0KKwkJCQkgICAgICAgbHNkY19wcmltYXJ5X2Zvcm1hdHMsDQor
CQkJCSAgICAgICBBUlJBWV9TSVpFKGxzZGNfcHJpbWFyeV9mb3JtYXRzKSwNCisJCQkJICAgICAg
IGxzZGNfZmJfZm9ybWF0X21vZGlmaWVycywNCisJCQkJICAgICAgIERSTV9QTEFORV9UWVBFX1BS
SU1BUlksDQorCQkJCSAgICAgICAicHJpbWFyeS0ldSIsDQorCQkJCSAgICAgICBpbmRleCk7DQor
CWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1fcGxhbmVfaGVscGVyX2FkZChwbGFu
ZSwgJmxzZGNfcHJpbWFyeV9oZWxwZXJfZnVuY3MpOw0KKw0KKwlwcmltYXJ5LT5sZGV2ID0gdG9f
bHNkYyhkZGV2KTsNCisJcHJpbWFyeS0+b3BzID0gJmxzZGNfcHJpbWFyeV9wbGFuZV9od19vcHNb
aW5kZXhdOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQoraW50IGxzN2ExMDAwX2N1cnNvcl9wbGFu
ZV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3Bs
YW5lICpwbGFuZSwNCisJCQkgICAgICAgdW5zaWduZWQgaW50IGluZGV4KQ0KK3sNCisJc3RydWN0
IGxzZGNfY3Vyc29yICpjdXJzb3IgPSB0b19sc2RjX2N1cnNvcihwbGFuZSk7DQorCWludCByZXQ7
DQorDQorCXJldCA9IGRybV91bml2ZXJzYWxfcGxhbmVfaW5pdChkZGV2LA0KKwkJCQkgICAgICAg
cGxhbmUsDQorCQkJCSAgICAgICAxIDw8IGluZGV4LA0KKwkJCQkgICAgICAgJmxzZGNfcGxhbmVf
ZnVuY3MsDQorCQkJCSAgICAgICBsc2RjX2N1cnNvcl9mb3JtYXRzLA0KKwkJCQkgICAgICAgQVJS
QVlfU0laRShsc2RjX2N1cnNvcl9mb3JtYXRzKSwNCisJCQkJICAgICAgIGxzZGNfZmJfZm9ybWF0
X21vZGlmaWVycywNCisJCQkJICAgICAgIERSTV9QTEFORV9UWVBFX0NVUlNPUiwNCisJCQkJICAg
ICAgICJjdXJzb3ItJXUiLA0KKwkJCQkgICAgICAgaW5kZXgpOw0KKwlpZiAocmV0KQ0KKwkJcmV0
dXJuIHJldDsNCisNCisJY3Vyc29yLT5sZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJY3Vyc29yLT5v
cHMgPSAmbHM3YTEwMDBfY3Vyc29yX2h3X29wc1tpbmRleF07DQorDQorCWRybV9wbGFuZV9oZWxw
ZXJfYWRkKHBsYW5lLCAmbHM3YTEwMDBfY3Vyc29yX3BsYW5lX2hlbHBlcl9mdW5jcyk7DQorDQor
CXJldHVybiAwOw0KK30NCisNCitpbnQgbHM3YTIwMDBfY3Vyc29yX3BsYW5lX2luaXQoc3RydWN0
IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0K
KwkJCSAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJzb3Ig
KmN1cnNvciA9IHRvX2xzZGNfY3Vyc29yKHBsYW5lKTsNCisJaW50IHJldDsNCisNCisJcmV0ID0g
ZHJtX3VuaXZlcnNhbF9wbGFuZV9pbml0KGRkZXYsDQorCQkJCSAgICAgICBwbGFuZSwNCisJCQkJ
ICAgICAgIDEgPDwgaW5kZXgsDQorCQkJCSAgICAgICAmbHNkY19wbGFuZV9mdW5jcywNCisJCQkJ
ICAgICAgIGxzZGNfY3Vyc29yX2Zvcm1hdHMsDQorCQkJCSAgICAgICBBUlJBWV9TSVpFKGxzZGNf
Y3Vyc29yX2Zvcm1hdHMpLA0KKwkJCQkgICAgICAgbHNkY19mYl9mb3JtYXRfbW9kaWZpZXJzLA0K
KwkJCQkgICAgICAgRFJNX1BMQU5FX1RZUEVfQ1VSU09SLA0KKwkJCQkgICAgICAgImN1cnNvci0l
dSIsDQorCQkJCSAgICAgICBpbmRleCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0K
KwljdXJzb3ItPmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwljdXJzb3ItPm9wcyA9ICZsczdhMjAw
MF9jdXJzb3JfaHdfb3BzW2luZGV4XTsNCisNCisJZHJtX3BsYW5lX2hlbHBlcl9hZGQocGxhbmUs
ICZsczdhMjAwMF9jdXJzb3JfcGxhbmVfaGVscGVyX2Z1bmNzKTsNCisNCisJcmV0dXJuIDA7DQor
fQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMgYi9k
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19wcm9iZS5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0
NA0KaW5kZXggMDAwMDAwMDAwMDAwLi40OGJhNjliYjhhOTgNCi0tLSAvZGV2L251bGwNCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMNCkBAIC0wLDAgKzEsNTYgQEAN
CisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsNCisvKg0KKyAqIENvcHlyaWdo
dCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8N
CisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisjaW5jbHVkZSAibHNkY19wcm9iZS5oIg0KKw0K
Ky8qDQorICogUHJvY2Vzc29yIElEIChpbXBsZW1lbnRhdGlvbikgdmFsdWVzIGZvciBiaXRzIDE1
Ojggb2YgdGhlIFBSSUQgcmVnaXN0ZXIuDQorICovDQorI2RlZmluZSBMT09OR1NPTl9DUFVfSU1Q
X01BU0sgICAgICAgICAgIDB4ZmYwMA0KKyNkZWZpbmUgTE9PTkdTT05fQ1BVX0lNUF9TSElGVCAg
ICAgICAgICA4DQorDQorI2RlZmluZSBMT09OR0FSQ0hfQ1BVX0lNUF9MUzJLMTAwMCAgICAgIDB4
YTANCisjZGVmaW5lIExPT05HQVJDSF9DUFVfSU1QX0xTMksyMDAwICAgICAgMHhiMA0KKyNkZWZp
bmUgTE9PTkdBUkNIX0NQVV9JTVBfTFMzQTUwMDAgICAgICAweGMwDQorDQorI2RlZmluZSBMT09O
R1NPTl9DUFVfTUlQU19JTVBfTFMySyAgICAgIDB4NjEgLyogTG9vbmdzb24gMksgTWlwcyBzZXJp
ZXMgU29DICovDQorDQorLyoNCisgKiBQYXJ0aWN1bGFyIFJldmlzaW9uIHZhbHVlcyBmb3IgYml0
cyA3OjAgb2YgdGhlIFBSSUQgcmVnaXN0ZXIuDQorICovDQorI2RlZmluZSBMT09OR1NPTl9DUFVf
UkVWX01BU0sgICAgICAgICAgIDB4MDBmZg0KKw0KKyNkZWZpbmUgTE9PTkdBUkNIX0NQVUNGR19Q
UklEX1JFRyAgICAgICAweDANCisNCisvKg0KKyAqIFdlIGNhbiBhY2hpZXZlIGZpbmUtZ3JhaW5l
ZCBjb250cm9sIHdpdGggdGhlIGluZm9ybWF0aW9uIGFib3V0IHRoZSBob3N0Lg0KKyAqLw0KKw0K
K3Vuc2lnbmVkIGludCBsb29uZ3Nvbl9jcHVfZ2V0X3ByaWQodTggKmltcCwgdTggKnJldikNCit7
DQorCXVuc2lnbmVkIGludCBwcmlkID0gMDsNCisNCisjaWYgZGVmaW5lZChfX2xvb25nYXJjaF9f
KQ0KKwlfX2FzbV9fIHZvbGF0aWxlKCJjcHVjZmcgJTAsICUxXG5cdCINCisJCQk6ICI9JnIiKHBy
aWQpDQorCQkJOiAiciIoTE9PTkdBUkNIX0NQVUNGR19QUklEX1JFRykNCisJCQkpOw0KKyNlbmRp
Zg0KKw0KKyNpZiBkZWZpbmVkKF9fbWlwc19fKQ0KKwlfX2FzbV9fIHZvbGF0aWxlKCJtZmMwXHQl
MCwgJDE1XG5cdCINCisJCQk6ICI9ciIgKHByaWQpDQorCQkJKTsNCisjZW5kaWYNCisNCisJaWYg
KGltcCkNCisJCSppbXAgPSAocHJpZCAmIExPT05HU09OX0NQVV9JTVBfTUFTSykgPj4gTE9PTkdT
T05fQ1BVX0lNUF9TSElGVDsNCisNCisJaWYgKHJldikNCisJCSpyZXYgPSBwcmlkICYgTE9PTkdT
T05fQ1BVX1JFVl9NQVNLOw0KKw0KKwlyZXR1cm4gcHJpZDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuaCBiL2RyaXZlcnMvZ3B1L2RybS9sb29u
Z3Nvbi9sc2RjX3Byb2JlLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAw
MDAuLjdhOTZiZWM0OWFiOQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfcHJvYmUuaA0KQEAgLTAsMCArMSwxMiBAQA0KKy8qIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdz
b24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xT
RENfUFJPQkVfSF9fDQorI2RlZmluZSBfX0xTRENfUFJPQkVfSF9fDQorDQorLyogSGVscGVycyBm
b3IgY2hpcCBkZXRlY3Rpb24gKi8NCit1bnNpZ25lZCBpbnQgbG9vbmdzb25fY3B1X2dldF9wcmlk
KHU4ICppbXBsLCB1OCAqcmV2KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19yZWdzLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19yZWdzLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjMwZmYw
NDUwZGRjZA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xz
ZGNfcmVncy5oDQpAQCAtMCwwICsxLDQwMiBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVy
OiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5v
bG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfUkVHU19I
X18NCisjZGVmaW5lIF9fTFNEQ19SRUdTX0hfXw0KKw0KKyNpbmNsdWRlIDxsaW51eC9iaXRvcHMu
aD4NCisjaW5jbHVkZSA8bGludXgvdHlwZXMuaD4NCisNCisvKg0KKyAqIFBJWEVMIFBMTCBSZWZl
cmVuY2UgY2xvY2sNCisgKi8NCisjZGVmaW5lIExTRENfUExMX1JFRl9DTEsgICAgICAgICAgICAg
ICAgMTAwMDAwICAgICAgICAgICAvKiBrSHogKi8NCisNCisvKg0KKyAqIFRob3NlIFBMTCByZWdp
c3RlcnMgYXJlIHJlbGF0aXZlIHRvIExTeHh4eHhfQ0ZHX1JFR19CQVNFLiB4eHh4eCA9IDdBMTAw
MCwNCisgKiA3QTIwMDAsIDJLMjAwMCwgMksxMDAwIGV0Yy4NCisgKi8NCisNCisvKiBMUzdBMTAw
MCAqLw0KKw0KKyNkZWZpbmUgTFM3QTEwMDBfUElYUExMMF9SRUcgICAgICAgICAgICAweDA0QjAN
CisjZGVmaW5lIExTN0ExMDAwX1BJWFBMTDFfUkVHICAgICAgICAgICAgMHgwNEMwDQorDQorLyog
VGhlIERDLCBHUFUsIEdyYXBoaWMgTWVtb3J5IENvbnRyb2xsZXIgc2hhcmUgdGhlIHNpbmdsZSBn
ZnhwbGwgKi8NCisjZGVmaW5lIExTN0ExMDAwX1BMTF9HRlhfUkVHICAgICAgICAgICAgMHgwNDkw
DQorDQorI2RlZmluZSBMUzdBMTAwMF9DT05GX1JFR19CQVNFICAgICAgICAgIDB4MTAwMTAwMDAN
CisNCisvKiBMUzdBMjAwMCAqLw0KKw0KKyNkZWZpbmUgTFM3QTIwMDBfUElYUExMMF9SRUcgICAg
ICAgICAgICAweDA0QjANCisjZGVmaW5lIExTN0EyMDAwX1BJWFBMTDFfUkVHICAgICAgICAgICAg
MHgwNEMwDQorDQorLyogVGhlIERDLCBHUFUsIEdyYXBoaWMgTWVtb3J5IENvbnRyb2xsZXIgc2hh
cmUgdGhlIHNpbmdsZSBnZnhwbGwgKi8NCisjZGVmaW5lIExTN0EyMDAwX1BMTF9HRlhfUkVHICAg
ICAgICAgICAgMHgwNDkwDQorDQorI2RlZmluZSBMUzdBMjAwMF9DT05GX1JFR19CQVNFICAgICAg
ICAgIDB4MTAwMTAwMDANCisNCisvKiBGb3IgTFNEQ19DUlRDeF9DRkdfUkVHICovDQorI2RlZmlu
ZSBDRkdfUElYX0ZNVF9NQVNLICAgICAgICAgICAgICAgIEdFTk1BU0soMiwgMCkNCisNCitlbnVt
IGxzZGNfcGl4ZWxfZm9ybWF0IHsNCisJTFNEQ19QRl9OT05FID0gMCwNCisJTFNEQ19QRl9YUkdC
NDQ0ID0gMSwgICAgLyogWzEyIGJpdHNdICovDQorCUxTRENfUEZfWFJHQjU1NSA9IDIsICAgIC8q
IFsxNSBiaXRzXSAqLw0KKwlMU0RDX1BGX1hSR0I1NjUgPSAzLCAgICAvKiBSR0IgWzE2IGJpdHNd
ICovDQorCUxTRENfUEZfWFJHQjg4ODggPSA0LCAgIC8qIFhSR0IgWzMyIGJpdHNdICovDQorfTsN
CisNCisvKg0KKyAqIEVhY2ggY3J0YyBoYXMgdHdvIHNldCBmYiBhZGRyZXNzIHJlZ2lzdGVycyB1
c2FibGUsIEZCX1JFR19JTl9VU0lORyBiaXQgb2YNCisgKiBMU0RDX0NSVEN4X0NGR19SRUcgaW5k
aWNhdGUgd2hpY2ggZmIgYWRkcmVzcyByZWdpc3RlciBpcyBpbiB1c2luZyBieSB0aGUNCisgKiBD
UlRDIGN1cnJlbnRseS4gQ0ZHX1BBR0VfRkxJUCBpcyB1c2VkIHRvIHRyaWdnZXIgdGhlIHN3aXRj
aCwgdGhlIHN3aXRjaGluZw0KKyAqIHdpbGwgYmUgZmluaXNoZWQgYXQgdGhlIHZlcnkgbmV4dCB2
YmxhbmsuIFRyaWdnZXIgaXQgYWdhaW4gaWYgeW91IHdhbnQgdG8NCisgKiBzd2l0Y2ggYmFjay4N
CisgKg0KKyAqIElmIEZCMF9BRERSX1JFRyBpcyBpbiB1c2luZywgd2Ugd3JpdGUgdGhlIGFkZHJl
c3MgdG8gRkIwX0FERFJfUkVHLA0KKyAqIGlmIEZCMV9BRERSX1JFRyBpcyBpbiB1c2luZywgd2Ug
d3JpdGUgdGhlIGFkZHJlc3MgdG8gRkIxX0FERFJfUkVHLg0KKyAqLw0KKyNkZWZpbmUgQ0ZHX1BB
R0VfRkxJUCAgICAgICAgICAgICAgICAgICBCSVQoNykNCisjZGVmaW5lIENGR19PVVRQVVRfRU5B
QkxFICAgICAgICAgICAgICAgQklUKDgpDQorI2RlZmluZSBDRkdfSFdfQ0xPTkUgICAgICAgICAg
ICAgICAgICAgIEJJVCg5KQ0KKy8qIEluZGljYXRlIHdpdGNoIGZiIGFkZHIgcmVnIGlzIGluIHVz
aW5nLCBjdXJyZW50bHkuIHJlYWQgb25seSAqLw0KKyNkZWZpbmUgRkJfUkVHX0lOX1VTSU5HICAg
ICAgICAgICAgICAgICBCSVQoMTEpDQorI2RlZmluZSBDRkdfR0FNTUFfRU4gICAgICAgICAgICAg
ICAgICAgIEJJVCgxMikNCisNCisvKiBUaGUgREMgZ2V0IHNvZnQgcmVzZXQgaWYgdGhpcyBiaXQg
Y2hhbmdlZCBmcm9tICIxIiB0byAiMCIsIGFjdGl2ZSBsb3cgKi8NCisjZGVmaW5lIENGR19SRVNF
VF9OICAgICAgICAgICAgICAgICAgICAgQklUKDIwKQ0KKy8qIElmIHRoaXMgYml0IGlzIHNldCwg
aXQgc2F5IHRoYXQgdGhlIENSVEMgc3RvcCB3b3JraW5nIGFueW1vcmUsIGFuY2hvcmVkLiAqLw0K
KyNkZWZpbmUgQ1JUQ19BTkNIT1JFRCAgICAgICAgICAgICAgICAgICBCSVQoMjQpDQorDQorLyoN
CisgKiBUaGUgRE1BIHN0ZXAgb2YgdGhlIERDIGluIExTN0EyMDAwL0xTMksyMDAwIGlzIGNvbmZp
Z3VyYWJsZSwNCisgKiBzZXR0aW5nIHRob3NlIGJpdHMgb24gbHM3YTEwMDAgcGxhdGZvcm0gbWFr
ZSBubyBlZmZlY3QuDQorICovDQorI2RlZmluZSBDRkdfRE1BX1NURVBfTUFTSyAgICAgICAgICAg
ICAgR0VOTUFTSygxNywgMTYpDQorI2RlZmluZSBDRkdfRE1BX1NURVBfU0hJRlQgICAgICAgICAg
ICAgMTYNCitlbnVtIGxzZGNfZG1hX3N0ZXBzIHsNCisJTFNEQ19ETUFfU1RFUF8yNTZfQllURVMg
PSAwLA0KKwlMU0RDX0RNQV9TVEVQXzEyOF9CWVRFUyA9IDEsDQorCUxTRENfRE1BX1NURVBfNjRf
QllURVMgPSAyLA0KKwlMU0RDX0RNQV9TVEVQXzMyX0JZVEVTID0gMywNCit9Ow0KKw0KKyNkZWZp
bmUgQ0ZHX1ZBTElEX0JJVFNfTUFTSyAgICAgICAgICAgICBHRU5NQVNLKDIwLCAwKQ0KKw0KKy8q
IEZvciBMU0RDX0NSVEN4X1BBTkVMX0NPTkZfUkVHICovDQorI2RlZmluZSBQSFlfQ0xPQ0tfUE9M
ICAgICAgICAgICAgICAgICAgIEJJVCg5KQ0KKyNkZWZpbmUgUEhZX0NMT0NLX0VOICAgICAgICAg
ICAgICAgICAgICBCSVQoOCkNCisjZGVmaW5lIFBIWV9ERV9QT0wgICAgICAgICAgICAgICAgICAg
ICAgQklUKDEpDQorI2RlZmluZSBQSFlfREFUQV9FTiAgICAgICAgICAgICAgICAgICAgIEJJVCgw
KQ0KKw0KKy8qIEZvciBMU0RDX0NSVEN4X0hTWU5DX1JFRyAqLw0KKyNkZWZpbmUgSFNZTkNfSU5W
ICAgICAgICAgICAgICAgICAgICAgICBCSVQoMzEpDQorI2RlZmluZSBIU1lOQ19FTiAgICAgICAg
ICAgICAgICAgICAgICAgIEJJVCgzMCkNCisjZGVmaW5lIEhTWU5DX0VORF9NQVNLICAgICAgICAg
ICAgICAgICAgR0VOTUFTSygyOCwgMTYpDQorI2RlZmluZSBIU1lOQ19FTkRfU0hJRlQgICAgICAg
ICAgICAgICAgIDE2DQorI2RlZmluZSBIU1lOQ19TVEFSVF9NQVNLICAgICAgICAgICAgICAgIEdF
Tk1BU0soMTIsIDApDQorI2RlZmluZSBIU1lOQ19TVEFSVF9TSElGVCAgICAgICAgICAgICAgIDAN
CisNCisvKiBGb3IgTFNEQ19DUlRDeF9WU1lOQ19SRUcgKi8NCisjZGVmaW5lIFZTWU5DX0lOViAg
ICAgICAgICAgICAgICAgICAgICAgQklUKDMxKQ0KKyNkZWZpbmUgVlNZTkNfRU4gICAgICAgICAg
ICAgICAgICAgICAgICBCSVQoMzApDQorI2RlZmluZSBWU1lOQ19FTkRfTUFTSyAgICAgICAgICAg
ICAgICAgIEdFTk1BU0soMjcsIDE2KQ0KKyNkZWZpbmUgVlNZTkNfRU5EX1NISUZUICAgICAgICAg
ICAgICAgICAxNg0KKyNkZWZpbmUgVlNZTkNfU1RBUlRfTUFTSyAgICAgICAgICAgICAgICBHRU5N
QVNLKDExLCAwKQ0KKyNkZWZpbmUgVlNZTkNfU1RBUlRfU0hJRlQgICAgICAgICAgICAgICAwDQor
DQorLyoqKioqKioqKioqIENSVEMwICYgRElTUExBWSBQSVBFMCAqKioqKioqKioqKi8NCisjZGVm
aW5lIExTRENfQ1JUQzBfQ0ZHX1JFRyAgICAgICAgICAgICAgMHgxMjQwDQorI2RlZmluZSBMU0RD
X0NSVEMwX0ZCMF9BRERSX0xPX1JFRyAgICAgIDB4MTI2MA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9G
QjBfQUREUl9ISV9SRUcgICAgICAweDE1QTANCisjZGVmaW5lIExTRENfQ1JUQzBfU1RSSURFX1JF
RyAgICAgICAgICAgMHgxMjgwDQorI2RlZmluZSBMU0RDX0NSVEMwX0ZCX09SSUdJTl9SRUcgICAg
ICAgIDB4MTMwMA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9QQU5FTF9DT05GX1JFRyAgICAgICAweDEz
QzANCisjZGVmaW5lIExTRENfQ1JUQzBfSERJU1BMQVlfUkVHICAgICAgICAgMHgxNDAwDQorI2Rl
ZmluZSBMU0RDX0NSVEMwX0hTWU5DX1JFRyAgICAgICAgICAgIDB4MTQyMA0KKyNkZWZpbmUgTFNE
Q19DUlRDMF9WRElTUExBWV9SRUcgICAgICAgICAweDE0ODANCisjZGVmaW5lIExTRENfQ1JUQzBf
VlNZTkNfUkVHICAgICAgICAgICAgMHgxNEEwDQorI2RlZmluZSBMU0RDX0NSVEMwX0dBTU1BX0lO
REVYX1JFRyAgICAgIDB4MTRFMA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9HQU1NQV9EQVRBX1JFRyAg
ICAgICAweDE1MDANCisjZGVmaW5lIExTRENfQ1JUQzBfRkIxX0FERFJfTE9fUkVHICAgICAgMHgx
NTgwDQorI2RlZmluZSBMU0RDX0NSVEMwX0ZCMV9BRERSX0hJX1JFRyAgICAgIDB4MTVDMA0KKw0K
Ky8qKioqKioqKioqKiBDVFJDMSAmIERJU1BMQVkgUElQRTEgKioqKioqKioqKiovDQorI2RlZmlu
ZSBMU0RDX0NSVEMxX0NGR19SRUcgICAgICAgICAgICAgIDB4MTI1MA0KKyNkZWZpbmUgTFNEQ19D
UlRDMV9GQjBfQUREUl9MT19SRUcgICAgICAweDEyNzANCisjZGVmaW5lIExTRENfQ1JUQzFfRkIw
X0FERFJfSElfUkVHICAgICAgMHgxNUIwDQorI2RlZmluZSBMU0RDX0NSVEMxX1NUUklERV9SRUcg
ICAgICAgICAgIDB4MTI5MA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9GQl9PUklHSU5fUkVHICAgICAg
ICAweDEzMTANCisjZGVmaW5lIExTRENfQ1JUQzFfUEFORUxfQ09ORl9SRUcgICAgICAgMHgxM0Qw
DQorI2RlZmluZSBMU0RDX0NSVEMxX0hESVNQTEFZX1JFRyAgICAgICAgIDB4MTQxMA0KKyNkZWZp
bmUgTFNEQ19DUlRDMV9IU1lOQ19SRUcgICAgICAgICAgICAweDE0MzANCisjZGVmaW5lIExTRENf
Q1JUQzFfVkRJU1BMQVlfUkVHICAgICAgICAgMHgxNDkwDQorI2RlZmluZSBMU0RDX0NSVEMxX1ZT
WU5DX1JFRyAgICAgICAgICAgIDB4MTRCMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9HQU1NQV9JTkRF
WF9SRUcgICAgICAweDE0RjANCisjZGVmaW5lIExTRENfQ1JUQzFfR0FNTUFfREFUQV9SRUcgICAg
ICAgMHgxNTEwDQorI2RlZmluZSBMU0RDX0NSVEMxX0ZCMV9BRERSX0xPX1JFRyAgICAgIDB4MTU5
MA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9GQjFfQUREUl9ISV9SRUcgICAgICAweDE1RDANCisNCisv
Kg0KKyAqIEFsbCBvZiB0aGUgREMgdmFyaWFudHMgaGFzIHRoZSBoYXJkd2FyZSB3aGljaCByZWNv
cmQgdGhlIHNjYW4gcG9zaXRpb24NCisgKiBvZiB0aGUgQ1JUQywgWzMxOjE2XSA6IGN1cnJlbnQg
WCBwb3NpdGlvbiwgWzE1OjBdIDogY3VycmVudCBZIHBvc2l0aW9uDQorICovDQorI2RlZmluZSBM
U0RDX0NSVEMwX1NDQU5fUE9TX1JFRyAgICAgICAgIDB4MTRDMA0KKyNkZWZpbmUgTFNEQ19DUlRD
MV9TQ0FOX1BPU19SRUcgICAgICAgICAweDE0RDANCisNCisvKg0KKyAqIExTN0EyMDAwIGhhcyBT
eW5jIERldmlhdGlvbiByZWdpc3Rlci4NCisgKi8NCisjZGVmaW5lIFNZTkNfREVWSUFUSU9OX0VO
ICAgICAgICAgICAgICAgQklUKDMxKQ0KKyNkZWZpbmUgU1lOQ19ERVZJQVRJT05fTlVNICAgICAg
ICAgICAgICBHRU5NQVNLKDEyLCAwKQ0KKyNkZWZpbmUgTFNEQ19DUlRDMF9TWU5DX0RFVklBVElP
Tl9SRUcgICAweDFCODANCisjZGVmaW5lIExTRENfQ1JUQzFfU1lOQ19ERVZJQVRJT05fUkVHICAg
MHgxQjkwDQorDQorLyoNCisgKiBJbiBncm9zcywgTFNEQ19DUlRDMV9YWFhfUkVHIC0gTFNEQ19D
UlRDMF9YWFhfUkVHID0gMHgxMCwgYnV0IG5vdCBhbGwgb2YNCisgKiB0aGUgcmVnaXN0ZXJzIG9i
ZXkgdGhpcyBydWxlLCBMU0RDX0NVUlNPUnhfWFhYX1JFRyBqdXN0IGRvbid0IGhvbm9yIHRoaXMu
DQorICogVGhpcyBpcyB0aGUgcm9vdCBjYXVzZSB3ZSBjYW4ndCB1bnRhbmdsZSB0aGUgY29kZSBi
eSBtYW5wdWxhdGluZyBvZmZzZXQNCisgKiBvZiB0aGUgcmVnaXN0ZXIgYWNjZXNzIHNpbXBseS4g
T3VyIGhhcmR3YXJlIGVuZ2luZWVycyBhcmUgbGFjayBleHBlcmlhbmNlDQorICogd2hlbiB0aGV5
IGRlc2lnbiB0aGlzLi4uDQorICovDQorI2RlZmluZSBDUlRDX1BJUEVfT0ZGU0VUICAgICAgICAg
ICAgICAgIDB4MTANCisNCisvKg0KKyAqIFRoZXJlIGlzIG9ubHkgb25lIGhhcmR3YXJlIGN1cnNv
ciB1bml0IGluIExTN0ExMDAwIGFuZCBMUzJLMTAwMCwgbGV0DQorICogQ0ZHX0hXX0NMT05FX0VO
IGJpdCBiZSAiMSIgY291bGQgZWxpbWluYXRlIHRoaXMgZW1iYXJyYXNzbWVudCwgd2UgbWFkZQ0K
KyAqIGl0IG9uIGN1c3RvbSBjbG9uZSBtb2RlIGFwcGxpY2F0aW9uLiBXaGlsZSBMUzdBMjAwMCBo
YXMgdHdvIGhhcmR3YXJlDQorICogY3Vyc29yIHVuaXQgd2hpY2ggaXMgZ29vZCBlbm91Z2guDQor
ICovDQorI2RlZmluZSBDVVJTT1JfRk9STUFUX01BU0sgICAgICAgICAgICAgIEdFTk1BU0soMSwg
MCkNCisjZGVmaW5lIENVUlNPUl9GT1JNQVRfU0hJRlQgICAgICAgICAgICAgMA0KK2VudW0gbHNk
Y19jdXJzb3JfZm9ybWF0IHsNCisJQ1VSU09SX0ZPUk1BVF9ESVNBQkxFID0gMCwNCisJQ1VSU09S
X0ZPUk1BVF9NT05PQ0hST01FID0gMSwgICAvKiBtYXNrZWQgKi8NCisJQ1VSU09SX0ZPUk1BVF9B
UkdCODg4OCA9IDIsICAgICAvKiBBOFI4RzhCOCAqLw0KK307DQorDQorLyoNCisgKiBMUzdBMTAw
MCBhbmQgTFMySzEwMDAgb25seSBzdXBwb3J0IDMyeDMyLCBMUzJLMjAwMCBhbmQgTFM3QTIwMDAg
c3VwcG9ydA0KKyAqIDY0eDY0LCBidXQgaXQgc2VlbXMgdGhhdCBzZXR0aW5nIHRoaXMgYml0IG1h
a2Ugbm8gaGFybXMgb24gTFM3QTEwMDAsIGl0DQorICoganVzdCBkb24ndCB0YWtlIGVmZmVjdHMu
DQorICovDQorI2RlZmluZSBDVVJTT1JfU0laRV9TSElGVCAgICAgICAgICAgICAgIDINCitlbnVt
IGxzZGNfY3Vyc29yX3NpemUgew0KKwlDVVJTT1JfU0laRV8zMlgzMiA9IDAsDQorCUNVUlNPUl9T
SVpFXzY0WDY0ID0gMSwNCit9Ow0KKw0KKyNkZWZpbmUgQ1VSU09SX0xPQ0FUSU9OX1NISUZUICAg
ICAgICAgICA0DQorZW51bSBsc2RjX2N1cnNvcl9sb2NhdGlvbiB7DQorCUNVUlNPUl9PTl9DUlRD
MCA9IDAsDQorCUNVUlNPUl9PTl9DUlRDMSA9IDEsDQorfTsNCisNCisjZGVmaW5lIExTRENfQ1VS
U09SMF9DRkdfUkVHICAgICAgICAgICAgMHgxNTIwDQorI2RlZmluZSBMU0RDX0NVUlNPUjBfQURE
Ul9MT19SRUcgICAgICAgIDB4MTUzMA0KKyNkZWZpbmUgTFNEQ19DVVJTT1IwX0FERFJfSElfUkVH
ICAgICAgICAweDE1ZTANCisjZGVmaW5lIExTRENfQ1VSU09SMF9QT1NJVElPTl9SRUcgICAgICAg
MHgxNTQwICAvKiBbMzE6MTZdIFksIFsxNTowXSBYICovDQorI2RlZmluZSBMU0RDX0NVUlNPUjBf
QkdfQ09MT1JfUkVHICAgICAgIDB4MTU1MCAgLyogYmFja2dyb3VuZCBjb2xvciAqLw0KKyNkZWZp
bmUgTFNEQ19DVVJTT1IwX0ZHX0NPTE9SX1JFRyAgICAgICAweDE1NjAgIC8qIGZvcmVncm91bmQg
Y29sb3IgKi8NCisNCisjZGVmaW5lIExTRENfQ1VSU09SMV9DRkdfUkVHICAgICAgICAgICAgMHgx
NjcwDQorI2RlZmluZSBMU0RDX0NVUlNPUjFfQUREUl9MT19SRUcgICAgICAgIDB4MTY4MA0KKyNk
ZWZpbmUgTFNEQ19DVVJTT1IxX0FERFJfSElfUkVHICAgICAgICAweDE2ZTANCisjZGVmaW5lIExT
RENfQ1VSU09SMV9QT1NJVElPTl9SRUcgICAgICAgMHgxNjkwICAvKiBbMzE6MTZdIFksIFsxNTow
XSBYICovDQorI2RlZmluZSBMU0RDX0NVUlNPUjFfQkdfQ09MT1JfUkVHICAgICAgIDB4MTZBMCAg
LyogYmFja2dyb3VuZCBjb2xvciAqLw0KKyNkZWZpbmUgTFNEQ19DVVJTT1IxX0ZHX0NPTE9SX1JF
RyAgICAgICAweDE2QjAgIC8qIGZvcmVncm91bmQgY29sb3IgKi8NCisNCisvKg0KKyAqIERDIElu
dGVycnVwdCBDb250cm9sIFJlZ2lzdGVyLCAzMmJpdCwgQWRkcmVzcyBPZmZzZXQ6IDE1NzANCisg
Kg0KKyAqIEJpdHMgMTU6MCBpbmlkaWNhdGUgdGhlIGludGVycnVwdCBzdGF0dXMNCisgKiBCaXRz
IDMxOjE2IGNvbnRyb2wgZW5hYmxlIGludGVycnVwdHMgY29ycmVzcG9uZGluZyB0byBiaXQgMTU6
MCBvciBub3QNCisgKiBXcml0ZSAxIHRvIGVuYWJsZSwgd3JpdGUgMCB0byBkaXNhYmxlDQorICoN
CisgKiBSRjogUmVhZCBGaW5pc2hlZA0KKyAqIElEQlU6IEludGVybmFsIERhdGEgQnVmZmVyIFVu
ZGVyZmxvdw0KKyAqIElEQkZVOiBJbnRlcm5hbCBEYXRhIEJ1ZmZlciBGYXRhbCBVbmRlcmZsb3cN
CisgKiBDQlJGOiBDdXJzb3IgQnVmZmVyIFJlYWQgRmluaXNoZWQgRmxhZywgbm8gdXNlLg0KKyAq
IEZCUkYwOiBDUlRDLTAgcmVhZGluZyBmcm9tIGl0cyBmcmFtZWJ1ZmZlciBmaW5pc2hlZC4NCisg
KiBGQlJGMTogQ1JUQy0xIHJlYWRpbmcgZnJvbSBpdHMgZnJhbWVidWZmZXIgZmluaXNoZWQuDQor
ICoNCisgKiArLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSstLS0tLS0tKy0tLS0t
LS0tKy0tLS0tLS0tKy0tLS0tLS0rDQorICogfCAzMToyNyB8ICAgICAgICAgMjY6MTYgICAgICAg
ICAgICB8IDE1OjExIHwgICAxMCAgIHwgICA5ICAgIHwgICA4ICAgfA0KKyAqICstLS0tLS0tKy0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0t
LSsNCisgKiB8ICBOL0EgIHwgSW50ZXJydXB0IEVuYWJsZSBDb250cm9sIHwgIE4vQSAgfCBJREJG
VTAgfCBJREJGVTEgfCBJREJVMCB8DQorICogKy0tLS0tLS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0rLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tKw0KKyAqDQorICogKy0tLS0t
LS0rLS0tLS0tLSstLS0tLS0tKy0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSstLS0t
LS0tLSsNCisgKiB8ICAgNyAgIHwgICA2ICAgfCAgIDUgICB8ICA0ICAgfCAgIDMgICAgfCAgIDIg
ICAgfCAgIDEgICAgfCAgIDAgICAgfA0KKyAqICstLS0tLS0tKy0tLS0tLS0rLS0tLS0tLSstLS0t
LS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rDQorICogfCBJREJVMSB8IEZC
UkYwIHwgRkJSRjEgfCBDUlJGIHwgSFNZTkMwIHwgVlNZTkMwIHwgSFNZTkMxIHwgVlNZTkMxIHwN
CisgKiArLS0tLS0tLSstLS0tLS0tKy0tLS0tLS0rLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0tKy0t
LS0tLS0tKy0tLS0tLS0tKw0KKyAqDQorICogdW5mb3J0dW5hdGVseSwgQ1JUQzAncyBpbnRlcnJ1
cHQgaXMgbWVzcyB3aXRoIENSVEMxJ3MgaW50ZXJydXB0IGluIG9uZQ0KKyAqIHJlZ2lzdGVyIGFn
YWluLg0KKyAqLw0KKw0KKyNkZWZpbmUgTFNEQ19JTlRfUkVHICAgICAgICAgICAgICAgICAgICAw
eDE1NzANCisNCisjZGVmaW5lIElOVF9DUlRDMF9WU1lOQyAgICAgICAgICAgICAgICAgQklUKDIp
DQorI2RlZmluZSBJTlRfQ1JUQzBfSFNZTkMgICAgICAgICAgICAgICAgIEJJVCgzKQ0KKyNkZWZp
bmUgSU5UX0NSVEMwX1JGICAgICAgICAgICAgICAgICAgICBCSVQoNikNCisjZGVmaW5lIElOVF9D
UlRDMF9JREJVICAgICAgICAgICAgICAgICAgQklUKDgpDQorI2RlZmluZSBJTlRfQ1JUQzBfSURC
RlUgICAgICAgICAgICAgICAgIEJJVCgxMCkNCisNCisjZGVmaW5lIElOVF9DUlRDMV9WU1lOQyAg
ICAgICAgICAgICAgICAgQklUKDApDQorI2RlZmluZSBJTlRfQ1JUQzFfSFNZTkMgICAgICAgICAg
ICAgICAgIEJJVCgxKQ0KKyNkZWZpbmUgSU5UX0NSVEMxX1JGICAgICAgICAgICAgICAgICAgICBC
SVQoNSkNCisjZGVmaW5lIElOVF9DUlRDMV9JREJVICAgICAgICAgICAgICAgICAgQklUKDcpDQor
I2RlZmluZSBJTlRfQ1JUQzFfSURCRlUgICAgICAgICAgICAgICAgIEJJVCg5KQ0KKw0KKyNkZWZp
bmUgSU5UX0NSVEMwX1ZTWU5DX0VOICAgICAgICAgICAgICBCSVQoMTgpDQorI2RlZmluZSBJTlRf
Q1JUQzBfSFNZTkNfRU4gICAgICAgICAgICAgIEJJVCgxOSkNCisjZGVmaW5lIElOVF9DUlRDMF9S
Rl9FTiAgICAgICAgICAgICAgICAgQklUKDIyKQ0KKyNkZWZpbmUgSU5UX0NSVEMwX0lEQlVfRU4g
ICAgICAgICAgICAgICBCSVQoMjQpDQorI2RlZmluZSBJTlRfQ1JUQzBfSURCRlVfRU4gICAgICAg
ICAgICAgIEJJVCgyNikNCisNCisjZGVmaW5lIElOVF9DUlRDMV9WU1lOQ19FTiAgICAgICAgICAg
ICAgQklUKDE2KQ0KKyNkZWZpbmUgSU5UX0NSVEMxX0hTWU5DX0VOICAgICAgICAgICAgICBCSVQo
MTcpDQorI2RlZmluZSBJTlRfQ1JUQzFfUkZfRU4gICAgICAgICAgICAgICAgIEJJVCgyMSkNCisj
ZGVmaW5lIElOVF9DUlRDMV9JREJVX0VOICAgICAgICAgICAgICAgQklUKDIzKQ0KKyNkZWZpbmUg
SU5UX0NSVEMxX0lEQkZVX0VOICAgICAgICAgICAgICBCSVQoMjUpDQorDQorI2RlZmluZSBJTlRf
U1RBVFVTX01BU0sgICAgICAgICAgICAgICAgIEdFTk1BU0soMTUsIDApDQorDQorLyoNCisgKiBM
UzdBMTAwMC9MUzdBMjAwMCBoYXZlIDQgZ3Bpb3Mgd2hpY2ggYXJlIHVzZWQgdG8gZW11bGF0ZWQg
STJDLg0KKyAqIFRoZXkgYXJlIHVuZGVyIGNvbnRyb2wgb2YgdGhlIExTN0FfRENfR1BJT19EQVRf
UkVHIGFuZCBMUzdBX0RDX0dQSU9fRElSX1JFRw0KKyAqIHJlZ2lzdGVyLCBUaG9zZSBHUElPcyBo
YXMgbm8gcmVsYXRpb25zaGlwIHdodGggdGhlIEdQSU8gaGFyZHdhcmUgb24gdGhlDQorICogYnJp
ZGdlIGNoaXAgaXRzZWxmLiBUaG9zZSBvZmZzZXRzIGFyZSByZWxhdGl2ZSB0byBEQyByZWdpc3Rl
ciBiYXNlIGFkZHJlc3MNCisgKg0KKyAqIExTMmsxMDAwIGRvbid0IGhhdmUgdGhvc2UgcmVnaXN0
ZXJzLCB0aGV5IHVzZSBoYXJkd2FyZSBpMmMgb3IgZ2VuZXJhbCBHUElPDQorICogZW11bGF0ZWQg
aTJjIGZyb20gbGludXggaTJjIHN1YnN5c3RlbS4NCisgKg0KKyAqIEdQSU8gZGF0YSByZWdpc3Rl
ciwgYWRkcmVzcyBvZmZzZXQ6IDB4MTY1MA0KKyAqICAgKy0tLS0tLS0tLS0tLS0tLSstLS0tLS0t
LS0tLSstLS0tLS0tLS0tLSsNCisgKiAgIHwgNyB8IDYgfCA1IHwgNCB8ICAzICB8ICAyICB8ICAx
ICB8ICAwICB8DQorICogICArLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKy0tLS0tLS0tLS0t
Kw0KKyAqICAgfCAgICAgICAgICAgICAgIHwgICAgRFZPMSAgIHwgICAgRFZPMCAgIHwNCisgKiAg
ICsgICAgICBOL0EgICAgICArLS0tLS0tLS0tLS0rLS0tLS0tLS0tLS0rDQorICogICB8ICAgICAg
ICAgICAgICAgfCBTQ0wgfCBTREEgfCBTQ0wgfCBTREEgfA0KKyAqICAgKy0tLS0tLS0tLS0tLS0t
LSstLS0tLS0tLS0tLSstLS0tLS0tLS0tLSsNCisgKi8NCisjZGVmaW5lIExTN0FfRENfR1BJT19E
QVRfUkVHICAgICAgICAgICAgMHgxNjUwDQorDQorLyoNCisgKiAgR1BJTyBJbnB1dC9PdXRwdXQg
ZGlyZWN0aW9uIGNvbnRyb2wgcmVnaXN0ZXIsIGFkZHJlc3Mgb2Zmc2V0OiAweDE2NjANCisgKi8N
CisjZGVmaW5lIExTN0FfRENfR1BJT19ESVJfUkVHICAgICAgICAgICAgMHgxNjYwDQorDQorLyoN
CisgKiAgTFM3QTIwMDAgaGFzIHR3byBidWlsdC1pbiBIRE1JIEVuY29kZXIgYW5kIG9uZSBWR0Eg
ZW5jb2Rlcg0KKyAqLw0KKw0KKy8qDQorICogTnVtYmVyIG9mIGNvbnRpbnVvdXMgcGFja2V0cyBt
YXkgYmUgcHJlc2VudA0KKyAqIGluIEhETUkgaGJsYW5rIGFuZCB2Ymxhbmsgem9uZSwgc2hvdWxk
ID49IDQ4DQorICovDQorI2RlZmluZSBMU0RDX0hETUkwX1pPTkVfUkVHICAgICAgICAgICAgIDB4
MTcwMA0KKyNkZWZpbmUgTFNEQ19IRE1JMV9aT05FX1JFRyAgICAgICAgICAgICAweDE3MTANCisN
CisjZGVmaW5lIEhETUlfSF9aT05FX0lETEVfU0hJRlQgICAgICAgICAgMA0KKyNkZWZpbmUgSERN
SV9WX1pPTkVfSURMRV9TSElGVCAgICAgICAgICAxNg0KKw0KKy8qIEhETUkgSXRlcmZhY2UgQ29u
dHJvbCBSZWcgKi8NCisjZGVmaW5lIEhETUlfSU5URVJGQUNFX0VOICAgICAgICAgICAgICAgQklU
KDApDQorI2RlZmluZSBIRE1JX1BBQ0tFVF9FTiAgICAgICAgICAgICAgICAgIEJJVCgxKQ0KKyNk
ZWZpbmUgSERNSV9BVURJT19FTiAgICAgICAgICAgICAgICAgICBCSVQoMikNCisvKg0KKyAqIFBy
ZWFtYmxlOg0KKyAqIEltbWVkaWF0ZWx5IHByZWNlZGluZyBlYWNoIHZpZGVvIGRhdGEgcGVyaW9k
IG9yIGRhdGEgaXNsYW5kIHBlcmlvZCBpcyB0aGUNCisgKiBwcmVhbWJsZS4gVGhpcyBpcyBhIHNl
cXVlbmNlIG9mIGVpZ2h0IGlkZW50aWNhbCBjb250cm9sIGNoYXJhY3RlcnMgdGhhdA0KKyAqIGlu
ZGljYXRlIHdoZXRoZXIgdGhlIHVwY29taW5nIGRhdGEgcGVyaW9kIGlzIGEgdmlkZW8gZGF0YSBw
ZXJpb2Qgb3IgaXMgYQ0KKyAqIGRhdGEgaXNsYW5kLiBUaGUgdmFsdWVzIG9mIENUTDAsIENUTDEs
IENUTDIsIGFuZCBDVEwzIGluZGljYXRlIHRoZSB0eXBlIG9mDQorICogZGF0YSBwZXJpb2QgdGhh
dCBmb2xsb3dzLg0KKyAqLw0KKyNkZWZpbmUgSERNSV9WSURFT19QUkVBTUJMRV9NQVNLICAgICAg
ICBHRU5NQVNLKDcsIDQpDQorI2RlZmluZSBIRE1JX1ZJREVPX1BSRUFNQkxFX1NISUZUICAgICAg
IDQNCisvKiAxOiBodyBpMmMsIDA6IGdwaW8gZW11IGkyYywgc2hvdWxkbid0IHB1dCBpbiBMU0RD
X0hETUl4X0lOVEZfQ1RSTF9SRUcgKi8NCisjZGVmaW5lIEhXX0kyQ19FTiAgICAgICAgICAgICAg
ICAgICAgICAgQklUKDgpDQorI2RlZmluZSBIRE1JX0NUTF9QRVJJT0RfTU9ERSAgICAgICAgICAg
IEJJVCg5KQ0KKyNkZWZpbmUgTFNEQ19IRE1JMF9JTlRGX0NUUkxfUkVHICAgICAgICAweDE3MjAN
CisjZGVmaW5lIExTRENfSERNSTFfSU5URl9DVFJMX1JFRyAgICAgICAgMHgxNzMwDQorDQorI2Rl
ZmluZSBIRE1JX1BIWV9FTiAgICAgICAgICAgICAgICAgICAgIEJJVCgwKQ0KKyNkZWZpbmUgSERN
SV9QSFlfUkVTRVRfTiAgICAgICAgICAgICAgICBCSVQoMSkNCisjZGVmaW5lIEhETUlfUEhZX1RF
Uk1fTF9FTiAgICAgICAgICAgICAgQklUKDgpDQorI2RlZmluZSBIRE1JX1BIWV9URVJNX0hfRU4g
ICAgICAgICAgICAgIEJJVCg5KQ0KKyNkZWZpbmUgSERNSV9QSFlfVEVSTV9ERVRfRU4gICAgICAg
ICAgICBCSVQoMTApDQorI2RlZmluZSBIRE1JX1BIWV9URVJNX1NUQVRVUyAgICAgICAgICAgIEJJ
VCgxMSkNCisjZGVmaW5lIExTRENfSERNSTBfUEhZX0NUUkxfUkVHICAgICAgICAgMHgxODAwDQor
I2RlZmluZSBMU0RDX0hETUkxX1BIWV9DVFJMX1JFRyAgICAgICAgIDB4MTgxMA0KKw0KKy8qIEhp
Z2ggbGV2ZWwgZHVyYXRpb24gbmVlZCA+IDF1cyAqLw0KKyNkZWZpbmUgSERNSV9QTExfRU5BQkxF
ICAgICAgICAgICAgICAgICBCSVQoMCkNCisjZGVmaW5lIEhETUlfUExMX0xPQ0tFRCAgICAgICAg
ICAgICAgICAgQklUKDE2KQ0KKy8qIEJ5cGFzcyB0aGUgc29mdHdhcmUgY29uZmlndXJlZCB2YWx1
ZXMsIHVzaW5nIGRlZmF1bHQgc291cmNlIGZyb20gc29tZXdoZXJlICovDQorI2RlZmluZSBIRE1J
X1BMTF9CWVBBU1MgICAgICAgICAgICAgICAgIEJJVCgxNykNCisNCisjZGVmaW5lIEhETUlfUExM
X0lERl9TSElGVCAgICAgICAgICAgICAgMQ0KKyNkZWZpbmUgSERNSV9QTExfSURGX01BU0sgICAg
ICAgICAgICAgICBHRU5NQVNLKDUsIDEpDQorI2RlZmluZSBIRE1JX1BMTF9MRl9TSElGVCAgICAg
ICAgICAgICAgIDYNCisjZGVmaW5lIEhETUlfUExMX0xGX01BU0sgICAgICAgICAgICAgICAgR0VO
TUFTSygxMiwgNikNCisjZGVmaW5lIEhETUlfUExMX09ERl9TSElGVCAgICAgICAgICAgICAgMTMN
CisjZGVmaW5lIEhETUlfUExMX09ERl9NQVNLICAgICAgICAgICAgICAgR0VOTUFTSygxNSwgMTMp
DQorI2RlZmluZSBMU0RDX0hETUkwX1BIWV9QTExfUkVHICAgICAgICAgIDB4MTgyMA0KKyNkZWZp
bmUgTFNEQ19IRE1JMV9QSFlfUExMX1JFRyAgICAgICAgICAweDE4MzANCisNCisvKiBMUzdBMjAw
MC9MUzJLMjAwMCBoYXMgaHBkIHN0YXR1cyByZWcsIHdoaWxlIHRoZSB0d28gaGRtaSdzIHN0YXR1
cw0KKyAqIGxvY2F0ZWQgYXQgdGhlIG9uZSByZWdpc3RlciBhZ2Fpbi4NCisgKi8NCisjZGVmaW5l
IExTRENfSERNSV9IUERfU1RBVFVTX1JFRyAgICAgICAgMHgxQkEwDQorI2RlZmluZSBIRE1JMF9I
UERfRkxBRyAgICAgICAgICAgICAgICAgIEJJVCgwKQ0KKyNkZWZpbmUgSERNSTFfSFBEX0ZMQUcg
ICAgICAgICAgICAgICAgICBCSVQoMSkNCisNCisjZGVmaW5lIExTRENfSERNSTBfUEhZX0NBTF9S
RUcgICAgICAgICAgMHgxOEMwDQorI2RlZmluZSBMU0RDX0hETUkxX1BIWV9DQUxfUkVHICAgICAg
ICAgIDB4MThEMA0KKw0KKy8qIEFWSSBJbmZvRnJhbWUgKi8NCisjZGVmaW5lIExTRENfSERNSTBf
QVZJX0NPTlRFTlQwICAgICAgICAgMHgxOEUwDQorI2RlZmluZSBMU0RDX0hETUkxX0FWSV9DT05U
RU5UMCAgICAgICAgIDB4MThEMA0KKyNkZWZpbmUgTFNEQ19IRE1JMF9BVklfQ09OVEVOVDEgICAg
ICAgICAweDE5MDANCisjZGVmaW5lIExTRENfSERNSTFfQVZJX0NPTlRFTlQxICAgICAgICAgMHgx
OTEwDQorI2RlZmluZSBMU0RDX0hETUkwX0FWSV9DT05URU5UMiAgICAgICAgIDB4MTkyMA0KKyNk
ZWZpbmUgTFNEQ19IRE1JMV9BVklfQ09OVEVOVDIgICAgICAgICAweDE5MzANCisjZGVmaW5lIExT
RENfSERNSTBfQVZJX0NPTlRFTlQzICAgICAgICAgMHgxOTQwDQorI2RlZmluZSBMU0RDX0hETUkx
X0FWSV9DT05URU5UMyAgICAgICAgIDB4MTk1MA0KKw0KKy8qIDE6IGVuYWJsZSBhdmkgaW5mb2Zy
YW1lIHBhY2tldCwgMDogZGlzYWJsZSBhdmkgaW5mb2ZyYW1lIHBhY2tldCAqLw0KKyNkZWZpbmUg
QVZJX1BLVF9FTkFCTEUgICAgICAgICAgICAgICAgICBCSVQoMCkNCisvKiAxOiBzZW5kIG9uZSBl
dmVyeSB0d28gZnJhbWUsIDA6IHNlbmQgb25lIGVhY2ggZnJhbWUgKi8NCisjZGVmaW5lIEFWSV9Q
S1RfU0VORF9GUkVRICAgICAgICAgICAgICAgQklUKDEpDQorLyoNCisgKiAxOiB3cml0ZSAxIHRv
IGZsdXNoIGF2aSByZWcgY29udGVudDAgfiBjb250ZW50MyB0byB0aGUgcGFja2V0IHRvIGJlIHNl
bmQsDQorICogVGhlIGhhcmR3YXJlIHdpbGwgY2xlYXIgdGhpcyBiaXQgYXV0b21hdGljYWxseS4N
CisgKi8NCisjZGVmaW5lIEFWSV9QS1RfVVBEQVRFICAgICAgICAgICAgICAgICAgQklUKDIpDQor
DQorI2RlZmluZSBMU0RDX0hETUkwX0FWSV9JTkZPX0NSVExfUkVHICAgIDB4MTk2MA0KKyNkZWZp
bmUgTFNEQ19IRE1JMV9BVklfSU5GT19DUlRMX1JFRyAgICAweDE5NzANCisNCisvKg0KKyAqIExT
N0EyMDAwIGhhcyB0aGUgaGFyZHdhcmUgd2hpY2ggY291bnQgdGhlIG51bWJlciBvZiB2Ymxhbmsg
Z2VuZXJhdGVkDQorICovDQorI2RlZmluZSBMU0RDX0NSVEMwX1ZTWU5DX0NPVU5URVJfUkVHICAg
IDB4MUEwMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9WU1lOQ19DT1VOVEVSX1JFRyAgICAweDFBMTAN
CisNCisvKg0KKyAqIExTN0EyMDAwIGhhcyB0aGUgYXVkaW8gaGFyZHdhcmUgYXNzb2NpYXRlIHdp
dGggdGhlIEhETUkgZW5jb2Rlci4NCisgKi8NCisjZGVmaW5lIExTRENfSERNSTBfQVVESU9fUExM
X0xPX1JFRyAgICAgMHgxQTIwDQorI2RlZmluZSBMU0RDX0hETUkxX0FVRElPX1BMTF9MT19SRUcg
ICAgIDB4MUEzMA0KKw0KKyNkZWZpbmUgTFNEQ19IRE1JMF9BVURJT19QTExfSElfUkVHICAgICAw
eDFBNDANCisjZGVmaW5lIExTRENfSERNSTFfQVVESU9fUExMX0hJX1JFRyAgICAgMHgxQTUwDQor
DQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRt
LmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uYw0KbmV3IGZpbGUgbW9kZSAx
MDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZmQyY2NmNTY3MGIxDQotLS0gL2Rldi9udWxsDQor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uYw0KQEAgLTAsMCArMSw2MTAg
QEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMCsNCisvKg0KKyAqIENvcHly
aWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisg
Ki8NCisNCisjaW5jbHVkZSA8ZHJtL2RybV9kcnYuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9maWxl
Lmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fbWFuYWdl
ZC5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW1lLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2
LmgiDQorI2luY2x1ZGUgImxzZGNfdHRtLmgiDQorDQorY29uc3QgY2hhciAqbHNkY19tZW1fdHlw
ZV90b19zdHIodWludDMyX3QgbWVtX3R5cGUpDQorew0KKwlzd2l0Y2ggKG1lbV90eXBlKSB7DQor
CWNhc2UgVFRNX1BMX1ZSQU06DQorCQlyZXR1cm4gIlZSQU0iOw0KKwljYXNlIFRUTV9QTF9UVDoN
CisJCXJldHVybiAiR1RUIjsNCisJY2FzZSBUVE1fUExfU1lTVEVNOg0KKwkJcmV0dXJuICJTWVNU
RU0iOw0KKwlkZWZhdWx0Og0KKwkJYnJlYWs7DQorCX0NCisNCisJcmV0dXJuICJVbmtub3duIjsN
Cit9DQorDQorY29uc3QgY2hhciAqbHNkY19kb21haW5fdG9fc3RyKHUzMiBkb21haW4pDQorew0K
Kwlzd2l0Y2ggKGRvbWFpbikgew0KKwljYXNlIExTRENfR0VNX0RPTUFJTl9WUkFNOg0KKwkJcmV0
dXJuICJWUkFNIjsNCisJY2FzZSBMU0RDX0dFTV9ET01BSU5fR1RUOg0KKwkJcmV0dXJuICJHVFQi
Ow0KKwljYXNlIExTRENfR0VNX0RPTUFJTl9TWVNURU06DQorCQlyZXR1cm4gIlNZU1RFTSI7DQor
CWRlZmF1bHQ6DQorCQlicmVhazsNCisJfQ0KKw0KKwlyZXR1cm4gIlVua25vd24iOw0KK30NCisN
CitzdGF0aWMgdm9pZCBsc2RjX2JvX3NldF9wbGFjZW1lbnQoc3RydWN0IGxzZGNfYm8gKmxibywg
dTMyIGRvbWFpbikNCit7DQorCXUzMiBjID0gMDsNCisJdTMyIHBmbGFncyA9IDA7DQorCXUzMiBp
Ow0KKw0KKwlpZiAobGJvLT50Ym8uYmFzZS5zaXplIDw9IFBBR0VfU0laRSkNCisJCXBmbGFncyB8
PSBUVE1fUExfRkxBR19UT1BET1dOOw0KKw0KKwlsYm8tPnBsYWNlbWVudC5wbGFjZW1lbnQgPSBs
Ym8tPnBsYWNlbWVudHM7DQorCWxiby0+cGxhY2VtZW50LmJ1c3lfcGxhY2VtZW50ID0gbGJvLT5w
bGFjZW1lbnRzOw0KKw0KKwlpZiAoZG9tYWluICYgTFNEQ19HRU1fRE9NQUlOX1ZSQU0pIHsNCisJ
CWxiby0+cGxhY2VtZW50c1tjXS5tZW1fdHlwZSA9IFRUTV9QTF9WUkFNOw0KKwkJbGJvLT5wbGFj
ZW1lbnRzW2MrK10uZmxhZ3MgPSBwZmxhZ3M7DQorCX0NCisNCisJaWYgKGRvbWFpbiAmIExTRENf
R0VNX0RPTUFJTl9HVFQpIHsNCisJCWxiby0+cGxhY2VtZW50c1tjXS5tZW1fdHlwZSA9IFRUTV9Q
TF9UVDsNCisJCWxiby0+cGxhY2VtZW50c1tjKytdLmZsYWdzID0gcGZsYWdzOw0KKwl9DQorDQor
CWlmIChkb21haW4gJiBMU0RDX0dFTV9ET01BSU5fU1lTVEVNKSB7DQorCQlsYm8tPnBsYWNlbWVu
dHNbY10ubWVtX3R5cGUgPSBUVE1fUExfU1lTVEVNOw0KKwkJbGJvLT5wbGFjZW1lbnRzW2MrK10u
ZmxhZ3MgPSAwOw0KKwl9DQorDQorCWlmICghYykgew0KKwkJbGJvLT5wbGFjZW1lbnRzW2NdLm1l
bV90eXBlID0gVFRNX1BMX1NZU1RFTTsNCisJCWxiby0+cGxhY2VtZW50c1tjKytdLmZsYWdzID0g
MDsNCisJfQ0KKw0KKwlsYm8tPnBsYWNlbWVudC5udW1fcGxhY2VtZW50ID0gYzsNCisJbGJvLT5w
bGFjZW1lbnQubnVtX2J1c3lfcGxhY2VtZW50ID0gYzsNCisNCisJZm9yIChpID0gMDsgaSA8IGM7
ICsraSkgew0KKwkJbGJvLT5wbGFjZW1lbnRzW2ldLmZwZm4gPSAwOw0KKwkJbGJvLT5wbGFjZW1l
bnRzW2ldLmxwZm4gPSAwOw0KKwl9DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfdHRtX3R0X2Rl
c3Ryb3koc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0cnVjdCB0dG1fdHQgKnR0KQ0KK3sNCisJ
dHRtX3R0X2ZpbmkodHQpOw0KKwlrZnJlZSh0dCk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3QgdHRt
X3R0ICoNCitsc2RjX3R0bV90dF9jcmVhdGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8s
IHVpbnQzMl90IHBhZ2VfZmxhZ3MpDQorew0KKwlzdHJ1Y3QgdHRtX3R0ICp0dDsNCisJaW50IHJl
dDsNCisNCisJdHQgPSBremFsbG9jKHNpemVvZigqdHQpLCBHRlBfS0VSTkVMKTsNCisJaWYgKCF0
dCkNCisJCXJldHVybiBOVUxMOw0KKw0KKwlyZXQgPSB0dG1fc2dfdHRfaW5pdCh0dCwgdGJvLCBw
YWdlX2ZsYWdzLCB0dG1fY2FjaGVkKTsNCisJaWYgKHJldCA8IDApIHsNCisJCWtmcmVlKHR0KTsN
CisJCXJldHVybiBOVUxMOw0KKwl9DQorDQorCXJldHVybiB0dDsNCit9DQorDQorc3RhdGljIGlu
dCBsc2RjX3R0bV90dF9wb3B1bGF0ZShzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiwNCisJCQkJc3Ry
dWN0IHR0bV90dCAqdHRtLA0KKwkJCQlzdHJ1Y3QgdHRtX29wZXJhdGlvbl9jdHggKmN0eCkNCit7
DQorCWJvb2wgc2xhdmUgPSAhISh0dG0tPnBhZ2VfZmxhZ3MgJiBUVE1fVFRfRkxBR19FWFRFUk5B
TCk7DQorDQorCWlmIChzbGF2ZSAmJiB0dG0tPnNnKSB7DQorCQlkcm1fcHJpbWVfc2dfdG9fZG1h
X2FkZHJfYXJyYXkodHRtLT5zZywNCisJCQkJCSAgICAgICB0dG0tPmRtYV9hZGRyZXNzLA0KKwkJ
CQkJICAgICAgIHR0bS0+bnVtX3BhZ2VzKTsNCisNCisJCXJldHVybiAwOw0KKwl9DQorDQorCXJl
dHVybiB0dG1fcG9vbF9hbGxvYygmYmRldi0+cG9vbCwgdHRtLCBjdHgpOw0KK30NCisNCitzdGF0
aWMgdm9pZCBsc2RjX3R0bV90dF91bnBvcHVsYXRlKHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2LA0K
KwkJCQkgICBzdHJ1Y3QgdHRtX3R0ICp0dG0pDQorew0KKwlib29sIHNsYXZlID0gISEodHRtLT5w
YWdlX2ZsYWdzICYgVFRNX1RUX0ZMQUdfRVhURVJOQUwpOw0KKw0KKwlpZiAoc2xhdmUpDQorCQly
ZXR1cm47DQorDQorCXJldHVybiB0dG1fcG9vbF9mcmVlKCZiZGV2LT5wb29sLCB0dG0pOw0KK30N
CisNCitzdGF0aWMgdm9pZCBsc2RjX2JvX2V2aWN0X2ZsYWdzKHN0cnVjdCB0dG1fYnVmZmVyX29i
amVjdCAqdGJvLA0KKwkJCQlzdHJ1Y3QgdHRtX3BsYWNlbWVudCAqdHBsYWNlbWVudCkNCit7DQor
CXN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlc291cmNlID0gdGJvLT5yZXNvdXJjZTsNCisJc3RydWN0
IGxzZGNfYm8gKmxibyA9IHRvX2xzZGNfYm8odGJvKTsNCisNCisJc3dpdGNoIChyZXNvdXJjZS0+
bWVtX3R5cGUpIHsNCisJY2FzZSBUVE1fUExfVlJBTToNCisJCWxzZGNfYm9fc2V0X3BsYWNlbWVu
dChsYm8sIExTRENfR0VNX0RPTUFJTl9HVFQpOw0KKwkJYnJlYWs7DQorCWNhc2UgVFRNX1BMX1RU
Og0KKwlkZWZhdWx0Og0KKwkJbHNkY19ib19zZXRfcGxhY2VtZW50KGxibywgTFNEQ19HRU1fRE9N
QUlOX1NZU1RFTSk7DQorCQlicmVhazsNCisJfQ0KKw0KKwkqdHBsYWNlbWVudCA9IGxiby0+cGxh
Y2VtZW50Ow0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfYm9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKnRibywNCisJCQlib29sIGV2aWN0LA0KKwkJCXN0cnVjdCB0dG1fb3BlcmF0aW9u
X2N0eCAqY3R4LA0KKwkJCXN0cnVjdCB0dG1fcmVzb3VyY2UgKm5ld19tZW0sDQorCQkJc3RydWN0
IHR0bV9wbGFjZSAqaG9wKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSB0Ym8tPmJh
c2UuZGV2Ow0KKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpvbGRfbWVtID0gdGJvLT5yZXNvdXJjZTsN
CisJc3RydWN0IGxzZGNfYm8gKmxibyA9IHRvX2xzZGNfYm8odGJvKTsNCisJaW50IHJldDsNCisN
CisJaWYgKHVubGlrZWx5KHRiby0+cGluX2NvdW50ID4gMCkpIHsNCisJCWRybV93YXJuKGRkZXYs
ICJDYW4ndCBtb3ZlIGEgcGlubmVkIEJPXG4iKTsNCisJCXJldHVybiAtRUlOVkFMOw0KKwl9DQor
DQorCXJldCA9IHR0bV9ib193YWl0X2N0eCh0Ym8sIGN0eCk7DQorCWlmIChyZXQpDQorCQlyZXR1
cm4gcmV0Ow0KKw0KKwlpZiAoIW9sZF9tZW0pIHsNCisJCWRybV9kYmcoZGRldiwgImJvWyVwXSBt
b3ZlOiBOVUxMIHRvICVzLCBzaXplOiAlenVcbiIsDQorCQkJbGJvLCBsc2RjX21lbV90eXBlX3Rv
X3N0cihuZXdfbWVtLT5tZW1fdHlwZSksDQorCQkJbHNkY19ib19zaXplKGxibykpOw0KKwkJdHRt
X2JvX21vdmVfbnVsbCh0Ym8sIG5ld19tZW0pOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJaWYg
KG9sZF9tZW0tPm1lbV90eXBlID09IFRUTV9QTF9TWVNURU0gJiYgIXRiby0+dHRtKSB7DQorCQl0
dG1fYm9fbW92ZV9udWxsKHRibywgbmV3X21lbSk7DQorCQlkcm1fZGJnKGRkZXYsICJib1slcF0g
bW92ZTogU1lTVEVNIHRvIE5VTEwsIHNpemU6ICV6dVxuIiwNCisJCQlsYm8sIGxzZGNfYm9fc2l6
ZShsYm8pKTsNCisJCXJldHVybiAwOw0KKwl9DQorDQorCWlmIChvbGRfbWVtLT5tZW1fdHlwZSA9
PSBUVE1fUExfU1lTVEVNICYmDQorCSAgICBuZXdfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfVFQp
IHsNCisJCWRybV9kYmcoZGRldiwgImJvWyVwXSBtb3ZlOiBTWVNURU0gdG8gR1RULCBzaXplOiAl
enVcbiIsDQorCQkJbGJvLCBsc2RjX2JvX3NpemUobGJvKSk7DQorCQl0dG1fYm9fbW92ZV9udWxs
KHRibywgbmV3X21lbSk7DQorCQlyZXR1cm4gMDsNCisJfQ0KKw0KKwlpZiAob2xkX21lbS0+bWVt
X3R5cGUgPT0gVFRNX1BMX1RUICYmDQorCSAgICBuZXdfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExf
U1lTVEVNKSB7DQorCQlkcm1fZGJnKGRkZXYsICJib1slcF0gbW92ZTogR1RUIHRvIFNZU1RFTSwg
c2l6ZTogJXp1XG4iLA0KKwkJCWxibywgbHNkY19ib19zaXplKGxibykpOw0KKwkJdHRtX3Jlc291
cmNlX2ZyZWUodGJvLCAmdGJvLT5yZXNvdXJjZSk7DQorCQl0dG1fYm9fYXNzaWduX21lbSh0Ym8s
IG5ld19tZW0pOw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJZHJtX2RiZyhkZGV2LCAiYm9bJXBd
IG1vdmU6ICVzIHRvICVzLCBzaXplOiAlenVcbiIsDQorCQlsYm8sDQorCQlsc2RjX21lbV90eXBl
X3RvX3N0cihvbGRfbWVtLT5tZW1fdHlwZSksDQorCQlsc2RjX21lbV90eXBlX3RvX3N0cihuZXdf
bWVtLT5tZW1fdHlwZSksDQorCQlsc2RjX2JvX3NpemUobGJvKSk7DQorDQorCXJldHVybiB0dG1f
Ym9fbW92ZV9tZW1jcHkodGJvLCBjdHgsIG5ld19tZW0pOw0KK30NCisNCitzdGF0aWMgaW50IGxz
ZGNfYm9fcmVzZXJ2ZV9pb19tZW0oc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsDQorCQkJCSAgc3Ry
dWN0IHR0bV9yZXNvdXJjZSAqbWVtKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
dGRldl90b19sZGV2KGJkZXYpOw0KKw0KKwlzd2l0Y2ggKG1lbS0+bWVtX3R5cGUpIHsNCisJY2Fz
ZSBUVE1fUExfU1lTVEVNOg0KKwkJYnJlYWs7DQorCWNhc2UgVFRNX1BMX1RUOg0KKwkJYnJlYWs7
DQorCWNhc2UgVFRNX1BMX1ZSQU06DQorCQltZW0tPmJ1cy5vZmZzZXQgPSAobWVtLT5zdGFydCA8
PCBQQUdFX1NISUZUKSArIGxkZXYtPnZyYW1fYmFzZTsNCisJCW1lbS0+YnVzLmlzX2lvbWVtID0g
dHJ1ZTsNCisJCW1lbS0+YnVzLmNhY2hpbmcgPSB0dG1fd3JpdGVfY29tYmluZWQ7DQorCQlicmVh
azsNCisJZGVmYXVsdDoNCisJCXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCXJldHVybiAwOw0K
K30NCisNCitzdGF0aWMgc3RydWN0IHR0bV9kZXZpY2VfZnVuY3MgbHNkY19ib19kcml2ZXIgPSB7
DQorCS50dG1fdHRfY3JlYXRlID0gbHNkY190dG1fdHRfY3JlYXRlLA0KKwkudHRtX3R0X3BvcHVs
YXRlID0gbHNkY190dG1fdHRfcG9wdWxhdGUsDQorCS50dG1fdHRfdW5wb3B1bGF0ZSA9IGxzZGNf
dHRtX3R0X3VucG9wdWxhdGUsDQorCS50dG1fdHRfZGVzdHJveSA9IGxzZGNfdHRtX3R0X2Rlc3Ry
b3ksDQorCS5ldmljdGlvbl92YWx1YWJsZSA9IHR0bV9ib19ldmljdGlvbl92YWx1YWJsZSwNCisJ
LmV2aWN0X2ZsYWdzID0gbHNkY19ib19ldmljdF9mbGFncywNCisJLm1vdmUgPSBsc2RjX2JvX21v
dmUsDQorCS5pb19tZW1fcmVzZXJ2ZSA9IGxzZGNfYm9fcmVzZXJ2ZV9pb19tZW0sDQorfTsNCisN
Cit1NjQgbHNkY19ib19ncHVfb2Zmc2V0KHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlzdHJ1
Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9ICZsYm8tPnRibzsNCisJc3RydWN0IGRybV9kZXZp
Y2UgKmRkZXYgPSB0Ym8tPmJhc2UuZGV2Ow0KKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXNvdXJj
ZSA9IHRiby0+cmVzb3VyY2U7DQorDQorCWlmICh1bmxpa2VseSghdGJvLT5waW5fY291bnQpKSB7
DQorCQlkcm1fZXJyKGRkZXYsICJ1bnBpbm5lZCBibywgZ3B1IHZpcnR1YWwgYWRkcmVzcyBpcyBp
bnZhbGlkXG4iKTsNCisJCXJldHVybiAwOw0KKwl9DQorDQorCWlmICh1bmxpa2VseShyZXNvdXJj
ZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1NZU1RFTSkpDQorCQlyZXR1cm4gMDsNCisNCisJcmV0dXJu
IHJlc291cmNlLT5zdGFydCA8PCBQQUdFX1NISUZUOw0KK30NCisNCitzaXplX3QgbHNkY19ib19z
aXplKHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KnRibyA9ICZsYm8tPnRibzsNCisNCisJcmV0dXJuIHRiby0+YmFzZS5zaXplOw0KK30NCisNCitp
bnQgbHNkY19ib19yZXNlcnZlKHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlyZXR1cm4gdHRt
X2JvX3Jlc2VydmUoJmxiby0+dGJvLCB0cnVlLCBmYWxzZSwgTlVMTCk7DQorfQ0KKw0KK3ZvaWQg
bHNkY19ib191bnJlc2VydmUoc3RydWN0IGxzZGNfYm8gKmxibykNCit7DQorCXJldHVybiB0dG1f
Ym9fdW5yZXNlcnZlKCZsYm8tPnRibyk7DQorfQ0KKw0KK2ludCBsc2RjX2JvX3BpbihzdHJ1Y3Qg
bHNkY19ibyAqbGJvLCB1MzIgZG9tYWluLCB1NjQgKmdwdV9hZGRyKQ0KK3sNCisJc3RydWN0IHR0
bV9vcGVyYXRpb25fY3R4IGN0eCA9IHsgZmFsc2UsIGZhbHNlIH07DQorCXN0cnVjdCB0dG1fYnVm
ZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSB0ZGV2X3RvX2xkZXYodGJvLT5iZGV2KTsNCisJaW50IHJldDsNCisNCisJaWYgKHRiby0+cGlu
X2NvdW50KQ0KKwkJZ290byBib19waW5uZWQ7DQorDQorCWlmIChsYm8tPnNoYXJpbmdfY291bnQg
JiYgZG9tYWluID09IExTRENfR0VNX0RPTUFJTl9WUkFNKQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQor
DQorCWlmIChkb21haW4pDQorCQlsc2RjX2JvX3NldF9wbGFjZW1lbnQobGJvLCBkb21haW4pOw0K
Kw0KKwlyZXQgPSB0dG1fYm9fdmFsaWRhdGUodGJvLCAmbGJvLT5wbGFjZW1lbnQsICZjdHgpOw0K
KwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJZHJtX2VycigmbGRldi0+YmFzZSwgIiVwIHZhbGlk
YXRlIGZhaWxlZDogJWRcbiIsIGxibywgcmV0KTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJ
aWYgKGRvbWFpbiA9PSBMU0RDX0dFTV9ET01BSU5fVlJBTSkNCisJCWxkZXYtPnZyYW1fcGlubmVk
X3NpemUgKz0gbHNkY19ib19zaXplKGxibyk7DQorCWVsc2UgaWYgKGRvbWFpbiA9PSBMU0RDX0dF
TV9ET01BSU5fR1RUKQ0KKwkJbGRldi0+Z3R0X3Bpbm5lZF9zaXplICs9IGxzZGNfYm9fc2l6ZShs
Ym8pOw0KKw0KK2JvX3Bpbm5lZDoNCisJdHRtX2JvX3Bpbih0Ym8pOw0KKw0KKwlpZiAoZ3B1X2Fk
ZHIpDQorCQkqZ3B1X2FkZHIgPSBsc2RjX2JvX2dwdV9vZmZzZXQobGJvKTsNCisNCisJcmV0dXJu
IDA7DQorfQ0KKw0KK3ZvaWQgbHNkY19ib191bnBpbihzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sN
CisJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8gPSAmbGJvLT50Ym87DQorCXN0cnVjdCBs
c2RjX2RldmljZSAqbGRldiA9IHRkZXZfdG9fbGRldih0Ym8tPmJkZXYpOw0KKw0KKwlpZiAodW5s
aWtlbHkoIXRiby0+cGluX2NvdW50KSkgew0KKwkJZHJtX2RiZygmbGRldi0+YmFzZSwgIiVwIHVu
cGluIGlzIG5vdCBuZWNlc3NhcnlcbiIsIGxibyk7DQorCQlyZXR1cm47DQorCX0NCisNCisJdHRt
X2JvX3VucGluKHRibyk7DQorDQorCWlmICghdGJvLT5waW5fY291bnQpIHsNCisJCWlmICh0Ym8t
PnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJBTSkNCisJCQlsZGV2LT52cmFtX3Bpbm5l
ZF9zaXplIC09IGxzZGNfYm9fc2l6ZShsYm8pOw0KKwkJZWxzZSBpZiAodGJvLT5yZXNvdXJjZS0+
bWVtX3R5cGUgPT0gVFRNX1BMX1RUKQ0KKwkJCWxkZXYtPmd0dF9waW5uZWRfc2l6ZSAtPSBsc2Rj
X2JvX3NpemUobGJvKTsNCisJfQ0KK30NCisNCit2b2lkIGxzZGNfYm9fcmVmKHN0cnVjdCBsc2Rj
X2JvICpsYm8pDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9ICZsYm8tPnRi
bzsNCisNCisJdHRtX2JvX2dldCh0Ym8pOw0KK30NCisNCit2b2lkIGxzZGNfYm9fdW5yZWYoc3Ry
dWN0IGxzZGNfYm8gKmxibykNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0g
Jmxiby0+dGJvOw0KKw0KKwl0dG1fYm9fcHV0KHRibyk7DQorfQ0KKw0KK2ludCBsc2RjX2JvX2tt
YXAoc3RydWN0IGxzZGNfYm8gKmxibykNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
dGJvID0gJmxiby0+dGJvOw0KKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSA9ICZ0Ym8tPmJh
c2U7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gZ2VtLT5kZXY7DQorCWxvbmcgcmV0Ow0K
KwlpbnQgZXJyOw0KKw0KKwlyZXQgPSBkbWFfcmVzdl93YWl0X3RpbWVvdXQoZ2VtLT5yZXN2LA0K
KwkJCQkgICAgRE1BX1JFU1ZfVVNBR0VfS0VSTkVMLA0KKwkJCQkgICAgZmFsc2UsDQorCQkJCSAg
ICBNQVhfU0NIRURVTEVfVElNRU9VVCk7DQorCWlmIChyZXQgPCAwKSB7DQorCQlkcm1fd2Fybihk
ZGV2LCAid2FpdCBmZW5jZSB0aW1lb3V0XG4iKTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJ
aWYgKGxiby0+a3B0cikNCisJCXJldHVybiAwOw0KKw0KKwllcnIgPSB0dG1fYm9fa21hcCh0Ym8s
IDAsIFBGTl9VUChsc2RjX2JvX3NpemUobGJvKSksICZsYm8tPmttYXApOw0KKwlpZiAoZXJyKSB7
DQorCQlkcm1fZXJyKGRkZXYsICJrbWFwICVwIGZhaWxlZDogJWRcbiIsIGxibywgZXJyKTsNCisJ
CXJldHVybiBlcnI7DQorCX0NCisNCisJbGJvLT5rcHRyID0gdHRtX2ttYXBfb2JqX3ZpcnR1YWwo
Jmxiby0+a21hcCwgJmxiby0+aXNfaW9tZW0pOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQordm9p
ZCBsc2RjX2JvX2t1bm1hcChzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJaWYgKCFsYm8tPmtw
dHIpDQorCQlyZXR1cm47DQorDQorCWxiby0+a3B0ciA9IE5VTEw7DQorCXR0bV9ib19rdW5tYXAo
Jmxiby0+a21hcCk7DQorfQ0KKw0KK3ZvaWQgbHNkY19ib19jbGVhcihzdHJ1Y3QgbHNkY19ibyAq
bGJvKQ0KK3sNCisJbHNkY19ib19rbWFwKGxibyk7DQorDQorCWlmIChsYm8tPmlzX2lvbWVtKQ0K
KwkJbWVtc2V0X2lvKCh2b2lkIF9faW9tZW0gKilsYm8tPmtwdHIsIDAsIGxiby0+c2l6ZSk7DQor
CWVsc2UNCisJCW1lbXNldChsYm8tPmtwdHIsIDAsIGxiby0+c2l6ZSk7DQorDQorCWxzZGNfYm9f
a3VubWFwKGxibyk7DQorfQ0KKw0KK2ludCBsc2RjX2JvX2V2aWN0X3ZyYW0oc3RydWN0IGRybV9k
ZXZpY2UgKmRkZXYpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRk
ZXYpOw0KKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9ICZsZGV2LT5iZGV2Ow0KKwlzdHJ1Y3Qg
dHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbjsNCisNCisJbWFuID0gdHRtX21hbmFnZXJfdHlwZShi
ZGV2LCBUVE1fUExfVlJBTSk7DQorCWlmICh1bmxpa2VseSghbWFuKSkNCisJCXJldHVybiAwOw0K
Kw0KKwlyZXR1cm4gdHRtX3Jlc291cmNlX21hbmFnZXJfZXZpY3RfYWxsKGJkZXYsIG1hbik7DQor
fQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfYm9fZGVzdHJveShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmpl
Y3QgKnRibykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRkZXZfdG9fbGRldih0
Ym8tPmJkZXYpOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvID0gdG9fbHNkY19ibyh0Ym8pOw0KKw0K
KwltdXRleF9sb2NrKCZsZGV2LT5nZW0ubXV0ZXgpOw0KKwlsaXN0X2RlbF9pbml0KCZsYm8tPmxp
c3QpOw0KKwltdXRleF91bmxvY2soJmxkZXYtPmdlbS5tdXRleCk7DQorDQorCWRybV9nZW1fb2Jq
ZWN0X3JlbGVhc2UoJnRiby0+YmFzZSk7DQorDQorCWtmcmVlKGxibyk7DQorfQ0KKw0KK3N0cnVj
dCBsc2RjX2JvICpsc2RjX2JvX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkg
ICAgICAgdTMyIGRvbWFpbiwNCisJCQkgICAgICAgc2l6ZV90IHNpemUsDQorCQkJICAgICAgIGJv
b2wga2VybmVsLA0KKwkJCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLA0KKwkJCSAgICAgICBz
dHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0
b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9ICZsZGV2LT5iZGV2Ow0K
KwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibzsNCisJc3RydWN0IGxzZGNfYm8gKmxibzsN
CisJZW51bSB0dG1fYm9fdHlwZSBib190eXBlOw0KKwlpbnQgcmV0Ow0KKw0KKwlsYm8gPSBremFs
bG9jKHNpemVvZigqbGJvKSwgR0ZQX0tFUk5FTCk7DQorCWlmICghbGJvKQ0KKwkJcmV0dXJuIEVS
Ul9QVFIoLUVOT01FTSk7DQorDQorCUlOSVRfTElTVF9IRUFEKCZsYm8tPmxpc3QpOw0KKw0KKwls
Ym8tPmluaXRpYWxfZG9tYWluID0gZG9tYWluICYgKExTRENfR0VNX0RPTUFJTl9WUkFNIHwNCisJ
CQkJCUxTRENfR0VNX0RPTUFJTl9HVFQgfA0KKwkJCQkJTFNEQ19HRU1fRE9NQUlOX1NZU1RFTSk7
DQorDQorCXRibyA9ICZsYm8tPnRibzsNCisNCisJc2l6ZSA9IEFMSUdOKHNpemUsIFBBR0VfU0la
RSk7DQorDQorCXJldCA9IGRybV9nZW1fb2JqZWN0X2luaXQoZGRldiwgJnRiby0+YmFzZSwgc2l6
ZSk7DQorCWlmIChyZXQpIHsNCisJCWtmcmVlKGxibyk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQp
Ow0KKwl9DQorDQorCXRiby0+YmRldiA9IGJkZXY7DQorDQorCWlmIChrZXJuZWwpDQorCQlib190
eXBlID0gdHRtX2JvX3R5cGVfa2VybmVsOw0KKwllbHNlIGlmIChzZykNCisJCWJvX3R5cGUgPSB0
dG1fYm9fdHlwZV9zZzsNCisJZWxzZQ0KKwkJYm9fdHlwZSA9IHR0bV9ib190eXBlX2RldmljZTsN
CisNCisJbHNkY19ib19zZXRfcGxhY2VtZW50KGxibywgZG9tYWluKTsNCisJbGJvLT5zaXplID0g
c2l6ZTsNCisNCisJcmV0ID0gdHRtX2JvX2luaXRfdmFsaWRhdGUoYmRldiwNCisJCQkJICAgdGJv
LA0KKwkJCQkgICBib190eXBlLA0KKwkJCQkgICAmbGJvLT5wbGFjZW1lbnQsDQorCQkJCSAgIDAs
DQorCQkJCSAgIGZhbHNlLA0KKwkJCQkgICBzZywNCisJCQkJICAgcmVzdiwNCisJCQkJICAgbHNk
Y19ib19kZXN0cm95KTsNCisJaWYgKHJldCkgew0KKwkJa2ZyZWUobGJvKTsNCisJCXJldHVybiBF
UlJfUFRSKHJldCk7DQorCX0NCisNCisJcmV0dXJuIGxibzsNCit9DQorDQorc3RydWN0IGxzZGNf
Ym8gKmxzZGNfYm9fY3JlYXRlX2tlcm5lbF9waW5uZWQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYs
DQorCQkJCQkgICAgIHUzMiBkb21haW4sDQorCQkJCQkgICAgIHNpemVfdCBzaXplKQ0KK3sNCisJ
c3RydWN0IGxzZGNfYm8gKmxibzsNCisJaW50IHJldDsNCisNCisJbGJvID0gbHNkY19ib19jcmVh
dGUoZGRldiwgZG9tYWluLCBzaXplLCB0cnVlLCBOVUxMLCBOVUxMKTsNCisNCisJcmV0ID0gbHNk
Y19ib19yZXNlcnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKSB7DQorCQlsc2RjX2JvX3Vu
cmVmKGxibyk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9DQorDQorCXJldCA9IGxzZGNf
Ym9fcGluKGxibywgZG9tYWluLCBOVUxMKTsNCisJbHNkY19ib191bnJlc2VydmUobGJvKTsNCisJ
aWYgKHVubGlrZWx5KHJldCkpIHsNCisJCWxzZGNfYm9fdW5yZWYobGJvKTsNCisJCXJldHVybiBF
UlJfUFRSKHJldCk7DQorCX0NCisNCisJcmV0dXJuIGxibzsNCit9DQorDQordm9pZCBsc2RjX2Jv
X2ZyZWVfa2VybmVsX3Bpbm5lZChzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJaW50IHJldDsN
CisNCisJcmV0ID0gbHNkY19ib19yZXNlcnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKQ0K
KwkJcmV0dXJuOw0KKw0KKwlsc2RjX2JvX3VucGluKGxibyk7DQorCWxzZGNfYm9fdW5yZXNlcnZl
KGxibyk7DQorDQorCWxzZGNfYm9fdW5yZWYobGJvKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNk
Y190dG1fZmluaShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwgdm9pZCAqZGF0YSkNCit7DQorCXN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IChzdHJ1Y3QgbHNkY19kZXZpY2UgKilkYXRhOw0KKw0K
Kwl0dG1fcmFuZ2VfbWFuX2ZpbmkoJmxkZXYtPmJkZXYsIFRUTV9QTF9WUkFNKTsNCisJdHRtX3Jh
bmdlX21hbl9maW5pKCZsZGV2LT5iZGV2LCBUVE1fUExfVFQpOw0KKw0KKwl0dG1fZGV2aWNlX2Zp
bmkoJmxkZXYtPmJkZXYpOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJ0dG0gZmluaXNoZWRcbiIpOw0K
K30NCisNCitpbnQgbHNkY190dG1faW5pdChzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYpDQorew0K
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9ICZsZGV2LT5iYXNlOw0KKwl1bnNpZ25lZCBsb25n
IG51bV92cmFtX3BhZ2VzOw0KKwl1bnNpZ25lZCBsb25nIG51bV9ndHRfcGFnZXM7DQorCWludCBy
ZXQ7DQorDQorCXJldCA9IHR0bV9kZXZpY2VfaW5pdCgmbGRldi0+YmRldiwNCisJCQkgICAgICAm
bHNkY19ib19kcml2ZXIsDQorCQkJICAgICAgZGRldi0+ZGV2LA0KKwkJCSAgICAgIGRkZXYtPmFu
b25faW5vZGUtPmlfbWFwcGluZywNCisJCQkgICAgICBkZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIs
DQorCQkJICAgICAgZmFsc2UsDQorCQkJICAgICAgZmFsc2UpOw0KKwlpZiAocmV0KQ0KKwkJcmV0
dXJuIHJldDsNCisNCisJbnVtX3ZyYW1fcGFnZXMgPSBsZGV2LT52cmFtX3NpemUgPj4gUEFHRV9T
SElGVDsNCisNCisJcmV0ID0gdHRtX3JhbmdlX21hbl9pbml0KCZsZGV2LT5iZGV2LA0KKwkJCQkg
VFRNX1BMX1ZSQU0sDQorCQkJCSBmYWxzZSwNCisJCQkJIG51bV92cmFtX3BhZ2VzKTsNCisJaWYg
KHVubGlrZWx5KHJldCkpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlkcm1faW5mbyhkZGV2LCAiVlJB
TTogJWx1IHBhZ2VzIHJlYWR5XG4iLCBudW1fdnJhbV9wYWdlcyk7DQorDQorCS8qIDUxMk0gaXMg
ZmFyIGVub3VnaCBmb3IgdXMgbm93ICovDQorCWxkZXYtPmd0dF9zaXplID0gNTEyIDw8IDIwOw0K
Kw0KKwludW1fZ3R0X3BhZ2VzID0gbGRldi0+Z3R0X3NpemUgPj4gUEFHRV9TSElGVDsNCisNCisJ
cmV0ID0gdHRtX3JhbmdlX21hbl9pbml0KCZsZGV2LT5iZGV2LA0KKwkJCQkgVFRNX1BMX1RULA0K
KwkJCQkgdHJ1ZSwNCisJCQkJIG51bV9ndHRfcGFnZXMpOw0KKwlpZiAodW5saWtlbHkocmV0KSkN
CisJCXJldHVybiByZXQ7DQorDQorCWRybV9pbmZvKGRkZXYsICJHVFQ6ICVsdSBwYWdlcyByZWFk
eVxuIiwgbnVtX2d0dF9wYWdlcyk7DQorDQorCXJldHVybiBkcm1tX2FkZF9hY3Rpb25fb3JfcmVz
ZXQoZGRldiwgbHNkY190dG1fZmluaSwgbGRldik7DQorfQ0KKw0KK3ZvaWQgbHNkY190dG1fZGVi
dWdmc19pbml0KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldikNCit7DQorCXN0cnVjdCB0dG1fZGV2
aWNlICpiZGV2ID0gJmxkZXYtPmJkZXY7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gJmxk
ZXYtPmJhc2U7DQorCXN0cnVjdCBkcm1fbWlub3IgKm1pbm9yID0gZGRldi0+cHJpbWFyeTsNCisJ
c3RydWN0IGRlbnRyeSAqcm9vdCA9IG1pbm9yLT5kZWJ1Z2ZzX3Jvb3Q7DQorCXN0cnVjdCB0dG1f
cmVzb3VyY2VfbWFuYWdlciAqdnJhbV9tYW47DQorCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdl
ciAqZ3R0X21hbjsNCisNCisJdnJhbV9tYW4gPSB0dG1fbWFuYWdlcl90eXBlKGJkZXYsIFRUTV9Q
TF9WUkFNKTsNCisJZ3R0X21hbiA9IHR0bV9tYW5hZ2VyX3R5cGUoYmRldiwgVFRNX1BMX1RUKTsN
CisNCisJdHRtX3Jlc291cmNlX21hbmFnZXJfY3JlYXRlX2RlYnVnZnModnJhbV9tYW4sIHJvb3Qs
ICJ2cmFtX21tIik7DQorCXR0bV9yZXNvdXJjZV9tYW5hZ2VyX2NyZWF0ZV9kZWJ1Z2ZzKGd0dF9t
YW4sIHJvb3QsICJndHRfbW0iKTsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xv
b25nc29uL2xzZGNfdHRtLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uaA0K
bmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uNmVmMzFkNzAyZGNhDQot
LS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uaA0K
QEAgLTAsMCArMSw5OSBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICov
DQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3Jh
dGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfVFRNX0hfXw0KKyNkZWZpbmUg
X19MU0RDX1RUTV9IX18NCisNCisjaW5jbHVkZSA8bGludXgvY29udGFpbmVyX29mLmg+DQorI2lu
Y2x1ZGUgPGxpbnV4L2lvc3lzLW1hcC5oPg0KKyNpbmNsdWRlIDxsaW51eC9saXN0Lmg+DQorDQor
I2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+DQorI2luY2x1ZGUgPGRybS90dG0vdHRtX2JvLmg+DQor
I2luY2x1ZGUgPGRybS90dG0vdHRtX3BsYWNlbWVudC5oPg0KKyNpbmNsdWRlIDxkcm0vdHRtL3R0
bV9yYW5nZV9tYW5hZ2VyLmg+DQorI2luY2x1ZGUgPGRybS90dG0vdHRtX3R0Lmg+DQorDQorI2Rl
ZmluZSBMU0RDX0dFTV9ET01BSU5fU1lTVEVNICAgICAgICAgIDB4MQ0KKyNkZWZpbmUgTFNEQ19H
RU1fRE9NQUlOX0dUVCAgICAgICAgICAgICAweDINCisjZGVmaW5lIExTRENfR0VNX0RPTUFJTl9W
UkFNICAgICAgICAgICAgMHg0DQorDQorc3RydWN0IGxzZGNfYm8gew0KKwlzdHJ1Y3QgdHRtX2J1
ZmZlcl9vYmplY3QgdGJvOw0KKw0KKwkvKiBQcm90ZWN0ZWQgYnkgZ2VtLm11dGV4ICovDQorCXN0
cnVjdCBsaXN0X2hlYWQgbGlzdDsNCisNCisJc3RydWN0IGlvc3lzX21hcCBtYXA7DQorDQorCXVu
c2lnbmVkIGludCB2bWFwX2NvdW50Ow0KKwkvKiBjcm9zcyBkZXZpY2UgZHJpdmVyIHNoYXJpbmcg
cmVmZXJlbmNlIGNvdW50ICovDQorCXVuc2lnbmVkIGludCBzaGFyaW5nX2NvdW50Ow0KKw0KKwlz
dHJ1Y3QgdHRtX2JvX2ttYXBfb2JqIGttYXA7DQorCXZvaWQgKmtwdHI7DQorCWJvb2wgaXNfaW9t
ZW07DQorDQorCXNpemVfdCBzaXplOw0KKw0KKwl1MzIgaW5pdGlhbF9kb21haW47DQorDQorCXN0
cnVjdCB0dG1fcGxhY2VtZW50IHBsYWNlbWVudDsNCisJc3RydWN0IHR0bV9wbGFjZSBwbGFjZW1l
bnRzWzRdOw0KK307DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3Qg
KnRvX3R0bV9ibyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSkNCit7DQorCXJldHVybiBjb250
YWluZXJfb2YoZ2VtLCBzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QsIGJhc2UpOw0KK30NCisNCitz
dGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX2JvICp0b19sc2RjX2JvKHN0cnVjdCB0dG1fYnVmZmVy
X29iamVjdCAqdGJvKQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9vZih0Ym8sIHN0cnVjdCBsc2Rj
X2JvLCB0Ym8pOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX2JvICpnZW1fdG9f
bHNkY19ibyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdlbSkNCit7DQorCXJldHVybiBjb250YWlu
ZXJfb2YoZ2VtLCBzdHJ1Y3QgbHNkY19ibywgdGJvLmJhc2UpOw0KK30NCisNCitjb25zdCBjaGFy
ICpsc2RjX21lbV90eXBlX3RvX3N0cih1aW50MzJfdCBtZW1fdHlwZSk7DQorY29uc3QgY2hhciAq
bHNkY19kb21haW5fdG9fc3RyKHUzMiBkb21haW4pOw0KKw0KK3N0cnVjdCBsc2RjX2JvICpsc2Rj
X2JvX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgICAgdTMyIGRvbWFp
biwNCisJCQkgICAgICAgc2l6ZV90IHNpemUsDQorCQkJICAgICAgIGJvb2wga2VybmVsLA0KKwkJ
CSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLA0KKwkJCSAgICAgICBzdHJ1Y3QgZG1hX3Jlc3Yg
KnJlc3YpOw0KKw0KK3N0cnVjdCBsc2RjX2JvICpsc2RjX2JvX2NyZWF0ZV9rZXJuZWxfcGlubmVk
KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCQkJICAgICB1MzIgZG9tYWluLA0KKwkJCQkJ
ICAgICBzaXplX3Qgc2l6ZSk7DQorDQordm9pZCBsc2RjX2JvX2ZyZWVfa2VybmVsX3Bpbm5lZChz
dHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCitpbnQgbHNkY19ib19yZXNlcnZlKHN0cnVjdCBsc2Rj
X2JvICpsYm8pOw0KK3ZvaWQgbHNkY19ib191bnJlc2VydmUoc3RydWN0IGxzZGNfYm8gKmxibyk7
DQorDQoraW50IGxzZGNfYm9fcGluKHN0cnVjdCBsc2RjX2JvICpsYm8sIHUzMiBkb21haW4sIHU2
NCAqZ3B1X2FkZHIpOw0KK3ZvaWQgbHNkY19ib191bnBpbihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsN
CisNCit2b2lkIGxzZGNfYm9fcmVmKHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3ZvaWQgbHNkY19i
b191bnJlZihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCit1NjQgbHNkY19ib19ncHVfb2Zmc2V0
KHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3NpemVfdCBsc2RjX2JvX3NpemUoc3RydWN0IGxzZGNf
Ym8gKmxibyk7DQorDQoraW50IGxzZGNfYm9fa21hcChzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCit2
b2lkIGxzZGNfYm9fa3VubWFwKHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3ZvaWQgbHNkY19ib19j
bGVhcihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCitpbnQgbHNkY19ib19ldmljdF92cmFtKHN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2KTsNCisNCitpbnQgbHNkY190dG1faW5pdChzdHJ1Y3QgbHNk
Y19kZXZpY2UgKmxkZXYpOw0KK3ZvaWQgbHNkY190dG1fZGVidWdmc19pbml0KHN0cnVjdCBsc2Rj
X2RldmljZSAqbGRldik7DQorDQorI2VuZGlmDQotLSANCjIuMjUuMQ0KDQpfX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcg
bGlzdCAtLSBsaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKVG8gdW5zdWJzY3JpYmUgc2Vu
ZCBhbiBlbWFpbCB0byBsaW5hcm8tbW0tc2lnLWxlYXZlQGxpc3RzLmxpbmFyby5vcmcK
