Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 41515703205
	for <lists+linaro-mm-sig@lfdr.de>; Mon, 15 May 2023 17:58:23 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 4E294443CE
	for <lists+linaro-mm-sig@lfdr.de>; Mon, 15 May 2023 15:58:22 +0000 (UTC)
Received: from loongson.cn (mail.loongson.cn [114.242.206.163])
	by lists.linaro.org (Postfix) with ESMTP id 1863344242
	for <linaro-mm-sig@lists.linaro.org>; Mon, 15 May 2023 15:57:40 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=none;
	spf=pass (lists.linaro.org: domain of suijingfeng@loongson.cn designates 114.242.206.163 as permitted sender) smtp.mailfrom=suijingfeng@loongson.cn;
	dmarc=none
Received: from loongson.cn (unknown [10.20.42.43])
	by gateway (Coremail) with SMTP id _____8AxX+tzVmJk890IAA--.15393S3;
	Mon, 15 May 2023 23:57:39 +0800 (CST)
Received: from openarena.loongson.cn (unknown [10.20.42.43])
	by localhost.localdomain (Coremail) with SMTP id AQAAf8BxBMVuVmJkr6lgAA--.36828S3;
	Mon, 15 May 2023 23:57:36 +0800 (CST)
From: Sui Jingfeng <suijingfeng@loongson.cn>
To: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>,
	Maxime Ripard <mripard@kernel.org>,
	Thomas Zimmermann <tzimmermann@suse.de>,
	David Airlie <airlied@gmail.com>,
	Daniel Vetter <daniel@ffwll.ch>,
	Sui Jingfeng <suijingfeng@loongson.cn>,
	suijingfeng <15330273260@189.cn>,
	Sumit Semwal <sumit.semwal@linaro.org>,
	Christian Koenig <christian.koenig@amd.com>,
	Emil Velikov <emil.l.velikov@gmail.com>
Date: Mon, 15 May 2023 23:57:33 +0800
Message-Id: <20230515155734.2954149-2-suijingfeng@loongson.cn>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20230515155734.2954149-1-suijingfeng@loongson.cn>
References: <20230515155734.2954149-1-suijingfeng@loongson.cn>
MIME-Version: 1.0
X-CM-TRANSID: AQAAf8BxBMVuVmJkr6lgAA--.36828S3
X-CM-SenderInfo: xvxlyxpqjiv03j6o00pqjv00gofq/
X-Coremail-Antispam: 1Uk129KBjvtXoWkAryUtw1xCF4xWFyfuryUKFg_yoW8CFWxuF
	X_CFy2vr1DGw1DuryFqw1UGw1xtF93Cry7XF4DWFWIyFZ7tr4DX345ArW3Xr1xuFy5u3W8
	tF98G34kCFy0yF1IgjkaLaAFLSUrUUUUeb8apTn2vfkv8UJUUUU8wcxFpf9Il3svdxBIda
	Vrn0xqx4xG64xvF2IEw4CE5I8CrVC2j2Jv73VFW2AGmfu7bjvjm3AaLaJ3UjIYCTnIWjp_
	UUUYX7kC6x804xWl14x267AKxVWUJVW8JwAFc2x0x2IEx4CE42xK8VAvwI8IcIk0rVWrJV
	Cq3wAFIxvE14AKwVWUAVWUZwA2ocxC64kIII0Yj41l84x0c7CEw4AK67xGY2AK021l84AC
	jcxK6xIIjxv20xvE14v26ryj6F1UM28EF7xvwVC0I7IYx2IY6xkF7I0E14v26r4j6F4UM2
	8EF7xvwVC2z280aVAFwI0_Cr1j6rxdM28EF7xvwVC2z280aVCY1x0267AKxVW0oVCq3wAa
	w2AFwI0_JF0_Jw1le2I262IYc4CY6c8Ij28IcVAaY2xG8wAqjxCEc2xF0cIa020Ex4CE44
	I27wAqx4xG64xvF2IEw4CE5I8CrVC2j2WlYx0E2Ix0cI8IcVAFwI0_Jw0_WrylYx0Ex4A2
	jsIE14v26r4j6F4UMcvjeVCFs4IE7xkEbVWUJVW8JwACjcxG0xvY0x0EwIxGrwCY1x0262
	kKe7AKxVWUAVWUtwCF04k20xvY0x0EwIxGrwCFx2IqxVCFs4IE7xkEbVWUJVW8JwCFI7km
	07C267AKxVWUAVWUtwC20s026c02F40E14v26r1j6r18MI8I3I0E7480Y4vE14v26r106r
	1rMI8E67AF67kF1VAFwI0_GFv_WrylIxkGc2Ij64vIr41lIxAIcVC0I7IYx2IY67AKxVW5
	JVW7JwCI42IY6xIIjxv20xvEc7CjxVAFwI0_Gr0_Cr1lIxAIcVCF04k26cxKx2IYs7xG6r
	1j6r1xMIIF0xvEx4A2jsIE14v26r4j6F4UMIIF0xvEx4A2jsIEc7CjxVAFwI0_Gr0_Gr1U
	YxBIdaVFxhVjvjDU0xZFpf9x07jr6p9UUUUU=
X-Spamd-Result: default: False [-4.70 / 15.00];
	REPLY(-4.00)[];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	MID_CONTAINS_FROM(1.00)[];
	R_SPF_ALLOW(-0.20)[+ip4:114.242.206.163:c];
	RCVD_NO_TLS_LAST(0.10)[];
	MIME_GOOD(-0.10)[text/plain];
	MIME_TRACE(0.00)[0:+];
	FREEMAIL_TO(0.00)[linux.intel.com,kernel.org,suse.de,gmail.com,ffwll.ch,loongson.cn,189.cn,linaro.org,amd.com];
	R_DKIM_NA(0.00)[];
	ASN(0.00)[asn:4808, ipnet:114.242.192.0/18, country:CN];
	FROM_EQ_ENVFROM(0.00)[];
	NEURAL_HAM(-0.00)[-0.652];
	RCPT_COUNT_TWELVE(0.00)[17];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	FROM_HAS_DN(0.00)[];
	RCVD_COUNT_TWO(0.00)[2];
	TO_DN_SOME(0.00)[];
	DMARC_NA(0.00)[loongson.cn];
	TAGGED_RCPT(0.00)[];
	ARC_NA(0.00)[]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: 1863344242
X-Spamd-Bar: ----
Message-ID-Hash: F2HMYGTHFIGK62GEWSTFGY4GVI7HWZU4
X-Message-ID-Hash: F2HMYGTHFIGK62GEWSTFGY4GVI7HWZU4
X-MailFrom: suijingfeng@loongson.cn
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: Nathan Chancellor <nathan@kernel.org>, linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org, linux-media@vger.kernel.org, linaro-mm-sig@lists.linaro.org, loongson-kernel@lists.loongnix.cn, Li Yi <liyi@loongson.cn>
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH v13 1/2] drm: add kms driver for loongson display controller
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/F2HMYGTHFIGK62GEWSTFGY4GVI7HWZU4/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

TG9vbmdzb24gZGlzcGxheSBjb250cm9sbGVyIElQIGhhcyBiZWVuIGludGVncmF0ZWQgaW4gYm90
aCBMb29uZ3NvbiBub3J0aA0KYnJpZGdlIGNoaXBzZXQobHM3YTEwMDAvbHM3YTIwMDApIGFuZCBM
b29uZ3NvbiBTb0NzKGxzMmsxMDAwL2xzMmsyMDAwKSwgaXQNCmhhcyBiZWVuIGV2ZW4gaW5jbHVk
ZWQgaW4gTG9vbmdzb24gc2VsZi1tYWRlIEJNQyBwcm9kdWN0cy4NCg0KVGhpcyBkaXNwbGF5IGNv
bnRyb2xsZXIgaXMgYSBQQ0kgZGV2aWNlLiBJdCBoYXMgdHdvIGRpc3BsYXkgcGlwZXMgYW5kIGVh
Y2gNCmRpc3BsYXkgcGlwZSBzdXBwb3J0IGEgcHJpbWFyeSBwbGFuZSBhbmQgYSBjdXJzb3IgcGxh
bmUuIEZvciB0aGUgREMgaW4gdGhlDQpsczdhMTAwMCBhbmQgbHMyazEwMDAsIGVhY2ggZGlzcGxh
eSBwaXBlIGhhcyBhIERWTyBvdXRwdXQgaW50ZXJmYWNlIHdoaWNoDQpwcm92aWRlIFJHQjg4OCBz
aWduYWxzLCB2ZXJ0aWNhbCAmIGhvcml6b250YWwgc3luY2hyb25pc2F0aW9ucyBhbmQgcGl4ZWwN
CmNsb2NrLiBFYWNoIENSVEMgaXMgYWJsZSB0byBzdXBwb3J0IDE5MjB4MTA4MEA2MEh6LCB0aGUg
bWF4aW11bSByZXNvbHV0aW9uDQpvZiBlYWNoIGRpc3BsYXkgcGlwZSBpcyAyMDQ4eDIwNDggYWNj
b3JkaW5nIHRvIHRoZSBoYXJkd2FyZSBzcGVjLg0KDQpGb3IgdGhlIERDIGluIExTN0EyMDAwLCBl
YWNoIGRpc3BsYXkgcGlwZSBpcyBlcXVpcHBlZCB3aXRoIGEgYnVpbHQtaW4gSERNSQ0KZW5jb2Rl
ciB3aGljaCBpcyBjb21wbGlhbnQgd2l0aCB0aGUgSERNSSAxLjQgc3BlY2lmaWNhdGlvbiwgdGh1
cyBpdCBzdXBwb3J0DQozODQweDIxNjBAMzBIei4gVGhlIGZpcnN0IGRpc3BsYXkgcGlwZSBpcyBh
bHNvIGVxdWlwcGVkIHdpdGggYSB0cmFuc3BhcmVudA0KdmdhIGVuY29kZXIgd2hpY2ggaXMgcGFy
YWxsZWwgd2l0aCB0aGUgSERNSSBlbmNvZGVyLiBUaGUgREMgaW4gTFM3QTIwMDAgaXMNCm1vcmUg
Y29tcGxldGUgY29tcGFyZSB3aXRoIHRoZSBvbmUgaW4gb2xkIGNoaXBzLCBiZXNpZGVzIGFib3Zl
IGZlYXR1cmUsIGl0DQpoYXMgdHdvIGhhcmR3YXJlIGN1cnNvcnMsIHR3byBoYXJkd2FyZSB2Ymxh
bmsgY291bnRlciBhbmQgdHdvIHNjYW5vdXQNCnBvc2l0aW9uIHJlY29yZGVycyB1bml0LiBJdCBh
bHNvIHN1cHBvcnQgdGlsZWQgZnJhbWVidWZmZXIgZm9ybWF0IHdoaWNoDQpjYW4gYmUgc2Nhbm91
dCB0aGUgdGlsZWQgZnJhbWVidWZmZXIgcmVuZGVyZWQgYnkgdGhlIExvb25nR1BVIGRpcmVjdGx5
Lg0KDQp2MSAtPiB2MjoNCiAxKSBVc2UgaHBkIHN0YXR1cyByZWcgd2hlbiBwb2xsaW5nIGZvciBs
czdhMjAwMA0KIDIpIEZpeCBhbGwgd2FybmluZ3MgZW1lcmdlZCB3aGVuIGNvbXBpbGUgd2l0aCBX
PTENCg0KdjIgLT4gdjM6DQogMSkgQWRkIENPTVBJTEVfVEVTVCBpbiBLY29uZmlnIGFuZCBtYWtl
IHRoZSBkcml2ZXIgb2ZmIGJ5IGRlZmF1bHQNCiAyKSBBbHBoYWJldGljYWwgc29ydGluZyBoZWFk
ZXJzIChUaG9tYXMpDQogMykgVW50YW5nbGUgcmVnaXN0ZXIgYWNjZXNzIGZ1bmN0aW9ucyBhcyBt
dWNoIGFzIHBvc3NpYmxlIChUaG9tYXMpDQogNCkgU3dpdGNoIHRvIFRUTSBiYXNlZCBtZW1vcnkg
bWFuYWdlciBhbmQgcHJlZmVyIGNhY2hlZCBtYXBwaW5nDQogICAgZm9yIExvb25nc29uIFNvQyAo
VGhvbWFzKQ0KIDUpIEFkZCBjaGlwIGlkIGRldGVjdGlvbiBtZXRob2QsIG5vdyBhbGwgbW9kZWxz
IGFyZSBkaXN0aW5ndWlzaGFibGUuDQogNikgUmV2aXNlIGJ1aWx0aW4gSERNSSBwaHkgZHJpdmVy
LCBuZWFybHkgYWxsIG1haW4gc3RyZWFtIG1vZGUNCiAgICBiZWxvdyA0S0AzMEh6IGlzIHRlc3Rl
ZCwgdGhpcyBkcml2ZXIgc3VwcG9ydGVkIHRoZXNlIG1vZGUgdmVyeQ0KICAgIHdlbGwgaW5jbHVk
aW5nIGNsb25lIGRpc3BsYXkgbW9kZSBhbmQgZXh0ZW5kIGRpc3BsYXkgbW9kZS4NCg0KdjMgLT4g
djQ6DQogMSkgUXVpY2tseSBmaXggYSBzbWFsbCBtaXN0YWtlLg0KDQp2NCAtPiB2NToNCiAxKSBE
cm9wIHBvdGVudGlhbCBzdXBwb3J0IGZvciBMb29uZ3NvbiAySyBzZXJpZXMgU29DIHRlbXBvcmFy
eSwNCiAgICB0aGlzIHBhcnQgc2hvdWxkIGJlIHJlc2VuZCB3aXRoIHRoZSBEVCBiaW5kaW5nIHBh
dGNoIGluIHRoZSBmdXR1cmUuDQogMikgQWRkIHBlciBkaXNwbGF5IHBpcGUgZGVidWdmcyBzdXBw
b3J0IHRvIHRoZSBidWlsdGluIEhETUkgZW5jb2Rlci4NCiAzKSBSZXdyaXRlIGF0b21pY191cGRh
dGUoKSBmb3IgaGFyZHdhcmUgY3Vyc29ycyBwbGFuZShUaG9tYXMpDQogNCkgUmV3cml0ZSBlbmNv
ZGVyIGFuZCBjb25uZWN0b3IgaW5pdGlhbGl6YXRpb24gcGFydCwgdW50YW5nbGUgaXQNCiAgICBh
Y2NvcmRpbmcgdG8gdGhlIGNoaXAoVGhvbWFzKS4NCg0KdjUgLT4gdjY6DQogMSkgUmVtb3ZlIHN0
cmF5IGNvZGUgd2hpY2ggZGlkbid0IGdldCB1c2VkLCBzYXkgbHNkY19vZl9nZXRfcmVzZXJ2ZWRf
cmFtDQogMikgRml4IGFsbCB0eXBvcyBJIGNvdWxkIGZvdW5kLCBtYWtlIHNlbnRlbmNlcyBhbmQg
Y29kZSBtb3JlIHJlYWRhYmxlDQogMykgVW50YW5nbGUgbHNkY19oZG1pKl9jb25uZWN0b3JfZGV0
ZWN0KCkgZnVuY3Rpb24gYWNjb3JkaW5nIHRvIHRoZSBwaXBlDQogNCkgQWZ0ZXIgYSBzZXJpb3Vz
IGNvbnNpZGVyYXRpb24sIHdlIHJlbmFtZSB0aGlzIGRyaXZlciBhcyBsb29uZ3Nvbi4NCiAgICBC
ZWNhdXNlIHdlIGFsc28gaGF2ZSBkcml2ZXJzIHRvd2FyZCB0aGUgTG9vbmdHUFUgSVAgaW4gTFM3
QTIwMDAgYW5kDQogICAgTFMySzIwMDAuIEJlc2lkZXMsIHRoZXJlIGFyZSBhbHNvIGRyaXZlcnMg
YWJvdXQgdGhlIGV4dGVybmFsIGVuY29kZXIsDQogICAgSERNSSBhdWRpbyBkcml2ZXIgYW5kIHZi
aW9zIHN1cHBvcnQgZXRjLiBUaGlzIHBhdGNoIG9ubHkgcHJvdmlkZSBEQw0KICAgIGRyaXZlciBw
YXJ0LCBteSB0ZWFtbWF0ZSBMaSBZaSBiZWxpZXZlIHRoYXQgbG9vbmdzb24gd2lsbCBiZSBtb3Jl
DQogICAgc3VpdGFibGUgZm9yIGxvb25nc29uIGdyYXBoaWNzIHRoYW4gbHNkYyBpbiB0aGUgbG9u
ZyBydW4uDQoNCiAgICBsb29uZ3Nvbi5rbyA9IExTREMgKyBMb29uZ0dQVSArIGVuY29kZXJzIGRy
aXZlciArIHZiaW9zL0RUIC4uLg0KDQp2NiAtPiB2NzoNCiAxKSBBZGQgcHJpbWUgc3VwcG9ydCwg
c2VsZi1zaGFyaW5nIGlzIHdvcmtzLiBzaGFyaW5nIGJ1ZmZlciB3aXRoIGV0bmF2aXYNCiAgICBp
cyBhbHNvIHRlc3RlZCwgYW5kIGl0cyB3b3JrcyB3aXRoIGxpbWl0YXRpb24uDQogMikgSW1wbGVt
ZW50IGJ1ZmZlciBvYmplY3RzIHRyYWNraW5nIHdpdGggbGlzdF9oZWFkLg0KIDMpIFMzKHNsZWVw
IHRvIFJBTSkgaXMgdGVzdGVkIG9uIGxzM2E1MDAwK2xzN2EyMDAwIGV2YiBhbmQgaXQgd29ya3Mu
DQogNCkgUmV3cml0ZSBsc2RjX2JvX21vdmUsIHNpbmNlIHR0bSBjb3JlIHN0b3AgYWxsb2NhdGlu
ZyByZXNvdXJjZXMNCiAgICBkdXJpbmcgQk8gY3JlYXRpb24uIFBhdGNoIFYxIH4gVjYgb2YgdGhp
cyBzZXJpZXMgbm8gbG9uZ2VyIHdvcmtzDQogICAgb24gbGF0ZXN0IGtlcm5lbC4gVGh1cywgd2Ug
c2VuZCBWNyB0byByZXZpdmFsIHRoZW0uDQoNCnY3IC0+IHY4Og0KIDEpIFplcm8gYSBjb21waWxl
IHdhcm5uaW5ncyBvbiAzMi1iaXQgcGxhdGZvcm0sIGNvbXBpbGUgd2l0aCBXPTENCiAyKSBSZXZp
c2UgbHNkY19ib19ncHVfb2Zmc2V0KCkgYW5kIG1pbm9yIGNsZWFudXANCiAzKSBQYWdlZmxpcCB0
ZXN0ZWQgb24gdGhlIHZpcnR1YWwgdGVybWluYWwgd2l0aCBmb2xsb3dpbmcgY29tbWFuZHMNCg0K
ICAgIG1vZGV0ZXN0IC1NIGxvb25nc29uIC1zIDMyOjE5MjB4MTA4MCAtdg0KICAgIG1vZGV0ZXN0
IC1NIGxvb25nc29uIC1zIDM0OjE5MjB4MTA4MCAtdiAtRiB0aWxlcw0KDQogICBJdCB3b3JrcyBs
aWtlIGEgY2hhcm0sIHdoZW4gcnVubmluZyBwYWdlZmxpcCB0ZXN0IHdpdGggZHVhbCBzY3Jlbm4N
CiAgIGNvbmZpZ3VyYXRpb24sIGFub3RoZXIgdHdvIGFkZGl0aW9uYWwgYm8gY3JlYXRlZCBieSB0
aGUgbW9kZXRlc3QNCiAgIGVtZXJnZWQsIFZSQU0gdXNhZ2UgdXAgdG8gNDArTUIsIHdlbGwgd2Ug
aGF2ZSBhdCBsZWFzdCA2NE1CLCBzdGlsbA0KICAgZW5vdWdoLg0KDQogICAjIGNhdCBib3MNCg0K
ICAgICAgIGJvWzAwMDBdOiBzaXplOiAgICAgODExMmtCIFZSQU0NCiAgICAgICBib1swMDAxXTog
c2l6ZTogICAgICAgMTZrQiBWUkFNDQogICAgICAgYm9bMDAwMl06IHNpemU6ICAgICAgIDE2a0Ig
VlJBTQ0KICAgICAgIGJvWzAwMDNdOiBzaXplOiAgICAxNjIwOGtCIFZSQU0NCiAgICAgICBib1sw
MDA0XTogc2l6ZTogICAgIDgxMTJrQiBWUkFNDQogICAgICAgYm9bMDAwNV06IHNpemU6ICAgICA4
MTEya0IgVlJBTQ0KDQp2OCAtPiB2OToNCiAxKSBTZWxlY3QgSTJDIGFuZCBJMkNfQUxHT0JJVCBp
biBLY29uZmlnIGFuZCBzaG91bGQgZGVwZW5kIG9uIE1NVS4NCiAyKSBVc2luZyBwY2lfZ2V0X2Rv
bWFpbl9idXNfYW5kX3Nsb3QgdG8gZ2V0IHRoZSBHUFUgZGV2aWNlLg0KIDMpIE90aGVyIG1pbm9y
IGltcHJvdmVtZW50cy4NCg0KIFRob3NlIHBhdGNoZXMgYXJlIHRlc3RlZCBvbiBsczNhNTAwMCAr
IGxzN2ExMDAwIENSQiwgbHMzYTUwMDAgKyBsczdhMjAwMA0KIGV2YiwgYW5kIGxlbW90ZSBhMTkw
MSBib2FyZChsczNhNDAwMCArIGxzN2ExMDAwKS4gT24gbG9vbmdzb24gbWlwcyBDUFUsDQogdGhl
IHdyaXRlIGNvbWJpbmUgc3VwcG9ydCBzaG91bGQgYmUgZW5hYmxlZCwgdG8gZ2V0IGEgZGVjZW50
IHBlcmZvcm1hbmNlDQogZm9yIHdyaXRpbmcgZnJhbWVidWZmZXIgZGF0YSB0byB0aGUgVlJBTS4N
Cg0KdjkgLT4gdjEwOg0KIDEpIFJldmlzZSBsc2RjX2RybV9mcmVlemUoKSB0byBpbXBsZW1lbnQg
UzMgY29tcGxldGVseSBhbmQgY29ycmVjdGx5Lg0KICAgIEkgc3VkZGVubHkgcmVhbGl6ZWQgdGhh
dCBwaW5uZWQgYnVmZmVyIGNhbiBub3QgbW92ZSBhbmQgVlJBTSBsb3N0DQogICAgcG93ZXIgd2hl
biBzbGVlcCB0byBSQU0uIFRodXMsIHRoZSBkYXRhIGluIHRoZSBidWZmZXIgd2hvIGlzIHBpbm5l
ZA0KICAgIGluIFZSQU0gd2lsbCBnZXQgbG9zdCB3aGVuIHJlc3VtZS4gWWV0IGl0J3Mgbm90IGJp
ZyBwcm9ibGVtIGJlY2F1c2UNCiAgICB3ZSBhcmUgc29mdHdhcmUgcmVuZGVyaW5nIHNvbHV0aW9u
IHdoaWNoIHJlbGF5IG9uIHRoZSBDUFUgdXBkYXRlIHRoZQ0KICAgIGZyb250IGZyYW1lYnVmZmVy
LiBXZSBjYW4gc2VlIHRoZSBnYXJiYWdlIGRhdGEgd2hlbiByZXN1bWUgZnJvbSBTMywNCiAgICBi
dXQgdGhlIHNjcmVlbiB3aWxsIHNob3cgY29ycmVjdCBpbWFnZSBhcyBJIG1vdmUgdGhlIGN1cnNv
ci4gVGhpcyBpcw0KICAgIGR1ZSB0byB0aGUgY3B1IHJlcGFpbnQuIHYxMCBvZiB0aGlzIHBhdGNo
IG1ha2UgUzMgcGVyZmVjdCBieSB1bnBpbg0KICAgIGFsbCBvZiBCT3MgaW4gVlJBTSwgZXZpY3Qg
dGhlbSBhbGwgdG8gc3lzdGVtIFJBTS4NCg0KdjEwIC0+IHYxMToNCiAxKSBPbiBkb3VibGUgc2Ny
ZWVuIGNhc2UsIHRoZSBzaW5nbGUgZ2lhbnQgZnJhbWVidWZmZXIgaXMgcmVmZXJlbmNlZCBieQ0K
ICAgIHR3byBHRU0gb2JqZWN0LCBoZW5jZSwgaXQgd2lsbCBiZSBwaW5uZWQgYnkgcHJlcGFyZV9m
YigpIGF0IGxlYXNlIHR3bw0KICAgIHRpbWVzLiBUaGlzIGNhdXNlIGl0cyBwaW4gY291bnQgPiAx
LiBWMTAgb2YgdGhpcyBwYXRjaCBvbmx5IHVucGluIFZSQU0NCiAgICBCT3Mgb25jZSB3aGVuIHN1
c3BlbmQsIHdoaWNoIGlzIG5vdCBjb3JyZWN0IG9uIGRvdWJsZSBzY3JlZW4gY2FzZS4gVjExDQog
ICAgb2YgdGhpcyBwYXRjaCB1bnBpbiBCT3MgdW50aWwgaXRzIHBpbiBjb3VudCByZWFjaCB0byB6
ZXJvIHdoZW4gc3VzcGVuZC4NCiAgICBUaGVuLCB3ZSBtYWtlIHRoZSBTMyBzdXBwb3J0IGNvbXBs
ZXRlIGZpbmFsbHkuIFdpdGggdjExLCBJIGNhbid0IHNlZQ0KICAgIGFueSBnYXJiYWdlIGRhdGEg
YWZ0ZXIgcmVzdW1lLiBUZXN0ZWQgb24gYm90aCBsczdhMTAwMCBhbmQgbHM3YTIwMDANCiAgICBw
bGF0Zm9ybSwgd2l0aCBzaW5nbGUgc2NyZWVuIGFuZCBkb3VibGUgc2NyZWVuIGNvbmZpZ3VyYXRp
b24uDQogMikgRml4IHZibGFuayB3YWl0IHRpbWVvdXQgd2hlbiBkaXNhYmxlIENSVEMuDQogMykg
VGVzdCBhZ2FpbnN0IElHVCwgYXQgbGVhc3QgZmJkZXYgdGVzdCBhbmQga21zX2ZsaXAgdGVzdCBw
YXNzZWQuDQogNCkgUmV3cml0ZSBwaXhlbCBQTEwgdXBkYXRlIGZ1bmN0aW9uLCBtYWdpYyBudW1i
ZXJzIGVsaW1pbmF0ZWQgKEVtaWwpDQogNSkgRHJvcCBhIGZldyBjb21tb24gaGFyZHdhcmUgZmVh
dHVyZXMgZGVzY3JpcHRpb24gaW4gbHNkY19kZXNjIChFbWlsKQ0KIDYpIERyb3AgbHNkY19tb2Rl
X2NvbmZpZ19tb2RlX3ZhbGlkKCksIGluc3RlYWQgYWRkIHJlc3RyaWN0aW9ucyBpbiBkdW1iDQog
ICAgY3JlYXRlIGZ1bmN0aW9uLiAoRW1pbCkNCiA3KSBVbnRhbmdsZSB0aGUgbHM3YTEwMDAgY2Fz
ZSBhbmQgbHM3YTIwMDAgY2FzZSBjb21wbGV0ZWx5IChUaG9tYXMpDQoNCnYxMSAtPiB2MTI6DQog
bm9uZQ0KDQp2MTIgLT4gdjEzOg0KIDEpIEFkZCBiZW5jaG1hcmsgdG8gZmlndXJlIG91dCB0aGUg
YmFuZHdpZHRoIG9mIHRoZSBoYXJkd2FyZSBwbGF0Zm9ybS4NCiAgICBVc2FnZToNCiAgICAjIGNk
IC9zeXMva2VybmVsL2RlYnVnL2RyaS8wLw0KICAgICMgY2F0IGJlbmNobWFyaw0KDQogMikgVlJB
TSBpcyBmaWxsZWQgd2l0aCBnYXJiYWdlIGRhdGEgaWYgdW5pbml0aWFsaXplZCwgYWRkIGEgYnVm
ZmVyDQogICAgY2xlYXJpbmcgcHJvY2VkdXJlLCBjbGVhciBpdCBvbiB0aGUgQk8gY3JlYXRpb24g
dGltZS4NCiAzKSBVcGRhdGUgY29weXJpZ2h0cyBhbmQgYWRqdXN0IGNvZGluZyBzdHlsZSAoSHVh
Y2FpKQ0KDQpTaWduZWQtb2ZmLWJ5OiBMaSBZaSA8bGl5aUBsb29uZ3Nvbi5jbj4NClNpZ25lZC1v
ZmYtYnk6IFN1aSBKaW5nZmVuZyA8c3VpamluZ2ZlbmdAbG9vbmdzb24uY24+DQpDYzogTWFhcnRl
biBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNvbT4NCkNjOiBNYXhp
bWUgUmlwYXJkIDxtcmlwYXJkQGtlcm5lbC5vcmc+DQpDYzogVGhvbWFzIFppbW1lcm1hbm4gPHR6
aW1tZXJtYW5uQHN1c2UuZGU+DQpDYzogRGF2aWQgQWlybGllIDxhaXJsaWVkQGdtYWlsLmNvbT4N
CkNjOiBEYW5pZWwgVmV0dGVyIDxkYW5pZWxAZmZ3bGwuY2g+DQpDYzogU3VtaXQgU2Vtd2FsIDxz
dW1pdC5zZW13YWxAbGluYXJvLm9yZz4NCkNjOiAiQ2hyaXN0aWFuIEvDtm5pZyIgPGNocmlzdGlh
bi5rb2VuaWdAYW1kLmNvbT4NCi0tLQ0KIGRyaXZlcnMvZ3B1L2RybS9LY29uZmlnICAgICAgICAg
ICAgICAgICAgICAgfCAgICAyICsNCiBkcml2ZXJzL2dwdS9kcm0vTWFrZWZpbGUgICAgICAgICAg
ICAgICAgICAgIHwgICAgMSArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25maWcgICAg
ICAgICAgICB8ICAgMTcgKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9NYWtlZmlsZSAgICAg
ICAgICAgfCAgIDIxICsNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHM3YTEwMDBfb3V0cHV0
cy5jIHwgIDE2MSArKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHM3YTIwMDBfb3V0cHV0
cy5jIHwgIDUzMSArKysrKysrKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5j
aG1hcmsuYyAgIHwgIDEzMiArKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5j
aG1hcmsuaCAgIHwgICAxMyArDQogZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfY3J0Yy5j
ICAgICAgICB8IDEwNjggKysrKysrKysrKysrKysrKysrKw0KIGRyaXZlcnMvZ3B1L2RybS9sb29u
Z3Nvbi9sc2RjX2RlYnVnZnMuYyAgICAgfCAgIDkxICsrDQogZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZGV2aWNlLmMgICAgICB8ICAxMDQgKysNCiBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19kcnYuYyAgICAgICAgIHwgIDQ4NCArKysrKysrKysNCiBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19kcnYuaCAgICAgICAgIHwgIDQ1MiArKysrKysrKw0KIGRyaXZlcnMvZ3B1
L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5jICAgICAgICAgfCAgMzI0ICsrKysrKw0KIGRyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5oICAgICAgICAgfCAgIDM3ICsNCiBkcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19nZnhwbGwuYyAgICAgIHwgIDE5OSArKysrDQogZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzZGNfZ2Z4cGxsLmggICAgICB8ICAgNTIgKw0KIGRyaXZlcnMvZ3B1
L2RybS9sb29uZ3Nvbi9sc2RjX2kyYy5jICAgICAgICAgfCAgMTc5ICsrKysNCiBkcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19pMmMuaCAgICAgICAgIHwgICAyOSArDQogZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfaXJxLmMgICAgICAgICB8ICAgODEgKysNCiBkcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19pcnEuaCAgICAgICAgIHwgICAxNiArDQogZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzZGNfb3V0cHV0LmggICAgICB8ICAgMjEgKw0KIGRyaXZlcnMvZ3B1L2RybS9s
b29uZ3Nvbi9sc2RjX3BpeHBsbC5jICAgICAgfCAgNDgxICsrKysrKysrKw0KIGRyaXZlcnMvZ3B1
L2RybS9sb29uZ3Nvbi9sc2RjX3BpeHBsbC5oICAgICAgfCAgIDg2ICsrDQogZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfcGxhbmUuYyAgICAgICB8ICA2MzkgKysrKysrKysrKysNCiBkcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19wcm9iZS5jICAgICAgIHwgICA1NiArDQogZHJpdmVy
cy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuaCAgICAgICB8ICAgMTIgKw0KIGRyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX3JlZ3MuaCAgICAgICAgfCAgNDAwICsrKysrKysNCiBkcml2
ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY190dG0uYyAgICAgICAgIHwgIDYxMCArKysrKysrKysr
Kw0KIGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3R0bS5oICAgICAgICAgfCAgIDk5ICsr
DQogMzAgZmlsZXMgY2hhbmdlZCwgNjM5OCBpbnNlcnRpb25zKCspDQogY3JlYXRlIG1vZGUgMTAw
NjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9LY29uZmlnDQogY3JlYXRlIG1vZGUgMTAwNjQ0
IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9NYWtlZmlsZQ0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHM3YTEwMDBfb3V0cHV0cy5jDQogY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sczdhMjAwMF9vdXRwdXRzLmMNCiBjcmVh
dGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfYmVuY2htYXJrLmMN
CiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfYmVuY2ht
YXJrLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
Y3J0Yy5jDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X2RlYnVnZnMuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24v
bHNkY19kZXZpY2UuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19kcnYuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19kcnYuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19nZW0uYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19nZW0uaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vbHNkY19nZnhwbGwuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19nZnhwbGwuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19pMmMuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19pMmMuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19pcnEuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19pcnEuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19vdXRwdXQuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19waXhwbGwuYw0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJzL2dw
dS9kcm0vbG9vbmdzb24vbHNkY19waXhwbGwuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBkcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19wbGFuZS5jDQogY3JlYXRlIG1vZGUgMTAwNjQ0IGRyaXZl
cnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3Byb2JlLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQgZHJp
dmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuaA0KIGNyZWF0ZSBtb2RlIDEwMDY0NCBk
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19yZWdzLmgNCiBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmMNCiBjcmVhdGUgbW9kZSAxMDA2NDQg
ZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmgNCg0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9LY29uZmlnIGIvZHJpdmVycy9ncHUvZHJtL0tjb25maWcNCmluZGV4IGJhM2Zi
MDRiYjY5MS4uZDFmYTg3ZDJhY2I3IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL0tjb25m
aWcNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9LY29uZmlnDQpAQCAtMzMxLDYgKzMzMSw4IEBAIHNv
dXJjZSAiZHJpdmVycy9ncHUvZHJtL3YzZC9LY29uZmlnIg0KIA0KIHNvdXJjZSAiZHJpdmVycy9n
cHUvZHJtL3ZjNC9LY29uZmlnIg0KIA0KK3NvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L0tjb25maWciDQorDQogc291cmNlICJkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9LY29uZmlnIg0K
IA0KIHNvdXJjZSAiZHJpdmVycy9ncHUvZHJtL2hpc2lsaWNvbi9LY29uZmlnIg0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZSBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQ0K
aW5kZXggYTMzMjU3ZDJiYzdmLi4xMzE1MzE0NTNiOGUgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vTWFrZWZpbGUNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9NYWtlZmlsZQ0KQEAgLTE5NCwz
ICsxOTQsNCBAQCBvYmoteQkJCSs9IGd1ZC8NCiBvYmotJChDT05GSUdfRFJNX0hZUEVSVikgKz0g
aHlwZXJ2Lw0KIG9iai15CQkJKz0gc29sb21vbi8NCiBvYmotJChDT05GSUdfRFJNX1NQUkQpICs9
IHNwcmQvDQorb2JqLSQoQ09ORklHX0RSTV9MT09OR1NPTikgKz0gbG9vbmdzb24vDQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL0tjb25maWcgYi9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vS2NvbmZpZw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAw
MC4uZGY2OTQ2ZDUwNWZhDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vS2NvbmZpZw0KQEAgLTAsMCArMSwxNyBAQA0KKyMgU1BEWC1MaWNlbnNlLUlkZW50aWZp
ZXI6IEdQTC0yLjANCisNCitjb25maWcgRFJNX0xPT05HU09ODQorCXRyaXN0YXRlICJEUk0gc3Vw
cG9ydCBmb3IgTG9vbmdzb24gR3JhcGhpY3MiDQorCWRlcGVuZHMgb24gRFJNICYmIFBDSSAmJiBN
TVUNCisJc2VsZWN0IERSTV9LTVNfSEVMUEVSDQorCXNlbGVjdCBEUk1fVFRNDQorCXNlbGVjdCBJ
MkMNCisJc2VsZWN0IEkyQ19BTEdPQklUDQorCWhlbHANCisJICBUaGlzIGlzIGEgRFJNIGRyaXZl
ciBmb3IgTG9vbmdzb24gR3JhcGhpY3MsIGl0IG1heSBpbmNsdWRpbmcNCisJICBMUzdBMjAwMCwg
TFM3QTEwMDAsIExTMksyMDAwIGFuZCBMUzJLMTAwMCBldGMuIExvb25nc29uIExTN0ENCisJICBz
ZXJpZXMgYXJlIGJyaWRnZSBjaGlwc2V0LCB3aGlsZSBMb29uZ3NvbiBMUzJLIHNlcmllcyBhcmUg
U29DLg0KKw0KKwkgIElmICJNIiBpcyBzZWxlY3RlZCwgdGhlIG1vZHVsZSB3aWxsIGJlIGNhbGxl
ZCBsb29uZ3Nvbi4NCisNCisJICBJZiBpbiBkb3VidCwgc2F5ICJOIi4NCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vTWFrZWZpbGUgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdz
b24vTWFrZWZpbGUNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmM1
YmM1NGJkZTk2ZA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L01ha2VmaWxlDQpAQCAtMCwwICsxLDIxIEBADQorIyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMA0KKw0KK2xvb25nc29uLXkgOj0gXA0KKwlsc2RjX2JlbmNobWFyay5vIFwNCisJbHNk
Y19jcnRjLm8gXA0KKwlsc2RjX2RlYnVnZnMubyBcDQorCWxzZGNfZGV2aWNlLm8gXA0KKwlsc2Rj
X2Rydi5vIFwNCisJbHNkY19nZW0ubyBcDQorCWxzZGNfZ2Z4cGxsLm8gXA0KKwlsc2RjX2kyYy5v
IFwNCisJbHNkY19pcnEubyBcDQorCWxzZGNfcGxhbmUubyBcDQorCWxzZGNfcGl4cGxsLm8gXA0K
Kwlsc2RjX3Byb2JlLm8gXA0KKwlsc2RjX3R0bS5vDQorDQorbG9vbmdzb24teSArPSBsczdhMTAw
MF9vdXRwdXRzLm8gXA0KKwkgICAgICBsczdhMjAwMF9vdXRwdXRzLm8NCisNCitvYmotJChDT05G
SUdfRFJNX0xPT05HU09OKSArPSBsb29uZ3Nvbi5vDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzN2ExMDAwX291dHB1dHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nv
bi9sczdhMTAwMF9vdXRwdXRzLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAw
MDAwMDAuLjQ1NjAyY2M3Y2NmOQ0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJt
L2xvb25nc29uL2xzN2ExMDAwX291dHB1dHMuYw0KQEAgLTAsMCArMSwxNjEgQEANCisvLyBTUERY
LUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIz
IExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNs
dWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9lZGlkLmg+
DQorI2luY2x1ZGUgPGRybS9kcm1fcHJvYmVfaGVscGVyLmg+DQorDQorI2luY2x1ZGUgImxzZGNf
ZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfb3V0cHV0LmgiDQorDQorLyoNCisgKiBDdXJyZW50bHks
IHdlIGFzc3VtZSB0aGUgZXh0ZXJuYWwgZW5jb2RlcnMgY29ubmVjdGVkIHdpdGggdGhlIERWTyBp
cw0KKyAqIHRyYW5zcGFyZW50LiBMb29uZ3NvbiBEVk8gaW50ZXJmYWNlIGNhbiBkaXJlY3RseSBk
cml2ZSBSR0I4ODggcGFuZWxzLg0KKyAqDQorICogIFRPRE86IEFkZCBzdXBwb3J0IGZvciBub24t
dHJhbnNwYXJlbnQgZW5jb2RlcnMgLi4uDQorICovDQorDQorc3RhdGljIGludCBsczdhMTAwMF9k
cGlfY29ubmVjdG9yX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubikNCit7DQor
CXVuc2lnbmVkIGludCBudW0gPSAwOw0KKwlzdHJ1Y3QgZWRpZCAqZWRpZDsNCisNCisJaWYgKGNv
bm4tPmRkYykgew0KKwkJZWRpZCA9IGRybV9nZXRfZWRpZChjb25uLCBjb25uLT5kZGMpOw0KKwkJ
aWYgKGVkaWQpIHsNCisJCQlkcm1fY29ubmVjdG9yX3VwZGF0ZV9lZGlkX3Byb3BlcnR5KGNvbm4s
IGVkaWQpOw0KKwkJCW51bSA9IGRybV9hZGRfZWRpZF9tb2Rlcyhjb25uLCBlZGlkKTsNCisJCQlr
ZnJlZShlZGlkKTsNCisJCX0NCisNCisJCXJldHVybiBudW07DQorCX0NCisNCisJbnVtID0gZHJt
X2FkZF9tb2Rlc19ub2VkaWQoY29ubiwgMTkyMCwgMTIwMCk7DQorDQorCWRybV9zZXRfcHJlZmVy
cmVkX21vZGUoY29ubiwgMTAyNCwgNzY4KTsNCisNCisJcmV0dXJuIG51bTsNCit9DQorDQorc3Rh
dGljIHN0cnVjdCBkcm1fZW5jb2RlciAqDQorbHM3YTEwMDBfZHBpX2Nvbm5lY3Rvcl9nZXRfYmVz
dF9lbmNvZGVyKHN0cnVjdCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsDQorCQkJCQlzdHJ1Y3Qg
ZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19vdXRwdXQgKm91dHB1
dCA9IGNvbm5lY3Rvcl90b19sc2RjX291dHB1dChjb25uZWN0b3IpOw0KKw0KKwlyZXR1cm4gJm91
dHB1dC0+ZW5jb2RlcjsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9y
X2hlbHBlcl9mdW5jcw0KK2xzN2ExMDAwX2RwaV9jb25uZWN0b3JfaGVscGVycyA9IHsNCisJLmF0
b21pY19iZXN0X2VuY29kZXIgPSBsczdhMTAwMF9kcGlfY29ubmVjdG9yX2dldF9iZXN0X2VuY29k
ZXIsDQorCS5nZXRfbW9kZXMgPSBsczdhMTAwMF9kcGlfY29ubmVjdG9yX2dldF9tb2RlcywNCit9
Ow0KKw0KK3N0YXRpYyBlbnVtIGRybV9jb25uZWN0b3Jfc3RhdHVzDQorbHM3YTEwMDBfZHBpX2Nv
bm5lY3Rvcl9kZXRlY3Qoc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciwgYm9vbCBmb3Jj
ZSkNCit7DQorCXN0cnVjdCBpMmNfYWRhcHRlciAqZGRjID0gY29ubmVjdG9yLT5kZGM7DQorDQor
CWlmIChkZGMpIHsNCisJCWlmIChkcm1fcHJvYmVfZGRjKGRkYykpDQorCQkJcmV0dXJuIGNvbm5l
Y3Rvcl9zdGF0dXNfY29ubmVjdGVkOw0KKw0KKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfZGlz
Y29ubmVjdGVkOw0KKwl9DQorDQorCXJldHVybiBjb25uZWN0b3Jfc3RhdHVzX3Vua25vd247DQor
fQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBsczdhMTAwMF9k
cGlfY29ubmVjdG9yX2Z1bmNzID0gew0KKwkuZGV0ZWN0ID0gbHM3YTEwMDBfZHBpX2Nvbm5lY3Rv
cl9kZXRlY3QsDQorCS5maWxsX21vZGVzID0gZHJtX2hlbHBlcl9wcm9iZV9zaW5nbGVfY29ubmVj
dG9yX21vZGVzLA0KKwkuZGVzdHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwNCisJLnJlc2V0
ID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX3Jlc2V0LA0KKwkuYXRvbWljX2R1cGxpY2F0
ZV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kdXBsaWNhdGVfc3RhdGUsDQor
CS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9kZXN0
cm95X3N0YXRlDQorfTsNCisNCitzdGF0aWMgdm9pZCBsczdhMTAwMF9waXBlMF9lbmNvZGVyX3Jl
c2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlcikNCit7DQorCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2ID0gZW5jb2Rlci0+ZGV2Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19s
c2RjKGRkZXYpOw0KKw0KKwkvKg0KKwkgKiBXZSBuZWVkIHRoaXMsIGZvciBTMyByZXN1bWUsIHNj
cmVlbiB3aWxsIG5vdCBsaWdodHVwIGlmIGRvbid0IHNldA0KKwkgKiBjb3JyZWN0bHkuDQorCSAq
Lw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1BBTkVMX0NPTkZfUkVHLA0KKwkJICAg
IFBIWV9DTE9DS19QT0wgfCBQSFlfQ0xPQ0tfRU4gfCBQSFlfREFUQV9FTik7DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGxzN2ExMDAwX3BpcGUxX2VuY29kZXJfcmVzZXQoc3RydWN0IGRybV9lbmNvZGVy
ICplbmNvZGVyKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBlbmNvZGVyLT5kZXY7
DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorDQorCS8qDQor
CSAqIFdlIG5lZWQgdGhpcywgZm9yIFMzIHJlc3VtZSwgc2NyZWVuIHdpbGwgbm90IGxpZ2h0IHVw
DQorCSAqIGlmIHdlIGRvbid0IHNldCBzZXR0aW5nIHRoaXMgcmVnaXN0ZXIgY29ycmVjdGx5Lg0K
KwkgKi8NCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMV9QQU5FTF9DT05GX1JFRywNCisJ
CSAgICBQSFlfQ0xPQ0tfUE9MIHwgUEhZX0NMT0NLX0VOIHwgUEhZX0RBVEFfRU4pOw0KK30NCisN
CitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9lbmNvZGVyX2Z1bmNzIGxzN2ExMDAwX2VuY29kZXJf
ZnVuY3NbMl0gPSB7DQorCXsNCisJCS5yZXNldCA9IGxzN2ExMDAwX3BpcGUwX2VuY29kZXJfcmVz
ZXQsDQorCQkuZGVzdHJveSA9IGRybV9lbmNvZGVyX2NsZWFudXAsDQorCX0sDQorCXsNCisJCS5y
ZXNldCA9IGxzN2ExMDAwX3BpcGUxX2VuY29kZXJfcmVzZXQsDQorCQkuZGVzdHJveSA9IGRybV9l
bmNvZGVyX2NsZWFudXAsDQorCX0sDQorfTsNCisNCitpbnQgbHM3YTEwMDBfb3V0cHV0X2luaXQo
c3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJIHN0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZSAq
ZGlzcGlwZSwNCisJCQkgc3RydWN0IGkyY19hZGFwdGVyICpkZGMsDQorCQkJIHVuc2lnbmVkIGlu
dCBpbmRleCkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0ID0gJmRpc3BpcGUtPm91
dHB1dDsNCisJc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyID0gJm91dHB1dC0+ZW5jb2RlcjsN
CisJc3RydWN0IGRybV9jb25uZWN0b3IgKmNvbm5lY3RvciA9ICZvdXRwdXQtPmNvbm5lY3RvcjsN
CisJaW50IHJldDsNCisNCisJcmV0ID0gZHJtX2VuY29kZXJfaW5pdChkZGV2LA0KKwkJCSAgICAg
ICBlbmNvZGVyLA0KKwkJCSAgICAgICAmbHM3YTEwMDBfZW5jb2Rlcl9mdW5jc1tpbmRleF0sDQor
CQkJICAgICAgIERSTV9NT0RFX0VOQ09ERVJfVE1EUywNCisJCQkgICAgICAgImVuY29kZXItJXUi
LA0KKwkJCSAgICAgICBpbmRleCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwll
bmNvZGVyLT5wb3NzaWJsZV9jcnRjcyA9IEJJVChpbmRleCk7DQorDQorCXJldCA9IGRybV9jb25u
ZWN0b3JfaW5pdF93aXRoX2RkYyhkZGV2LA0KKwkJCQkJICBjb25uZWN0b3IsDQorCQkJCQkgICZs
czdhMTAwMF9kcGlfY29ubmVjdG9yX2Z1bmNzLA0KKwkJCQkJICBEUk1fTU9ERV9DT05ORUNUT1Jf
RFBJLA0KKwkJCQkJICBkZGMpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZHJt
X2luZm8oZGRldiwgImRpc3BsYXkgcGlwZS0ldSBoYXMgYSBEVk9cbiIsIGluZGV4KTsNCisNCisJ
ZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKGNvbm5lY3RvciwgJmxzN2ExMDAwX2RwaV9jb25uZWN0
b3JfaGVscGVycyk7DQorDQorCWRybV9jb25uZWN0b3JfYXR0YWNoX2VuY29kZXIoY29ubmVjdG9y
LCBlbmNvZGVyKTsNCisNCisJY29ubmVjdG9yLT5wb2xsZWQgPSBEUk1fQ09OTkVDVE9SX1BPTExf
Q09OTkVDVCB8DQorCQkJICAgIERSTV9DT05ORUNUT1JfUE9MTF9ESVNDT05ORUNUOw0KKw0KKwlj
b25uZWN0b3ItPmludGVybGFjZV9hbGxvd2VkID0gMDsNCisJY29ubmVjdG9yLT5kb3VibGVzY2Fu
X2FsbG93ZWQgPSAwOw0KKw0KKwlyZXR1cm4gMDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzN2EyMDAwX291dHB1dHMuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29u
Z3Nvbi9sczdhMjAwMF9vdXRwdXRzLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAw
MDAwMDAwMDAuLmNjYzM1MjgzZTFkYw0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzN2EyMDAwX291dHB1dHMuYw0KQEAgLTAsMCArMSw1MzEgQEANCisvLyBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAy
MDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNp
bmNsdWRlIDxsaW51eC9kZWxheS5oPg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxw
ZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9kZWJ1Z2ZzLmg+DQorI2luY2x1ZGUgPGRybS9kcm1f
ZWRpZC5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX3Byb2JlX2hlbHBlci5oPg0KKw0KKyNpbmNsdWRl
ICJsc2RjX2Rydi5oIg0KKyNpbmNsdWRlICJsc2RjX291dHB1dC5oIg0KKw0KK3N0YXRpYyBpbnQg
bHM3YTIwMDBfY29ubmVjdG9yX2dldF9tb2RlcyhzdHJ1Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVj
dG9yKQ0KK3sNCisJdW5zaWduZWQgaW50IG51bSA9IDA7DQorCXN0cnVjdCBlZGlkICplZGlkOw0K
Kw0KKwlpZiAoY29ubmVjdG9yLT5kZGMpIHsNCisJCWVkaWQgPSBkcm1fZ2V0X2VkaWQoY29ubmVj
dG9yLCBjb25uZWN0b3ItPmRkYyk7DQorCQlpZiAoZWRpZCkgew0KKwkJCWRybV9jb25uZWN0b3Jf
dXBkYXRlX2VkaWRfcHJvcGVydHkoY29ubmVjdG9yLCBlZGlkKTsNCisJCQludW0gPSBkcm1fYWRk
X2VkaWRfbW9kZXMoY29ubmVjdG9yLCBlZGlkKTsNCisJCQlrZnJlZShlZGlkKTsNCisJCX0NCisN
CisJCXJldHVybiBudW07DQorCX0NCisNCisJbnVtID0gZHJtX2FkZF9tb2Rlc19ub2VkaWQoY29u
bmVjdG9yLCAxOTIwLCAxMjAwKTsNCisNCisJZHJtX3NldF9wcmVmZXJyZWRfbW9kZShjb25uZWN0
b3IsIDEwMjQsIDc2OCk7DQorDQorCXJldHVybiBudW07DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3Qg
ZHJtX2VuY29kZXIgKg0KK2xzN2EyMDAwX2Nvbm5lY3Rvcl9nZXRfYmVzdF9lbmNvZGVyKHN0cnVj
dCBkcm1fY29ubmVjdG9yICpjb25uZWN0b3IsDQorCQkJCSAgICBzdHJ1Y3QgZHJtX2F0b21pY19z
dGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19vdXRwdXQgKm91dHB1dCA9IGNvbm5lY3Rv
cl90b19sc2RjX291dHB1dChjb25uZWN0b3IpOw0KKw0KKwlyZXR1cm4gJm91dHB1dC0+ZW5jb2Rl
cjsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fY29ubmVjdG9yX2hlbHBlcl9mdW5j
cyBsczdhMjAwMF9jb25uZWN0b3JfaGVscGVycyA9IHsNCisJLmF0b21pY19iZXN0X2VuY29kZXIg
PSBsczdhMjAwMF9jb25uZWN0b3JfZ2V0X2Jlc3RfZW5jb2RlciwNCisJLmdldF9tb2RlcyA9IGxz
N2EyMDAwX2Nvbm5lY3Rvcl9nZXRfbW9kZXMsDQorfTsNCisNCisvKiBkZWJ1Z2ZzICovDQorDQor
I2RlZmluZSBMU0RDX0hETUlfUkVHKGksIHJlZykgeyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBcDQorCS5uYW1lID0gX19zdHJpbmdpZnlfMShMU0RDX0hETUkjI2kjI18jI3JlZyMjX1JF
RyksICAgIFwNCisJLm9mZnNldCA9IExTRENfSERNSSMjaSMjXyMjcmVnIyNfUkVHLCAgICAgICAg
ICAgICAgICAgXA0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfcmVnMzIgbHM3YTIw
MDBfaGRtaTBfZW5jb2Rlcl9yZWdzW10gPSB7DQorCUxTRENfSERNSV9SRUcoMCwgWk9ORSksDQor
CUxTRENfSERNSV9SRUcoMCwgSU5URl9DVFJMKSwNCisJTFNEQ19IRE1JX1JFRygwLCBQSFlfQ1RS
TCksDQorCUxTRENfSERNSV9SRUcoMCwgUEhZX1BMTCksDQorCUxTRENfSERNSV9SRUcoMCwgQVZJ
X0lORk9fQ1JUTCksDQorCUxTRENfSERNSV9SRUcoMCwgUEhZX0NBTCksDQorCUxTRENfSERNSV9S
RUcoMCwgQVVESU9fUExMX0xPKSwNCisJTFNEQ19IRE1JX1JFRygwLCBBVURJT19QTExfSEkpLA0K
Kwl7TlVMTCwgMH0sICAvKiBNVVNUIGJlIHtOVUxMLCAwfSB0ZXJtaW5hdGVkICovDQorfTsNCisN
CitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfcmVnMzIgbHM3YTIwMDBfaGRtaTFfZW5jb2Rlcl9y
ZWdzW10gPSB7DQorCUxTRENfSERNSV9SRUcoMSwgWk9ORSksDQorCUxTRENfSERNSV9SRUcoMSwg
SU5URl9DVFJMKSwNCisJTFNEQ19IRE1JX1JFRygxLCBQSFlfQ1RSTCksDQorCUxTRENfSERNSV9S
RUcoMSwgUEhZX1BMTCksDQorCUxTRENfSERNSV9SRUcoMSwgQVZJX0lORk9fQ1JUTCksDQorCUxT
RENfSERNSV9SRUcoMSwgUEhZX0NBTCksDQorCUxTRENfSERNSV9SRUcoMSwgQVVESU9fUExMX0xP
KSwNCisJTFNEQ19IRE1JX1JFRygxLCBBVURJT19QTExfSEkpLA0KKwl7TlVMTCwgMH0sICAvKiBN
VVNUIGJlIHtOVUxMLCAwfSB0ZXJtaW5hdGVkICovDQorfTsNCisNCitzdGF0aWMgaW50IGxzN2Ey
MDAwX2hkbWlfZW5jb2Rlcl9yZWdzX3Nob3coc3RydWN0IHNlcV9maWxlICptLCB2b2lkICpkYXRh
KQ0KK3sNCisJc3RydWN0IGRybV9pbmZvX25vZGUgKm5vZGUgPSAoc3RydWN0IGRybV9pbmZvX25v
ZGUgKiltLT5wcml2YXRlOw0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IG5vZGUtPm1pbm9y
LT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCWNv
bnN0IHN0cnVjdCBsc2RjX3JlZzMyICpwcmVnOw0KKw0KKwlwcmVnID0gKGNvbnN0IHN0cnVjdCBs
c2RjX3JlZzMyICopbm9kZS0+aW5mb19lbnQtPmRhdGE7DQorDQorCXdoaWxlIChwcmVnLT5uYW1l
KSB7DQorCQl1MzIgb2Zmc2V0ID0gcHJlZy0+b2Zmc2V0Ow0KKw0KKwkJc2VxX3ByaW50ZihtLCAi
JXMgKDB4JTA0eCk6IDB4JTA4eFxuIiwNCisJCQkgICBwcmVnLT5uYW1lLCBvZmZzZXQsIGxzZGNf
cnJlZzMyKGxkZXYsIG9mZnNldCkpOw0KKwkJKytwcmVnOw0KKwl9DQorDQorCXJldHVybiAwOw0K
K30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9pbmZvX2xpc3QgbHM3YTIwMDBfaGRtaTBf
ZGVidWdmc19maWxlc1tdID0gew0KKwl7ICJyZWdzIiwgbHM3YTIwMDBfaGRtaV9lbmNvZGVyX3Jl
Z3Nfc2hvdywgMCwgKHZvaWQgKilsczdhMjAwMF9oZG1pMF9lbmNvZGVyX3JlZ3MgfSwNCit9Ow0K
Kw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBsczdhMjAwMF9oZG1pMV9kZWJ1
Z2ZzX2ZpbGVzW10gPSB7DQorCXsgInJlZ3MiLCBsczdhMjAwMF9oZG1pX2VuY29kZXJfcmVnc19z
aG93LCAwLCAodm9pZCAqKWxzN2EyMDAwX2hkbWkxX2VuY29kZXJfcmVncyB9LA0KK307DQorDQor
c3RhdGljIHZvaWQgbHM3YTIwMDBfaGRtaTBfbGF0ZV9yZWdpc3RlcihzdHJ1Y3QgZHJtX2Nvbm5l
Y3RvciAqY29ubmVjdG9yLA0KKwkJCQkJIHN0cnVjdCBkZW50cnkgKnJvb3QpDQorew0KKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldiA9IGNvbm5lY3Rvci0+ZGV2Ow0KKwlzdHJ1Y3QgZHJtX21pbm9y
ICptaW5vciA9IGRkZXYtPnByaW1hcnk7DQorDQorCWRybV9kZWJ1Z2ZzX2NyZWF0ZV9maWxlcyhs
czdhMjAwMF9oZG1pMF9kZWJ1Z2ZzX2ZpbGVzLA0KKwkJCQkgQVJSQVlfU0laRShsczdhMjAwMF9o
ZG1pMF9kZWJ1Z2ZzX2ZpbGVzKSwNCisJCQkJIHJvb3QsDQorCQkJCSBtaW5vcik7DQorfQ0KKw0K
K3N0YXRpYyB2b2lkIGxzN2EyMDAwX2hkbWkxX2xhdGVfcmVnaXN0ZXIoc3RydWN0IGRybV9jb25u
ZWN0b3IgKmNvbm5lY3RvciwNCisJCQkJCSBzdHJ1Y3QgZGVudHJ5ICpyb290KQ0KK3sNCisJc3Ry
dWN0IGRybV9kZXZpY2UgKmRkZXYgPSBjb25uZWN0b3ItPmRldjsNCisJc3RydWN0IGRybV9taW5v
ciAqbWlub3IgPSBkZGV2LT5wcmltYXJ5Ow0KKw0KKwlkcm1fZGVidWdmc19jcmVhdGVfZmlsZXMo
bHM3YTIwMDBfaGRtaTFfZGVidWdmc19maWxlcywNCisJCQkJIEFSUkFZX1NJWkUobHM3YTIwMDBf
aGRtaTFfZGVidWdmc19maWxlcyksDQorCQkJCSByb290LA0KKwkJCQkgbWlub3IpOw0KK30NCisN
CisvKiBtb25pdG9yIHByZXNlbnQgZGV0ZWN0aW9uICovDQorDQorc3RhdGljIGVudW0gZHJtX2Nv
bm5lY3Rvcl9zdGF0dXMNCitsczdhMjAwMF9oZG1pMF92Z2FfY29ubmVjdG9yX2RldGVjdChzdHJ1
Y3QgZHJtX2Nvbm5lY3RvciAqY29ubmVjdG9yLCBib29sIGZvcmNlKQ0KK3sNCisJc3RydWN0IGRy
bV9kZXZpY2UgKmRkZXYgPSBjb25uZWN0b3ItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICps
ZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJdTMyIHZhbDsNCisNCisJdmFsID0gbHNkY19ycmVnMzIo
bGRldiwgTFNEQ19IRE1JX0hQRF9TVEFUVVNfUkVHKTsNCisNCisJaWYgKHZhbCAmIEhETUkwX0hQ
RF9GTEFHKQ0KKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOw0KKw0KKwlpZiAo
Y29ubmVjdG9yLT5kZGMpIHsNCisJCWlmIChkcm1fcHJvYmVfZGRjKGNvbm5lY3Rvci0+ZGRjKSkN
CisJCQlyZXR1cm4gY29ubmVjdG9yX3N0YXR1c19jb25uZWN0ZWQ7DQorDQorCQlyZXR1cm4gY29u
bmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7DQorCX0NCisNCisJcmV0dXJuIGNvbm5lY3Rvcl9z
dGF0dXNfdW5rbm93bjsNCit9DQorDQorc3RhdGljIGVudW0gZHJtX2Nvbm5lY3Rvcl9zdGF0dXMN
CitsczdhMjAwMF9oZG1pMV9jb25uZWN0b3JfZGV0ZWN0KHN0cnVjdCBkcm1fY29ubmVjdG9yICpj
b25uZWN0b3IsIGJvb2wgZm9yY2UpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0
b19sc2RjKGNvbm5lY3Rvci0+ZGV2KTsNCisJdTMyIHZhbDsNCisNCisJdmFsID0gbHNkY19ycmVn
MzIobGRldiwgTFNEQ19IRE1JX0hQRF9TVEFUVVNfUkVHKTsNCisNCisJaWYgKHZhbCAmIEhETUkx
X0hQRF9GTEFHKQ0KKwkJcmV0dXJuIGNvbm5lY3Rvcl9zdGF0dXNfY29ubmVjdGVkOw0KKw0KKwly
ZXR1cm4gY29ubmVjdG9yX3N0YXR1c19kaXNjb25uZWN0ZWQ7DQorfQ0KKw0KK3N0YXRpYyBjb25z
dCBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9mdW5jcyBsczdhMjAwMF9oZG1pX2Nvbm5lY3Rvcl9mdW5j
c1syXSA9IHsNCisJew0KKwkJLmRldGVjdCA9IGxzN2EyMDAwX2hkbWkwX3ZnYV9jb25uZWN0b3Jf
ZGV0ZWN0LA0KKwkJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0
b3JfbW9kZXMsDQorCQkuZGVzdHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwNCisJCS5yZXNl
dCA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwNCisJCS5hdG9taWNfZHVwbGlj
YXRlX3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwN
CisJCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9k
ZXN0cm95X3N0YXRlLA0KKwkJLmRlYnVnZnNfaW5pdCA9IGxzN2EyMDAwX2hkbWkwX2xhdGVfcmVn
aXN0ZXIsDQorCX0sDQorCXsNCisJCS5kZXRlY3QgPSBsczdhMjAwMF9oZG1pMV9jb25uZWN0b3Jf
ZGV0ZWN0LA0KKwkJLmZpbGxfbW9kZXMgPSBkcm1faGVscGVyX3Byb2JlX3NpbmdsZV9jb25uZWN0
b3JfbW9kZXMsDQorCQkuZGVzdHJveSA9IGRybV9jb25uZWN0b3JfY2xlYW51cCwNCisJCS5yZXNl
dCA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9yZXNldCwNCisJCS5hdG9taWNfZHVwbGlj
YXRlX3N0YXRlID0gZHJtX2F0b21pY19oZWxwZXJfY29ubmVjdG9yX2R1cGxpY2F0ZV9zdGF0ZSwN
CisJCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVscGVyX2Nvbm5lY3Rvcl9k
ZXN0cm95X3N0YXRlLA0KKwkJLmRlYnVnZnNfaW5pdCA9IGxzN2EyMDAwX2hkbWkxX2xhdGVfcmVn
aXN0ZXIsDQorCX0sDQorfTsNCisNCisvKiBFdmVuIHRob3VnaCBzb21lIGJvYXJkIGhhcyBvbmx5
IG9uZSBoZG1pIG9uIGRpc3BsYXkgcGlwZSAxLA0KKyAqIFdlIHN0aWxsIG5lZWQgaG9vayBsc2Rj
X2VuY29kZXJfZnVuY3MgdXAgb24gZGlzcGxheSBwaXBlIDAsDQorICogVGhpcyBpcyBiZWNhdXNl
IHdlIG5lZWQgaXRzIHJlc2V0KCkgY2FsbGJhY2sgZ2V0IGNhbGxlZCwgdG8NCisgKiBzZXQgdGhl
IExTRENfSERNSXhfQ1RSTF9SRUcgdXNpbmcgc29mdHdhcmUgZ3BpbyBlbXVsYXRlZCBpMmMuDQor
ICogT3RoZXJ3aXNlLCB0aGUgZmlybXdhcmUgbWF5IHNldCBMU0RDX0hETUl4X0NUUkxfUkVHIGJs
aW5kbHkuDQorICovDQorc3RhdGljIHZvaWQgbHM3YTIwMDBfaGRtaTBfZW5jb2Rlcl9yZXNldChz
dHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRl
diA9IGVuY29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhk
ZGV2KTsNCisJdTMyIHZhbDsNCisNCisJdmFsID0gUEhZX0NMT0NLX1BPTCB8IFBIWV9DTE9DS19F
TiB8IFBIWV9EQVRBX0VOOw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1BBTkVMX0NP
TkZfUkVHLCB2YWwpOw0KKw0KKwkvKiB1c2luZyBzb2Z0d2FyZSBncGlvIGVtdWxhdGVkIGkyYyAq
Lw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0hETUkwX0lOVEZfQ1RSTF9SRUcpOw0K
Kwl2YWwgJj0gfkhXX0kyQ19FTjsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19IRE1JMF9JTlRG
X0NUUkxfUkVHLCB2YWwpOw0KKw0KKwkvKiBoZWxwIHRoZSBoZG1pIHBoeSB0byBnZXQgb3V0IG9m
IHJlc2V0IHN0YXRlICovDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfSERNSTBfUEhZX0NUUkxf
UkVHLCBIRE1JX1BIWV9SRVNFVF9OKTsNCisNCisJbWRlbGF5KDIwKTsNCisNCisJZHJtX2RiZyhk
ZGV2LCAiSERNSS0wIFJlc2V0XG4iKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTIwMDBfaGRt
aTFfZW5jb2Rlcl9yZXNldChzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIpDQorew0KKwlzdHJ1
Y3QgZHJtX2RldmljZSAqZGRldiA9IGVuY29kZXItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJdTMyIHZhbDsNCisNCisJdmFsID0gUEhZX0NMT0NL
X1BPTCB8IFBIWV9DTE9DS19FTiB8IFBIWV9EQVRBX0VOOw0KKwlsc2RjX3dyZWczMihsZGV2LCBM
U0RDX0NSVEMxX1BBTkVMX0NPTkZfUkVHLCB2YWwpOw0KKw0KKwkvKiB1c2luZyBzb2Z0d2FyZSBn
cGlvIGVtdWxhdGVkIGkyYyAqLw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0hETUkx
X0lOVEZfQ1RSTF9SRUcpOw0KKwl2YWwgJj0gfkhXX0kyQ19FTjsNCisJbHNkY193cmVnMzIobGRl
diwgTFNEQ19IRE1JMV9JTlRGX0NUUkxfUkVHLCB2YWwpOw0KKw0KKwkvKiAgaGVscCB0aGUgaGRt
aSBwaHkgdG8gZ2V0IG91dCBvZiByZXNldCBzdGF0ZSAqLw0KKwlsc2RjX3dyZWczMihsZGV2LCBM
U0RDX0hETUkxX1BIWV9DVFJMX1JFRywgSERNSV9QSFlfUkVTRVRfTik7DQorDQorCW1kZWxheSgy
MCk7DQorDQorCWRybV9kYmcoZGRldiwgIkhETUktMSBSZXNldFxuIik7DQorfQ0KKw0KK3N0YXRp
YyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfZnVuY3MgbHM3YTIwMDBfZW5jb2Rlcl9mdW5jc1sy
XSA9IHsNCisJew0KKwkJLnJlc2V0ID0gbHM3YTIwMDBfaGRtaTBfZW5jb2Rlcl9yZXNldCwNCisJ
CS5kZXN0cm95ID0gZHJtX2VuY29kZXJfY2xlYW51cCwNCisJfSwNCisJew0KKwkJLnJlc2V0ID0g
bHM3YTIwMDBfaGRtaTFfZW5jb2Rlcl9yZXNldCwNCisJCS5kZXN0cm95ID0gZHJtX2VuY29kZXJf
Y2xlYW51cCwNCisJfSwNCit9Ow0KKw0KK3N0YXRpYyBpbnQgbHM3YTIwMDBfaGRtaV9zZXRfYXZp
X2luZm9mcmFtZShzdHJ1Y3QgZHJtX2VuY29kZXIgKmVuY29kZXIsDQorCQkJCQkgICBzdHJ1Y3Qg
ZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0
ID0gZW5jb2Rlcl90b19sc2RjX291dHB1dChlbmNvZGVyKTsNCisJc3RydWN0IGxzZGNfZGlzcGxh
eV9waXBlICpkaXNwaXBlID0gb3V0cHV0X3RvX2Rpc3BsYXlfcGlwZShvdXRwdXQpOw0KKwl1bnNp
Z25lZCBpbnQgaW5kZXggPSBkaXNwaXBlLT5pbmRleDsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYgPSBlbmNvZGVyLT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMo
ZGRldik7DQorCXN0cnVjdCBoZG1pX2F2aV9pbmZvZnJhbWUgaW5mb2ZyYW1lOw0KKwl1OCBidWZm
ZXJbSERNSV9JTkZPRlJBTUVfU0laRShBVkkpXTsNCisJdW5zaWduZWQgY2hhciAqcHRyID0gJmJ1
ZmZlcltIRE1JX0lORk9GUkFNRV9IRUFERVJfU0laRV07DQorCXVuc2lnbmVkIGludCBjb250ZW50
MCwgY29udGVudDEsIGNvbnRlbnQyLCBjb250ZW50MzsNCisJaW50IGVycjsNCisNCisJZXJyID0g
ZHJtX2hkbWlfYXZpX2luZm9mcmFtZV9mcm9tX2Rpc3BsYXlfbW9kZSgmaW5mb2ZyYW1lLA0KKwkJ
CQkJCSAgICAgICAmb3V0cHV0LT5jb25uZWN0b3IsDQorCQkJCQkJICAgICAgIG1vZGUpOw0KKwlp
ZiAoZXJyIDwgMCkgew0KKwkJZHJtX2VycihkZGV2LCAiZmFpbGVkIHRvIHNldHVwIEFWSSBpbmZv
ZnJhbWU6ICVkXG4iLCBlcnIpOw0KKwkJcmV0dXJuIGVycjsNCisJfQ0KKw0KKwkvKiBGaXhlZCBp
bmZvZnJhbWUgY29uZmlndXJhdGlvbiBub3QgbGlua2VkIHRvIHRoZSBtb2RlICovDQorCWluZm9m
cmFtZS5jb2xvcnNwYWNlID0gSERNSV9DT0xPUlNQQUNFX1JHQjsNCisJaW5mb2ZyYW1lLnF1YW50
aXphdGlvbl9yYW5nZSA9IEhETUlfUVVBTlRJWkFUSU9OX1JBTkdFX0RFRkFVTFQ7DQorCWluZm9m
cmFtZS5jb2xvcmltZXRyeSA9IEhETUlfQ09MT1JJTUVUUllfTk9ORTsNCisNCisJZXJyID0gaGRt
aV9hdmlfaW5mb2ZyYW1lX3BhY2soJmluZm9mcmFtZSwgYnVmZmVyLCBzaXplb2YoYnVmZmVyKSk7
DQorCWlmIChlcnIgPCAwKSB7DQorCQlkcm1fZXJyKGRkZXYsICJmYWlsZWQgdG8gcGFjayBBVkkg
aW5mb2ZyYW1lOiAlZFxuIiwgZXJyKTsNCisJCQlyZXR1cm4gZXJyOw0KKwl9DQorDQorCWNvbnRl
bnQwID0gKih1bnNpZ25lZCBpbnQgKilwdHI7DQorCWNvbnRlbnQxID0gKihwdHIgKyA0KTsNCisJ
Y29udGVudDIgPSAqKHVuc2lnbmVkIGludCAqKShwdHIgKyA1KTsNCisJY29udGVudDMgPSAqKHVu
c2lnbmVkIGludCAqKShwdHIgKyA5KTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RD
X0hETUkwX0FWSV9DT05URU5UMCwgaW5kZXgsIGNvbnRlbnQwKTsNCisJbHNkY19waXBlX3dyZWcz
MihsZGV2LCBMU0RDX0hETUkwX0FWSV9DT05URU5UMSwgaW5kZXgsIGNvbnRlbnQxKTsNCisJbHNk
Y19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX0FWSV9DT05URU5UMiwgaW5kZXgsIGNvbnRl
bnQyKTsNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkwX0FWSV9DT05URU5UMywg
aW5kZXgsIGNvbnRlbnQzKTsNCisNCisJbHNkY19waXBlX3dyZWczMihsZGV2LCBMU0RDX0hETUkw
X0FWSV9JTkZPX0NSVExfUkVHLCBpbmRleCwNCisJCQkgQVZJX1BLVF9FTkFCTEUgfCBBVklfUEtU
X1VQREFURSk7DQorDQorCWRybV9kYmcoZGRldiwgIlVwZGF0ZSBIRE1JLSV1IGF2aSBpbmZvZnJh
bWVcbiIsIGluZGV4KTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzN2Ey
MDAwX2hkbWlfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLA0KKwkJ
CQkJIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX291
dHB1dCAqb3V0cHV0ID0gZW5jb2Rlcl90b19sc2RjX291dHB1dChlbmNvZGVyKTsNCisJc3RydWN0
IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBlID0gb3V0cHV0X3RvX2Rpc3BsYXlfcGlwZShvdXRw
dXQpOw0KKwl1bnNpZ25lZCBpbnQgaW5kZXggPSBkaXNwaXBlLT5pbmRleDsNCisJc3RydWN0IGRy
bV9kZXZpY2UgKmRkZXYgPSBlbmNvZGVyLT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diA9IHRvX2xzZGMoZGRldik7DQorCXUzMiB2YWw7DQorDQorCS8qIERpc2FibGUgdGhlIGhkbWkg
cGh5ICovDQorCXZhbCA9IGxzZGNfcGlwZV9ycmVnMzIobGRldiwgTFNEQ19IRE1JMF9QSFlfQ1RS
TF9SRUcsIGluZGV4KTsNCisJdmFsICY9IH5IRE1JX1BIWV9FTjsNCisJbHNkY19waXBlX3dyZWcz
MihsZGV2LCBMU0RDX0hETUkwX1BIWV9DVFJMX1JFRywgaW5kZXgsIHZhbCk7DQorDQorCS8qIERp
c2FibGUgdGhlIGhkbWkgaW50ZXJmYWNlICovDQorCXZhbCA9IGxzZGNfcGlwZV9ycmVnMzIobGRl
diwgTFNEQ19IRE1JMF9JTlRGX0NUUkxfUkVHLCBpbmRleCk7DQorCXZhbCAmPSB+SERNSV9JTlRF
UkZBQ0VfRU47DQorCWxzZGNfcGlwZV93cmVnMzIobGRldiwgTFNEQ19IRE1JMF9JTlRGX0NUUkxf
UkVHLCBpbmRleCwgdmFsKTsNCisNCisJZHJtX2RiZyhkZGV2LCAiSERNSS0ldSBkaXNhYmxlZFxu
IiwgaW5kZXgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsczdhMjAwMF9oZG1pX2F0b21pY19lbmFi
bGUoc3RydWN0IGRybV9lbmNvZGVyICplbmNvZGVyLA0KKwkJCQkJc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBlbmNvZGVyLT5k
ZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCXN0cnVj
dCBsc2RjX291dHB1dCAqb3V0cHV0ID0gZW5jb2Rlcl90b19sc2RjX291dHB1dChlbmNvZGVyKTsN
CisJc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBlID0gb3V0cHV0X3RvX2Rpc3BsYXlf
cGlwZShvdXRwdXQpOw0KKwl1bnNpZ25lZCBpbnQgaW5kZXggPSBkaXNwaXBlLT5pbmRleDsNCisJ
dTMyIHZhbDsNCisNCisJLyogZGF0YXNoZWV0IHNheSBpdCBzaG91bGQgbGFyZ2VyIHRoYW4gNDgg
Ki8NCisJdmFsID0gNjQgPDwgSERNSV9IX1pPTkVfSURMRV9TSElGVCB8IDY0IDw8IEhETUlfVl9a
T05FX0lETEVfU0hJRlQ7DQorDQorCWxzZGNfcGlwZV93cmVnMzIobGRldiwgTFNEQ19IRE1JMF9a
T05FX1JFRywgaW5kZXgsIHZhbCk7DQorDQorCXZhbCA9IEhETUlfUEhZX1RFUk1fU1RBVFVTIHwN
CisJICAgICAgSERNSV9QSFlfVEVSTV9ERVRfRU4gfA0KKwkgICAgICBIRE1JX1BIWV9URVJNX0hf
RU4gfA0KKwkgICAgICBIRE1JX1BIWV9URVJNX0xfRU4gfA0KKwkgICAgICBIRE1JX1BIWV9SRVNF
VF9OIHwNCisJICAgICAgSERNSV9QSFlfRU47DQorDQorCWxzZGNfcGlwZV93cmVnMzIobGRldiwg
TFNEQ19IRE1JMF9QSFlfQ1RSTF9SRUcsIGluZGV4LCB2YWwpOw0KKw0KKwl1ZGVsYXkoMik7DQor
DQorCXZhbCA9IEhETUlfQ1RMX1BFUklPRF9NT0RFIHwNCisJICAgICAgSERNSV9BVURJT19FTiB8
DQorCSAgICAgIEhETUlfUEFDS0VUX0VOIHwNCisJICAgICAgSERNSV9JTlRFUkZBQ0VfRU4gfA0K
KwkgICAgICAoOCA8PCBIRE1JX1ZJREVPX1BSRUFNQkxFX1NISUZUKTsNCisNCisJbHNkY19waXBl
X3dyZWczMihsZGV2LCBMU0RDX0hETUkwX0lOVEZfQ1RSTF9SRUcsIGluZGV4LCB2YWwpOw0KKw0K
Kwlkcm1fZGJnKGRkZXYsICJIRE1JLSV1IGVuYWJsZWRcbiIsIGluZGV4KTsNCit9DQorDQorLyoN
CisgKiAgRm91dCA9IE0gKiBGaW4NCisgKg0KKyAqICBNID0gKDQgKiBMRikgLyAoSURGICogT0RG
KQ0KKyAqDQorICogIElERjogSW5wdXQgRGl2aXNpb24gRmFjdG9yDQorICogIE9ERjogT3V0cHV0
IERpdmlzaW9uIEZhY3Rvcg0KKyAqICAgTEY6IExvb3AgRmFjdG9yDQorICogICAgTTogUmVxdWly
ZWQgTXVsdA0KKyAqDQorICogICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLSsNCisgKiAgfCAgICAgRmluIChrSFopICAgICB8IE0gIHwgSURG
IHwgTEYgfCBPREYgfCAgIEZvdXQoTWh6KSAgfA0KKyAqICB8LS0tLS0tLS0tLS0tLS0tLS0tLSst
LS0tKy0tLS0tKy0tLS0rLS0tLS0rLS0tLS0tLS0tLS0tLS18DQorICogIHwgIDE3MDAwMCB+IDM0
MDAwMCAgfCAxMCB8IDE2ICB8IDQwIHwgIDEgIHwgMTcwMCB+IDM0MDAgIHwNCisgKiAgfCAgIDg1
MDAwIH4gMTcwMDAwICB8IDEwIHwgIDggIHwgNDAgfCAgMiAgfCAgODUwIH4gMTcwMCAgfA0KKyAq
ICB8ICAgNDI1MDAgfiAgODUwMDAgIHwgMTAgfCAgNCAgfCA0MCB8ICA0ICB8ICA0MjUgfiA4NTAg
ICB8DQorICogIHwgICAyMTI1MCB+ICA0MjUwMCAgfCAxMCB8ICAyICB8IDQwIHwgIDggIHwgMjEy
LjUgfiA0MjUgIHwNCisgKiAgfCAgIDIwMDAwIH4gIDIxMjUwICB8IDEwIHwgIDEgIHwgNDAgfCAx
NiAgfCAgMjAwIH4gMjEyLjUgfA0KKyAqICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rDQorICovDQorc3RhdGljIHZvaWQgbHM3YTIwMDBf
aGRtaV9waHlfcGxsX2NvbmZpZyhzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQorCQkJCQkgaW50
IGZpbiwNCisJCQkJCSB1bnNpZ25lZCBpbnQgaW5kZXgpDQorew0KKwlzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGRldiA9ICZsZGV2LT5iYXNlOw0KKwlpbnQgY291bnQgPSAwOw0KKwl1MzIgdmFsOw0KKw0K
KwkvKiBGaXJzdGx5LCBkaXNhYmxlIHBoeSBwbGwgKi8NCisJbHNkY19waXBlX3dyZWczMihsZGV2
LCBMU0RDX0hETUkwX1BIWV9QTExfUkVHLCBpbmRleCwgMHgwKTsNCisNCisJLyoNCisJICogTW9z
dCBvZiB0aW1lLCBsb29uZ3NvbiBIRE1JIHJlcXVpcmUgTSA9IDEwDQorCSAqIGZvciBleGFtcGxl
LCAxMCA9ICg0ICogNDApIC8gKDggKiAyKQ0KKwkgKiBoZXJlLCB3cml0ZSAiMSIgdG8gdGhlIE9E
RiB3aWxsIGdldCAiMiINCisJICovDQorDQorCWlmIChmaW4gPj0gMTcwMDAwKQ0KKwkJdmFsID0g
KDE2IDw8IEhETUlfUExMX0lERl9TSElGVCkgfA0KKwkJICAgICAgKDQwIDw8IEhETUlfUExMX0xG
X1NISUZUKSB8DQorCQkgICAgICAoMCA8PCBIRE1JX1BMTF9PREZfU0hJRlQpOw0KKwllbHNlIGlm
IChmaW4gPj0gODUwMDApDQorCQl2YWwgPSAoOCA8PCBIRE1JX1BMTF9JREZfU0hJRlQpIHwNCisJ
CSAgICAgICg0MCA8PCBIRE1JX1BMTF9MRl9TSElGVCkgfA0KKwkJICAgICAgKDEgPDwgSERNSV9Q
TExfT0RGX1NISUZUKTsNCisJZWxzZSBpZiAoZmluID49IDQyNTAwKQ0KKwkJdmFsID0gKDQgPDwg
SERNSV9QTExfSURGX1NISUZUKSB8DQorCQkgICAgICAoNDAgPDwgSERNSV9QTExfTEZfU0hJRlQp
IHwNCisJCSAgICAgICgyIDw8IEhETUlfUExMX09ERl9TSElGVCk7DQorCWVsc2UgaWYgIChmaW4g
Pj0gMjEyNTApDQorCQl2YWwgPSAoMiA8PCBIRE1JX1BMTF9JREZfU0hJRlQpIHwNCisJCSAgICAg
ICg0MCA8PCBIRE1JX1BMTF9MRl9TSElGVCkgfA0KKwkJICAgICAgKDMgPDwgSERNSV9QTExfT0RG
X1NISUZUKTsNCisJZWxzZQ0KKwkJdmFsID0gKDEgPDwgSERNSV9QTExfSURGX1NISUZUKSB8DQor
CQkgICAgICAoNDAgPDwgSERNSV9QTExfTEZfU0hJRlQpIHwNCisJCSAgICAgICg0IDw8IEhETUlf
UExMX09ERl9TSElGVCk7DQorDQorCWxzZGNfcGlwZV93cmVnMzIobGRldiwgTFNEQ19IRE1JMF9Q
SFlfUExMX1JFRywgaW5kZXgsIHZhbCk7DQorDQorCXZhbCB8PSBIRE1JX1BMTF9FTkFCTEU7DQor
DQorCWxzZGNfcGlwZV93cmVnMzIobGRldiwgTFNEQ19IRE1JMF9QSFlfUExMX1JFRywgaW5kZXgs
IHZhbCk7DQorDQorCXVkZWxheSgyKTsNCisNCisJZHJtX2RiZyhkZGV2LCAiRmluIG9mIEhETUkt
JXU6ICVkIGtIelxuIiwgaW5kZXgsIGZpbik7DQorDQorCS8qIFdhaXQgaGRtaSBwaHkgcGxsIGxv
Y2sgKi8NCisJZG8gew0KKwkJdmFsID0gbHNkY19waXBlX3JyZWczMihsZGV2LCBMU0RDX0hETUkw
X1BIWV9QTExfUkVHLCBpbmRleCk7DQorDQorCQlpZiAodmFsICYgSERNSV9QTExfTE9DS0VEKSB7
DQorCQkJZHJtX2RiZyhkZGV2LCAiU2V0dGluZyBIRE1JLSV1IFBMTCB0YWtlICVkIGN5Y2xlc1xu
IiwNCisJCQkJaW5kZXgsIGNvdW50KTsNCisJCQlicmVhazsNCisJCX0NCisJCSsrY291bnQ7DQor
CX0gd2hpbGUgKGNvdW50IDwgMTAwMCk7DQorDQorCWxzZGNfcGlwZV93cmVnMzIobGRldiwgTFNE
Q19IRE1JMF9QSFlfQ0FMX1JFRywgaW5kZXgsIDB4MGYwMDBmZjApOw0KKw0KKwlpZiAoY291bnQg
Pj0gMTAwMCkNCisJCWRybV9lcnIoZGRldiwgIlNldHRpbmcgSERNSS0ldSBQTEwgZmFpbGVkXG4i
LCBpbmRleCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzN2EyMDAwX2hkbWlfYXRvbWljX21vZGVf
c2V0KHN0cnVjdCBkcm1fZW5jb2RlciAqZW5jb2RlciwNCisJCQkJCSAgc3RydWN0IGRybV9jcnRj
X3N0YXRlICpjcnRjX3N0YXRlLA0KKwkJCQkJICBzdHJ1Y3QgZHJtX2Nvbm5lY3Rvcl9zdGF0ZSAq
Y29ubl9zdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX291dHB1dCAqb3V0cHV0ID0gZW5jb2Rlcl90
b19sc2RjX291dHB1dChlbmNvZGVyKTsNCisJc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNw
aXBlID0gb3V0cHV0X3RvX2Rpc3BsYXlfcGlwZShvdXRwdXQpOw0KKwl1bnNpZ25lZCBpbnQgaW5k
ZXggPSBkaXNwaXBlLT5pbmRleDsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBlbmNvZGVy
LT5kZXY7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCXN0
cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJmNydGNfc3RhdGUtPm1vZGU7DQorDQorCWxz
N2EyMDAwX2hkbWlfcGh5X3BsbF9jb25maWcobGRldiwgbW9kZS0+Y2xvY2ssIGluZGV4KTsNCisN
CisJbHM3YTIwMDBfaGRtaV9zZXRfYXZpX2luZm9mcmFtZShlbmNvZGVyLCBtb2RlKTsNCisNCisJ
ZHJtX2RiZyhkZGV2LCAiJXMgbW9kZXNldCBmaW5pc2hlZFxuIiwgZW5jb2Rlci0+bmFtZSk7DQor
fQ0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgZHJtX2VuY29kZXJfaGVscGVyX2Z1bmNzIGxzN2Ey
MDAwX2VuY29kZXJfaGVscGVyX2Z1bmNzID0gew0KKwkuYXRvbWljX2Rpc2FibGUgPSBsczdhMjAw
MF9oZG1pX2F0b21pY19kaXNhYmxlLA0KKwkuYXRvbWljX2VuYWJsZSA9IGxzN2EyMDAwX2hkbWlf
YXRvbWljX2VuYWJsZSwNCisJLmF0b21pY19tb2RlX3NldCA9IGxzN2EyMDAwX2hkbWlfYXRvbWlj
X21vZGVfc2V0LA0KK307DQorDQorLyoNCisgKiBGb3IgTFM3QTIwMDA6DQorICoNCisgKiAxKSBN
b3N0IG9mIGJvYXJkIGV4cG9ydCBvbmUgdmdhICsgaGRtaSBvdXRwdXQgaW50ZXJmYWNlLg0KKyAq
IDIpIFlldCwgU29tZSBib2FyZHMgZXhwb3J0IGRvdWJsZSBoZG1pIG91dHB1dCBpbnRlcmZhY2Uu
DQorICogMykgU3RpbGwgaGF2ZSBib2FyZHMgZXhwb3J0IHRocmVlIG91dHB1dCgyIGhkbWkgKyAx
IHZnYSkuDQorICoNCisgKiBTbyBsZXQncyBob29rIGhkbWkgaGVscGVyIGZ1bmNzIHRvIGFsbCBk
aXNwbGF5IHBpcGUsIGRvbid0IG1pc3MuDQorICogd3JpdGluZyBoZG1pIHJlZ2lzdGVyIGRvIG5v
IGhhcm1zLg0KKyAqLw0KK2ludCBsczdhMjAwMF9vdXRwdXRfaW5pdChzdHJ1Y3QgZHJtX2Rldmlj
ZSAqZGRldiwNCisJCQkgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlICpkaXNwaXBlLA0KKwkJCSBz
dHJ1Y3QgaTJjX2FkYXB0ZXIgKmRkYywNCisJCQkgdW5zaWduZWQgaW50IHBpcGUpDQorew0KKwlz
dHJ1Y3QgbHNkY19vdXRwdXQgKm91dHB1dCA9ICZkaXNwaXBlLT5vdXRwdXQ7DQorCXN0cnVjdCBk
cm1fZW5jb2RlciAqZW5jb2RlciA9ICZvdXRwdXQtPmVuY29kZXI7DQorCXN0cnVjdCBkcm1fY29u
bmVjdG9yICpjb25uZWN0b3IgPSAmb3V0cHV0LT5jb25uZWN0b3I7DQorCWludCByZXQ7DQorDQor
CXJldCA9IGRybV9lbmNvZGVyX2luaXQoZGRldiwNCisJCQkgICAgICAgZW5jb2RlciwNCisJCQkg
ICAgICAgJmxzN2EyMDAwX2VuY29kZXJfZnVuY3NbcGlwZV0sDQorCQkJICAgICAgIERSTV9NT0RF
X0VOQ09ERVJfVE1EUywNCisJCQkgICAgICAgImVuY29kZXItJXUiLA0KKwkJCSAgICAgICBwaXBl
KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWVuY29kZXItPnBvc3NpYmxlX2Ny
dGNzID0gQklUKHBpcGUpOw0KKw0KKwlkcm1fZW5jb2Rlcl9oZWxwZXJfYWRkKGVuY29kZXIsICZs
czdhMjAwMF9lbmNvZGVyX2hlbHBlcl9mdW5jcyk7DQorDQorCXJldCA9IGRybV9jb25uZWN0b3Jf
aW5pdF93aXRoX2RkYyhkZGV2LA0KKwkJCQkJICBjb25uZWN0b3IsDQorCQkJCQkgICZsczdhMjAw
MF9oZG1pX2Nvbm5lY3Rvcl9mdW5jc1twaXBlXSwNCisJCQkJCSAgRFJNX01PREVfQ09OTkVDVE9S
X0hETUlBLA0KKwkJCQkJICBkZGMpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJ
ZHJtX2luZm8oZGRldiwgImRpc3BsYXkgcGlwZS0ldSBoYXMgSERNSSAlc1xuIiwgcGlwZSwgcGlw
ZSA/ICIiIDogImFuZC9vciBWR0EiKTsNCisNCisJZHJtX2Nvbm5lY3Rvcl9oZWxwZXJfYWRkKGNv
bm5lY3RvciwgJmxzN2EyMDAwX2Nvbm5lY3Rvcl9oZWxwZXJzKTsNCisNCisJZHJtX2Nvbm5lY3Rv
cl9hdHRhY2hfZW5jb2Rlcihjb25uZWN0b3IsIGVuY29kZXIpOw0KKw0KKwljb25uZWN0b3ItPnBv
bGxlZCA9IERSTV9DT05ORUNUT1JfUE9MTF9DT05ORUNUIHwNCisJCQkgICAgRFJNX0NPTk5FQ1RP
Ul9QT0xMX0RJU0NPTk5FQ1Q7DQorDQorCWNvbm5lY3Rvci0+aW50ZXJsYWNlX2FsbG93ZWQgPSAw
Ow0KKwljb25uZWN0b3ItPmRvdWJsZXNjYW5fYWxsb3dlZCA9IDA7DQorDQorCXJldHVybiAwOw0K
K30NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsu
YyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5jDQpuZXcgZmlsZSBt
b2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi5iYjgyMzUyYjA0MmENCi0tLSAvZGV2L251
bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5jDQpAQCAt
MCwwICsxLDEzMiBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wKw0KKy8q
DQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24g
TGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisNCisjaW5j
bHVkZSAibHNkY19iZW5jaG1hcmsuaCINCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisjaW5jbHVk
ZSAibHNkY19nZW0uaCINCisjaW5jbHVkZSAibHNkY190dG0uaCINCisNCit0eXBlZGVmIHZvaWQg
KCpsc2RjX2NvcHlfcHJvY190KShzdHJ1Y3QgbHNkY19ibyAqc3JjX2JvLA0KKwkJCQkgc3RydWN0
IGxzZGNfYm8gKmRzdF9ibywNCisJCQkJIHVuc2lnbmVkIGludCBzaXplLA0KKwkJCQkgaW50IG4p
Ow0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY29weV9ndHRfdG9fdnJhbV9jcHUoc3RydWN0IGxzZGNf
Ym8gKnNyY19ibywNCisJCQkJICAgICAgc3RydWN0IGxzZGNfYm8gKmRzdF9ibywNCisJCQkJICAg
ICAgdW5zaWduZWQgaW50IHNpemUsDQorCQkJCSAgICAgIGludCBuKQ0KK3sNCisJbHNkY19ib19r
bWFwKHNyY19ibyk7DQorCWxzZGNfYm9fa21hcChkc3RfYm8pOw0KKw0KKwl3aGlsZSAobi0tKQ0K
KwkJbWVtY3B5X3RvaW8oZHN0X2JvLT5rcHRyLCBzcmNfYm8tPmtwdHIsIHNpemUpOw0KKw0KKwls
c2RjX2JvX2t1bm1hcChzcmNfYm8pOw0KKwlsc2RjX2JvX2t1bm1hcChkc3RfYm8pOw0KK30NCisN
CitzdGF0aWMgdm9pZCBsc2RjX2NvcHlfdnJhbV90b19ndHRfY3B1KHN0cnVjdCBsc2RjX2JvICpz
cmNfYm8sDQorCQkJCSAgICAgIHN0cnVjdCBsc2RjX2JvICpkc3RfYm8sDQorCQkJCSAgICAgIHVu
c2lnbmVkIGludCBzaXplLA0KKwkJCQkgICAgICBpbnQgbikNCit7DQorCWxzZGNfYm9fa21hcChz
cmNfYm8pOw0KKwlsc2RjX2JvX2ttYXAoZHN0X2JvKTsNCisNCisJd2hpbGUgKG4tLSkNCisJCW1l
bWNweV9mcm9taW8oZHN0X2JvLT5rcHRyLCBzcmNfYm8tPmtwdHIsIHNpemUpOw0KKw0KKwlsc2Rj
X2JvX2t1bm1hcChzcmNfYm8pOw0KKwlsc2RjX2JvX2t1bm1hcChkc3RfYm8pOw0KK30NCisNCitz
dGF0aWMgdm9pZCBsc2RjX2NvcHlfZ3R0X3RvX2d0dF9jcHUoc3RydWN0IGxzZGNfYm8gKnNyY19i
bywNCisJCQkJICAgICBzdHJ1Y3QgbHNkY19ibyAqZHN0X2JvLA0KKwkJCQkgICAgIHVuc2lnbmVk
IGludCBzaXplLA0KKwkJCQkgICAgIGludCBuKQ0KK3sNCisJbHNkY19ib19rbWFwKHNyY19ibyk7
DQorCWxzZGNfYm9fa21hcChkc3RfYm8pOw0KKw0KKwl3aGlsZSAobi0tKQ0KKwkJbWVtY3B5KGRz
dF9iby0+a3B0ciwgc3JjX2JvLT5rcHRyLCBzaXplKTsNCisNCisJbHNkY19ib19rdW5tYXAoc3Jj
X2JvKTsNCisJbHNkY19ib19rdW5tYXAoZHN0X2JvKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNk
Y19iZW5jaG1hcmtfY29weShzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQorCQkJCXVuc2lnbmVk
IGludCBzaXplLA0KKwkJCQl1bnNpZ25lZCBpbnQgbiwNCisJCQkJdTMyIHNyY19kb21haW4sDQor
CQkJCXUzMiBkc3RfZG9tYWluLA0KKwkJCQlsc2RjX2NvcHlfcHJvY190IGNvcHlfcHJvYywNCisJ
CQkJc3RydWN0IGRybV9wcmludGVyICpwKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYg
PSAmbGRldi0+YmFzZTsNCisJc3RydWN0IGxzZGNfYm8gKnNyY19ibzsNCisJc3RydWN0IGxzZGNf
Ym8gKmRzdF9ibzsNCisJdW5zaWduZWQgbG9uZyBzdGFydF9qaWZmaWVzOw0KKwl1bnNpZ25lZCBs
b25nIGVuZF9qaWZmaWVzOw0KKwl1bnNpZ25lZCBpbnQgdGhyb3VnaHB1dDsNCisJdW5zaWduZWQg
aW50IHRpbWU7DQorDQorCXNyY19ibyA9IGxzZGNfYm9fY3JlYXRlX2tlcm5lbF9waW5uZWQoZGRl
diwgc3JjX2RvbWFpbiwgc2l6ZSk7DQorCWRzdF9ibyA9IGxzZGNfYm9fY3JlYXRlX2tlcm5lbF9w
aW5uZWQoZGRldiwgZHN0X2RvbWFpbiwgc2l6ZSk7DQorDQorCXN0YXJ0X2ppZmZpZXMgPSBqaWZm
aWVzOw0KKw0KKwljb3B5X3Byb2Moc3JjX2JvLCBkc3RfYm8sIHNpemUsIG4pOw0KKw0KKwllbmRf
amlmZmllcyA9IGppZmZpZXM7DQorDQorCWxzZGNfYm9fZnJlZV9rZXJuZWxfcGlubmVkKHNyY19i
byk7DQorCWxzZGNfYm9fZnJlZV9rZXJuZWxfcGlubmVkKGRzdF9ibyk7DQorDQorCXRpbWUgPSBq
aWZmaWVzX3RvX21zZWNzKGVuZF9qaWZmaWVzIC0gc3RhcnRfamlmZmllcyk7DQorDQorCXRocm91
Z2hwdXQgPSAobiAqIChzaXplID4+IDEwKSkgLyB0aW1lOw0KKw0KKwlkcm1fcHJpbnRmKHAsICJD
b3B5IGJvIG9mICV1a0IgZnJvbSAlcyB0byAlcyBpbiAldW1zLCAldU1CL3NcbiIsDQorCQkgICBz
aXplID4+IDEwLA0KKwkJICAgbHNkY19kb21haW5fdG9fc3RyKHNyY19kb21haW4pLA0KKwkJICAg
bHNkY19kb21haW5fdG9fc3RyKGRzdF9kb21haW4pLA0KKwkJICAgdGltZSwgdGhyb3VnaHB1dCk7
DQorfQ0KKw0KK2ludCBsc2RjX3Nob3dfYmVuY2htYXJrX2NvcHkoc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2LCBzdHJ1Y3QgZHJtX3ByaW50ZXIgKnApDQorew0KKwl1bnNpZ25lZCBpbnQgYnVmZmVy
X3NpemUgPSAxOTIwICogMTA4MCAqIDQ7DQorCXVuc2lnbmVkIGludCBpdGVyYXRpb24gPSA2MDsN
CisNCisJbHNkY19iZW5jaG1hcmtfY29weShsZGV2LA0KKwkJCSAgICBidWZmZXJfc2l6ZSwNCisJ
CQkgICAgaXRlcmF0aW9uLA0KKwkJCSAgICBMU0RDX0dFTV9ET01BSU5fR1RULA0KKwkJCSAgICBM
U0RDX0dFTV9ET01BSU5fR1RULA0KKwkJCSAgICBsc2RjX2NvcHlfZ3R0X3RvX2d0dF9jcHUsDQor
CQkJICAgIHApOw0KKw0KKwlsc2RjX2JlbmNobWFya19jb3B5KGxkZXYsDQorCQkJICAgIGJ1ZmZl
cl9zaXplLA0KKwkJCSAgICBpdGVyYXRpb24sDQorCQkJICAgIExTRENfR0VNX0RPTUFJTl9HVFQs
DQorCQkJICAgIExTRENfR0VNX0RPTUFJTl9WUkFNLA0KKwkJCSAgICBsc2RjX2NvcHlfZ3R0X3Rv
X3ZyYW1fY3B1LA0KKwkJCSAgICBwKTsNCisNCisJbHNkY19iZW5jaG1hcmtfY29weShsZGV2LA0K
KwkJCSAgICBidWZmZXJfc2l6ZSwNCisJCQkgICAgaXRlcmF0aW9uLA0KKwkJCSAgICBMU0RDX0dF
TV9ET01BSU5fVlJBTSwNCisJCQkgICAgTFNEQ19HRU1fRE9NQUlOX0dUVCwNCisJCQkgICAgbHNk
Y19jb3B5X3ZyYW1fdG9fZ3R0X2NwdSwNCisJCQkgICAgcCk7DQorDQorCXJldHVybiAwOw0KK30N
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19iZW5jaG1hcmsuaCBi
L2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5oDQpuZXcgZmlsZSBtb2Rl
IDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi4yYmY5NDA2ZWFlOWMNCi0tLSAvZGV2L251bGwN
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2JlbmNobWFyay5oDQpAQCAtMCww
ICsxLDEzIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCisvKg0K
KyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExp
bWl0ZWQNCisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19CRU5DSE1BUktfSF9fDQorI2RlZmluZSBf
X0xTRENfQkVOQ0hNQVJLX0hfXw0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKw0KK2ludCBs
c2RjX3Nob3dfYmVuY2htYXJrX2NvcHkoc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2LCBzdHJ1Y3Qg
ZHJtX3ByaW50ZXIgKnApOw0KKw0KKyNlbmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX2NydGMuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2Ny
dGMuYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uYjM4YzlkMDE1
YmZkDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19j
cnRjLmMNCkBAIC0wLDAgKzEsMTA2OCBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBH
UEwtMi4wDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBD
b3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+DQor
DQorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWljLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fYXRvbWlj
X2hlbHBlci5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2RlYnVnZnMuaD4NCisjaW5jbHVkZSA8ZHJt
L2RybV92YmxhbmsuaD4NCisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisNCisvKg0KKyAqIFRo
ZSBzb2Z0IHJlc2V0IGNhdXNlIHRoZSB2YmxhbmsgY291bnRlciByZXNldCB0byB6ZXJvLCBidXQg
dGhlIGFkZHJlc3MNCisgKiBhbmQgb3RoZXIgc2V0dGluZ3MgaW4gdGhlIGNydGMgcmVnaXN0ZXIg
cmVtYWlucy4NCisgKi8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMwX3NvZnRfcmVzZXQoc3Ry
dWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBs
Y3J0Yy0+bGRldjsNCisJdTMyIHZhbDsNCisNCisJdmFsID0gbHNkY19ycmVnMzIobGRldiwgTFNE
Q19DUlRDMF9DRkdfUkVHKTsNCisNCisJdmFsICY9IENGR19WQUxJRF9CSVRTX01BU0s7DQorDQor
CS8qIHNvZnQgcmVzZXQgYml0LCBhY3RpdmUgbG93ICovDQorCXZhbCAmPSB+Q0ZHX1JFU0VUX047
DQorDQorCXZhbCAmPSB+Q0ZHX1BJWF9GTVRfTUFTSzsNCisNCisJbHNkY193cmVnMzIobGRldiwg
TFNEQ19DUlRDMF9DRkdfUkVHLCB2YWwpOw0KKw0KKwl1ZGVsYXkoNSk7DQorDQorCXZhbCB8PSBD
RkdfUkVTRVRfTiB8IExTRENfUEZfWFJHQjg4ODggfCBDRkdfT1VUUFVUX0VOQUJMRTsNCisNCisJ
bHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9DRkdfUkVHLCB2YWwpOw0KKw0KKwltZGVsYXko
MjApOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMxX3NvZnRfcmVzZXQoc3RydWN0IGxz
ZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+
bGRldjsNCisJdTMyIHZhbDsNCisNCisJdmFsID0gbHNkY19ycmVnMzIobGRldiwgTFNEQ19DUlRD
MV9DRkdfUkVHKTsNCisNCisJdmFsICY9IENGR19WQUxJRF9CSVRTX01BU0s7DQorDQorCS8qIHNv
ZnQgcmVzZXQgYml0LCBhY3RpdmUgbG93ICovDQorCXZhbCAmPSB+Q0ZHX1JFU0VUX047DQorDQor
CXZhbCAmPSB+Q0ZHX1BJWF9GTVRfTUFTSzsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19D
UlRDMV9DRkdfUkVHLCB2YWwpOw0KKw0KKwl1ZGVsYXkoNSk7DQorDQorCXZhbCB8PSBDRkdfUkVT
RVRfTiB8IExTRENfUEZfWFJHQjg4ODggfCBDRkdfT1VUUFVUX0VOQUJMRTsNCisNCisJbHNkY193
cmVnMzIobGRldiwgTFNEQ19DUlRDMV9DRkdfUkVHLCB2YWwpOw0KKw0KKwltc2xlZXAoMjApOw0K
K30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMwX2VuYWJsZShzdHJ1Y3QgbHNkY19jcnRjICps
Y3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKwl1
MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcp
Ow0KKw0KKwkvKg0KKwkgKiBJZiBiaXQgMjQgb2YgTFNEQ19DUlRDMF9DRkdfUkVHIGlzIHNldCwg
aXQgc2F5IHRoYXQgdGhlIERDIGhhcmR3YXJlDQorCSAqIHN0b3Agd29ya2luZyBhbnltb3JlLCBh
bmNob3JlZC4gVGhpcyBtYXliZSBjYXVzZWQgYnkgaW1wcm9wZXINCisJICogb3BlcmF0aW9uIHNl
cXVlbmNlLCBtYXkgaGFwcGVucyBvbiBleHRyZW1lIHJhcmVseSBjYXNlLg0KKwkgKg0KKwkgKiBM
dWNraWx5LCBhIHNvZnQgcmVzZXQgaGVscHMgYnJpbmcgaXQgdG8gbm9ybWFsIG9uIHN1Y2ggYSBj
YXNlLg0KKwkgKiBTbyB3ZSBhZGQgYSB3YXJuIGhlcmUsIGhvcGUgdG8gY2F0Y2ggc29tZXRoaW5n
IGlmIGl0IGhhcHBlbnMuDQorCSAqLw0KKw0KKwlpZiAodmFsICYgQklUKDI0KSkgew0KKwkJZHJt
X3dhcm4oJmxkZXYtPmJhc2UsICIlcyBhbmNob3JlZFxuIiwgbGNydGMtPmJhc2UubmFtZSk7DQor
CQlyZXR1cm4gbHNkY19jcnRjMF9zb2Z0X3Jlc2V0KGxjcnRjKTsNCisJfQ0KKw0KKwlsc2RjX3dy
ZWczMihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIHZhbCB8IENGR19PVVRQVVRfRU5BQkxFKTsN
Cit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9kaXNhYmxlKHN0cnVjdCBsc2RjX2NydGMg
KmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQor
DQorCWxzZGNfdXJlZzMyX2NscihsZGV2LCBMU0RDX0NSVEMwX0NGR19SRUcsIENGR19PVVRQVVRf
RU5BQkxFKTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMx
X2VuYWJsZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2Rldmlj
ZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKwl1MzIgdmFsOw0KKw0KKwl2YWwgPSBsc2RjX3JyZWcz
MihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcpOw0KKwlpZiAodmFsICYgQklUKDI0KSkgew0KKwkJ
ZHJtX3dhcm4oJmxkZXYtPmJhc2UsICIlcyBhbmNob3JlZFxuIiwgbGNydGMtPmJhc2UubmFtZSk7
DQorCQlyZXR1cm4gbHNkY19jcnRjMV9zb2Z0X3Jlc2V0KGxjcnRjKTsNCisJfQ0KKw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHZhbCB8IENGR19PVVRQVVRfRU5BQkxF
KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9kaXNhYmxlKHN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7
DQorDQorCWxzZGNfdXJlZzMyX2NscihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIENGR19PVVRQ
VVRfRU5BQkxFKTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCisvKiBBbGwgbG9vbmdzb24gZGlz
cGxheSBjb250cm9sbGVyIHN1cHBvcnQgc2Nhbm91dCBwb3NpdGlvbiBoYXJkd2FyZSAqLw0KKw0K
K3N0YXRpYyB2b2lkIGxzZGNfY3J0YzBfc2Nhbl9wb3Moc3RydWN0IGxzZGNfY3J0YyAqbGNydGMs
IGludCAqaHBvcywgaW50ICp2cG9zKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
bGNydGMtPmxkZXY7DQorCXUzMiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExT
RENfQ1JUQzBfU0NBTl9QT1NfUkVHKTsNCisNCisJKmhwb3MgPSB2YWwgPj4gMTY7DQorCSp2cG9z
ID0gdmFsICYgMHhmZmZmOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMxX3NjYW5fcG9z
KHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjLCBpbnQgKmhwb3MsIGludCAqdnBvcykNCit7DQorCXN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKwl1MzIgdmFsOw0KKw0KKwl2
YWwgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX1NDQU5fUE9TX1JFRyk7DQorDQorCSpo
cG9zID0gdmFsID4+IDE2Ow0KKwkqdnBvcyA9IHZhbCAmIDB4ZmZmZjsNCit9DQorDQorc3RhdGlj
IHZvaWQgbHNkY19jcnRjMF9lbmFibGVfdmJsYW5rKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0K
K3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNf
dXJlZzMyX3NldChsZGV2LCBMU0RDX0lOVF9SRUcsIElOVF9DUlRDMF9WU1lOQ19FTik7DQorfQ0K
Kw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzBfZGlzYWJsZV92Ymxhbmsoc3RydWN0IGxzZGNfY3J0
YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsN
CisNCisJbHNkY191cmVnMzJfY2xyKGxkZXYsIExTRENfSU5UX1JFRywgSU5UX0NSVEMwX1ZTWU5D
X0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9lbmFibGVfdmJsYW5rKHN0cnVj
dCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNy
dGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0lOVF9SRUcsIElOVF9D
UlRDMV9WU1lOQ19FTik7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0YzFfZGlzYWJsZV92
Ymxhbmsoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2Ug
KmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfY2xyKGxkZXYsIExTRENfSU5U
X1JFRywgSU5UX0NSVEMxX1ZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRj
MF9mbGlwKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0NS
VEMwX0NGR19SRUcsIENGR19QQUdFX0ZMSVApOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2Ny
dGMxX2ZsaXAoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfc2V0KGxkZXYsIExTRENf
Q1JUQzFfQ0ZHX1JFRywgQ0ZHX1BBR0VfRkxJUCk7DQorfQ0KKw0KKy8qDQorICogQ1JUQzAgY2xv
bmUgZnJvbSBDUlRDMSBvciBDUlRDMSBjbG9uZSBmcm9tIENSVEMwIHVzaW5nIGhhcmR3YXJlIGxv
Z2ljLg0KKyAqIEhhcmR3YXJlIGVuZ2luZWVyIHNheSB0aGlzIHdvdWxkIGhlbHAgdG8gc2F2aW5n
IGJhbmR3aWR0aCBvbiBjbG9uZSBtb2RlLg0KKyAqDQorICogVGhpcyBtYXkgdXNlZnVsIG9uIGN1
c3RvbSBjbG9uZSBhcHBsaWNhdGlvbi4NCisgKi8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMw
X2Nsb25lKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNl
ICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCWxzZGNfdXJlZzMyX3NldChsZGV2LCBMU0RDX0NS
VEMwX0NGR19SRUcsIENGR19IV19DTE9ORSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3J0
YzFfY2xvbmUoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZp
Y2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY191cmVnMzJfc2V0KGxkZXYsIExTRENf
Q1JUQzFfQ0ZHX1JFRywgQ0ZHX0hXX0NMT05FKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19j
cnRjMF9zZXRfbW9kZShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJY29uc3Qgc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSBsY3J0Yy0+bGRldjsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9IRElTUExB
WV9SRUcsDQorCQkgICAgKG1vZGUtPmNydGNfaHRvdGFsIDw8IDE2KSB8IG1vZGUtPmNydGNfaGRp
c3BsYXkpOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1ZESVNQTEFZX1JFRywN
CisJCSAgICAobW9kZS0+Y3J0Y192dG90YWwgPDwgMTYpIHwgbW9kZS0+Y3J0Y192ZGlzcGxheSk7
DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfSFNZTkNfUkVHLA0KKwkJICAgICht
b2RlLT5jcnRjX2hzeW5jX2VuZCA8PCAxNikgfCBtb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IHwgSFNZ
TkNfRU4pOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX1ZTWU5DX1JFRywNCisJ
CSAgICAobW9kZS0+Y3J0Y192c3luY19lbmQgPDwgMTYpIHwgbW9kZS0+Y3J0Y192c3luY19zdGFy
dCB8IFZTWU5DX0VOKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9zZXRfbW9kZShz
dHJ1Y3QgbHNkY19jcnRjICpsY3J0YywNCisJCQkJY29uc3Qgc3RydWN0IGRybV9kaXNwbGF5X21v
ZGUgKm1vZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsN
CisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMV9IRElTUExBWV9SRUcsDQorCQkgICAg
KG1vZGUtPmNydGNfaHRvdGFsIDw8IDE2KSB8IG1vZGUtPmNydGNfaGRpc3BsYXkpOw0KKw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZESVNQTEFZX1JFRywNCisJCSAgICAobW9kZS0+
Y3J0Y192dG90YWwgPDwgMTYpIHwgbW9kZS0+Y3J0Y192ZGlzcGxheSk7DQorDQorCWxzZGNfd3Jl
ZzMyKGxkZXYsIExTRENfQ1JUQzFfSFNZTkNfUkVHLA0KKwkJICAgIChtb2RlLT5jcnRjX2hzeW5j
X2VuZCA8PCAxNikgfCBtb2RlLT5jcnRjX2hzeW5jX3N0YXJ0IHwgSFNZTkNfRU4pOw0KKw0KKwls
c2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZTWU5DX1JFRywNCisJCSAgICAobW9kZS0+Y3J0
Y192c3luY19lbmQgPDwgMTYpIHwgbW9kZS0+Y3J0Y192c3luY19zdGFydCB8IFZTWU5DX0VOKTsN
Cit9DQorDQorLyoNCisgKiBUaGlzIGlzIHJlcXVpcmVkIGZvciBTMyBzdXBwb3J0Lg0KKyAqDQor
ICogQWZ0ZXIgcmVzdW1lIGZyb20gc3VzcGVuZCwgTFNEQ19DUlRDeF9DRkdfUkVHICh4PTAgb3Ig
MSlpcyBmaWxsZWQgd2l0aA0KKyAqIGdhcmJhcmdlIHZhbHVlIHdoaWNoIG1heSBjYXVzZSB0aGUg
Q1JUQyBjb21wbGV0ZWx5IGhhbmcuIFRoaXMgZnVuY3Rpb24NCisgKiBnaXZlIGEgbWluaW1hbCBz
ZXR0aW5nIHRvIHRoZSBhZmZlY3RlZCByZWdpc3RlcnMuIFRoaXMgYWxzbyBvdmVycmlkZQ0KKyAq
IHRoZSBmaXJtd2FyZSdzIHNldHRpbmcgb24gc3RhcnR1cCwgZWxpbWluYXRlIHBvdGVudGlhbCBi
bGluZGluZyBzZXR0aW5nLg0KKyAqDQorICogTWFraW5nIHRoZSBDUlRDIHdvcmtzIG9uIG91ciBv
d24gbm93LCB0aGlzIGlzIHNpbWlsYXIgd2l0aCB0aGUgZnVuY3Rpb25hbA0KKyAqIG9mIEdQVSBQ
T1NUKFBvd2VyIE9uIFNlbGYgVGVzdCkuIE9ubHkgdG91Y2ggQ1JUQyBoYXJkd2FyZSByZWxhdGVk
IHBhcnQuDQorICovDQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMF9yZXNldChzdHJ1Y3QgbHNk
Y19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5s
ZGV2Ow0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmbGNydGMtPmJhc2U7DQorCXUzMiB2YWw7
DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRyk7DQorDQor
CS8qIFRoaXMgaGVscCB0byBzZWUgd2hhdCBpcyBpdCAqLw0KKwlkcm1fZGJnKCZsZGV2LT5iYXNl
LCAidmFsdWUgb2YgJXMgY29uZmlndXJlIHJlZ2lzdGVyOiAleFxuIiwNCisJCWNydGMtPm5hbWUs
IHZhbCk7DQorDQorCS8qDQorCSAqIEhlbHAgdGhlIENSVEMgZ2V0IG91dCBvZiBzb2Z0IHJlc2V0
IHNhdGUsIGFzIHRoZSBDUlRDIGlzIGNvbXBsZXRlbHkNCisJICogaGFsdCBvbiBzb2Z0IHJlc2V0
IG1vZGUgKEJJVCgyMCkgPSAwKS4gSXQgZG9lcyBub3QgZXZlbnQgZ2VuZXJhdGUNCisJICogdmJs
YW5rLCBjYXVzZSB2Ymxhbmsgd2FpdCB0aW1lb3V0LiBUaGlzIGhhcHBlbmRzIHdoZW4gcmVzdW1l
IGZyb20NCisJICogUzMuDQorCSAqDQorCSAqIEFsc28gZ2l2ZSBhIHNhbmUgZm9ybWF0LCBhZnRl
ciByZXN1bWUgZnJvbSBzdXNwZW5kIFMzLCB0aGlzDQorCSAqIHJlZ2lzdGVyIGlzIGZpbGxlZCB3
aXRoIGdhcmJhcmdlIHZhbHVlLiBBIG1lYW5pbmdsZXNzIHZhbHVlIG1heQ0KKwkgKiBhbHNvIGNh
dXNlIHRoZSBDUlRDIGhhbHQgb3IgY3Jhc2guDQorCSAqLw0KKw0KKwl2YWwgPSBDRkdfUkVTRVRf
TiB8IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBf
Q0ZHX1JFRywgdmFsKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjMV9yZXNldChzdHJ1
Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGxj
cnRjLT5sZGV2Ow0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSAmbGNydGMtPmJhc2U7DQorCXUz
MiB2YWw7DQorDQorCXZhbCA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRyk7
DQorDQorCWRybV9kYmcoJmxkZXYtPmJhc2UsICJ2YWx1ZSBvZiAlcyBjb25maWd1ZSByZWdpc3Rl
cjogJXhcbiIsDQorCQljcnRjLT5uYW1lLCB2YWwpOw0KKw0KKwkvKg0KKwkgKiBIZWxwIHRoZSBD
UlRDIGdldCBvdXQgb2Ygc29mdCByZXNldCBzYXRlLCBnaXZlIGEgc2FuZSBmb3JtYXQsDQorCSAq
IE90aGVyd2lzZSBpdCB3aWxsIGNvbXBsZXRlIGhhbHQgdGhlcmUuDQorCSAqLw0KKwl2YWwgPSBD
RkdfUkVTRVRfTiB8IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1JUQzFfQ0ZHX1JFRywgdmFsKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsc2Rj
X2NydGNfaHdfb3BzIGxzN2ExMDAwX2NydGNfaHdfb3BzWzJdID0gew0KKwl7DQorCQkuZW5hYmxl
ID0gbHNkY19jcnRjMF9lbmFibGUsDQorCQkuZGlzYWJsZSA9IGxzZGNfY3J0YzBfZGlzYWJsZSwN
CisJCS5lbmFibGVfdmJsYW5rID0gbHNkY19jcnRjMF9lbmFibGVfdmJsYW5rLA0KKwkJLmRpc2Fi
bGVfdmJsYW5rID0gbHNkY19jcnRjMF9kaXNhYmxlX3ZibGFuaywNCisJCS5mbGlwID0gbHNkY19j
cnRjMF9mbGlwLA0KKwkJLmNsb25lID0gbHNkY19jcnRjMF9jbG9uZSwNCisJCS5zZXRfbW9kZSA9
IGxzZGNfY3J0YzBfc2V0X21vZGUsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMF9zY2Fu
X3BvcywNCisJCS5zb2Z0X3Jlc2V0ID0gbHNkY19jcnRjMF9zb2Z0X3Jlc2V0LA0KKwkJLnJlc2V0
ID0gbHNkY19jcnRjMF9yZXNldCwNCisJfSwNCisJew0KKwkJLmVuYWJsZSA9IGxzZGNfY3J0YzFf
ZW5hYmxlLA0KKwkJLmRpc2FibGUgPSBsc2RjX2NydGMxX2Rpc2FibGUsDQorCQkuZW5hYmxlX3Zi
bGFuayA9IGxzZGNfY3J0YzFfZW5hYmxlX3ZibGFuaywNCisJCS5kaXNhYmxlX3ZibGFuayA9IGxz
ZGNfY3J0YzFfZGlzYWJsZV92YmxhbmssDQorCQkuZmxpcCA9IGxzZGNfY3J0YzFfZmxpcCwNCisJ
CS5jbG9uZSA9IGxzZGNfY3J0YzFfY2xvbmUsDQorCQkuc2V0X21vZGUgPSBsc2RjX2NydGMxX3Nl
dF9tb2RlLA0KKwkJLmdldF9zY2FuX3BvcyA9IGxzZGNfY3J0YzFfc2Nhbl9wb3MsDQorCQkuc29m
dF9yZXNldCA9IGxzZGNfY3J0YzFfc29mdF9yZXNldCwNCisJCS5yZXNldCA9IGxzZGNfY3J0YzFf
cmVzZXQsDQorCX0sDQorfTsNCisNCisvKg0KKyAqIFRoZSAzMi1iaXQgaGFyZHdhcmUgdmJsYW5r
IGNvdW50ZXIgaXMgYXZhaWxhYmxlIHNpbmNlIGxzN2EyMDAwL2xzMmsyMDAwLA0KKyAqIFRoZSBj
b3VudGVyIGdyb3cgdXAgZXZlbiB0aGUgQ1JUQyBpcyBiZWluZyBkaXNhYmxlZCwgaXQgd2lsbCBn
b3QgcmVzZXQNCisgKiBpZiB0aGUgY3J0YyBpcyBiZWluZyBzb2Z0IHJlc2V0Lg0KKyAqDQorICog
VGhvc2UgcmVnaXN0ZXJzIGFyZSBhbHNvIHJlYWRhYmxlIGZvciBsczdhMTAwMCwgYnV0IGl0cyB2
YWx1ZSBkb2VzIG5vdA0KKyAqIGNoYW5nZS4NCisgKi8NCisNCitzdGF0aWMgdTMyIGxzZGNfY3J0
YzBfZ2V0X3ZibGFua19jb3VudChzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YykNCit7DQorCXN0cnVj
dCBsc2RjX2RldmljZSAqbGRldiA9IGxjcnRjLT5sZGV2Ow0KKw0KKwlyZXR1cm4gbHNkY19ycmVn
MzIobGRldiwgTFNEQ19DUlRDMF9WU1lOQ19DT1VOVEVSX1JFRyk7DQorfQ0KKw0KK3N0YXRpYyB1
MzIgbHNkY19jcnRjMV9nZXRfdmJsYW5rX2NvdW50KHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKQ0K
K3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorDQorCXJldHVy
biBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMxX1ZTWU5DX0NPVU5URVJfUkVHKTsNCit9DQor
DQorLyoNCisgKiBUaGUgRE1BIHN0ZXAgYml0IGZpZWxkIGlzIGF2YWlsYWJsZSBzaW5jZSBsczdh
MjAwMC9sczJrMjAwMCwgZm9yIHN1cHBvcnQNCisgKiBvZGQgcmVzb2x1dGlvbnMuIEJ1dCBhIGxh
cmdlIERNQSBzdGVwIG1heSBzYXZlIGJhbmR3aWR0aC4gQmVoYXZpb3Igb2YNCisgKiB3cml0aW5n
IHRob2VzIGJpdHMgZmllbGQgb24gbHM3YTEwMDAvbHMyazEwMDAgaXMgdW5kZXJmaW5lZC4NCisg
Ki8NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGMwX3NldF9kbWFfc3RlcChzdHJ1Y3QgbHNkY19j
cnRjICpsY3J0YywNCisJCQkJICAgIGVudW0gbHNkY19kbWFfc3RlcHMgZG1hX3N0ZXApDQorew0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRldjsNCisJdTMyIHZhbCA9IGxz
ZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRyk7DQorDQorCXZhbCAmPSB+Q0ZHX0RN
QV9TVEVQX01BU0s7DQorCXZhbCB8PSBkbWFfc3RlcCA8PCBDRkdfRE1BX1NURVBfU0hJRlQ7DQor
DQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfQ0ZHX1JFRywgdmFsKTsNCit9DQorDQor
c3RhdGljIHZvaWQgbHNkY19jcnRjMV9zZXRfZG1hX3N0ZXAoc3RydWN0IGxzZGNfY3J0YyAqbGNy
dGMsDQorCQkJCSAgICBlbnVtIGxzZGNfZG1hX3N0ZXBzIGRtYV9zdGVwKQ0KK3sNCisJc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2ID0gbGNydGMtPmxkZXY7DQorCXUzMiB2YWwgPSBsc2RjX3JyZWcz
MihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcpOw0KKw0KKwl2YWwgJj0gfkNGR19ETUFfU1RFUF9N
QVNLOw0KKwl2YWwgfD0gZG1hX3N0ZXAgPDwgQ0ZHX0RNQV9TVEVQX1NISUZUOw0KKw0KKwlsc2Rj
X3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHZhbCk7DQorfQ0KKw0KK3N0YXRpYyBj
b25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyBsczdhMjAwMF9jcnRjX2h3X29wc1syXSA9IHsN
CisJew0KKwkJLmVuYWJsZSA9IGxzZGNfY3J0YzBfZW5hYmxlLA0KKwkJLmRpc2FibGUgPSBsc2Rj
X2NydGMwX2Rpc2FibGUsDQorCQkuZW5hYmxlX3ZibGFuayA9IGxzZGNfY3J0YzBfZW5hYmxlX3Zi
bGFuaywNCisJCS5kaXNhYmxlX3ZibGFuayA9IGxzZGNfY3J0YzBfZGlzYWJsZV92YmxhbmssDQor
CQkuZmxpcCA9IGxzZGNfY3J0YzBfZmxpcCwNCisJCS5jbG9uZSA9IGxzZGNfY3J0YzBfY2xvbmUs
DQorCQkuc2V0X21vZGUgPSBsc2RjX2NydGMwX3NldF9tb2RlLA0KKwkJLnNvZnRfcmVzZXQgPSBs
c2RjX2NydGMwX3NvZnRfcmVzZXQsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMF9zY2Fu
X3BvcywNCisJCS5zZXRfZG1hX3N0ZXAgPSBsc2RjX2NydGMwX3NldF9kbWFfc3RlcCwNCisJCS5n
ZXRfdmJsYW5rX2NvdW50ZXIgPSBsc2RjX2NydGMwX2dldF92YmxhbmtfY291bnQsDQorCQkucmVz
ZXQgPSBsc2RjX2NydGMwX3Jlc2V0LA0KKwl9LA0KKwl7DQorCQkuZW5hYmxlID0gbHNkY19jcnRj
MV9lbmFibGUsDQorCQkuZGlzYWJsZSA9IGxzZGNfY3J0YzFfZGlzYWJsZSwNCisJCS5lbmFibGVf
dmJsYW5rID0gbHNkY19jcnRjMV9lbmFibGVfdmJsYW5rLA0KKwkJLmRpc2FibGVfdmJsYW5rID0g
bHNkY19jcnRjMV9kaXNhYmxlX3ZibGFuaywNCisJCS5mbGlwID0gbHNkY19jcnRjMV9mbGlwLA0K
KwkJLmNsb25lID0gbHNkY19jcnRjMV9jbG9uZSwNCisJCS5zZXRfbW9kZSA9IGxzZGNfY3J0YzFf
c2V0X21vZGUsDQorCQkuZ2V0X3NjYW5fcG9zID0gbHNkY19jcnRjMV9zY2FuX3BvcywNCisJCS5z
b2Z0X3Jlc2V0ID0gbHNkY19jcnRjMV9zb2Z0X3Jlc2V0LA0KKwkJLnNldF9kbWFfc3RlcCA9IGxz
ZGNfY3J0YzFfc2V0X2RtYV9zdGVwLA0KKwkJLmdldF92YmxhbmtfY291bnRlciA9IGxzZGNfY3J0
YzFfZ2V0X3ZibGFua19jb3VudCwNCisJCS5yZXNldCA9IGxzZGNfY3J0YzFfcmVzZXQsDQorCX0s
DQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfcmVzZXQoc3RydWN0IGRybV9jcnRjICpj
cnRjKQ0KK3sNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7
DQorCWNvbnN0IHN0cnVjdCBsc2RjX2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+aHdfb3BzOw0K
KwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X2NydGNfc3RhdGU7DQorDQorCWlmIChjcnRj
LT5zdGF0ZSkNCisJCWNydGMtPmZ1bmNzLT5hdG9taWNfZGVzdHJveV9zdGF0ZShjcnRjLCBjcnRj
LT5zdGF0ZSk7DQorDQorCXByaXZfY3J0Y19zdGF0ZSA9IGt6YWxsb2Moc2l6ZW9mKCpwcml2X2Ny
dGNfc3RhdGUpLCBHRlBfS0VSTkVMKTsNCisNCisJaWYgKCFwcml2X2NydGNfc3RhdGUpDQorCQlf
X2RybV9hdG9taWNfaGVscGVyX2NydGNfcmVzZXQoY3J0YywgTlVMTCk7DQorCWVsc2UNCisJCV9f
ZHJtX2F0b21pY19oZWxwZXJfY3J0Y19yZXNldChjcnRjLCAmcHJpdl9jcnRjX3N0YXRlLT5iYXNl
KTsNCisNCisJLyoNCisJICogUmVzZXQgdGhlIGNydGMgaGFyZHdhcmUsIHRoaXMgaXMgbmVlZCBm
b3IgUzMgc3VwcG9ydCwNCisJICogb3RoZXJ3aXNlLCB3YWl0IGZvciB2YmxhbmsgdGltZW91dCBt
YXkgaGFwcGVuLg0KKwkgKi8NCisJb3BzLT5yZXNldChsY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyB2
b2lkIGxzZGNfY3J0Y19hdG9taWNfZGVzdHJveV9zdGF0ZShzdHJ1Y3QgZHJtX2NydGMgKmNydGMs
DQorCQkJCQkgICBzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxz
ZGNfY3J0Y19zdGF0ZSAqcHJpdl9zdGF0ZSA9IHRvX2xzZGNfY3J0Y19zdGF0ZShzdGF0ZSk7DQor
DQorCV9fZHJtX2F0b21pY19oZWxwZXJfY3J0Y19kZXN0cm95X3N0YXRlKCZwcml2X3N0YXRlLT5i
YXNlKTsNCisNCisJa2ZyZWUocHJpdl9zdGF0ZSk7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3QgZHJt
X2NydGNfc3RhdGUgKg0KK2xzZGNfY3J0Y19hdG9taWNfZHVwbGljYXRlX3N0YXRlKHN0cnVjdCBk
cm1fY3J0YyAqY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2NydGNfc3RhdGUgKm5ld19wcml2X3N0
YXRlOw0KKwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpvbGRfcHJpdl9zdGF0ZTsNCisNCisJbmV3
X3ByaXZfc3RhdGUgPSBremFsbG9jKHNpemVvZigqbmV3X3ByaXZfc3RhdGUpLCBHRlBfS0VSTkVM
KTsNCisJaWYgKCFuZXdfcHJpdl9zdGF0ZSkNCisJCXJldHVybiBOVUxMOw0KKw0KKwlfX2RybV9h
dG9taWNfaGVscGVyX2NydGNfZHVwbGljYXRlX3N0YXRlKGNydGMsICZuZXdfcHJpdl9zdGF0ZS0+
YmFzZSk7DQorDQorCW9sZF9wcml2X3N0YXRlID0gdG9fbHNkY19jcnRjX3N0YXRlKGNydGMtPnN0
YXRlKTsNCisNCisJbWVtY3B5KCZuZXdfcHJpdl9zdGF0ZS0+cHBhcm1zLCAmb2xkX3ByaXZfc3Rh
dGUtPnBwYXJtcywNCisJICAgICAgIHNpemVvZihuZXdfcHJpdl9zdGF0ZS0+cHBhcm1zKSk7DQor
DQorCXJldHVybiAmbmV3X3ByaXZfc3RhdGUtPmJhc2U7DQorfQ0KKw0KK3N0YXRpYyB1MzIgbHNk
Y19jcnRjX2dldF92YmxhbmtfY291bnRlcihzdHJ1Y3QgZHJtX2NydGMgKmNydGMpDQorew0KKwlz
dHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRvX2xzZGNfY3J0YyhjcnRjKTsNCisJY29uc3Qgc3Ry
dWN0IGxzZGNfY3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQorCXJldHVybiBv
cHMtPmdldF92YmxhbmtfY291bnRlcihsY3J0Yyk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19j
cnRjX2VuYWJsZV92Ymxhbmsoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJc3RydWN0IGxz
ZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2NydGMoY3J0Yyk7DQorCWNvbnN0IHN0cnVjdCBsc2Rj
X2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+aHdfb3BzOw0KKw0KKwlvcHMtPmVuYWJsZV92Ymxh
bmsobGNydGMpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRj
X2Rpc2FibGVfdmJsYW5rKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXN0cnVjdCBsc2Rj
X2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19j
cnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisNCisJb3BzLT5kaXNhYmxlX3ZibGFu
ayhsY3J0Yyk7DQorfQ0KKw0KKy8qDQorICogQ1JUQyByZWxhdGVkIGRlYnVnZnMNCisgKg0KKyAq
IFByaW1hcnkgcGxhbmVzIGFuZCBjdXJzb3IgcGxhbmVzIGFyZSBhbHNvIGJlbG9uZyB0byB0aGUg
Q1JUQyBmb3Igb3VyIGNhc2UsDQorICogc28gYWxzbyBhcHBlbmQgb3RoZXIgcmVnaXN0ZXJzIHRv
IGhlcmUsIGZvciBzYWtlIG9mIGNvbnZlbmllbnQuDQorICovDQorDQorI2RlZmluZSBSRUdfREVG
KHJlZykgeyBcDQorCS5uYW1lID0gX19zdHJpbmdpZnlfMShMU0RDXyMjcmVnIyNfUkVHKSwgXA0K
Kwkub2Zmc2V0ID0gTFNEQ18jI3JlZyMjX1JFRywgXA0KK30NCisNCitzdGF0aWMgY29uc3Qgc3Ry
dWN0IGxzZGNfcmVnMzIgbHNkY19jcnRjX3JlZ3NfYXJyYXlbMl1bMjFdID0gew0KKwlbMF0gPSB7
DQorCQlSRUdfREVGKENSVEMwX0NGRyksDQorCQlSRUdfREVGKENSVEMwX0ZCX09SSUdJTiksDQor
CQlSRUdfREVGKENSVEMwX1BBTkVMX0NPTkYpLA0KKwkJUkVHX0RFRihDUlRDMF9IRElTUExBWSks
DQorCQlSRUdfREVGKENSVEMwX0hTWU5DKSwNCisJCVJFR19ERUYoQ1JUQzBfVkRJU1BMQVkpLA0K
KwkJUkVHX0RFRihDUlRDMF9WU1lOQyksDQorCQlSRUdfREVGKENSVEMwX0dBTU1BX0lOREVYKSwN
CisJCVJFR19ERUYoQ1JUQzBfR0FNTUFfREFUQSksDQorCQlSRUdfREVGKENSVEMwX1NZTkNfREVW
SUFUSU9OKSwNCisJCVJFR19ERUYoQ1JUQzBfVlNZTkNfQ09VTlRFUiksDQorCQlSRUdfREVGKENS
VEMwX1NDQU5fUE9TKSwNCisJCVJFR19ERUYoQ1JUQzBfU1RSSURFKSwNCisJCVJFR19ERUYoQ1JU
QzBfRkIxX0FERFJfSEkpLA0KKwkJUkVHX0RFRihDUlRDMF9GQjFfQUREUl9MTyksDQorCQlSRUdf
REVGKENSVEMwX0ZCMF9BRERSX0hJKSwNCisJCVJFR19ERUYoQ1JUQzBfRkIwX0FERFJfTE8pLA0K
KwkJUkVHX0RFRihDVVJTT1IwX0NGRyksDQorCQlSRUdfREVGKENVUlNPUjBfUE9TSVRJT04pLA0K
KwkJUkVHX0RFRihDVVJTT1IwX0JHX0NPTE9SKSwNCisJCVJFR19ERUYoQ1VSU09SMF9GR19DT0xP
UiksDQorCX0sDQorCVsxXSA9IHsNCisJCVJFR19ERUYoQ1JUQzFfQ0ZHKSwNCisJCVJFR19ERUYo
Q1JUQzFfRkJfT1JJR0lOKSwNCisJCVJFR19ERUYoQ1JUQzFfUEFORUxfQ09ORiksDQorCQlSRUdf
REVGKENSVEMxX0hESVNQTEFZKSwNCisJCVJFR19ERUYoQ1JUQzFfSFNZTkMpLA0KKwkJUkVHX0RF
RihDUlRDMV9WRElTUExBWSksDQorCQlSRUdfREVGKENSVEMxX1ZTWU5DKSwNCisJCVJFR19ERUYo
Q1JUQzFfR0FNTUFfSU5ERVgpLA0KKwkJUkVHX0RFRihDUlRDMV9HQU1NQV9EQVRBKSwNCisJCVJF
R19ERUYoQ1JUQzFfU1lOQ19ERVZJQVRJT04pLA0KKwkJUkVHX0RFRihDUlRDMV9WU1lOQ19DT1VO
VEVSKSwNCisJCVJFR19ERUYoQ1JUQzFfU0NBTl9QT1MpLA0KKwkJUkVHX0RFRihDUlRDMV9TVFJJ
REUpLA0KKwkJUkVHX0RFRihDUlRDMV9GQjFfQUREUl9ISSksDQorCQlSRUdfREVGKENSVEMxX0ZC
MV9BRERSX0xPKSwNCisJCVJFR19ERUYoQ1JUQzFfRkIwX0FERFJfSEkpLA0KKwkJUkVHX0RFRihD
UlRDMV9GQjBfQUREUl9MTyksDQorCQlSRUdfREVGKENVUlNPUjFfQ0ZHKSwNCisJCVJFR19ERUYo
Q1VSU09SMV9QT1NJVElPTiksDQorCQlSRUdfREVGKENVUlNPUjFfQkdfQ09MT1IpLA0KKwkJUkVH
X0RFRihDVVJTT1IxX0ZHX0NPTE9SKSwNCisJfSwNCit9Ow0KKw0KK3N0YXRpYyBpbnQgbHNkY19j
cnRjX3Nob3dfcmVncyhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmFyZykNCit7DQorCXN0cnVj
dCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1faW5mb19ub2RlICopbS0+cHJpdmF0
ZTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSAoc3RydWN0IGxzZGNfY3J0YyAqKW5vZGUt
PmluZm9fZW50LT5kYXRhOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBsY3J0Yy0+bGRl
djsNCisJdW5zaWduZWQgaW50IGk7DQorDQorCWZvciAoaSA9IDA7IGkgPCBsY3J0Yy0+bnJlZzsg
aSsrKSB7DQorCQljb25zdCBzdHJ1Y3QgbHNkY19yZWczMiAqcHJlZyA9ICZsY3J0Yy0+cHJlZ1tp
XTsNCisJCXUzMiBvZmZzZXQgPSBwcmVnLT5vZmZzZXQ7DQorDQorCQlzZXFfcHJpbnRmKG0sICIl
cyAoMHglMDR4KTogMHglMDh4XG4iLA0KKwkJCSAgIHByZWctPm5hbWUsIG9mZnNldCwgbHNkY19y
cmVnMzIobGRldiwgb2Zmc2V0KSk7DQorCX0NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRp
YyBpbnQgbHNkY19jcnRjX3Nob3dfc2Nhbl9wb3NpdGlvbihzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZv
aWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1f
aW5mb19ub2RlICopbS0+cHJpdmF0ZTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSAoc3Ry
dWN0IGxzZGNfY3J0YyAqKW5vZGUtPmluZm9fZW50LT5kYXRhOw0KKwljb25zdCBzdHJ1Y3QgbHNk
Y19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisJaW50IHgsIHk7DQorDQorCW9w
cy0+Z2V0X3NjYW5fcG9zKGxjcnRjLCAmeCwgJnkpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICJzY2Fu
b3V0IHBvc2l0aW9uOiB4OiAlMDh1LCB5OiAlMDh1XG4iLCB4LCB5KTsNCisNCisJcmV0dXJuIDA7
DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX3Nob3dfdmJsYW5rX2NvdW50ZXIoc3RydWN0
IHNlcV9maWxlICptLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9k
ZSA9IChzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjID0gKHN0cnVjdCBsc2RjX2NydGMgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisJ
Y29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19vcHMgKm9wcyA9IGxjcnRjLT5od19vcHM7DQorDQor
CWlmIChvcHMtPmdldF92YmxhbmtfY291bnRlcikNCisJCXNlcV9wcmludGYobSwgIkNSVEMtMCB2
YmxhbmsgY291bnRlcjogJTA4dVxuXG4iLA0KKwkJCSAgIG9wcy0+Z2V0X3ZibGFua19jb3VudGVy
KGxjcnRjKSk7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfcGl4cGxs
X3Nob3dfY2xvY2soc3RydWN0IHNlcV9maWxlICptLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3Qg
ZHJtX2luZm9fbm9kZSAqbm9kZSA9IChzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqKW0tPnByaXZhdGU7
DQorCXN0cnVjdCBsc2RjX2NydGMgKmxjcnRjID0gKHN0cnVjdCBsc2RjX2NydGMgKilub2RlLT5p
bmZvX2VudC0+ZGF0YTsNCisJc3RydWN0IGxzZGNfcGl4cGxsICpwaXhwbGwgPSAmbGNydGMtPnBp
eHBsbDsNCisJY29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpmdW5jcyA9IHBpeHBsbC0+
ZnVuY3M7DQorCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9ICZsY3J0Yy0+YmFzZTsNCisJc3RydWN0
IGRybV9kaXNwbGF5X21vZGUgKm1vZGUgPSAmY3J0Yy0+c3RhdGUtPm1vZGU7DQorCXN0cnVjdCBk
cm1fcHJpbnRlciBwcmludGVyID0gZHJtX3NlcV9maWxlX3ByaW50ZXIobSk7DQorCXVuc2lnbmVk
IGludCBvdXRfa2h6Ow0KKw0KKwlvdXRfa2h6ID0gZnVuY3MtPmdldF9yYXRlKHBpeHBsbCk7DQor
DQorCXNlcV9wcmludGYobSwgIiVzOiAlZHglZEAlZFxuIiwgY3J0Yy0+bmFtZSwNCisJCSAgIG1v
ZGUtPmhkaXNwbGF5LCBtb2RlLT52ZGlzcGxheSwgZHJtX21vZGVfdnJlZnJlc2gobW9kZSkpOw0K
Kw0KKwlzZXFfcHJpbnRmKG0sICJQaXhlbCBjbG9jayByZXF1aXJlZDogJWQga0h6XG4iLCBtb2Rl
LT5jbG9jayk7DQorCXNlcV9wcmludGYobSwgIkFjdHVhbCBmcmVxdWVuY3kgb3V0cHV0OiAldSBr
SHpcbiIsIG91dF9raHopOw0KKwlzZXFfcHJpbnRmKG0sICJEaWZmOiAlZCBrSHpcbiIsIG91dF9r
aHogLSBtb2RlLT5jbG9jayk7DQorDQorCWZ1bmNzLT5wcmludChwaXhwbGwsICZwcmludGVyKTsN
CisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBzdHJ1Y3QgZHJtX2luZm9fbGlzdCBsc2Rj
X2NydGNfZGVidWdmc19saXN0WzJdWzRdID0gew0KKwlbMF0gPSB7DQorCQl7ICJyZWdzIiwgbHNk
Y19jcnRjX3Nob3dfcmVncywgMCwgTlVMTCB9LA0KKwkJeyAicGl4Y2xrIiwgbHNkY19waXhwbGxf
c2hvd19jbG9jaywgMCwgTlVMTCB9LA0KKwkJeyAic2NhbnBvcyIsIGxzZGNfY3J0Y19zaG93X3Nj
YW5fcG9zaXRpb24sIDAsIE5VTEwgfSwNCisJCXsgInZibGFua3MiLCBsc2RjX2NydGNfc2hvd192
YmxhbmtfY291bnRlciwgMCwgTlVMTCB9LA0KKwl9LA0KKwlbMV0gPSB7DQorCQl7ICJyZWdzIiwg
bHNkY19jcnRjX3Nob3dfcmVncywgMCwgTlVMTCB9LA0KKwkJeyAicGl4Y2xrIiwgbHNkY19waXhw
bGxfc2hvd19jbG9jaywgMCwgTlVMTCB9LA0KKwkJeyAic2NhbnBvcyIsIGxzZGNfY3J0Y19zaG93
X3NjYW5fcG9zaXRpb24sIDAsIE5VTEwgfSwNCisJCXsgInZibGFua3MiLCBsc2RjX2NydGNfc2hv
d192YmxhbmtfY291bnRlciwgMCwgTlVMTCB9LA0KKwl9LA0KK307DQorDQorLyogb3BlcmF0ZSBt
YW51YWxseSAqLw0KKw0KK3N0YXRpYyBpbnQgbHNkY19jcnRjX21hbl9vcF9zaG93KHN0cnVjdCBz
ZXFfZmlsZSAqbSwgdm9pZCAqZGF0YSkNCit7DQorCXNlcV9wdXRzKG0sICJzb2Z0X3Jlc2V0OiBz
b2Z0IHJlc2V0IHRoaXMgQ1JUQ1xuIik7DQorCXNlcV9wdXRzKG0sICJlbmFibGU6IGVuYWJsZSB0
aGlzIENSVENcbiIpOw0KKwlzZXFfcHV0cyhtLCAiZGlzYWJsZTogZGlzYWJsZSB0aGlzIENSVENc
biIpOw0KKwlzZXFfcHV0cyhtLCAiZmxpcDogdHJpZ2dlciB0aGUgcGFnZSBmbGlwXG4iKTsNCisJ
c2VxX3B1dHMobSwgImNsb25lOiBjbG9uZSB0aGUgYW5vdGhlciBjcnRjIHdpdGggaGFyZHdhcmUg
bG9naWNcbiIpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX2NydGNf
bWFuX29wX29wZW4oc3RydWN0IGlub2RlICppbm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpDQorew0K
KwlzdHJ1Y3QgZHJtX2NydGMgKmNydGMgPSBpbm9kZS0+aV9wcml2YXRlOw0KKw0KKwlyZXR1cm4g
c2luZ2xlX29wZW4oZmlsZSwgbHNkY19jcnRjX21hbl9vcF9zaG93LCBjcnRjKTsNCit9DQorDQor
c3RhdGljIHNzaXplX3QgbHNkY19jcnRjX21hbl9vcF93cml0ZShzdHJ1Y3QgZmlsZSAqZmlsZSwN
CisJCQkJICAgICAgY29uc3QgY2hhciBfX3VzZXIgKnVidWYsDQorCQkJCSAgICAgIHNpemVfdCBs
ZW4sDQorCQkJCSAgICAgIGxvZmZfdCAqb2ZmcCkNCit7DQorCXN0cnVjdCBzZXFfZmlsZSAqbSA9
IGZpbGUtPnByaXZhdGVfZGF0YTsNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSBtLT5wcml2
YXRlOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29w
czsNCisNCisJY2hhciBidWZbMTZdOw0KKw0KKwlpZiAobGVuID4gc2l6ZW9mKGJ1ZikgLSAxKQ0K
KwkJcmV0dXJuIC1FSU5WQUw7DQorDQorCWlmIChjb3B5X2Zyb21fdXNlcihidWYsIHVidWYsIGxl
bikpDQorCQlyZXR1cm4gLUVGQVVMVDsNCisNCisJYnVmW2xlbl0gPSAnXDAnOw0KKw0KKwlpZiAo
c3lzZnNfc3RyZXEoYnVmLCAic29mdF9yZXNldCIpKQ0KKwkJb3BzLT5zb2Z0X3Jlc2V0KGxjcnRj
KTsNCisJZWxzZSBpZiAoc3lzZnNfc3RyZXEoYnVmLCAiZW5hYmxlIikpDQorCQlvcHMtPmVuYWJs
ZShsY3J0Yyk7DQorCWVsc2UgaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgImRpc2FibGUiKSkNCisJCW9w
cy0+ZGlzYWJsZShsY3J0Yyk7DQorCWVsc2UgaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgImZsaXAiKSkN
CisJCW9wcy0+ZmxpcChsY3J0Yyk7DQorCWVsc2UgaWYgKHN5c2ZzX3N0cmVxKGJ1ZiwgImNsb25l
IikpDQorCQlvcHMtPmNsb25lKGxjcnRjKTsNCisNCisJcmV0dXJuIGxlbjsNCit9DQorDQorc3Rh
dGljIGNvbnN0IHN0cnVjdCBmaWxlX29wZXJhdGlvbnMgbHNkY19jcnRjX21hbl9vcF9mb3BzID0g
ew0KKwkub3duZXIgPSBUSElTX01PRFVMRSwNCisJLm9wZW4gPSBsc2RjX2NydGNfbWFuX29wX29w
ZW4sDQorCS5yZWFkID0gc2VxX3JlYWQsDQorCS5sbHNlZWsgPSBzZXFfbHNlZWssDQorCS5yZWxl
YXNlID0gc2luZ2xlX3JlbGVhc2UsDQorCS53cml0ZSA9IGxzZGNfY3J0Y19tYW5fb3Bfd3JpdGUs
DQorfTsNCisNCitzdGF0aWMgaW50IGxzZGNfY3J0Y19sYXRlX3JlZ2lzdGVyKHN0cnVjdCBkcm1f
Y3J0YyAqY3J0YykNCit7DQorCXN0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZSAqZGlzcGlwZSA9IGNy
dGNfdG9fZGlzcGxheV9waXBlKGNydGMpOw0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRv
X2xzZGNfY3J0YyhjcnRjKTsNCisJc3RydWN0IGRybV9taW5vciAqbWlub3IgPSBjcnRjLT5kZXYt
PnByaW1hcnk7DQorCXVuc2lnbmVkIGludCBpbmRleCA9IGRpc3BpcGUtPmluZGV4Ow0KKwl1bnNp
Z25lZCBpbnQgaTsNCisNCisJbGNydGMtPnByZWcgPSBsc2RjX2NydGNfcmVnc19hcnJheVtpbmRl
eF07DQorCWxjcnRjLT5ucmVnID0gQVJSQVlfU0laRShsc2RjX2NydGNfcmVnc19hcnJheVtpbmRl
eF0pOw0KKwlsY3J0Yy0+cF9pbmZvX2xpc3QgPSBsc2RjX2NydGNfZGVidWdmc19saXN0W2luZGV4
XTsNCisJbGNydGMtPm5faW5mb19saXN0ID0gQVJSQVlfU0laRShsc2RjX2NydGNfZGVidWdmc19s
aXN0W2luZGV4XSk7DQorDQorCWZvciAoaSA9IDA7IGkgPCBsY3J0Yy0+bl9pbmZvX2xpc3Q7ICsr
aSkNCisJCWxjcnRjLT5wX2luZm9fbGlzdFtpXS5kYXRhID0gbGNydGM7DQorDQorCWRybV9kZWJ1
Z2ZzX2NyZWF0ZV9maWxlcyhsY3J0Yy0+cF9pbmZvX2xpc3QsDQorCQkJCSBsY3J0Yy0+bl9pbmZv
X2xpc3QsDQorCQkJCSBjcnRjLT5kZWJ1Z2ZzX2VudHJ5LA0KKwkJCQkgbWlub3IpOw0KKw0KKwkv
KiBzdXBwb3J0ZWQgbWFudWFsIG9wZXJhdGlvbnMgKi8NCisJZGVidWdmc19jcmVhdGVfZmlsZSgi
b3BzIiwgMDY0NCwgY3J0Yy0+ZGVidWdmc19lbnRyeSwgbGNydGMsDQorCQkJICAgICZsc2RjX2Ny
dGNfbWFuX29wX2ZvcHMpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNk
Y19jcnRjX2F0b21pY19wcmludF9zdGF0ZShzdHJ1Y3QgZHJtX3ByaW50ZXIgKnAsDQorCQkJCQkg
Y29uc3Qgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkNCit7DQorCWNvbnN0IHN0cnVjdCBs
c2RjX2NydGNfc3RhdGUgKnByaXZfc3RhdGU7DQorCWNvbnN0IHN0cnVjdCBsc2RjX3BpeHBsbF9w
YXJtcyAqcHBhcm1zOw0KKw0KKwlwcml2X3N0YXRlID0gY29udGFpbmVyX29mX2NvbnN0KHN0YXRl
LCBzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlLCBiYXNlKTsNCisJcHBhcm1zID0gJnByaXZfc3RhdGUt
PnBwYXJtczsNCisNCisJZHJtX3ByaW50ZihwLCAiXHRJbnB1dCBjbG9jayBkaXZpZGVyID0gJXVc
biIsIHBwYXJtcy0+ZGl2X3JlZik7DQorCWRybV9wcmludGYocCwgIlx0TWVkaXVtIGNsb2NrIE11
bHRpcGxpZXIgPSAldVxuIiwgcHBhcm1zLT5sb29wYyk7DQorCWRybV9wcmludGYocCwgIlx0T3V0
cHV0IGNsb2NrIGRpdmlkZXIgPSAldVxuIiwgcHBhcm1zLT5kaXZfb3V0KTsNCit9DQorDQorc3Rh
dGljIGNvbnN0IHN0cnVjdCBkcm1fY3J0Y19mdW5jcyBsczdhMTAwMF9jcnRjX2Z1bmNzID0gew0K
KwkucmVzZXQgPSBsc2RjX2NydGNfcmVzZXQsDQorCS5kZXN0cm95ID0gZHJtX2NydGNfY2xlYW51
cCwNCisJLnNldF9jb25maWcgPSBkcm1fYXRvbWljX2hlbHBlcl9zZXRfY29uZmlnLA0KKwkucGFn
ZV9mbGlwID0gZHJtX2F0b21pY19oZWxwZXJfcGFnZV9mbGlwLA0KKwkuYXRvbWljX2R1cGxpY2F0
ZV9zdGF0ZSA9IGxzZGNfY3J0Y19hdG9taWNfZHVwbGljYXRlX3N0YXRlLA0KKwkuYXRvbWljX2Rl
c3Ryb3lfc3RhdGUgPSBsc2RjX2NydGNfYXRvbWljX2Rlc3Ryb3lfc3RhdGUsDQorCS5sYXRlX3Jl
Z2lzdGVyID0gbHNkY19jcnRjX2xhdGVfcmVnaXN0ZXIsDQorCS5lbmFibGVfdmJsYW5rID0gbHNk
Y19jcnRjX2VuYWJsZV92YmxhbmssDQorCS5kaXNhYmxlX3ZibGFuayA9IGxzZGNfY3J0Y19kaXNh
YmxlX3ZibGFuaywNCisJLmdldF92YmxhbmtfdGltZXN0YW1wID0gZHJtX2NydGNfdmJsYW5rX2hl
bHBlcl9nZXRfdmJsYW5rX3RpbWVzdGFtcCwNCisJLmF0b21pY19wcmludF9zdGF0ZSA9IGxzZGNf
Y3J0Y19hdG9taWNfcHJpbnRfc3RhdGUsDQorfTsNCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRy
bV9jcnRjX2Z1bmNzIGxzN2EyMDAwX2NydGNfZnVuY3MgPSB7DQorCS5yZXNldCA9IGxzZGNfY3J0
Y19yZXNldCwNCisJLmRlc3Ryb3kgPSBkcm1fY3J0Y19jbGVhbnVwLA0KKwkuc2V0X2NvbmZpZyA9
IGRybV9hdG9taWNfaGVscGVyX3NldF9jb25maWcsDQorCS5wYWdlX2ZsaXAgPSBkcm1fYXRvbWlj
X2hlbHBlcl9wYWdlX2ZsaXAsDQorCS5hdG9taWNfZHVwbGljYXRlX3N0YXRlID0gbHNkY19jcnRj
X2F0b21pY19kdXBsaWNhdGVfc3RhdGUsDQorCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGxzZGNf
Y3J0Y19hdG9taWNfZGVzdHJveV9zdGF0ZSwNCisJLmxhdGVfcmVnaXN0ZXIgPSBsc2RjX2NydGNf
bGF0ZV9yZWdpc3RlciwNCisJLmdldF92YmxhbmtfY291bnRlciA9IGxzZGNfY3J0Y19nZXRfdmJs
YW5rX2NvdW50ZXIsDQorCS5lbmFibGVfdmJsYW5rID0gbHNkY19jcnRjX2VuYWJsZV92Ymxhbmss
DQorCS5kaXNhYmxlX3ZibGFuayA9IGxzZGNfY3J0Y19kaXNhYmxlX3ZibGFuaywNCisJLmdldF92
YmxhbmtfdGltZXN0YW1wID0gZHJtX2NydGNfdmJsYW5rX2hlbHBlcl9nZXRfdmJsYW5rX3RpbWVz
dGFtcCwNCisJLmF0b21pY19wcmludF9zdGF0ZSA9IGxzZGNfY3J0Y19hdG9taWNfcHJpbnRfc3Rh
dGUsDQorfTsNCisNCitzdGF0aWMgZW51bSBkcm1fbW9kZV9zdGF0dXMNCitsc2RjX2NydGNfbW9k
ZV92YWxpZChzdHJ1Y3QgZHJtX2NydGMgKmNydGMsIGNvbnN0IHN0cnVjdCBkcm1fZGlzcGxheV9t
b2RlICptb2RlKQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBjcnRjLT5kZXY7DQor
CXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCWNvbnN0IHN0cnVj
dCBsc2RjX2Rlc2MgKmRlc2NwID0gbGRldi0+ZGVzY3A7DQorCXVuc2lnbmVkIGludCBwaXRjaDsN
CisNCisJaWYgKG1vZGUtPmhkaXNwbGF5ID4gZGVzY3AtPm1heF93aWR0aCkNCisJCXJldHVybiBN
T0RFX0JBRF9IVkFMVUU7DQorDQorCWlmIChtb2RlLT52ZGlzcGxheSA+IGRlc2NwLT5tYXhfaGVp
Z2h0KQ0KKwkJcmV0dXJuIE1PREVfQkFEX1ZWQUxVRTsNCisNCisJaWYgKG1vZGUtPmNsb2NrID4g
ZGVzY3AtPm1heF9waXhlbF9jbGspIHsNCisJCWRybV9kYmdfa21zKGRkZXYsICJtb2RlICVkeCVk
LCBwaXhlbCBjbG9jaz0lZCBpcyB0b28gaGlnaFxuIiwNCisJCQkgICAgbW9kZS0+aGRpc3BsYXks
IG1vZGUtPnZkaXNwbGF5LCBtb2RlLT5jbG9jayk7DQorCQlyZXR1cm4gTU9ERV9DTE9DS19ISUdI
Ow0KKwl9DQorDQorCS8qIDQgZm9yIERSTV9GT1JNQVRfWFJHQjg4ODggKi8NCisJcGl0Y2ggPSBt
b2RlLT5oZGlzcGxheSAqIDQ7DQorDQorCWlmIChwaXRjaCAlIGRlc2NwLT5waXRjaF9hbGlnbikg
ew0KKwkJZHJtX2RiZ19rbXMoZGRldiwgImFsaWduZWQgdG8gJXUgYnl0ZXMgaXMgcmVxdWlyZWQ6
ICV1XG4iLA0KKwkJCSAgICBkZXNjcC0+cGl0Y2hfYWxpZ24sIHBpdGNoKTsNCisJCXJldHVybiBN
T0RFX0JBRF9XSURUSDsNCisJfQ0KKw0KKwlyZXR1cm4gTU9ERV9PSzsNCit9DQorDQorc3RhdGlj
IGludCBsc2RjX3BpeHBsbF9hdG9taWNfY2hlY2soc3RydWN0IGRybV9jcnRjICpjcnRjLA0KKwkJ
CQkgICAgc3RydWN0IGRybV9jcnRjX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX2Ny
dGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwlzdHJ1Y3QgbHNkY19waXhwbGwgKnBp
eHBsbCA9ICZsY3J0Yy0+cGl4cGxsOw0KKwljb25zdCBzdHJ1Y3QgbHNkY19waXhwbGxfZnVuY3Mg
KnBmdW5jcyA9IHBpeHBsbC0+ZnVuY3M7DQorCXN0cnVjdCBsc2RjX2NydGNfc3RhdGUgKnByaXZf
c3RhdGUgPSB0b19sc2RjX2NydGNfc3RhdGUoc3RhdGUpOw0KKwl1bnNpZ25lZCBpbnQgY2xvY2sg
PSBzdGF0ZS0+bW9kZS5jbG9jazsNCisJaW50IHJldDsNCisNCisJcmV0ID0gcGZ1bmNzLT5jb21w
dXRlKHBpeHBsbCwgY2xvY2ssICZwcml2X3N0YXRlLT5wcGFybXMpOw0KKwlpZiAocmV0KSB7DQor
CQlkcm1fd2FybihjcnRjLT5kZXYsICJmaW5kIFBMTCBwYXJtcyBmb3IgJXVrSHogZmFpbGVkXG4i
LCBjbG9jayk7DQorCQlyZXR1cm4gLUVJTlZBTDsNCisJfQ0KKw0KKwlyZXR1cm4gMDsNCit9DQor
DQorc3RhdGljIGludCBsc2RjX2NydGNfaGVscGVyX2F0b21pY19jaGVjayhzdHJ1Y3QgZHJtX2Ny
dGMgKmNydGMsDQorCQkJCQkgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJ
c3RydWN0IGRybV9jcnRjX3N0YXRlICpjcnRjX3N0YXRlID0gZHJtX2F0b21pY19nZXRfbmV3X2Ny
dGNfc3RhdGUoc3RhdGUsIGNydGMpOw0KKw0KKwlpZiAoIWNydGNfc3RhdGUtPmVuYWJsZSkNCisJ
CXJldHVybiAwOw0KKw0KKwlyZXR1cm4gbHNkY19waXhwbGxfYXRvbWljX2NoZWNrKGNydGMsIGNy
dGNfc3RhdGUpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfbW9kZV9zZXRfbm9mYihz
dHJ1Y3QgZHJtX2NydGMgKmNydGMpDQorew0KKwlzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YyA9IHRv
X2xzZGNfY3J0YyhjcnRjKTsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3J0Y19od19vcHMgKmNydGNf
aHdfb3BzID0gbGNydGMtPmh3X29wczsNCisJc3RydWN0IGxzZGNfcGl4cGxsICpwaXhwbGwgPSAm
bGNydGMtPnBpeHBsbDsNCisJY29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpwaXhwbGxf
ZnVuY3MgPSBwaXhwbGwtPmZ1bmNzOw0KKwlzdHJ1Y3QgZHJtX2NydGNfc3RhdGUgKnN0YXRlID0g
Y3J0Yy0+c3RhdGU7DQorCXN0cnVjdCBkcm1fZGlzcGxheV9tb2RlICptb2RlID0gJnN0YXRlLT5t
b2RlOw0KKwlzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlICpwcml2X3N0YXRlID0gdG9fbHNkY19jcnRj
X3N0YXRlKHN0YXRlKTsNCisNCisJcGl4cGxsX2Z1bmNzLT51cGRhdGUocGl4cGxsLCAmcHJpdl9z
dGF0ZS0+cHBhcm1zKTsNCisNCisJaWYgKGNydGNfaHdfb3BzLT5zZXRfZG1hX3N0ZXApIHsNCisJ
CXVuc2lnbmVkIGludCB3aWR0aF9pbl9ieXRlcyA9IG1vZGUtPmhkaXNwbGF5ICogNDsNCisJCWVu
dW0gbHNkY19kbWFfc3RlcHMgZG1hX3N0ZXA7DQorDQorCQkvKg0KKwkJICogVXNpbmcgbGFyZ2Ug
ZG1hIHN0ZXAgYXMgbXVjaCBhcyBwb3NzaWJsZSwgZm9yIGltcHJvdmluZw0KKwkJICogaGFyZHdh
cmUgRE1BIGVmZmljaWVuY3kuDQorCQkgKi8NCisJCWlmICh3aWR0aF9pbl9ieXRlcyAlIDI1NiA9
PSAwKQ0KKwkJCWRtYV9zdGVwID0gTFNEQ19ETUFfU1RFUF8yNTZfQllURVM7DQorCQllbHNlIGlm
ICh3aWR0aF9pbl9ieXRlcyAlIDEyOCA9PSAwKQ0KKwkJCWRtYV9zdGVwID0gTFNEQ19ETUFfU1RF
UF8xMjhfQllURVM7DQorCQllbHNlIGlmICh3aWR0aF9pbl9ieXRlcyAlIDY0ID09IDApDQorCQkJ
ZG1hX3N0ZXAgPSBMU0RDX0RNQV9TVEVQXzY0X0JZVEVTOw0KKwkJZWxzZSAgLyogd2lkdGhfaW5f
Ynl0ZXMgJSAzMiA9PSAwICovDQorCQkJZG1hX3N0ZXAgPSBMU0RDX0RNQV9TVEVQXzMyX0JZVEVT
Ow0KKw0KKwkJY3J0Y19od19vcHMtPnNldF9kbWFfc3RlcChsY3J0YywgZG1hX3N0ZXApOw0KKwl9
DQorDQorCWNydGNfaHdfb3BzLT5zZXRfbW9kZShsY3J0YywgbW9kZSk7DQorfQ0KKw0KK3N0YXRp
YyB2b2lkIGxzZGNfY3J0Y19zZW5kX3ZibGFuayhzdHJ1Y3QgZHJtX2NydGMgKmNydGMpDQorew0K
KwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IGNydGMtPmRldjsNCisJdW5zaWduZWQgbG9uZyBm
bGFnczsNCisNCisJaWYgKCFjcnRjLT5zdGF0ZSB8fCAhY3J0Yy0+c3RhdGUtPmV2ZW50KQ0KKwkJ
cmV0dXJuOw0KKw0KKwlkcm1fZGJnKGRkZXYsICJzZW5kIHZibGFuayBtYW51YWxseVxuIik7DQor
DQorCXNwaW5fbG9ja19pcnFzYXZlKCZkZGV2LT5ldmVudF9sb2NrLCBmbGFncyk7DQorCWRybV9j
cnRjX3NlbmRfdmJsYW5rX2V2ZW50KGNydGMsIGNydGMtPnN0YXRlLT5ldmVudCk7DQorCWNydGMt
PnN0YXRlLT5ldmVudCA9IE5VTEw7DQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmRkZXYtPmV2
ZW50X2xvY2ssIGZsYWdzKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jcnRjX2F0b21pY19l
bmFibGUoc3RydWN0IGRybV9jcnRjICpjcnRjLA0KKwkJCQkgICAgc3RydWN0IGRybV9hdG9taWNf
c3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19sc2RjX2Ny
dGMoY3J0Yyk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2NydGNfaHdfb3BzICpvcHMgPSBsY3J0Yy0+
aHdfb3BzOw0KKw0KKwlkcm1fY3J0Y192Ymxhbmtfb24oY3J0Yyk7DQorDQorCWRybV9kYmcoY3J0
Yy0+ZGV2LCAiJXMgZW5hYmxlXG4iLCBjcnRjLT5uYW1lKTsNCisNCisJb3BzLT5lbmFibGUobGNy
dGMpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2NydGNfYXRvbWljX2Rpc2FibGUoc3RydWN0
IGRybV9jcnRjICpjcnRjLA0KKwkJCQkgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0
ZSkNCit7DQorCXN0cnVjdCBsc2RjX2NydGMgKmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0K
Kwljb25zdCBzdHJ1Y3QgbHNkY19jcnRjX2h3X29wcyAqb3BzID0gbGNydGMtPmh3X29wczsNCisN
CisJZHJtX2NydGNfdmJsYW5rX29mZihjcnRjKTsNCisNCisJb3BzLT5kaXNhYmxlKGxjcnRjKTsN
CisNCisJZHJtX2RiZyhjcnRjLT5kZXYsICIlcyBkaXNhYmxlXG4iLCBjcnRjLT5uYW1lKTsNCisN
CisJLyoNCisJICogTWFrZSBzdXJlIHdlIGlzc3VlIGEgdmJsYW5rIGV2ZW50IGFmdGVyIGRpc2Fi
bGluZyB0aGUgQ1JUQyBpZg0KKwkgKiBzb21lb25lIHdhcyB3YWl0aW5nIGl0Lg0KKwkgKi8NCisJ
bHNkY19jcnRjX3NlbmRfdmJsYW5rKGNydGMpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2Ny
dGNfYXRvbWljX2ZsdXNoKHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkJICAgc3RydWN0IGRy
bV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3Bpbl9sb2NrX2lycSgmY3J0Yy0+ZGV2LT5l
dmVudF9sb2NrKTsNCisJaWYgKGNydGMtPnN0YXRlLT5ldmVudCkgew0KKwkJaWYgKGRybV9jcnRj
X3ZibGFua19nZXQoY3J0YykgPT0gMCkNCisJCQlkcm1fY3J0Y19hcm1fdmJsYW5rX2V2ZW50KGNy
dGMsIGNydGMtPnN0YXRlLT5ldmVudCk7DQorCQllbHNlDQorCQkJZHJtX2NydGNfc2VuZF92Ymxh
bmtfZXZlbnQoY3J0YywgY3J0Yy0+c3RhdGUtPmV2ZW50KTsNCisJCWNydGMtPnN0YXRlLT5ldmVu
dCA9IE5VTEw7DQorCX0NCisJc3Bpbl91bmxvY2tfaXJxKCZjcnRjLT5kZXYtPmV2ZW50X2xvY2sp
Ow0KK30NCisNCitzdGF0aWMgYm9vbCBsc2RjX2NydGNfZ2V0X3NjYW5vdXRfcG9zaXRpb24oc3Ry
dWN0IGRybV9jcnRjICpjcnRjLA0KKwkJCQkJICAgYm9vbCBpbl92YmxhbmtfaXJxLA0KKwkJCQkJ
ICAgaW50ICp2cG9zLA0KKwkJCQkJICAgaW50ICpocG9zLA0KKwkJCQkJICAga3RpbWVfdCAqc3Rp
bWUsDQorCQkJCQkgICBrdGltZV90ICpldGltZSwNCisJCQkJCSAgIGNvbnN0IHN0cnVjdCBkcm1f
ZGlzcGxheV9tb2RlICptb2RlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19s
c2RjX2NydGMoY3J0Yyk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2NydGNfaHdfb3BzICpvcHMgPSBs
Y3J0Yy0+aHdfb3BzOw0KKwlpbnQgdnN3LCB2YnAsIHZhY3RpdmVfc3RhcnQsIHZhY3RpdmVfZW5k
LCB2ZnBfZW5kOw0KKwlpbnQgeCwgeTsNCisNCisJdnN3ID0gbW9kZS0+Y3J0Y192c3luY19lbmQg
LSBtb2RlLT5jcnRjX3ZzeW5jX3N0YXJ0Ow0KKwl2YnAgPSBtb2RlLT5jcnRjX3Z0b3RhbCAtIG1v
ZGUtPmNydGNfdnN5bmNfZW5kOw0KKw0KKwl2YWN0aXZlX3N0YXJ0ID0gdnN3ICsgdmJwICsgMTsN
CisJdmFjdGl2ZV9lbmQgPSB2YWN0aXZlX3N0YXJ0ICsgbW9kZS0+Y3J0Y192ZGlzcGxheTsNCisN
CisJLyogbGFzdCBzY2FuIGxpbmUgYmVmb3JlIFZTWU5DICovDQorCXZmcF9lbmQgPSBtb2RlLT5j
cnRjX3Z0b3RhbDsNCisNCisJaWYgKHN0aW1lKQ0KKwkJKnN0aW1lID0ga3RpbWVfZ2V0KCk7DQor
DQorCW9wcy0+Z2V0X3NjYW5fcG9zKGxjcnRjLCAmeCwgJnkpOw0KKw0KKwlpZiAoeSA+IHZhY3Rp
dmVfZW5kKQ0KKwkJeSA9IHkgLSB2ZnBfZW5kIC0gdmFjdGl2ZV9zdGFydDsNCisJZWxzZQ0KKwkJ
eSAtPSB2YWN0aXZlX3N0YXJ0Ow0KKw0KKwkqdnBvcyA9IHk7DQorCSpocG9zID0geDsNCisNCisJ
aWYgKGV0aW1lKQ0KKwkJKmV0aW1lID0ga3RpbWVfZ2V0KCk7DQorDQorCXJldHVybiB0cnVlOw0K
K30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9jcnRjX2hlbHBlcl9mdW5jcyBsc2RjX2Ny
dGNfaGVscGVyX2Z1bmNzID0gew0KKwkubW9kZV92YWxpZCA9IGxzZGNfY3J0Y19tb2RlX3ZhbGlk
LA0KKwkubW9kZV9zZXRfbm9mYiA9IGxzZGNfY3J0Y19tb2RlX3NldF9ub2ZiLA0KKwkuYXRvbWlj
X2VuYWJsZSA9IGxzZGNfY3J0Y19hdG9taWNfZW5hYmxlLA0KKwkuYXRvbWljX2Rpc2FibGUgPSBs
c2RjX2NydGNfYXRvbWljX2Rpc2FibGUsDQorCS5hdG9taWNfY2hlY2sgPSBsc2RjX2NydGNfaGVs
cGVyX2F0b21pY19jaGVjaywNCisJLmF0b21pY19mbHVzaCA9IGxzZGNfY3J0Y19hdG9taWNfZmx1
c2gsDQorCS5nZXRfc2Nhbm91dF9wb3NpdGlvbiA9IGxzZGNfY3J0Y19nZXRfc2Nhbm91dF9wb3Np
dGlvbiwNCit9Ow0KKw0KK2ludCBsczdhMTAwMF9jcnRjX2luaXQoc3RydWN0IGRybV9kZXZpY2Ug
KmRkZXYsDQorCQkgICAgICAgc3RydWN0IGRybV9jcnRjICpjcnRjLA0KKwkJICAgICAgIHN0cnVj
dCBkcm1fcGxhbmUgKnByaW1hcnksDQorCQkgICAgICAgc3RydWN0IGRybV9wbGFuZSAqY3Vyc29y
LA0KKwkJICAgICAgIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBsc2RjX2NydGMg
KmxjcnRjID0gdG9fbHNkY19jcnRjKGNydGMpOw0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBsc2Rj
X3BpeHBsbF9pbml0KCZsY3J0Yy0+cGl4cGxsLCBkZGV2LCBpbmRleCk7DQorCWlmIChyZXQpIHsN
CisJCWRybV9lcnIoZGRldiwgImNydGMgaW5pdCB3aXRoIHBsbCBmYWlsZWQ6ICVkXG4iLCByZXQp
Ow0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlsY3J0Yy0+bGRldiA9IHRvX2xzZGMoZGRldik7
DQorCWxjcnRjLT5od19vcHMgPSAmbHM3YTEwMDBfY3J0Y19od19vcHNbaW5kZXhdOw0KKw0KKwly
ZXQgPSBkcm1fY3J0Y19pbml0X3dpdGhfcGxhbmVzKGRkZXYsDQorCQkJCQljcnRjLA0KKwkJCQkJ
cHJpbWFyeSwNCisJCQkJCWN1cnNvciwNCisJCQkJCSZsczdhMTAwMF9jcnRjX2Z1bmNzLA0KKwkJ
CQkJIkNSVEMtJWQiLA0KKwkJCQkJaW5kZXgpOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKGRk
ZXYsICJjcnRjIGluaXQgd2l0aCBwbGFuZXMgZmFpbGVkOiAlZFxuIiwgcmV0KTsNCisJCXJldHVy
biByZXQ7DQorCX0NCisNCisJZHJtX2NydGNfaGVscGVyX2FkZChjcnRjLCAmbHNkY19jcnRjX2hl
bHBlcl9mdW5jcyk7DQorDQorCXJldCA9IGRybV9tb2RlX2NydGNfc2V0X2dhbW1hX3NpemUoY3J0
YywgMjU2KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWRybV9jcnRjX2VuYWJs
ZV9jb2xvcl9tZ210KGNydGMsIDAsIGZhbHNlLCAyNTYpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQor
DQoraW50IGxzN2EyMDAwX2NydGNfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCSAg
ICAgICBzdHJ1Y3QgZHJtX2NydGMgKmNydGMsDQorCQkgICAgICAgc3RydWN0IGRybV9wbGFuZSAq
cHJpbWFyeSwNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpjdXJzb3IsDQorCQkgICAgICAg
dW5zaWduZWQgaW50IGluZGV4KQ0KK3sNCisJc3RydWN0IGxzZGNfY3J0YyAqbGNydGMgPSB0b19s
c2RjX2NydGMoY3J0Yyk7DQorCWludCByZXQ7DQorDQorCXJldCA9IGxzZGNfcGl4cGxsX2luaXQo
JmxjcnRjLT5waXhwbGwsIGRkZXYsIGluZGV4KTsNCisJaWYgKHJldCkgew0KKwkJZHJtX2Vycihk
ZGV2LCAiY3J0YyBpbml0IHdpdGggcGxsIGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQlyZXR1cm4g
cmV0Ow0KKwl9DQorDQorCWxjcnRjLT5sZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJbGNydGMtPmh3
X29wcyA9ICZsczdhMjAwMF9jcnRjX2h3X29wc1tpbmRleF07DQorDQorCXJldCA9IGRybV9jcnRj
X2luaXRfd2l0aF9wbGFuZXMoZGRldiwNCisJCQkJCWNydGMsDQorCQkJCQlwcmltYXJ5LA0KKwkJ
CQkJY3Vyc29yLA0KKwkJCQkJJmxzN2EyMDAwX2NydGNfZnVuY3MsDQorCQkJCQkiQ1JUQy0lZCIs
DQorCQkJCQlpbmRleCk7DQorCWlmIChyZXQpIHsNCisJCWRybV9lcnIoZGRldiwgImNydGMgaW5p
dCB3aXRoIHBsYW5lcyBmYWlsZWQ6ICVkXG4iLCByZXQpOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0K
Kw0KKwlkcm1fY3J0Y19oZWxwZXJfYWRkKGNydGMsICZsc2RjX2NydGNfaGVscGVyX2Z1bmNzKTsN
CisNCisJcmV0ID0gZHJtX21vZGVfY3J0Y19zZXRfZ2FtbWFfc2l6ZShjcnRjLCAyNTYpOw0KKwlp
ZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZHJtX2NydGNfZW5hYmxlX2NvbG9yX21nbXQo
Y3J0YywgMCwgZmFsc2UsIDI1Nik7DQorDQorCXJldHVybiAwOw0KK30NCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kZWJ1Z2ZzLmMgYi9kcml2ZXJzL2dwdS9kcm0v
bG9vbmdzb24vbHNkY19kZWJ1Z2ZzLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAw
MDAwMDAwMDAuLjlhZDJjNWEwYWRkMg0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfZGVidWdmcy5jDQpAQCAtMCwwICsxLDkxIEBADQorLy8gU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMg
TG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1
ZGUgPGRybS9kcm1fZGVidWdmcy5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2JlbmNobWFyay5oIg0K
KyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKyNpbmNsdWRlICJsc2RjX2dlbS5oIg0KKyNpbmNsdWRl
ICJsc2RjX3Byb2JlLmgiDQorI2luY2x1ZGUgImxzZGNfdHRtLmgiDQorDQorLyogZGV2aWNlIGxl
dmVsIGRlYnVnZnMgKi8NCisNCitzdGF0aWMgaW50IGxzZGNfaWRlbnRpZnkoc3RydWN0IHNlcV9m
aWxlICptLCB2b2lkICphcmcpDQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSA9IChz
dHJ1Y3QgZHJtX2luZm9fbm9kZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBsc2RjX2RldmljZSAq
bGRldiA9IChzdHJ1Y3QgbHNkY19kZXZpY2UgKilub2RlLT5pbmZvX2VudC0+ZGF0YTsNCisJY29u
c3Qgc3RydWN0IGxvb25nc29uX2dmeF9kZXNjICpnZnggPSB0b19sb29uZ3Nvbl9nZngobGRldi0+
ZGVzY3ApOw0KKwl1OCBpbXBsLCByZXY7DQorDQorCWxvb25nc29uX2NwdV9nZXRfcHJpZCgmaW1w
bCwgJnJldik7DQorDQorCXNlcV9wcmludGYobSwgIlJ1bm5pbmcgb24gY3B1IDB4JXgsIGNwdSBy
ZXZpc2lvbjogMHgleFxuIiwNCisJCSAgIGltcGwsIHJldik7DQorDQorCXNlcV9wcmludGYobSwg
IkNvbnRhaW5lZCBpbjogJXNcbiIsIGdmeC0+bW9kZWwpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQor
DQorc3RhdGljIGludCBsc2RjX3Nob3dfbW0oc3RydWN0IHNlcV9maWxlICptLCB2b2lkICphcmcp
DQorew0KKwlzdHJ1Y3QgZHJtX2luZm9fbm9kZSAqbm9kZSA9IChzdHJ1Y3QgZHJtX2luZm9fbm9k
ZSAqKW0tPnByaXZhdGU7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gbm9kZS0+bWlub3It
PmRldjsNCisJc3RydWN0IGRybV9wcmludGVyIHAgPSBkcm1fc2VxX2ZpbGVfcHJpbnRlcihtKTsN
CisNCisJZHJtX21tX3ByaW50KCZkZGV2LT52bWFfb2Zmc2V0X21hbmFnZXItPnZtX2FkZHJfc3Bh
Y2VfbW0sICZwKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19zaG93
X2dmeHBsbF9jbG9jayhzdHJ1Y3Qgc2VxX2ZpbGUgKm0sIHZvaWQgKmFyZykNCit7DQorCXN0cnVj
dCBkcm1faW5mb19ub2RlICpub2RlID0gKHN0cnVjdCBkcm1faW5mb19ub2RlICopbS0+cHJpdmF0
ZTsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gKHN0cnVjdCBsc2RjX2RldmljZSAqKW5v
ZGUtPmluZm9fZW50LT5kYXRhOw0KKwlzdHJ1Y3QgZHJtX3ByaW50ZXIgcHJpbnRlciA9IGRybV9z
ZXFfZmlsZV9wcmludGVyKG0pOw0KKwlzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsICpnZnhwbGwgPSBs
ZGV2LT5nZnhwbGw7DQorDQorCWdmeHBsbC0+ZnVuY3MtPnByaW50KGdmeHBsbCwgJnByaW50ZXIs
IHRydWUpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX3Nob3dfYmVu
Y2htYXJrKHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0IGRybV9p
bmZvX25vZGUgKm5vZGUgPSAoc3RydWN0IGRybV9pbmZvX25vZGUgKiltLT5wcml2YXRlOw0KKwlz
dHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSAoc3RydWN0IGxzZGNfZGV2aWNlICopbm9kZS0+aW5m
b19lbnQtPmRhdGE7DQorCXN0cnVjdCBkcm1fcHJpbnRlciBwcmludGVyID0gZHJtX3NlcV9maWxl
X3ByaW50ZXIobSk7DQorDQorCWxzZGNfc2hvd19iZW5jaG1hcmtfY29weShsZGV2LCAmcHJpbnRl
cik7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgc3RydWN0IGRybV9pbmZvX2xpc3Qg
bHNkY19kZWJ1Z2ZzX2xpc3RbXSA9IHsNCisJeyAiY2hpcHMiLCAgICAgICBsc2RjX2lkZW50aWZ5
LCAwLCBOVUxMIH0sDQorCXsgImNsb2NrcyIsICAgICAgbHNkY19zaG93X2dmeHBsbF9jbG9jaywg
MCwgTlVMTCB9LA0KKwl7ICJtbSIsICAgICAgICAgIGxzZGNfc2hvd19tbSwgMCwgTlVMTCB9LA0K
Kwl7ICJib3MiLCAgICAgICAgIGxzZGNfc2hvd19idWZmZXJfb2JqZWN0LCAwLCBOVUxMIH0sDQor
CXsgImJlbmNobWFyayIsICAgbHNkY19zaG93X2JlbmNobWFyaywgMCwgTlVMTCB9LA0KK307DQor
DQordm9pZCBsc2RjX2RlYnVnZnNfaW5pdChzdHJ1Y3QgZHJtX21pbm9yICptaW5vcikNCit7DQor
CXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gbWlub3ItPmRldjsNCisJc3RydWN0IGxzZGNfZGV2
aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJdW5zaWduZWQgaW50IE4gPSBBUlJBWV9TSVpF
KGxzZGNfZGVidWdmc19saXN0KTsNCisJdW5zaWduZWQgaW50IGk7DQorDQorCWZvciAoaSA9IDA7
IGkgPCBOOyArK2kpDQorCQlsc2RjX2RlYnVnZnNfbGlzdFtpXS5kYXRhID0gbGRldjsNCisNCisJ
ZHJtX2RlYnVnZnNfY3JlYXRlX2ZpbGVzKGxzZGNfZGVidWdmc19saXN0LA0KKwkJCQkgTiwNCisJ
CQkJIG1pbm9yLT5kZWJ1Z2ZzX3Jvb3QsDQorCQkJCSBtaW5vcik7DQorDQorCWxzZGNfdHRtX2Rl
YnVnZnNfaW5pdChsZGV2KTsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfZGV2aWNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kZXZpY2Uu
Yw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uYjQxNTJmMjI4YmVi
DQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19kZXZp
Y2UuYw0KQEAgLTAsMCArMSwxMDQgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BM
LTIuMCsNCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENv
cnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaW5jbHVkZSA8bGludXgvcGNpLmg+DQorDQor
I2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsc2RjX2ttc19m
dW5jcyBsczdhMTAwMF9rbXNfZnVuY3MgPSB7DQorCS5jcmVhdGVfaTJjID0gbHNkY19jcmVhdGVf
aTJjX2NoYW4sDQorCS5pcnFfaGFuZGxlciA9IGxzN2ExMDAwX2RjX2lycV9oYW5kbGVyLA0KKwku
b3V0cHV0X2luaXQgPSBsczdhMTAwMF9vdXRwdXRfaW5pdCwNCisJLmN1cnNvcl9wbGFuZV9pbml0
ID0gbHM3YTEwMDBfY3Vyc29yX3BsYW5lX2luaXQsDQorCS5wcmltYXJ5X3BsYW5lX2luaXQgPSBs
c2RjX3ByaW1hcnlfcGxhbmVfaW5pdCwNCisJLmNydGNfaW5pdCA9IGxzN2ExMDAwX2NydGNfaW5p
dCwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgbHNkY19rbXNfZnVuY3MgbHM3YTIwMDBf
a21zX2Z1bmNzID0gew0KKwkuY3JlYXRlX2kyYyA9IGxzZGNfY3JlYXRlX2kyY19jaGFuLA0KKwku
aXJxX2hhbmRsZXIgPSBsczdhMjAwMF9kY19pcnFfaGFuZGxlciwNCisJLm91dHB1dF9pbml0ID0g
bHM3YTIwMDBfb3V0cHV0X2luaXQsDQorCS5jdXJzb3JfcGxhbmVfaW5pdCA9IGxzN2EyMDAwX2N1
cnNvcl9wbGFuZV9pbml0LA0KKwkucHJpbWFyeV9wbGFuZV9pbml0ID0gbHNkY19wcmltYXJ5X3Bs
YW5lX2luaXQsDQorCS5jcnRjX2luaXQgPSBsczdhMjAwMF9jcnRjX2luaXQsDQorfTsNCisNCitz
dGF0aWMgY29uc3Qgc3RydWN0IGxvb25nc29uX2dmeF9kZXNjIGxzN2ExMDAwX2dmeCA9IHsNCisJ
LmRjID0gew0KKwkJLm51bV9vZl9jcnRjID0gMiwNCisJCS5tYXhfcGl4ZWxfY2xrID0gMjAwMDAw
LA0KKwkJLm1heF93aWR0aCA9IDIwNDgsDQorCQkubWF4X2hlaWdodCA9IDIwNDgsDQorCQkubnVt
X29mX2h3X2N1cnNvciA9IDEsDQorCQkuaHdfY3Vyc29yX3cgPSAzMiwNCisJCS5od19jdXJzb3Jf
aCA9IDMyLA0KKwkJLnBpdGNoX2FsaWduID0gMjU2LA0KKwkJLm1jX2JpdHMgPSA0MCwNCisJCS5o
YXNfdmJsYW5rX2NvdW50ZXIgPSBmYWxzZSwNCisJCS5mdW5jcyA9ICZsczdhMTAwMF9rbXNfZnVu
Y3MsDQorCX0sDQorCS5jb25mX3JlZ19iYXNlID0gTFM3QTEwMDBfQ09ORl9SRUdfQkFTRSwNCisJ
LmdmeHBsbCA9IHsNCisJCS5yZWdfb2Zmc2V0ID0gTFM3QTEwMDBfUExMX0dGWF9SRUcsDQorCQku
cmVnX3NpemUgPSA4LA0KKwl9LA0KKwkucGl4cGxsID0gew0KKwkJWzBdID0gew0KKwkJCS5yZWdf
b2Zmc2V0ID0gTFM3QTEwMDBfUElYUExMMF9SRUcsDQorCQkJLnJlZ19zaXplID0gOCwNCisJCX0s
DQorCQlbMV0gPSB7DQorCQkJLnJlZ19vZmZzZXQgPSBMUzdBMTAwMF9QSVhQTEwxX1JFRywNCisJ
CQkucmVnX3NpemUgPSA4LA0KKwkJfSwNCisJfSwNCisJLmNoaXBfaWQgPSBDSElQX0xTN0ExMDAw
LA0KKwkubW9kZWwgPSAiTFM3QTEwMDAgYnJpZGdlIGNoaXBzZXQiLA0KK307DQorDQorc3RhdGlj
IGNvbnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVzYyBsczdhMjAwMF9nZnggPSB7DQorCS5kYyA9
IHsNCisJCS5udW1fb2ZfY3J0YyA9IDIsDQorCQkubWF4X3BpeGVsX2NsayA9IDM1MDAwMCwNCisJ
CS5tYXhfd2lkdGggPSA0MDk2LA0KKwkJLm1heF9oZWlnaHQgPSA0MDk2LA0KKwkJLm51bV9vZl9o
d19jdXJzb3IgPSAyLA0KKwkJLmh3X2N1cnNvcl93ID0gNjQsDQorCQkuaHdfY3Vyc29yX2ggPSA2
NCwNCisJCS5waXRjaF9hbGlnbiA9IDY0LA0KKwkJLm1jX2JpdHMgPSA0MCwgLyogU3VwcG9ydCA0
OCBidXQgdXNpbmcgNDAgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgKi8NCisJCS5oYXNfdmJs
YW5rX2NvdW50ZXIgPSB0cnVlLA0KKwkJLmZ1bmNzID0gJmxzN2EyMDAwX2ttc19mdW5jcywNCisJ
fSwNCisJLmNvbmZfcmVnX2Jhc2UgPSBMUzdBMjAwMF9DT05GX1JFR19CQVNFLA0KKwkuZ2Z4cGxs
ID0gew0KKwkJLnJlZ19vZmZzZXQgPSBMUzdBMjAwMF9QTExfR0ZYX1JFRywNCisJCS5yZWdfc2l6
ZSA9IDgsDQorCX0sDQorCS5waXhwbGwgPSB7DQorCQlbMF0gPSB7DQorCQkJLnJlZ19vZmZzZXQg
PSBMUzdBMjAwMF9QSVhQTEwwX1JFRywNCisJCQkucmVnX3NpemUgPSA4LA0KKwkJfSwNCisJCVsx
XSA9IHsNCisJCQkucmVnX29mZnNldCA9IExTN0EyMDAwX1BJWFBMTDFfUkVHLA0KKwkJCS5yZWdf
c2l6ZSA9IDgsDQorCQl9LA0KKwl9LA0KKwkuY2hpcF9pZCA9IENISVBfTFM3QTIwMDAsDQorCS5t
b2RlbCA9ICJMUzdBMjAwMCBicmlkZ2UgY2hpcHNldCIsDQorfTsNCisNCitjb25zdCBzdHJ1Y3Qg
bHNkY19kZXNjICoNCitsc2RjX2RldmljZV9wcm9iZShzdHJ1Y3QgcGNpX2RldiAqcGRldiwgZW51
bSBsb29uZ3Nvbl9jaGlwX2lkIGNoaXBfaWQpDQorew0KKwlpZiAoY2hpcF9pZCA9PSBDSElQX0xT
N0ExMDAwKQ0KKwkJcmV0dXJuICZsczdhMTAwMF9nZnguZGM7DQorDQorCWlmIChjaGlwX2lkID09
IENISVBfTFM3QTIwMDApDQorCQlyZXR1cm4gJmxzN2EyMDAwX2dmeC5kYzsNCisNCisJcmV0dXJu
IEVSUl9QVFIoLUVOT0RFVik7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29u
Z3Nvbi9sc2RjX2Rydi5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmMNCm5l
dyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjFkNWM3Zjc0YWJmNA0KLS0t
IC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmMNCkBA
IC0wLDAgKzEsNDg0IEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArDQor
LyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlv
biBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGxpbnV4L3BjaS5oPg0KKw0KKyNpbmNsdWRl
IDx2aWRlby9ub21vZGVzZXQuaD4NCisNCisjaW5jbHVkZSA8ZHJtL2RybV9hcGVydHVyZS5oPg0K
KyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9k
cnYuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9mYmRldl9nZW5lcmljLmg+DQorI2luY2x1ZGUgPGRy
bS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2lvY3Rs
Lmg+DQorI2luY2x1ZGUgPGRybS9kcm1fbW9kZXNldF9oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJt
L2RybV9wcm9iZV9oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV92YmxhbmsuaD4NCisNCisj
aW5jbHVkZSAibHNkY19kcnYuaCINCisjaW5jbHVkZSAibHNkY19nZW0uaCINCisjaW5jbHVkZSAi
bHNkY19pMmMuaCINCisjaW5jbHVkZSAibHNkY19pcnEuaCINCisjaW5jbHVkZSAibHNkY19vdXRw
dXQuaCINCisjaW5jbHVkZSAibHNkY19wcm9iZS5oIg0KKyNpbmNsdWRlICJsc2RjX3R0bS5oIg0K
Kw0KKyNkZWZpbmUgRFJJVkVSX0FVVEhPUiAgICAgICAgICAgIlN1aSBKaW5nZmVuZyA8c3Vpamlu
Z2ZlbmdAbG9vbmdzb24uY24+Ig0KKyNkZWZpbmUgRFJJVkVSX05BTUUgICAgICAgICAgICAgImxv
b25nc29uIg0KKyNkZWZpbmUgRFJJVkVSX0RFU0MgICAgICAgICAgICAgImRybSBkcml2ZXIgZm9y
IGxvb25nc29uIGdyYXBoaWNzIg0KKyNkZWZpbmUgRFJJVkVSX0RBVEUgICAgICAgICAgICAgIjIw
MjIwNzAxIg0KKyNkZWZpbmUgRFJJVkVSX01BSk9SICAgICAgICAgICAgMQ0KKyNkZWZpbmUgRFJJ
VkVSX01JTk9SICAgICAgICAgICAgMA0KKyNkZWZpbmUgRFJJVkVSX1BBVENITEVWRUwgICAgICAg
MA0KKw0KK0RFRklORV9EUk1fR0VNX0ZPUFMobHNkY19nZW1fZm9wcyk7DQorDQorc3RhdGljIGNv
bnN0IHN0cnVjdCBkcm1fZHJpdmVyIGxzZGNfZHJtX2RyaXZlciA9IHsNCisJLmRyaXZlcl9mZWF0
dXJlcyA9IERSSVZFUl9NT0RFU0VUIHwgRFJJVkVSX1JFTkRFUiB8IERSSVZFUl9HRU0gfCBEUklW
RVJfQVRPTUlDLA0KKwkuZm9wcyA9ICZsc2RjX2dlbV9mb3BzLA0KKw0KKwkubmFtZSA9IERSSVZF
Ul9OQU1FLA0KKwkuZGVzYyA9IERSSVZFUl9ERVNDLA0KKwkuZGF0ZSA9IERSSVZFUl9EQVRFLA0K
KwkubWFqb3IgPSBEUklWRVJfTUFKT1IsDQorCS5taW5vciA9IERSSVZFUl9NSU5PUiwNCisJLnBh
dGNobGV2ZWwgPSBEUklWRVJfUEFUQ0hMRVZFTCwNCisNCisJLmRlYnVnZnNfaW5pdCA9IGxzZGNf
ZGVidWdmc19pbml0LA0KKwkuZHVtYl9jcmVhdGUgPSBsc2RjX2R1bWJfY3JlYXRlLA0KKwkuZHVt
Yl9tYXBfb2Zmc2V0ID0gbHNkY19kdW1iX21hcF9vZmZzZXQsDQorCS5wcmltZV9oYW5kbGVfdG9f
ZmQgPSBkcm1fZ2VtX3ByaW1lX2hhbmRsZV90b19mZCwNCisJLnByaW1lX2ZkX3RvX2hhbmRsZSA9
IGRybV9nZW1fcHJpbWVfZmRfdG9faGFuZGxlLA0KKwkuZ2VtX3ByaW1lX2ltcG9ydF9zZ190YWJs
ZSA9IGxzZGNfcHJpbWVfaW1wb3J0X3NnX3RhYmxlLA0KKwkuZ2VtX3ByaW1lX21tYXAgPSBkcm1f
Z2VtX3ByaW1lX21tYXAsDQorfTsNCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9tb2RlX2Nv
bmZpZ19mdW5jcyBsc2RjX21vZGVfY29uZmlnX2Z1bmNzID0gew0KKwkuZmJfY3JlYXRlID0gZHJt
X2dlbV9mYl9jcmVhdGUsDQorCS5hdG9taWNfY2hlY2sgPSBkcm1fYXRvbWljX2hlbHBlcl9jaGVj
aywNCisJLmF0b21pY19jb21taXQgPSBkcm1fYXRvbWljX2hlbHBlcl9jb21taXQsDQorfTsNCisN
CisvKiBEaXNwbGF5IHJlbGF0ZWQgKi8NCisNCitzdGF0aWMgaW50IGxzZGNfbW9kZXNldF9pbml0
KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldiwNCisJCQkgICAgIHVuc2lnbmVkIGludCBudW1fY3J0
YywNCisJCQkgICAgIGNvbnN0IHN0cnVjdCBsc2RjX2ttc19mdW5jcyAqZnVuY3MpDQorew0KKwlz
dHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9ICZsZGV2LT5iYXNlOw0KKwlzdHJ1Y3QgbHNkY19kaXNw
bGF5X3BpcGUgKmRpc3BpcGU7DQorCXVuc2lnbmVkIGludCBpOw0KKwlpbnQgcmV0Ow0KKw0KKwlm
b3IgKGkgPSAwOyBpIDwgbnVtX2NydGM7IGkrKykgew0KKwkJZGlzcGlwZSA9ICZsZGV2LT5kaXNw
aXBlW2ldOw0KKw0KKwkJLyogV2UgbmVlZCBhIGluZGV4IGJlZm9yZSBjcnRjIGlzIGluaXRpYWxp
emVkICovDQorCQlkaXNwaXBlLT5pbmRleCA9IGk7DQorDQorCQlyZXQgPSBmdW5jcy0+Y3JlYXRl
X2kyYyhkZGV2LCBkaXNwaXBlLCBpKTsNCisJCWlmIChyZXQpDQorCQkJcmV0dXJuIHJldDsNCisJ
fQ0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2NydGM7IGkrKykgew0KKwkJc3RydWN0IGkyY19h
ZGFwdGVyICpkZGMgPSBOVUxMOw0KKw0KKwkJZGlzcGlwZSA9ICZsZGV2LT5kaXNwaXBlW2ldOw0K
KwkJaWYgKGRpc3BpcGUtPmxpMmMpDQorCQkJZGRjID0gJmRpc3BpcGUtPmxpMmMtPmFkYXB0ZXI7
DQorDQorCQlyZXQgPSBmdW5jcy0+b3V0cHV0X2luaXQoZGRldiwgZGlzcGlwZSwgZGRjLCBpKTsN
CisJCWlmIChyZXQpDQorCQkJcmV0dXJuIHJldDsNCisNCisJCWxkZXYtPm51bV9vdXRwdXQrKzsN
CisJfQ0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgbnVtX2NydGM7IGkrKykgew0KKwkJZGlzcGlwZSA9
ICZsZGV2LT5kaXNwaXBlW2ldOw0KKw0KKwkJcmV0ID0gZnVuY3MtPnByaW1hcnlfcGxhbmVfaW5p
dChkZGV2LCAmZGlzcGlwZS0+cHJpbWFyeS5iYXNlLCBpKTsNCisJCWlmIChyZXQpDQorCQkJcmV0
dXJuIHJldDsNCisNCisJCXJldCA9IGZ1bmNzLT5jdXJzb3JfcGxhbmVfaW5pdChkZGV2LCAmZGlz
cGlwZS0+Y3Vyc29yLmJhc2UsIGkpOw0KKwkJaWYgKHJldCkNCisJCQlyZXR1cm4gcmV0Ow0KKw0K
KwkJcmV0ID0gZnVuY3MtPmNydGNfaW5pdChkZGV2LA0KKwkJCQkgICAgICAgJmRpc3BpcGUtPmNy
dGMuYmFzZSwNCisJCQkJICAgICAgICZkaXNwaXBlLT5wcmltYXJ5LmJhc2UsDQorCQkJCSAgICAg
ICAmZGlzcGlwZS0+Y3Vyc29yLmJhc2UsDQorCQkJCSAgICAgICBpKTsNCisJCWlmIChyZXQpDQor
CQkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlkcm1faW5mbyhkZGV2LCAidG90YWwgJXUgb3V0cHV0
c1xuIiwgbGRldi0+bnVtX291dHB1dCk7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMg
aW50IGxzZGNfbW9kZV9jb25maWdfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkJ
IGNvbnN0IHN0cnVjdCBsc2RjX2Rlc2MgKmRlc2NwKQ0KK3sNCisJaW50IHJldDsNCisNCisJcmV0
ID0gZHJtbV9tb2RlX2NvbmZpZ19pbml0KGRkZXYpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJl
dDsNCisNCisJZGRldi0+bW9kZV9jb25maWcuZnVuY3MgPSAmbHNkY19tb2RlX2NvbmZpZ19mdW5j
czsNCisJZGRldi0+bW9kZV9jb25maWcubWluX3dpZHRoID0gMTsNCisJZGRldi0+bW9kZV9jb25m
aWcubWluX2hlaWdodCA9IDE7DQorCWRkZXYtPm1vZGVfY29uZmlnLm1heF93aWR0aCA9IGRlc2Nw
LT5tYXhfd2lkdGggKiBMU0RDX05VTV9DUlRDOw0KKwlkZGV2LT5tb2RlX2NvbmZpZy5tYXhfaGVp
Z2h0ID0gZGVzY3AtPm1heF9oZWlnaHQgKiBMU0RDX05VTV9DUlRDOw0KKwlkZGV2LT5tb2RlX2Nv
bmZpZy5wcmVmZXJyZWRfZGVwdGggPSAyNDsNCisJZGRldi0+bW9kZV9jb25maWcucHJlZmVyX3No
YWRvdyA9IDE7DQorDQorCWRkZXYtPm1vZGVfY29uZmlnLmN1cnNvcl93aWR0aCA9IGRlc2NwLT5o
d19jdXJzb3JfaDsNCisJZGRldi0+bW9kZV9jb25maWcuY3Vyc29yX2hlaWdodCA9IGRlc2NwLT5o
d19jdXJzb3JfaDsNCisNCisJaWYgKGRlc2NwLT5oYXNfdmJsYW5rX2NvdW50ZXIpDQorCQlkZGV2
LT5tYXhfdmJsYW5rX2NvdW50ID0gMHhmZmZmZmZmZjsNCisNCisJcmV0dXJuIHJldDsNCit9DQor
DQorLyoNCisgKiBUaGUgR1BVIGFuZCBkaXNwbGF5IGNvbnRyb2xsZXIgaW4gTFM3QTEwMDAvTFM3
QTIwMDAgYXJlIHNlcGFyYXRlZA0KKyAqIFBDSUUgZGV2aWNlcywgdGhleSBhcmUgdHdvIGRldmlj
ZXMgbm90IG9uZS4gVGhlIERDIGRvZXMgbm90IGhhcyBhDQorICogZGVkaWNhdGUgVlJBTSBiYXIs
IGJlY2F1c2UgdGhlIEJJT1MgZW5naW5lZXIgY2hvb3NlIHRvIGFzc2lnbiB0aGUNCisgKiBWUkFN
IHRvIHRoZSBHUFUgZGV2aWNlLiBTYWRseSwgYWZ0ZXIgeWVhcnMgYXBwbGljYXRpb24sIHRoaXMg
Zm9ybQ0KKyAqIGFzIGEgY29udmVudGlvbiBmb3IgbG9vbmdzb24gaW50ZWdyYXRlZCBncmFwaGlj
cy4gQmFyIDIgb2YgdGhlIEdQVQ0KKyAqIGRldmljZSBjb250YWluIHRoZSBiYXNlIGFkZHJlc3Mg
YW5kIHNpemUgb2YgdGhlIFZSQU0sIGJvdGggdGhlIEdQVQ0KKyAqIGFuZCB0aGUgREMgY2FuIGFj
Y2VzcyB0aGUgb24tYm9hcmQgVlJBTSBhcyBsb25nIGFzIHRoZSBETUEgYWRkcmVzcw0KKyAqIGVt
aXR0ZWQgZmFsbCBpbiBbYmFzZSwgYmFzZSArIHNpemUpLg0KKyAqLw0KK3N0YXRpYyBpbnQgbHNk
Y19nZXRfZGVkaWNhdGVkX3ZyYW0oc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2LA0KKwkJCQkgICBz
dHJ1Y3QgcGNpX2RldiAqcGRldl9kYywNCisJCQkJICAgY29uc3Qgc3RydWN0IGxzZGNfZGVzYyAq
ZGVzY3ApDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9ICZsZGV2LT5iYXNlOw0KKwlz
dHJ1Y3QgcGNpX2RldiAqcGRldl9ncHU7DQorCXJlc291cmNlX3NpemVfdCBiYXNlLCBzaXplOw0K
Kw0KKwkvKg0KKwkgKiBUaGUgR1BVIGhhcyAwMDowNi4wIGFzIGl0cyBCREYsIHdoaWxlIHRoZSBE
QyBoYXMgMDA6MDYuMSwNCisJICogVGhpcyBpcyBzdXJlIGZvciBMUzdBMTAwMCwgTFM3QTIwMDAg
YW5kIExTMksyMDAwLg0KKwkgKi8NCisJcGRldl9ncHUgPSBwY2lfZ2V0X2RvbWFpbl9idXNfYW5k
X3Nsb3QocGNpX2RvbWFpbl9ucihwZGV2X2RjLT5idXMpLA0KKwkJCQkJICAgICAgIHBkZXZfZGMt
PmJ1cy0+bnVtYmVyLA0KKwkJCQkJICAgICAgIFBDSV9ERVZGTig2LCAwKSk7DQorCWlmICghcGRl
dl9ncHUpIHsNCisJCWRybV9lcnIoZGRldiwgIk5vIEdQVSBkZXZpY2UsIHRoZW4gbm8gVlJBTVxu
Iik7DQorCQlyZXR1cm4gLUVOT0RFVjsNCisJfQ0KKw0KKwliYXNlID0gcGNpX3Jlc291cmNlX3N0
YXJ0KHBkZXZfZ3B1LCAyKTsNCisJc2l6ZSA9IHBjaV9yZXNvdXJjZV9sZW4ocGRldl9ncHUsIDIp
Ow0KKw0KKwlsZGV2LT52cmFtX2Jhc2UgPSBiYXNlOw0KKwlsZGV2LT52cmFtX3NpemUgPSBzaXpl
Ow0KKwlsZGV2LT5ncHUgPSBwZGV2X2dwdTsNCisNCisJZHJtX2luZm8oZGRldiwgImRlZGljYXRl
ZCB2cmFtIHN0YXJ0OiAweCVsbHgsIHNpemU6ICV1TUJcbiIsDQorCQkgKHU2NCliYXNlLCAodTMy
KShzaXplID4+IDIwKSk7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgc3RydWN0IGxz
ZGNfZGV2aWNlICoNCitsc2RjX2NyZWF0ZV9kZXZpY2Uoc3RydWN0IHBjaV9kZXYgKnBkZXYsDQor
CQkgICBjb25zdCBzdHJ1Y3QgbHNkY19kZXNjICpkZXNjcCwNCisJCSAgIGNvbnN0IHN0cnVjdCBk
cm1fZHJpdmVyICpkcnYpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXY7DQorCXN0cnVj
dCBkcm1fZGV2aWNlICpkZGV2Ow0KKwlpbnQgcmV0Ow0KKw0KKwlsZGV2ID0gZGV2bV9kcm1fZGV2
X2FsbG9jKCZwZGV2LT5kZXYsIGRydiwgc3RydWN0IGxzZGNfZGV2aWNlLCBiYXNlKTsNCisJaWYg
KElTX0VSUihsZGV2KSkNCisJCXJldHVybiBsZGV2Ow0KKw0KKwlkZGV2ID0gJmxkZXYtPmJhc2U7
DQorDQorCWxkZXYtPmRlc2NwID0gZGVzY3A7DQorDQorCWxvb25nc29uX2dmeHBsbF9jcmVhdGUo
ZGRldiwgJmxkZXYtPmdmeHBsbCk7DQorDQorCXJldCA9IGxzZGNfZ2V0X2RlZGljYXRlZF92cmFt
KGxkZXYsIHBkZXYsIGRlc2NwKTsNCisJaWYgKHJldCkgew0KKwkJZHJtX2VycihkZGV2LCAiSW5p
dCBWUkFNIGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9
DQorDQorCXJldCA9IGRybV9hcGVydHVyZV9yZW1vdmVfY29uZmxpY3RpbmdfZnJhbWVidWZmZXJz
KGxkZXYtPnZyYW1fYmFzZSwNCisJCQkJCQkJICAgbGRldi0+dnJhbV9zaXplLA0KKwkJCQkJCQkg
ICBkcnYpOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKGRkZXYsICJyZW1vdmUgZmlybXdhcmUg
ZnJhbWVidWZmZXJzIGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQp
Ow0KKwl9DQorDQorCXJldCA9IGxzZGNfdHRtX2luaXQobGRldik7DQorCWlmIChyZXQpIHsNCisJ
CWRybV9lcnIoZGRldiwgIm1lbW9yeSBtYW5hZ2VyIGluaXQgZmFpbGVkOiAlZFxuIiwgcmV0KTsN
CisJCXJldHVybiBFUlJfUFRSKHJldCk7DQorCX0NCisNCisJbHNkY19nZW1faW5pdChkZGV2KTsN
CisNCisJLyogQkFSIDAgb2YgdGhlIERDIGRldmljZSBjb250YWluIHJlZ2lzdGVycyBiYXNlIGFk
ZHJlc3MgKi8NCisJbGRldi0+cmVnX2Jhc2UgPSBwY2ltX2lvbWFwKHBkZXYsIDAsIDApOw0KKwlp
ZiAoIWxkZXYtPnJlZ19iYXNlKQ0KKwkJcmV0dXJuIEVSUl9QVFIoLUVOT0RFVik7DQorDQorCXNw
aW5fbG9ja19pbml0KCZsZGV2LT5yZWdsb2NrKTsNCisNCisJcmV0ID0gbHNkY19tb2RlX2NvbmZp
Z19pbml0KGRkZXYsIGRlc2NwKTsNCisJaWYgKHJldCkNCisJCXJldHVybiBFUlJfUFRSKHJldCk7
DQorDQorCXJldCA9IGxzZGNfbW9kZXNldF9pbml0KGxkZXYsIGRlc2NwLT5udW1fb2ZfY3J0Yywg
ZGVzY3AtPmZ1bmNzKTsNCisJaWYgKHJldCkNCisJCXJldHVybiBFUlJfUFRSKHJldCk7DQorDQor
CWRybV9tb2RlX2NvbmZpZ19yZXNldChkZGV2KTsNCisNCisJcmV0ID0gZHJtX3ZibGFua19pbml0
KGRkZXYsIGRlc2NwLT5udW1fb2ZfY3J0Yyk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gRVJSX1BU
UihyZXQpOw0KKw0KKwlkcm1fa21zX2hlbHBlcl9wb2xsX2luaXQoZGRldik7DQorDQorCXJldHVy
biBsZGV2Ow0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfcGNpX3Byb2JlKHN0cnVjdCBwY2lfZGV2
ICpwZGV2LCBjb25zdCBzdHJ1Y3QgcGNpX2RldmljZV9pZCAqZW50KQ0KK3sNCisJY29uc3Qgc3Ry
dWN0IGxzZGNfZGVzYyAqZGVzY3A7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2Ow0KKwlzdHJ1
Y3QgbHNkY19kZXZpY2UgKmxkZXY7DQorCWludCByZXQ7DQorDQorCXJldCA9IHBjaW1fZW5hYmxl
X2RldmljZShwZGV2KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCXBjaV9zZXRf
bWFzdGVyKHBkZXYpOw0KKw0KKwlyZXQgPSBkbWFfc2V0X21hc2tfYW5kX2NvaGVyZW50KCZwZGV2
LT5kZXYsIERNQV9CSVRfTUFTSyg0MCkpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisN
CisJZGVzY3AgPSBsc2RjX2RldmljZV9wcm9iZShwZGV2LCBlbnQtPmRyaXZlcl9kYXRhKTsNCisJ
aWYgKElTX0VSUl9PUl9OVUxMKGRlc2NwKSkNCisJCXJldHVybiAtRU5PREVWOw0KKw0KKwlkZXZf
aW5mbygmcGRldi0+ZGV2LCAiRm91bmQgJXMsIHJldmlzaW9uOiAldSIsDQorCQkgdG9fbG9vbmdz
b25fZ2Z4KGRlc2NwKS0+bW9kZWwsIHBkZXYtPnJldmlzaW9uKTsNCisNCisJbGRldiA9IGxzZGNf
Y3JlYXRlX2RldmljZShwZGV2LCBkZXNjcCwgJmxzZGNfZHJtX2RyaXZlcik7DQorCWlmIChJU19F
UlIobGRldikpDQorCQlyZXR1cm4gUFRSX0VSUihsZGV2KTsNCisNCisJbGRldi0+ZGMgPSBwZGV2
Ow0KKw0KKwlkZGV2ID0gJmxkZXYtPmJhc2U7DQorDQorCXBjaV9zZXRfZHJ2ZGF0YShwZGV2LCBk
ZGV2KTsNCisNCisJcmV0ID0gZGV2bV9yZXF1ZXN0X2lycSgmcGRldi0+ZGV2LA0KKwkJCSAgICAg
ICBwZGV2LT5pcnEsDQorCQkJICAgICAgIGRlc2NwLT5mdW5jcy0+aXJxX2hhbmRsZXIsDQorCQkJ
ICAgICAgIElSUUZfU0hBUkVELA0KKwkJCSAgICAgICBkZXZfbmFtZSgmcGRldi0+ZGV2KSwNCisJ
CQkgICAgICAgZGRldik7DQorCWlmIChyZXQpIHsNCisJCWRybV9lcnIoZGRldiwgIkZhaWxlZCB0
byByZWdpc3RlciBpbnRlcnJ1cHQ6ICVkXG4iLCByZXQpOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0K
Kw0KKwlyZXQgPSBkcm1fZGV2X3JlZ2lzdGVyKGRkZXYsIDApOw0KKwlpZiAocmV0KQ0KKwkJcmV0
dXJuIHJldDsNCisNCisJZHJtX2ZiZGV2X2dlbmVyaWNfc2V0dXAoZGRldiwgMzIpOw0KKw0KKwly
ZXR1cm4gMDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19wY2lfcmVtb3ZlKHN0cnVjdCBwY2lf
ZGV2ICpwZGV2KQ0KK3sNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSBwY2lfZ2V0X2RydmRh
dGEocGRldik7DQorDQorCWRybV9kZXZfdW5yZWdpc3RlcihkZGV2KTsNCisJZHJtX2F0b21pY19o
ZWxwZXJfc2h1dGRvd24oZGRldik7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19kcm1fZnJlZXpl
KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2
ID0gdG9fbHNkYyhkZGV2KTsNCisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisJaW50IHJldDsNCisN
CisJLyogdW5waW4gYWxsIG9mIGJ1ZmZlcnMgaW4gdGhlIHZyYW0gKi8NCisJbXV0ZXhfbG9jaygm
bGRldi0+Z2VtLm11dGV4KTsNCisJbGlzdF9mb3JfZWFjaF9lbnRyeShsYm8sICZsZGV2LT5nZW0u
b2JqZWN0cywgbGlzdCkgew0KKwkJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8gPSAmbGJv
LT50Ym87DQorCQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXNvdXJjZSA9IHRiby0+cmVzb3VyY2U7
DQorCQl1bnNpZ25lZCBpbnQgcGluX2NvdW50ID0gdGJvLT5waW5fY291bnQ7DQorDQorCQlkcm1f
ZGJnKGRkZXYsDQorCQkJImJvWyVwXSwgc2l6ZTogJXp1S0IsIHR5cGU6ICVzLCBwaW4gY291bnQ6
ICV1XG4iLA0KKwkJCWxibywNCisJCQlsc2RjX2JvX3NpemUobGJvKSA+PiAxMCwNCisJCQlsc2Rj
X21lbV90eXBlX3RvX3N0cihyZXNvdXJjZS0+bWVtX3R5cGUpLA0KKwkJCXBpbl9jb3VudCk7DQor
DQorCQlpZiAoIXBpbl9jb3VudCkNCisJCQljb250aW51ZTsNCisNCisJCWlmIChyZXNvdXJjZS0+
bWVtX3R5cGUgPT0gVFRNX1BMX1ZSQU0pIHsNCisJCQlyZXQgPSBsc2RjX2JvX3Jlc2VydmUobGJv
KTsNCisJCQlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJCQlkcm1fZXJyKGRkZXYsICJibyByZXNl
cnZlIGZhaWxlZDogJWRcbiIsIHJldCk7DQorCQkJCWNvbnRpbnVlOw0KKwkJCX0NCisNCisJCQkv
Kg0KKwkJCSAqIEZvciBkb3VibGUgc2NyZWVuIHVzYWdlIGNhc2UsIG11bHRpcGxlIGNydGMgbWF5
DQorCQkJICogcmVmZXJlbmNlIHRvIHRoZSBzaW5nbGUgZ2lhbnQgZnJhbWVidWZmZXIgYm8uDQor
CQkJICogVGhlIHNpbmdsZSBnaWFudCBmYiBibyBnZXQgcGlubmVkIGJ5IG11bHRpcGxlIHRpbWUu
DQorCQkJICogdGh1cywgaXQgbmVlZCB0byB1bnBpbiB1bnRpbCBpdHMgcGluIGNvdW50ZXIgcmVh
Y2gNCisJCQkgKiB6ZXJvLg0KKwkJCSAqLw0KKwkJCWRvIHsNCisJCQkJbHNkY19ib191bnBpbihs
Ym8pOw0KKwkJCQktLXBpbl9jb3VudDsNCisJCQl9IHdoaWxlIChwaW5fY291bnQpOw0KKw0KKwkJ
CWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorCQl9DQorCX0NCisJbXV0ZXhfdW5sb2NrKCZsZGV2
LT5nZW0ubXV0ZXgpOw0KKw0KKwlsc2RjX2JvX2V2aWN0X3ZyYW0oZGRldik7DQorDQorCXJldCA9
IGRybV9tb2RlX2NvbmZpZ19oZWxwZXJfc3VzcGVuZChkZGV2KTsNCisJaWYgKHVubGlrZWx5KHJl
dCkpIHsNCisJCWRybV9lcnIoZGRldiwgImZyZWV6ZSBlcnJvcjogJWQiLCByZXQpOw0KKwkJcmV0
dXJuIHJldDsNCisJfQ0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX2Ry
bV9yZXN1bWUoc3RydWN0IGRldmljZSAqZGV2KQ0KK3sNCisJc3RydWN0IHBjaV9kZXYgKnBkZXYg
PSB0b19wY2lfZGV2KGRldik7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gcGNpX2dldF9k
cnZkYXRhKHBkZXYpOw0KKw0KKwlyZXR1cm4gZHJtX21vZGVfY29uZmlnX2hlbHBlcl9yZXN1bWUo
ZGRldik7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19wbV9mcmVlemUoc3RydWN0IGRldmljZSAq
ZGV2KQ0KK3sNCisJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSB0b19wY2lfZGV2KGRldik7DQorCXN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gcGNpX2dldF9kcnZkYXRhKHBkZXYpOw0KKw0KKwlyZXR1
cm4gbHNkY19kcm1fZnJlZXplKGRkZXYpOw0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfcG1fdGhh
dyhzdHJ1Y3QgZGV2aWNlICpkZXYpDQorew0KKwlyZXR1cm4gbHNkY19kcm1fcmVzdW1lKGRldik7
DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19wbV9zdXNwZW5kKHN0cnVjdCBkZXZpY2UgKmRldikN
Cit7DQorCXN0cnVjdCBwY2lfZGV2ICpwZGV2ID0gdG9fcGNpX2RldihkZXYpOw0KKwlpbnQgZXJy
b3I7DQorDQorCWVycm9yID0gbHNkY19wbV9mcmVlemUoZGV2KTsNCisJaWYgKGVycm9yKQ0KKwkJ
cmV0dXJuIGVycm9yOw0KKw0KKwlwY2lfc2F2ZV9zdGF0ZShwZGV2KTsNCisJLyogU2h1dCBkb3du
IHRoZSBkZXZpY2UgKi8NCisJcGNpX2Rpc2FibGVfZGV2aWNlKHBkZXYpOw0KKwlwY2lfc2V0X3Bv
d2VyX3N0YXRlKHBkZXYsIFBDSV9EM2hvdCk7DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0
aWMgaW50IGxzZGNfcG1fcmVzdW1lKHN0cnVjdCBkZXZpY2UgKmRldikNCit7DQorCXN0cnVjdCBw
Y2lfZGV2ICpwZGV2ID0gdG9fcGNpX2RldihkZXYpOw0KKw0KKwlwY2lfc2V0X3Bvd2VyX3N0YXRl
KHBkZXYsIFBDSV9EMCk7DQorDQorCXBjaV9yZXN0b3JlX3N0YXRlKHBkZXYpOw0KKw0KKwlpZiAo
cGNpbV9lbmFibGVfZGV2aWNlKHBkZXYpKQ0KKwkJcmV0dXJuIC1FSU87DQorDQorCXJldHVybiBs
c2RjX3BtX3RoYXcoZGV2KTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkZXZfcG1fb3Bz
IGxzZGNfcG1fb3BzID0gew0KKwkuc3VzcGVuZCA9IGxzZGNfcG1fc3VzcGVuZCwNCisJLnJlc3Vt
ZSA9IGxzZGNfcG1fcmVzdW1lLA0KKwkuZnJlZXplID0gbHNkY19wbV9mcmVlemUsDQorCS50aGF3
ID0gbHNkY19wbV90aGF3LA0KKwkucG93ZXJvZmYgPSBsc2RjX3BtX2ZyZWV6ZSwNCisJLnJlc3Rv
cmUgPSBsc2RjX3BtX3Jlc3VtZSwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCBzdHJ1Y3QgcGNpX2Rl
dmljZV9pZCBsc2RjX3BjaWlkX2xpc3RbXSA9IHsNCisJe1BDSV9WRU5ET1JfSURfTE9PTkdTT04s
IDB4N2EwNiwgUENJX0FOWV9JRCwgUENJX0FOWV9JRCwgMCwgMCwgQ0hJUF9MUzdBMTAwMH0sDQor
CXtQQ0lfVkVORE9SX0lEX0xPT05HU09OLCAweDdhMzYsIFBDSV9BTllfSUQsIFBDSV9BTllfSUQs
IDAsIDAsIENISVBfTFM3QTIwMDB9LA0KKwl7MCwgMCwgMCwgMCwgMCwgMCwgMH0NCit9Ow0KKw0K
K3N0YXRpYyBzdHJ1Y3QgcGNpX2RyaXZlciBsc2RjX3BjaV9kcml2ZXIgPSB7DQorCS5uYW1lID0g
RFJJVkVSX05BTUUsDQorCS5pZF90YWJsZSA9IGxzZGNfcGNpaWRfbGlzdCwNCisJLnByb2JlID0g
bHNkY19wY2lfcHJvYmUsDQorCS5yZW1vdmUgPSBsc2RjX3BjaV9yZW1vdmUsDQorCS5kcml2ZXIu
cG0gPSAmbHNkY19wbV9vcHMsDQorfTsNCisNCitzdGF0aWMgaW50IF9faW5pdCBsb29uZ3Nvbl9t
b2R1bGVfaW5pdCh2b2lkKQ0KK3sNCisJc3RydWN0IHBjaV9kZXYgKnBkZXYgPSBOVUxMOw0KKw0K
KwlpZiAodmlkZW9fZmlybXdhcmVfZHJpdmVyc19vbmx5KCkpDQorCQlyZXR1cm4gLUVOT0RFVjsN
CisNCisJLyogTXVsdGlwbGUgdmlkZW8gY2FyZCB3b3JrYXJvdW5kICovDQorCXdoaWxlICgocGRl
diA9IHBjaV9nZXRfY2xhc3MoUENJX0NMQVNTX0RJU1BMQVlfVkdBIDw8IDgsIHBkZXYpKSkgew0K
KwkJaWYgKHBkZXYtPnZlbmRvciAhPSBQQ0lfVkVORE9SX0lEX0xPT05HU09OKSB7DQorCQkJcHJf
aW5mbygiRGlzY3JldGUgZ3JhcGhpYyBjYXJkIGRldGVjdGVkLCBhYm9ydFxuIik7DQorCQkJcmV0
dXJuIDA7DQorCQl9DQorCX0NCisNCisJcmV0dXJuIHBjaV9yZWdpc3Rlcl9kcml2ZXIoJmxzZGNf
cGNpX2RyaXZlcik7DQorfQ0KK21vZHVsZV9pbml0KGxvb25nc29uX21vZHVsZV9pbml0KTsNCisN
CitzdGF0aWMgdm9pZCBfX2V4aXQgbG9vbmdzb25fbW9kdWxlX2V4aXQodm9pZCkNCit7DQorCXBj
aV91bnJlZ2lzdGVyX2RyaXZlcigmbHNkY19wY2lfZHJpdmVyKTsNCit9DQorbW9kdWxlX2V4aXQo
bG9vbmdzb25fbW9kdWxlX2V4aXQpOw0KKw0KK01PRFVMRV9ERVZJQ0VfVEFCTEUocGNpLCBsc2Rj
X3BjaWlkX2xpc3QpOw0KK01PRFVMRV9BVVRIT1IoRFJJVkVSX0FVVEhPUik7DQorTU9EVUxFX0RF
U0NSSVBUSU9OKERSSVZFUl9ERVNDKTsNCitNT0RVTEVfTElDRU5TRSgiR1BMIik7DQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfZHJ2LmggYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19kcnYuaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAw
MDAwMDAwMC4uMDM0ZDAxYzM0MjNiDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY19kcnYuaA0KQEAgLTAsMCArMSw0NTIgQEANCisvKiBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMCAqLw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExv
b25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5kZWYg
X19MU0RDX0RSVl9IX18NCisjZGVmaW5lIF9fTFNEQ19EUlZfSF9fDQorDQorI2luY2x1ZGUgPGxp
bnV4L3BjaS5oPg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2Nvbm5lY3Rvci5oPg0KKyNpbmNsdWRl
IDxkcm0vZHJtX2NydGMuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9kZXZpY2UuaD4NCisjaW5jbHVk
ZSA8ZHJtL2RybV9lbmNvZGVyLmg+DQorDQorI2luY2x1ZGUgPGRybS9kcm1fZmlsZS5oPg0KKyNp
bmNsdWRlIDxkcm0vZHJtX3BsYW5lLmg+DQorI2luY2x1ZGUgPGRybS90dG0vdHRtX2RldmljZS5o
Pg0KKw0KKyNpbmNsdWRlICJsc2RjX2kyYy5oIg0KKyNpbmNsdWRlICJsc2RjX2lycS5oIg0KKyNp
bmNsdWRlICJsc2RjX2dmeHBsbC5oIg0KKyNpbmNsdWRlICJsc2RjX3BpeHBsbC5oIg0KKyNpbmNs
dWRlICJsc2RjX3JlZ3MuaCINCisjaW5jbHVkZSAibHNkY19vdXRwdXQuaCINCisNCisvKiBDdXJy
ZW50bHksIGFsbCBsb29uZ3NvbiBkaXNwbGF5IGNvbnRyb2xsZXIgaGFzIHR3byBkaXNwbGF5IHBp
cGVzICovDQorI2RlZmluZSBMU0RDX05VTV9DUlRDICAgICAgICAgICAyDQorDQorLyoNCisgKiBM
UzdBMTAwMC9MUzdBMjAwMCBicmlkZ2UgY2hpcHNldCBmdW5jdGlvbiBhcyBzb3V0aCAmIG5vcnRo
IG9mIHRoZSBMb29uZ3Nvbg0KKyAqIExTM0E0MDAwL0xTM0E1MDAwL0xTM0E2MDAwIENQVSwgdGhl
eSBhcmUgZXF1aXBwZWQgd2l0aCBvbi1ib2FyZCB2aWRlbyBSQU0NCisgKiB0eXBpY2FsbHkuIFdo
aWxlIExTMkswNTAwL0xTMksxMDAwL0xTMksyMDAwIGFyZSBsb3cgY29zdCBTb0NzIHdoaWNoIHNo
YXJlDQorICogdGhlIHN5c3RlbSBSQU0gYXMgdmlkZW8gUkFNLCB0aGV5IGRvbid0IGhhcyBhIGRl
ZGlhY2F0ZWQgVlJBTS4NCisgKg0KKyAqIExTN0EyMDAwIGludGVncmF0ZWQgYSAzMi1iaXQgRERS
NEAyNDAwIHZpZGVvIG1lbXRvcnkgY29udHJvbGxlciwgd2hpbGUNCisgKiBpdCBpcyBqdXN0IDE2
LWJpdCBERFIzIGZvciBMUzdBMTAwMC4gTFM3QTIwMDAgaW50ZWdyYXRlIExvb25nc29uIHNlbGYN
CisgKiBtYWRlZCBMb29uZ0dQVSwgTFM3QTEwMDAgaW50ZWdyYXRlIEdDMTAwMCBkdWUgdG8gaGlz
dG9yaWNhbCByZWFzb25zLg0KKyAqDQorICogVGhlIGRpc3BsYXkgY29udHJvbGxlciBpbiBMUzdB
MTAwMCBoYXMgb25seSB0d28td2F5IERWTyBpbnRlcmZhY2UgZXhwb3J0ZWQsDQorICogdGh1cywg
ZXh0ZXJuYWwgZW5jb2RlcihUWCBjaGlwKSBpcyByZXF1aXJlZCBleGNlcHQgY29ubmVjdGVkIHdp
dGggRFBJIHBhbmVsDQorICogZGlyZWN0bHkuDQorICogICAgICAgX19fX19fX19fX19fX19fX19f
XyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfX19fX19fX18NCisgKiAgICAg
IHwgICAgICAgICAgICAtLS0tLS0tfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgICAgICAgIHwNCisgKiAgICAgIHwgIENSVEMwIC0tPiB8IERWTzAgLS0tLT4gRW5jb2RlcjAg
LS0tPiBDb25uZWN0b3IwIC0tLT4gfCBEaXNwbGF5IHwNCisgKiAgICAgIHwgIF8gICBfICAgICAt
LS0tLS0tfCAgICAgICAgXiAgICAgICAgICAgICBeICAgICAgICAgICAgfF9fX19fX19fX3wNCisg
KiAgICAgIHwgfCB8IHwgfCAgKy0tLS0tLSsgfCAgICAgICAgfCAgICAgICAgICAgICB8DQorICog
ICAgICB8IHxffCB8X3wgIHwgaTJjNiB8IDwtLS0tLS0tLSstLS0tLS0tLS0tLS0tKw0KKyAqICAg
ICAgfCAgICAgICAgICArLS0tLS0tKyB8DQorICogICAgICB8ICAgICAgICAgICAgICAgICAgIHwN
CisgKiAgICAgIHwgIERDIGluIExTN0ExMDAwICAgfA0KKyAqICAgICAgfCAgICAgICAgICAgICAg
ICAgICB8DQorICogICAgICB8ICBfICAgXyAgICstLS0tLS0rIHwNCisgKiAgICAgIHwgfCB8IHwg
fCAgfCBpMmM3IHwgPC0tLS0tLS0tKy0tLS0tLS0tLS0tLS0rDQorICogICAgICB8IHxffCB8X3wg
ICstLS0tLS0rIHwgICAgICAgIHwgICAgICAgICAgICAgfCAgICAgICAgICAgICBfX19fX19fX18N
CisgKiAgICAgIHwgICAgICAgICAgICAtLS0tLS0tfCAgICAgICAgfCAgICAgICAgICAgICB8ICAg
ICAgICAgICAgfCAgICAgICAgIHwNCisgKiAgICAgIHwgIENSVEMxIC0tPiB8IERWTzEgLS0tLT4g
RW5jb2RlcjEgLS0tPiBDb25uZWN0b3IxIC0tLT4gfCAgUGFuZWwgIHwNCisgKiAgICAgIHwgICAg
ICAgICAgICAtLS0tLS0tfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfF9fX19f
X19fX3wNCisgKiAgICAgIHxfX19fX19fX19fX19fX19fX19ffA0KKyAqDQorICogVGhlIGRpc3Bs
YXkgY29udHJvbGxlciBpbiBMUzdBMjAwMCBoYXMgdHdvIGRpc3BsYXkgcGlwZSwgeWV0IGl0IGhh
cw0KKyAqIGludGVncmF0ZWQgdGhyZWUgZW5jb2RlcnMsIGRpc3BsYXkgcGlwZSAwIGlzIGF0dGFj
aGVkIHdpdGggYSB0cmFuc3BhcmVudA0KKyAqIFZHQSBlbmNvZGVyIGFuZCBhIEhETUkgZW5jb2Rl
ciwgdGhleSBhcmUgcGFyYWxsZWwuIERpc3BsYXkgcGlwZSAxIGhhcw0KKyAqIG9ubHkgb25lIEhE
TUkgcGh5IGNvbm5lY3RlZC4NCisgKg0KKyAqICAgICAgIF9fX19fX19fX19fX19fX19fX19fX18g
ICAgICAgICAgICAgICAgICAgICAgICAgIF9fX19fX19fX19fX18NCisgKiAgICAgIHwgICAgICAg
ICAgICAgKy0tLS0tKyAgfCAgICAgICAgICAgICAgICAgICAgICAgIHwgICAgICAgICAgICAgfA0K
KyAqICAgICAgfCBDUlRDMCAtKy0tPiB8IFZHQSB8ICAtLS0tPiBWR0EgQ29ubmVjdG9yIC0tLT4g
fCBWR0EgTW9uaXRvciB8PC0tLSsNCisgKiAgICAgIHwgICAgICAgIHwgICAgKy0tLS0tKyAgfCAg
ICAgICAgICAgICAgICAgICAgICAgIHxfX19fX19fX19fX19ffCAgICB8DQorICogICAgICB8ICAg
ICAgICB8ICAgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgX19fX19fX19fX19f
X18gICAgfA0KKyAqICAgICAgfCAgICAgICAgfCAgICArLS0tLS0tKyB8ICAgICAgICAgICAgICAg
ICAgICAgICAgfCAgICAgICAgICAgICAgfCAgIHwNCisgKiAgICAgIHwgICAgICAgICstLT4gfCBI
RE1JIHwgLS0tLT4gSERNSSBDb25uZWN0b3IgLS0+IHwgSERNSSBNb25pdG9yIHw8LS0rDQorICog
ICAgICB8ICAgICAgICAgICAgICstLS0tLS0rIHwgICAgICAgICAgICAgICAgICAgICAgICB8X19f
X19fX19fX19fX198ICAgfA0KKyAqICAgICAgfCAgICAgICAgICAgICstLS0tLS0rICB8ICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCisgKiAgICAgIHwgICAgICAg
ICAgICB8IGkyYzYgfCAgPC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0rDQorICogICAgICB8ICAgICAgICAgICAgKy0tLS0tLSsgIHwNCisgKiAgICAgIHwgICAgICAg
ICAgICAgICAgICAgICAgfA0KKyAqICAgICAgfCAgICBEQyBpbiBMUzdBMjAwMCAgICB8DQorICog
ICAgICB8ICAgICAgICAgICAgICAgICAgICAgIHwNCisgKiAgICAgIHwgICAgICAgICAgICArLS0t
LS0tKyAgfA0KKyAqICAgICAgfCAgICAgICAgICAgIHwgaTJjNyB8ICA8LS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0rDQorICogICAgICB8ICAgICAgICAgICAgKy0tLS0tLSsgIHwgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwNCisgKiAgICAgIHwgICAgICAgICAgICAgICAg
ICAgICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgX19fX19ffF9fX19fX18NCisgKiAgICAg
IHwgICAgICAgICAgICArLS0tLS0tKyAgfCAgICAgICAgICAgICAgICAgICAgICAgICB8ICAgICAg
ICAgICAgICB8DQorICogICAgICB8IENSVEMxIC0tLT4gfCBIRE1JIHwgIC0tLS0+IEhETUkgQ29u
bmVjdG9yIC0tLT4gfCBIRE1JIE1vbml0b3IgfA0KKyAqICAgICAgfCAgICAgICAgICAgICstLS0t
LS0rICB8ICAgICAgICAgICAgICAgICAgICAgICAgIHxfX19fX19fX19fX19fX3wNCisgKiAgICAg
IHxfX19fX19fX19fX19fX19fX19fX19ffA0KKyAqDQorICoNCisgKiBUaGVyZSBpcyBvbmx5IGEg
MToxIG1hcHBpbmcgb2YgY3J0Y3MsIGVuY29kZXJzIGFuZCBjb25uZWN0b3JzIGZvciB0aGUgREMs
DQorICogZGlzcGxheSBwaXBlIDAgPSBjcnRjMCArIGR2bzAgKyBlbmNvZGVyMCArIGNvbm5lY3Rv
cjAgKyBjdXJzb3IwICsgcHJpbWFyeTANCisgKiBkaXNwbGF5IHBpcGUgMSA9IGNydGMxICsgZHZv
MSArIGVuY29kZXIxICsgY29ubmVjdHJvMSArIGN1cnNvcjEgKyBwcmltYXJ5MQ0KKyAqIEVhY2gg
Q1JUQyBoYXMgdHdvIEZCIGFkZHJlc3MgcmVnaXN0ZXJzLg0KKyAqDQorICogVGhlIERDIGluIExT
N0ExMDAwL0xTMksxMDAwIGhhcyB0aGUgcGNpIHZlbmRvci9kZXZpY2UgSUQ6IDB4MDAxNDoweDdh
MDYsDQorICogVGhlIERDIGluIExTN0EyMDAwL0xTMksyMDAwIGhhcyB0aGUgcGNpIHZlbmRvci9k
ZXZpY2UgSUQ6IDB4MDAxNDoweDdhMzYuDQorICoNCisgKiBUaGUgR1BVIGluIExTN0ExMDAwIGhh
cyB0aGUgcGNpIHZlbmRvci9kZXZpY2UgSUQ6IDB4MDAxNDoweDdhMTUsDQorICogVGhlIEdQVSBp
biBMUzdBMjAwMCBoYXMgdGhlIHBjaSB2ZW5kb3IvZGV2aWNlIElEOiAweDAwMTQ6MHg3YTI1Lg0K
KyAqDQorICogTFM3QTEwMDAvTFM3QTIwMDAgY2FuIG9ubHkgYmUgdXNlZCB3aXRoIGRlc2t0b3Ag
b3Igc2VydmVyIGNsYXNzIENQVXMsIHN1Y2gNCisgKiBhcyBMUzNBNDAwMCwgTFMzQTUwMDAgYW5k
IExTM0E2MDAwLiBUaHVzLCBDUFUgUFJJRCBjYW4gYmUgdXNlZCB0bw0KKyAqIGRpc3Rpbmd1aXNo
IExvb25nc29uIFNvQyBmcm9tIHRob3NlIHRoZSBkZXNrdG9wIGNsYXNzIENQVSBvbiB0aGUgcnVu
dGltZS4NCisgKi8NCitlbnVtIGxvb25nc29uX2NoaXBfaWQgew0KKwlDSElQX0xTN0ExMDAwID0g
MCwNCisJQ0hJUF9MUzdBMjAwMCA9IDEsDQorCUNISVBfTFNfTEFTVCwNCit9Ow0KKw0KK2NvbnN0
IHN0cnVjdCBsc2RjX2Rlc2MgKg0KK2xzZGNfZGV2aWNlX3Byb2JlKHN0cnVjdCBwY2lfZGV2ICpw
ZGV2LCBlbnVtIGxvb25nc29uX2NoaXBfaWQgY2hpcCk7DQorDQorc3RydWN0IGxzZGNfa21zX2Z1
bmNzOw0KKw0KKy8qIERDIHNwZWNpZmljICovDQorDQorc3RydWN0IGxzZGNfZGVzYyB7DQorCXUz
MiBudW1fb2ZfY3J0YzsNCisJdTMyIG1heF9waXhlbF9jbGs7DQorCXUzMiBtYXhfd2lkdGg7DQor
CXUzMiBtYXhfaGVpZ2h0Ow0KKwl1MzIgbnVtX29mX2h3X2N1cnNvcjsNCisJdTMyIGh3X2N1cnNv
cl93Ow0KKwl1MzIgaHdfY3Vyc29yX2g7DQorCXUzMiBwaXRjaF9hbGlnbjsgICAgICAgICAvKiBD
UlRDIERNQSBhbGlnbm1lbnQgY29uc3RyYWludCAqLw0KKwl1NjQgbWNfYml0czsgICAgICAgICAg
ICAgLyogcGh5c2ljYWwgYWRkcmVzcyBidXMgYml0IHdpZHRoICovDQorCWJvb2wgaGFzX3ZibGFu
a19jb3VudGVyOyAvKiAzMiBiaXQgaHcgdnN5bmMgY291bnRlciAqLw0KKw0KKwkvKiBkZXZpY2Ug
ZGVwZW5kZW50IG9wcywgZGMgc2lkZSAqLw0KKwljb25zdCBzdHJ1Y3QgbHNkY19rbXNfZnVuY3Mg
KmZ1bmNzOw0KK307DQorDQorLyogR0ZYIHJlbGF0ZWQgcmVzb3VyY2VzIHdyYW5nbGVyICovDQor
DQorc3RydWN0IGxvb25nc29uX2dmeF9kZXNjIHsNCisJc3RydWN0IGxzZGNfZGVzYyBkYzsNCisN
CisJdTMyIGNvbmZfcmVnX2Jhc2U7DQorDQorCS8qIEdGWFBMTCBzaGFyZWQgYnkgdGhlIERDLCBH
TUMgYW5kIEdQVSAqLw0KKwlzdHJ1Y3Qgew0KKwkJdTMyIHJlZ19vZmZzZXQ7DQorCQl1MzIgcmVn
X3NpemU7DQorCX0gZ2Z4cGxsOw0KKw0KKwkvKiBQaXhlbCBQTEwsIHBlciBkaXNwbGF5IHBpcGUg
Ki8NCisJc3RydWN0IHsNCisJCXUzMiByZWdfb2Zmc2V0Ow0KKwkJdTMyIHJlZ19zaXplOw0KKwl9
IHBpeHBsbFtMU0RDX05VTV9DUlRDXTsNCisNCisJZW51bSBsb29uZ3Nvbl9jaGlwX2lkIGNoaXBf
aWQ7DQorCWNoYXIgbW9kZWxbNjRdOw0KK307DQorDQorc3RhdGljIGlubGluZSBjb25zdCBzdHJ1
Y3QgbG9vbmdzb25fZ2Z4X2Rlc2MgKg0KK3RvX2xvb25nc29uX2dmeChjb25zdCBzdHJ1Y3QgbHNk
Y19kZXNjICpkY3ApDQorew0KKwlyZXR1cm4gY29udGFpbmVyX29mX2NvbnN0KGRjcCwgc3RydWN0
IGxvb25nc29uX2dmeF9kZXNjLCBkYyk7DQorfTsNCisNCitzdHJ1Y3QgbHNkY19yZWczMiB7DQor
CWNoYXIgKm5hbWU7DQorCXUzMiBvZmZzZXQ7DQorfTsNCisNCisvKiBjcnRjIGhhcmR3YXJlIHJl
bGF0ZWQgb3BzICovDQorDQorc3RydWN0IGxzZGNfY3J0YzsNCisNCitzdHJ1Y3QgbHNkY19jcnRj
X2h3X29wcyB7DQorCXZvaWQgKCplbmFibGUpKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisJ
dm9pZCAoKmRpc2FibGUpKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisJdm9pZCAoKmVuYWJs
ZV92YmxhbmspKHN0cnVjdCBsc2RjX2NydGMgKmxjcnRjKTsNCisJdm9pZCAoKmRpc2FibGVfdmJs
YW5rKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCpmbGlwKShzdHJ1Y3QgbHNk
Y19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCpjbG9uZSkoc3RydWN0IGxzZGNfY3J0YyAqbGNydGMp
Ow0KKwl2b2lkICgqZ2V0X3NjYW5fcG9zKShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0YywgaW50ICpo
cG9zLCBpbnQgKnZwb3MpOw0KKwl2b2lkICgqc2V0X21vZGUpKHN0cnVjdCBsc2RjX2NydGMgKmxj
cnRjLCBjb25zdCBzdHJ1Y3QgZHJtX2Rpc3BsYXlfbW9kZSAqbW9kZSk7DQorCXZvaWQgKCpzb2Z0
X3Jlc2V0KShzdHJ1Y3QgbHNkY19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCpyZXNldCkoc3RydWN0
IGxzZGNfY3J0YyAqbGNydGMpOw0KKw0KKwl1MzIgICgqZ2V0X3ZibGFua19jb3VudGVyKShzdHJ1
Y3QgbHNkY19jcnRjICpsY3J0Yyk7DQorCXZvaWQgKCpzZXRfZG1hX3N0ZXApKHN0cnVjdCBsc2Rj
X2NydGMgKmxjcnRjLCBlbnVtIGxzZGNfZG1hX3N0ZXBzIHN0ZXApOw0KK307DQorDQorc3RydWN0
IGxzZGNfY3J0YyB7DQorCXN0cnVjdCBkcm1fY3J0YyBiYXNlOw0KKwlzdHJ1Y3QgbHNkY19waXhw
bGwgcGl4cGxsOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXY7DQorCWNvbnN0IHN0cnVjdCBs
c2RjX2NydGNfaHdfb3BzICpod19vcHM7DQorCWNvbnN0IHN0cnVjdCBsc2RjX3JlZzMyICpwcmVn
Ow0KKwl1bnNpZ25lZCBpbnQgbnJlZzsNCisJc3RydWN0IGRybV9pbmZvX2xpc3QgKnBfaW5mb19s
aXN0Ow0KKwl1bnNpZ25lZCBpbnQgbl9pbmZvX2xpc3Q7DQorfTsNCisNCisvKiBwcmltYXJ5IHBs
YW5lIGhhcmR3YXJlIHJlbGF0ZWQgb3BzICovDQorDQorc3RydWN0IGxzZGNfcHJpbWFyeTsNCisN
CitzdHJ1Y3QgbHNkY19wcmltYXJ5X3BsYW5lX29wcyB7DQorCXZvaWQgKCp1cGRhdGVfZmJfYWRk
cikoc3RydWN0IGxzZGNfcHJpbWFyeSAqcGxhbmUsIHU2NCBhZGRyKTsNCisJdm9pZCAoKnVwZGF0
ZV9mYl9zdHJpZGUpKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnBsYW5lLCB1MzIgc3RyaWRlKTsNCisJ
dm9pZCAoKnVwZGF0ZV9mYl9mb3JtYXQpKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnBsYW5lLA0KKwkJ
CQkgY29uc3Qgc3RydWN0IGRybV9mb3JtYXRfaW5mbyAqZm9ybWF0KTsNCit9Ow0KKw0KK3N0cnVj
dCBsc2RjX3ByaW1hcnkgew0KKwlzdHJ1Y3QgZHJtX3BsYW5lIGJhc2U7DQorCWNvbnN0IHN0cnVj
dCBsc2RjX3ByaW1hcnlfcGxhbmVfb3BzICpvcHM7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
djsNCit9Ow0KKw0KKy8qIGN1cnNvciBwbGFuZSBoYXJkd2FyZSByZWxhdGVkIG9wcyAqLw0KKw0K
K3N0cnVjdCBsc2RjX2N1cnNvcjsNCisNCitzdHJ1Y3QgbHNkY19jdXJzb3JfcGxhbmVfb3BzIHsN
CisJdm9pZCAoKnVwZGF0ZV9ib19hZGRyKShzdHJ1Y3QgbHNkY19jdXJzb3IgKnBsYW5lLCB1NjQg
YWRkcik7DQorCXZvaWQgKCp1cGRhdGVfY2ZnKShzdHJ1Y3QgbHNkY19jdXJzb3IgKnBsYW5lLA0K
KwkJCSAgIGVudW0gbHNkY19jdXJzb3Jfc2l6ZSBjdXJzb3Jfc2l6ZSwNCisJCQkgICBlbnVtIGxz
ZGNfY3Vyc29yX2Zvcm1hdCk7DQorCXZvaWQgKCp1cGRhdGVfcG9zaXRpb24pKHN0cnVjdCBsc2Rj
X2N1cnNvciAqcGxhbmUsIGludCB4LCBpbnQgeSk7DQorfTsNCisNCitzdHJ1Y3QgbHNkY19jdXJz
b3Igew0KKwlzdHJ1Y3QgZHJtX3BsYW5lIGJhc2U7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2N1cnNv
cl9wbGFuZV9vcHMgKm9wczsNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2Ow0KK307DQorDQor
c3RydWN0IGxzZGNfb3V0cHV0IHsNCisJc3RydWN0IGRybV9lbmNvZGVyIGVuY29kZXI7DQorCXN0
cnVjdCBkcm1fY29ubmVjdG9yIGNvbm5lY3RvcjsNCit9Ow0KKw0KK3N0YXRpYyBpbmxpbmUgc3Ry
dWN0IGxzZGNfb3V0cHV0ICoNCitjb25uZWN0b3JfdG9fbHNkY19vdXRwdXQoc3RydWN0IGRybV9j
b25uZWN0b3IgKmNvbm5lY3RvcikNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoY29ubmVjdG9y
LCBzdHJ1Y3QgbHNkY19vdXRwdXQsIGNvbm5lY3Rvcik7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUg
c3RydWN0IGxzZGNfb3V0cHV0ICoNCitlbmNvZGVyX3RvX2xzZGNfb3V0cHV0KHN0cnVjdCBkcm1f
ZW5jb2RlciAqZW5jb2RlcikNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoZW5jb2Rlciwgc3Ry
dWN0IGxzZGNfb3V0cHV0LCBlbmNvZGVyKTsNCit9DQorDQorc3RydWN0IGxzZGNfZGlzcGxheV9w
aXBlIHsNCisJc3RydWN0IGxzZGNfY3J0YyBjcnRjOw0KKwlzdHJ1Y3QgbHNkY19wcmltYXJ5IHBy
aW1hcnk7DQorCXN0cnVjdCBsc2RjX2N1cnNvciBjdXJzb3I7DQorCXN0cnVjdCBsc2RjX291dHB1
dCBvdXRwdXQ7DQorCXN0cnVjdCBsc2RjX2kyYyAqbGkyYzsNCisJdW5zaWduZWQgaW50IGluZGV4
Ow0KK307DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKg0KK291
dHB1dF90b19kaXNwbGF5X3BpcGUoc3RydWN0IGxzZGNfb3V0cHV0ICpvdXRwdXQpDQorew0KKwly
ZXR1cm4gY29udGFpbmVyX29mKG91dHB1dCwgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlLCBvdXRw
dXQpOw0KK30NCisNCitzdHJ1Y3QgbHNkY19rbXNfZnVuY3Mgew0KKwlpcnFyZXR1cm5fdCAoKmly
cV9oYW5kbGVyKShpbnQgaXJxLCB2b2lkICphcmcpOw0KKw0KKwlpbnQgKCpjcmVhdGVfaTJjKShz
dHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgIHN0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZSAq
ZGlzcGlwZSwNCisJCQkgIHVuc2lnbmVkIGludCBpbmRleCk7DQorDQorCWludCAoKm91dHB1dF9p
bml0KShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICBzdHJ1Y3QgbHNkY19kaXNwbGF5
X3BpcGUgKmRpc3BpcGUsDQorCQkJICAgc3RydWN0IGkyY19hZGFwdGVyICpkZGMsDQorCQkJICAg
dW5zaWduZWQgaW50IGluZGV4KTsNCisNCisJaW50ICgqY3Vyc29yX3BsYW5lX2luaXQpKHN0cnVj
dCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCQkgc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJ
CSB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0KKwlpbnQgKCpwcmltYXJ5X3BsYW5lX2luaXQpKHN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCQkgIHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0K
KwkJCQkgIHVuc2lnbmVkIGludCBpbmRleCk7DQorDQorCWludCAoKmNydGNfaW5pdCkoc3RydWN0
IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJIHN0cnVjdCBkcm1fY3J0YyAqY3J0YywNCisJCQkgc3Ry
dWN0IGRybV9wbGFuZSAqcHJpbWFyeSwNCisJCQkgc3RydWN0IGRybV9wbGFuZSAqY3Vyc29yLA0K
KwkJCSB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KK307DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3Qg
bHNkY19jcnRjICoNCit0b19sc2RjX2NydGMoc3RydWN0IGRybV9jcnRjICpjcnRjKQ0KK3sNCisJ
cmV0dXJuIGNvbnRhaW5lcl9vZihjcnRjLCBzdHJ1Y3QgbHNkY19jcnRjLCBiYXNlKTsNCit9DQor
DQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKg0KK2NydGNfdG9fZGlz
cGxheV9waXBlKHN0cnVjdCBkcm1fY3J0YyAqY3J0YykNCit7DQorCXJldHVybiBjb250YWluZXJf
b2YoY3J0Yywgc3RydWN0IGxzZGNfZGlzcGxheV9waXBlLCBjcnRjLmJhc2UpOw0KK30NCisNCitz
dGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX3ByaW1hcnkgKg0KK3RvX2xzZGNfcHJpbWFyeShzdHJ1
Y3QgZHJtX3BsYW5lICpwbGFuZSkNCit7DQorCXJldHVybiBjb250YWluZXJfb2YocGxhbmUsIHN0
cnVjdCBsc2RjX3ByaW1hcnksIGJhc2UpOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBs
c2RjX2N1cnNvciAqDQordG9fbHNkY19jdXJzb3Ioc3RydWN0IGRybV9wbGFuZSAqcGxhbmUpDQor
ew0KKwlyZXR1cm4gY29udGFpbmVyX29mKHBsYW5lLCBzdHJ1Y3QgbHNkY19jdXJzb3IsIGJhc2Up
Ow0KK30NCisNCitzdHJ1Y3QgbHNkY19jcnRjX3N0YXRlIHsNCisJc3RydWN0IGRybV9jcnRjX3N0
YXRlIGJhc2U7DQorCXN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyBwcGFybXM7DQorfTsNCisNCitz
dHJ1Y3QgbHNkY19nZW0gew0KKwkvKiBAbXV0ZXg6IHByb3RlY3Qgb2JqZWN0cyBsaXN0ICovDQor
CXN0cnVjdCBtdXRleCBtdXRleDsNCisJc3RydWN0IGxpc3RfaGVhZCBvYmplY3RzOw0KK307DQor
DQorc3RydWN0IGxzZGNfZGV2aWNlIHsNCisJc3RydWN0IGRybV9kZXZpY2UgYmFzZTsNCisJc3Ry
dWN0IHR0bV9kZXZpY2UgYmRldjsNCisNCisJLyogQGRlc2NwOiBmZWF0dXJlcyBkZXNjcmlwdGlv
biBvZiB0aGUgREMgdmFyaWFudCAqLw0KKwljb25zdCBzdHJ1Y3QgbHNkY19kZXNjICpkZXNjcDsN
CisJc3RydWN0IHBjaV9kZXYgKmRjOw0KKwlzdHJ1Y3QgcGNpX2RldiAqZ3B1Ow0KKw0KKwlzdHJ1
Y3QgbG9vbmdzb25fZ2Z4cGxsICpnZnhwbGw7DQorDQorCS8qIEByZWdsb2NrOiBwcm90ZWN0cyBj
b25jdXJyZW50IGFjY2VzcyAqLw0KKwlzcGlubG9ja190IHJlZ2xvY2s7DQorDQorCXZvaWQgX19p
b21lbSAqcmVnX2Jhc2U7DQorCXJlc291cmNlX3NpemVfdCB2cmFtX2Jhc2U7DQorCXJlc291cmNl
X3NpemVfdCB2cmFtX3NpemU7DQorDQorCXJlc291cmNlX3NpemVfdCBndHRfYmFzZTsNCisJcmVz
b3VyY2Vfc2l6ZV90IGd0dF9zaXplOw0KKw0KKwlzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgZGlz
cGlwZVtMU0RDX05VTV9DUlRDXTsNCisNCisJc3RydWN0IGxzZGNfZ2VtIGdlbTsNCisNCisJdTMy
IGlycV9zdGF0dXM7DQorDQorCS8qIHRyYWNraW5nIHBpbm5lZCBtZW1vcnkgKi8NCisJc2l6ZV90
IHZyYW1fcGlubmVkX3NpemU7DQorCXNpemVfdCBndHRfcGlubmVkX3NpemU7DQorDQorCS8qIEBu
dW1fb3V0cHV0OiBjb3VudCB0aGUgbnVtYmVyIG9mIGFjdGl2ZSBkaXNwbGF5IHBpcGUgKi8NCisJ
dW5zaWduZWQgaW50IG51bV9vdXRwdXQ7DQorfTsNCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBs
c2RjX2RldmljZSAqdGRldl90b19sZGV2KHN0cnVjdCB0dG1fZGV2aWNlICpiZGV2KQ0KK3sNCisJ
cmV0dXJuIGNvbnRhaW5lcl9vZihiZGV2LCBzdHJ1Y3QgbHNkY19kZXZpY2UsIGJkZXYpOw0KK30N
CisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX2RldmljZSAqdG9fbHNkYyhzdHJ1Y3QgZHJt
X2RldmljZSAqZGRldikNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoZGRldiwgc3RydWN0IGxz
ZGNfZGV2aWNlLCBiYXNlKTsNCit9DQorDQorc3RhdGljIGlubGluZSBzdHJ1Y3QgbHNkY19jcnRj
X3N0YXRlICoNCit0b19sc2RjX2NydGNfc3RhdGUoc3RydWN0IGRybV9jcnRjX3N0YXRlICpiYXNl
KQ0KK3sNCisJcmV0dXJuIGNvbnRhaW5lcl9vZihiYXNlLCBzdHJ1Y3QgbHNkY19jcnRjX3N0YXRl
LCBiYXNlKTsNCit9DQorDQordm9pZCBsc2RjX2RlYnVnZnNfaW5pdChzdHJ1Y3QgZHJtX21pbm9y
ICptaW5vcik7DQorDQoraW50IGxzN2ExMDAwX2NydGNfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGRldiwNCisJCSAgICAgICBzdHJ1Y3QgZHJtX2NydGMgKmNydGMsDQorCQkgICAgICAgc3RydWN0
IGRybV9wbGFuZSAqcHJpbWFyeSwNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpjdXJzb3Is
DQorCQkgICAgICAgdW5zaWduZWQgaW50IGluZGV4KTsNCisNCitpbnQgbHM3YTIwMDBfY3J0Y19p
bml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJICAgICAgIHN0cnVjdCBkcm1fY3J0YyAq
Y3J0YywNCisJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwcmltYXJ5LA0KKwkJICAgICAgIHN0
cnVjdCBkcm1fcGxhbmUgKmN1cnNvciwNCisJCSAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpOw0K
Kw0KK2ludCBsc2RjX3ByaW1hcnlfcGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwN
CisJCQkgICAgc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJICAgIHVuc2lnbmVkIGludCBp
bmRleCk7DQorDQoraW50IGxzN2ExMDAwX2N1cnNvcl9wbGFuZV9pbml0KHN0cnVjdCBkcm1fZGV2
aWNlICpkZGV2LA0KKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkgICAg
ICAgdW5zaWduZWQgaW50IGluZGV4KTsNCisNCitpbnQgbHM3YTIwMDBfY3Vyc29yX3BsYW5lX2lu
aXQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICAgICAgIHN0cnVjdCBkcm1fcGxhbmUg
KnBsYW5lLA0KKwkJCSAgICAgICB1bnNpZ25lZCBpbnQgaW5kZXgpOw0KKw0KKy8qIHJlZ2lzdGVy
cyBhY2Nlc3MgaGVscGVycyAqLw0KKw0KK3N0YXRpYyBpbmxpbmUgdTMyIGxzZGNfcnJlZzMyKHN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiwgdTMyIG9mZnNldCkNCit7DQorCXJldHVybiByZWFkbChs
ZGV2LT5yZWdfYmFzZSArIG9mZnNldCk7DQorfQ0KKw0KK3N0YXRpYyBpbmxpbmUgdm9pZCBsc2Rj
X3dyZWczMihzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsIHUzMiBvZmZzZXQsIHUzMiB2YWwpDQor
ew0KKwl3cml0ZWwodmFsLCBsZGV2LT5yZWdfYmFzZSArIG9mZnNldCk7DQorfQ0KKw0KK3N0YXRp
YyBpbmxpbmUgdm9pZCBsc2RjX3VyZWczMl9zZXQoc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2LA0K
KwkJCQkgICB1MzIgb2Zmc2V0LA0KKwkJCQkgICB1MzIgbWFzaykNCit7DQorCXZvaWQgX19pb21l
bSAqYWRkciA9IGxkZXYtPnJlZ19iYXNlICsgb2Zmc2V0Ow0KKwl1MzIgdmFsID0gcmVhZGwoYWRk
cik7DQorDQorCXdyaXRlbCh2YWwgfCBtYXNrLCBhZGRyKTsNCit9DQorDQorc3RhdGljIGlubGlu
ZSB2b2lkIGxzZGNfdXJlZzMyX2NscihzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQorCQkJCSAg
IHUzMiBvZmZzZXQsDQorCQkJCSAgIHUzMiBtYXNrKQ0KK3sNCisJdm9pZCBfX2lvbWVtICphZGRy
ID0gbGRldi0+cmVnX2Jhc2UgKyBvZmZzZXQ7DQorCXUzMiB2YWwgPSByZWFkbChhZGRyKTsNCisN
CisJd3JpdGVsKHZhbCAmIH5tYXNrLCBhZGRyKTsNCit9DQorDQorc3RhdGljIGlubGluZSB1MzIg
bHNkY19waXBlX3JyZWczMihzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQorCQkJCSAgIHUzMiBv
ZmZzZXQsDQorCQkJCSAgIHUzMiBwaXBlKQ0KK3sNCisJcmV0dXJuIHJlYWRsKGxkZXYtPnJlZ19i
YXNlICsgb2Zmc2V0ICsgcGlwZSAqIENSVENfUElQRV9PRkZTRVQpOw0KK30NCisNCitzdGF0aWMg
aW5saW5lIHZvaWQgbHNkY19waXBlX3dyZWczMihzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYsDQor
CQkJCSAgICB1MzIgb2Zmc2V0LA0KKwkJCQkgICAgdTMyIHBpcGUsDQorCQkJCSAgICB1MzIgdmFs
KQ0KK3sNCisJd3JpdGVsKHZhbCwgbGRldi0+cmVnX2Jhc2UgKyBvZmZzZXQgKyBwaXBlICogQ1JU
Q19QSVBFX09GRlNFVCk7DQorfQ0KKw0KKyNlbmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
Z2VtLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmYyMTk0MmIy
YTNiOA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNf
Z2VtLmMNCkBAIC0wLDAgKzEsMzI0IEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjArDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBD
b3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4N
CisNCisjaW5jbHVkZSA8ZHJtL2RybV9kZWJ1Z2ZzLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZmls
ZS5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbS5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW1l
Lmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfZ2VtLmgiDQor
I2luY2x1ZGUgImxzZGNfdHRtLmgiDQorDQorc3RhdGljIGludCBsc2RjX2dlbV9wcmltZV9waW4o
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopDQorew0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvID0g
Z2VtX3RvX2xzZGNfYm8ob2JqKTsNCisJaW50IHJldDsNCisNCisJcmV0ID0gbHNkY19ib19yZXNl
cnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKQ0KKwkJcmV0dXJuIHJldDsNCisNCisJcmV0
ID0gbHNkY19ib19waW4obGJvLCBMU0RDX0dFTV9ET01BSU5fR1RULCBOVUxMKTsNCisJaWYgKGxp
a2VseShyZXQgPT0gMCkpDQorCQlsYm8tPnNoYXJpbmdfY291bnQrKzsNCisNCisJbHNkY19ib191
bnJlc2VydmUobGJvKTsNCisNCisJcmV0dXJuIHJldDsNCit9DQorDQorc3RhdGljIHZvaWQgbHNk
Y19nZW1fcHJpbWVfdW5waW4oc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopDQorew0KKwlzdHJ1
Y3QgbHNkY19ibyAqbGJvID0gZ2VtX3RvX2xzZGNfYm8ob2JqKTsNCisJaW50IHJldDsNCisNCisJ
cmV0ID0gbHNkY19ib19yZXNlcnZlKGxibyk7DQorCWlmICh1bmxpa2VseShyZXQpKQ0KKwkJcmV0
dXJuOw0KKw0KKwlsc2RjX2JvX3VucGluKGxibyk7DQorCWlmIChsYm8tPnNoYXJpbmdfY291bnQp
DQorCQlsYm8tPnNoYXJpbmdfY291bnQtLTsNCisNCisJbHNkY19ib191bnJlc2VydmUobGJvKTsN
Cit9DQorDQorc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqbHNkY19nZW1fcHJpbWVfZ2V0X3NnX3Rh
YmxlKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKQ0KK3sNCisJc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICp0Ym8gPSB0b190dG1fYm8ob2JqKTsNCisJc3RydWN0IHR0bV90dCAqdHQgPSB0Ym8t
PnR0bTsNCisNCisJaWYgKCF0dCkgew0KKwkJZHJtX2VycihvYmotPmRldiwgInNoYXJpbmcgYSBi
dWZmZXIgd2l0aG91dCBiYWNraW5nIG1lbW9yeVxuIik7DQorCQlyZXR1cm4gRVJSX1BUUigtRU5P
TUVNKTsNCisJfQ0KKw0KKwlyZXR1cm4gZHJtX3ByaW1lX3BhZ2VzX3RvX3NnKG9iai0+ZGV2LCB0
dC0+cGFnZXMsIHR0LT5udW1fcGFnZXMpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2dlbV9v
YmplY3RfZnJlZShzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikNCit7DQorCXN0cnVjdCB0dG1f
YnVmZmVyX29iamVjdCAqdGJvID0gdG9fdHRtX2JvKG9iaik7DQorDQorCWlmICh0Ym8pDQorCQl0
dG1fYm9fcHV0KHRibyk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19nZW1fb2JqZWN0X3ZtYXAo
c3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosDQorCQkJCXN0cnVjdCBpb3N5c19tYXAgKm1hcCkN
Cit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gdG9fdHRtX2JvKG9iaik7DQor
CXN0cnVjdCBsc2RjX2JvICpsYm8gPSB0b19sc2RjX2JvKHRibyk7DQorCWludCByZXQ7DQorDQor
CWlmIChsYm8tPnZtYXBfY291bnQgPiAwKSB7DQorCQkrK2xiby0+dm1hcF9jb3VudDsNCisJCWdv
dG8gb3V0Ow0KKwl9DQorDQorCXJldCA9IGxzZGNfYm9fcGluKGxibywgMCwgTlVMTCk7DQorCWlm
ICh1bmxpa2VseShyZXQpKSB7DQorCQlkcm1fZXJyKG9iai0+ZGV2LCAicGluICVwIGZvciB2bWFw
IGZhaWxlZFxuIiwgbGJvKTsNCisJCXJldHVybiByZXQ7DQorCX0NCisNCisJcmV0ID0gdHRtX2Jv
X3ZtYXAodGJvLCAmbGJvLT5tYXApOw0KKwlpZiAocmV0KSB7DQorCQlkcm1fZXJyKG9iai0+ZGV2
LCAidHRtIGJvIHZtYXAgZmFpbGVkXG4iKTsNCisJCWxzZGNfYm9fdW5waW4obGJvKTsNCisJCXJl
dHVybiByZXQ7DQorCX0NCisNCisJbGJvLT52bWFwX2NvdW50ID0gMTsNCisNCitvdXQ6DQorCSpt
YXAgPSBsYm8tPm1hcDsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNf
Z2VtX29iamVjdF92dW5tYXAoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmosDQorCQkJCSAgIHN0
cnVjdCBpb3N5c19tYXAgKm1hcCkNCit7DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJv
ID0gdG9fdHRtX2JvKG9iaik7DQorCXN0cnVjdCBsc2RjX2JvICpsYm8gPSB0b19sc2RjX2JvKHRi
byk7DQorDQorCWlmICh1bmxpa2VseSghbGJvLT52bWFwX2NvdW50KSkgew0KKwkJZHJtX3dhcm4o
b2JqLT5kZXYsICIlcCBpcyBub3QgbWFwcGVkXG4iLCBsYm8pOw0KKwkJcmV0dXJuOw0KKwl9DQor
DQorCS0tbGJvLT52bWFwX2NvdW50Ow0KKwlpZiAobGJvLT52bWFwX2NvdW50ID09IDApIHsNCisJ
CXR0bV9ib192dW5tYXAodGJvLCAmbGJvLT5tYXApOw0KKw0KKwkJbHNkY19ib191bnBpbihsYm8p
Ow0KKwl9DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19nZW1fb2JqZWN0X21tYXAoc3RydWN0IGRy
bV9nZW1fb2JqZWN0ICpvYmosDQorCQkJCXN0cnVjdCB2bV9hcmVhX3N0cnVjdCAqdm1hKQ0KK3sN
CisJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8gPSB0b190dG1fYm8ob2JqKTsNCisJaW50
IHJldDsNCisNCisJcmV0ID0gdHRtX2JvX21tYXBfb2JqKHZtYSwgdGJvKTsNCisJaWYgKHVubGlr
ZWx5KHJldCkpIHsNCisJCWRybV93YXJuKG9iai0+ZGV2LCAibW1hcCAlcCBmYWlsZWRcbiIsIHRi
byk7DQorCQlyZXR1cm4gcmV0Ow0KKwl9DQorDQorCWRybV9nZW1fb2JqZWN0X3B1dChvYmopOw0K
Kw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBkcm1fZ2VtX29iamVj
dF9mdW5jcyBsc2RjX2dlbV9vYmplY3RfZnVuY3MgPSB7DQorCS5mcmVlID0gbHNkY19nZW1fb2Jq
ZWN0X2ZyZWUsDQorCS5leHBvcnQgPSBkcm1fZ2VtX3ByaW1lX2V4cG9ydCwNCisJLnBpbiA9IGxz
ZGNfZ2VtX3ByaW1lX3BpbiwNCisJLnVucGluID0gbHNkY19nZW1fcHJpbWVfdW5waW4sDQorCS5n
ZXRfc2dfdGFibGUgPSBsc2RjX2dlbV9wcmltZV9nZXRfc2dfdGFibGUsDQorCS52bWFwID0gbHNk
Y19nZW1fb2JqZWN0X3ZtYXAsDQorCS52dW5tYXAgPSBsc2RjX2dlbV9vYmplY3RfdnVubWFwLA0K
KwkubW1hcCA9IGxzZGNfZ2VtX29iamVjdF9tbWFwLA0KK307DQorDQorc3RydWN0IGRybV9nZW1f
b2JqZWN0ICoNCitsc2RjX2dlbV9vYmplY3RfY3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2
LA0KKwkJICAgICAgIHUzMiBkb21haW4sDQorCQkgICAgICAgc2l6ZV90IHNpemUsDQorCQkgICAg
ICAgYm9vbCBrZXJlbmwsDQorCQkgICAgICAgc3RydWN0IHNnX3RhYmxlICpzZywNCisJCSAgICAg
ICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYg
PSB0b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdvYmo7DQorCXN0cnVj
dCBsc2RjX2JvICpsYm87DQorCWludCByZXQ7DQorDQorCWxibyA9IGxzZGNfYm9fY3JlYXRlKGRk
ZXYsIGRvbWFpbiwgc2l6ZSwga2VyZW5sLCBzZywgcmVzdik7DQorCWlmIChJU19FUlIobGJvKSkg
ew0KKwkJcmV0ID0gUFRSX0VSUihsYm8pOw0KKwkJcmV0dXJuIEVSUl9QVFIocmV0KTsNCisJfQ0K
Kw0KKwkvKiBWUkFNIGlzIGZpbGxlZCB3aXRoIHJhbmRvbSBkYXRhICovDQorCWxzZGNfYm9fY2xl
YXIobGJvKTsNCisNCisJZ29iaiA9ICZsYm8tPnRiby5iYXNlOw0KKwlnb2JqLT5mdW5jcyA9ICZs
c2RjX2dlbV9vYmplY3RfZnVuY3M7DQorDQorCS8qIHRyYWNraW5nIHRoZSBCT3Mgd2UgY3JlYXRl
ZCAqLw0KKwltdXRleF9sb2NrKCZsZGV2LT5nZW0ubXV0ZXgpOw0KKwlsaXN0X2FkZF90YWlsKCZs
Ym8tPmxpc3QsICZsZGV2LT5nZW0ub2JqZWN0cyk7DQorCW11dGV4X3VubG9jaygmbGRldi0+Z2Vt
Lm11dGV4KTsNCisNCisJcmV0dXJuIGdvYmo7DQorfQ0KKw0KK3N0cnVjdCBkcm1fZ2VtX29iamVj
dCAqDQorbHNkY19wcmltZV9pbXBvcnRfc2dfdGFibGUoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYs
DQorCQkJICAgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoLA0KKwkJCSAgIHN0cnVj
dCBzZ190YWJsZSAqc2cpDQorew0KKwlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YgPSBhdHRhY2gtPmRt
YWJ1Zi0+cmVzdjsNCisJdTY0IHNpemUgPSBhdHRhY2gtPmRtYWJ1Zi0+c2l6ZTsNCisJc3RydWN0
IGRybV9nZW1fb2JqZWN0ICpnb2JqOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvOw0KKw0KKwlkbWFf
cmVzdl9sb2NrKHJlc3YsIE5VTEwpOw0KKwlnb2JqID0gbHNkY19nZW1fb2JqZWN0X2NyZWF0ZShk
ZGV2LCBMU0RDX0dFTV9ET01BSU5fR1RULCBzaXplLCBmYWxzZSwNCisJCQkJICAgICAgc2csIHJl
c3YpOw0KKwlkbWFfcmVzdl91bmxvY2socmVzdik7DQorDQorCWlmIChJU19FUlIoZ29iaikpIHsN
CisJCWRybV9lcnIoZGRldiwgIkZhaWxlZCB0byBpbXBvcnQgc2cgdGFibGVcbiIpOw0KKwkJcmV0
dXJuIGdvYmo7DQorCX0NCisNCisJbGJvID0gZ2VtX3RvX2xzZGNfYm8oZ29iaik7DQorCWxiby0+
c2hhcmluZ19jb3VudCA9IDE7DQorDQorCXJldHVybiBnb2JqOw0KK30NCisNCitpbnQgbHNkY19k
dW1iX2NyZWF0ZShzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsDQorCQkgICAgIHN0cnVjdCBkcm1fZGV2
aWNlICpkZGV2LA0KKwkJICAgICBzdHJ1Y3QgZHJtX21vZGVfY3JlYXRlX2R1bWIgKmFyZ3MpDQor
ew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwljb25zdCBz
dHJ1Y3QgbHNkY19kZXNjICpkZXNjcCA9IGxkZXYtPmRlc2NwOw0KKwl1MzIgZG9tYWluID0gTFNE
Q19HRU1fRE9NQUlOX1ZSQU07DQorCXN0cnVjdCBkcm1fZ2VtX29iamVjdCAqZ29iajsNCisJc2l6
ZV90IHNpemU7DQorCXUzMiBwaXRjaDsNCisJdTMyIGhhbmRsZTsNCisJaW50IHJldDsNCisNCisJ
aWYgKCFhcmdzLT53aWR0aCB8fCAhYXJncy0+aGVpZ2h0KQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQor
DQorCS8qIExvb25nc29uIGRpYXBsYXkgY29udHJvbGxlciBvbmx5IHN1cHBvcnQgMzItYml0IGFu
ZCAxNi1iaXQgRkIgKi8NCisJaWYgKGFyZ3MtPmJwcCAhPSAzMiAmJiBhcmdzLT5icHAgIT0gMTYp
DQorCQlyZXR1cm4gLUVJTlZBTDsNCisNCisJcGl0Y2ggPSBhcmdzLT53aWR0aCAqIGFyZ3MtPmJw
cCAvIDg7DQorCXBpdGNoID0gQUxJR04ocGl0Y2gsIGRlc2NwLT5waXRjaF9hbGlnbik7DQorCXNp
emUgPSBwaXRjaCAqIGFyZ3MtPmhlaWdodDsNCisJc2l6ZSA9IEFMSUdOKHNpemUsIFBBR0VfU0la
RSk7DQorDQorCS8qIE1heGltdW0gYm8gc2l6ZSBhbGxvd2VkIGlzIHRoZSBoYWxmIHZyYW0gc2l6
ZSBhdmFpbGFibGUgKi8NCisJaWYgKHNpemUgPiBsZGV2LT52cmFtX3NpemUgLyAyKSB7DQorCQlk
cm1fZXJyKGRkZXYsICJSZXF1ZXN0aW5nKCV6dU1CKSBtb3JlIHRoYW4gb3duZWQoJXVNQilcbiIs
DQorCQkJc2l6ZSA+PiAyMCwgKHUzMikobGRldi0+dnJhbV9zaXplID4+IDIwKSk7DQorCQlyZXR1
cm4gLUVOT01FTTsNCisJfQ0KKw0KKwlnb2JqID0gbHNkY19nZW1fb2JqZWN0X2NyZWF0ZShkZGV2
LA0KKwkJCQkgICAgICBkb21haW4sDQorCQkJCSAgICAgIHNpemUsDQorCQkJCSAgICAgIGZhbHNl
LA0KKwkJCQkgICAgICBOVUxMLA0KKwkJCQkgICAgICBOVUxMKTsNCisJaWYgKElTX0VSUihnb2Jq
KSkgew0KKwkJZHJtX2VycihkZGV2LCAiRmFpbGVkIHRvIGNyZWF0ZSBnZW0gb2JqZWN0XG4iKTsN
CisJCXJldHVybiBQVFJfRVJSKGdvYmopOw0KKwl9DQorDQorCXJldCA9IGRybV9nZW1faGFuZGxl
X2NyZWF0ZShmaWxlLCBnb2JqLCAmaGFuZGxlKTsNCisNCisJLyogZHJvcCByZWZlcmVuY2UgZnJv
bSBhbGxvY2F0ZSwgaGFuZGxlIGhvbGRzIGl0IG5vdyAqLw0KKwlkcm1fZ2VtX29iamVjdF9wdXQo
Z29iaik7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlhcmdzLT5waXRjaCA9IHBp
dGNoOw0KKwlhcmdzLT5zaXplID0gc2l6ZTsNCisJYXJncy0+aGFuZGxlID0gaGFuZGxlOw0KKw0K
KwlyZXR1cm4gMDsNCit9DQorDQoraW50IGxzZGNfZHVtYl9tYXBfb2Zmc2V0KHN0cnVjdCBkcm1f
ZmlsZSAqZmlscCwNCisJCQkgc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJIHUzMiBoYW5k
bGUsDQorCQkJIHVpbnQ2NF90ICpvZmZzZXQpDQorew0KKwlzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
KmdvYmo7DQorDQorCWdvYmogPSBkcm1fZ2VtX29iamVjdF9sb29rdXAoZmlscCwgaGFuZGxlKTsN
CisJaWYgKCFnb2JqKQ0KKwkJcmV0dXJuIC1FTk9FTlQ7DQorDQorCSpvZmZzZXQgPSBkcm1fdm1h
X25vZGVfb2Zmc2V0X2FkZHIoJmdvYmotPnZtYV9ub2RlKTsNCisNCisJZHJtX2dlbV9vYmplY3Rf
cHV0KGdvYmopOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQordm9pZCBsc2RjX2dlbV9pbml0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZGV2KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
dG9fbHNkYyhkZGV2KTsNCisNCisJbXV0ZXhfaW5pdCgmbGRldi0+Z2VtLm11dGV4KTsNCisJSU5J
VF9MSVNUX0hFQUQoJmxkZXYtPmdlbS5vYmplY3RzKTsNCit9DQorDQoraW50IGxzZGNfc2hvd19i
dWZmZXJfb2JqZWN0KHN0cnVjdCBzZXFfZmlsZSAqbSwgdm9pZCAqYXJnKQ0KK3sNCisJc3RydWN0
IGRybV9pbmZvX25vZGUgKm5vZGUgPSAoc3RydWN0IGRybV9pbmZvX25vZGUgKiltLT5wcml2YXRl
Ow0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9IG5vZGUtPm1pbm9yLT5kZXY7DQorCXN0cnVj
dCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCXN0cnVjdCBsc2RjX2JvICps
Ym87DQorCXVuc2lnbmVkIGludCBpOw0KKw0KKwltdXRleF9sb2NrKCZsZGV2LT5nZW0ubXV0ZXgp
Ow0KKw0KKwlpID0gMDsNCisNCisJbGlzdF9mb3JfZWFjaF9lbnRyeShsYm8sICZsZGV2LT5nZW0u
b2JqZWN0cywgbGlzdCkgew0KKwkJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8gPSAmbGJv
LT50Ym87DQorCQlzdHJ1Y3QgdHRtX3Jlc291cmNlICpyZXNvdXJjZSA9IHRiby0+cmVzb3VyY2U7
DQorDQorCQlzZXFfcHJpbnRmKG0sICJib1slMDR1XVslcF06IHNpemU6ICU4enUgS0IgJXMgb2Zm
c2V0OiAlOGxseFxuIiwNCisJCQkgICBpLCBsYm8sDQorCQkJICAgbHNkY19ib19zaXplKGxibykg
Pj4gMTAsDQorCQkJICAgbHNkY19tZW1fdHlwZV90b19zdHIocmVzb3VyY2UtPm1lbV90eXBlKSwN
CisJCQkgICBsc2RjX2JvX2dwdV9vZmZzZXQobGJvKSk7DQorCQlpKys7DQorCX0NCisNCisJbXV0
ZXhfdW5sb2NrKCZsZGV2LT5nZW0ubXV0ZXgpOw0KKw0KKwlzZXFfcHJpbnRmKG0sICJQaW5uZWQg
Qk8gc2l6ZTogVlJBTTogJXp1IEtCLCBHVFQ6ICV6dSBLQlxuIiwNCisJCSAgIGxkZXYtPnZyYW1f
cGlubmVkX3NpemUgPj4gMTAsIGxkZXYtPmd0dF9waW5uZWRfc2l6ZSA+PiAxMCk7DQorDQorCXJl
dHVybiAwOw0KK30NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19n
ZW0uaCBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5oDQpuZXcgZmlsZSBtb2Rl
IDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi43ZTA1ZTQ1M2I3MzMNCi0tLSAvZGV2L251bGwN
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dlbS5oDQpAQCAtMCwwICsxLDM3
IEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCisvKg0KKyAqIENv
cHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQN
CisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19HRU1fSF9fDQorI2RlZmluZSBfX0xTRENfR0VNX0hf
Xw0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2RldmljZS5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2dl
bS5oPg0KKw0KK3N0cnVjdCBkcm1fZ2VtX29iamVjdCAqDQorbHNkY19wcmltZV9pbXBvcnRfc2df
dGFibGUoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJICAgc3RydWN0IGRtYV9idWZfYXR0
YWNobWVudCAqYXR0YWNoLA0KKwkJCSAgIHN0cnVjdCBzZ190YWJsZSAqc2cpOw0KKw0KK2ludCBs
c2RjX2R1bWJfbWFwX29mZnNldChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsDQorCQkJIHN0cnVjdCBk
cm1fZGV2aWNlICpkZXYsDQorCQkJIHUzMiBoYW5kbGUsDQorCQkJIHVpbnQ2NF90ICpvZmZzZXQp
Ow0KKw0KK2ludCBsc2RjX2R1bWJfY3JlYXRlKHN0cnVjdCBkcm1fZmlsZSAqZmlsZSwNCisJCSAg
ICAgc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkgICAgIHN0cnVjdCBkcm1fbW9kZV9jcmVh
dGVfZHVtYiAqYXJncyk7DQorDQordm9pZCBsc2RjX2dlbV9pbml0KHN0cnVjdCBkcm1fZGV2aWNl
ICpkZGV2KTsNCitpbnQgbHNkY19zaG93X2J1ZmZlcl9vYmplY3Qoc3RydWN0IHNlcV9maWxlICpt
LCB2b2lkICphcmcpOw0KKw0KK3N0cnVjdCBkcm1fZ2VtX29iamVjdCAqDQorbHNkY19nZW1fb2Jq
ZWN0X2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCSAgICAgICB1MzIgZG9tYWlu
LA0KKwkJICAgICAgIHNpemVfdCBzaXplLA0KKwkJICAgICAgIGJvb2wga2VyZW5sLA0KKwkJICAg
ICAgIHN0cnVjdCBzZ190YWJsZSAqc2csDQorCQkgICAgICAgc3RydWN0IGRtYV9yZXN2ICpyZXN2
KTsNCisNCisjZW5kaWYNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y19nZnhwbGwuYyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dmeHBsbC5jDQpuZXcg
ZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi45NzdiMTJkY2I3M2MNCi0tLSAv
ZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dmeHBsbC5jDQpA
QCAtMCwwICsxLDE5OSBAQA0KKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wDQor
LyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlv
biBMaW1pdGVkDQorICovDQorDQorI2luY2x1ZGUgPGxpbnV4L2RlbGF5Lmg+DQorDQorI2luY2x1
ZGUgPGRybS9kcm1fZmlsZS5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX21hbmFnZWQuaD4NCisjaW5j
bHVkZSA8ZHJtL2RybV9wcmludC5oPg0KKw0KKyNpbmNsdWRlICJsc2RjX2Rydi5oIg0KKw0KKy8q
DQorICogR0ZYIFBMTCBpcyB0aGUgUExMIHVzZWQgYnkgREMsIEdNQyBhbmQgR1BVLCB0aGUgc3Ry
dWN0dXJlIG9mIHRoZSBHRlggUExMDQorICogbWF5IHN1ZmZlciBmcm9tIGNoYW5nZSBhY3Jvc3Mg
Y2hpcCB2YXJpYW50cy4NCisgKg0KKyAqDQorICogICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICstLS0tLS0tLS0tLS0tKyAgc2VsX291dF9kYw0KKyAqICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKy0tLS18IC8gZGl2X291dF8wIHwgX19fX18v
IF9fX19fIERDDQorICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8ICAg
ICstLS0tLS0tLS0tLS0tKw0KKyAqIHJlZmNsayAgICstLS0tLS0tLS0rICAgICAgKy0tLS0tLS0r
ICAgfCAgICArLS0tLS0tLS0tLS0tLSsgIHNlbF9vdXRfZ21jDQorICogLS0tKy0tLT4gfCBkaXZf
cmVmIHwgLS0tPiB8IGxvb3BjIHwgLS0rLS0+IHwgLyBkaXZfb3V0XzEgfCBfX19fXy8gX19fX18g
R01DDQorICogICAgfCAgICAgKy0tLS0tLS0tLSsgICAgICArLS0tLS0tLSsgICB8ICAgICstLS0t
LS0tLS0tLS0tKw0KKyAqICAgIHwgICAgICAgICAgLyAgICAgICAgICAgICAgICogICAgICAgfCAg
ICArLS0tLS0tLS0tLS0tLSsgIHNlbF9vdXRfZ3B1DQorICogICAgfCAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICArLS0tLXwgLyBkaXZfb3V0XzIgfCBfX19fXy8gX19fX18gR1BVDQor
ICogICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICstLS0tLS0tLS0t
LS0tKw0KKyAqICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBeDQorICogICAgfCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHwNCisgKiAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tIGJ5cGFzcyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tKw0KKyAqLw0KKw0KK3N0cnVjdCBs
b29uZ3Nvbl9nZnhwbGxfYml0bWFwIHsNCisJLyogQnl0ZSAwIH4gQnl0ZSAzICovDQorCXVuc2ln
bmVkIGRpdl9vdXRfZGMgICAgOiA3OyAgLyogIDYgOiAwICAgIERDIG91dHB1dCBjbG9jayBkaXZp
ZGVyICAqLw0KKwl1bnNpZ25lZCBkaXZfb3V0X2dtYyAgIDogNzsgIC8qIDEzIDogNyAgICBHTUMg
b3V0cHV0IGNsb2NrIGRpdmlkZXIgKi8NCisJdW5zaWduZWQgZGl2X291dF9ncHUgICA6IDc7ICAv
KiAyMCA6IDE0ICAgR1BVIG91dHB1dCBjbG9jayBkaXZpZGVyICovDQorCXVuc2lnbmVkIGxvb3Bj
ICAgICAgICAgOiA5OyAgLyogMjkgOiAyMSAgIGNsb2NrIG11bHRpcGxpZXIgICAgICAgICAqLw0K
Kwl1bnNpZ25lZCBfcmVzZXJ2ZWRfMV8gIDogMjsgIC8qIDMxIDogMzAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgKi8NCisNCisJLyogQnl0ZSA0IH4gQnl0ZSA3ICovDQorCXVuc2lnbmVkIGRp
dl9yZWYgICAgICAgOiA3OyAgIC8qIDM4IDogMzIgICBJbnB1dCBjbG9jayBkaXZpZGVyICAgICov
DQorCXVuc2lnbmVkIGxvY2tlZCAgICAgICAgOiAxOyAgIC8qIDM5ICAgICAgICBQTEwgbG9ja2Vk
IGluZGljYXRvciAgICovDQorCXVuc2lnbmVkIHNlbF9vdXRfZGMgICAgOiAxOyAgIC8qIDQwICAg
ICAgICBkYyBvdXRwdXQgY2xrIGVuYWJsZSAgICovDQorCXVuc2lnbmVkIHNlbF9vdXRfZ21jICAg
OiAxOyAgIC8qIDQxICAgICAgICBnbWMgb3V0cHV0IGNsayBlbmFibGUgICovDQorCXVuc2lnbmVk
IHNlbF9vdXRfZ3B1ICAgOiAxOyAgIC8qIDQyICAgICAgICBncHUgb3V0cHV0IGNsayBlbmFibGUg
ICovDQorCXVuc2lnbmVkIHNldF9wYXJhbSAgICAgOiAxOyAgIC8qIDQzICAgICAgICBUcmlnZ2Vy
IHRoZSB1cGRhdGUgICAgICovDQorCXVuc2lnbmVkIGJ5cGFzcyAgICAgICAgOiAxOyAgIC8qIDQ0
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorCXVuc2lnbmVkIHBvd2VyZG93biAg
ICAgOiAxOyAgIC8qIDQ1ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorCXVuc2ln
bmVkIF9yZXNlcnZlZF8yXyAgOiAxODsgIC8qIDQ2IDogNjMgICBubyB1c2UgICAgICAgICAgICAg
ICAgICovDQorfTsNCisNCit1bmlvbiBsb29uZ3Nvbl9nZnhwbGxfcmVnX2JpdG1hcCB7DQorCXN0
cnVjdCBsb29uZ3Nvbl9nZnhwbGxfYml0bWFwIGJpdG1hcDsNCisJdTMyIHdbMl07DQorCXU2NCBk
Ow0KK307DQorDQorc3RhdGljIHZvaWQgX19nZnhwbGxfcnJlZyhzdHJ1Y3QgbG9vbmdzb25fZ2Z4
cGxsICp0aGlzLA0KKwkJCSAgdW5pb24gbG9vbmdzb25fZ2Z4cGxsX3JlZ19iaXRtYXAgKnJlZykN
Cit7DQorI2lmIGRlZmluZWQoQ09ORklHXzY0QklUKQ0KKwlyZWctPmQgPSByZWFkcSh0aGlzLT5t
bWlvKTsNCisjZWxzZQ0KKwlyZWctPndbMF0gPSByZWFkbCh0aGlzLT5tbWlvKTsNCisJcmVnLT53
WzFdID0gcmVhZGwodGhpcy0+bW1pbyArIDQpOw0KKyNlbmRpZg0KK30NCisNCisvKiBVcGRhdGUg
bmV3IHBhcmFtZXRlcnMgdG8gdGhlIGhhcmR3YXJlICovDQorDQorc3RhdGljIGludCBsb29uZ3Nv
bl9nZnhwbGxfdXBkYXRlKHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKiBjb25zdCB0aGlzLA0KKwkJ
CQkgIHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGxfcGFybXMgY29uc3QgKnBpbikNCit7DQorCS8qIE5v
bmUsIFRPRE8gKi8NCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxvb25nc29u
X2dmeHBsbF9nZXRfcmF0ZXMoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMsDQor
CQkJCSAgICAgIHVuc2lnbmVkIGludCAqZGMsDQorCQkJCSAgICAgIHVuc2lnbmVkIGludCAqZ21j
LA0KKwkJCQkgICAgICB1bnNpZ25lZCBpbnQgKmdwdSkNCit7DQorCXN0cnVjdCBsb29uZ3Nvbl9n
ZnhwbGxfcGFybXMgKnBwYXJtcyA9ICZ0aGlzLT5wYXJtczsNCisJdW5pb24gbG9vbmdzb25fZ2Z4
cGxsX3JlZ19iaXRtYXAgZ2Z4cGxsX3JlZzsNCisJdW5zaWduZWQgaW50IHByZV9vdXRwdXQ7DQor
CXVuc2lnbmVkIGludCBkY19taHo7DQorCXVuc2lnbmVkIGludCBnbWNfbWh6Ow0KKwl1bnNpZ25l
ZCBpbnQgZ3B1X21oejsNCisNCisJX19nZnhwbGxfcnJlZyh0aGlzLCAmZ2Z4cGxsX3JlZyk7DQor
DQorCXBwYXJtcy0+ZGl2X3JlZiA9IGdmeHBsbF9yZWcuYml0bWFwLmRpdl9yZWY7DQorCXBwYXJt
cy0+bG9vcGMgPSBnZnhwbGxfcmVnLmJpdG1hcC5sb29wYzsNCisNCisJcHBhcm1zLT5kaXZfb3V0
X2RjID0gZ2Z4cGxsX3JlZy5iaXRtYXAuZGl2X291dF9kYzsNCisJcHBhcm1zLT5kaXZfb3V0X2dt
YyA9IGdmeHBsbF9yZWcuYml0bWFwLmRpdl9vdXRfZ21jOw0KKwlwcGFybXMtPmRpdl9vdXRfZ3B1
ID0gZ2Z4cGxsX3JlZy5iaXRtYXAuZGl2X291dF9ncHU7DQorDQorCXByZV9vdXRwdXQgPSBwcGFy
bXMtPnJlZl9jbG9jayAvIHBwYXJtcy0+ZGl2X3JlZiAqIHBwYXJtcy0+bG9vcGM7DQorDQorCWRj
X21oeiA9IHByZV9vdXRwdXQgLyBwcGFybXMtPmRpdl9vdXRfZGMgLyAxMDAwOw0KKwlnbWNfbWh6
ID0gcHJlX291dHB1dCAvIHBwYXJtcy0+ZGl2X291dF9nbWMgLyAxMDAwOw0KKwlncHVfbWh6ID0g
cHJlX291dHB1dCAvIHBwYXJtcy0+ZGl2X291dF9ncHUgLyAxMDAwOw0KKw0KKwlpZiAoZGMpDQor
CQkqZGMgPSBkY19taHo7DQorDQorCWlmIChnbWMpDQorCQkqZ21jID0gZ21jX21oejsNCisNCisJ
aWYgKGdwdSkNCisJCSpncHUgPSBncHVfbWh6Ow0KK30NCisNCitzdGF0aWMgdm9pZCBsb29uZ3Nv
bl9nZnhwbGxfcHJpbnQoc3RydWN0IGxvb25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJ
CSAgc3RydWN0IGRybV9wcmludGVyICpwLA0KKwkJCQkgIGJvb2wgdmVyYm9zZSkNCit7DQorCXN0
cnVjdCBsb29uZ3Nvbl9nZnhwbGxfcGFybXMgKnBhcm1zID0gJnRoaXMtPnBhcm1zOw0KKwl1bnNp
Z25lZCBpbnQgZGMsIGdtYywgZ3B1Ow0KKw0KKwlpZiAodmVyYm9zZSkgew0KKwkJZHJtX3ByaW50
ZihwLCAicmVmZXJlbmNlIGNsb2NrOiAldVxuIiwgcGFybXMtPnJlZl9jbG9jayk7DQorCQlkcm1f
cHJpbnRmKHAsICJkaXZfcmVmID0gJXVcbiIsIHBhcm1zLT5kaXZfcmVmKTsNCisJCWRybV9wcmlu
dGYocCwgImxvb3BjID0gJXVcbiIsIHBhcm1zLT5sb29wYyk7DQorDQorCQlkcm1fcHJpbnRmKHAs
ICJkaXZfb3V0X2RjID0gJXVcbiIsIHBhcm1zLT5kaXZfb3V0X2RjKTsNCisJCWRybV9wcmludGYo
cCwgImRpdl9vdXRfZ21jID0gJXVcbiIsIHBhcm1zLT5kaXZfb3V0X2dtYyk7DQorCQlkcm1fcHJp
bnRmKHAsICJkaXZfb3V0X2dwdSA9ICV1XG4iLCBwYXJtcy0+ZGl2X291dF9ncHUpOw0KKwl9DQor
DQorCXRoaXMtPmZ1bmNzLT5nZXRfcmF0ZXModGhpcywgJmRjLCAmZ21jLCAmZ3B1KTsNCisNCisJ
ZHJtX3ByaW50ZihwLCAiZGM6ICV1TUh6LCBnbWM6ICV1TUh6LCBncHU6ICV1TUh6XG4iLCBkYywg
Z21jLCBncHUpOw0KK30NCisNCisvKiBHRlggKERDLCBHUFUsIEdNQykgUExMIGluaXRpYWxpemF0
aW9uIGFuZCBkZXN0cm95IGZ1bmN0aW9uICovDQorDQorc3RhdGljIHZvaWQgbG9vbmdzb25fZ2Z4
cGxsX2Zpbmkoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsIHZvaWQgKmRhdGEpDQorew0KKwlzdHJ1
Y3QgbG9vbmdzb25fZ2Z4cGxsICp0aGlzID0gKHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKilkYXRh
Ow0KKw0KKwlpb3VubWFwKHRoaXMtPm1taW8pOw0KKw0KKwlrZnJlZSh0aGlzKTsNCit9DQorDQor
c3RhdGljIGludCBsb29uZ3Nvbl9nZnhwbGxfaW5pdChzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsICog
Y29uc3QgdGhpcykNCit7DQorCXN0cnVjdCBsb29uZ3Nvbl9nZnhwbGxfcGFybXMgKnBwYXJtcyA9
ICZ0aGlzLT5wYXJtczsNCisJc3RydWN0IGRybV9wcmludGVyIHByaW50ZXIgPSBkcm1faW5mb19w
cmludGVyKHRoaXMtPmRkZXYtPmRldik7DQorDQorCXBwYXJtcy0+cmVmX2Nsb2NrID0gTFNEQ19Q
TExfUkVGX0NMSzsNCisNCisJdGhpcy0+bW1pbyA9IGlvcmVtYXAodGhpcy0+cmVnX2Jhc2UsIHRo
aXMtPnJlZ19zaXplKTsNCisJaWYgKElTX0VSUl9PUl9OVUxMKHRoaXMtPm1taW8pKQ0KKwkJcmV0
dXJuIC1FTk9NRU07DQorDQorCXRoaXMtPmZ1bmNzLT5wcmludCh0aGlzLCAmcHJpbnRlciwgZmFs
c2UpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsb29uZ3Nv
bl9nZnhwbGxfZnVuY3MgbHNkY19nbWNfZ3B1X2Z1bmNzID0gew0KKwkuaW5pdCA9IGxvb25nc29u
X2dmeHBsbF9pbml0LA0KKwkudXBkYXRlID0gbG9vbmdzb25fZ2Z4cGxsX3VwZGF0ZSwNCisJLmdl
dF9yYXRlcyA9IGxvb25nc29uX2dmeHBsbF9nZXRfcmF0ZXMsDQorCS5wcmludCA9IGxvb25nc29u
X2dmeHBsbF9wcmludCwNCit9Ow0KKw0KK2ludCBsb29uZ3Nvbl9nZnhwbGxfY3JlYXRlKHN0cnVj
dCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCSAgIHN0cnVjdCBsb29uZ3Nvbl9nZnhwbGwgKipwcG91
dCkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRvX2xzZGMoZGRldik7DQorCWNv
bnN0IHN0cnVjdCBsb29uZ3Nvbl9nZnhfZGVzYyAqZ2Z4ID0gdG9fbG9vbmdzb25fZ2Z4KGxkZXYt
PmRlc2NwKTsNCisJc3RydWN0IGxvb25nc29uX2dmeHBsbCAqdGhpczsNCisJaW50IHJldDsNCisN
CisJdGhpcyA9IGt6YWxsb2Moc2l6ZW9mKCp0aGlzKSwgR0ZQX0tFUk5FTCk7DQorCWlmIChJU19F
UlJfT1JfTlVMTCh0aGlzKSkNCisJCXJldHVybiAtRU5PTUVNOw0KKw0KKwl0aGlzLT5kZGV2ID0g
ZGRldjsNCisJdGhpcy0+cmVnX3NpemUgPSBnZngtPmdmeHBsbC5yZWdfc2l6ZTsNCisJdGhpcy0+
cmVnX2Jhc2UgPSBnZngtPmNvbmZfcmVnX2Jhc2UgKyBnZngtPmdmeHBsbC5yZWdfb2Zmc2V0Ow0K
Kwl0aGlzLT5mdW5jcyA9ICZsc2RjX2dtY19ncHVfZnVuY3M7DQorDQorCXJldCA9IHRoaXMtPmZ1
bmNzLT5pbml0KHRoaXMpOw0KKwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJa2ZyZWUodGhpcyk7
DQorCQlyZXR1cm4gcmV0Ow0KKwl9DQorDQorCSpwcG91dCA9IHRoaXM7DQorDQorCXJldHVybiBk
cm1tX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGRldiwgbG9vbmdzb25fZ2Z4cGxsX2ZpbmksIHRoaXMp
Ow0KK30NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19nZnhwbGwu
aCBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dmeHBsbC5oDQpuZXcgZmlsZSBtb2Rl
IDEwMDY0NA0KaW5kZXggMDAwMDAwMDAwMDAwLi5mNWViYTY3NjU4MTINCi0tLSAvZGV2L251bGwN
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX2dmeHBsbC5oDQpAQCAtMCwwICsx
LDUyIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCisvKg0KKyAq
IENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0
ZWQNCisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19HRlhQTExfSF9fDQorI2RlZmluZSBfX0xTRENf
R0ZYUExMX0hfXw0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2RldmljZS5oPg0KKw0KK3N0cnVjdCBs
b29uZ3Nvbl9nZnhwbGw7DQorDQorc3RydWN0IGxvb25nc29uX2dmeHBsbF9wYXJtcyB7DQorCXVu
c2lnbmVkIGludCByZWZfY2xvY2s7DQorCXVuc2lnbmVkIGludCBkaXZfcmVmOw0KKwl1bnNpZ25l
ZCBpbnQgbG9vcGM7DQorCXVuc2lnbmVkIGludCBkaXZfb3V0X2RjOw0KKwl1bnNpZ25lZCBpbnQg
ZGl2X291dF9nbWM7DQorCXVuc2lnbmVkIGludCBkaXZfb3V0X2dwdTsNCit9Ow0KKw0KK3N0cnVj
dCBsb29uZ3Nvbl9nZnhwbGxfZnVuY3Mgew0KKwlpbnQgKCppbml0KShzdHJ1Y3QgbG9vbmdzb25f
Z2Z4cGxsICogY29uc3QgdGhpcyk7DQorDQorCWludCAoKnVwZGF0ZSkoc3RydWN0IGxvb25nc29u
X2dmeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICBzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsX3Bh
cm1zIGNvbnN0ICpwaW4pOw0KKw0KKwl2b2lkICgqZ2V0X3JhdGVzKShzdHJ1Y3QgbG9vbmdzb25f
Z2Z4cGxsICogY29uc3QgdGhpcywNCisJCQkgIHVuc2lnbmVkIGludCAqZGMsIHVuc2lnbmVkIGlu
dCAqZ21jLCB1bnNpZ25lZCBpbnQgKmdwdSk7DQorDQorCXZvaWQgKCpwcmludCkoc3RydWN0IGxv
b25nc29uX2dmeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICBzdHJ1Y3QgZHJtX3ByaW50ZXIg
KnByaW50ZXIsIGJvb2wgdmVyYm9zZSk7DQorfTsNCisNCitzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxs
IHsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXY7DQorCXZvaWQgX19pb21lbSAqbW1pbzsNCisN
CisJLyogUExMIHJlZ2lzdGVyIG9mZnNldCAqLw0KKwl1MzIgcmVnX2Jhc2U7DQorCS8qIFBMTCBy
ZWdpc3RlciBzaXplIGluIGJ5dGVzICovDQorCXUzMiByZWdfc2l6ZTsNCisNCisJY29uc3Qgc3Ry
dWN0IGxvb25nc29uX2dmeHBsbF9mdW5jcyAqZnVuY3M7DQorDQorCXN0cnVjdCBsb29uZ3Nvbl9n
ZnhwbGxfcGFybXMgcGFybXM7DQorfTsNCisNCitpbnQgbG9vbmdzb25fZ2Z4cGxsX2NyZWF0ZShz
dHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICBzdHJ1Y3QgbG9vbmdzb25fZ2Z4cGxsICoq
cHBvdXQpOw0KKw0KKyNlbmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nv
bi9sc2RjX2kyYy5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfaTJjLmMNCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLmQ2NDcxMmE0NjA5OA0KLS0tIC9k
ZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfaTJjLmMNCkBAIC0w
LDAgKzEsMTc5IEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisvKg0K
KyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExp
bWl0ZWQNCisgKi8NCisNCisjaW5jbHVkZSA8ZHJtL2RybV9tYW5hZ2VkLmg+DQorDQorI2luY2x1
ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfb3V0cHV0LmgiDQorDQorLyoNCisgKiBf
X2xzZGNfZ3Bpb19pMmNfc2V0IC0gc2V0IHRoZSBzdGF0ZSBvZiBhIGdwaW8gcGluIGluZGljYXRl
ZCBieSBtYXNrDQorICogQG1hc2s6IGdwaW8gcGluIG1hc2sNCisgKiBAc3RhdGU6ICIwIiBmb3Ig
bG93LCAiMSIgZm9yIGhpZ2gNCisgKi8NCitzdGF0aWMgdm9pZCBfX2xzZGNfZ3Bpb19pMmNfc2V0
KHN0cnVjdCBsc2RjX2kyYyAqIGNvbnN0IGxpMmMsIGludCBtYXNrLCBpbnQgc3RhdGUpDQorew0K
KwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGxpMmMtPmRkZXYpOw0KKwl1bnNp
Z25lZCBsb25nIGZsYWdzOw0KKwl1OCB2YWw7DQorDQorCXNwaW5fbG9ja19pcnFzYXZlKCZsZGV2
LT5yZWdsb2NrLCBmbGFncyk7DQorDQorCWlmIChzdGF0ZSkgew0KKwkJLyoNCisJCSAqIFNldHRp
bmcgdGhpcyBwaW4gYXMgaW5wdXQgZGlyZWN0bHksIHdyaXRlIDEgZm9yIGlucHV0Lg0KKwkJICog
VGhlIGV4dGVybmFsIHB1bGwtdXAgcmVzaXN0b3Igd2lsbCBwdWxsIHRoZSBsZXZlbCB1cA0KKwkJ
ICovDQorCQl2YWwgPSByZWFkYihsaTJjLT5kaXJfcmVnKTsNCisJCXZhbCB8PSBtYXNrOw0KKwkJ
d3JpdGViKHZhbCwgbGkyYy0+ZGlyX3JlZyk7DQorCX0gZWxzZSB7DQorCQkvKiBGaXJzdCBzZXQg
dGhpcyBwaW4gYXMgb3V0cHV0LCB3cml0ZSAwIGZvciBvdXRwdXQgKi8NCisJCXZhbCA9IHJlYWRi
KGxpMmMtPmRpcl9yZWcpOw0KKwkJdmFsICY9IH5tYXNrOw0KKwkJd3JpdGViKHZhbCwgbGkyYy0+
ZGlyX3JlZyk7DQorDQorCQkvKiBUaGVuLCBtYWtlIHRoaXMgcGluIG91dHB1dCAwICovDQorCQl2
YWwgPSByZWFkYihsaTJjLT5kYXRfcmVnKTsNCisJCXZhbCAmPSB+bWFzazsNCisJCXdyaXRlYih2
YWwsIGxpMmMtPmRhdF9yZWcpOw0KKwl9DQorDQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmxk
ZXYtPnJlZ2xvY2ssIGZsYWdzKTsNCit9DQorDQorLyoNCisgKiBfX2xzZGNfZ3Bpb19pMmNfZ2V0
IC0gcmVhZCB2YWx1ZSBiYWNrIGZyb20gdGhlIGdwaW8gcGluIGluZGljYXRlZCBieSBtYXNrDQor
ICogQG1hc2s6IGdwaW8gcGluIG1hc2sNCisgKiByZXR1cm4gIjAiIGZvciBsb3csICIxIiBmb3Ig
aGlnaA0KKyAqLw0KK3N0YXRpYyBpbnQgX19sc2RjX2dwaW9faTJjX2dldChzdHJ1Y3QgbHNkY19p
MmMgKiBjb25zdCBsaTJjLCBpbnQgbWFzaykNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRl
diA9IHRvX2xzZGMobGkyYy0+ZGRldik7DQorCXVuc2lnbmVkIGxvbmcgZmxhZ3M7DQorCXU4IHZh
bDsNCisNCisJc3Bpbl9sb2NrX2lycXNhdmUoJmxkZXYtPnJlZ2xvY2ssIGZsYWdzKTsNCisNCisJ
LyogRmlyc3Qgc2V0IHRoaXMgcGluIGFzIGlucHV0ICovDQorCXZhbCA9IHJlYWRiKGxpMmMtPmRp
cl9yZWcpOw0KKwl2YWwgfD0gbWFzazsNCisJd3JpdGViKHZhbCwgbGkyYy0+ZGlyX3JlZyk7DQor
DQorCS8qIFRoZW4gZ2V0IGxldmVsIHN0YXRlIGZyb20gdGhpcyBwaW4gKi8NCisJdmFsID0gcmVh
ZGIobGkyYy0+ZGF0X3JlZyk7DQorDQorCXNwaW5fdW5sb2NrX2lycXJlc3RvcmUoJmxkZXYtPnJl
Z2xvY2ssIGZsYWdzKTsNCisNCisJcmV0dXJuICh2YWwgJiBtYXNrKSA/IDEgOiAwOw0KK30NCisN
CitzdGF0aWMgdm9pZCBsc2RjX2dwaW9faTJjX3NldF9zZGEodm9pZCAqaTJjLCBpbnQgc3RhdGUp
DQorew0KKwlzdHJ1Y3QgbHNkY19pMmMgKiBjb25zdCBsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAq
KWkyYzsNCisJLyogc2V0IHN0YXRlIG9uIHRoZSBsaTJjLT5zZGEgcGluICovDQorCXJldHVybiBf
X2xzZGNfZ3Bpb19pMmNfc2V0KGxpMmMsIGxpMmMtPnNkYSwgc3RhdGUpOw0KK30NCisNCitzdGF0
aWMgdm9pZCBsc2RjX2dwaW9faTJjX3NldF9zY2wodm9pZCAqaTJjLCBpbnQgc3RhdGUpDQorew0K
KwlzdHJ1Y3QgbHNkY19pMmMgKiBjb25zdCBsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAqKWkyYzsN
CisJLyogc2V0IHN0YXRlIG9uIHRoZSBsaTJjLT5zY2wgcGluICovDQorCXJldHVybiBfX2xzZGNf
Z3Bpb19pMmNfc2V0KGxpMmMsIGxpMmMtPnNjbCwgc3RhdGUpOw0KK30NCisNCitzdGF0aWMgaW50
IGxzZGNfZ3Bpb19pMmNfZ2V0X3NkYSh2b2lkICppMmMpDQorew0KKwlzdHJ1Y3QgbHNkY19pMmMg
KiBjb25zdCBsaTJjID0gKHN0cnVjdCBsc2RjX2kyYyAqKWkyYzsNCisJLyogcmVhZCB2YWx1ZSBm
cm9tIHRoZSBsaTJjLT5zZGEgcGluICovDQorCXJldHVybiBfX2xzZGNfZ3Bpb19pMmNfZ2V0KGxp
MmMsIGxpMmMtPnNkYSk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19ncGlvX2kyY19nZXRfc2Ns
KHZvaWQgKmkyYykNCit7DQorCXN0cnVjdCBsc2RjX2kyYyAqIGNvbnN0IGxpMmMgPSAoc3RydWN0
IGxzZGNfaTJjICopaTJjOw0KKwkvKiByZWFkIHRoZSB2YWx1ZSBmcm9tIHRoZSBsaTJjLT5zY2wg
cGluICovDQorCXJldHVybiBfX2xzZGNfZ3Bpb19pMmNfZ2V0KGxpMmMsIGxpMmMtPnNjbCk7DQor
fQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfZGVzdHJveV9pMmMoc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYsIHZvaWQgKmRhdGEpDQorew0KKwlzdHJ1Y3QgbHNkY19pMmMgKmxpMmMgPSAoc3RydWN0IGxz
ZGNfaTJjICopZGF0YTsNCisNCisJaWYgKGxpMmMpIHsNCisJCWkyY19kZWxfYWRhcHRlcigmbGky
Yy0+YWRhcHRlcik7DQorCQlrZnJlZShsaTJjKTsNCisJfQ0KK30NCisNCisvKg0KKyAqIFRoZSBE
QyBpbiBsczdhMTAwMC9sczdhMjAwMC9sczJrMjAwMCBoYXMgYnVpbHRpbiBncGlvIGhhcmR3YXJl
DQorICoNCisgKiBAcmVnX2Jhc2U6IGdwaW8gcmVnIGJhc2UNCisgKiBAaW5kZXg6IG91dHB1dCBj
aGFubmVsIGluZGV4LCAwIGZvciBQSVBFMCwgMSBmb3IgUElQRTENCisgKi8NCitpbnQgbHNkY19j
cmVhdGVfaTJjX2NoYW4oc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJIHN0cnVjdCBsc2Rj
X2Rpc3BsYXlfcGlwZSAqZGlzcGlwZSwNCisJCQkgdW5zaWduZWQgaW50IGluZGV4KQ0KK3sNCisJ
c3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJc3RydWN0IGkyY19h
ZGFwdGVyICphZGFwdGVyOw0KKwlzdHJ1Y3QgbHNkY19pMmMgKmxpMmM7DQorCWludCByZXQ7DQor
DQorCWxpMmMgPSBremFsbG9jKHNpemVvZigqbGkyYyksIEdGUF9LRVJORUwpOw0KKwlpZiAoIWxp
MmMpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJZGlzcGlwZS0+bGkyYyA9IGxpMmM7DQorDQor
CWlmIChpbmRleCA9PSAwKSB7DQorCQlsaTJjLT5zZGEgPSAweDAxOyAgLyogcGluIDAgKi8NCisJ
CWxpMmMtPnNjbCA9IDB4MDI7ICAvKiBwaW4gMSAqLw0KKwl9IGVsc2UgaWYgKGluZGV4ID09IDEp
IHsNCisJCWxpMmMtPnNkYSA9IDB4MDQ7ICAvKiBwaW4gMiAqLw0KKwkJbGkyYy0+c2NsID0gMHgw
ODsgIC8qIHBpbiAzICovDQorCX0gZWxzZSB7DQorCQlyZXR1cm4gLUVOT0VOVDsNCisJfQ0KKw0K
KwlsaTJjLT5kZGV2ID0gZGRldjsNCisJbGkyYy0+ZGlyX3JlZyA9IGxkZXYtPnJlZ19iYXNlICsg
TFM3QV9EQ19HUElPX0RJUl9SRUc7DQorCWxpMmMtPmRhdF9yZWcgPSBsZGV2LT5yZWdfYmFzZSAr
IExTN0FfRENfR1BJT19EQVRfUkVHOw0KKw0KKwlsaTJjLT5iaXQuc2V0c2RhID0gbHNkY19ncGlv
X2kyY19zZXRfc2RhOw0KKwlsaTJjLT5iaXQuc2V0c2NsID0gbHNkY19ncGlvX2kyY19zZXRfc2Ns
Ow0KKwlsaTJjLT5iaXQuZ2V0c2RhID0gbHNkY19ncGlvX2kyY19nZXRfc2RhOw0KKwlsaTJjLT5i
aXQuZ2V0c2NsID0gbHNkY19ncGlvX2kyY19nZXRfc2NsOw0KKwlsaTJjLT5iaXQudWRlbGF5ID0g
NTsNCisJbGkyYy0+Yml0LnRpbWVvdXQgPSB1c2Vjc190b19qaWZmaWVzKDIyMDApOw0KKwlsaTJj
LT5iaXQuZGF0YSA9IGxpMmM7DQorDQorCWFkYXB0ZXIgPSAmbGkyYy0+YWRhcHRlcjsNCisJYWRh
cHRlci0+YWxnb19kYXRhID0gJmxpMmMtPmJpdDsNCisJYWRhcHRlci0+b3duZXIgPSBUSElTX01P
RFVMRTsNCisJYWRhcHRlci0+Y2xhc3MgPSBJMkNfQ0xBU1NfRERDOw0KKwlhZGFwdGVyLT5kZXYu
cGFyZW50ID0gZGRldi0+ZGV2Ow0KKwlhZGFwdGVyLT5uciA9IC0xOw0KKw0KKwlzbnByaW50Zihh
ZGFwdGVyLT5uYW1lLCBzaXplb2YoYWRhcHRlci0+bmFtZSksICJsc2RjLWkyYyV1IiwgaW5kZXgp
Ow0KKw0KKwlpMmNfc2V0X2FkYXBkYXRhKGFkYXB0ZXIsIGxpMmMpOw0KKw0KKwlyZXQgPSBpMmNf
Yml0X2FkZF9idXMoYWRhcHRlcik7DQorCWlmIChyZXQpIHsNCisJCWtmcmVlKGxpMmMpOw0KKwkJ
cmV0dXJuIHJldDsNCisJfQ0KKw0KKwlyZXQgPSBkcm1tX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGRl
diwgbHNkY19kZXN0cm95X2kyYywgbGkyYyk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0K
Kw0KKwlkcm1faW5mbyhkZGV2LCAiJXMoc2RhIHBpbiBtYXNrPSV1LCBzY2wgcGluIG1hc2s9JXUp
IGNyZWF0ZWRcbiIsDQorCQkgYWRhcHRlci0+bmFtZSwgbGkyYy0+c2RhLCBsaTJjLT5zY2wpOw0K
Kw0KKwlyZXR1cm4gMDsNCit9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfaTJjLmggYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pMmMuaA0KbmV3IGZp
bGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uYzNkYWRjMmM0MjNkDQotLS0gL2Rl
di9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pMmMuaA0KQEAgLTAs
MCArMSwyOSBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoN
CisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBM
aW1pdGVkDQorICovDQorDQorI2lmbmRlZiBfX0xTRENfSTJDX0hfXw0KKyNkZWZpbmUgX19MU0RD
X0kyQ19IX18NCisNCisjaW5jbHVkZSA8bGludXgvaTJjLmg+DQorI2luY2x1ZGUgPGxpbnV4L2ky
Yy1hbGdvLWJpdC5oPg0KKw0KK3N0cnVjdCBsc2RjX2kyYyB7DQorCXN0cnVjdCBpMmNfYWRhcHRl
ciBhZGFwdGVyOw0KKwlzdHJ1Y3QgaTJjX2FsZ29fYml0X2RhdGEgYml0Ow0KKwlzdHJ1Y3QgZHJt
X2RldmljZSAqZGRldjsNCisJdm9pZCBfX2lvbWVtICpkaXJfcmVnOw0KKwl2b2lkIF9faW9tZW0g
KmRhdF9yZWc7DQorCS8qIHBpbiBiaXQgbWFzayAqLw0KKwl1OCBzZGE7DQorCXU4IHNjbDsNCit9
Ow0KKw0KK3N0cnVjdCBsc2RjX2Rpc3BsYXlfcGlwZTsNCisNCitpbnQgbHNkY19jcmVhdGVfaTJj
X2NoYW4oc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJIHN0cnVjdCBsc2RjX2Rpc3BsYXlf
cGlwZSAqZGlzcGlwZSwNCisJCQkgdW5zaWduZWQgaW50IGluZGV4KTsNCisNCisjZW5kaWYNCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEuYyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2lycS5jDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXgg
MDAwMDAwMDAwMDAwLi44MDQwMjRmYzRiMGYNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX2lycS5jDQpAQCAtMCwwICsxLDgxIEBADQorLy8gU1BEWC1M
aWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBM
b29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaW5jbHVk
ZSA8ZHJtL2RybV92YmxhbmsuaD4NCisNCisjaW5jbHVkZSAibHNkY19pcnEuaCINCisNCisvKg0K
KyAqIEZvciB0aGUgREMgaW4gbHM3YTIwMDAsIGNsZWFyaW5nIGludGVycnVwdCBzdGF0dXMgaXMg
YWNoaWV2ZWQgYnkNCisgKiB3cml0ZSAiMSIgdG8gTFNEQ19JTlRfUkVHLCBGb3IgdGhlIERDIGlu
IGxzN2ExMDAwLCBjbGVhciBpbnRlcnJ1cHQNCisgKiBzdGF0dXMgaXMgYWNoaWV2ZWQgYnkgd3Jp
dGUgIjAiIHRvIExTRENfSU5UX1JFRy4gVHdvIGRpZmZlcmVudCBoYXJkd2FyZQ0KKyAqIGVuZ2lu
ZWVyIG9mIExvb25nc29uIG1vZGlmeSBpdCBhcyB0aGVpciB3aWxsLg0KKyAqLw0KKw0KK2lycXJl
dHVybl90IGxzN2EyMDAwX2RjX2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZykNCit7DQor
CXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gYXJnOw0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxk
ZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3QgZHJtX2NydGMgKmNydGM7DQorCXUzMiB2YWw7
DQorDQorCS8qIFJlYWQgdGhlIGludGVycnVwdCBzdGF0dXMgKi8NCisJdmFsID0gbHNkY19ycmVn
MzIobGRldiwgTFNEQ19JTlRfUkVHKTsNCisJaWYgKCh2YWwgJiBJTlRfU1RBVFVTX01BU0spID09
IDApIHsNCisJCWRybV93YXJuKGRkZXYsICJubyBpbnRlcnJ1cHQgb2NjdXJzXG4iKTsNCisJCXJl
dHVybiBJUlFfTk9ORTsNCisJfQ0KKw0KKwlsZGV2LT5pcnFfc3RhdHVzID0gdmFsOw0KKw0KKwkv
KiB3cml0ZSAiMSIgdG8gY2xlYXIgdGhlIGludGVycnVwdCBzdGF0dXMgKi8NCisJbHNkY193cmVn
MzIobGRldiwgTFNEQ19JTlRfUkVHLCB2YWwpOw0KKw0KKwlpZiAobGRldi0+aXJxX3N0YXR1cyAm
IElOVF9DUlRDMF9WU1lOQykgew0KKwkJY3J0YyA9IGRybV9jcnRjX2Zyb21faW5kZXgoZGRldiwg
MCk7DQorCQlkcm1fY3J0Y19oYW5kbGVfdmJsYW5rKGNydGMpOw0KKwl9DQorDQorCWlmIChsZGV2
LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMxX1ZTWU5DKSB7DQorCQljcnRjID0gZHJtX2NydGNfZnJv
bV9pbmRleChkZGV2LCAxKTsNCisJCWRybV9jcnRjX2hhbmRsZV92YmxhbmsoY3J0Yyk7DQorCX0N
CisNCisJcmV0dXJuIElSUV9IQU5ETEVEOw0KK30NCisNCisvKiBGb3IgdGhlIERDIGluIExTN0Ex
MDAwIGFuZCBMUzJLMTAwMCAqLw0KK2lycXJldHVybl90IGxzN2ExMDAwX2RjX2lycV9oYW5kbGVy
KGludCBpcnEsIHZvaWQgKmFyZykNCit7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0gYXJn
Ow0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3Qg
ZHJtX2NydGMgKmNydGM7DQorCXUzMiB2YWw7DQorDQorCS8qIFJlYWQgdGhlIGludGVycnVwdCBz
dGF0dXMgKi8NCisJdmFsID0gbHNkY19ycmVnMzIobGRldiwgTFNEQ19JTlRfUkVHKTsNCisJaWYg
KCh2YWwgJiBJTlRfU1RBVFVTX01BU0spID09IDApIHsNCisJCWRybV93YXJuKGRkZXYsICJubyBp
bnRlcnJ1cHQgb2NjdXJzXG4iKTsNCisJCXJldHVybiBJUlFfTk9ORTsNCisJfQ0KKw0KKwlsZGV2
LT5pcnFfc3RhdHVzID0gdmFsOw0KKw0KKwkvKiB3cml0ZSAiMCIgdG8gY2xlYXIgdGhlIGludGVy
cnVwdCBzdGF0dXMgKi8NCisJdmFsICY9IH4oSU5UX0NSVEMwX1ZTWU5DIHwgSU5UX0NSVEMxX1ZT
WU5DKTsNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19JTlRfUkVHLCB2YWwpOw0KKw0KKwlpZiAo
bGRldi0+aXJxX3N0YXR1cyAmIElOVF9DUlRDMF9WU1lOQykgew0KKwkJY3J0YyA9IGRybV9jcnRj
X2Zyb21faW5kZXgoZGRldiwgMCk7DQorCQlkcm1fY3J0Y19oYW5kbGVfdmJsYW5rKGNydGMpOw0K
Kwl9DQorDQorCWlmIChsZGV2LT5pcnFfc3RhdHVzICYgSU5UX0NSVEMxX1ZTWU5DKSB7DQorCQlj
cnRjID0gZHJtX2NydGNfZnJvbV9pbmRleChkZGV2LCAxKTsNCisJCWRybV9jcnRjX2hhbmRsZV92
YmxhbmsoY3J0Yyk7DQorCX0NCisNCisJcmV0dXJuIElSUV9IQU5ETEVEOw0KK30NCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19pcnEuaCBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX2lycS5oDQpuZXcgZmlsZSBtb2RlIDEwMDY0NA0KaW5kZXggMDAwMDAw
MDAwMDAwLi5jNzAwMzQ2MTA1MWUNCi0tLSAvZGV2L251bGwNCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX2lycS5oDQpAQCAtMCwwICsxLDE2IEBADQorLyogU1BEWC1MaWNlbnNl
LUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29u
Z3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaWZuZGVmIF9f
TFNEQ19JUlFfSF9fDQorI2RlZmluZSBfX0xTRENfSVJRX0hfXw0KKw0KKyNpbmNsdWRlIDxsaW51
eC9pcnFyZXR1cm4uaD4NCisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisNCitpcnFyZXR1cm5f
dCBsczdhMTAwMF9kY19pcnFfaGFuZGxlcihpbnQgaXJxLCB2b2lkICphcmcpOw0KK2lycXJldHVy
bl90IGxzN2EyMDAwX2RjX2lycV9oYW5kbGVyKGludCBpcnEsIHZvaWQgKmFyZyk7DQorDQorI2Vu
ZGlmDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfb3V0cHV0Lmgg
Yi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19vdXRwdXQuaA0KbmV3IGZpbGUgbW9kZSAx
MDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZTNjMzc1Mjk4NTY4DQotLS0gL2Rldi9udWxsDQor
KysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19vdXRwdXQuaA0KQEAgLTAsMCArMSwy
MSBAQA0KKy8qIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBD
b3B5cmlnaHQgKEMpIDIwMjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVk
DQorICovDQorDQorI2lmbmRlZiBfX0xTRENfT1VUUFVUX0hfXw0KKyNkZWZpbmUgX19MU0RDX09V
VFBVVF9IX18NCisNCisjaW5jbHVkZSAibHNkY19kcnYuaCINCisNCitpbnQgbHM3YTEwMDBfb3V0
cHV0X2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJIHN0cnVjdCBsc2RjX2Rpc3Bs
YXlfcGlwZSAqZGlzcGlwZSwNCisJCQkgc3RydWN0IGkyY19hZGFwdGVyICpkZGMsDQorCQkJIHVu
c2lnbmVkIGludCBpbmRleCk7DQorDQoraW50IGxzN2EyMDAwX291dHB1dF9pbml0KHN0cnVjdCBk
cm1fZGV2aWNlICpsZGV2LA0KKwkJCSBzdHJ1Y3QgbHNkY19kaXNwbGF5X3BpcGUgKmRpc3BpcGUs
DQorCQkJIHN0cnVjdCBpMmNfYWRhcHRlciAqZGRjLA0KKwkJCSB1bnNpZ25lZCBpbnQgaW5kZXgp
Ow0KKw0KKyNlbmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2Rj
X3BpeHBsbC5jIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmMNCm5ldyBm
aWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAuLjAzNjRjNDk1ODVkYw0KLS0tIC9k
ZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGl4cGxsLmMNCkBA
IC0wLDAgKzEsNDgxIEBADQorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjANCisv
Kg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9u
IExpbWl0ZWQNCisgKi8NCisNCisjaW5jbHVkZSA8bGludXgvZGVsYXkuaD4NCisNCisjaW5jbHVk
ZSA8ZHJtL2RybV9tYW5hZ2VkLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorDQorLyoN
CisgKiBUaGUgc3RydWN0dXJlIG9mIHRoZSBwaXhlbCBQTEwgcmVnaXN0ZXJzIGlzIGV2b2x2ZWQg
d2l0aCB0aW1lcywNCisgKiBpdCBjYW4gYmUgZGlmZmVyZW50IGFjcm9zcyBkaWZmZXJlbnQgY2hp
cCBhbHNvLg0KKyAqLw0KKw0KKy8qIHNpemUgaXMgdTY0LCBub3RlIHRoYXQgYWxsIGxvb25nc29u
J3MgY3B1IGlzIGxpdHRsZSBlbmRpYW4uDQorICogVGhpcyBzdHJ1Y3R1cmUgaXMgc2FtZSBmb3Ig
bHM3YTIwMDAsIGxzN2ExMDAwIGFuZCBsczJrMjAwMC4NCisgKi8NCitzdHJ1Y3QgbHNkY19waXhw
bGxfcmVnIHsNCisJLyogQnl0ZSAwIH4gQnl0ZSAzICovDQorCXVuc2lnbmVkIGRpdl9vdXQgICAg
ICAgOiA3OyAgIC8qICA2IDogMCAgICAgT3V0cHV0IGNsb2NrIGRpdmlkZXIgICovDQorCXVuc2ln
bmVkIF9yZXNlcnZlZF8xXyAgOiAxNDsgIC8qIDIwIDogNyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICovDQorCXVuc2lnbmVkIGxvb3BjICAgICAgICAgOiA5OyAgIC8qIDI5IDogMjEgICAgQ2xv
Y2sgbXVsdGlwbGllciAgICAgICovDQorCXVuc2lnbmVkIF9yZXNlcnZlZF8yXyAgOiAyOyAgIC8q
IDMxIDogMzAgICAgICAgICAgICAgICAgICAgICAgICAgICovDQorDQorCS8qIEJ5dGUgNCB+IEJ5
dGUgNyAqLw0KKwl1bnNpZ25lZCBkaXZfcmVmICAgICAgIDogNzsgICAvKiAzOCA6IDMyICAgIElu
cHV0IGNsb2NrIGRpdmlkZXIgICAqLw0KKwl1bnNpZ25lZCBsb2NrZWQgICAgICAgIDogMTsgICAv
KiAzOSAgICAgICAgIFBMTCBsb2NrZWQgaW5kaWNhdG9yICAqLw0KKwl1bnNpZ25lZCBzZWxfb3V0
ICAgICAgIDogMTsgICAvKiA0MCAgICAgICAgIG91dHB1dCBjbGsgc2VsZWN0b3IgICAqLw0KKwl1
bnNpZ25lZCBfcmVzZXJ2ZWRfM18gIDogMjsgICAvKiA0MiA6IDQxICAgICAgICAgICAgICAgICAg
ICAgICAgICAqLw0KKwl1bnNpZ25lZCBzZXRfcGFyYW0gICAgIDogMTsgICAvKiA0MyAgICAgICAg
IFRyaWdnZXIgdGhlIHVwZGF0ZSAgICAqLw0KKwl1bnNpZ25lZCBieXBhc3MgICAgICAgIDogMTsg
ICAvKiA0NCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0KKwl1bnNpZ25lZCBwb3dl
cmRvd24gICAgIDogMTsgICAvKiA0NSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqLw0K
Kwl1bnNpZ25lZCBfcmVzZXJ2ZWRfNF8gIDogMTg7ICAvKiA0NiA6IDYzICAgIG5vIHVzZSAgICAg
ICAgICAgICAgICAqLw0KK307DQorDQordW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCB7DQor
CXN0cnVjdCBsc2RjX3BpeHBsbF9yZWcgYml0bWFwOw0KKwl1MzIgd1syXTsNCisJdTY0IGQ7DQor
fTsNCisNCitzdHJ1Y3QgY2xrX3RvX3BpeHBsbF9wYXJtc19sb29rdXBfdCB7DQorCXVuc2lnbmVk
IGludCBjbG9jazsgICAgICAgIC8qIGtIeiAqLw0KKw0KKwl1bnNpZ25lZCBzaG9ydCB3aWR0aDsN
CisJdW5zaWduZWQgc2hvcnQgaGVpZ2h0Ow0KKwl1bnNpZ25lZCBzaG9ydCB2cmVmcmVzaDsNCisN
CisJLyogU3RvcmVzIHBhcmFtZXRlcnMgZm9yIHByb2dyYW1taW5nIHRoZSBIYXJkd2FyZSBQTExz
ICovDQorCXVuc2lnbmVkIHNob3J0IGRpdl9vdXQ7DQorCXVuc2lnbmVkIHNob3J0IGxvb3BjOw0K
Kwl1bnNpZ25lZCBzaG9ydCBkaXZfcmVmOw0KK307DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBj
bGtfdG9fcGl4cGxsX3Bhcm1zX2xvb2t1cF90IHBpeHBsbF9wYXJtc190YWJsZVtdID0gew0KKwl7
MTQ4NTAwLCAxOTIwLCAxMDgwLCA2MCwgIDExLCA0OSwgIDN9LCAgIC8qIDE5MjB4MTA4MEA2MEh6
ICovDQorCXsxNDE3NTAsIDE5MjAsIDEwODAsIDYwLCAgMTEsIDc4LCAgNX0sICAgLyogMTkyMHgx
MDgwQDYwSHogKi8NCisJCQkJCQkgLyogMTkyMHgxMDgwQDUwSHogKi8NCisJezE3NDUwMCwgMTky
MCwgMTA4MCwgNzUsICAxNywgODksICAzfSwgICAvKiAxOTIweDEwODBANzVIeiAqLw0KKwl7MTgx
MjUwLCAyNTYwLCAxMDgwLCA3NSwgIDgsICA1OCwgIDR9LCAgIC8qIDI1NjB4MTA4MEA3NUh6ICov
DQorCXsyOTcwMDAsIDI1NjAsIDEwODAsIDMwLCAgOCwgIDk1LCAgNH0sICAgLyogMzg0MHgyMTYw
QDMwSHogKi8NCisJezMwMTk5MiwgMTkyMCwgMTA4MCwgMTAwLCAxMCwgMTUxLCA1fSwgICAvKiAx
OTIweDEwODBAMTAwSHogKi8NCisJezE0NjI1MCwgMTY4MCwgMTA1MCwgNjAsICAxNiwgMTE3LCA1
fSwgICAvKiAxNjgweDEwNTBANjBIeiAqLw0KKwl7MTM1MDAwLCAxMjgwLCAxMDI0LCA3NSwgIDEw
LCA1NCwgIDR9LCAgIC8qIDEyODB4MTAyNEA3NUh6ICovDQorCXsxMTkwMDAsIDE2ODAsIDEwNTAs
IDYwLCAgMjAsIDExOSwgNX0sICAgLyogMTY4MHgxMDUwQDYwSHogKi8NCisJezEwODAwMCwgMTYw
MCwgOTAwLCAgNjAsICAxNSwgODEsICA1fSwgICAvKiAxNjAweDkwMEA2MEh6ICAqLw0KKwkJCQkJ
CSAvKiAxMjgweDEwMjRANjBIeiAqLw0KKwkJCQkJCSAvKiAxMjgweDk2MEA2MEh6ICovDQorCQkJ
CQkJIC8qIDExNTJ4ODY0QDc1SHogKi8NCisNCisJezEwNjUwMCwgMTQ0MCwgOTAwLCAgNjAsICAx
OSwgODEsICA0fSwgICAvKiAxNDQweDkwMEA2MEh6ICovDQorCXs4ODc1MCwgIDE0NDAsIDkwMCwg
IDYwLCAgMTYsIDcxLCAgNX0sICAgLyogMTQ0MHg5MDBANjBIeiAqLw0KKwl7ODM1MDAsICAxMjgw
LCA4MDAsICA2MCwgIDE3LCA3MSwgIDV9LCAgIC8qIDEyODB4ODAwQDYwSHogKi8NCisJezcxMDAw
LCAgMTI4MCwgODAwLCAgNjAsICAyMCwgNzEsICA1fSwgICAvKiAxMjgweDgwMEA2MEh6ICovDQor
DQorCXs3NDI1MCwgIDEyODAsIDcyMCwgIDYwLCAgMjIsIDQ5LCAgM30sICAgLyogMTI4MHg3MjBA
NjBIeiAqLw0KKwkJCQkJCSAvKiAxMjgweDcyMEA1MEh6ICovDQorDQorCXs3ODc1MCwgIDEwMjQs
IDc2OCwgIDc1LCAgMTYsIDYzLCAgNX0sICAgLyogMTAyNHg3NjhANzVIeiAqLw0KKwl7NzUwMDAs
ICAxMDI0LCA3NjgsICA3MCwgIDI5LCA4NywgIDR9LCAgIC8qIDEwMjR4NzY4QDcwSHogKi8NCisJ
ezY1MDAwLCAgMTAyNCwgNzY4LCAgNjAsICAyMCwgMzksICAzfSwgICAvKiAxMDI0eDc2OEA2MEh6
ICovDQorDQorCXs1MTIwMCwgIDEwMjQsIDYwMCwgIDYwLCAgMjUsIDY0LCAgNX0sICAgLyogMTAy
NHg2MDBANjBIeiAqLw0KKw0KKwl7NTcyODQsICA4MzIsICA2MjQsICA3NSwgIDI0LCA1NSwgIDR9
LCAgIC8qIDgzMng2MjRANzVIeiAqLw0KKwl7NDk1MDAsICA4MDAsICA2MDAsICA3NSwgIDQwLCA5
OSwgIDV9LCAgIC8qIDgwMHg2MDBANzVIeiAqLw0KKwl7NTAwMDAsICA4MDAsICA2MDAsICA3Miwg
IDQ0LCA4OCwgIDR9LCAgIC8qIDgwMHg2MDBANzJIeiAqLw0KKwl7NDAwMDAsICA4MDAsICA2MDAs
ICA2MCwgIDMwLCAzNiwgIDN9LCAgIC8qIDgwMHg2MDBANjBIeiAqLw0KKwl7MzYwMDAsICA4MDAs
ICA2MDAsICA1NiwgIDUwLCA3MiwgIDR9LCAgIC8qIDgwMHg2MDBANTZIeiAqLw0KKwl7MzE1MDAs
ICA2NDAsICA0ODAsICA3NSwgIDQwLCA2MywgIDV9LCAgIC8qIDY0MHg0ODBANzVIeiAqLw0KKwkJ
CQkJCSAvKiA2NDB4NDgwQDczSHogKi8NCisNCisJezMwMjQwLCAgNjQwLCAgNDgwLCAgNjcsICA2
MiwgNzUsICA0fSwgICAvKiA2NDB4NDgwQDY3SHogKi8NCisJezI3MDAwLCAgNzIwLCAgNTc2LCAg
NTAsICA1MCwgNTQsICA0fSwgICAvKiA3MjB4NTc2QDYwSHogKi8NCisJezI1MTc1LCAgNjQwLCAg
NDgwLCAgNjAsICA4NSwgMTA3LCA1fSwgICAvKiA2NDB4NDgwQDYwSHogKi8NCisJezI1MjAwLCAg
NjQwLCAgNDgwLCAgNjAsICA1MCwgNjMsICA1fSwgICAvKiA2NDB4NDgwQDYwSHogKi8NCisJCQkJ
CQkgLyogNzIweDQ4MEA2MEh6ICovDQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2RjX3BpeGVsX3Bs
bF9mcmVlKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LCB2b2lkICpkYXRhKQ0KK3sNCisJc3RydWN0
IGxzZGNfcGl4cGxsICp0aGlzID0gKHN0cnVjdCBsc2RjX3BpeHBsbCAqKWRhdGE7DQorDQorCWlv
dW5tYXAodGhpcy0+bW1pbyk7DQorDQorCWtmcmVlKHRoaXMtPnByaXYpOw0KKw0KKwlkcm1fZGJn
KGRkZXYsICJwaXhwbGwgcHJpdmF0ZSBkYXRhIGZyZWVkXG4iKTsNCit9DQorDQorLyoNCisgKiBp
b3JlbWFwIHRoZSBkZXZpY2UgZGVwZW5kZW50IFBMTCByZWdpc3RlcnMNCisgKg0KKyAqIEB0aGlz
OiBwb2ludCB0byB0aGUgb2JqZWN0IHdoZXJlIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGZyb20N
CisgKi8NCitzdGF0aWMgaW50IGxzZGNfcGl4ZWxfcGxsX3NldHVwKHN0cnVjdCBsc2RjX3BpeHBs
bCAqIGNvbnN0IHRoaXMpDQorew0KKwlzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtczsN
CisNCisJdGhpcy0+bW1pbyA9IGlvcmVtYXAodGhpcy0+cmVnX2Jhc2UsIHRoaXMtPnJlZ19zaXpl
KTsNCisJaWYgKElTX0VSUl9PUl9OVUxMKHRoaXMtPm1taW8pKQ0KKwkJcmV0dXJuIC1FTk9NRU07
DQorDQorCXBwYXJtcyA9IGt6YWxsb2Moc2l6ZW9mKCpwcGFybXMpLCBHRlBfS0VSTkVMKTsNCisJ
aWYgKElTX0VSUl9PUl9OVUxMKHBwYXJtcykpDQorCQlyZXR1cm4gLUVOT01FTTsNCisNCisJcHBh
cm1zLT5yZWZfY2xvY2sgPSBMU0RDX1BMTF9SRUZfQ0xLOw0KKw0KKwl0aGlzLT5wcml2ID0gcHBh
cm1zOw0KKw0KKwlyZXR1cm4gZHJtbV9hZGRfYWN0aW9uX29yX3Jlc2V0KHRoaXMtPmRkZXYsIGxz
ZGNfcGl4ZWxfcGxsX2ZyZWUsIHRoaXMpOw0KK30NCisNCisvKg0KKyAqIEZpbmQgYSBzZXQgb2Yg
cGxsIHBhcmFtZXRlcnMgZnJvbSBhIHN0YXRpYyBsb2NhbCB0YWJsZSB3aGljaCBhdm9pZA0KKyAq
IGNvbXB1dGluZyB0aGUgcGxsIHBhcmFtZXRlciBlYWNodGltZSBhIG1vZGVzZXQgaXMgdHJpZ2dl
cmVkLg0KKyAqDQorICogQHRoaXM6IHBvaW50IHRvIHRoZSBvYmplY3Qgd2hlcmUgdGhpcyBmdW5j
dGlvbiBpcyBjYWxsZWQgZnJvbQ0KKyAqIEBjbG9jazogdGhlIGRlc2lyZWQgb3V0cHV0IHBpeGVs
IGNsb2NrLCB0aGUgdW5pdCBpcyBrSHoNCisgKiBAcG91dDogcG9pbnQgdG8gd2hlcmUgdGhlIHBh
cmFtZXRlcnMgdG8gc3RvcmUgaWYgZm91bmQNCisgKg0KKyAqIFJldHVybiAwIGlmIHN1Y2Nlc3Ms
IHJldHVybiAtMSBpZiBub3QgZm91bmQuDQorICovDQorc3RhdGljIGludCBsc2RjX3BpeHBsbF9m
aW5kKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJICAgIHVuc2lnbmVkIGlu
dCBjbG9jaywNCisJCQkgICAgc3RydWN0IGxzZGNfcGl4cGxsX3Bhcm1zICpwb3V0KQ0KK3sNCisJ
dW5zaWduZWQgaW50IG51bSA9IEFSUkFZX1NJWkUocGl4cGxsX3Bhcm1zX3RhYmxlKTsNCisJY29u
c3Qgc3RydWN0IGNsa190b19waXhwbGxfcGFybXNfbG9va3VwX3QgKnB0Ow0KKwl1bnNpZ25lZCBp
bnQgaTsNCisNCisJZm9yIChpID0gMDsgaSA8IG51bTsgKytpKSB7DQorCQlwdCA9ICZwaXhwbGxf
cGFybXNfdGFibGVbaV07DQorDQorCQlpZiAoY2xvY2sgPT0gcHQtPmNsb2NrKSB7DQorCQkJcG91
dC0+ZGl2X3JlZiA9IHB0LT5kaXZfcmVmOw0KKwkJCXBvdXQtPmxvb3BjICAgPSBwdC0+bG9vcGM7
DQorCQkJcG91dC0+ZGl2X291dCA9IHB0LT5kaXZfb3V0Ow0KKw0KKwkJCXJldHVybiAwOw0KKwkJ
fQ0KKwl9DQorDQorCWRybV9kYmdfa21zKHRoaXMtPmRkZXYsICJwaXhlbCBjbG9jayAldTogbWlz
c1xuIiwgY2xvY2spOw0KKw0KKwlyZXR1cm4gLTE7DQorfQ0KKw0KKy8qDQorICogRmluZCBhIHNl
dCBvZiBwbGwgcGFyYW1ldGVycyB3aGljaCBoYXZlIG1pbmltYWwgZGlmZmVyZW5jZSB3aXRoIHRo
ZQ0KKyAqIGRlc2lyZWQgcGl4ZWwgY2xvY2sgZnJlcXVlbmN5LiBJdCBkb2VzIHRoYXQgYnkgY29t
cHV0aW5nIGFsbCBvZiB0aGUNCisgKiBwb3NzaWJsZSBjb21iaW5hdGlvbi4gQ29tcHV0ZSB0aGUg
ZGlmZiBhbmQgZmluZCB0aGUgY29tYmluYXRpb24gd2l0aA0KKyAqIG1pbmltYWwgZGlmZi4NCisg
Kg0KKyAqIGNsb2NrX291dCA9IHJlZmNsayAvIGRpdl9yZWYgKiBsb29wYyAvIGRpdl9vdXQNCisg
Kg0KKyAqIHJlZmNsayBpcyBkZXRlcm1pbmVkIGJ5IHRoZSBvc2NpbGxhdG9yIG1vdW50ZWQgb24g
bW90aGVyYm9hcmQoMTAwTUh6DQorICogaW4gYWxtb3N0IGFsbCBib2FyZCkNCisgKg0KKyAqIEB0
aGlzOiBwb2ludCB0byB0aGUgb2JqZWN0IGZyb20gd2hlcmUgdGhpcyBmdW5jdGlvbiBpcyBjYWxs
ZWQNCisgKiBAY2xvY2s6IHRoZSBkZXNpcmVkIG91dHB1dCBwaXhlbCBjbG9jaywgdGhlIHVuaXQg
aXMga0h6DQorICogQHBvdXQ6IHBvaW50IHRvIHRoZSBvdXQgc3RydWN0IG9mIGxzZGNfcGl4cGxs
X3Bhcm1zDQorICoNCisgKiBSZXR1cm4gMCBpZiBhIHNldCBvZiBwYXJhbWV0ZXIgaXMgZm91bmQs
IG90aGVyd2lzZSByZXR1cm4gdGhlIGVycm9yDQorICogYmV0d2VlbiBjbG9ja19rSHogd2Ugd2Fu
dGVkIGFuZCB0aGUgbW9zdCBjbG9zZXN0IGNhbmRpZGF0ZSB3aXRoIGl0Lg0KKyAqLw0KK3N0YXRp
YyBpbnQgbHNkY19waXhlbF9wbGxfY29tcHV0ZShzdHJ1Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0
aGlzLA0KKwkJCQkgIHVuc2lnbmVkIGludCBjbG9jaywNCisJCQkJICBzdHJ1Y3QgbHNkY19waXhw
bGxfcGFybXMgKnBvdXQpDQorew0KKwlzdHJ1Y3QgbHNkY19waXhwbGxfcGFybXMgKnBwYXJtcyA9
IHRoaXMtPnByaXY7DQorCXVuc2lnbmVkIGludCByZWZjbGsgPSBwcGFybXMtPnJlZl9jbG9jazsN
CisJY29uc3QgdW5zaWduZWQgaW50IHRvbGVyYW5jZSA9IDEwMDA7DQorCXVuc2lnbmVkIGludCBt
aW4gPSB0b2xlcmFuY2U7DQorCXVuc2lnbmVkIGludCBkaXZfb3V0LCBsb29wYywgZGl2X3JlZjsN
CisJdW5zaWduZWQgaW50IGNvbXB1dGVkOw0KKw0KKwlpZiAoIWxzZGNfcGl4cGxsX2ZpbmQodGhp
cywgY2xvY2ssIHBvdXQpKQ0KKwkJcmV0dXJuIDA7DQorDQorCWZvciAoZGl2X291dCA9IDY7IGRp
dl9vdXQgPCA2NDsgZGl2X291dCsrKSB7DQorCQlmb3IgKGRpdl9yZWYgPSAzOyBkaXZfcmVmIDwg
NjsgZGl2X3JlZisrKSB7DQorCQkJZm9yIChsb29wYyA9IDY7IGxvb3BjIDwgMTYxOyBsb29wYysr
KSB7DQorCQkJCXVuc2lnbmVkIGludCBkaWZmID0gMDsNCisNCisJCQkJaWYgKGxvb3BjIDwgMTIg
KiBkaXZfcmVmKQ0KKwkJCQkJY29udGludWU7DQorCQkJCWlmIChsb29wYyA+IDMyICogZGl2X3Jl
ZikNCisJCQkJCWNvbnRpbnVlOw0KKw0KKwkJCQljb21wdXRlZCA9IHJlZmNsayAvIGRpdl9yZWYg
KiBsb29wYyAvIGRpdl9vdXQ7DQorDQorCQkJCWlmIChjbG9jayA+PSBjb21wdXRlZCkNCisJCQkJ
CWRpZmYgPSBjbG9jayAtIGNvbXB1dGVkOw0KKwkJCQllbHNlDQorCQkJCQlkaWZmID0gY29tcHV0
ZWQgLSBjbG9jazsNCisNCisJCQkJaWYgKGRpZmYgPCBtaW4pIHsNCisJCQkJCW1pbiA9IGRpZmY7
DQorCQkJCQlwcGFybXMtPmRpdl9yZWYgPSBkaXZfcmVmOw0KKwkJCQkJcHBhcm1zLT5kaXZfb3V0
ID0gZGl2X291dDsNCisJCQkJCXBwYXJtcy0+bG9vcGMgPSBsb29wYzsNCisNCisJCQkJCWlmIChk
aWZmID09IDApIHsNCisJCQkJCQkqcG91dCA9ICpwcGFybXM7DQorCQkJCQkJcmV0dXJuIDA7DQor
CQkJCQl9DQorCQkJCX0NCisJCQl9DQorCQl9DQorCX0NCisNCisJLyogc3RpbGwgYWNjZXB0YWJs
ZSAqLw0KKwlpZiAobWluIDwgdG9sZXJhbmNlKSB7DQorCQkqcG91dCA9ICpwcGFybXM7DQorCQly
ZXR1cm4gMDsNCisJfQ0KKw0KKwlkcm1fZGJnKHRoaXMtPmRkZXYsICJjYW4ndCBmaW5kIHN1aXRh
YmxlIHBhcmFtcyBmb3IgJXUga2h6XG4iLCBjbG9jayk7DQorDQorCXJldHVybiBtaW47DQorfQ0K
Kw0KKy8qIFBpeGVsIHBsbCBoYXJkd2FyZSByZWxhdGVkIG9wcywgcGVyIGRpc3BsYXkgcGlwZSAq
Lw0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX3JyZWcoc3RydWN0IGxzZGNfcGl4cGxsICp0aGlz
LA0KKwkJCSAgdW5pb24gbHNkY19waXhwbGxfcmVnX2JpdG1hcCAqZHN0KQ0KK3sNCisjaWYgZGVm
aW5lZChDT05GSUdfNjRCSVQpDQorCWRzdC0+ZCA9IHJlYWRxKHRoaXMtPm1taW8pOw0KKyNlbHNl
DQorCWRzdC0+d1swXSA9IHJlYWRsKHRoaXMtPm1taW8pOw0KKwlkc3QtPndbMV0gPSByZWFkbCh0
aGlzLT5tbWlvICsgNCk7DQorI2VuZGlmDQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX3dy
ZWcoc3RydWN0IGxzZGNfcGl4cGxsICp0aGlzLA0KKwkJCSAgdW5pb24gbHNkY19waXhwbGxfcmVn
X2JpdG1hcCAqc3JjKQ0KK3sNCisjaWYgZGVmaW5lZChDT05GSUdfNjRCSVQpDQorCXdyaXRlcShz
cmMtPmQsIHRoaXMtPm1taW8pOw0KKyNlbHNlDQorCXdyaXRlbChzcmMtPndbMF0sIHRoaXMtPm1t
aW8pOw0KKwl3cml0ZWwoc3JjLT53WzFdLCB0aGlzLT5tbWlvICsgNCk7DQorI2VuZGlmDQorfQ0K
Kw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29wc19wb3dlcnVwKHN0cnVjdCBsc2RjX3BpeHBsbCAq
IGNvbnN0IHRoaXMpDQorew0KKwl1bmlvbiBsc2RjX3BpeHBsbF9yZWdfYml0bWFwIHBpeHBsbF9y
ZWc7DQorDQorCV9fcGl4cGxsX3JyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KKw0KKwlwaXhwbGxf
cmVnLmJpdG1hcC5wb3dlcmRvd24gPSAwOw0KKw0KKwlfX3BpeHBsbF93cmVnKHRoaXMsICZwaXhw
bGxfcmVnKTsNCit9DQorDQorc3RhdGljIHZvaWQgX19waXhwbGxfb3BzX3Bvd2VyZG93bihzdHJ1
Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0aGlzKQ0KK3sNCisJdW5pb24gbHNkY19waXhwbGxfcmVn
X2JpdG1hcCBwaXhwbGxfcmVnOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVn
KTsNCisNCisJcGl4cGxsX3JlZy5iaXRtYXAucG93ZXJkb3duID0gMTsNCisNCisJX19waXhwbGxf
d3JlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29w
c19vbihzdHJ1Y3QgbHNkY19waXhwbGwgKiBjb25zdCB0aGlzKQ0KK3sNCisJdW5pb24gbHNkY19w
aXhwbGxfcmVnX2JpdG1hcCBwaXhwbGxfcmVnOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZw
aXhwbGxfcmVnKTsNCisNCisJcGl4cGxsX3JlZy5iaXRtYXAuc2VsX291dCA9IDE7DQorDQorCV9f
cGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3Bp
eHBsbF9vcHNfb2ZmKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpDQorew0KKwl1bmlv
biBsc2RjX3BpeHBsbF9yZWdfYml0bWFwIHBpeHBsbF9yZWc7DQorDQorCV9fcGl4cGxsX3JyZWco
dGhpcywgJnBpeHBsbF9yZWcpOw0KKw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5zZWxfb3V0ID0gMDsN
CisNCisJX19waXhwbGxfd3JlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorfQ0KKw0KK3N0YXRpYyB2
b2lkIF9fcGl4cGxsX29wc19ieXBhc3Moc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykN
Cit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19w
aXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLmJ5
cGFzcyA9IDE7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisN
CitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfdW5ieXBhc3Moc3RydWN0IGxzZGNfcGl4cGxsICog
Y29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3Jl
ZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7DQorDQorCXBpeHBsbF9y
ZWcuYml0bWFwLmJ5cGFzcyA9IDA7DQorDQorCV9fcGl4cGxsX3dyZWcodGhpcywgJnBpeHBsbF9y
ZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNfdW50b2dnbGVfcGFyYW0oc3Ry
dWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3Jl
Z19iaXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3Jl
Zyk7DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLnNldF9wYXJhbSA9IDA7DQorDQorCV9fcGl4cGxs
X3dyZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9v
cHNfc2V0X3BhcmFtKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkJCSAgIHN0
cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyBjb25zdCAqcCkNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxs
X3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxs
X3JlZyk7DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLmRpdl9yZWYgPSBwLT5kaXZfcmVmOw0KKwlw
aXhwbGxfcmVnLmJpdG1hcC5sb29wYyA9IHAtPmxvb3BjOw0KKwlwaXhwbGxfcmVnLmJpdG1hcC5k
aXZfb3V0ID0gcC0+ZGl2X291dDsNCisNCisJX19waXhwbGxfd3JlZyh0aGlzLCAmcGl4cGxsX3Jl
Zyk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIF9fcGl4cGxsX29wc190b2dnbGVfcGFyYW0oc3RydWN0
IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19i
aXRtYXAgcGl4cGxsX3JlZzsNCisNCisJX19waXhwbGxfcnJlZyh0aGlzLCAmcGl4cGxsX3JlZyk7
DQorDQorCXBpeHBsbF9yZWcuYml0bWFwLnNldF9wYXJhbSA9IDE7DQorDQorCV9fcGl4cGxsX3dy
ZWcodGhpcywgJnBpeHBsbF9yZWcpOw0KK30NCisNCitzdGF0aWMgdm9pZCBfX3BpeHBsbF9vcHNf
d2FpdF9sb2NrZWQoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcykNCit7DQorCXVuaW9u
IGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4cGxsX3JlZzsNCisJdW5zaWduZWQgaW50IGNvdW50
ZXIgPSAwOw0KKw0KKwlkbyB7DQorCQlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhwbGxfcmVnKTsN
CisNCisJCWlmIChwaXhwbGxfcmVnLmJpdG1hcC5sb2NrZWQpDQorCQkJYnJlYWs7DQorDQorCQkr
K2NvdW50ZXI7DQorCX0gd2hpbGUgKGNvdW50ZXIgPCAyMDAwKTsNCisNCisJZHJtX2RiZyh0aGlz
LT5kZGV2LCAiJXUgbG9vcCB3YWl0ZWRcbiIsIGNvdW50ZXIpOw0KK30NCisNCisvKg0KKyAqIFVw
ZGF0ZSB0aGUgUExMIHBhcmFtZXRlcnMgdG8gdGhlIFBMTCBoYXJkd2FyZQ0KKyAqDQorICogQHRo
aXM6IHBvaW50IHRvIHRoZSBvYmplY3QgZnJvbSB3aGljaCB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxl
ZA0KKyAqIEBwaW46IHBvaW50IHRvIHRoZSBzdHJ1Y3Qgb2YgbHNkY19waXhwbGxfcGFybXMgcGFz
c2VkIGluDQorICoNCisgKiByZXR1cm4gMCBpZiBzdWNjZXNzZnVsLg0KKyAqLw0KK3N0YXRpYyBp
bnQgbHNkY19waXhwbGxfdXBkYXRlKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQor
CQkJICAgICAgc3RydWN0IGxzZGNfcGl4cGxsX3Bhcm1zIGNvbnN0ICpwaW4pDQorew0KKwlfX3Bp
eHBsbF9vcHNfYnlwYXNzKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfb2ZmKHRoaXMpOw0KKw0K
KwlfX3BpeHBsbF9vcHNfcG93ZXJkb3duKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfdG9nZ2xl
X3BhcmFtKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfc2V0X3BhcmFtKHRoaXMsIHBpbik7DQor
DQorCV9fcGl4cGxsX29wc191bnRvZ2dsZV9wYXJhbSh0aGlzKTsNCisNCisJX19waXhwbGxfb3Bz
X3Bvd2VydXAodGhpcyk7DQorDQorCXVkZWxheSgyKTsNCisNCisJX19waXhwbGxfb3BzX3dhaXRf
bG9ja2VkKHRoaXMpOw0KKw0KKwlfX3BpeHBsbF9vcHNfb24odGhpcyk7DQorDQorCV9fcGl4cGxs
X29wc191bmJ5cGFzcyh0aGlzKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3N0YXRpYyB1bnNp
Z25lZCBpbnQgbHNkY19waXhwbGxfZ2V0X2ZyZXEoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3Qg
dGhpcykNCit7DQorCXN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcHBhciA9IHRoaXMtPnByaXY7
DQorCXVuaW9uIGxzZGNfcGl4cGxsX3JlZ19iaXRtYXAgcGl4X3BsbF9yZWc7DQorCXVuc2lnbmVk
IGludCBmcmVxOw0KKw0KKwlfX3BpeHBsbF9ycmVnKHRoaXMsICZwaXhfcGxsX3JlZyk7DQorDQor
CXBwYXItPmRpdl9yZWYgPSBwaXhfcGxsX3JlZy5iaXRtYXAuZGl2X3JlZjsNCisJcHBhci0+bG9v
cGMgPSBwaXhfcGxsX3JlZy5iaXRtYXAubG9vcGM7DQorCXBwYXItPmRpdl9vdXQgPSBwaXhfcGxs
X3JlZy5iaXRtYXAuZGl2X291dDsNCisNCisJZnJlcSA9IHBwYXItPnJlZl9jbG9jayAvIHBwYXIt
PmRpdl9yZWYgKiBwcGFyLT5sb29wYyAvIHBwYXItPmRpdl9vdXQ7DQorDQorCXJldHVybiBmcmVx
Ow0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3BpeHBsbF9wcmludChzdHJ1Y3QgbHNkY19waXhw
bGwgKiBjb25zdCB0aGlzLA0KKwkJCSAgICAgIHN0cnVjdCBkcm1fcHJpbnRlciAqcCkNCit7DQor
CXN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcGFybXMgPSB0aGlzLT5wcml2Ow0KKw0KKwlkcm1f
cHJpbnRmKHAsICJkaXZfcmVmOiAldSwgbG9vcGM6ICV1LCBkaXZfb3V0OiAldVxuIiwNCisJCSAg
IHBhcm1zLT5kaXZfcmVmLCBwYXJtcy0+bG9vcGMsIHBhcm1zLT5kaXZfb3V0KTsNCit9DQorDQor
LyoNCisgKiBMUzdBMTAwMCwgTFM3QTIwMDAgYW5kIGxzMmsyMDAwJ3MgcGl4ZWwgcGxsIHNldHRp
bmcgcmVnaXN0ZXIgaXMgc2FtZSwNCisgKiB3ZSB0YWtlIHRoaXMgYXMgZGVmYXVsdCwgY3JlYXRl
IGEgbmV3IGluc3RhbmNlIGlmIGEgZGlmZmVyZW50IG1vZGVsIGlzDQorICogaW50cm9kdWNlZC4N
CisgKi8NCitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzIF9fcGl4cGxsX2Rl
ZmF1bHRfZnVuY3MgPSB7DQorCS5zZXR1cCA9IGxzZGNfcGl4ZWxfcGxsX3NldHVwLA0KKwkuY29t
cHV0ZSA9IGxzZGNfcGl4ZWxfcGxsX2NvbXB1dGUsDQorCS51cGRhdGUgPSBsc2RjX3BpeHBsbF91
cGRhdGUsDQorCS5nZXRfcmF0ZSA9IGxzZGNfcGl4cGxsX2dldF9mcmVxLA0KKwkucHJpbnQgPSBs
c2RjX3BpeHBsbF9wcmludCwNCit9Ow0KKw0KKy8qIHBpeGVsIHBsbCBpbml0aWFsaXphdGlvbiAq
Lw0KKw0KK2ludCBsc2RjX3BpeHBsbF9pbml0KHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRo
aXMsDQorCQkgICAgIHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJICAgICB1bnNpZ25lZCBp
bnQgaW5kZXgpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYp
Ow0KKwljb25zdCBzdHJ1Y3QgbHNkY19kZXNjICpkZXNjcCA9IGxkZXYtPmRlc2NwOw0KKwljb25z
dCBzdHJ1Y3QgbG9vbmdzb25fZ2Z4X2Rlc2MgKmdmeCA9IHRvX2xvb25nc29uX2dmeChkZXNjcCk7
DQorDQorCXRoaXMtPmRkZXYgPSBkZGV2Ow0KKwl0aGlzLT5yZWdfc2l6ZSA9IDg7DQorCXRoaXMt
PnJlZ19iYXNlID0gZ2Z4LT5jb25mX3JlZ19iYXNlICsgZ2Z4LT5waXhwbGxbaW5kZXhdLnJlZ19v
ZmZzZXQ7DQorCXRoaXMtPmZ1bmNzID0gJl9fcGl4cGxsX2RlZmF1bHRfZnVuY3M7DQorDQorCXJl
dHVybiB0aGlzLT5mdW5jcy0+c2V0dXAodGhpcyk7DQorfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9sb29uZ3Nvbi9sc2RjX3BpeHBsbC5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29u
L2xzZGNfcGl4cGxsLmgNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAwMDAwMDAwMDAu
LjA2ZWJjZGZjMTczMw0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2xvb25n
c29uL2xzZGNfcGl4cGxsLmgNCkBAIC0wLDAgKzEsODYgQEANCisvKiBTUERYLUxpY2Vuc2UtSWRl
bnRpZmllcjogR1BMLTIuMCAqLw0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExvb25nc29u
IFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpZm5kZWYgX19MU0RD
X1BJWFBMTF9IX18NCisjZGVmaW5lIF9fTFNEQ19QSVhQTExfSF9fDQorDQorI2luY2x1ZGUgPGRy
bS9kcm1fZGV2aWNlLmg+DQorDQorLyoNCisgKiBMb29uZ3NvbiBQaXhlbCBQTEwgaGFyZHdhcmUg
c3RydWN0dXJlDQorICoNCisgKiByZWZjbGs6IHJlZmVyZW5jZSBmcmVxdWVuY3ksIDEwMCBNSHog
ZnJvbSBleHRlcm5hbCBvc2NpbGxhdG9yDQorICogb3V0Y2xrOiBvdXRwdXQgZnJlcXVlbmN5IGRl
c2lyZWQuDQorICoNCisgKg0KKyAqICAgICAgICAgICAgICAgTDEgICAgICAgRnJlZiAgICAgICAg
ICAgICAgICAgICAgICBGdmNvICAgICBMMg0KKyAqIHJlZmNsayAgICstLS0tLS0tLS0tLSsgICAg
ICArLS0tLS0tLS0tLS0tLS0tLS0tKyAgICAgICstLS0tLS0tLS0rICAgb3V0Y2xrDQorICogLS0t
Ky0tLT4gfCBQcmVzY2FsZXIgfCAtLS0+IHwgQ2xvY2sgTXVsdGlwbGllciB8IC0tLT4gfCBkaXZp
ZGVyIHwgLS0tLS0tLS0+DQorICogICAgfCAgICAgKy0tLS0tLS0tLS0tKyAgICAgICstLS0tLS0t
LS0tLS0tLS0tLS0rICAgICAgKy0tLS0tLS0tLSsgICAgIF4NCisgKiAgICB8ICAgICAgICAgICBe
ICAgICAgICAgICAgICAgICAgICAgIF4gICAgICAgICAgICAgICAgICAgIF4gICAgICAgICAgfA0K
KyAqICAgIHwgICAgICAgICAgIHwgICAgICAgICAgICAgICAgICAgICAgfCAgICAgICAgICAgICAg
ICAgICAgfCAgICAgICAgICB8DQorICogICAgfCAgICAgICAgICAgfCAgICAgICAgICAgICAgICAg
ICAgICB8ICAgICAgICAgICAgICAgICAgICB8ICAgICAgICAgIHwNCisgKiAgICB8ICAgICAgICBk
aXZfcmVmICAgICAgICAgICAgICAgICBsb29wYyAgICAgICAgICAgICAgIGRpdl9vdXQgICAgICAg
fA0KKyAqICAgIHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8DQorICogICAgKy0tLS0gYnlwYXNzIChieXBhc3MgYWJvdmUg
c29mdHdhcmUgY29uZmlndXJhYmxlIGNsb2NrIGlmIHNldCkgLS0tLSsNCisgKg0KKyAqICAgb3V0
Y2xrID0gcmVmY2xrIC8gZGl2X3JlZiAqIGxvb3BjIC8gZGl2X291dDsNCisgKg0KKyAqICAgc2Vs
X291dDogUExMIGNsb2NrIG91dHB1dCBzZWxlY3RvcihlbmFibGUpLg0KKyAqDQorICogICBJZiBz
ZWxfb3V0ID09IDEsIHRoZW4gZW5hYmxlIG91dHB1dCBjbG9jayAodHVybiBPbik7DQorICogICBJ
ZiBzZWxfb3V0ID09IDAsIHRoZW4gZGlzYWJsZSBvdXRwdXQgY2xvY2sgKHR1cm4gT2ZmKTsNCisg
Kg0KKyAqIFBMTCB3b3JraW5nIHJlcXVpcmVtZW50czoNCisgKg0KKyAqICAxKSAyMCBNSHogPD0g
cmVmY2xrIC8gZGl2X3JlZiA8PSA0ME1oeg0KKyAqICAyKSAxLjIgR0h6IDw9IHJlZmNsayAvZGl2
X291dCAqIGxvb3BjIDw9IDMuMiBHaHoNCisgKi8NCisNCitzdHJ1Y3QgbHNkY19waXhwbGxfcGFy
bXMgew0KKwl1bnNpZ25lZCBpbnQgcmVmX2Nsb2NrOw0KKwl1bnNpZ25lZCBpbnQgZGl2X3JlZjsN
CisJdW5zaWduZWQgaW50IGxvb3BjOw0KKwl1bnNpZ25lZCBpbnQgZGl2X291dDsNCit9Ow0KKw0K
K3N0cnVjdCBsc2RjX3BpeHBsbDsNCisNCitzdHJ1Y3QgbHNkY19waXhwbGxfZnVuY3Mgew0KKwlp
bnQgKCpzZXR1cCkoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcyk7DQorDQorCWludCAo
KmNvbXB1dGUpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkgICAgICAgdW5z
aWduZWQgaW50IGNsb2NrLA0KKwkJICAgICAgIHN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyAqcG91
dCk7DQorDQorCWludCAoKnVwZGF0ZSkoc3RydWN0IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcywN
CisJCSAgICAgIHN0cnVjdCBsc2RjX3BpeHBsbF9wYXJtcyBjb25zdCAqcGluKTsNCisNCisJdW5z
aWduZWQgaW50ICgqZ2V0X3JhdGUpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMpOw0K
Kw0KKwl2b2lkICgqcHJpbnQpKHN0cnVjdCBsc2RjX3BpeHBsbCAqIGNvbnN0IHRoaXMsDQorCQkg
ICAgICBzdHJ1Y3QgZHJtX3ByaW50ZXIgKnByaW50ZXIpOw0KK307DQorDQorc3RydWN0IGxzZGNf
cGl4cGxsIHsNCisJY29uc3Qgc3RydWN0IGxzZGNfcGl4cGxsX2Z1bmNzICpmdW5jczsNCisNCisJ
c3RydWN0IGRybV9kZXZpY2UgKmRkZXY7DQorDQorCS8qIFBMTCByZWdpc3RlciBvZmZzZXQgKi8N
CisJdTMyIHJlZ19iYXNlOw0KKwkvKiBQTEwgcmVnaXN0ZXIgc2l6ZSBpbiBieXRlcyAqLw0KKwl1
MzIgcmVnX3NpemU7DQorDQorCXZvaWQgX19pb21lbSAqbW1pbzsNCisNCisJc3RydWN0IGxzZGNf
cGl4cGxsX3Bhcm1zICpwcml2Ow0KK307DQorDQoraW50IGxzZGNfcGl4cGxsX2luaXQoc3RydWN0
IGxzZGNfcGl4cGxsICogY29uc3QgdGhpcywNCisJCSAgICAgc3RydWN0IGRybV9kZXZpY2UgKmRk
ZXYsDQorCQkgICAgIHVuc2lnbmVkIGludCBpbmRleCk7DQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcGxhbmUuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS9sb29uZ3Nvbi9sc2RjX3BsYW5lLmMNCm5ldyBmaWxlIG1vZGUgMTAwNjQ0DQppbmRleCAwMDAw
MDAwMDAwMDAuLmY3MzE0MGVkOTg1NA0KLS0tIC9kZXYvbnVsbA0KKysrIGIvZHJpdmVycy9ncHUv
ZHJtL2xvb25nc29uL2xzZGNfcGxhbmUuYw0KQEAgLTAsMCArMSw2MzkgQEANCisvLyBTUERYLUxp
Y2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMA0KKy8qDQorICogQ29weXJpZ2h0IChDKSAyMDIzIExv
b25nc29uIFRlY2hub2xvZ3kgQ29ycG9yYXRpb24gTGltaXRlZA0KKyAqLw0KKw0KKyNpbmNsdWRl
IDxsaW51eC9kZWxheS5oPg0KKw0KKyNpbmNsdWRlIDxkcm0vZHJtX2F0b21pYy5oPg0KKyNpbmNs
dWRlIDxkcm0vZHJtX2F0b21pY19oZWxwZXIuaD4NCisjaW5jbHVkZSA8ZHJtL2RybV9mcmFtZWJ1
ZmZlci5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX2dlbV9hdG9taWNfaGVscGVyLmg+DQorI2luY2x1
ZGUgPGRybS9kcm1fcGxhbmVfaGVscGVyLmg+DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQor
I2luY2x1ZGUgImxzZGNfcmVncy5oIg0KKyNpbmNsdWRlICJsc2RjX3R0bS5oIg0KKw0KK3N0YXRp
YyBjb25zdCB1MzIgbHNkY19wcmltYXJ5X2Zvcm1hdHNbXSA9IHsNCisJRFJNX0ZPUk1BVF9YUkdC
ODg4OCwNCit9Ow0KKw0KK3N0YXRpYyBjb25zdCB1MzIgbHNkY19jdXJzb3JfZm9ybWF0c1tdID0g
ew0KKwlEUk1fRk9STUFUX0FSR0I4ODg4LA0KK307DQorDQorc3RhdGljIGNvbnN0IHU2NCBsc2Rj
X2ZiX2Zvcm1hdF9tb2RpZmllcnNbXSA9IHsNCisJRFJNX0ZPUk1BVF9NT0RfTElORUFSLA0KKwlE
Uk1fRk9STUFUX01PRF9JTlZBTElEDQorfTsNCisNCitzdGF0aWMgdW5zaWduZWQgaW50IGxzZGNf
Z2V0X2ZiX29mZnNldChzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYiwNCisJCQkJICAgICAgIHN0
cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQ0KK3sNCisJdW5zaWduZWQgaW50IG9mZnNldCA9
IGZiLT5vZmZzZXRzWzBdOw0KKw0KKwlvZmZzZXQgKz0gZmItPmZvcm1hdC0+Y3BwWzBdICogKHN0
YXRlLT5zcmNfeCA+PiAxNik7DQorCW9mZnNldCArPSBmYi0+cGl0Y2hlc1swXSAqIChzdGF0ZS0+
c3JjX3kgPj4gMTYpOw0KKw0KKwlyZXR1cm4gb2Zmc2V0Ow0KK30NCisNCitzdGF0aWMgdTY0IGxz
ZGNfZmJfZG1hX2Jhc2VfYWRkcihzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYikNCit7DQorCXN0
cnVjdCBsc2RjX2JvICpsYm8gPSBnZW1fdG9fbHNkY19ibyhmYi0+b2JqWzBdKTsNCisJc3RydWN0
IGxzZGNfZGV2aWNlICpsZGV2ID0gdG9fbHNkYyhmYi0+ZGV2KTsNCisNCisJcmV0dXJuIGxzZGNf
Ym9fZ3B1X29mZnNldChsYm8pICsgbGRldi0+dnJhbV9iYXNlOw0KK30NCisNCitzdGF0aWMgaW50
IGxzZGNfcHJpbWFyeV9hdG9taWNfY2hlY2soc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJ
CSAgICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGRybV9w
bGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlID0gZHJtX2F0b21pY19nZXRfbmV3X3BsYW5lX3N0
YXRlKHN0YXRlLCBwbGFuZSk7DQorCXN0cnVjdCBkcm1fY3J0YyAqY3J0YyA9IG5ld19wbGFuZV9z
dGF0ZS0+Y3J0YzsNCisJc3RydWN0IGRybV9jcnRjX3N0YXRlICpuZXdfY3J0Y19zdGF0ZTsNCisN
CisJaWYgKCFjcnRjKQ0KKwkJcmV0dXJuIDA7DQorDQorCW5ld19jcnRjX3N0YXRlID0gZHJtX2F0
b21pY19nZXRfbmV3X2NydGNfc3RhdGUoc3RhdGUsIGNydGMpOw0KKw0KKwlyZXR1cm4gZHJtX2F0
b21pY19oZWxwZXJfY2hlY2tfcGxhbmVfc3RhdGUobmV3X3BsYW5lX3N0YXRlLA0KKwkJCQkJCSAg
IG5ld19jcnRjX3N0YXRlLA0KKwkJCQkJCSAgIERSTV9QTEFORV9OT19TQ0FMSU5HLA0KKwkJCQkJ
CSAgIERSTV9QTEFORV9OT19TQ0FMSU5HLA0KKwkJCQkJCSAgIGZhbHNlLA0KKwkJCQkJCSAgIHRy
dWUpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3ByaW1hcnlfYXRvbWljX3VwZGF0ZShzdHJ1
Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJICAgICAgIHN0cnVjdCBkcm1fYXRvbWljX3N0YXRl
ICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX3ByaW1hcnkgKnByaW1hcnkgPSB0b19sc2RjX3By
aW1hcnkocGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpvbGRfcGxhbmVfc3RhdGUg
PSBkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsNCisJc3RydWN0
IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlID0gZHJtX2F0b21pY19nZXRfbmV3X3Bs
YW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKm5ld19m
YiA9IG5ld19wbGFuZV9zdGF0ZS0+ZmI7DQorCXN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKm9sZF9m
YiA9IG9sZF9wbGFuZV9zdGF0ZS0+ZmI7DQorCWNvbnN0IHN0cnVjdCBsc2RjX3ByaW1hcnlfcGxh
bmVfb3BzICpod19vcHMgPSBwcmltYXJ5LT5vcHM7DQorCXU2NCBmYl9hZGRyOw0KKw0KKwlmYl9h
ZGRyID0gbHNkY19mYl9kbWFfYmFzZV9hZGRyKG5ld19mYik7DQorCWZiX2FkZHIgKz0gbHNkY19n
ZXRfZmJfb2Zmc2V0KG5ld19mYiwgbmV3X3BsYW5lX3N0YXRlKTsNCisNCisJZHJtX2RiZyhwbGFu
ZS0+ZGV2LCAiZmIgZG1hIGFkZHI6ICVsbHhcbiIsIGZiX2FkZHIpOw0KKw0KKwlod19vcHMtPnVw
ZGF0ZV9mYl9hZGRyKHByaW1hcnksIGZiX2FkZHIpOw0KKwlod19vcHMtPnVwZGF0ZV9mYl9zdHJp
ZGUocHJpbWFyeSwgbmV3X2ZiLT5waXRjaGVzWzBdKTsNCisNCisJaWYgKCFvbGRfZmIgfHwgb2xk
X2ZiLT5mb3JtYXQgIT0gbmV3X2ZiLT5mb3JtYXQpDQorCQlod19vcHMtPnVwZGF0ZV9mYl9mb3Jt
YXQocHJpbWFyeSwgbmV3X2ZiLT5mb3JtYXQpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3By
aW1hcnlfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQlzdHJ1
Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwkvKiBEbyBub3RoaW5nLCBqdXN0IHBy
ZXZlbnQgY2FsbCBpbnRvIGF0b21pY191cGRhdGUoKS4NCisJICogV3JpdGluZyB0aGUgZm9ybWF0
IGFzIExTRENfUEZfTk9ORSBjYW4gZGlzYWJsZSB0aGUgcHJpbWFyeSwNCisJICogQnV0IGl0IHNl
ZW1zIG5vdCBuZWNlc3NhcnkuLi4NCisJICovDQorCWRybV9kYmcocGxhbmUtPmRldiwgIiVzIGRp
c2FibGVkXG4iLCBwbGFuZS0+bmFtZSk7DQorfQ0KKw0KK3N0YXRpYyBpbnQgbHNkY19wbGFuZV9w
cmVwYXJlX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0KKwkJCQkgc3RydWN0IGRybV9wbGFu
ZV9zdGF0ZSAqbmV3X3N0YXRlKQ0KK3sNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqZmIgPSBu
ZXdfc3RhdGUtPmZiOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJvOw0KKwl1NjQgZ3B1X3ZhZGRyOw0K
KwlpbnQgcmV0Ow0KKw0KKwlpZiAoIWZiKQ0KKwkJcmV0dXJuIDA7DQorDQorCWxibyA9IGdlbV90
b19sc2RjX2JvKGZiLT5vYmpbMF0pOw0KKw0KKwlyZXQgPSBsc2RjX2JvX3Jlc2VydmUobGJvKTsN
CisJaWYgKHVubGlrZWx5KHJldCkpIHsNCisJCWRybV9lcnIocGxhbmUtPmRldiwgImJvICVwIHJl
c2VydmUgZmFpbGVkXG4iLCBsYm8pOw0KKwkJcmV0dXJuIHJldDsNCisJfQ0KKw0KKwlyZXQgPSBs
c2RjX2JvX3BpbihsYm8sIExTRENfR0VNX0RPTUFJTl9WUkFNLCAmZ3B1X3ZhZGRyKTsNCisNCisJ
bHNkY19ib191bnJlc2VydmUobGJvKTsNCisNCisJaWYgKHVubGlrZWx5KHJldCkpIHsNCisJCWRy
bV9lcnIocGxhbmUtPmRldiwgImJvICVwIHBpbiBmYWlsZWRcbiIsIGxibyk7DQorCQlyZXR1cm4g
cmV0Ow0KKwl9DQorDQorCWxzZGNfYm9fcmVmKGxibyk7DQorDQorCWlmIChwbGFuZS0+dHlwZSAh
PSBEUk1fUExBTkVfVFlQRV9DVVJTT1IpDQorCQlkcm1fZGJnKHBsYW5lLT5kZXYsICIlc1slcF0g
cGluIGF0IDB4JWxseCwgYm8gc2l6ZTogJXp1XG4iLA0KKwkJCXBsYW5lLT5uYW1lLCBsYm8sIGdw
dV92YWRkciwgbHNkY19ib19zaXplKGxibykpOw0KKw0KKwlyZXR1cm4gZHJtX2dlbV9wbGFuZV9o
ZWxwZXJfcHJlcGFyZV9mYihwbGFuZSwgbmV3X3N0YXRlKTsNCit9DQorDQorc3RhdGljIHZvaWQg
bHNkY19wbGFuZV9jbGVhbnVwX2ZiKHN0cnVjdCBkcm1fcGxhbmUgKnBsYW5lLA0KKwkJCQkgIHN0
cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9zdGF0ZSkNCit7DQorCXN0cnVjdCBkcm1fZnJhbWVi
dWZmZXIgKmZiID0gb2xkX3N0YXRlLT5mYjsNCisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisJaW50
IHJldDsNCisNCisJaWYgKCFmYikNCisJCXJldHVybjsNCisNCisJbGJvID0gZ2VtX3RvX2xzZGNf
Ym8oZmItPm9ialswXSk7DQorDQorCXJldCA9IGxzZGNfYm9fcmVzZXJ2ZShsYm8pOw0KKwlpZiAo
dW5saWtlbHkocmV0KSkgew0KKwkJZHJtX2VycihwbGFuZS0+ZGV2LCAiJXAgcmVzZXJ2ZSBmYWls
ZWRcbiIsIGxibyk7DQorCQlyZXR1cm47DQorCX0NCisNCisJbHNkY19ib191bnBpbihsYm8pOw0K
Kw0KKwlsc2RjX2JvX3VucmVzZXJ2ZShsYm8pOw0KKw0KKwlsc2RjX2JvX3VucmVmKGxibyk7DQor
DQorCWlmIChwbGFuZS0+dHlwZSAhPSBEUk1fUExBTkVfVFlQRV9DVVJTT1IpDQorCQlkcm1fZGJn
KHBsYW5lLT5kZXYsICIlcyB1bnBpblxuIiwgcGxhbmUtPm5hbWUpOw0KK30NCisNCitzdGF0aWMg
Y29uc3Qgc3RydWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgbHNkY19wcmltYXJ5X2hlbHBlcl9m
dW5jcyA9IHsNCisJLnByZXBhcmVfZmIgPSBsc2RjX3BsYW5lX3ByZXBhcmVfZmIsDQorCS5jbGVh
bnVwX2ZiID0gbHNkY19wbGFuZV9jbGVhbnVwX2ZiLA0KKwkuYXRvbWljX2NoZWNrID0gbHNkY19w
cmltYXJ5X2F0b21pY19jaGVjaywNCisJLmF0b21pY191cGRhdGUgPSBsc2RjX3ByaW1hcnlfYXRv
bWljX3VwZGF0ZSwNCisJLmF0b21pY19kaXNhYmxlID0gbHNkY19wcmltYXJ5X2F0b21pY19kaXNh
YmxlLA0KK307DQorDQorc3RhdGljIGludCBsc2RjX2N1cnNvcl9hdG9taWNfY2hlY2soc3RydWN0
IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCSAgICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3Rh
dGUpDQorew0KKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1f
YXRvbWljX2dldF9uZXdfcGxhbmVfc3RhdGUoc3RhdGUsIHBsYW5lKTsNCisJc3RydWN0IGRybV9j
cnRjICpjcnRjID0gbmV3X3BsYW5lX3N0YXRlLT5jcnRjOw0KKwlzdHJ1Y3QgZHJtX2NydGNfc3Rh
dGUgKm5ld19jcnRjX3N0YXRlOw0KKw0KKwlpZiAoIWNydGMpDQorCQlyZXR1cm4gMDsNCisNCisJ
bmV3X2NydGNfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfY3J0Y19zdGF0ZShzdGF0ZSwgY3J0
Yyk7DQorDQorCXJldHVybiBkcm1fYXRvbWljX2hlbHBlcl9jaGVja19wbGFuZV9zdGF0ZShuZXdf
cGxhbmVfc3RhdGUsDQorCQkJCQkJICAgbmV3X2NydGNfc3RhdGUsDQorCQkJCQkJICAgRFJNX1BM
QU5FX05PX1NDQUxJTkcsDQorCQkJCQkJICAgRFJNX1BMQU5FX05PX1NDQUxJTkcsDQorCQkJCQkJ
ICAgdHJ1ZSwNCisJCQkJCQkgICB0cnVlKTsNCit9DQorDQorc3RhdGljIHZvaWQgbHM3YTEwMDBf
Y3Vyc29yX2F0b21pY191cGRhdGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkgIHN0
cnVjdCBkcm1fYXRvbWljX3N0YXRlICpzdGF0ZSkNCit7DQorCXN0cnVjdCBsc2RjX2N1cnNvciAq
Y3Vyc29yID0gdG9fbHNkY19jdXJzb3IocGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX3BsYW5lX3N0YXRl
ICpvbGRfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9vbGRfcGxhbmVfc3RhdGUoc3RhdGUs
IHBsYW5lKTsNCisJc3RydWN0IGRybV9wbGFuZV9zdGF0ZSAqbmV3X3BsYW5lX3N0YXRlID0gZHJt
X2F0b21pY19nZXRfbmV3X3BsYW5lX3N0YXRlKHN0YXRlLCBwbGFuZSk7DQorCXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKm5ld19mYiA9IG5ld19wbGFuZV9zdGF0ZS0+ZmI7DQorCXN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKm9sZF9mYiA9IG9sZF9wbGFuZV9zdGF0ZS0+ZmI7DQorCWNvbnN0IHN0cnVj
dCBsc2RjX2N1cnNvcl9wbGFuZV9vcHMgKmh3X29wcyA9IGN1cnNvci0+b3BzOw0KKwl1NjQgYWRk
ciA9IGxzZGNfZmJfZG1hX2Jhc2VfYWRkcihuZXdfZmIpOw0KKw0KKwlod19vcHMtPnVwZGF0ZV9w
b3NpdGlvbihjdXJzb3IsIG5ld19wbGFuZV9zdGF0ZS0+Y3J0Y194LCBuZXdfcGxhbmVfc3RhdGUt
PmNydGNfeSk7DQorDQorCWlmICghb2xkX2ZiIHx8IG5ld19mYiAhPSBvbGRfZmIpDQorCQlod19v
cHMtPnVwZGF0ZV9ib19hZGRyKGN1cnNvciwgYWRkcik7DQorDQorCWh3X29wcy0+dXBkYXRlX2Nm
ZyhjdXJzb3IsIENVUlNPUl9TSVpFXzMyWDMyLCBDVVJTT1JfRk9STUFUX0FSR0I4ODg4KTsNCit9
DQorDQorc3RhdGljIHZvaWQgbHM3YTEwMDBfY3Vyc29yX2F0b21pY19kaXNhYmxlKHN0cnVjdCBk
cm1fcGxhbmUgKnBsYW5lLA0KKwkJCQkJICAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0YXRl
KQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3IgPSB0b19sc2RjX2N1cnNvcihwbGFu
ZSk7DQorCWNvbnN0IHN0cnVjdCBsc2RjX2N1cnNvcl9wbGFuZV9vcHMgKmh3X29wcyA9IGN1cnNv
ci0+b3BzOw0KKw0KKwlod19vcHMtPnVwZGF0ZV9jZmcoY3Vyc29yLCBDVVJTT1JfU0laRV8zMlgz
MiwgQ1VSU09SX0ZPUk1BVF9ESVNBQkxFKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBk
cm1fcGxhbmVfaGVscGVyX2Z1bmNzIGxzN2ExMDAwX2N1cnNvcl9oZWxwZXJfZnVuY3MgPSB7DQor
CS5wcmVwYXJlX2ZiID0gbHNkY19wbGFuZV9wcmVwYXJlX2ZiLA0KKwkuY2xlYW51cF9mYiA9IGxz
ZGNfcGxhbmVfY2xlYW51cF9mYiwNCisJLmF0b21pY19jaGVjayA9IGxzZGNfY3Vyc29yX2F0b21p
Y19jaGVjaywNCisJLmF0b21pY191cGRhdGUgPSBsczdhMTAwMF9jdXJzb3JfYXRvbWljX3VwZGF0
ZSwNCisJLmF0b21pY19kaXNhYmxlID0gbHM3YTEwMDBfY3Vyc29yX2F0b21pY19kaXNhYmxlLA0K
K307DQorDQorLyogdXBkYXRlIHRoZSBmb3JtYXQsIHNpemUgYW5kIGxvY2F0aW9uIG9mIHRoZSBj
dXJzb3IgKi8NCitzdGF0aWMgdm9pZCBsczdhMjAwMF9jdXJzb3JfYXRvbWljX3VwZGF0ZShzdHJ1
Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkJCSAgc3RydWN0IGRybV9hdG9taWNfc3RhdGUgKnN0
YXRlKQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3IgPSB0b19sc2RjX2N1cnNvcihw
bGFuZSk7DQorCXN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKm9sZF9wbGFuZV9zdGF0ZSA9IGRybV9h
dG9taWNfZ2V0X29sZF9wbGFuZV9zdGF0ZShzdGF0ZSwgcGxhbmUpOw0KKwlzdHJ1Y3QgZHJtX3Bs
YW5lX3N0YXRlICpuZXdfcGxhbmVfc3RhdGUgPSBkcm1fYXRvbWljX2dldF9uZXdfcGxhbmVfc3Rh
dGUoc3RhdGUsIHBsYW5lKTsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqbmV3X2ZiID0gbmV3
X3BsYW5lX3N0YXRlLT5mYjsNCisJc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAqb2xkX2ZiID0gb2xk
X3BsYW5lX3N0YXRlLT5mYjsNCisJY29uc3Qgc3RydWN0IGxzZGNfY3Vyc29yX3BsYW5lX29wcyAq
aHdfb3BzID0gY3Vyc29yLT5vcHM7DQorCXU2NCBhZGRyID0gbHNkY19mYl9kbWFfYmFzZV9hZGRy
KG5ld19mYik7DQorDQorCWh3X29wcy0+dXBkYXRlX3Bvc2l0aW9uKGN1cnNvciwgbmV3X3BsYW5l
X3N0YXRlLT5jcnRjX3gsIG5ld19wbGFuZV9zdGF0ZS0+Y3J0Y195KTsNCisNCisJaWYgKCFvbGRf
ZmIgfHwgbmV3X2ZiICE9IG9sZF9mYikNCisJCWh3X29wcy0+dXBkYXRlX2JvX2FkZHIoY3Vyc29y
LCBhZGRyKTsNCisNCisJaHdfb3BzLT51cGRhdGVfY2ZnKGN1cnNvciwgQ1VSU09SX1NJWkVfNjRY
NjQsIENVUlNPUl9GT1JNQVRfQVJHQjg4ODgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsczdhMjAw
MF9jdXJzb3JfYXRvbWljX2Rpc2FibGUoc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJCQkg
ICBzdHJ1Y3QgZHJtX2F0b21pY19zdGF0ZSAqc3RhdGUpDQorew0KKwlzdHJ1Y3QgbHNkY19jdXJz
b3IgKmN1cnNvciA9IHRvX2xzZGNfY3Vyc29yKHBsYW5lKTsNCisJY29uc3Qgc3RydWN0IGxzZGNf
Y3Vyc29yX3BsYW5lX29wcyAqaHdfb3BzID0gY3Vyc29yLT5vcHM7DQorDQorCWh3X29wcy0+dXBk
YXRlX2NmZyhjdXJzb3IsIENVUlNPUl9TSVpFXzY0WDY0LCBDVVJTT1JfRk9STUFUX0RJU0FCTEUp
Ow0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRybV9wbGFuZV9oZWxwZXJfZnVuY3MgbHM3
YTIwMDBfY3Vyc29yX2hlbHBlcl9mdW5jcyA9IHsNCisJLnByZXBhcmVfZmIgPSBsc2RjX3BsYW5l
X3ByZXBhcmVfZmIsDQorCS5jbGVhbnVwX2ZiID0gbHNkY19wbGFuZV9jbGVhbnVwX2ZiLA0KKwku
YXRvbWljX2NoZWNrID0gbHNkY19jdXJzb3JfYXRvbWljX2NoZWNrLA0KKwkuYXRvbWljX3VwZGF0
ZSA9IGxzN2EyMDAwX2N1cnNvcl9hdG9taWNfdXBkYXRlLA0KKwkuYXRvbWljX2Rpc2FibGUgPSBs
czdhMjAwMF9jdXJzb3JfYXRvbWljX2Rpc2FibGUsDQorfTsNCisNCitzdGF0aWMgdm9pZCBsc2Rj
X3BsYW5lX2F0b21pY19wcmludF9zdGF0ZShzdHJ1Y3QgZHJtX3ByaW50ZXIgKnAsDQorCQkJCQkg
IGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfc3RhdGUgKnN0YXRlKQ0KK3sNCisJc3RydWN0IGRybV9m
cmFtZWJ1ZmZlciAqZmIgPSBzdGF0ZS0+ZmI7DQorCXU2NCBhZGRyOw0KKw0KKwlpZiAoIWZiKQ0K
KwkJcmV0dXJuOw0KKw0KKwlhZGRyID0gbHNkY19mYl9kbWFfYmFzZV9hZGRyKGZiKTsNCisNCisJ
ZHJtX3ByaW50ZihwLCAiXHRkbWEgYWRkcj0lbGx4XG4iLCBhZGRyKTsNCit9DQorDQorc3RhdGlj
IGNvbnN0IHN0cnVjdCBkcm1fcGxhbmVfZnVuY3MgbHNkY19wbGFuZV9mdW5jcyA9IHsNCisJLnVw
ZGF0ZV9wbGFuZSA9IGRybV9hdG9taWNfaGVscGVyX3VwZGF0ZV9wbGFuZSwNCisJLmRpc2FibGVf
cGxhbmUgPSBkcm1fYXRvbWljX2hlbHBlcl9kaXNhYmxlX3BsYW5lLA0KKwkuZGVzdHJveSA9IGRy
bV9wbGFuZV9jbGVhbnVwLA0KKwkucmVzZXQgPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9yZXNl
dCwNCisJLmF0b21pY19kdXBsaWNhdGVfc3RhdGUgPSBkcm1fYXRvbWljX2hlbHBlcl9wbGFuZV9k
dXBsaWNhdGVfc3RhdGUsDQorCS5hdG9taWNfZGVzdHJveV9zdGF0ZSA9IGRybV9hdG9taWNfaGVs
cGVyX3BsYW5lX2Rlc3Ryb3lfc3RhdGUsDQorCS5hdG9taWNfcHJpbnRfc3RhdGUgPSBsc2RjX3Bs
YW5lX2F0b21pY19wcmludF9zdGF0ZSwNCit9Ow0KKw0KKy8qIHByaW1hcnkgcGxhbmUgaGFyZHdh
cmUgcmVsYXRlZCBvcHMsIGZvciBwcmltYXJ5IHBsYW5lIDAgKi8NCisNCitzdGF0aWMgdm9pZCBs
c2RjX3ByaW1hcnkwX3VwZGF0ZV9mYl9hZGRyKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnByaW1hcnks
IHU2NCBmYl9hZGRyKQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gcHJpbWFyeS0+
bGRldjsNCisJdTMyIHN0YXR1czsNCisJdTMyIGxvLCBoaTsNCisNCisJLyogNDAtYml0IHdpZHRo
IHBoeXNpY2FsIGFkZHJlc3MgYnVzICovDQorCWxvID0gZmJfYWRkciAmIDB4RkZGRkZGRkY7DQor
CWhpID0gKGZiX2FkZHIgPj4gMzIpICYgMHhGRjsNCisNCisJc3RhdHVzID0gbHNkY19ycmVnMzIo
bGRldiwgTFNEQ19DUlRDMF9DRkdfUkVHKTsNCisJaWYgKHN0YXR1cyAmIEZCX1JFR19JTl9VU0lO
Rykgew0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9GQjFfQUREUl9MT19SRUcsIGxv
KTsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JUQzBfRkIxX0FERFJfSElfUkVHLCBoaSk7
DQorCX0gZWxzZSB7DQorCQlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMwX0ZCMF9BRERSX0xP
X1JFRywgbG8pOw0KKwkJbHNkY193cmVnMzIobGRldiwgTFNEQ19DUlRDMF9GQjBfQUREUl9ISV9S
RUcsIGhpKTsNCisJfQ0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3ByaW1hcnkwX3VwZGF0ZV9m
Yl9zdHJpZGUoc3RydWN0IGxzZGNfcHJpbWFyeSAqcHJpbWFyeSwgdTMyIHN0cmlkZSkNCit7DQor
CXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHByaW1hcnktPmxkZXY7DQorDQorCWxzZGNfd3Jl
ZzMyKGxkZXYsIExTRENfQ1JUQzBfU1RSSURFX1JFRywgc3RyaWRlKTsNCit9DQorDQorc3RhdGlj
IHZvaWQgbHNkY19wcmltYXJ5MF91cGRhdGVfZmJfZm9ybWF0KHN0cnVjdCBsc2RjX3ByaW1hcnkg
KnByaW1hcnksDQorCQkJCQkgICBjb25zdCBzdHJ1Y3QgZHJtX2Zvcm1hdF9pbmZvICpmb3JtYXQp
DQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBwcmltYXJ5LT5sZGV2Ow0KKwl1MzIg
c3RhdHVzOw0KKw0KKwlzdGF0dXMgPSBsc2RjX3JyZWczMihsZGV2LCBMU0RDX0NSVEMwX0NGR19S
RUcpOw0KKw0KKwkvKg0KKwkgKiBUT0RPOiBhZGQgUkdCNTY1IHN1cHBvcnQsIG9ubHkgc3VwcG9y
dCBYUkJHODg4OCBjdXJyZW50bHkNCisJICovDQorCXN0YXR1cyAmPSB+Q0ZHX1BJWF9GTVRfTUFT
SzsNCisJc3RhdHVzIHw9IExTRENfUEZfWFJHQjg4ODg7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYs
IExTRENfQ1JUQzBfQ0ZHX1JFRywgc3RhdHVzKTsNCisNCisJdWRlbGF5KDkpOw0KK30NCisNCisv
KiBwcmltYXJ5IHBsYW5lIGhhcmR3YXJlIHJlbGF0ZWQgb3BzLCBmb3IgcHJpbWFyeSBwbGFuZSAx
ICovDQorDQorc3RhdGljIHZvaWQgbHNkY19wcmltYXJ5MV91cGRhdGVfZmJfYWRkcihzdHJ1Y3Qg
bHNkY19wcmltYXJ5ICpwcmltYXJ5LCB1NjQgZmJfYWRkcikNCit7DQorCXN0cnVjdCBsc2RjX2Rl
dmljZSAqbGRldiA9IHByaW1hcnktPmxkZXY7DQorCXUzMiBzdGF0dXM7DQorCXUzMiBsbywgaGk7
DQorDQorCS8qIDQwLWJpdCB3aWR0aCBwaHlzaWNhbCBhZGRyZXNzIGJ1cyAqLw0KKwlsbyA9IGZi
X2FkZHIgJiAweEZGRkZGRkZGOw0KKwloaSA9IChmYl9hZGRyID4+IDMyKSAmIDB4RkY7DQorDQor
CXN0YXR1cyA9IGxzZGNfcnJlZzMyKGxkZXYsIExTRENfQ1JUQzFfQ0ZHX1JFRyk7DQorCWlmIChz
dGF0dXMgJiBGQl9SRUdfSU5fVVNJTkcpIHsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1JU
QzFfRkIxX0FERFJfTE9fUkVHLCBsbyk7DQorCQlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMx
X0ZCMV9BRERSX0hJX1JFRywgaGkpOw0KKwl9IGVsc2Ugew0KKwkJbHNkY193cmVnMzIobGRldiwg
TFNEQ19DUlRDMV9GQjBfQUREUl9MT19SRUcsIGxvKTsNCisJCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1JUQzFfRkIwX0FERFJfSElfUkVHLCBoaSk7DQorCX0NCit9DQorDQorc3RhdGljIHZvaWQg
bHNkY19wcmltYXJ5MV91cGRhdGVfZmJfc3RyaWRlKHN0cnVjdCBsc2RjX3ByaW1hcnkgKnByaW1h
cnksIHUzMiBzdHJpZGUpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBwcmltYXJ5
LT5sZGV2Ow0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX1NUUklERV9SRUcsIHN0
cmlkZSk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfcHJpbWFyeTFfdXBkYXRlX2ZiX2Zvcm1h
dChzdHJ1Y3QgbHNkY19wcmltYXJ5ICpwcmltYXJ5LA0KKwkJCQkJICAgY29uc3Qgc3RydWN0IGRy
bV9mb3JtYXRfaW5mbyAqZm9ybWF0KQ0KK3sNCisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0g
cHJpbWFyeS0+bGRldjsNCisJdTMyIHN0YXR1czsNCisNCisJc3RhdHVzID0gbHNkY19ycmVnMzIo
bGRldiwgTFNEQ19DUlRDMV9DRkdfUkVHKTsNCisNCisJLyoNCisJICogT25seSBzdXBwb3J0IFhS
Qkc4ODg4IGN1cnJlbnRseSwNCisJICogVE9ETzogYWRkIFJHQjU2NSBzdXBwb3J0DQorCSAqLw0K
KwlzdGF0dXMgJj0gfkNGR19QSVhfRk1UX01BU0s7DQorCXN0YXR1cyB8PSBMU0RDX1BGX1hSR0I4
ODg4Ow0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NSVEMxX0NGR19SRUcsIHN0YXR1cyk7
DQorDQorCXVkZWxheSg5KTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBsc2RjX3ByaW1h
cnlfcGxhbmVfb3BzIHByaW1hcnlfaHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBkYXRlX2ZiX2Fk
ZHIgPSBsc2RjX3ByaW1hcnkwX3VwZGF0ZV9mYl9hZGRyLA0KKwkJLnVwZGF0ZV9mYl9zdHJpZGUg
PSBsc2RjX3ByaW1hcnkwX3VwZGF0ZV9mYl9zdHJpZGUsDQorCQkudXBkYXRlX2ZiX2Zvcm1hdCA9
IGxzZGNfcHJpbWFyeTBfdXBkYXRlX2ZiX2Zvcm1hdCwNCisJfSwNCisJew0KKwkJLnVwZGF0ZV9m
Yl9hZGRyID0gbHNkY19wcmltYXJ5MV91cGRhdGVfZmJfYWRkciwNCisJCS51cGRhdGVfZmJfc3Ry
aWRlID0gbHNkY19wcmltYXJ5MV91cGRhdGVfZmJfc3RyaWRlLA0KKwkJLnVwZGF0ZV9mYl9mb3Jt
YXQgPSBsc2RjX3ByaW1hcnkxX3VwZGF0ZV9mYl9mb3JtYXQsDQorCX0sDQorfTsNCisNCisvKg0K
KyAqIFVwZGF0ZSBsb2NhdGlvbiwgZm9ybWF0LCBlbmFibGUgYW5kIGRpc2FibGUgc3RhdGUgb2Yg
dGhlIGN1cnNvciwNCisgKiBGb3IgdGhvc2Ugd2hvIGhhdmUgdHdvIGhhcmR3YXJlIGN1cnNvciwg
Y3Vyc29yIDAgaXMgYXR0YWNoIGl0IHRvIENSVEMtMCwNCisgKiBjdXJzb3IgMSBpcyBhdHRhY2hl
ZCB0byBDUlRDLTEuIENvbXBvc2l0aW5nIHRoZSBwcmltYXJ5IGFuZCBjdXJzb3IgcGxhbmUNCisg
KiBpcyBhdXRvbWF0aWNhbGx5IGRvbmUgYnkgaGFyZHdhcmUsIHRoZSBjdXJzb3IgaXMgYWx3YXkg
b24gdGhlIHRvcCBvZiB0aGUNCisgKiBwcmltYXJ5LiBJbiBvdGhlciB3b3JkLCB6LW9yZGVyIGlz
IGZpeGVkIGluIGhhcmR3YXJlIGFuZCBjYW5ub3QgYmUgY2hhbmdlZC4NCisgKiBGb3IgdGhvc2Ug
b2xkIERDIHdobyBoYXMgb25seSBvbmUgaGFyZHdhcmUgY3Vyc29yLCB3ZSBtYWRlIGl0IHNoYXJl
ZCBieQ0KKyAqIHRoZSB0d28gc2NyZWVuLCB0aGlzIHdvcmtzIG9uIGV4dGVuZCBzY3JlZW4gbW9k
ZS4NCisgKi8NCisNCisvKiBjdXJzb3IgcGxhbmUgcmVsYXRlZCBoYXJkd2FyZSBvcHMsIGZvciBj
dXJzb3IgcGxhbmUgMCAqLw0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3Vyc29yMF91cGRhdGVfYm9f
YWRkcihzdHJ1Y3QgbHNkY19jdXJzb3IgKmN1cnNvciwgdTY0IGFkZHIpDQorew0KKwlzdHJ1Y3Qg
bHNkY19kZXZpY2UgKmxkZXYgPSBjdXJzb3ItPmxkZXY7DQorDQorCS8qIDQwLWJpdCB3aWR0aCBw
aHlzaWNhbCBhZGRyZXNzIGJ1cyAqLw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NVUlNPUjBf
QUREUl9ISV9SRUcsIChhZGRyID4+IDMyKSAmIDB4RkYpOw0KKwlsc2RjX3dyZWczMihsZGV2LCBM
U0RDX0NVUlNPUjBfQUREUl9MT19SRUcsIGFkZHIpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2Rj
X2N1cnNvcjBfdXBkYXRlX3Bvc2l0aW9uKHN0cnVjdCBsc2RjX2N1cnNvciAqY3Vyc29yLCBpbnQg
eCwgaW50IHkpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBjdXJzb3ItPmxkZXY7
DQorDQorCWlmICh4IDwgMCkNCisJCXggPSAwOw0KKw0KKwlpZiAoeSA8IDApDQorCQl5ID0gMDsN
CisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX1BPU0lUSU9OX1JFRywgKHkgPDwg
MTYpIHwgeCk7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3Vyc29yMF91cGRhdGVfY2ZnKHN0
cnVjdCBsc2RjX2N1cnNvciAqY3Vyc29yLA0KKwkJCQkgICAgZW51bSBsc2RjX2N1cnNvcl9zaXpl
IGN1cnNvcl9zaXplLA0KKwkJCQkgICAgZW51bSBsc2RjX2N1cnNvcl9mb3JtYXQgZm10KQ0KK3sN
CisJc3RydWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gY3Vyc29yLT5sZGV2Ow0KKwl1MzIgY2ZnOw0K
Kw0KKwljZmcgPSBDVVJTT1JfT05fQ1JUQzAgPDwgQ1VSU09SX0xPQ0FUSU9OX1NISUZUIHwNCisJ
ICAgICAgY3Vyc29yX3NpemUgPDwgQ1VSU09SX1NJWkVfU0hJRlQgfA0KKwkgICAgICBmbXQgPDwg
Q1VSU09SX0ZPUk1BVF9TSElGVDsNCisNCisJbHNkY193cmVnMzIobGRldiwgTFNEQ19DVVJTT1Iw
X0NGR19SRUcsIGNmZyk7DQorfQ0KKw0KKy8qIGN1cnNvciBwbGFuZSByZWxhdGVkIGhhcmR3YXJl
IG9wcywgZm9yIGN1cnNvciBwbGFuZSAxICovDQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3Ix
X3VwZGF0ZV9ib19hZGRyKHN0cnVjdCBsc2RjX2N1cnNvciAqY3Vyc29yLCB1NjQgYWRkcikNCit7
DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGN1cnNvci0+bGRldjsNCisNCisJLyogNDAt
Yml0IHdpZHRoIHBoeXNpY2FsIGFkZHJlc3MgYnVzICovDQorCWxzZGNfd3JlZzMyKGxkZXYsIExT
RENfQ1VSU09SMV9BRERSX0hJX1JFRywgKGFkZHIgPj4gMzIpICYgMHhGRik7DQorCWxzZGNfd3Jl
ZzMyKGxkZXYsIExTRENfQ1VSU09SMV9BRERSX0xPX1JFRywgYWRkcik7DQorfQ0KKw0KK3N0YXRp
YyB2b2lkIGxzZGNfY3Vyc29yMV91cGRhdGVfcG9zaXRpb24oc3RydWN0IGxzZGNfY3Vyc29yICpj
dXJzb3IsIGludCB4LCBpbnQgeSkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGN1
cnNvci0+bGRldjsNCisNCisJaWYgKHggPCAwKQ0KKwkJeCA9IDA7DQorDQorCWlmICh5IDwgMCkN
CisJCXkgPSAwOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NVUlNPUjFfUE9TSVRJT05f
UkVHLCAoeSA8PCAxNikgfCB4KTsNCit9DQorDQorc3RhdGljIHZvaWQgbHNkY19jdXJzb3IxX3Vw
ZGF0ZV9jZmcoc3RydWN0IGxzZGNfY3Vyc29yICpjdXJzb3IsDQorCQkJCSAgICBlbnVtIGxzZGNf
Y3Vyc29yX3NpemUgY3Vyc29yX3NpemUsDQorCQkJCSAgICBlbnVtIGxzZGNfY3Vyc29yX2Zvcm1h
dCBmbXQpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBjdXJzb3ItPmxkZXY7DQor
CXUzMiBjZmc7DQorDQorCWNmZyA9IENVUlNPUl9PTl9DUlRDMSA8PCBDVVJTT1JfTE9DQVRJT05f
U0hJRlQgfA0KKwkgICAgICBjdXJzb3Jfc2l6ZSA8PCBDVVJTT1JfU0laRV9TSElGVCB8DQorCSAg
ICAgIGZtdCA8PCBDVVJTT1JfRk9STUFUX1NISUZUOw0KKw0KKwlsc2RjX3dyZWczMihsZGV2LCBM
U0RDX0NVUlNPUjFfQ0ZHX1JFRywgY2ZnKTsNCit9DQorDQorc3RhdGljIGNvbnN0IHN0cnVjdCBs
c2RjX2N1cnNvcl9wbGFuZV9vcHMgbHM3YTIwMDBfY3Vyc29yX2h3X29wc1syXSA9IHsNCisJew0K
KwkJLnVwZGF0ZV9ib19hZGRyID0gbHNkY19jdXJzb3IwX3VwZGF0ZV9ib19hZGRyLA0KKwkJLnVw
ZGF0ZV9jZmcgPSBsc2RjX2N1cnNvcjBfdXBkYXRlX2NmZywNCisJCS51cGRhdGVfcG9zaXRpb24g
PSBsc2RjX2N1cnNvcjBfdXBkYXRlX3Bvc2l0aW9uLA0KKwl9LA0KKwl7DQorCQkudXBkYXRlX2Jv
X2FkZHIgPSBsc2RjX2N1cnNvcjFfdXBkYXRlX2JvX2FkZHIsDQorCQkudXBkYXRlX2NmZyA9IGxz
ZGNfY3Vyc29yMV91cGRhdGVfY2ZnLA0KKwkJLnVwZGF0ZV9wb3NpdGlvbiA9IGxzZGNfY3Vyc29y
MV91cGRhdGVfcG9zaXRpb24sDQorCX0sDQorfTsNCisNCisvKiBxdWlya3MgZm9yIGN1cnNvciAx
LCBvbmx5IGZvciBvbGQgbG9vbmdzb24gZGlzcGxheSBjb250cm9sbGVyIGRldmljZSAqLw0KKw0K
K3N0YXRpYyB2b2lkIGxzZGNfY3Vyc29yMV91cGRhdGVfYm9fYWRkcl9xdWlyayhzdHJ1Y3QgbHNk
Y19jdXJzb3IgKmN1cnNvciwgdTY0IGFkZHIpDQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxk
ZXYgPSBjdXJzb3ItPmxkZXY7DQorDQorCS8qIDQwLWJpdCB3aWR0aCBwaHlzaWNhbCBhZGRyZXNz
IGJ1cyAqLw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NVUlNPUjBfQUREUl9ISV9SRUcsIChh
ZGRyID4+IDMyKSAmIDB4RkYpOw0KKwlsc2RjX3dyZWczMihsZGV2LCBMU0RDX0NVUlNPUjBfQURE
Ul9MT19SRUcsIGFkZHIpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2N1cnNvcjFfdXBkYXRl
X3Bvc2l0aW9uX3F1aXJrKHN0cnVjdCBsc2RjX2N1cnNvciAqY3Vyc29yLCBpbnQgeCwgaW50IHkp
DQorew0KKwlzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSBjdXJzb3ItPmxkZXY7DQorDQorCWlm
ICh4IDwgMCkNCisJCXggPSAwOw0KKw0KKwlpZiAoeSA8IDApDQorCQl5ID0gMDsNCisNCisJbHNk
Y193cmVnMzIobGRldiwgTFNEQ19DVVJTT1IwX1BPU0lUSU9OX1JFRywgKHkgPDwgMTYpIHwgeCk7
DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfY3Vyc29yMV91cGRhdGVfY2ZnX3F1aXJrKHN0cnVj
dCBsc2RjX2N1cnNvciAqY3Vyc29yLA0KKwkJCQkJICBlbnVtIGxzZGNfY3Vyc29yX3NpemUgY3Vy
c29yX3NpemUsDQorCQkJCQkgIGVudW0gbHNkY19jdXJzb3JfZm9ybWF0IGZtdCkNCit7DQorCXN0
cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IGN1cnNvci0+bGRldjsNCisJdTMyIGNmZzsNCisNCisJ
Y2ZnID0gQ1VSU09SX09OX0NSVEMxIDw8IENVUlNPUl9MT0NBVElPTl9TSElGVCB8DQorCSAgICAg
IGN1cnNvcl9zaXplIDw8IENVUlNPUl9TSVpFX1NISUZUIHwNCisJICAgICAgZm10IDw8IENVUlNP
Ul9GT1JNQVRfU0hJRlQ7DQorDQorCWxzZGNfd3JlZzMyKGxkZXYsIExTRENfQ1VSU09SMF9DRkdf
UkVHLCBjZmcpOw0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGxzZGNfY3Vyc29yX3BsYW5l
X29wcyBsczdhMTAwMF9jdXJzb3JfaHdfb3BzWzJdID0gew0KKwl7DQorCQkudXBkYXRlX2JvX2Fk
ZHIgPSBsc2RjX2N1cnNvcjBfdXBkYXRlX2JvX2FkZHIsDQorCQkudXBkYXRlX2NmZyA9IGxzZGNf
Y3Vyc29yMF91cGRhdGVfY2ZnLA0KKwkJLnVwZGF0ZV9wb3NpdGlvbiA9IGxzZGNfY3Vyc29yMF91
cGRhdGVfcG9zaXRpb24sDQorCX0sDQorCXsNCisJCS51cGRhdGVfYm9fYWRkciA9IGxzZGNfY3Vy
c29yMV91cGRhdGVfYm9fYWRkcl9xdWlyaywNCisJCS51cGRhdGVfY2ZnID0gbHNkY19jdXJzb3Ix
X3VwZGF0ZV9jZmdfcXVpcmssDQorCQkudXBkYXRlX3Bvc2l0aW9uID0gbHNkY19jdXJzb3IxX3Vw
ZGF0ZV9wb3NpdGlvbl9xdWlyaywNCisJfSwNCit9Ow0KKw0KK2ludCBsc2RjX3ByaW1hcnlfcGxh
bmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgc3RydWN0IGRybV9wbGFu
ZSAqcGxhbmUsDQorCQkJICAgIHVuc2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBsc2Rj
X3ByaW1hcnkgKnByaW1hcnkgPSB0b19sc2RjX3ByaW1hcnkocGxhbmUpOw0KKwlpbnQgcmV0Ow0K
Kw0KKwlyZXQgPSBkcm1fdW5pdmVyc2FsX3BsYW5lX2luaXQoZGRldiwNCisJCQkJICAgICAgIHBs
YW5lLA0KKwkJCQkgICAgICAgMSA8PCBpbmRleCwNCisJCQkJICAgICAgICZsc2RjX3BsYW5lX2Z1
bmNzLA0KKwkJCQkgICAgICAgbHNkY19wcmltYXJ5X2Zvcm1hdHMsDQorCQkJCSAgICAgICBBUlJB
WV9TSVpFKGxzZGNfcHJpbWFyeV9mb3JtYXRzKSwNCisJCQkJICAgICAgIGxzZGNfZmJfZm9ybWF0
X21vZGlmaWVycywNCisJCQkJICAgICAgIERSTV9QTEFORV9UWVBFX1BSSU1BUlksDQorCQkJCSAg
ICAgICAicHJpbWFyeS0ldSIsDQorCQkJCSAgICAgICBpbmRleCk7DQorCWlmIChyZXQpDQorCQly
ZXR1cm4gcmV0Ow0KKw0KKwlkcm1fcGxhbmVfaGVscGVyX2FkZChwbGFuZSwgJmxzZGNfcHJpbWFy
eV9oZWxwZXJfZnVuY3MpOw0KKw0KKwlwcmltYXJ5LT5sZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJ
cHJpbWFyeS0+b3BzID0gJnByaW1hcnlfaHdfb3BzW2luZGV4XTsNCisNCisJcmV0dXJuIDA7DQor
fQ0KKw0KK2ludCBsczdhMTAwMF9jdXJzb3JfcGxhbmVfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAq
ZGRldiwNCisJCQkgICAgICAgc3RydWN0IGRybV9wbGFuZSAqcGxhbmUsDQorCQkJICAgICAgIHVu
c2lnbmVkIGludCBpbmRleCkNCit7DQorCXN0cnVjdCBsc2RjX2N1cnNvciAqY3Vyc29yID0gdG9f
bHNkY19jdXJzb3IocGxhbmUpOw0KKw0KKwlpbnQgcmV0Ow0KKw0KKwlyZXQgPSBkcm1fdW5pdmVy
c2FsX3BsYW5lX2luaXQoZGRldiwNCisJCQkJICAgICAgIHBsYW5lLA0KKwkJCQkgICAgICAgMSA8
PCBpbmRleCwNCisJCQkJICAgICAgICZsc2RjX3BsYW5lX2Z1bmNzLA0KKwkJCQkgICAgICAgbHNk
Y19jdXJzb3JfZm9ybWF0cywNCisJCQkJICAgICAgIEFSUkFZX1NJWkUobHNkY19jdXJzb3JfZm9y
bWF0cyksDQorCQkJCSAgICAgICBsc2RjX2ZiX2Zvcm1hdF9tb2RpZmllcnMsDQorCQkJCSAgICAg
ICBEUk1fUExBTkVfVFlQRV9DVVJTT1IsDQorCQkJCSAgICAgICAiY3Vyc29yLSV1IiwNCisJCQkJ
ICAgICAgIGluZGV4KTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7DQorDQorCWN1cnNvci0+
bGRldiA9IHRvX2xzZGMoZGRldik7DQorCWN1cnNvci0+b3BzID0gJmxzN2ExMDAwX2N1cnNvcl9o
d19vcHNbaW5kZXhdOw0KKw0KKwlkcm1fcGxhbmVfaGVscGVyX2FkZChwbGFuZSwgJmxzN2ExMDAw
X2N1cnNvcl9oZWxwZXJfZnVuY3MpOw0KKw0KKwlyZXR1cm4gMDsNCit9DQorDQorLyogVGhlIGhh
cmR3YXJlIGN1cnNvcnMgYmVjb21lIG5vcm1hbCBzaW5jZSBsczdhMjAwMChpbmNsdWRpbmcgbHMy
azIwMDApICovDQorDQoraW50IGxzN2EyMDAwX2N1cnNvcl9wbGFuZV9pbml0KHN0cnVjdCBkcm1f
ZGV2aWNlICpkZGV2LA0KKwkJCSAgICAgICBzdHJ1Y3QgZHJtX3BsYW5lICpwbGFuZSwNCisJCQkg
ICAgICAgdW5zaWduZWQgaW50IGluZGV4KQ0KK3sNCisJc3RydWN0IGxzZGNfY3Vyc29yICpjdXJz
b3IgPSB0b19sc2RjX2N1cnNvcihwbGFuZSk7DQorDQorCWludCByZXQ7DQorDQorCXJldCA9IGRy
bV91bml2ZXJzYWxfcGxhbmVfaW5pdChkZGV2LA0KKwkJCQkgICAgICAgcGxhbmUsDQorCQkJCSAg
ICAgICAxIDw8IGluZGV4LA0KKwkJCQkgICAgICAgJmxzZGNfcGxhbmVfZnVuY3MsDQorCQkJCSAg
ICAgICBsc2RjX2N1cnNvcl9mb3JtYXRzLA0KKwkJCQkgICAgICAgQVJSQVlfU0laRShsc2RjX2N1
cnNvcl9mb3JtYXRzKSwNCisJCQkJICAgICAgIGxzZGNfZmJfZm9ybWF0X21vZGlmaWVycywNCisJ
CQkJICAgICAgIERSTV9QTEFORV9UWVBFX0NVUlNPUiwNCisJCQkJICAgICAgICJjdXJzb3ItJXUi
LA0KKwkJCQkgICAgICAgaW5kZXgpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJ
Y3Vyc29yLT5sZGV2ID0gdG9fbHNkYyhkZGV2KTsNCisJY3Vyc29yLT5vcHMgPSAmbHM3YTIwMDBf
Y3Vyc29yX2h3X29wc1tpbmRleF07DQorDQorCWRybV9wbGFuZV9oZWxwZXJfYWRkKHBsYW5lLCAm
bHM3YTIwMDBfY3Vyc29yX2hlbHBlcl9mdW5jcyk7DQorDQorCXJldHVybiAwOw0KK30NCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19wcm9iZS5jIGIvZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUuYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4
IDAwMDAwMDAwMDAwMC4uZTA5ZjYyMjdhMjU3DQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vbG9vbmdzb24vbHNkY19wcm9iZS5jDQpAQCAtMCwwICsxLDU2IEBADQorLy8gU1BE
WC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjArDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIw
MjMgTG9vbmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lu
Y2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfcHJvYmUuaCINCisNCisvKg0KKyAq
IFByb2Nlc3NvciBJRCAoaW1wbGVtZW50YXRpb24pIHZhbHVlcyBmb3IgYml0cyAxNTo4IG9mIHRo
ZSBQUklEIHJlZ2lzdGVyLg0KKyAqLw0KKyNkZWZpbmUgTE9PTkdTT05fQ1BVX0lNUF9NQVNLICAg
ICAgICAgICAweGZmMDANCisjZGVmaW5lIExPT05HU09OX0NQVV9JTVBfU0hJRlQgICAgICAgICAg
OA0KKw0KKyNkZWZpbmUgTE9PTkdBUkNIX0NQVV9JTVBfTFMySzEwMDAgICAgICAweGEwDQorI2Rl
ZmluZSBMT09OR0FSQ0hfQ1BVX0lNUF9MUzJLMjAwMCAgICAgIDB4YjANCisjZGVmaW5lIExPT05H
QVJDSF9DUFVfSU1QX0xTM0E1MDAwICAgICAgMHhjMA0KKw0KKyNkZWZpbmUgTE9PTkdTT05fQ1BV
X01JUFNfSU1QX0xTMksgICAgICAweDYxIC8qIExvb25nc29uIDJLIE1pcHMgc2VyaWVzIFNvQyAq
Lw0KKw0KKy8qDQorICogUGFydGljdWxhciBSZXZpc2lvbiB2YWx1ZXMgZm9yIGJpdHMgNzowIG9m
IHRoZSBQUklEIHJlZ2lzdGVyLg0KKyAqLw0KKyNkZWZpbmUgTE9PTkdTT05fQ1BVX1JFVl9NQVNL
ICAgICAgICAgICAweDAwZmYNCisNCisjZGVmaW5lIExPT05HQVJDSF9DUFVDRkdfUFJJRF9SRUcg
ICAgICAgMHgwDQorDQorLyoNCisgKiBXZSBjYW4gYWNoaWV2ZSBmaW5lIGNvbnRyb2wgd2l0aCB0
aGUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIGhvc3QuDQorICovDQorDQordW5zaWduZWQgaW50IGxv
b25nc29uX2NwdV9nZXRfcHJpZCh1OCAqaW1wLCB1OCAqcmV2KQ0KK3sNCisJdW5zaWduZWQgaW50
IHByaWQgPSAwOw0KKw0KKyNpZiBkZWZpbmVkKF9fbG9vbmdhcmNoX18pDQorCV9fYXNtX18gdm9s
YXRpbGUoImNwdWNmZyAlMCwgJTFcblx0Ig0KKwkJCTogIj0mciIocHJpZCkNCisJCQk6ICJyIihM
T09OR0FSQ0hfQ1BVQ0ZHX1BSSURfUkVHKQ0KKwkJCSk7DQorI2VuZGlmDQorDQorI2lmIGRlZmlu
ZWQoX19taXBzX18pDQorCV9fYXNtX18gdm9sYXRpbGUoIm1mYzBcdCUwLCAkMTVcblx0Ig0KKwkJ
CTogIj1yIiAocHJpZCkNCisJCQkpOw0KKyNlbmRpZg0KKw0KKwlpZiAoaW1wKQ0KKwkJKmltcCA9
IChwcmlkICYgTE9PTkdTT05fQ1BVX0lNUF9NQVNLKSA+PiBMT09OR1NPTl9DUFVfSU1QX1NISUZU
Ow0KKw0KKwlpZiAocmV2KQ0KKwkJKnJldiA9IHByaWQgJiBMT09OR1NPTl9DUFVfUkVWX01BU0s7
DQorDQorCXJldHVybiBwcmlkOw0KK30NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbG9v
bmdzb24vbHNkY19wcm9iZS5oIGIvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfcHJvYmUu
aA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uN2E5NmJlYzQ5YWI5
DQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19wcm9i
ZS5oDQpAQCAtMCwwICsxLDEyIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0y
LjAgKi8NCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENv
cnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19QUk9CRV9IX18NCisj
ZGVmaW5lIF9fTFNEQ19QUk9CRV9IX18NCisNCisvKiBIZWxwZXJzIGZvciBjaGlwIGRldGVjdGlv
biAqLw0KK3Vuc2lnbmVkIGludCBsb29uZ3Nvbl9jcHVfZ2V0X3ByaWQodTggKmltcGwsIHU4ICpy
ZXYpOw0KKw0KKyNlbmRpZg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9s
c2RjX3JlZ3MuaCBiL2RyaXZlcnMvZ3B1L2RybS9sb29uZ3Nvbi9sc2RjX3JlZ3MuaA0KbmV3IGZp
bGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uYTdlMGIzYzE3NmI4DQotLS0gL2Rl
di9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNkY19yZWdzLmgNCkBAIC0w
LDAgKzEsNDAwIEBADQorLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAgKi8NCisv
Kg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5IENvcnBvcmF0aW9u
IExpbWl0ZWQNCisgKi8NCisNCisjaWZuZGVmIF9fTFNEQ19SRUdTX0hfXw0KKyNkZWZpbmUgX19M
U0RDX1JFR1NfSF9fDQorDQorI2luY2x1ZGUgPGxpbnV4L2JpdG9wcy5oPg0KKyNpbmNsdWRlIDxs
aW51eC90eXBlcy5oPg0KKw0KKy8qDQorICogUElYRUwgUExMIFJlZmVyZW5jZSBjbG9jaw0KKyAq
Lw0KKyNkZWZpbmUgTFNEQ19QTExfUkVGX0NMSyAgICAgICAgICAgICAgICAxMDAwMDAgICAgICAg
ICAgIC8qIGtIeiAqLw0KKw0KKy8qDQorICogVGhvc2UgUExMIHJlZ2lzdGVycyBhcmUgcmVsYXRp
dmUgdG8gTFN4eHh4eF9DRkdfUkVHX0JBU0UuIHh4eHh4ID0gN0ExMDAwLA0KKyAqIDdBMjAwMCwg
MksyMDAwLCAySzEwMDAgZXRjLg0KKyAqLw0KKw0KKy8qIExTN0ExMDAwICovDQorDQorI2RlZmlu
ZSBMUzdBMTAwMF9QSVhQTEwwX1JFRyAgICAgICAgICAgIDB4MDRCMA0KKyNkZWZpbmUgTFM3QTEw
MDBfUElYUExMMV9SRUcgICAgICAgICAgICAweDA0QzANCisNCisvKiBUaGUgREMsIEdQVSwgR3Jh
cGhpYyBNZW1vcnkgQ29udHJvbGxlciBzaGFyZSB0aGUgc2luZ2xlIGdmeHBsbCAqLw0KKyNkZWZp
bmUgTFM3QTEwMDBfUExMX0dGWF9SRUcgICAgICAgICAgICAweDA0OTANCisNCisjZGVmaW5lIExT
N0ExMDAwX0NPTkZfUkVHX0JBU0UgICAgICAgICAgMHgxMDAxMDAwMA0KKw0KKy8qIExTN0EyMDAw
ICovDQorDQorI2RlZmluZSBMUzdBMjAwMF9QSVhQTEwwX1JFRyAgICAgICAgICAgIDB4MDRCMA0K
KyNkZWZpbmUgTFM3QTIwMDBfUElYUExMMV9SRUcgICAgICAgICAgICAweDA0QzANCisNCisvKiBU
aGUgREMsIEdQVSwgR3JhcGhpYyBNZW1vcnkgQ29udHJvbGxlciBzaGFyZSB0aGUgc2luZ2xlIGdm
eHBsbCAqLw0KKyNkZWZpbmUgTFM3QTIwMDBfUExMX0dGWF9SRUcgICAgICAgICAgICAweDA0OTAN
CisNCisjZGVmaW5lIExTN0EyMDAwX0NPTkZfUkVHX0JBU0UgICAgICAgICAgMHgxMDAxMDAwMA0K
Kw0KKy8qIEZvciBMU0RDX0NSVEN4X0NGR19SRUcgKi8NCisjZGVmaW5lIENGR19QSVhfRk1UX01B
U0sgICAgICAgICAgICAgICAgR0VOTUFTSygyLCAwKQ0KKw0KK2VudW0gbHNkY19waXhlbF9mb3Jt
YXQgew0KKwlMU0RDX1BGX05PTkUgPSAwLA0KKwlMU0RDX1BGX1hSR0I0NDQgPSAxLCAgICAvKiBb
MTIgYml0c10gKi8NCisJTFNEQ19QRl9YUkdCNTU1ID0gMiwgICAgLyogWzE1IGJpdHNdICovDQor
CUxTRENfUEZfWFJHQjU2NSA9IDMsICAgIC8qIFJHQiBbMTYgYml0c10gKi8NCisJTFNEQ19QRl9Y
UkdCODg4OCA9IDQsICAgLyogWFJHQiBbMzIgYml0c10gKi8NCit9Ow0KKw0KKy8qDQorICogRWFj
aCBjcnRjIGhhcyB0d28gc2V0IGZiIGFkZHJlc3MgcmVnaXN0ZXJzIHVzYWJsZSwgRkJfUkVHX0lO
X1VTSU5HIGJpdCBvZg0KKyAqIExTRENfQ1JUQ3hfQ0ZHX1JFRyBpbmRpY2F0ZSB3aGljaCBmYiBh
ZGRyZXNzIHJlZ2lzdGVyIGlzIGluIHVzaW5nIGJ5IHRoZQ0KKyAqIENSVEMgY3VycmVudGx5LiBD
RkdfUEFHRV9GTElQIGlzIHVzZWQgdG8gdHJpZ2dlciB0aGUgc3dpdGNoLCB0aGUgc3dpdGNoaW5n
DQorICogd2lsbCBiZSBmaW5pc2hlZCBhdCB0aGUgdmVyeSBuZXh0IHZibGFuay4gVHJpZ2dlciBp
dCBhZ2FpbiBpZiB5b3Ugd2FudCB0bw0KKyAqIHN3aXRjaCBiYWNrLg0KKyAqDQorICogSWYgRkIw
X0FERFJfUkVHIGlzIGluIHVzaW5nLCB3ZSB3cml0ZSB0aGUgYWRkcmVzcyB0byBGQjBfQUREUl9S
RUcsDQorICogaWYgRkIxX0FERFJfUkVHIGlzIGluIHVzaW5nLCB3ZSB3cml0ZSB0aGUgYWRkcmVz
cyB0byBGQjFfQUREUl9SRUcuDQorICovDQorI2RlZmluZSBDRkdfUEFHRV9GTElQICAgICAgICAg
ICAgICAgICAgIEJJVCg3KQ0KKyNkZWZpbmUgQ0ZHX09VVFBVVF9FTkFCTEUgICAgICAgICAgICAg
ICBCSVQoOCkNCisjZGVmaW5lIENGR19IV19DTE9ORSAgICAgICAgICAgICAgICAgICAgQklUKDkp
DQorLyogSW5kaWNhdGUgd2l0Y2ggZmIgYWRkciByZWcgaXMgaW4gdXNpbmcsIGN1cnJlbnRseS4g
cmVhZCBvbmx5ICovDQorI2RlZmluZSBGQl9SRUdfSU5fVVNJTkcgICAgICAgICAgICAgICAgIEJJ
VCgxMSkNCisjZGVmaW5lIENGR19HQU1NQV9FTiAgICAgICAgICAgICAgICAgICAgQklUKDEyKQ0K
Kw0KKy8qIFRoZSBEQyBnZXQgc29mdCByZXNldCBpZiB0aGlzIGJpdCBjaGFuZ2VkIGZyb20gIjEi
IHRvICIwIiwgYWN0aXZlIGxvdyAqLw0KKyNkZWZpbmUgQ0ZHX1JFU0VUX04gICAgICAgICAgICAg
ICAgICAgICBCSVQoMjApDQorDQorLyoNCisgKiBUaGUgRE1BIHN0ZXAgb2YgdGhlIERDIGluIExT
N0EyMDAwL0xTMksyMDAwIGlzIGNvbmZpZ3VyYWJsZSwNCisgKiBzZXR0aW5nIHRob3NlIGJpdHMg
b24gbHM3YTEwMDAgcGxhdGZvcm0gbWFrZSBubyBlZmZlY3QuDQorICovDQorI2RlZmluZSBDRkdf
RE1BX1NURVBfTUFTSyAgICAgICAgICAgICAgR0VOTUFTSygxNywgMTYpDQorI2RlZmluZSBDRkdf
RE1BX1NURVBfU0hJRlQgICAgICAgICAgICAgMTYNCitlbnVtIGxzZGNfZG1hX3N0ZXBzIHsNCisJ
TFNEQ19ETUFfU1RFUF8yNTZfQllURVMgPSAwLA0KKwlMU0RDX0RNQV9TVEVQXzEyOF9CWVRFUyA9
IDEsDQorCUxTRENfRE1BX1NURVBfNjRfQllURVMgPSAyLA0KKwlMU0RDX0RNQV9TVEVQXzMyX0JZ
VEVTID0gMywNCit9Ow0KKw0KKyNkZWZpbmUgQ0ZHX1ZBTElEX0JJVFNfTUFTSyAgICAgICAgICAg
ICBHRU5NQVNLKDIwLCAwKQ0KKw0KKy8qIEZvciBMU0RDX0NSVEN4X1BBTkVMX0NPTkZfUkVHICov
DQorI2RlZmluZSBQSFlfQ0xPQ0tfUE9MICAgICAgICAgICAgICAgICAgIEJJVCg5KQ0KKyNkZWZp
bmUgUEhZX0NMT0NLX0VOICAgICAgICAgICAgICAgICAgICBCSVQoOCkNCisjZGVmaW5lIFBIWV9E
RV9QT0wgICAgICAgICAgICAgICAgICAgICAgQklUKDEpDQorI2RlZmluZSBQSFlfREFUQV9FTiAg
ICAgICAgICAgICAgICAgICAgIEJJVCgwKQ0KKw0KKy8qIEZvciBMU0RDX0NSVEN4X0hTWU5DX1JF
RyAqLw0KKyNkZWZpbmUgSFNZTkNfSU5WICAgICAgICAgICAgICAgICAgICAgICBCSVQoMzEpDQor
I2RlZmluZSBIU1lOQ19FTiAgICAgICAgICAgICAgICAgICAgICAgIEJJVCgzMCkNCisjZGVmaW5l
IEhTWU5DX0VORF9NQVNLICAgICAgICAgICAgICAgICAgR0VOTUFTSygyOCwgMTYpDQorI2RlZmlu
ZSBIU1lOQ19FTkRfU0hJRlQgICAgICAgICAgICAgICAgIDE2DQorI2RlZmluZSBIU1lOQ19TVEFS
VF9NQVNLICAgICAgICAgICAgICAgIEdFTk1BU0soMTIsIDApDQorI2RlZmluZSBIU1lOQ19TVEFS
VF9TSElGVCAgICAgICAgICAgICAgIDANCisNCisvKiBGb3IgTFNEQ19DUlRDeF9WU1lOQ19SRUcg
Ki8NCisjZGVmaW5lIFZTWU5DX0lOViAgICAgICAgICAgICAgICAgICAgICAgQklUKDMxKQ0KKyNk
ZWZpbmUgVlNZTkNfRU4gICAgICAgICAgICAgICAgICAgICAgICBCSVQoMzApDQorI2RlZmluZSBW
U1lOQ19FTkRfTUFTSyAgICAgICAgICAgICAgICAgIEdFTk1BU0soMjcsIDE2KQ0KKyNkZWZpbmUg
VlNZTkNfRU5EX1NISUZUICAgICAgICAgICAgICAgICAxNg0KKyNkZWZpbmUgVlNZTkNfU1RBUlRf
TUFTSyAgICAgICAgICAgICAgICBHRU5NQVNLKDExLCAwKQ0KKyNkZWZpbmUgVlNZTkNfU1RBUlRf
U0hJRlQgICAgICAgICAgICAgICAwDQorDQorLyoqKioqKioqKioqIENSVEMwICYgRElTUExBWSBQ
SVBFMCAqKioqKioqKioqKi8NCisjZGVmaW5lIExTRENfQ1JUQzBfQ0ZHX1JFRyAgICAgICAgICAg
ICAgMHgxMjQwDQorI2RlZmluZSBMU0RDX0NSVEMwX0ZCMF9BRERSX0xPX1JFRyAgICAgIDB4MTI2
MA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9GQjBfQUREUl9ISV9SRUcgICAgICAweDE1QTANCisjZGVm
aW5lIExTRENfQ1JUQzBfU1RSSURFX1JFRyAgICAgICAgICAgMHgxMjgwDQorI2RlZmluZSBMU0RD
X0NSVEMwX0ZCX09SSUdJTl9SRUcgICAgICAgIDB4MTMwMA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9Q
QU5FTF9DT05GX1JFRyAgICAgICAweDEzQzANCisjZGVmaW5lIExTRENfQ1JUQzBfSERJU1BMQVlf
UkVHICAgICAgICAgMHgxNDAwDQorI2RlZmluZSBMU0RDX0NSVEMwX0hTWU5DX1JFRyAgICAgICAg
ICAgIDB4MTQyMA0KKyNkZWZpbmUgTFNEQ19DUlRDMF9WRElTUExBWV9SRUcgICAgICAgICAweDE0
ODANCisjZGVmaW5lIExTRENfQ1JUQzBfVlNZTkNfUkVHICAgICAgICAgICAgMHgxNEEwDQorI2Rl
ZmluZSBMU0RDX0NSVEMwX0dBTU1BX0lOREVYX1JFRyAgICAgIDB4MTRFMA0KKyNkZWZpbmUgTFNE
Q19DUlRDMF9HQU1NQV9EQVRBX1JFRyAgICAgICAweDE1MDANCisjZGVmaW5lIExTRENfQ1JUQzBf
RkIxX0FERFJfTE9fUkVHICAgICAgMHgxNTgwDQorI2RlZmluZSBMU0RDX0NSVEMwX0ZCMV9BRERS
X0hJX1JFRyAgICAgIDB4MTVDMA0KKw0KKy8qKioqKioqKioqKiBDVFJDMSAmIERJU1BMQVkgUElQ
RTEgKioqKioqKioqKiovDQorI2RlZmluZSBMU0RDX0NSVEMxX0NGR19SRUcgICAgICAgICAgICAg
IDB4MTI1MA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9GQjBfQUREUl9MT19SRUcgICAgICAweDEyNzAN
CisjZGVmaW5lIExTRENfQ1JUQzFfRkIwX0FERFJfSElfUkVHICAgICAgMHgxNUIwDQorI2RlZmlu
ZSBMU0RDX0NSVEMxX1NUUklERV9SRUcgICAgICAgICAgIDB4MTI5MA0KKyNkZWZpbmUgTFNEQ19D
UlRDMV9GQl9PUklHSU5fUkVHICAgICAgICAweDEzMTANCisjZGVmaW5lIExTRENfQ1JUQzFfUEFO
RUxfQ09ORl9SRUcgICAgICAgMHgxM0QwDQorI2RlZmluZSBMU0RDX0NSVEMxX0hESVNQTEFZX1JF
RyAgICAgICAgIDB4MTQxMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9IU1lOQ19SRUcgICAgICAgICAg
ICAweDE0MzANCisjZGVmaW5lIExTRENfQ1JUQzFfVkRJU1BMQVlfUkVHICAgICAgICAgMHgxNDkw
DQorI2RlZmluZSBMU0RDX0NSVEMxX1ZTWU5DX1JFRyAgICAgICAgICAgIDB4MTRCMA0KKyNkZWZp
bmUgTFNEQ19DUlRDMV9HQU1NQV9JTkRFWF9SRUcgICAgICAweDE0RjANCisjZGVmaW5lIExTRENf
Q1JUQzFfR0FNTUFfREFUQV9SRUcgICAgICAgMHgxNTEwDQorI2RlZmluZSBMU0RDX0NSVEMxX0ZC
MV9BRERSX0xPX1JFRyAgICAgIDB4MTU5MA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9GQjFfQUREUl9I
SV9SRUcgICAgICAweDE1RDANCisNCisvKg0KKyAqIEFsbCBvZiB0aGUgREMgdmFyaWFudHMgaGFz
IHRoZSBoYXJkd2FyZSB3aGljaCByZWNvcmQgdGhlIHNjYW4gcG9zaXRpb24NCisgKiBvZiB0aGUg
Q1JUQywgWzMxOjE2XSA6IGN1cnJlbnQgWCBwb3NpdGlvbiwgWzE1OjBdIDogY3VycmVudCBZIHBv
c2l0aW9uDQorICovDQorI2RlZmluZSBMU0RDX0NSVEMwX1NDQU5fUE9TX1JFRyAgICAgICAgIDB4
MTRDMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9TQ0FOX1BPU19SRUcgICAgICAgICAweDE0RDANCisN
CisvKg0KKyAqIExTN0EyMDAwIGhhcyBTeW5jIERldmlhdGlvbiByZWdpc3Rlci4NCisgKi8NCisj
ZGVmaW5lIFNZTkNfREVWSUFUSU9OX0VOICAgICAgICAgICAgICAgQklUKDMxKQ0KKyNkZWZpbmUg
U1lOQ19ERVZJQVRJT05fTlVNICAgICAgICAgICAgICBHRU5NQVNLKDEyLCAwKQ0KKyNkZWZpbmUg
TFNEQ19DUlRDMF9TWU5DX0RFVklBVElPTl9SRUcgICAweDFCODANCisjZGVmaW5lIExTRENfQ1JU
QzFfU1lOQ19ERVZJQVRJT05fUkVHICAgMHgxQjkwDQorDQorLyoNCisgKiBJbiBncm9zcywgTFNE
Q19DUlRDMV9YWFhfUkVHIC0gTFNEQ19DUlRDMF9YWFhfUkVHID0gMHgxMCwgYnV0IG5vdCBhbGwg
b2YNCisgKiB0aGUgcmVnaXN0ZXJzIG9iZXkgdGhpcyBydWxlLCBMU0RDX0NVUlNPUnhfWFhYX1JF
RyBqdXN0IGRvbid0IGhvbm9yIHRoaXMuDQorICogVGhpcyBpcyB0aGUgcm9vdCBjYXVzZSB3ZSBj
YW4ndCB1bnRhbmdsZSB0aGUgY29kZSBieSBtYW5wdWxhdGluZyBvZmZzZXQNCisgKiBvZiB0aGUg
cmVnaXN0ZXIgYWNjZXNzIHNpbXBseS4gT3VyIGhhcmR3YXJlIGVuZ2luZWVycyBhcmUgbGFjayBl
eHBlcmlhbmNlDQorICogd2hlbiB0aGV5IGRlc2lnbiB0aGlzLi4uDQorICovDQorI2RlZmluZSBD
UlRDX1BJUEVfT0ZGU0VUICAgICAgICAgICAgICAgIDB4MTANCisNCisvKg0KKyAqIFRoZXJlIGlz
IG9ubHkgb25lIGhhcmR3YXJlIGN1cnNvciB1bml0IGluIExTN0ExMDAwIGFuZCBMUzJLMTAwMCwg
bGV0DQorICogQ0ZHX0hXX0NMT05FX0VOIGJpdCBiZSAiMSIgY291bGQgZWxpbWluYXRlIHRoaXMg
ZW1iYXJyYXNzbWVudCwgd2UgbWFkZQ0KKyAqIGl0IG9uIGN1c3RvbSBjbG9uZSBtb2RlIGFwcGxp
Y2F0aW9uLiBXaGlsZSBMUzdBMjAwMCBoYXMgdHdvIGhhcmR3YXJlDQorICogY3Vyc29yIHVuaXQg
d2hpY2ggaXMgZ29vZCBlbm91Z2guDQorICovDQorI2RlZmluZSBDVVJTT1JfRk9STUFUX01BU0sg
ICAgICAgICAgICAgIEdFTk1BU0soMSwgMCkNCisjZGVmaW5lIENVUlNPUl9GT1JNQVRfU0hJRlQg
ICAgICAgICAgICAgMA0KK2VudW0gbHNkY19jdXJzb3JfZm9ybWF0IHsNCisJQ1VSU09SX0ZPUk1B
VF9ESVNBQkxFID0gMCwNCisJQ1VSU09SX0ZPUk1BVF9NT05PQ0hST01FID0gMSwgICAvKiBtYXNr
ZWQgKi8NCisJQ1VSU09SX0ZPUk1BVF9BUkdCODg4OCA9IDIsICAgICAvKiBBOFI4RzhCOCAqLw0K
K307DQorDQorLyoNCisgKiBMUzdBMTAwMCBhbmQgTFMySzEwMDAgb25seSBzdXBwb3J0IDMyeDMy
LCBMUzJLMjAwMCBhbmQgTFM3QTIwMDAgc3VwcG9ydA0KKyAqIDY0eDY0LCBidXQgaXQgc2VlbXMg
dGhhdCBzZXR0aW5nIHRoaXMgYml0IG1ha2Ugbm8gaGFybXMgb24gTFM3QTEwMDAsIGl0DQorICog
anVzdCBkb24ndCB0YWtlIGVmZmVjdHMuDQorICovDQorI2RlZmluZSBDVVJTT1JfU0laRV9TSElG
VCAgICAgICAgICAgICAgIDINCitlbnVtIGxzZGNfY3Vyc29yX3NpemUgew0KKwlDVVJTT1JfU0la
RV8zMlgzMiA9IDAsDQorCUNVUlNPUl9TSVpFXzY0WDY0ID0gMSwNCit9Ow0KKw0KKyNkZWZpbmUg
Q1VSU09SX0xPQ0FUSU9OX1NISUZUICAgICAgICAgICA0DQorZW51bSBsc2RjX2N1cnNvcl9sb2Nh
dGlvbiB7DQorCUNVUlNPUl9PTl9DUlRDMCA9IDAsDQorCUNVUlNPUl9PTl9DUlRDMSA9IDEsDQor
fTsNCisNCisjZGVmaW5lIExTRENfQ1VSU09SMF9DRkdfUkVHICAgICAgICAgICAgMHgxNTIwDQor
I2RlZmluZSBMU0RDX0NVUlNPUjBfQUREUl9MT19SRUcgICAgICAgIDB4MTUzMA0KKyNkZWZpbmUg
TFNEQ19DVVJTT1IwX0FERFJfSElfUkVHICAgICAgICAweDE1ZTANCisjZGVmaW5lIExTRENfQ1VS
U09SMF9QT1NJVElPTl9SRUcgICAgICAgMHgxNTQwICAvKiBbMzE6MTZdIFksIFsxNTowXSBYICov
DQorI2RlZmluZSBMU0RDX0NVUlNPUjBfQkdfQ09MT1JfUkVHICAgICAgIDB4MTU1MCAgLyogYmFj
a2dyb3VuZCBjb2xvciAqLw0KKyNkZWZpbmUgTFNEQ19DVVJTT1IwX0ZHX0NPTE9SX1JFRyAgICAg
ICAweDE1NjAgIC8qIGZvcmVncm91bmQgY29sb3IgKi8NCisNCisjZGVmaW5lIExTRENfQ1VSU09S
MV9DRkdfUkVHICAgICAgICAgICAgMHgxNjcwDQorI2RlZmluZSBMU0RDX0NVUlNPUjFfQUREUl9M
T19SRUcgICAgICAgIDB4MTY4MA0KKyNkZWZpbmUgTFNEQ19DVVJTT1IxX0FERFJfSElfUkVHICAg
ICAgICAweDE2ZTANCisjZGVmaW5lIExTRENfQ1VSU09SMV9QT1NJVElPTl9SRUcgICAgICAgMHgx
NjkwICAvKiBbMzE6MTZdIFksIFsxNTowXSBYICovDQorI2RlZmluZSBMU0RDX0NVUlNPUjFfQkdf
Q09MT1JfUkVHICAgICAgIDB4MTZBMCAgLyogYmFja2dyb3VuZCBjb2xvciAqLw0KKyNkZWZpbmUg
TFNEQ19DVVJTT1IxX0ZHX0NPTE9SX1JFRyAgICAgICAweDE2QjAgIC8qIGZvcmVncm91bmQgY29s
b3IgKi8NCisNCisvKg0KKyAqIERDIEludGVycnVwdCBDb250cm9sIFJlZ2lzdGVyLCAzMmJpdCwg
QWRkcmVzcyBPZmZzZXQ6IDE1NzANCisgKg0KKyAqIEJpdHMgMTU6MCBpbmlkaWNhdGUgdGhlIGlu
dGVycnVwdCBzdGF0dXMNCisgKiBCaXRzIDMxOjE2IGNvbnRyb2wgZW5hYmxlIGludGVycnVwdHMg
Y29ycmVzcG9uZGluZyB0byBiaXQgMTU6MCBvciBub3QNCisgKiBXcml0ZSAxIHRvIGVuYWJsZSwg
d3JpdGUgMCB0byBkaXNhYmxlDQorICoNCisgKiBSRjogUmVhZCBGaW5pc2hlZA0KKyAqIElEQlU6
IEludGVybmFsIERhdGEgQnVmZmVyIFVuZGVyZmxvdw0KKyAqIElEQkZVOiBJbnRlcm5hbCBEYXRh
IEJ1ZmZlciBGYXRhbCBVbmRlcmZsb3cNCisgKiBDQlJGOiBDdXJzb3IgQnVmZmVyIFJlYWQgRmlu
aXNoZWQgRmxhZywgbm8gdXNlLg0KKyAqIEZCUkYwOiBDUlRDLTAgcmVhZGluZyBmcm9tIGl0cyBm
cmFtZWJ1ZmZlciBmaW5pc2hlZC4NCisgKiBGQlJGMTogQ1JUQy0xIHJlYWRpbmcgZnJvbSBpdHMg
ZnJhbWVidWZmZXIgZmluaXNoZWQuDQorICoNCisgKiArLS0tLS0tLSstLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLSstLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0rDQorICogfCAzMToy
NyB8ICAgICAgICAgMjY6MTYgICAgICAgICAgICB8IDE1OjExIHwgICAxMCAgIHwgICA5ICAgIHwg
ICA4ICAgfA0KKyAqICstLS0tLS0tKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKy0tLS0tLS0r
LS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLSsNCisgKiB8ICBOL0EgIHwgSW50ZXJydXB0IEVuYWJs
ZSBDb250cm9sIHwgIE4vQSAgfCBJREJGVTAgfCBJREJGVTEgfCBJREJVMCB8DQorICogKy0tLS0t
LS0rLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSst
LS0tLS0tKw0KKyAqDQorICogKy0tLS0tLS0rLS0tLS0tLSstLS0tLS0tKy0tLS0tLSstLS0tLS0t
LSstLS0tLS0tLSstLS0tLS0tLSstLS0tLS0tLSsNCisgKiB8ICAgNyAgIHwgICA2ICAgfCAgIDUg
ICB8ICA0ICAgfCAgIDMgICAgfCAgIDIgICAgfCAgIDEgICAgfCAgIDAgICAgfA0KKyAqICstLS0t
LS0tKy0tLS0tLS0rLS0tLS0tLSstLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0tLS0tLS0rLS0t
LS0tLS0rDQorICogfCBJREJVMSB8IEZCUkYwIHwgRkJSRjEgfCBDUlJGIHwgSFNZTkMwIHwgVlNZ
TkMwIHwgSFNZTkMxIHwgVlNZTkMxIHwNCisgKiArLS0tLS0tLSstLS0tLS0tKy0tLS0tLS0rLS0t
LS0tKy0tLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0tKy0tLS0tLS0tKw0KKyAqDQorICogdW5mb3J0
dW5hdGVseSwgQ1JUQzAncyBpbnRlcnJ1cHQgaXMgbWVzcyB3aXRoIENSVEMxJ3MgaW50ZXJydXB0
IGluIG9uZQ0KKyAqIHJlZ2lzdGVyIGFnYWluLg0KKyAqLw0KKw0KKyNkZWZpbmUgTFNEQ19JTlRf
UkVHICAgICAgICAgICAgICAgICAgICAweDE1NzANCisNCisjZGVmaW5lIElOVF9DUlRDMF9WU1lO
QyAgICAgICAgICAgICAgICAgQklUKDIpDQorI2RlZmluZSBJTlRfQ1JUQzBfSFNZTkMgICAgICAg
ICAgICAgICAgIEJJVCgzKQ0KKyNkZWZpbmUgSU5UX0NSVEMwX1JGICAgICAgICAgICAgICAgICAg
ICBCSVQoNikNCisjZGVmaW5lIElOVF9DUlRDMF9JREJVICAgICAgICAgICAgICAgICAgQklUKDgp
DQorI2RlZmluZSBJTlRfQ1JUQzBfSURCRlUgICAgICAgICAgICAgICAgIEJJVCgxMCkNCisNCisj
ZGVmaW5lIElOVF9DUlRDMV9WU1lOQyAgICAgICAgICAgICAgICAgQklUKDApDQorI2RlZmluZSBJ
TlRfQ1JUQzFfSFNZTkMgICAgICAgICAgICAgICAgIEJJVCgxKQ0KKyNkZWZpbmUgSU5UX0NSVEMx
X1JGICAgICAgICAgICAgICAgICAgICBCSVQoNSkNCisjZGVmaW5lIElOVF9DUlRDMV9JREJVICAg
ICAgICAgICAgICAgICAgQklUKDcpDQorI2RlZmluZSBJTlRfQ1JUQzFfSURCRlUgICAgICAgICAg
ICAgICAgIEJJVCg5KQ0KKw0KKyNkZWZpbmUgSU5UX0NSVEMwX1ZTWU5DX0VOICAgICAgICAgICAg
ICBCSVQoMTgpDQorI2RlZmluZSBJTlRfQ1JUQzBfSFNZTkNfRU4gICAgICAgICAgICAgIEJJVCgx
OSkNCisjZGVmaW5lIElOVF9DUlRDMF9SRl9FTiAgICAgICAgICAgICAgICAgQklUKDIyKQ0KKyNk
ZWZpbmUgSU5UX0NSVEMwX0lEQlVfRU4gICAgICAgICAgICAgICBCSVQoMjQpDQorI2RlZmluZSBJ
TlRfQ1JUQzBfSURCRlVfRU4gICAgICAgICAgICAgIEJJVCgyNikNCisNCisjZGVmaW5lIElOVF9D
UlRDMV9WU1lOQ19FTiAgICAgICAgICAgICAgQklUKDE2KQ0KKyNkZWZpbmUgSU5UX0NSVEMxX0hT
WU5DX0VOICAgICAgICAgICAgICBCSVQoMTcpDQorI2RlZmluZSBJTlRfQ1JUQzFfUkZfRU4gICAg
ICAgICAgICAgICAgIEJJVCgyMSkNCisjZGVmaW5lIElOVF9DUlRDMV9JREJVX0VOICAgICAgICAg
ICAgICAgQklUKDIzKQ0KKyNkZWZpbmUgSU5UX0NSVEMxX0lEQkZVX0VOICAgICAgICAgICAgICBC
SVQoMjUpDQorDQorI2RlZmluZSBJTlRfU1RBVFVTX01BU0sgICAgICAgICAgICAgICAgIEdFTk1B
U0soMTUsIDApDQorDQorLyoNCisgKiBMUzdBMTAwMC9MUzdBMjAwMCBoYXZlIDQgZ3Bpb3Mgd2hp
Y2ggYXJlIHVzZWQgdG8gZW11bGF0ZWQgSTJDLg0KKyAqIFRoZXkgYXJlIHVuZGVyIGNvbnRyb2wg
b2YgdGhlIExTN0FfRENfR1BJT19EQVRfUkVHIGFuZCBMUzdBX0RDX0dQSU9fRElSX1JFRw0KKyAq
IHJlZ2lzdGVyLCBUaG9zZSBHUElPcyBoYXMgbm8gcmVsYXRpb25zaGlwIHdodGggdGhlIEdQSU8g
aGFyZHdhcmUgb24gdGhlDQorICogYnJpZGdlIGNoaXAgaXRzZWxmLiBUaG9zZSBvZmZzZXRzIGFy
ZSByZWxhdGl2ZSB0byBEQyByZWdpc3RlciBiYXNlIGFkZHJlc3MNCisgKg0KKyAqIExTMmsxMDAw
IGRvbid0IGhhdmUgdGhvc2UgcmVnaXN0ZXJzLCB0aGV5IHVzZSBoYXJkd2FyZSBpMmMgb3IgZ2Vu
ZXJhbCBHUElPDQorICogZW11bGF0ZWQgaTJjIGZyb20gbGludXggaTJjIHN1YnN5c3RlbS4NCisg
Kg0KKyAqIEdQSU8gZGF0YSByZWdpc3RlciwgYWRkcmVzcyBvZmZzZXQ6IDB4MTY1MA0KKyAqICAg
Ky0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLSstLS0tLS0tLS0tLSsNCisgKiAgIHwgNyB8IDYg
fCA1IHwgNCB8ICAzICB8ICAyICB8ICAxICB8ICAwICB8DQorICogICArLS0tLS0tLS0tLS0tLS0t
Ky0tLS0tLS0tLS0tKy0tLS0tLS0tLS0tKw0KKyAqICAgfCAgICAgICAgICAgICAgIHwgICAgRFZP
MSAgIHwgICAgRFZPMCAgIHwNCisgKiAgICsgICAgICBOL0EgICAgICArLS0tLS0tLS0tLS0rLS0t
LS0tLS0tLS0rDQorICogICB8ICAgICAgICAgICAgICAgfCBTQ0wgfCBTREEgfCBTQ0wgfCBTREEg
fA0KKyAqICAgKy0tLS0tLS0tLS0tLS0tLSstLS0tLS0tLS0tLSstLS0tLS0tLS0tLSsNCisgKi8N
CisjZGVmaW5lIExTN0FfRENfR1BJT19EQVRfUkVHICAgICAgICAgICAgMHgxNjUwDQorDQorLyoN
CisgKiAgR1BJTyBJbnB1dC9PdXRwdXQgZGlyZWN0aW9uIGNvbnRyb2wgcmVnaXN0ZXIsIGFkZHJl
c3Mgb2Zmc2V0OiAweDE2NjANCisgKi8NCisjZGVmaW5lIExTN0FfRENfR1BJT19ESVJfUkVHICAg
ICAgICAgICAgMHgxNjYwDQorDQorLyoNCisgKiAgTFM3QTIwMDAgaGFzIHR3byBidWlsdC1pbiBI
RE1JIEVuY29kZXIgYW5kIG9uZSBWR0EgZW5jb2Rlcg0KKyAqLw0KKw0KKy8qDQorICogTnVtYmVy
IG9mIGNvbnRpbnVvdXMgcGFja2V0cyBtYXkgYmUgcHJlc2VudA0KKyAqIGluIEhETUkgaGJsYW5r
IGFuZCB2Ymxhbmsgem9uZSwgc2hvdWxkID49IDQ4DQorICovDQorI2RlZmluZSBMU0RDX0hETUkw
X1pPTkVfUkVHICAgICAgICAgICAgIDB4MTcwMA0KKyNkZWZpbmUgTFNEQ19IRE1JMV9aT05FX1JF
RyAgICAgICAgICAgICAweDE3MTANCisNCisjZGVmaW5lIEhETUlfSF9aT05FX0lETEVfU0hJRlQg
ICAgICAgICAgMA0KKyNkZWZpbmUgSERNSV9WX1pPTkVfSURMRV9TSElGVCAgICAgICAgICAxNg0K
Kw0KKy8qIEhETUkgSXRlcmZhY2UgQ29udHJvbCBSZWcgKi8NCisjZGVmaW5lIEhETUlfSU5URVJG
QUNFX0VOICAgICAgICAgICAgICAgQklUKDApDQorI2RlZmluZSBIRE1JX1BBQ0tFVF9FTiAgICAg
ICAgICAgICAgICAgIEJJVCgxKQ0KKyNkZWZpbmUgSERNSV9BVURJT19FTiAgICAgICAgICAgICAg
ICAgICBCSVQoMikNCisvKg0KKyAqIFByZWFtYmxlOg0KKyAqIEltbWVkaWF0ZWx5IHByZWNlZGlu
ZyBlYWNoIHZpZGVvIGRhdGEgcGVyaW9kIG9yIGRhdGEgaXNsYW5kIHBlcmlvZCBpcyB0aGUNCisg
KiBwcmVhbWJsZS4gVGhpcyBpcyBhIHNlcXVlbmNlIG9mIGVpZ2h0IGlkZW50aWNhbCBjb250cm9s
IGNoYXJhY3RlcnMgdGhhdA0KKyAqIGluZGljYXRlIHdoZXRoZXIgdGhlIHVwY29taW5nIGRhdGEg
cGVyaW9kIGlzIGEgdmlkZW8gZGF0YSBwZXJpb2Qgb3IgaXMgYQ0KKyAqIGRhdGEgaXNsYW5kLiBU
aGUgdmFsdWVzIG9mIENUTDAsIENUTDEsIENUTDIsIGFuZCBDVEwzIGluZGljYXRlIHRoZSB0eXBl
IG9mDQorICogZGF0YSBwZXJpb2QgdGhhdCBmb2xsb3dzLg0KKyAqLw0KKyNkZWZpbmUgSERNSV9W
SURFT19QUkVBTUJMRV9NQVNLICAgICAgICBHRU5NQVNLKDcsIDQpDQorI2RlZmluZSBIRE1JX1ZJ
REVPX1BSRUFNQkxFX1NISUZUICAgICAgIDQNCisvKiAxOiBodyBpMmMsIDA6IGdwaW8gZW11IGky
Yywgc2hvdWxkbid0IHB1dCBpbiBMU0RDX0hETUl4X0lOVEZfQ1RSTF9SRUcgKi8NCisjZGVmaW5l
IEhXX0kyQ19FTiAgICAgICAgICAgICAgICAgICAgICAgQklUKDgpDQorI2RlZmluZSBIRE1JX0NU
TF9QRVJJT0RfTU9ERSAgICAgICAgICAgIEJJVCg5KQ0KKyNkZWZpbmUgTFNEQ19IRE1JMF9JTlRG
X0NUUkxfUkVHICAgICAgICAweDE3MjANCisjZGVmaW5lIExTRENfSERNSTFfSU5URl9DVFJMX1JF
RyAgICAgICAgMHgxNzMwDQorDQorI2RlZmluZSBIRE1JX1BIWV9FTiAgICAgICAgICAgICAgICAg
ICAgIEJJVCgwKQ0KKyNkZWZpbmUgSERNSV9QSFlfUkVTRVRfTiAgICAgICAgICAgICAgICBCSVQo
MSkNCisjZGVmaW5lIEhETUlfUEhZX1RFUk1fTF9FTiAgICAgICAgICAgICAgQklUKDgpDQorI2Rl
ZmluZSBIRE1JX1BIWV9URVJNX0hfRU4gICAgICAgICAgICAgIEJJVCg5KQ0KKyNkZWZpbmUgSERN
SV9QSFlfVEVSTV9ERVRfRU4gICAgICAgICAgICBCSVQoMTApDQorI2RlZmluZSBIRE1JX1BIWV9U
RVJNX1NUQVRVUyAgICAgICAgICAgIEJJVCgxMSkNCisjZGVmaW5lIExTRENfSERNSTBfUEhZX0NU
UkxfUkVHICAgICAgICAgMHgxODAwDQorI2RlZmluZSBMU0RDX0hETUkxX1BIWV9DVFJMX1JFRyAg
ICAgICAgIDB4MTgxMA0KKw0KKy8qIEhpZ2ggbGV2ZWwgZHVyYXRpb24gbmVlZCA+IDF1cyAqLw0K
KyNkZWZpbmUgSERNSV9QTExfRU5BQkxFICAgICAgICAgICAgICAgICBCSVQoMCkNCisjZGVmaW5l
IEhETUlfUExMX0xPQ0tFRCAgICAgICAgICAgICAgICAgQklUKDE2KQ0KKy8qIEJ5cGFzcyB0aGUg
c29mdHdhcmUgY29uZmlndXJlZCB2YWx1ZXMsIHVzaW5nIGRlZmF1bHQgc291cmNlIGZyb20gc29t
ZXdoZXJlICovDQorI2RlZmluZSBIRE1JX1BMTF9CWVBBU1MgICAgICAgICAgICAgICAgIEJJVCgx
NykNCisNCisjZGVmaW5lIEhETUlfUExMX0lERl9TSElGVCAgICAgICAgICAgICAgMQ0KKyNkZWZp
bmUgSERNSV9QTExfSURGX01BU0sgICAgICAgICAgICAgICBHRU5NQVNLKDUsIDEpDQorI2RlZmlu
ZSBIRE1JX1BMTF9MRl9TSElGVCAgICAgICAgICAgICAgIDYNCisjZGVmaW5lIEhETUlfUExMX0xG
X01BU0sgICAgICAgICAgICAgICAgR0VOTUFTSygxMiwgNikNCisjZGVmaW5lIEhETUlfUExMX09E
Rl9TSElGVCAgICAgICAgICAgICAgMTMNCisjZGVmaW5lIEhETUlfUExMX09ERl9NQVNLICAgICAg
ICAgICAgICAgR0VOTUFTSygxNSwgMTMpDQorI2RlZmluZSBMU0RDX0hETUkwX1BIWV9QTExfUkVH
ICAgICAgICAgIDB4MTgyMA0KKyNkZWZpbmUgTFNEQ19IRE1JMV9QSFlfUExMX1JFRyAgICAgICAg
ICAweDE4MzANCisNCisvKiBMUzdBMjAwMC9MUzJLMjAwMCBoYXMgaHBkIHN0YXR1cyByZWcsIHdo
aWxlIHRoZSB0d28gaGRtaSdzIHN0YXR1cw0KKyAqIGxvY2F0ZWQgYXQgdGhlIG9uZSByZWdpc3Rl
ciBhZ2Fpbi4NCisgKi8NCisjZGVmaW5lIExTRENfSERNSV9IUERfU1RBVFVTX1JFRyAgICAgICAg
MHgxQkEwDQorI2RlZmluZSBIRE1JMF9IUERfRkxBRyAgICAgICAgICAgICAgICAgIEJJVCgwKQ0K
KyNkZWZpbmUgSERNSTFfSFBEX0ZMQUcgICAgICAgICAgICAgICAgICBCSVQoMSkNCisNCisjZGVm
aW5lIExTRENfSERNSTBfUEhZX0NBTF9SRUcgICAgICAgICAgMHgxOEMwDQorI2RlZmluZSBMU0RD
X0hETUkxX1BIWV9DQUxfUkVHICAgICAgICAgIDB4MThEMA0KKw0KKy8qIEFWSSBJbmZvRnJhbWUg
Ki8NCisjZGVmaW5lIExTRENfSERNSTBfQVZJX0NPTlRFTlQwICAgICAgICAgMHgxOEUwDQorI2Rl
ZmluZSBMU0RDX0hETUkxX0FWSV9DT05URU5UMCAgICAgICAgIDB4MThEMA0KKyNkZWZpbmUgTFNE
Q19IRE1JMF9BVklfQ09OVEVOVDEgICAgICAgICAweDE5MDANCisjZGVmaW5lIExTRENfSERNSTFf
QVZJX0NPTlRFTlQxICAgICAgICAgMHgxOTEwDQorI2RlZmluZSBMU0RDX0hETUkwX0FWSV9DT05U
RU5UMiAgICAgICAgIDB4MTkyMA0KKyNkZWZpbmUgTFNEQ19IRE1JMV9BVklfQ09OVEVOVDIgICAg
ICAgICAweDE5MzANCisjZGVmaW5lIExTRENfSERNSTBfQVZJX0NPTlRFTlQzICAgICAgICAgMHgx
OTQwDQorI2RlZmluZSBMU0RDX0hETUkxX0FWSV9DT05URU5UMyAgICAgICAgIDB4MTk1MA0KKw0K
Ky8qIDE6IGVuYWJsZSBhdmkgaW5mb2ZyYW1lIHBhY2tldCwgMDogZGlzYWJsZSBhdmkgaW5mb2Zy
YW1lIHBhY2tldCAqLw0KKyNkZWZpbmUgQVZJX1BLVF9FTkFCTEUgICAgICAgICAgICAgICAgICBC
SVQoMCkNCisvKiAxOiBzZW5kIG9uZSBldmVyeSB0d28gZnJhbWUsIDA6IHNlbmQgb25lIGVhY2gg
ZnJhbWUgKi8NCisjZGVmaW5lIEFWSV9QS1RfU0VORF9GUkVRICAgICAgICAgICAgICAgQklUKDEp
DQorLyoNCisgKiAxOiB3cml0ZSAxIHRvIGZsdXNoIGF2aSByZWcgY29udGVudDAgfiBjb250ZW50
MyB0byB0aGUgcGFja2V0IHRvIGJlIHNlbmQsDQorICogVGhlIGhhcmR3YXJlIHdpbGwgY2xlYXIg
dGhpcyBiaXQgYXV0b21hdGljYWxseS4NCisgKi8NCisjZGVmaW5lIEFWSV9QS1RfVVBEQVRFICAg
ICAgICAgICAgICAgICAgQklUKDIpDQorDQorI2RlZmluZSBMU0RDX0hETUkwX0FWSV9JTkZPX0NS
VExfUkVHICAgIDB4MTk2MA0KKyNkZWZpbmUgTFNEQ19IRE1JMV9BVklfSU5GT19DUlRMX1JFRyAg
ICAweDE5NzANCisNCisvKg0KKyAqIExTN0EyMDAwIGhhcyB0aGUgaGFyZHdhcmUgd2hpY2ggY291
bnQgdGhlIG51bWJlciBvZiB2YmxhbmsgZ2VuZXJhdGVkDQorICovDQorI2RlZmluZSBMU0RDX0NS
VEMwX1ZTWU5DX0NPVU5URVJfUkVHICAgIDB4MUEwMA0KKyNkZWZpbmUgTFNEQ19DUlRDMV9WU1lO
Q19DT1VOVEVSX1JFRyAgICAweDFBMTANCisNCisvKg0KKyAqIExTN0EyMDAwIGhhcyB0aGUgYXVk
aW8gaGFyZHdhcmUgYXNzb2NpYXRlIHdpdGggdGhlIEhETUkgZW5jb2Rlci4NCisgKi8NCisjZGVm
aW5lIExTRENfSERNSTBfQVVESU9fUExMX0xPX1JFRyAgICAgMHgxQTIwDQorI2RlZmluZSBMU0RD
X0hETUkxX0FVRElPX1BMTF9MT19SRUcgICAgIDB4MUEzMA0KKw0KKyNkZWZpbmUgTFNEQ19IRE1J
MF9BVURJT19QTExfSElfUkVHICAgICAweDFBNDANCisjZGVmaW5lIExTRENfSERNSTFfQVVESU9f
UExMX0hJX1JFRyAgICAgMHgxQTUwDQorDQorI2VuZGlmDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9n
cHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmMgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y190dG0uYw0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAwMDAwMDAwMC4uZmQyY2Nm
NTY3MGIxDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbG9vbmdzb24vbHNk
Y190dG0uYw0KQEAgLTAsMCArMSw2MTAgQEANCisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMCsNCisvKg0KKyAqIENvcHlyaWdodCAoQykgMjAyMyBMb29uZ3NvbiBUZWNobm9sb2d5
IENvcnBvcmF0aW9uIExpbWl0ZWQNCisgKi8NCisNCisjaW5jbHVkZSA8ZHJtL2RybV9kcnYuaD4N
CisjaW5jbHVkZSA8ZHJtL2RybV9maWxlLmg+DQorI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+DQor
I2luY2x1ZGUgPGRybS9kcm1fbWFuYWdlZC5oPg0KKyNpbmNsdWRlIDxkcm0vZHJtX3ByaW1lLmg+
DQorDQorI2luY2x1ZGUgImxzZGNfZHJ2LmgiDQorI2luY2x1ZGUgImxzZGNfdHRtLmgiDQorDQor
Y29uc3QgY2hhciAqbHNkY19tZW1fdHlwZV90b19zdHIodWludDMyX3QgbWVtX3R5cGUpDQorew0K
Kwlzd2l0Y2ggKG1lbV90eXBlKSB7DQorCWNhc2UgVFRNX1BMX1ZSQU06DQorCQlyZXR1cm4gIlZS
QU0iOw0KKwljYXNlIFRUTV9QTF9UVDoNCisJCXJldHVybiAiR1RUIjsNCisJY2FzZSBUVE1fUExf
U1lTVEVNOg0KKwkJcmV0dXJuICJTWVNURU0iOw0KKwlkZWZhdWx0Og0KKwkJYnJlYWs7DQorCX0N
CisNCisJcmV0dXJuICJVbmtub3duIjsNCit9DQorDQorY29uc3QgY2hhciAqbHNkY19kb21haW5f
dG9fc3RyKHUzMiBkb21haW4pDQorew0KKwlzd2l0Y2ggKGRvbWFpbikgew0KKwljYXNlIExTRENf
R0VNX0RPTUFJTl9WUkFNOg0KKwkJcmV0dXJuICJWUkFNIjsNCisJY2FzZSBMU0RDX0dFTV9ET01B
SU5fR1RUOg0KKwkJcmV0dXJuICJHVFQiOw0KKwljYXNlIExTRENfR0VNX0RPTUFJTl9TWVNURU06
DQorCQlyZXR1cm4gIlNZU1RFTSI7DQorCWRlZmF1bHQ6DQorCQlicmVhazsNCisJfQ0KKw0KKwly
ZXR1cm4gIlVua25vd24iOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2JvX3NldF9wbGFjZW1l
bnQoc3RydWN0IGxzZGNfYm8gKmxibywgdTMyIGRvbWFpbikNCit7DQorCXUzMiBjID0gMDsNCisJ
dTMyIHBmbGFncyA9IDA7DQorCXUzMiBpOw0KKw0KKwlpZiAobGJvLT50Ym8uYmFzZS5zaXplIDw9
IFBBR0VfU0laRSkNCisJCXBmbGFncyB8PSBUVE1fUExfRkxBR19UT1BET1dOOw0KKw0KKwlsYm8t
PnBsYWNlbWVudC5wbGFjZW1lbnQgPSBsYm8tPnBsYWNlbWVudHM7DQorCWxiby0+cGxhY2VtZW50
LmJ1c3lfcGxhY2VtZW50ID0gbGJvLT5wbGFjZW1lbnRzOw0KKw0KKwlpZiAoZG9tYWluICYgTFNE
Q19HRU1fRE9NQUlOX1ZSQU0pIHsNCisJCWxiby0+cGxhY2VtZW50c1tjXS5tZW1fdHlwZSA9IFRU
TV9QTF9WUkFNOw0KKwkJbGJvLT5wbGFjZW1lbnRzW2MrK10uZmxhZ3MgPSBwZmxhZ3M7DQorCX0N
CisNCisJaWYgKGRvbWFpbiAmIExTRENfR0VNX0RPTUFJTl9HVFQpIHsNCisJCWxiby0+cGxhY2Vt
ZW50c1tjXS5tZW1fdHlwZSA9IFRUTV9QTF9UVDsNCisJCWxiby0+cGxhY2VtZW50c1tjKytdLmZs
YWdzID0gcGZsYWdzOw0KKwl9DQorDQorCWlmIChkb21haW4gJiBMU0RDX0dFTV9ET01BSU5fU1lT
VEVNKSB7DQorCQlsYm8tPnBsYWNlbWVudHNbY10ubWVtX3R5cGUgPSBUVE1fUExfU1lTVEVNOw0K
KwkJbGJvLT5wbGFjZW1lbnRzW2MrK10uZmxhZ3MgPSAwOw0KKwl9DQorDQorCWlmICghYykgew0K
KwkJbGJvLT5wbGFjZW1lbnRzW2NdLm1lbV90eXBlID0gVFRNX1BMX1NZU1RFTTsNCisJCWxiby0+
cGxhY2VtZW50c1tjKytdLmZsYWdzID0gMDsNCisJfQ0KKw0KKwlsYm8tPnBsYWNlbWVudC5udW1f
cGxhY2VtZW50ID0gYzsNCisJbGJvLT5wbGFjZW1lbnQubnVtX2J1c3lfcGxhY2VtZW50ID0gYzsN
CisNCisJZm9yIChpID0gMDsgaSA8IGM7ICsraSkgew0KKwkJbGJvLT5wbGFjZW1lbnRzW2ldLmZw
Zm4gPSAwOw0KKwkJbGJvLT5wbGFjZW1lbnRzW2ldLmxwZm4gPSAwOw0KKwl9DQorfQ0KKw0KK3N0
YXRpYyB2b2lkIGxzZGNfdHRtX3R0X2Rlc3Ryb3koc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYsIHN0
cnVjdCB0dG1fdHQgKnR0KQ0KK3sNCisJdHRtX3R0X2ZpbmkodHQpOw0KKwlrZnJlZSh0dCk7DQor
fQ0KKw0KK3N0YXRpYyBzdHJ1Y3QgdHRtX3R0ICoNCitsc2RjX3R0bV90dF9jcmVhdGUoc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8sIHVpbnQzMl90IHBhZ2VfZmxhZ3MpDQorew0KKwlzdHJ1
Y3QgdHRtX3R0ICp0dDsNCisJaW50IHJldDsNCisNCisJdHQgPSBremFsbG9jKHNpemVvZigqdHQp
LCBHRlBfS0VSTkVMKTsNCisJaWYgKCF0dCkNCisJCXJldHVybiBOVUxMOw0KKw0KKwlyZXQgPSB0
dG1fc2dfdHRfaW5pdCh0dCwgdGJvLCBwYWdlX2ZsYWdzLCB0dG1fY2FjaGVkKTsNCisJaWYgKHJl
dCA8IDApIHsNCisJCWtmcmVlKHR0KTsNCisJCXJldHVybiBOVUxMOw0KKwl9DQorDQorCXJldHVy
biB0dDsNCit9DQorDQorc3RhdGljIGludCBsc2RjX3R0bV90dF9wb3B1bGF0ZShzdHJ1Y3QgdHRt
X2RldmljZSAqYmRldiwNCisJCQkJc3RydWN0IHR0bV90dCAqdHRtLA0KKwkJCQlzdHJ1Y3QgdHRt
X29wZXJhdGlvbl9jdHggKmN0eCkNCit7DQorCWJvb2wgc2xhdmUgPSAhISh0dG0tPnBhZ2VfZmxh
Z3MgJiBUVE1fVFRfRkxBR19FWFRFUk5BTCk7DQorDQorCWlmIChzbGF2ZSAmJiB0dG0tPnNnKSB7
DQorCQlkcm1fcHJpbWVfc2dfdG9fZG1hX2FkZHJfYXJyYXkodHRtLT5zZywNCisJCQkJCSAgICAg
ICB0dG0tPmRtYV9hZGRyZXNzLA0KKwkJCQkJICAgICAgIHR0bS0+bnVtX3BhZ2VzKTsNCisNCisJ
CXJldHVybiAwOw0KKwl9DQorDQorCXJldHVybiB0dG1fcG9vbF9hbGxvYygmYmRldi0+cG9vbCwg
dHRtLCBjdHgpOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX3R0bV90dF91bnBvcHVsYXRlKHN0
cnVjdCB0dG1fZGV2aWNlICpiZGV2LA0KKwkJCQkgICBzdHJ1Y3QgdHRtX3R0ICp0dG0pDQorew0K
Kwlib29sIHNsYXZlID0gISEodHRtLT5wYWdlX2ZsYWdzICYgVFRNX1RUX0ZMQUdfRVhURVJOQUwp
Ow0KKw0KKwlpZiAoc2xhdmUpDQorCQlyZXR1cm47DQorDQorCXJldHVybiB0dG1fcG9vbF9mcmVl
KCZiZGV2LT5wb29sLCB0dG0pOw0KK30NCisNCitzdGF0aWMgdm9pZCBsc2RjX2JvX2V2aWN0X2Zs
YWdzKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvLA0KKwkJCQlzdHJ1Y3QgdHRtX3BsYWNl
bWVudCAqdHBsYWNlbWVudCkNCit7DQorCXN0cnVjdCB0dG1fcmVzb3VyY2UgKnJlc291cmNlID0g
dGJvLT5yZXNvdXJjZTsNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9IHRvX2xzZGNfYm8odGJvKTsN
CisNCisJc3dpdGNoIChyZXNvdXJjZS0+bWVtX3R5cGUpIHsNCisJY2FzZSBUVE1fUExfVlJBTToN
CisJCWxzZGNfYm9fc2V0X3BsYWNlbWVudChsYm8sIExTRENfR0VNX0RPTUFJTl9HVFQpOw0KKwkJ
YnJlYWs7DQorCWNhc2UgVFRNX1BMX1RUOg0KKwlkZWZhdWx0Og0KKwkJbHNkY19ib19zZXRfcGxh
Y2VtZW50KGxibywgTFNEQ19HRU1fRE9NQUlOX1NZU1RFTSk7DQorCQlicmVhazsNCisJfQ0KKw0K
KwkqdHBsYWNlbWVudCA9IGxiby0+cGxhY2VtZW50Ow0KK30NCisNCitzdGF0aWMgaW50IGxzZGNf
Ym9fbW92ZShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibywNCisJCQlib29sIGV2aWN0LA0K
KwkJCXN0cnVjdCB0dG1fb3BlcmF0aW9uX2N0eCAqY3R4LA0KKwkJCXN0cnVjdCB0dG1fcmVzb3Vy
Y2UgKm5ld19tZW0sDQorCQkJc3RydWN0IHR0bV9wbGFjZSAqaG9wKQ0KK3sNCisJc3RydWN0IGRy
bV9kZXZpY2UgKmRkZXYgPSB0Ym8tPmJhc2UuZGV2Ow0KKwlzdHJ1Y3QgdHRtX3Jlc291cmNlICpv
bGRfbWVtID0gdGJvLT5yZXNvdXJjZTsNCisJc3RydWN0IGxzZGNfYm8gKmxibyA9IHRvX2xzZGNf
Ym8odGJvKTsNCisJaW50IHJldDsNCisNCisJaWYgKHVubGlrZWx5KHRiby0+cGluX2NvdW50ID4g
MCkpIHsNCisJCWRybV93YXJuKGRkZXYsICJDYW4ndCBtb3ZlIGEgcGlubmVkIEJPXG4iKTsNCisJ
CXJldHVybiAtRUlOVkFMOw0KKwl9DQorDQorCXJldCA9IHR0bV9ib193YWl0X2N0eCh0Ym8sIGN0
eCk7DQorCWlmIChyZXQpDQorCQlyZXR1cm4gcmV0Ow0KKw0KKwlpZiAoIW9sZF9tZW0pIHsNCisJ
CWRybV9kYmcoZGRldiwgImJvWyVwXSBtb3ZlOiBOVUxMIHRvICVzLCBzaXplOiAlenVcbiIsDQor
CQkJbGJvLCBsc2RjX21lbV90eXBlX3RvX3N0cihuZXdfbWVtLT5tZW1fdHlwZSksDQorCQkJbHNk
Y19ib19zaXplKGxibykpOw0KKwkJdHRtX2JvX21vdmVfbnVsbCh0Ym8sIG5ld19tZW0pOw0KKwkJ
cmV0dXJuIDA7DQorCX0NCisNCisJaWYgKG9sZF9tZW0tPm1lbV90eXBlID09IFRUTV9QTF9TWVNU
RU0gJiYgIXRiby0+dHRtKSB7DQorCQl0dG1fYm9fbW92ZV9udWxsKHRibywgbmV3X21lbSk7DQor
CQlkcm1fZGJnKGRkZXYsICJib1slcF0gbW92ZTogU1lTVEVNIHRvIE5VTEwsIHNpemU6ICV6dVxu
IiwNCisJCQlsYm8sIGxzZGNfYm9fc2l6ZShsYm8pKTsNCisJCXJldHVybiAwOw0KKwl9DQorDQor
CWlmIChvbGRfbWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNICYmDQorCSAgICBuZXdfbWVt
LT5tZW1fdHlwZSA9PSBUVE1fUExfVFQpIHsNCisJCWRybV9kYmcoZGRldiwgImJvWyVwXSBtb3Zl
OiBTWVNURU0gdG8gR1RULCBzaXplOiAlenVcbiIsDQorCQkJbGJvLCBsc2RjX2JvX3NpemUobGJv
KSk7DQorCQl0dG1fYm9fbW92ZV9udWxsKHRibywgbmV3X21lbSk7DQorCQlyZXR1cm4gMDsNCisJ
fQ0KKw0KKwlpZiAob2xkX21lbS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUICYmDQorCSAgICBuZXdf
bWVtLT5tZW1fdHlwZSA9PSBUVE1fUExfU1lTVEVNKSB7DQorCQlkcm1fZGJnKGRkZXYsICJib1sl
cF0gbW92ZTogR1RUIHRvIFNZU1RFTSwgc2l6ZTogJXp1XG4iLA0KKwkJCWxibywgbHNkY19ib19z
aXplKGxibykpOw0KKwkJdHRtX3Jlc291cmNlX2ZyZWUodGJvLCAmdGJvLT5yZXNvdXJjZSk7DQor
CQl0dG1fYm9fYXNzaWduX21lbSh0Ym8sIG5ld19tZW0pOw0KKwkJcmV0dXJuIDA7DQorCX0NCisN
CisJZHJtX2RiZyhkZGV2LCAiYm9bJXBdIG1vdmU6ICVzIHRvICVzLCBzaXplOiAlenVcbiIsDQor
CQlsYm8sDQorCQlsc2RjX21lbV90eXBlX3RvX3N0cihvbGRfbWVtLT5tZW1fdHlwZSksDQorCQls
c2RjX21lbV90eXBlX3RvX3N0cihuZXdfbWVtLT5tZW1fdHlwZSksDQorCQlsc2RjX2JvX3NpemUo
bGJvKSk7DQorDQorCXJldHVybiB0dG1fYm9fbW92ZV9tZW1jcHkodGJvLCBjdHgsIG5ld19tZW0p
Ow0KK30NCisNCitzdGF0aWMgaW50IGxzZGNfYm9fcmVzZXJ2ZV9pb19tZW0oc3RydWN0IHR0bV9k
ZXZpY2UgKmJkZXYsDQorCQkJCSAgc3RydWN0IHR0bV9yZXNvdXJjZSAqbWVtKQ0KK3sNCisJc3Ry
dWN0IGxzZGNfZGV2aWNlICpsZGV2ID0gdGRldl90b19sZGV2KGJkZXYpOw0KKw0KKwlzd2l0Y2gg
KG1lbS0+bWVtX3R5cGUpIHsNCisJY2FzZSBUVE1fUExfU1lTVEVNOg0KKwkJYnJlYWs7DQorCWNh
c2UgVFRNX1BMX1RUOg0KKwkJYnJlYWs7DQorCWNhc2UgVFRNX1BMX1ZSQU06DQorCQltZW0tPmJ1
cy5vZmZzZXQgPSAobWVtLT5zdGFydCA8PCBQQUdFX1NISUZUKSArIGxkZXYtPnZyYW1fYmFzZTsN
CisJCW1lbS0+YnVzLmlzX2lvbWVtID0gdHJ1ZTsNCisJCW1lbS0+YnVzLmNhY2hpbmcgPSB0dG1f
d3JpdGVfY29tYmluZWQ7DQorCQlicmVhazsNCisJZGVmYXVsdDoNCisJCXJldHVybiAtRUlOVkFM
Ow0KKwl9DQorDQorCXJldHVybiAwOw0KK30NCisNCitzdGF0aWMgc3RydWN0IHR0bV9kZXZpY2Vf
ZnVuY3MgbHNkY19ib19kcml2ZXIgPSB7DQorCS50dG1fdHRfY3JlYXRlID0gbHNkY190dG1fdHRf
Y3JlYXRlLA0KKwkudHRtX3R0X3BvcHVsYXRlID0gbHNkY190dG1fdHRfcG9wdWxhdGUsDQorCS50
dG1fdHRfdW5wb3B1bGF0ZSA9IGxzZGNfdHRtX3R0X3VucG9wdWxhdGUsDQorCS50dG1fdHRfZGVz
dHJveSA9IGxzZGNfdHRtX3R0X2Rlc3Ryb3ksDQorCS5ldmljdGlvbl92YWx1YWJsZSA9IHR0bV9i
b19ldmljdGlvbl92YWx1YWJsZSwNCisJLmV2aWN0X2ZsYWdzID0gbHNkY19ib19ldmljdF9mbGFn
cywNCisJLm1vdmUgPSBsc2RjX2JvX21vdmUsDQorCS5pb19tZW1fcmVzZXJ2ZSA9IGxzZGNfYm9f
cmVzZXJ2ZV9pb19tZW0sDQorfTsNCisNCit1NjQgbHNkY19ib19ncHVfb2Zmc2V0KHN0cnVjdCBs
c2RjX2JvICpsYm8pDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9ICZsYm8t
PnRibzsNCisJc3RydWN0IGRybV9kZXZpY2UgKmRkZXYgPSB0Ym8tPmJhc2UuZGV2Ow0KKwlzdHJ1
Y3QgdHRtX3Jlc291cmNlICpyZXNvdXJjZSA9IHRiby0+cmVzb3VyY2U7DQorDQorCWlmICh1bmxp
a2VseSghdGJvLT5waW5fY291bnQpKSB7DQorCQlkcm1fZXJyKGRkZXYsICJ1bnBpbm5lZCBibywg
Z3B1IHZpcnR1YWwgYWRkcmVzcyBpcyBpbnZhbGlkXG4iKTsNCisJCXJldHVybiAwOw0KKwl9DQor
DQorCWlmICh1bmxpa2VseShyZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1NZU1RFTSkpDQor
CQlyZXR1cm4gMDsNCisNCisJcmV0dXJuIHJlc291cmNlLT5zdGFydCA8PCBQQUdFX1NISUZUOw0K
K30NCisNCitzaXplX3QgbHNkY19ib19zaXplKHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibyA9ICZsYm8tPnRibzsNCisNCisJcmV0dXJuIHRi
by0+YmFzZS5zaXplOw0KK30NCisNCitpbnQgbHNkY19ib19yZXNlcnZlKHN0cnVjdCBsc2RjX2Jv
ICpsYm8pDQorew0KKwlyZXR1cm4gdHRtX2JvX3Jlc2VydmUoJmxiby0+dGJvLCB0cnVlLCBmYWxz
ZSwgTlVMTCk7DQorfQ0KKw0KK3ZvaWQgbHNkY19ib191bnJlc2VydmUoc3RydWN0IGxzZGNfYm8g
KmxibykNCit7DQorCXJldHVybiB0dG1fYm9fdW5yZXNlcnZlKCZsYm8tPnRibyk7DQorfQ0KKw0K
K2ludCBsc2RjX2JvX3BpbihzdHJ1Y3QgbHNkY19ibyAqbGJvLCB1MzIgZG9tYWluLCB1NjQgKmdw
dV9hZGRyKQ0KK3sNCisJc3RydWN0IHR0bV9vcGVyYXRpb25fY3R4IGN0eCA9IHsgZmFsc2UsIGZh
bHNlIH07DQorCXN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwlz
dHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0ZGV2X3RvX2xkZXYodGJvLT5iZGV2KTsNCisJaW50
IHJldDsNCisNCisJaWYgKHRiby0+cGluX2NvdW50KQ0KKwkJZ290byBib19waW5uZWQ7DQorDQor
CWlmIChsYm8tPnNoYXJpbmdfY291bnQgJiYgZG9tYWluID09IExTRENfR0VNX0RPTUFJTl9WUkFN
KQ0KKwkJcmV0dXJuIC1FSU5WQUw7DQorDQorCWlmIChkb21haW4pDQorCQlsc2RjX2JvX3NldF9w
bGFjZW1lbnQobGJvLCBkb21haW4pOw0KKw0KKwlyZXQgPSB0dG1fYm9fdmFsaWRhdGUodGJvLCAm
bGJvLT5wbGFjZW1lbnQsICZjdHgpOw0KKwlpZiAodW5saWtlbHkocmV0KSkgew0KKwkJZHJtX2Vy
cigmbGRldi0+YmFzZSwgIiVwIHZhbGlkYXRlIGZhaWxlZDogJWRcbiIsIGxibywgcmV0KTsNCisJ
CXJldHVybiByZXQ7DQorCX0NCisNCisJaWYgKGRvbWFpbiA9PSBMU0RDX0dFTV9ET01BSU5fVlJB
TSkNCisJCWxkZXYtPnZyYW1fcGlubmVkX3NpemUgKz0gbHNkY19ib19zaXplKGxibyk7DQorCWVs
c2UgaWYgKGRvbWFpbiA9PSBMU0RDX0dFTV9ET01BSU5fR1RUKQ0KKwkJbGRldi0+Z3R0X3Bpbm5l
ZF9zaXplICs9IGxzZGNfYm9fc2l6ZShsYm8pOw0KKw0KK2JvX3Bpbm5lZDoNCisJdHRtX2JvX3Bp
bih0Ym8pOw0KKw0KKwlpZiAoZ3B1X2FkZHIpDQorCQkqZ3B1X2FkZHIgPSBsc2RjX2JvX2dwdV9v
ZmZzZXQobGJvKTsNCisNCisJcmV0dXJuIDA7DQorfQ0KKw0KK3ZvaWQgbHNkY19ib191bnBpbihz
dHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICp0Ym8g
PSAmbGJvLT50Ym87DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IHRkZXZfdG9fbGRldih0
Ym8tPmJkZXYpOw0KKw0KKwlpZiAodW5saWtlbHkoIXRiby0+cGluX2NvdW50KSkgew0KKwkJZHJt
X2RiZygmbGRldi0+YmFzZSwgIiVwIHVucGluIGlzIG5vdCBuZWNlc3NhcnlcbiIsIGxibyk7DQor
CQlyZXR1cm47DQorCX0NCisNCisJdHRtX2JvX3VucGluKHRibyk7DQorDQorCWlmICghdGJvLT5w
aW5fY291bnQpIHsNCisJCWlmICh0Ym8tPnJlc291cmNlLT5tZW1fdHlwZSA9PSBUVE1fUExfVlJB
TSkNCisJCQlsZGV2LT52cmFtX3Bpbm5lZF9zaXplIC09IGxzZGNfYm9fc2l6ZShsYm8pOw0KKwkJ
ZWxzZSBpZiAodGJvLT5yZXNvdXJjZS0+bWVtX3R5cGUgPT0gVFRNX1BMX1RUKQ0KKwkJCWxkZXYt
Pmd0dF9waW5uZWRfc2l6ZSAtPSBsc2RjX2JvX3NpemUobGJvKTsNCisJfQ0KK30NCisNCit2b2lk
IGxzZGNfYm9fcmVmKHN0cnVjdCBsc2RjX2JvICpsYm8pDQorew0KKwlzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKnRibyA9ICZsYm8tPnRibzsNCisNCisJdHRtX2JvX2dldCh0Ym8pOw0KK30NCisN
Cit2b2lkIGxzZGNfYm9fdW5yZWYoc3RydWN0IGxzZGNfYm8gKmxibykNCit7DQorCXN0cnVjdCB0
dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKw0KKwl0dG1fYm9fcHV0KHRibyk7
DQorfQ0KKw0KK2ludCBsc2RjX2JvX2ttYXAoc3RydWN0IGxzZGNfYm8gKmxibykNCit7DQorCXN0
cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvID0gJmxiby0+dGJvOw0KKwlzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKmdlbSA9ICZ0Ym8tPmJhc2U7DQorCXN0cnVjdCBkcm1fZGV2aWNlICpkZGV2ID0g
Z2VtLT5kZXY7DQorCWxvbmcgcmV0Ow0KKwlpbnQgZXJyOw0KKw0KKwlyZXQgPSBkbWFfcmVzdl93
YWl0X3RpbWVvdXQoZ2VtLT5yZXN2LA0KKwkJCQkgICAgRE1BX1JFU1ZfVVNBR0VfS0VSTkVMLA0K
KwkJCQkgICAgZmFsc2UsDQorCQkJCSAgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7DQorCWlmIChy
ZXQgPCAwKSB7DQorCQlkcm1fd2FybihkZGV2LCAid2FpdCBmZW5jZSB0aW1lb3V0XG4iKTsNCisJ
CXJldHVybiByZXQ7DQorCX0NCisNCisJaWYgKGxiby0+a3B0cikNCisJCXJldHVybiAwOw0KKw0K
KwllcnIgPSB0dG1fYm9fa21hcCh0Ym8sIDAsIFBGTl9VUChsc2RjX2JvX3NpemUobGJvKSksICZs
Ym8tPmttYXApOw0KKwlpZiAoZXJyKSB7DQorCQlkcm1fZXJyKGRkZXYsICJrbWFwICVwIGZhaWxl
ZDogJWRcbiIsIGxibywgZXJyKTsNCisJCXJldHVybiBlcnI7DQorCX0NCisNCisJbGJvLT5rcHRy
ID0gdHRtX2ttYXBfb2JqX3ZpcnR1YWwoJmxiby0+a21hcCwgJmxiby0+aXNfaW9tZW0pOw0KKw0K
KwlyZXR1cm4gMDsNCit9DQorDQordm9pZCBsc2RjX2JvX2t1bm1hcChzdHJ1Y3QgbHNkY19ibyAq
bGJvKQ0KK3sNCisJaWYgKCFsYm8tPmtwdHIpDQorCQlyZXR1cm47DQorDQorCWxiby0+a3B0ciA9
IE5VTEw7DQorCXR0bV9ib19rdW5tYXAoJmxiby0+a21hcCk7DQorfQ0KKw0KK3ZvaWQgbHNkY19i
b19jbGVhcihzdHJ1Y3QgbHNkY19ibyAqbGJvKQ0KK3sNCisJbHNkY19ib19rbWFwKGxibyk7DQor
DQorCWlmIChsYm8tPmlzX2lvbWVtKQ0KKwkJbWVtc2V0X2lvKCh2b2lkIF9faW9tZW0gKilsYm8t
PmtwdHIsIDAsIGxiby0+c2l6ZSk7DQorCWVsc2UNCisJCW1lbXNldChsYm8tPmtwdHIsIDAsIGxi
by0+c2l6ZSk7DQorDQorCWxzZGNfYm9fa3VubWFwKGxibyk7DQorfQ0KKw0KK2ludCBsc2RjX2Jv
X2V2aWN0X3ZyYW0oc3RydWN0IGRybV9kZXZpY2UgKmRkZXYpDQorew0KKwlzdHJ1Y3QgbHNkY19k
ZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3QgdHRtX2RldmljZSAqYmRldiA9
ICZsZGV2LT5iZGV2Ow0KKwlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbjsNCisNCisJ
bWFuID0gdHRtX21hbmFnZXJfdHlwZShiZGV2LCBUVE1fUExfVlJBTSk7DQorCWlmICh1bmxpa2Vs
eSghbWFuKSkNCisJCXJldHVybiAwOw0KKw0KKwlyZXR1cm4gdHRtX3Jlc291cmNlX21hbmFnZXJf
ZXZpY3RfYWxsKGJkZXYsIG1hbik7DQorfQ0KKw0KK3N0YXRpYyB2b2lkIGxzZGNfYm9fZGVzdHJv
eShzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibykNCit7DQorCXN0cnVjdCBsc2RjX2Rldmlj
ZSAqbGRldiA9IHRkZXZfdG9fbGRldih0Ym8tPmJkZXYpOw0KKwlzdHJ1Y3QgbHNkY19ibyAqbGJv
ID0gdG9fbHNkY19ibyh0Ym8pOw0KKw0KKwltdXRleF9sb2NrKCZsZGV2LT5nZW0ubXV0ZXgpOw0K
KwlsaXN0X2RlbF9pbml0KCZsYm8tPmxpc3QpOw0KKwltdXRleF91bmxvY2soJmxkZXYtPmdlbS5t
dXRleCk7DQorDQorCWRybV9nZW1fb2JqZWN0X3JlbGVhc2UoJnRiby0+YmFzZSk7DQorDQorCWtm
cmVlKGxibyk7DQorfQ0KKw0KK3N0cnVjdCBsc2RjX2JvICpsc2RjX2JvX2NyZWF0ZShzdHJ1Y3Qg
ZHJtX2RldmljZSAqZGRldiwNCisJCQkgICAgICAgdTMyIGRvbWFpbiwNCisJCQkgICAgICAgc2l6
ZV90IHNpemUsDQorCQkJICAgICAgIGJvb2wga2VybmVsLA0KKwkJCSAgICAgICBzdHJ1Y3Qgc2df
dGFibGUgKnNnLA0KKwkJCSAgICAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpDQorew0KKwlzdHJ1
Y3QgbHNkY19kZXZpY2UgKmxkZXYgPSB0b19sc2RjKGRkZXYpOw0KKwlzdHJ1Y3QgdHRtX2Rldmlj
ZSAqYmRldiA9ICZsZGV2LT5iZGV2Ow0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRibzsN
CisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisJZW51bSB0dG1fYm9fdHlwZSBib190eXBlOw0KKwlp
bnQgcmV0Ow0KKw0KKwlsYm8gPSBremFsbG9jKHNpemVvZigqbGJvKSwgR0ZQX0tFUk5FTCk7DQor
CWlmICghbGJvKQ0KKwkJcmV0dXJuIEVSUl9QVFIoLUVOT01FTSk7DQorDQorCUlOSVRfTElTVF9I
RUFEKCZsYm8tPmxpc3QpOw0KKw0KKwlsYm8tPmluaXRpYWxfZG9tYWluID0gZG9tYWluICYgKExT
RENfR0VNX0RPTUFJTl9WUkFNIHwNCisJCQkJCUxTRENfR0VNX0RPTUFJTl9HVFQgfA0KKwkJCQkJ
TFNEQ19HRU1fRE9NQUlOX1NZU1RFTSk7DQorDQorCXRibyA9ICZsYm8tPnRibzsNCisNCisJc2l6
ZSA9IEFMSUdOKHNpemUsIFBBR0VfU0laRSk7DQorDQorCXJldCA9IGRybV9nZW1fb2JqZWN0X2lu
aXQoZGRldiwgJnRiby0+YmFzZSwgc2l6ZSk7DQorCWlmIChyZXQpIHsNCisJCWtmcmVlKGxibyk7
DQorCQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KKwl9DQorDQorCXRiby0+YmRldiA9IGJkZXY7DQor
DQorCWlmIChrZXJuZWwpDQorCQlib190eXBlID0gdHRtX2JvX3R5cGVfa2VybmVsOw0KKwllbHNl
IGlmIChzZykNCisJCWJvX3R5cGUgPSB0dG1fYm9fdHlwZV9zZzsNCisJZWxzZQ0KKwkJYm9fdHlw
ZSA9IHR0bV9ib190eXBlX2RldmljZTsNCisNCisJbHNkY19ib19zZXRfcGxhY2VtZW50KGxibywg
ZG9tYWluKTsNCisJbGJvLT5zaXplID0gc2l6ZTsNCisNCisJcmV0ID0gdHRtX2JvX2luaXRfdmFs
aWRhdGUoYmRldiwNCisJCQkJICAgdGJvLA0KKwkJCQkgICBib190eXBlLA0KKwkJCQkgICAmbGJv
LT5wbGFjZW1lbnQsDQorCQkJCSAgIDAsDQorCQkJCSAgIGZhbHNlLA0KKwkJCQkgICBzZywNCisJ
CQkJICAgcmVzdiwNCisJCQkJICAgbHNkY19ib19kZXN0cm95KTsNCisJaWYgKHJldCkgew0KKwkJ
a2ZyZWUobGJvKTsNCisJCXJldHVybiBFUlJfUFRSKHJldCk7DQorCX0NCisNCisJcmV0dXJuIGxi
bzsNCit9DQorDQorc3RydWN0IGxzZGNfYm8gKmxzZGNfYm9fY3JlYXRlX2tlcm5lbF9waW5uZWQo
c3RydWN0IGRybV9kZXZpY2UgKmRkZXYsDQorCQkJCQkgICAgIHUzMiBkb21haW4sDQorCQkJCQkg
ICAgIHNpemVfdCBzaXplKQ0KK3sNCisJc3RydWN0IGxzZGNfYm8gKmxibzsNCisJaW50IHJldDsN
CisNCisJbGJvID0gbHNkY19ib19jcmVhdGUoZGRldiwgZG9tYWluLCBzaXplLCB0cnVlLCBOVUxM
LCBOVUxMKTsNCisNCisJcmV0ID0gbHNkY19ib19yZXNlcnZlKGxibyk7DQorCWlmICh1bmxpa2Vs
eShyZXQpKSB7DQorCQlsc2RjX2JvX3VucmVmKGxibyk7DQorCQlyZXR1cm4gRVJSX1BUUihyZXQp
Ow0KKwl9DQorDQorCXJldCA9IGxzZGNfYm9fcGluKGxibywgZG9tYWluLCBOVUxMKTsNCisJbHNk
Y19ib191bnJlc2VydmUobGJvKTsNCisJaWYgKHVubGlrZWx5KHJldCkpIHsNCisJCWxzZGNfYm9f
dW5yZWYobGJvKTsNCisJCXJldHVybiBFUlJfUFRSKHJldCk7DQorCX0NCisNCisJcmV0dXJuIGxi
bzsNCit9DQorDQordm9pZCBsc2RjX2JvX2ZyZWVfa2VybmVsX3Bpbm5lZChzdHJ1Y3QgbHNkY19i
byAqbGJvKQ0KK3sNCisJaW50IHJldDsNCisNCisJcmV0ID0gbHNkY19ib19yZXNlcnZlKGxibyk7
DQorCWlmICh1bmxpa2VseShyZXQpKQ0KKwkJcmV0dXJuOw0KKw0KKwlsc2RjX2JvX3VucGluKGxi
byk7DQorCWxzZGNfYm9fdW5yZXNlcnZlKGxibyk7DQorDQorCWxzZGNfYm9fdW5yZWYobGJvKTsN
Cit9DQorDQorc3RhdGljIHZvaWQgbHNkY190dG1fZmluaShzdHJ1Y3QgZHJtX2RldmljZSAqZGRl
diwgdm9pZCAqZGF0YSkNCit7DQorCXN0cnVjdCBsc2RjX2RldmljZSAqbGRldiA9IChzdHJ1Y3Qg
bHNkY19kZXZpY2UgKilkYXRhOw0KKw0KKwl0dG1fcmFuZ2VfbWFuX2ZpbmkoJmxkZXYtPmJkZXYs
IFRUTV9QTF9WUkFNKTsNCisJdHRtX3JhbmdlX21hbl9maW5pKCZsZGV2LT5iZGV2LCBUVE1fUExf
VFQpOw0KKw0KKwl0dG1fZGV2aWNlX2ZpbmkoJmxkZXYtPmJkZXYpOw0KKw0KKwlkcm1fZGJnKGRk
ZXYsICJ0dG0gZmluaXNoZWRcbiIpOw0KK30NCisNCitpbnQgbHNkY190dG1faW5pdChzdHJ1Y3Qg
bHNkY19kZXZpY2UgKmxkZXYpDQorew0KKwlzdHJ1Y3QgZHJtX2RldmljZSAqZGRldiA9ICZsZGV2
LT5iYXNlOw0KKwl1bnNpZ25lZCBsb25nIG51bV92cmFtX3BhZ2VzOw0KKwl1bnNpZ25lZCBsb25n
IG51bV9ndHRfcGFnZXM7DQorCWludCByZXQ7DQorDQorCXJldCA9IHR0bV9kZXZpY2VfaW5pdCgm
bGRldi0+YmRldiwNCisJCQkgICAgICAmbHNkY19ib19kcml2ZXIsDQorCQkJICAgICAgZGRldi0+
ZGV2LA0KKwkJCSAgICAgIGRkZXYtPmFub25faW5vZGUtPmlfbWFwcGluZywNCisJCQkgICAgICBk
ZGV2LT52bWFfb2Zmc2V0X21hbmFnZXIsDQorCQkJICAgICAgZmFsc2UsDQorCQkJICAgICAgZmFs
c2UpOw0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJbnVtX3ZyYW1fcGFnZXMgPSBs
ZGV2LT52cmFtX3NpemUgPj4gUEFHRV9TSElGVDsNCisNCisJcmV0ID0gdHRtX3JhbmdlX21hbl9p
bml0KCZsZGV2LT5iZGV2LA0KKwkJCQkgVFRNX1BMX1ZSQU0sDQorCQkJCSBmYWxzZSwNCisJCQkJ
IG51bV92cmFtX3BhZ2VzKTsNCisJaWYgKHVubGlrZWx5KHJldCkpDQorCQlyZXR1cm4gcmV0Ow0K
Kw0KKwlkcm1faW5mbyhkZGV2LCAiVlJBTTogJWx1IHBhZ2VzIHJlYWR5XG4iLCBudW1fdnJhbV9w
YWdlcyk7DQorDQorCS8qIDUxMk0gaXMgZmFyIGVub3VnaCBmb3IgdXMgbm93ICovDQorCWxkZXYt
Pmd0dF9zaXplID0gNTEyIDw8IDIwOw0KKw0KKwludW1fZ3R0X3BhZ2VzID0gbGRldi0+Z3R0X3Np
emUgPj4gUEFHRV9TSElGVDsNCisNCisJcmV0ID0gdHRtX3JhbmdlX21hbl9pbml0KCZsZGV2LT5i
ZGV2LA0KKwkJCQkgVFRNX1BMX1RULA0KKwkJCQkgdHJ1ZSwNCisJCQkJIG51bV9ndHRfcGFnZXMp
Ow0KKwlpZiAodW5saWtlbHkocmV0KSkNCisJCXJldHVybiByZXQ7DQorDQorCWRybV9pbmZvKGRk
ZXYsICJHVFQ6ICVsdSBwYWdlcyByZWFkeVxuIiwgbnVtX2d0dF9wYWdlcyk7DQorDQorCXJldHVy
biBkcm1tX2FkZF9hY3Rpb25fb3JfcmVzZXQoZGRldiwgbHNkY190dG1fZmluaSwgbGRldik7DQor
fQ0KKw0KK3ZvaWQgbHNkY190dG1fZGVidWdmc19pbml0KHN0cnVjdCBsc2RjX2RldmljZSAqbGRl
dikNCit7DQorCXN0cnVjdCB0dG1fZGV2aWNlICpiZGV2ID0gJmxkZXYtPmJkZXY7DQorCXN0cnVj
dCBkcm1fZGV2aWNlICpkZGV2ID0gJmxkZXYtPmJhc2U7DQorCXN0cnVjdCBkcm1fbWlub3IgKm1p
bm9yID0gZGRldi0+cHJpbWFyeTsNCisJc3RydWN0IGRlbnRyeSAqcm9vdCA9IG1pbm9yLT5kZWJ1
Z2ZzX3Jvb3Q7DQorCXN0cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqdnJhbV9tYW47DQorCXN0
cnVjdCB0dG1fcmVzb3VyY2VfbWFuYWdlciAqZ3R0X21hbjsNCisNCisJdnJhbV9tYW4gPSB0dG1f
bWFuYWdlcl90eXBlKGJkZXYsIFRUTV9QTF9WUkFNKTsNCisJZ3R0X21hbiA9IHR0bV9tYW5hZ2Vy
X3R5cGUoYmRldiwgVFRNX1BMX1RUKTsNCisNCisJdHRtX3Jlc291cmNlX21hbmFnZXJfY3JlYXRl
X2RlYnVnZnModnJhbV9tYW4sIHJvb3QsICJ2cmFtX21tIik7DQorCXR0bV9yZXNvdXJjZV9tYW5h
Z2VyX2NyZWF0ZV9kZWJ1Z2ZzKGd0dF9tYW4sIHJvb3QsICJndHRfbW0iKTsNCit9DQpkaWZmIC0t
Z2l0IGEvZHJpdmVycy9ncHUvZHJtL2xvb25nc29uL2xzZGNfdHRtLmggYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY190dG0uaA0KbmV3IGZpbGUgbW9kZSAxMDA2NDQNCmluZGV4IDAwMDAw
MDAwMDAwMC4uNmVmMzFkNzAyZGNhDQotLS0gL2Rldi9udWxsDQorKysgYi9kcml2ZXJzL2dwdS9k
cm0vbG9vbmdzb24vbHNkY190dG0uaA0KQEAgLTAsMCArMSw5OSBAQA0KKy8qIFNQRFgtTGljZW5z
ZS1JZGVudGlmaWVyOiBHUEwtMi4wICovDQorLyoNCisgKiBDb3B5cmlnaHQgKEMpIDIwMjMgTG9v
bmdzb24gVGVjaG5vbG9neSBDb3Jwb3JhdGlvbiBMaW1pdGVkDQorICovDQorDQorI2lmbmRlZiBf
X0xTRENfVFRNX0hfXw0KKyNkZWZpbmUgX19MU0RDX1RUTV9IX18NCisNCisjaW5jbHVkZSA8bGlu
dXgvY29udGFpbmVyX29mLmg+DQorI2luY2x1ZGUgPGxpbnV4L2lvc3lzLW1hcC5oPg0KKyNpbmNs
dWRlIDxsaW51eC9saXN0Lmg+DQorDQorI2luY2x1ZGUgPGRybS9kcm1fZ2VtLmg+DQorI2luY2x1
ZGUgPGRybS90dG0vdHRtX2JvLmg+DQorI2luY2x1ZGUgPGRybS90dG0vdHRtX3BsYWNlbWVudC5o
Pg0KKyNpbmNsdWRlIDxkcm0vdHRtL3R0bV9yYW5nZV9tYW5hZ2VyLmg+DQorI2luY2x1ZGUgPGRy
bS90dG0vdHRtX3R0Lmg+DQorDQorI2RlZmluZSBMU0RDX0dFTV9ET01BSU5fU1lTVEVNICAgICAg
ICAgIDB4MQ0KKyNkZWZpbmUgTFNEQ19HRU1fRE9NQUlOX0dUVCAgICAgICAgICAgICAweDINCisj
ZGVmaW5lIExTRENfR0VNX0RPTUFJTl9WUkFNICAgICAgICAgICAgMHg0DQorDQorc3RydWN0IGxz
ZGNfYm8gew0KKwlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgdGJvOw0KKw0KKwkvKiBQcm90ZWN0
ZWQgYnkgZ2VtLm11dGV4ICovDQorCXN0cnVjdCBsaXN0X2hlYWQgbGlzdDsNCisNCisJc3RydWN0
IGlvc3lzX21hcCBtYXA7DQorDQorCXVuc2lnbmVkIGludCB2bWFwX2NvdW50Ow0KKwkvKiBjcm9z
cyBkZXZpY2UgZHJpdmVyIHNoYXJpbmcgcmVmZXJlbmNlIGNvdW50ICovDQorCXVuc2lnbmVkIGlu
dCBzaGFyaW5nX2NvdW50Ow0KKw0KKwlzdHJ1Y3QgdHRtX2JvX2ttYXBfb2JqIGttYXA7DQorCXZv
aWQgKmtwdHI7DQorCWJvb2wgaXNfaW9tZW07DQorDQorCXNpemVfdCBzaXplOw0KKw0KKwl1MzIg
aW5pdGlhbF9kb21haW47DQorDQorCXN0cnVjdCB0dG1fcGxhY2VtZW50IHBsYWNlbWVudDsNCisJ
c3RydWN0IHR0bV9wbGFjZSBwbGFjZW1lbnRzWzRdOw0KK307DQorDQorc3RhdGljIGlubGluZSBz
dHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKnRvX3R0bV9ibyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
KmdlbSkNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoZ2VtLCBzdHJ1Y3QgdHRtX2J1ZmZlcl9v
YmplY3QsIGJhc2UpOw0KK30NCisNCitzdGF0aWMgaW5saW5lIHN0cnVjdCBsc2RjX2JvICp0b19s
c2RjX2JvKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqdGJvKQ0KK3sNCisJcmV0dXJuIGNvbnRh
aW5lcl9vZih0Ym8sIHN0cnVjdCBsc2RjX2JvLCB0Ym8pOw0KK30NCisNCitzdGF0aWMgaW5saW5l
IHN0cnVjdCBsc2RjX2JvICpnZW1fdG9fbHNkY19ibyhzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKmdl
bSkNCit7DQorCXJldHVybiBjb250YWluZXJfb2YoZ2VtLCBzdHJ1Y3QgbHNkY19ibywgdGJvLmJh
c2UpOw0KK30NCisNCitjb25zdCBjaGFyICpsc2RjX21lbV90eXBlX3RvX3N0cih1aW50MzJfdCBt
ZW1fdHlwZSk7DQorY29uc3QgY2hhciAqbHNkY19kb21haW5fdG9fc3RyKHUzMiBkb21haW4pOw0K
Kw0KK3N0cnVjdCBsc2RjX2JvICpsc2RjX2JvX2NyZWF0ZShzdHJ1Y3QgZHJtX2RldmljZSAqZGRl
diwNCisJCQkgICAgICAgdTMyIGRvbWFpbiwNCisJCQkgICAgICAgc2l6ZV90IHNpemUsDQorCQkJ
ICAgICAgIGJvb2wga2VybmVsLA0KKwkJCSAgICAgICBzdHJ1Y3Qgc2dfdGFibGUgKnNnLA0KKwkJ
CSAgICAgICBzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YpOw0KKw0KK3N0cnVjdCBsc2RjX2JvICpsc2Rj
X2JvX2NyZWF0ZV9rZXJuZWxfcGlubmVkKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2LA0KKwkJCQkJ
ICAgICB1MzIgZG9tYWluLA0KKwkJCQkJICAgICBzaXplX3Qgc2l6ZSk7DQorDQordm9pZCBsc2Rj
X2JvX2ZyZWVfa2VybmVsX3Bpbm5lZChzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCitpbnQgbHNk
Y19ib19yZXNlcnZlKHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3ZvaWQgbHNkY19ib191bnJlc2Vy
dmUoc3RydWN0IGxzZGNfYm8gKmxibyk7DQorDQoraW50IGxzZGNfYm9fcGluKHN0cnVjdCBsc2Rj
X2JvICpsYm8sIHUzMiBkb21haW4sIHU2NCAqZ3B1X2FkZHIpOw0KK3ZvaWQgbHNkY19ib191bnBp
bihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCit2b2lkIGxzZGNfYm9fcmVmKHN0cnVjdCBsc2Rj
X2JvICpsYm8pOw0KK3ZvaWQgbHNkY19ib191bnJlZihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisN
Cit1NjQgbHNkY19ib19ncHVfb2Zmc2V0KHN0cnVjdCBsc2RjX2JvICpsYm8pOw0KK3NpemVfdCBs
c2RjX2JvX3NpemUoc3RydWN0IGxzZGNfYm8gKmxibyk7DQorDQoraW50IGxzZGNfYm9fa21hcChz
dHJ1Y3QgbHNkY19ibyAqbGJvKTsNCit2b2lkIGxzZGNfYm9fa3VubWFwKHN0cnVjdCBsc2RjX2Jv
ICpsYm8pOw0KK3ZvaWQgbHNkY19ib19jbGVhcihzdHJ1Y3QgbHNkY19ibyAqbGJvKTsNCisNCitp
bnQgbHNkY19ib19ldmljdF92cmFtKHN0cnVjdCBkcm1fZGV2aWNlICpkZGV2KTsNCisNCitpbnQg
bHNkY190dG1faW5pdChzdHJ1Y3QgbHNkY19kZXZpY2UgKmxkZXYpOw0KK3ZvaWQgbHNkY190dG1f
ZGVidWdmc19pbml0KHN0cnVjdCBsc2RjX2RldmljZSAqbGRldik7DQorDQorI2VuZGlmDQotLSAN
CjIuMjUuMQ0KDQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdCAtLSBsaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFy
by5vcmcKVG8gdW5zdWJzY3JpYmUgc2VuZCBhbiBlbWFpbCB0byBsaW5hcm8tbW0tc2lnLWxlYXZl
QGxpc3RzLmxpbmFyby5vcmcK
