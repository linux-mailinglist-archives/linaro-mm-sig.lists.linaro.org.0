Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 8B62C648CA8
	for <lists+linaro-mm-sig@lfdr.de>; Sat, 10 Dec 2022 04:14:09 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 758453E98D
	for <lists+linaro-mm-sig@lfdr.de>; Sat, 10 Dec 2022 03:14:08 +0000 (UTC)
Received: from mail-yb1-f172.google.com (mail-yb1-f172.google.com [209.85.219.172])
	by lists.linaro.org (Postfix) with ESMTPS id EFFCC3E976
	for <linaro-mm-sig@lists.linaro.org>; Sat, 10 Dec 2022 03:13:59 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linaro.org header.s=google header.b=yfh1LyKt;
	spf=pass (lists.linaro.org: domain of sumit.semwal@linaro.org designates 209.85.219.172 as permitted sender) smtp.mailfrom=sumit.semwal@linaro.org;
	dmarc=pass (policy=none) header.from=linaro.org
Received: by mail-yb1-f172.google.com with SMTP id d128so7674135ybf.10
        for <linaro-mm-sig@lists.linaro.org>; Fri, 09 Dec 2022 19:13:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:from:to:cc:subject:date
         :message-id:reply-to;
        bh=puhhx/GU0T3NXLqqWXTCjhDEWYCFqFbhOu3JuJgDFA8=;
        b=yfh1LyKtfhDu64mVcwcXgiIaQ5MbnEOQVGQ2P9Cj+UoKmDlPiL+U86cXvF+Kj+DERs
         52Nfb7zFjBJ8fGsZ5HjU/pTZrxcPkOEUj4KVTG7wXh7cvAHqvb/YTuSQNOsLnawQiq3R
         Dq4nTskBAaD+NVI9aeMRpOBNKmO5bfztYo2CqeFEA9OgonaqZW14KZA7hZ08bLkA8ERs
         3YEVrmxIEX8D+6dyJhRY3GP83ZQYXUnNy6ULOrMtyozoi62kP6DeH2lDwyl89qdSo/Mm
         ll2boaxXbqG2Pdi2RVYt3vz0CD1BIaxH0TJkRCTdBqKmSoh065AnmsQGtWiSq6gopVZw
         XR4w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=puhhx/GU0T3NXLqqWXTCjhDEWYCFqFbhOu3JuJgDFA8=;
        b=GtSZARFXFuovWmXfijcQhQ6Xhpgl4aucWfh3iYoVa8M1VjLKSr6XhlcRi4KA72ge14
         xPrNm8bWx1sDwQ6soMdT2LKxfDauEh3qsGxk+XkduruQgCRbBfuQtmBwcIZF1F6DIfCF
         UZWI2Y7iacGHeiuR8yp34Wv69vqZ/Tvr0p5VoTxItNC6r2X4CGxLAeGbWz7pOli5ar9R
         hNXBgLamYE8ZZgiuwO9ZHIADBvoYGg0AihfUD+7dlxgn0oMtKLH1nwFGqemPELJZmoy5
         bVjsUG2sNjdG4x6mEtYJFJAthz9nRNQTebHme/zHQbxXmYRcxEmLTrP5EUMEpbB1q3E3
         K8BQ==
X-Gm-Message-State: ANoB5pm4IGR+mIsWk8jrIvpjebCKhAsOCwHbLLdxqTHk3XTZag6JG7pc
	y4yraPdX8C/VGz+XIkkqLGKy2rgy7CRNnQOCeeU/7mR7
X-Google-Smtp-Source: AA0mqf5srgU9qKqc2DjPmJLutxXhtzqQBJLJ83A+5w7VvMQf5WZLojIw7E4CzRwyVZDbkaNev92+yPrLGU9eVzr2f+k=
X-Received: by 2002:a25:7709:0:b0:6fb:13c5:d33f with SMTP id
 s9-20020a257709000000b006fb13c5d33fmr34469086ybc.157.1670642039332; Fri, 09
 Dec 2022 19:13:59 -0800 (PST)
MIME-Version: 1.0
References: <20221209071535.933698-1-christian.koenig@amd.com>
In-Reply-To: <20221209071535.933698-1-christian.koenig@amd.com>
From: Sumit Semwal <sumit.semwal@linaro.org>
Date: Sat, 10 Dec 2022 08:43:47 +0530
Message-ID: <CAO_48GEQmsiJ96iu16UKg-QWJDNK=y-QTcDOKTMc3CMt+S993g@mail.gmail.com>
To: =?UTF-8?Q?Christian_K=C3=B6nig?= <ckoenig.leichtzumerken@gmail.com>
X-Rspamd-Queue-Id: EFFCC3E976
X-Spamd-Bar: --
X-Spamd-Result: default: False [-2.50 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	DMARC_POLICY_ALLOW(-0.50)[linaro.org,none];
	R_SPF_ALLOW(-0.20)[+ip4:209.85.128.0/17];
	R_DKIM_ALLOW(-0.20)[linaro.org:s=google];
	MIME_GOOD(-0.10)[text/plain];
	FREEMAIL_TO(0.00)[gmail.com];
	FROM_EQ_ENVFROM(0.00)[];
	ARC_NA(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	ASN(0.00)[asn:15169, ipnet:209.85.128.0/17, country:US];
	MIME_TRACE(0.00)[0:+];
	RCVD_COUNT_TWO(0.00)[2];
	NEURAL_HAM(-0.00)[-1.000];
	DKIM_TRACE(0.00)[linaro.org:+];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	TO_DN_SOME(0.00)[];
	FROM_HAS_DN(0.00)[];
	DBL_BLOCKED_OPENRESOLVER(0.00)[linaro.org:url,linaro.org:email,linaro.org:dkim];
	TAGGED_RCPT(0.00)[];
	RCPT_COUNT_FIVE(0.00)[6];
	PREVIOUSLY_DELIVERED(0.00)[linaro-mm-sig@lists.linaro.org];
	RWL_MAILSPIKE_POSSIBLE(0.00)[209.85.219.172:from]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
Message-ID-Hash: AD2JG6H3HLKML7ETOYOMP435IEZRH5JK
X-Message-ID-Hash: AD2JG6H3HLKML7ETOYOMP435IEZRH5JK
X-MailFrom: sumit.semwal@linaro.org
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: quic_charante@quicinc.com, cuigaosheng1@huawei.com, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] Re: [PATCH] dma-buf: fix dma_buf_export init order v2
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/AD2JG6H3HLKML7ETOYOMP435IEZRH5JK/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

SGkgQ2hyaXN0aWFuLA0KDQpPbiBGcmksIDkgRGVjIDIwMjIgYXQgMTI6NDUsIENocmlzdGlhbiBL
w7ZuaWcNCjxja29lbmlnLmxlaWNodHp1bWVya2VuQGdtYWlsLmNvbT4gd3JvdGU6DQo+DQo+IFRo
ZSBpbml0IG9yZGVyIGFuZCByZXN1bHRpbmcgZXJyb3IgaGFuZGxpbmcgaW4gZG1hX2J1Zl9leHBv
cnQNCj4gd2FzIHByZXR0eSBtZXNzeS4NCj4NCj4gU3Vib3JkaW5hdGUgb2JqZWN0cyBsaWtlIHRo
ZSBmaWxlIGFuZCB0aGUgc3lzZnMga2VybmVsIG9iamVjdHMNCj4gd2VyZSBpbml0aWFsaXppbmcg
YW5kIHdpcmluZyBpdHNlbGYgdXAgd2l0aCB0aGUgb2JqZWN0IGluIHRoZQ0KPiB3cm9uZyBvcmRl
ciByZXN1bHRpbmcgbm90IG9ubHkgaW4gY29tcGxpY2F0aW5nIGFuZCBwYXJ0aWFsbHkNCj4gaW5j
b3JyZWN0IGVycm9yIGhhbmRsaW5nLCBidXQgYWxzbyBpbiBwdWJsaXNoaW5nIG9ubHkgaGFsdmUN
Cj4gaW5pdGlhbGl6ZWQgRE1BLWJ1ZiBvYmplY3RzLg0KPg0KPiBDbGVhbiB0aGlzIHVwIHRob3Vn
aHRmdWxseSBieSBhbGxvY2F0aW5nIHRoZSBmaWxlIGluZGVwZW5kZW50DQo+IG9mIHRoZSBETUEt
YnVmIG9iamVjdC4gVGhlbiBhbGxvY2F0ZSBhbmQgaW5pdGlhbGl6ZSB0aGUgRE1BLWJ1Zg0KPiBv
YmplY3QgaXRzZWxmLCBiZWZvcmUgcHVibGlzaGluZyBpdCB0aHJvdWdoIHN5c2ZzLiBJZiBldmVy
eXRoaW5nDQo+IHdvcmtzIGFzIGV4cGVjdGVkIHRoZSBmaWxlIGlzIHRoZW4gY29ubmVjdGVkIHdp
dGggdGhlIERNQS1idWYNCj4gb2JqZWN0IGFuZCBwdWJsaXNoIGl0IHRocm91Z2ggZGVidWdmcy4N
Cj4NCj4gQWxzbyBhZGRzIHRoZSBtaXNzaW5nIGRtYV9yZXN2X2ZpbmkoKSBpbnRvIHRoZSBlcnJv
ciBoYW5kbGluZy4NCj4NCj4gdjI6IGFkZCBzb21lIG1pc3NpbmcgY2hhbmdlcyB0byBkbWFfYnVn
X2dldGZpbGUoKSBhbmQgYSBtaXNzaW5nIE5VTEwNCj4gICAgIGNoZWNrIGluIGRtYV9idWZfZmls
ZV9yZWxlYXNlKCkNCj4NCj4gU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0
aWFuLmtvZW5pZ0BhbWQuY29tPg0KDQpUaGFuayB5b3UgZm9yIHRoaXMgbmljZSBjbGVhbnVwLg0K
QWNrZWQtYnk6IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+DQoNCkJlc3Qs
DQpTdW1pdC4NCj4gLS0tDQo+ICBkcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi1zeXNmcy1zdGF0cy5j
IHwgIDcgKy0tDQo+ICBkcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi1zeXNmcy1zdGF0cy5oIHwgIDQg
Ky0NCj4gIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMgICAgICAgICAgICAgfCA4NCArKysrKysr
KysrKysrLS0tLS0tLS0tLS0tLS0NCj4gIDMgZmlsZXMgY2hhbmdlZCwgNDMgaW5zZXJ0aW9ucygr
KSwgNTIgZGVsZXRpb25zKC0pDQo+DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1h
LWJ1Zi1zeXNmcy1zdGF0cy5jIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYtc3lzZnMtc3RhdHMu
Yw0KPiBpbmRleCAyYmJhMGJhYmNiNjIuLjRiNjgwZTEwYzE1YSAxMDA2NDQNCj4gLS0tIGEvZHJp
dmVycy9kbWEtYnVmL2RtYS1idWYtc3lzZnMtc3RhdHMuYw0KPiArKysgYi9kcml2ZXJzL2RtYS1i
dWYvZG1hLWJ1Zi1zeXNmcy1zdGF0cy5jDQo+IEBAIC0xNjgsMTQgKzE2OCwxMSBAQCB2b2lkIGRt
YV9idWZfdW5pbml0X3N5c2ZzX3N0YXRpc3RpY3Modm9pZCkNCj4gICAgICAgICBrc2V0X3VucmVn
aXN0ZXIoZG1hX2J1Zl9zdGF0c19rc2V0KTsNCj4gIH0NCj4NCj4gLWludCBkbWFfYnVmX3N0YXRz
X3NldHVwKHN0cnVjdCBkbWFfYnVmICpkbWFidWYpDQo+ICtpbnQgZG1hX2J1Zl9zdGF0c19zZXR1
cChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgZmlsZSAqZmlsZSkNCj4gIHsNCj4gICAg
ICAgICBzdHJ1Y3QgZG1hX2J1Zl9zeXNmc19lbnRyeSAqc3lzZnNfZW50cnk7DQo+ICAgICAgICAg
aW50IHJldDsNCj4NCj4gLSAgICAgICBpZiAoIWRtYWJ1ZiB8fCAhZG1hYnVmLT5maWxlKQ0KPiAt
ICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+IC0NCj4gICAgICAgICBpZiAoIWRtYWJ1
Zi0+ZXhwX25hbWUpIHsNCj4gICAgICAgICAgICAgICAgIHByX2VycigiZXhwb3J0ZXIgbmFtZSBt
dXN0IG5vdCBiZSBlbXB0eSBpZiBzdGF0cyBuZWVkZWRcbiIpOw0KPiAgICAgICAgICAgICAgICAg
cmV0dXJuIC1FSU5WQUw7DQo+IEBAIC0xOTIsNyArMTg5LDcgQEAgaW50IGRtYV9idWZfc3RhdHNf
c2V0dXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1ZikNCj4NCj4gICAgICAgICAvKiBjcmVhdGUgdGhl
IGRpcmVjdG9yeSBmb3IgYnVmZmVyIHN0YXRzICovDQo+ICAgICAgICAgcmV0ID0ga29iamVjdF9p
bml0X2FuZF9hZGQoJnN5c2ZzX2VudHJ5LT5rb2JqLCAmZG1hX2J1Zl9rdHlwZSwgTlVMTCwNCj4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiJWx1IiwgZmlsZV9pbm9kZShkbWFi
dWYtPmZpbGUpLT5pX2lubyk7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IiVsdSIsIGZpbGVfaW5vZGUoZmlsZSktPmlfaW5vKTsNCj4gICAgICAgICBpZiAocmV0KQ0KPiAg
ICAgICAgICAgICAgICAgZ290byBlcnJfc3lzZnNfZG1hYnVmOw0KPg0KPiBkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9kbWEtYnVmL2RtYS1idWYtc3lzZnMtc3RhdHMuaCBiL2RyaXZlcnMvZG1hLWJ1Zi9k
bWEtYnVmLXN5c2ZzLXN0YXRzLmgNCj4gaW5kZXggYTQ5YzZlMjY1MGNjLi43YThhOTk1Yjc1YmEg
MTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLXN5c2ZzLXN0YXRzLmgNCj4g
KysrIGIvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYtc3lzZnMtc3RhdHMuaA0KPiBAQCAtMTMsNyAr
MTMsNyBAQA0KPiAgaW50IGRtYV9idWZfaW5pdF9zeXNmc19zdGF0aXN0aWNzKHZvaWQpOw0KPiAg
dm9pZCBkbWFfYnVmX3VuaW5pdF9zeXNmc19zdGF0aXN0aWNzKHZvaWQpOw0KPg0KPiAtaW50IGRt
YV9idWZfc3RhdHNfc2V0dXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1Zik7DQo+ICtpbnQgZG1hX2J1
Zl9zdGF0c19zZXR1cChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgZmlsZSAqZmlsZSk7
DQo+DQo+ICB2b2lkIGRtYV9idWZfc3RhdHNfdGVhcmRvd24oc3RydWN0IGRtYV9idWYgKmRtYWJ1
Zik7DQo+ICAjZWxzZQ0KPiBAQCAtMjUsNyArMjUsNyBAQCBzdGF0aWMgaW5saW5lIGludCBkbWFf
YnVmX2luaXRfc3lzZnNfc3RhdGlzdGljcyh2b2lkKQ0KPg0KPiAgc3RhdGljIGlubGluZSB2b2lk
IGRtYV9idWZfdW5pbml0X3N5c2ZzX3N0YXRpc3RpY3Modm9pZCkge30NCj4NCj4gLXN0YXRpYyBp
bmxpbmUgaW50IGRtYV9idWZfc3RhdHNfc2V0dXAoc3RydWN0IGRtYV9idWYgKmRtYWJ1ZikNCj4g
K3N0YXRpYyBpbmxpbmUgaW50IGRtYV9idWZfc3RhdHNfc2V0dXAoc3RydWN0IGRtYV9idWYgKmRt
YWJ1Ziwgc3RydWN0IGZpbGUgKmZpbGUpDQo+ICB7DQo+ICAgICAgICAgcmV0dXJuIDA7DQo+ICB9
DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jIGIvZHJpdmVycy9kbWEt
YnVmL2RtYS1idWYuYw0KPiBpbmRleCBlNmYzNmMwMTRjNGMuLmViNmI1OTM2M2M0ZiAxMDA2NDQN
Cj4gLS0tIGEvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYw0KPiArKysgYi9kcml2ZXJzL2RtYS1i
dWYvZG1hLWJ1Zi5jDQo+IEBAIC05NSwxMCArOTUsMTEgQEAgc3RhdGljIGludCBkbWFfYnVmX2Zp
bGVfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2RlLCBzdHJ1Y3QgZmlsZSAqZmlsZSkNCj4gICAg
ICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPg0KPiAgICAgICAgIGRtYWJ1ZiA9IGZpbGUt
PnByaXZhdGVfZGF0YTsNCj4gLQ0KPiAtICAgICAgIG11dGV4X2xvY2soJmRiX2xpc3QubG9jayk7
DQo+IC0gICAgICAgbGlzdF9kZWwoJmRtYWJ1Zi0+bGlzdF9ub2RlKTsNCj4gLSAgICAgICBtdXRl
eF91bmxvY2soJmRiX2xpc3QubG9jayk7DQo+ICsgICAgICAgaWYgKGRtYWJ1Zikgew0KPiArICAg
ICAgICAgICAgICAgbXV0ZXhfbG9jaygmZGJfbGlzdC5sb2NrKTsNCj4gKyAgICAgICAgICAgICAg
IGxpc3RfZGVsKCZkbWFidWYtPmxpc3Rfbm9kZSk7DQo+ICsgICAgICAgICAgICAgICBtdXRleF91
bmxvY2soJmRiX2xpc3QubG9jayk7DQo+ICsgICAgICAgfQ0KPg0KPiAgICAgICAgIHJldHVybiAw
Ow0KPiAgfQ0KPiBAQCAtNTIzLDE3ICs1MjQsMTcgQEAgc3RhdGljIGlubGluZSBpbnQgaXNfZG1h
X2J1Zl9maWxlKHN0cnVjdCBmaWxlICpmaWxlKQ0KPiAgICAgICAgIHJldHVybiBmaWxlLT5mX29w
ID09ICZkbWFfYnVmX2ZvcHM7DQo+ICB9DQo+DQo+IC1zdGF0aWMgc3RydWN0IGZpbGUgKmRtYV9i
dWZfZ2V0ZmlsZShzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBpbnQgZmxhZ3MpDQo+ICtzdGF0aWMg
c3RydWN0IGZpbGUgKmRtYV9idWZfZ2V0ZmlsZShzaXplX3Qgc2l6ZSwgaW50IGZsYWdzKQ0KPiAg
ew0KPiAgICAgICAgIHN0YXRpYyBhdG9taWM2NF90IGRtYWJ1Zl9pbm9kZSA9IEFUT01JQzY0X0lO
SVQoMCk7DQo+IC0gICAgICAgc3RydWN0IGZpbGUgKmZpbGU7DQo+ICAgICAgICAgc3RydWN0IGlu
b2RlICppbm9kZSA9IGFsbG9jX2Fub25faW5vZGUoZG1hX2J1Zl9tbnQtPm1udF9zYik7DQo+ICsg
ICAgICAgc3RydWN0IGZpbGUgKmZpbGU7DQo+DQo+ICAgICAgICAgaWYgKElTX0VSUihpbm9kZSkp
DQo+ICAgICAgICAgICAgICAgICByZXR1cm4gRVJSX0NBU1QoaW5vZGUpOw0KPg0KPiAtICAgICAg
IGlub2RlLT5pX3NpemUgPSBkbWFidWYtPnNpemU7DQo+IC0gICAgICAgaW5vZGVfc2V0X2J5dGVz
KGlub2RlLCBkbWFidWYtPnNpemUpOw0KPiArICAgICAgIGlub2RlLT5pX3NpemUgPSBzaXplOw0K
PiArICAgICAgIGlub2RlX3NldF9ieXRlcyhpbm9kZSwgc2l6ZSk7DQo+DQo+ICAgICAgICAgLyoN
Cj4gICAgICAgICAgKiBUaGUgLT5pX2lubyBhY3F1aXJlZCBmcm9tIGdldF9uZXh0X2lubygpIGlz
IG5vdCB1bmlxdWUgdGh1cw0KPiBAQCAtNTQ3LDggKzU0OCw2IEBAIHN0YXRpYyBzdHJ1Y3QgZmls
ZSAqZG1hX2J1Zl9nZXRmaWxlKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIGludCBmbGFncykNCj4g
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ3MsICZkbWFfYnVmX2ZvcHMpOw0K
PiAgICAgICAgIGlmIChJU19FUlIoZmlsZSkpDQo+ICAgICAgICAgICAgICAgICBnb3RvIGVycl9h
bGxvY19maWxlOw0KPiAtICAgICAgIGZpbGUtPnByaXZhdGVfZGF0YSA9IGRtYWJ1ZjsNCj4gLSAg
ICAgICBmaWxlLT5mX3BhdGguZGVudHJ5LT5kX2ZzZGF0YSA9IGRtYWJ1ZjsNCj4NCj4gICAgICAg
ICByZXR1cm4gZmlsZTsNCj4NCj4gQEAgLTYxNCwxOSArNjEzLDExIEBAIHN0cnVjdCBkbWFfYnVm
ICpkbWFfYnVmX2V4cG9ydChjb25zdCBzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwX2lu
Zm8pDQo+ICAgICAgICAgc2l6ZV90IGFsbG9jX3NpemUgPSBzaXplb2Yoc3RydWN0IGRtYV9idWYp
Ow0KPiAgICAgICAgIGludCByZXQ7DQo+DQo+IC0gICAgICAgaWYgKCFleHBfaW5mby0+cmVzdikN
Cj4gLSAgICAgICAgICAgICAgIGFsbG9jX3NpemUgKz0gc2l6ZW9mKHN0cnVjdCBkbWFfcmVzdik7
DQo+IC0gICAgICAgZWxzZQ0KPiAtICAgICAgICAgICAgICAgLyogcHJldmVudCAmZG1hX2J1Zlsx
XSA9PSBkbWFfYnVmLT5yZXN2ICovDQo+IC0gICAgICAgICAgICAgICBhbGxvY19zaXplICs9IDE7
DQo+IC0NCj4gLSAgICAgICBpZiAoV0FSTl9PTighZXhwX2luZm8tPnByaXYNCj4gLSAgICAgICAg
ICAgICAgICAgICAgICAgICB8fCAhZXhwX2luZm8tPm9wcw0KPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgIHx8ICFleHBfaW5mby0+b3BzLT5tYXBfZG1hX2J1Zg0KPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgIHx8ICFleHBfaW5mby0+b3BzLT51bm1hcF9kbWFfYnVmDQo+IC0gICAgICAgICAg
ICAgICAgICAgICAgICAgfHwgIWV4cF9pbmZvLT5vcHMtPnJlbGVhc2UpKSB7DQo+ICsgICAgICAg
aWYgKFdBUk5fT04oIWV4cF9pbmZvLT5wcml2IHx8ICFleHBfaW5mby0+b3BzDQo+ICsgICAgICAg
ICAgICAgICAgICAgfHwgIWV4cF9pbmZvLT5vcHMtPm1hcF9kbWFfYnVmDQo+ICsgICAgICAgICAg
ICAgICAgICAgfHwgIWV4cF9pbmZvLT5vcHMtPnVubWFwX2RtYV9idWYNCj4gKyAgICAgICAgICAg
ICAgICAgICB8fCAhZXhwX2luZm8tPm9wcy0+cmVsZWFzZSkpDQo+ICAgICAgICAgICAgICAgICBy
ZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsNCj4gLSAgICAgICB9DQo+DQo+ICAgICAgICAgaWYgKFdB
Uk5fT04oZXhwX2luZm8tPm9wcy0+Y2FjaGVfc2d0X21hcHBpbmcgJiYNCj4gICAgICAgICAgICAg
ICAgICAgICAoZXhwX2luZm8tPm9wcy0+cGluIHx8IGV4cF9pbmZvLT5vcHMtPnVucGluKSkpDQo+
IEBAIC02MzgsMTAgKzYyOSwyMSBAQCBzdHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1Zl9leHBvcnQoY29u
c3Qgc3RydWN0IGRtYV9idWZfZXhwb3J0X2luZm8gKmV4cF9pbmZvKQ0KPiAgICAgICAgIGlmICgh
dHJ5X21vZHVsZV9nZXQoZXhwX2luZm8tPm93bmVyKSkNCj4gICAgICAgICAgICAgICAgIHJldHVy
biBFUlJfUFRSKC1FTk9FTlQpOw0KPg0KPiArICAgICAgIGZpbGUgPSBkbWFfYnVmX2dldGZpbGUo
ZXhwX2luZm8tPnNpemUsIGV4cF9pbmZvLT5mbGFncyk7DQo+ICsgICAgICAgaWYgKElTX0VSUihm
aWxlKSkgew0KPiArICAgICAgICAgICAgICAgcmV0ID0gUFRSX0VSUihmaWxlKTsNCj4gKyAgICAg
ICAgICAgICAgIGdvdG8gZXJyX21vZHVsZTsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBp
ZiAoIWV4cF9pbmZvLT5yZXN2KQ0KPiArICAgICAgICAgICAgICAgYWxsb2Nfc2l6ZSArPSBzaXpl
b2Yoc3RydWN0IGRtYV9yZXN2KTsNCj4gKyAgICAgICBlbHNlDQo+ICsgICAgICAgICAgICAgICAv
KiBwcmV2ZW50ICZkbWFfYnVmWzFdID09IGRtYV9idWYtPnJlc3YgKi8NCj4gKyAgICAgICAgICAg
ICAgIGFsbG9jX3NpemUgKz0gMTsNCj4gICAgICAgICBkbWFidWYgPSBremFsbG9jKGFsbG9jX3Np
emUsIEdGUF9LRVJORUwpOw0KPiAgICAgICAgIGlmICghZG1hYnVmKSB7DQo+ICAgICAgICAgICAg
ICAgICByZXQgPSAtRU5PTUVNOw0KPiAtICAgICAgICAgICAgICAgZ290byBlcnJfbW9kdWxlOw0K
PiArICAgICAgICAgICAgICAgZ290byBlcnJfZmlsZTsNCj4gICAgICAgICB9DQo+DQo+ICAgICAg
ICAgZG1hYnVmLT5wcml2ID0gZXhwX2luZm8tPnByaXY7DQo+IEBAIC02NTMsNDQgKzY1NSwzNiBA
QCBzdHJ1Y3QgZG1hX2J1ZiAqZG1hX2J1Zl9leHBvcnQoY29uc3Qgc3RydWN0IGRtYV9idWZfZXhw
b3J0X2luZm8gKmV4cF9pbmZvKQ0KPiAgICAgICAgIGluaXRfd2FpdHF1ZXVlX2hlYWQoJmRtYWJ1
Zi0+cG9sbCk7DQo+ICAgICAgICAgZG1hYnVmLT5jYl9pbi5wb2xsID0gZG1hYnVmLT5jYl9vdXQu
cG9sbCA9ICZkbWFidWYtPnBvbGw7DQo+ICAgICAgICAgZG1hYnVmLT5jYl9pbi5hY3RpdmUgPSBk
bWFidWYtPmNiX291dC5hY3RpdmUgPSAwOw0KPiArICAgICAgIG11dGV4X2luaXQoJmRtYWJ1Zi0+
bG9jayk7DQo+ICsgICAgICAgSU5JVF9MSVNUX0hFQUQoJmRtYWJ1Zi0+YXR0YWNobWVudHMpOw0K
Pg0KPiAgICAgICAgIGlmICghcmVzdikgew0KPiAtICAgICAgICAgICAgICAgcmVzdiA9IChzdHJ1
Y3QgZG1hX3Jlc3YgKikmZG1hYnVmWzFdOw0KPiAtICAgICAgICAgICAgICAgZG1hX3Jlc3ZfaW5p
dChyZXN2KTsNCj4gKyAgICAgICAgICAgICAgIGRtYWJ1Zi0+cmVzdiA9IChzdHJ1Y3QgZG1hX3Jl
c3YgKikmZG1hYnVmWzFdOw0KPiArICAgICAgICAgICAgICAgZG1hX3Jlc3ZfaW5pdChkbWFidWYt
PnJlc3YpOw0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAgICBkbWFidWYtPnJl
c3YgPSByZXN2Ow0KPiAgICAgICAgIH0NCj4gLSAgICAgICBkbWFidWYtPnJlc3YgPSByZXN2Ow0K
Pg0KPiAtICAgICAgIGZpbGUgPSBkbWFfYnVmX2dldGZpbGUoZG1hYnVmLCBleHBfaW5mby0+Zmxh
Z3MpOw0KPiAtICAgICAgIGlmIChJU19FUlIoZmlsZSkpIHsNCj4gLSAgICAgICAgICAgICAgIHJl
dCA9IFBUUl9FUlIoZmlsZSk7DQo+ICsgICAgICAgcmV0ID0gZG1hX2J1Zl9zdGF0c19zZXR1cChk
bWFidWYsIGZpbGUpOw0KPiArICAgICAgIGlmIChyZXQpDQo+ICAgICAgICAgICAgICAgICBnb3Rv
IGVycl9kbWFidWY7DQo+IC0gICAgICAgfQ0KPg0KPiArICAgICAgIGZpbGUtPnByaXZhdGVfZGF0
YSA9IGRtYWJ1ZjsNCj4gKyAgICAgICBmaWxlLT5mX3BhdGguZGVudHJ5LT5kX2ZzZGF0YSA9IGRt
YWJ1ZjsNCj4gICAgICAgICBkbWFidWYtPmZpbGUgPSBmaWxlOw0KPg0KPiAtICAgICAgIG11dGV4
X2luaXQoJmRtYWJ1Zi0+bG9jayk7DQo+IC0gICAgICAgSU5JVF9MSVNUX0hFQUQoJmRtYWJ1Zi0+
YXR0YWNobWVudHMpOw0KPiAtDQo+ICAgICAgICAgbXV0ZXhfbG9jaygmZGJfbGlzdC5sb2NrKTsN
Cj4gICAgICAgICBsaXN0X2FkZCgmZG1hYnVmLT5saXN0X25vZGUsICZkYl9saXN0LmhlYWQpOw0K
PiAgICAgICAgIG11dGV4X3VubG9jaygmZGJfbGlzdC5sb2NrKTsNCj4NCj4gLSAgICAgICByZXQg
PSBkbWFfYnVmX3N0YXRzX3NldHVwKGRtYWJ1Zik7DQo+IC0gICAgICAgaWYgKHJldCkNCj4gLSAg
ICAgICAgICAgICAgIGdvdG8gZXJyX3N5c2ZzOw0KPiAtDQo+ICAgICAgICAgcmV0dXJuIGRtYWJ1
ZjsNCj4NCj4gLWVycl9zeXNmczoNCj4gLSAgICAgICAvKg0KPiAtICAgICAgICAqIFNldCBmaWxl
LT5mX3BhdGguZGVudHJ5LT5kX2ZzZGF0YSB0byBOVUxMIHNvIHRoYXQgd2hlbg0KPiAtICAgICAg
ICAqIGRtYV9idWZfcmVsZWFzZSgpIGdldHMgaW52b2tlZCBieSBkZW50cnlfb3BzLCBpdCBleGl0
cw0KPiAtICAgICAgICAqIGVhcmx5IGJlZm9yZSBjYWxsaW5nIHRoZSByZWxlYXNlKCkgZG1hX2J1
ZiBvcC4NCj4gLSAgICAgICAgKi8NCj4gLSAgICAgICBmaWxlLT5mX3BhdGguZGVudHJ5LT5kX2Zz
ZGF0YSA9IE5VTEw7DQo+IC0gICAgICAgZnB1dChmaWxlKTsNCj4gIGVycl9kbWFidWY6DQo+ICsg
ICAgICAgaWYgKCFyZXN2KQ0KPiArICAgICAgICAgICAgICAgZG1hX3Jlc3ZfZmluaShkbWFidWYt
PnJlc3YpOw0KPiAgICAgICAgIGtmcmVlKGRtYWJ1Zik7DQo+ICtlcnJfZmlsZToNCj4gKyAgICAg
ICBmcHV0KGZpbGUpOw0KPiAgZXJyX21vZHVsZToNCj4gICAgICAgICBtb2R1bGVfcHV0KGV4cF9p
bmZvLT5vd25lcik7DQo+ICAgICAgICAgcmV0dXJuIEVSUl9QVFIocmV0KTsNCj4gLS0NCj4gMi4z
NC4xDQo+DQoNCg0KLS0gDQpUaGFua3MgYW5kIHJlZ2FyZHMsDQoNClN1bWl0IFNlbXdhbCAoaGUg
LyBoaW0pDQpUZWNoIExlYWQgLSBMQ0csIFZlcnRpY2FsIFRlY2hub2xvZ2llcw0KTGluYXJvLm9y
ZyDilIIgT3BlbiBzb3VyY2Ugc29mdHdhcmUgZm9yIEFSTSBTb0NzDQpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlz
dCAtLSBsaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKVG8gdW5zdWJzY3JpYmUgc2VuZCBh
biBlbWFpbCB0byBsaW5hcm8tbW0tc2lnLWxlYXZlQGxpc3RzLmxpbmFyby5vcmcK
