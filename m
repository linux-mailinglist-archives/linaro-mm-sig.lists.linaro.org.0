Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id B2B388424D4
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 30 Jan 2024 13:24:52 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id C35F5400A2
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 30 Jan 2024 12:24:51 +0000 (UTC)
Received: from aposti.net (aposti.net [89.234.176.197])
	by lists.linaro.org (Postfix) with ESMTPS id DBBED400E6
	for <linaro-mm-sig@lists.linaro.org>; Tue, 30 Jan 2024 12:24:06 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=crapouillou.net header.s=mail header.b="bc/PbOTB";
	dmarc=pass (policy=none) header.from=crapouillou.net;
	spf=pass (lists.linaro.org: domain of paul@crapouillou.net designates 89.234.176.197 as permitted sender) smtp.mailfrom=paul@crapouillou.net
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=crapouillou.net;
	s=mail; t=1706617429;
	h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
	 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding:
	 in-reply-to:in-reply-to:references:references;
	bh=F0IWTO5GhOhb6A40qFrrArST21ZkQRJyFVCmrexpwLA=;
	b=bc/PbOTBeNd1aAV7/kAEpPInvM5w73re093TBuOfPyZtp63hWr5u0xmRct3IUPj39otuXZ
	1cuEw4PUWu6ND4eEO95KxabbE1KPjDp7xlMA6fFGd4qkh1yY/Zo/DQUe4K5iGhHielCmSC
	68zPc7BlT6yvkTelG/UfR37DWsgBvUQ=
From: Paul Cercueil <paul@crapouillou.net>
To: Greg Kroah-Hartman <gregkh@linuxfoundation.org>,
	Jonathan Corbet <corbet@lwn.net>,
	Sumit Semwal <sumit.semwal@linaro.org>,
	=?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
Date: Tue, 30 Jan 2024 13:23:39 +0100
Message-ID: <20240130122340.54813-4-paul@crapouillou.net>
In-Reply-To: <20240130122340.54813-1-paul@crapouillou.net>
References: <20240130122340.54813-1-paul@crapouillou.net>
MIME-Version: 1.0
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: DBBED400E6
X-Spamd-Bar: -----
X-Spamd-Result: default: False [-5.50 / 15.00];
	REPLY(-4.00)[];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	MID_CONTAINS_FROM(1.00)[];
	DMARC_POLICY_ALLOW(-0.50)[crapouillou.net,none];
	R_DKIM_ALLOW(-0.20)[crapouillou.net:s=mail];
	R_SPF_ALLOW(-0.20)[+a:c];
	MIME_GOOD(-0.10)[text/plain];
	ARC_NA(0.00)[];
	ASN(0.00)[asn:203432, ipnet:89.234.176.0/23, country:FR];
	MIME_TRACE(0.00)[0:+];
	MISSING_XM_UA(0.00)[];
	RCPT_COUNT_TWELVE(0.00)[15];
	TAGGED_RCPT(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	TO_DN_SOME(0.00)[];
	FREEMAIL_CC(0.00)[gmail.com,kernel.org,analog.com,vger.kernel.org,lists.freedesktop.org,lists.linaro.org,crapouillou.net,ffwll.ch];
	RCVD_COUNT_ZERO(0.00)[0];
	FROM_HAS_DN(0.00)[];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	DKIM_TRACE(0.00)[crapouillou.net:+]
Message-ID-Hash: THLQ6L3G74BJAMXRFMZHYUR3TTMUETYH
X-Message-ID-Hash: THLQ6L3G74BJAMXRFMZHYUR3TTMUETYH
X-MailFrom: paul@crapouillou.net
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: =?UTF-8?q?Nuno=20S=C3=A1?= <noname.nuno@gmail.com>, Jonathan Cameron <jic23@kernel.org>, Michael Hennerich <Michael.Hennerich@analog.com>, linux-usb@vger.kernel.org, linux-doc@vger.kernel.org, linux-kernel@vger.kernel.org, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, Paul Cercueil <paul@crapouillou.net>
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH v6 3/4] usb: gadget: functionfs: Add DMABUF import interface
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/THLQ6L3G74BJAMXRFMZHYUR3TTMUETYH/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

VGhpcyBwYXRjaCBpbnRyb2R1Y2VzIHRocmVlIG5ldyBpb2N0bHMuIFRoZXkgYWxsIHNob3VsZCBi
ZSBjYWxsZWQgb24gYQ0KZGF0YSBlbmRwb2ludCAoaWUuIG5vdCBlcDApLiBUaGV5IGFyZToNCg0K
LSBGVU5DVElPTkZTX0RNQUJVRl9BVFRBQ0gsIHdoaWNoIHRha2VzIHRoZSBmaWxlIGRlc2NyaXB0
b3Igb2YgYSBETUFCVUYNCiAgb2JqZWN0IHRvIGF0dGFjaCB0byB0aGUgZW5kcG9pbnQuDQoNCi0g
RlVOQ1RJT05GU19ETUFCVUZfREVUQUNILCB3aGljaCB0YWtlcyB0aGUgZmlsZSBkZXNjcmlwdG9y
IG9mIHRoZQ0KICBETUFCVUYgdG8gZGV0YWNoIGZyb20gdGhlIGVuZHBvaW50LiBOb3RlIHRoYXQg
Y2xvc2luZyB0aGUgZW5kcG9pbnQncw0KICBmaWxlIGRlc2NyaXB0b3Igd2lsbCBhdXRvbWF0aWNh
bGx5IGRldGFjaCBhbGwgYXR0YWNoZWQgRE1BQlVGcy4NCg0KLSBGVU5DVElPTkZTX0RNQUJVRl9U
UkFOU0ZFUiwgd2hpY2ggcmVxdWVzdHMgYSBkYXRhIHRyYW5zZmVyIGZyb20gLyB0bw0KICB0aGUg
Z2l2ZW4gRE1BQlVGLiBJdHMgYXJndW1lbnQgaXMgYSBzdHJ1Y3R1cmUgdGhhdCBwYWNrcyB0aGUg
RE1BQlVGJ3MNCiAgZmlsZSBkZXNjcmlwdG9yLCB0aGUgc2l6ZSBpbiBieXRlcyB0byB0cmFuc2Zl
ciAod2hpY2ggc2hvdWxkIGdlbmVyYWxseQ0KICBiZSBzZXQgdG8gdGhlIHNpemUgb2YgdGhlIERN
QUJVRiksIGFuZCBhICdmbGFncycgZmllbGQgd2hpY2ggaXMgdW51c2VkDQogIGZvciBub3cuDQog
IEJlZm9yZSB0aGlzIGlvY3RsIGNhbiBiZSB1c2VkLCB0aGUgcmVsYXRlZCBETUFCVUYgbXVzdCBi
ZSBhdHRhY2hlZA0KICB3aXRoIEZVTkNUSU9ORlNfRE1BQlVGX0FUVEFDSC4NCg0KVGhlc2UgdGhy
ZWUgaW9jdGxzIGVuYWJsZSB0aGUgRnVuY3Rpb25GUyBjb2RlIHRvIHRyYW5zZmVyIGRhdGEgYmV0
d2Vlbg0KdGhlIFVTQiBzdGFjayBhbmQgYSBETUFCVUYgb2JqZWN0LCB3aGljaCBjYW4gYmUgcHJv
dmlkZWQgYnkgYSBkcml2ZXINCmZyb20gYSBjb21wbGV0ZWx5IGRpZmZlcmVudCBzdWJzeXN0ZW0s
IGluIGEgemVyby1jb3B5IGZhc2hpb24uDQoNClNpZ25lZC1vZmYtYnk6IFBhdWwgQ2VyY3VlaWwg
PHBhdWxAY3JhcG91aWxsb3UubmV0Pg0KQWNrZWQtYnk6IERhbmllbCBWZXR0ZXIgPGRhbmllbC52
ZXR0ZXJAZmZ3bGwuY2g+DQpBY2tlZC1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtv
ZW5pZ0BhbWQuY29tPg0KDQotLS0NCnYyOg0KLSBNYWtlIGZmc19kbWFfcmVzdl9sb2NrKCkgc3Rh
dGljDQotIEFkZCBNT0RVTEVfSU1QT1JUX05TKERNQV9CVUYpOw0KLSBUaGUgYXR0YWNoL2RldGFj
aCBmdW5jdGlvbnMgYXJlIG5vdyBwZXJmb3JtZWQgd2l0aG91dCBsb2NraW5nIHRoZQ0KICBlcHNf
bG9jayBzcGlubG9jay4gVGhlIHRyYW5zZmVyIGZ1bmN0aW9uIHN0YXJ0cyB3aXRoIHRoZSBzcGlu
bG9jaw0KICB1bmxvY2tlZCwgdGhlbiBsb2NrcyBpdCBiZWZvcmUgYWxsb2NhdGluZyBhbmQgcXVl
dWVpbmcgdGhlIFVTQg0KICB0cmFuc2Zlci4NCg0KdjM6DQotIElubGluZSB0b19mZnNfZG1hX2Zl
bmNlKCkgd2hpY2ggd2FzIGNhbGxlZCBvbmx5IG9uY2UuDQotIFNpbXBsaWZ5IGZmc19kbWFfcmVz
dl9sb2NrKCkNCi0gQWRkIGNvbW1lbnQgZXhwbGFpbmluZyB3aHkgd2UgdW5yZWYgdHdpY2UgaW4g
ZmZzX2RtYWJ1Zl9kZXRhY2goKQ0KLSBEb2N1bWVudCB1YXBpIHN0cnVjdCB1c2JfZmZzX2RtYWJ1
Zl90cmFuc2Zlcl9yZXEgYW5kIElPQ1RMcw0KDQp2NDoNCi0gUHJvdGVjdCB0aGUgRE1BQlVGIGxp
c3Qgd2l0aCBhIG11dGV4DQotIFVzZSBpbmNyZW1lbnRhbCBzZXF1ZW5jZSBudW1iZXIgZm9yIHRo
ZSBkbWFfZmVuY2VzDQotIFVucmVmIGF0dGFjaG1lbnRzIGFuZCBETUFCVUZzIGluIHdvcmtlcnMN
Ci0gUmVtb3ZlIGRlYWQgY29kZSBpbiBmZnNfZG1hX3Jlc3ZfbG9jaygpDQotIEZpeCBub24tYmxv
Y2sgYWN0dWFsbHkgYmxvY2tpbmcNCi0gVXNlIGRtYV9mZW5jZV9iZWdpbi9lbmRfc2lnbmFsbGlu
ZygpDQotIEFkZCBjb21tZW50IGFib3V0IGNhY2hlLW1hbmFnZW1lbnQgYW5kIGRtYV9idWZfdW5t
YXBfYXR0YWNobWVudCgpDQotIE1ha2Ugc3VyZSBkbWFfYnVmX21hcF9hdHRhY2htZW50KCkgaXMg
Y2FsbGVkIHdpdGggdGhlIGRtYS1yZXN2IGxvY2tlZA0KDQp2NToNCi0gQ2FjaGUgdGhlIGRtYV9i
dWZfYXR0YWNobWVudCB3aGlsZSB0aGUgRE1BQlVGIGlzIGF0dGFjaGVkLg0KLSBVc2UgZG1hX2J1
Zl9iZWdpbi9lbmRfYWNjZXNzKCkgdG8gZW5zdXJlIHRoYXQgdGhlIERNQUJVRiBkYXRhIHdpbGwg
YmUNCiAgY29oZXJlbnQgdG8gdGhlIGhhcmR3YXJlLg0KLSBSZW1vdmUgY29tbWVudCBhYm91dCBj
YWNoZS1tYW5hZ2VtZW50IGFuZCBkbWFfYnVmX3VubWFwX2F0dGFjaG1lbnQoKSwNCiAgc2luY2Ug
d2Ugbm93IHVzZSBkbWFfYnVmX2JlZ2luL2VuZF9hY2Nlc3MoKS4NCi0gQWRkZWQgQ2hyaXN0aWFu
J3MgQUNLDQotIFNlbGVjdCBETUFfU0hBUkVEX0JVRkZFUiBpbiBLY29uZmlnIGVudHJ5DQoNCnY2
Og0KLSBEcm9wIHVzZSBvZiBkbWFfYnVmX2JlZ2luL2VuZF9hY2Nlc3MoKS4gV2Ugbm93IG1ha2Ug
dGhlIGFzc3VtcHRpb24NCiAgdGhhdCB0aGUgZGV2aWNlcyBhdHRhY2hlZCB0byB0aGUgRE1BQlVG
cyBtdXN0IGJlIGNvaGVyZW50IGJldHdlZW4NCiAgdGhlbXNlbHZlcy4gVGhlIGNhY2hlIGNvaGVy
ZW5jeSBpc3N1ZSBpcyBhIHRhbmdlbnRpYWwgcHJvYmxlbSwgYW5kDQogIHRob3NlIGZ1bmN0aW9u
cyBjYW4gYmUgcmUtaW50cm9kdWNlZCBpbiBhIHN1YnNlcXVlbnQgcGF0Y2hzZXQuDQotIFVucXVl
dWUgcGVuZGluZyByZXF1ZXN0cyBvbiBkZXRhY2guIE90aGVyd2lzZSwgd2hlbiBjbG9zaW5nIHRo
ZSBkYXRhDQogIGVuZHBvaW50IHRoZSBETUFCVUYgd2lsbCBuZXZlciBiZSBzaWduYWxlZC4NCi0g
VXNlIGxpc3RfZm9yX2VhY2hfZW50cnlfc2FmZSgpIGluIGZmc19kbWFidWZfZGV0YWNoKCksIGJl
Y2F1c2UgdGhlcmUNCiAgaXMgYSBsaXN0X2RlbCgpIGluIHRoZXJlLg0KLSBVc2UgcHJfdmRlYnVn
KCkgaW5zdGVhZCBvZiBwcl9kZWJ1ZygpDQotIFJlbmFtZSBmZnNfZG1hYnVmX3VubWFwX3dvcmso
KSAtPiBmZnNfZG1hYnVmX2NsZWFudXAoKQ0KLS0tDQogZHJpdmVycy91c2IvZ2FkZ2V0L0tjb25m
aWcgICAgICAgICAgfCAgIDEgKw0KIGRyaXZlcnMvdXNiL2dhZGdldC9mdW5jdGlvbi9mX2ZzLmMg
IHwgNDY3ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysNCiBpbmNsdWRlL3VhcGkvbGludXgv
dXNiL2Z1bmN0aW9uZnMuaCB8ICA0MSArKysNCiAzIGZpbGVzIGNoYW5nZWQsIDUwOSBpbnNlcnRp
b25zKCspDQoNCmRpZmYgLS1naXQgYS9kcml2ZXJzL3VzYi9nYWRnZXQvS2NvbmZpZyBiL2RyaXZl
cnMvdXNiL2dhZGdldC9LY29uZmlnDQppbmRleCBiMzU5MmJjYjBmOTYuLjU2NmZmMGIxMjgyYSAx
MDA2NDQNCi0tLSBhL2RyaXZlcnMvdXNiL2dhZGdldC9LY29uZmlnDQorKysgYi9kcml2ZXJzL3Vz
Yi9nYWRnZXQvS2NvbmZpZw0KQEAgLTE5MCw2ICsxOTAsNyBAQCBjb25maWcgVVNCX0ZfTUFTU19T
VE9SQUdFDQogCXRyaXN0YXRlDQogDQogY29uZmlnIFVTQl9GX0ZTDQorCXNlbGVjdCBETUFfU0hB
UkVEX0JVRkZFUg0KIAl0cmlzdGF0ZQ0KIA0KIGNvbmZpZyBVU0JfRl9VQUMxDQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy91c2IvZ2FkZ2V0L2Z1bmN0aW9uL2ZfZnMuYyBiL2RyaXZlcnMvdXNiL2dhZGdl
dC9mdW5jdGlvbi9mX2ZzLmMNCmluZGV4IDQ5MWExZTBmNGZhMy4uYmZmYmMxZGM2NTFmIDEwMDY0
NA0KLS0tIGEvZHJpdmVycy91c2IvZ2FkZ2V0L2Z1bmN0aW9uL2ZfZnMuYw0KKysrIGIvZHJpdmVy
cy91c2IvZ2FkZ2V0L2Z1bmN0aW9uL2ZfZnMuYw0KQEAgLTE1LDYgKzE1LDkgQEANCiAvKiAjZGVm
aW5lIFZFUkJPU0VfREVCVUcgKi8NCiANCiAjaW5jbHVkZSA8bGludXgvYmxrZGV2Lmg+DQorI2lu
Y2x1ZGUgPGxpbnV4L2RtYS1idWYuaD4NCisjaW5jbHVkZSA8bGludXgvZG1hLWZlbmNlLmg+DQor
I2luY2x1ZGUgPGxpbnV4L2RtYS1yZXN2Lmg+DQogI2luY2x1ZGUgPGxpbnV4L3BhZ2VtYXAuaD4N
CiAjaW5jbHVkZSA8bGludXgvZXhwb3J0Lmg+DQogI2luY2x1ZGUgPGxpbnV4L2ZzX3BhcnNlci5o
Pg0KQEAgLTQzLDYgKzQ2LDggQEANCiANCiAjZGVmaW5lIEZVTkNUSU9ORlNfTUFHSUMJMHhhNjQ3
MzYxIC8qIENob3NlbiBieSBhIGhvbmVzdCBkaWNlIHJvbGwgOykgKi8NCiANCitNT0RVTEVfSU1Q
T1JUX05TKERNQV9CVUYpOw0KKw0KIC8qIFJlZmVyZW5jZSBjb3VudGVyIGhhbmRsaW5nICovDQog
c3RhdGljIHZvaWQgZmZzX2RhdGFfZ2V0KHN0cnVjdCBmZnNfZGF0YSAqZmZzKTsNCiBzdGF0aWMg
dm9pZCBmZnNfZGF0YV9wdXQoc3RydWN0IGZmc19kYXRhICpmZnMpOw0KQEAgLTEyNCw2ICsxMjks
MjUgQEAgc3RydWN0IGZmc19lcCB7DQogCXU4CQkJCW51bTsNCiB9Ow0KIA0KK3N0cnVjdCBmZnNf
ZG1hYnVmX3ByaXYgew0KKwlzdHJ1Y3QgbGlzdF9oZWFkIGVudHJ5Ow0KKwlzdHJ1Y3Qga3JlZiBy
ZWY7DQorCXN0cnVjdCBmZnNfZGF0YSAqZmZzOw0KKwlzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50
ICphdHRhY2g7DQorCXN0cnVjdCBzZ190YWJsZSAqc2d0Ow0KKwllbnVtIGRtYV9kYXRhX2RpcmVj
dGlvbiBkaXI7DQorCXNwaW5sb2NrX3QgbG9jazsNCisJdTY0IGNvbnRleHQ7DQorCXN0cnVjdCB1
c2JfcmVxdWVzdCAqcmVxOwkvKiBQOiBmZnMtPmVwc19sb2NrICovDQorCXN0cnVjdCB1c2JfZXAg
KmVwOwkJLyogUDogZmZzLT5lcHNfbG9jayAqLw0KK307DQorDQorc3RydWN0IGZmc19kbWFfZmVu
Y2Ugew0KKwlzdHJ1Y3QgZG1hX2ZlbmNlIGJhc2U7DQorCXN0cnVjdCBmZnNfZG1hYnVmX3ByaXYg
KnByaXY7DQorCXN0cnVjdCB3b3JrX3N0cnVjdCB3b3JrOw0KK307DQorDQogc3RydWN0IGZmc19l
cGZpbGUgew0KIAkvKiBQcm90ZWN0cyBlcC0+ZXAgYW5kIGVwLT5yZXEuICovDQogCXN0cnVjdCBt
dXRleAkJCW11dGV4Ow0KQEAgLTE5Nyw2ICsyMjEsMTEgQEAgc3RydWN0IGZmc19lcGZpbGUgew0K
IAl1bnNpZ25lZCBjaGFyCQkJaXNvYzsJLyogUDogZmZzLT5lcHNfbG9jayAqLw0KIA0KIAl1bnNp
Z25lZCBjaGFyCQkJX3BhZDsNCisNCisJLyogUHJvdGVjdHMgZG1hYnVmcyAqLw0KKwlzdHJ1Y3Qg
bXV0ZXgJCQlkbWFidWZzX211dGV4Ow0KKwlzdHJ1Y3QgbGlzdF9oZWFkCQlkbWFidWZzOyAvKiBQ
OiBkbWFidWZzX211dGV4ICovDQorCWF0b21pY190CQkJc2Vxbm87DQogfTsNCiANCiBzdHJ1Y3Qg
ZmZzX2J1ZmZlciB7DQpAQCAtMTI3MSwxMCArMTMwMCw1OCBAQCBzdGF0aWMgc3NpemVfdCBmZnNf
ZXBmaWxlX3JlYWRfaXRlcihzdHJ1Y3Qga2lvY2IgKmtpb2NiLCBzdHJ1Y3QgaW92X2l0ZXIgKnRv
KQ0KIAlyZXR1cm4gcmVzOw0KIH0NCiANCitzdGF0aWMgdm9pZCBmZnNfZG1hYnVmX3JlbGVhc2Uo
c3RydWN0IGtyZWYgKnJlZikNCit7DQorCXN0cnVjdCBmZnNfZG1hYnVmX3ByaXYgKnByaXYgPSBj
b250YWluZXJfb2YocmVmLCBzdHJ1Y3QgZmZzX2RtYWJ1Zl9wcml2LCByZWYpOw0KKwlzdHJ1Y3Qg
ZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2ggPSBwcml2LT5hdHRhY2g7DQorCXN0cnVjdCBkbWFf
YnVmICpkbWFidWYgPSBhdHRhY2gtPmRtYWJ1ZjsNCisNCisJcHJfdmRlYnVnKCJGRlMgRE1BQlVG
IHJlbGVhc2VcbiIpOw0KKwlkbWFfcmVzdl9sb2NrKGRtYWJ1Zi0+cmVzdiwgTlVMTCk7DQorCWRt
YV9idWZfdW5tYXBfYXR0YWNobWVudChhdHRhY2gsIHByaXYtPnNndCwgcHJpdi0+ZGlyKTsNCisJ
ZG1hX3Jlc3ZfdW5sb2NrKGRtYWJ1Zi0+cmVzdik7DQorDQorCWRtYV9idWZfZGV0YWNoKGF0dGFj
aC0+ZG1hYnVmLCBhdHRhY2gpOw0KKwlkbWFfYnVmX3B1dChkbWFidWYpOw0KKwlrZnJlZShwcml2
KTsNCit9DQorDQorc3RhdGljIHZvaWQgZmZzX2RtYWJ1Zl9nZXQoc3RydWN0IGRtYV9idWZfYXR0
YWNobWVudCAqYXR0YWNoKQ0KK3sNCisJc3RydWN0IGZmc19kbWFidWZfcHJpdiAqcHJpdiA9IGF0
dGFjaC0+aW1wb3J0ZXJfcHJpdjsNCisNCisJa3JlZl9nZXQoJnByaXYtPnJlZik7DQorfQ0KKw0K
K3N0YXRpYyB2b2lkIGZmc19kbWFidWZfcHV0KHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0
dGFjaCkNCit7DQorCXN0cnVjdCBmZnNfZG1hYnVmX3ByaXYgKnByaXYgPSBhdHRhY2gtPmltcG9y
dGVyX3ByaXY7DQorDQorCWtyZWZfcHV0KCZwcml2LT5yZWYsIGZmc19kbWFidWZfcmVsZWFzZSk7
DQorfQ0KKw0KIHN0YXRpYyBpbnQNCiBmZnNfZXBmaWxlX3JlbGVhc2Uoc3RydWN0IGlub2RlICpp
bm9kZSwgc3RydWN0IGZpbGUgKmZpbGUpDQogew0KIAlzdHJ1Y3QgZmZzX2VwZmlsZSAqZXBmaWxl
ID0gaW5vZGUtPmlfcHJpdmF0ZTsNCisJc3RydWN0IGZmc19kbWFidWZfcHJpdiAqcHJpdiwgKnRt
cDsNCisJc3RydWN0IGZmc19kYXRhICpmZnMgPSBlcGZpbGUtPmZmczsNCisNCisJbXV0ZXhfbG9j
aygmZXBmaWxlLT5kbWFidWZzX211dGV4KTsNCisNCisJLyogQ2xvc2UgYWxsIGF0dGFjaGVkIERN
QUJVRnMgKi8NCisJbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHByaXYsIHRtcCwgJmVwZmlsZS0+
ZG1hYnVmcywgZW50cnkpIHsNCisJCS8qIENhbmNlbCBhbnkgcGVuZGluZyB0cmFuc2ZlciAqLw0K
KwkJc3Bpbl9sb2NrX2lycSgmZmZzLT5lcHNfbG9jayk7DQorCQlpZiAocHJpdi0+ZXAgJiYgcHJp
di0+cmVxKQ0KKwkJCXVzYl9lcF9kZXF1ZXVlKHByaXYtPmVwLCBwcml2LT5yZXEpOw0KKwkJc3Bp
bl91bmxvY2tfaXJxKCZmZnMtPmVwc19sb2NrKTsNCisNCisJCWxpc3RfZGVsKCZwcml2LT5lbnRy
eSk7DQorCQlmZnNfZG1hYnVmX3B1dChwcml2LT5hdHRhY2gpOw0KKwl9DQorDQorCW11dGV4X3Vu
bG9jaygmZXBmaWxlLT5kbWFidWZzX211dGV4KTsNCiANCiAJX19mZnNfZXBmaWxlX3JlYWRfYnVm
ZmVyX2ZyZWUoZXBmaWxlKTsNCiAJZmZzX2RhdGFfY2xvc2VkKGVwZmlsZS0+ZmZzKTsNCkBAIC0x
MjgyLDYgKzEzNTksMzU2IEBAIGZmc19lcGZpbGVfcmVsZWFzZShzdHJ1Y3QgaW5vZGUgKmlub2Rl
LCBzdHJ1Y3QgZmlsZSAqZmlsZSkNCiAJcmV0dXJuIDA7DQogfQ0KIA0KK3N0YXRpYyB2b2lkIGZm
c19kbWFidWZfY2xlYW51cChzdHJ1Y3Qgd29ya19zdHJ1Y3QgKndvcmspDQorew0KKwlzdHJ1Y3Qg
ZmZzX2RtYV9mZW5jZSAqZG1hX2ZlbmNlID0NCisJCWNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3Qg
ZmZzX2RtYV9mZW5jZSwgd29yayk7DQorCXN0cnVjdCBmZnNfZG1hYnVmX3ByaXYgKnByaXYgPSBk
bWFfZmVuY2UtPnByaXY7DQorCXN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCA9IHBy
aXYtPmF0dGFjaDsNCisJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UgPSAmZG1hX2ZlbmNlLT5iYXNl
Ow0KKw0KKwlmZnNfZG1hYnVmX3B1dChhdHRhY2gpOw0KKwlkbWFfZmVuY2VfcHV0KGZlbmNlKTsN
Cit9DQorDQorc3RhdGljIHZvaWQgZmZzX2RtYWJ1Zl9zaWduYWxfZG9uZShzdHJ1Y3QgZmZzX2Rt
YV9mZW5jZSAqZG1hX2ZlbmNlLCBpbnQgcmV0KQ0KK3sNCisJc3RydWN0IGZmc19kbWFidWZfcHJp
diAqcHJpdiA9IGRtYV9mZW5jZS0+cHJpdjsNCisJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UgPSAm
ZG1hX2ZlbmNlLT5iYXNlOw0KKwlib29sIGNvb2tpZSA9IGRtYV9mZW5jZV9iZWdpbl9zaWduYWxs
aW5nKCk7DQorDQorCWRtYV9mZW5jZV9nZXQoZmVuY2UpOw0KKwlmZW5jZS0+ZXJyb3IgPSByZXQ7
DQorCWRtYV9mZW5jZV9zaWduYWwoZmVuY2UpOw0KKwlkbWFfZmVuY2VfZW5kX3NpZ25hbGxpbmco
Y29va2llKTsNCisNCisJLyoNCisJICogVGhlIGZlbmNlIHdpbGwgYmUgdW5yZWYnZCBpbiBmZnNf
ZG1hYnVmX2NsZWFudXAuDQorCSAqIEl0IGNhbid0IGJlIGRvbmUgaGVyZSwgYXMgdGhlIHVucmVm
IGZ1bmN0aW9ucyBtaWdodCB0cnkgdG8gbG9jaw0KKwkgKiB0aGUgcmVzdiBvYmplY3QsIHdoaWNo
IHdvdWxkIGRlYWRsb2NrLg0KKwkgKi8NCisJSU5JVF9XT1JLKCZkbWFfZmVuY2UtPndvcmssIGZm
c19kbWFidWZfY2xlYW51cCk7DQorCXF1ZXVlX3dvcmsocHJpdi0+ZmZzLT5pb19jb21wbGV0aW9u
X3dxLCAmZG1hX2ZlbmNlLT53b3JrKTsNCit9DQorDQorc3RhdGljIHZvaWQgZmZzX2VwZmlsZV9k
bWFidWZfaW9fY29tcGxldGUoc3RydWN0IHVzYl9lcCAqZXAsDQorCQkJCQkgIHN0cnVjdCB1c2Jf
cmVxdWVzdCAqcmVxKQ0KK3sNCisJcHJfdmRlYnVnKCJGRlM6IERNQUJVRiB0cmFuc2ZlciBjb21w
bGV0ZSwgc3RhdHVzPSVkXG4iLCByZXEtPnN0YXR1cyk7DQorCWZmc19kbWFidWZfc2lnbmFsX2Rv
bmUocmVxLT5jb250ZXh0LCByZXEtPnN0YXR1cyk7DQorCXVzYl9lcF9mcmVlX3JlcXVlc3QoZXAs
IHJlcSk7DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBjaGFyICpmZnNfZG1hYnVmX2dldF9kcml2ZXJf
bmFtZShzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkNCit7DQorCXJldHVybiAiZnVuY3Rpb25mcyI7
DQorfQ0KKw0KK3N0YXRpYyBjb25zdCBjaGFyICpmZnNfZG1hYnVmX2dldF90aW1lbGluZV9uYW1l
KHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKQ0KK3sNCisJcmV0dXJuICIiOw0KK30NCisNCitzdGF0
aWMgdm9pZCBmZnNfZG1hYnVmX2ZlbmNlX3JlbGVhc2Uoc3RydWN0IGRtYV9mZW5jZSAqZmVuY2Up
DQorew0KKwlzdHJ1Y3QgZmZzX2RtYV9mZW5jZSAqZG1hX2ZlbmNlID0NCisJCWNvbnRhaW5lcl9v
ZihmZW5jZSwgc3RydWN0IGZmc19kbWFfZmVuY2UsIGJhc2UpOw0KKw0KKwlrZnJlZShkbWFfZmVu
Y2UpOw0KK30NCisNCitzdGF0aWMgY29uc3Qgc3RydWN0IGRtYV9mZW5jZV9vcHMgZmZzX2RtYWJ1
Zl9mZW5jZV9vcHMgPSB7DQorCS5nZXRfZHJpdmVyX25hbWUJPSBmZnNfZG1hYnVmX2dldF9kcml2
ZXJfbmFtZSwNCisJLmdldF90aW1lbGluZV9uYW1lCT0gZmZzX2RtYWJ1Zl9nZXRfdGltZWxpbmVf
bmFtZSwNCisJLnJlbGVhc2UJCT0gZmZzX2RtYWJ1Zl9mZW5jZV9yZWxlYXNlLA0KK307DQorDQor
c3RhdGljIGludCBmZnNfZG1hX3Jlc3ZfbG9jayhzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBib29s
IG5vbmJsb2NrKQ0KK3sNCisJaWYgKCFub25ibG9jaykNCisJCXJldHVybiBkbWFfcmVzdl9sb2Nr
X2ludGVycnVwdGlibGUoZG1hYnVmLT5yZXN2LCBOVUxMKTsNCisNCisJaWYgKCFkbWFfcmVzdl90
cnlsb2NrKGRtYWJ1Zi0+cmVzdikpDQorCQlyZXR1cm4gLUVCVVNZOw0KKw0KKwlyZXR1cm4gMDsN
Cit9DQorDQorc3RhdGljIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKg0KK2Zmc19kbWFidWZf
ZmluZF9hdHRhY2htZW50KHN0cnVjdCBmZnNfZXBmaWxlICplcGZpbGUsIHN0cnVjdCBkbWFfYnVm
ICpkbWFidWYpDQorew0KKwlzdHJ1Y3QgZGV2aWNlICpkZXYgPSBlcGZpbGUtPmZmcy0+Z2FkZ2V0
LT5kZXYucGFyZW50Ow0KKwlzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRhY2ggPSBOVUxM
Ow0KKwlzdHJ1Y3QgZmZzX2RtYWJ1Zl9wcml2ICpwcml2Ow0KKw0KKwltdXRleF9sb2NrKCZlcGZp
bGUtPmRtYWJ1ZnNfbXV0ZXgpOw0KKw0KKwlsaXN0X2Zvcl9lYWNoX2VudHJ5KHByaXYsICZlcGZp
bGUtPmRtYWJ1ZnMsIGVudHJ5KSB7DQorCQlpZiAocHJpdi0+YXR0YWNoLT5kZXYgPT0gZGV2DQor
CQkgICAgJiYgcHJpdi0+YXR0YWNoLT5kbWFidWYgPT0gZG1hYnVmKSB7DQorCQkJYXR0YWNoID0g
cHJpdi0+YXR0YWNoOw0KKwkJCWJyZWFrOw0KKwkJfQ0KKwl9DQorDQorCWlmIChhdHRhY2gpDQor
CQlmZnNfZG1hYnVmX2dldChhdHRhY2gpOw0KKw0KKwltdXRleF91bmxvY2soJmVwZmlsZS0+ZG1h
YnVmc19tdXRleCk7DQorDQorCXJldHVybiBhdHRhY2ggPzogRVJSX1BUUigtRVBFUk0pOw0KK30N
CisNCitzdGF0aWMgaW50IGZmc19kbWFidWZfYXR0YWNoKHN0cnVjdCBmaWxlICpmaWxlLCBpbnQg
ZmQpDQorew0KKwlib29sIG5vbmJsb2NrID0gZmlsZS0+Zl9mbGFncyAmIE9fTk9OQkxPQ0s7DQor
CXN0cnVjdCBmZnNfZXBmaWxlICplcGZpbGUgPSBmaWxlLT5wcml2YXRlX2RhdGE7DQorCXN0cnVj
dCB1c2JfZ2FkZ2V0ICpnYWRnZXQgPSBlcGZpbGUtPmZmcy0+Z2FkZ2V0Ow0KKwlzdHJ1Y3QgZG1h
X2J1Zl9hdHRhY2htZW50ICphdHRhY2g7DQorCXN0cnVjdCBmZnNfZG1hYnVmX3ByaXYgKnByaXY7
DQorCWVudW0gZG1hX2RhdGFfZGlyZWN0aW9uIGRpcjsNCisJc3RydWN0IHNnX3RhYmxlICpzZ190
YWJsZTsNCisJc3RydWN0IGRtYV9idWYgKmRtYWJ1ZjsNCisJaW50IGVycjsNCisNCisJaWYgKCFn
YWRnZXQgfHwgIWdhZGdldC0+c2dfc3VwcG9ydGVkKQ0KKwkJcmV0dXJuIC1FUEVSTTsNCisNCisJ
ZG1hYnVmID0gZG1hX2J1Zl9nZXQoZmQpOw0KKwlpZiAoSVNfRVJSKGRtYWJ1ZikpDQorCQlyZXR1
cm4gUFRSX0VSUihkbWFidWYpOw0KKw0KKwlhdHRhY2ggPSBkbWFfYnVmX2F0dGFjaChkbWFidWYs
IGdhZGdldC0+ZGV2LnBhcmVudCk7DQorCWlmIChJU19FUlIoYXR0YWNoKSkgew0KKwkJZXJyID0g
UFRSX0VSUihhdHRhY2gpOw0KKwkJZ290byBlcnJfZG1hYnVmX3B1dDsNCisJfQ0KKw0KKwlwcml2
ID0ga3phbGxvYyhzaXplb2YoKnByaXYpLCBHRlBfS0VSTkVMKTsNCisJaWYgKCFwcml2KSB7DQor
CQllcnIgPSAtRU5PTUVNOw0KKwkJZ290byBlcnJfZG1hYnVmX2RldGFjaDsNCisJfQ0KKw0KKwlk
aXIgPSBlcGZpbGUtPmluID8gRE1BX0ZST01fREVWSUNFIDogRE1BX1RPX0RFVklDRTsNCisNCisJ
ZXJyID0gZmZzX2RtYV9yZXN2X2xvY2soZG1hYnVmLCBub25ibG9jayk7DQorCWlmIChlcnIpDQor
CQlnb3RvIGVycl9mcmVlX3ByaXY7DQorDQorCXNnX3RhYmxlID0gZG1hX2J1Zl9tYXBfYXR0YWNo
bWVudChhdHRhY2gsIGRpcik7DQorCWRtYV9yZXN2X3VubG9jayhkbWFidWYtPnJlc3YpOw0KKw0K
KwlpZiAoSVNfRVJSKHNnX3RhYmxlKSkgew0KKwkJZXJyID0gUFRSX0VSUihzZ190YWJsZSk7DQor
CQlnb3RvIGVycl9mcmVlX3ByaXY7DQorCX0NCisNCisJYXR0YWNoLT5pbXBvcnRlcl9wcml2ID0g
cHJpdjsNCisNCisJcHJpdi0+c2d0ID0gc2dfdGFibGU7DQorCXByaXYtPmRpciA9IGRpcjsNCisJ
cHJpdi0+ZmZzID0gZXBmaWxlLT5mZnM7DQorCXByaXYtPmF0dGFjaCA9IGF0dGFjaDsNCisJc3Bp
bl9sb2NrX2luaXQoJnByaXYtPmxvY2spOw0KKwlrcmVmX2luaXQoJnByaXYtPnJlZik7DQorCXBy
aXYtPmNvbnRleHQgPSBkbWFfZmVuY2VfY29udGV4dF9hbGxvYygxKTsNCisNCisJbXV0ZXhfbG9j
aygmZXBmaWxlLT5kbWFidWZzX211dGV4KTsNCisJbGlzdF9hZGQoJnByaXYtPmVudHJ5LCAmZXBm
aWxlLT5kbWFidWZzKTsNCisJbXV0ZXhfdW5sb2NrKCZlcGZpbGUtPmRtYWJ1ZnNfbXV0ZXgpOw0K
Kw0KKwlyZXR1cm4gMDsNCisNCitlcnJfZnJlZV9wcml2Og0KKwlrZnJlZShwcml2KTsNCitlcnJf
ZG1hYnVmX2RldGFjaDoNCisJZG1hX2J1Zl9kZXRhY2goZG1hYnVmLCBhdHRhY2gpOw0KK2Vycl9k
bWFidWZfcHV0Og0KKwlkbWFfYnVmX3B1dChkbWFidWYpOw0KKw0KKwlyZXR1cm4gZXJyOw0KK30N
CisNCitzdGF0aWMgaW50IGZmc19kbWFidWZfZGV0YWNoKHN0cnVjdCBmaWxlICpmaWxlLCBpbnQg
ZmQpDQorew0KKwlzdHJ1Y3QgZmZzX2VwZmlsZSAqZXBmaWxlID0gZmlsZS0+cHJpdmF0ZV9kYXRh
Ow0KKwlzdHJ1Y3QgZmZzX2RhdGEgKmZmcyA9IGVwZmlsZS0+ZmZzOw0KKwlzdHJ1Y3QgZGV2aWNl
ICpkZXYgPSBmZnMtPmdhZGdldC0+ZGV2LnBhcmVudDsNCisJc3RydWN0IGZmc19kbWFidWZfcHJp
diAqcHJpdiwgKnRtcDsNCisJc3RydWN0IGRtYV9idWYgKmRtYWJ1ZjsNCisJaW50IHJldCA9IC1F
UEVSTTsNCisNCisJZG1hYnVmID0gZG1hX2J1Zl9nZXQoZmQpOw0KKwlpZiAoSVNfRVJSKGRtYWJ1
ZikpDQorCQlyZXR1cm4gUFRSX0VSUihkbWFidWYpOw0KKw0KKwltdXRleF9sb2NrKCZlcGZpbGUt
PmRtYWJ1ZnNfbXV0ZXgpOw0KKw0KKwlsaXN0X2Zvcl9lYWNoX2VudHJ5X3NhZmUocHJpdiwgdG1w
LCAmZXBmaWxlLT5kbWFidWZzLCBlbnRyeSkgew0KKwkJaWYgKHByaXYtPmF0dGFjaC0+ZGV2ID09
IGRldg0KKwkJICAgICYmIHByaXYtPmF0dGFjaC0+ZG1hYnVmID09IGRtYWJ1Zikgew0KKwkJCS8q
IENhbmNlbCBhbnkgcGVuZGluZyB0cmFuc2ZlciAqLw0KKwkJCXNwaW5fbG9ja19pcnEoJmZmcy0+
ZXBzX2xvY2spOw0KKwkJCWlmIChwcml2LT5lcCAmJiBwcml2LT5yZXEpDQorCQkJCXVzYl9lcF9k
ZXF1ZXVlKHByaXYtPmVwLCBwcml2LT5yZXEpOw0KKwkJCXNwaW5fdW5sb2NrX2lycSgmZmZzLT5l
cHNfbG9jayk7DQorDQorCQkJbGlzdF9kZWwoJnByaXYtPmVudHJ5KTsNCisNCisJCQkvKiBVbnJl
ZiB0aGUgcmVmZXJlbmNlIGZyb20gZmZzX2RtYWJ1Zl9hdHRhY2goKSAqLw0KKwkJCWZmc19kbWFi
dWZfcHV0KHByaXYtPmF0dGFjaCk7DQorCQkJcmV0ID0gMDsNCisJCQlicmVhazsNCisJCX0NCisJ
fQ0KKw0KKwltdXRleF91bmxvY2soJmVwZmlsZS0+ZG1hYnVmc19tdXRleCk7DQorCWRtYV9idWZf
cHV0KGRtYWJ1Zik7DQorDQorCXJldHVybiByZXQ7DQorfQ0KKw0KK3N0YXRpYyBpbnQgZmZzX2Rt
YWJ1Zl90cmFuc2ZlcihzdHJ1Y3QgZmlsZSAqZmlsZSwNCisJCQkgICAgICAgY29uc3Qgc3RydWN0
IHVzYl9mZnNfZG1hYnVmX3RyYW5zZmVyX3JlcSAqcmVxKQ0KK3sNCisJYm9vbCBub25ibG9jayA9
IGZpbGUtPmZfZmxhZ3MgJiBPX05PTkJMT0NLOw0KKwlzdHJ1Y3QgZmZzX2VwZmlsZSAqZXBmaWxl
ID0gZmlsZS0+cHJpdmF0ZV9kYXRhOw0KKwlzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICphdHRh
Y2g7DQorCXN0cnVjdCBmZnNfZG1hYnVmX3ByaXYgKnByaXY7DQorCXN0cnVjdCBmZnNfZG1hX2Zl
bmNlICpmZW5jZTsNCisJc3RydWN0IHVzYl9yZXF1ZXN0ICp1c2JfcmVxOw0KKwlzdHJ1Y3QgZG1h
X2J1ZiAqZG1hYnVmOw0KKwlzdHJ1Y3QgZmZzX2VwICplcDsNCisJYm9vbCBjb29raWU7DQorCXUz
MiBzZXFubzsNCisJaW50IHJldDsNCisNCisJaWYgKHJlcS0+ZmxhZ3MgJiB+VVNCX0ZGU19ETUFC
VUZfVFJBTlNGRVJfTUFTSykNCisJCXJldHVybiAtRUlOVkFMOw0KKw0KKwlkbWFidWYgPSBkbWFf
YnVmX2dldChyZXEtPmZkKTsNCisJaWYgKElTX0VSUihkbWFidWYpKQ0KKwkJcmV0dXJuIFBUUl9F
UlIoZG1hYnVmKTsNCisNCisJaWYgKHJlcS0+bGVuZ3RoID4gZG1hYnVmLT5zaXplIHx8IHJlcS0+
bGVuZ3RoID09IDApIHsNCisJCXJldCA9IC1FSU5WQUw7DQorCQlnb3RvIGVycl9kbWFidWZfcHV0
Ow0KKwl9DQorDQorCWF0dGFjaCA9IGZmc19kbWFidWZfZmluZF9hdHRhY2htZW50KGVwZmlsZSwg
ZG1hYnVmKTsNCisJaWYgKElTX0VSUihhdHRhY2gpKSB7DQorCQlyZXQgPSBQVFJfRVJSKGF0dGFj
aCk7DQorCQlnb3RvIGVycl9kbWFidWZfcHV0Ow0KKwl9DQorDQorCXByaXYgPSBhdHRhY2gtPmlt
cG9ydGVyX3ByaXY7DQorDQorCWVwID0gZmZzX2VwZmlsZV93YWl0X2VwKGZpbGUpOw0KKwlpZiAo
SVNfRVJSKGVwKSkgew0KKwkJcmV0ID0gUFRSX0VSUihlcCk7DQorCQlnb3RvIGVycl9hdHRhY2ht
ZW50X3B1dDsNCisJfQ0KKw0KKwlyZXQgPSBmZnNfZG1hX3Jlc3ZfbG9jayhkbWFidWYsIG5vbmJs
b2NrKTsNCisJaWYgKHJldCkNCisJCWdvdG8gZXJyX2F0dGFjaG1lbnRfcHV0Ow0KKw0KKwkvKiBN
YWtlIHN1cmUgd2UgZG9uJ3QgaGF2ZSB3cml0ZXJzICovDQorCWlmICghZG1hX3Jlc3ZfdGVzdF9z
aWduYWxlZChkbWFidWYtPnJlc3YsIERNQV9SRVNWX1VTQUdFX1dSSVRFKSkgew0KKwkJcHJfdmRl
YnVnKCJGRlMgV1JJVEUgZmVuY2UgaXMgbm90IHNpZ25hbGVkXG4iKTsNCisJCXJldCA9IC1FQlVT
WTsNCisJCWdvdG8gZXJyX3Jlc3ZfdW5sb2NrOw0KKwl9DQorDQorCS8qIElmIHdlJ3JlIHdyaXRp
bmcgdG8gdGhlIERNQUJVRiwgbWFrZSBzdXJlIHdlIGRvbid0IGhhdmUgcmVhZGVycyAqLw0KKwlp
ZiAoZXBmaWxlLT5pbiAmJg0KKwkgICAgIWRtYV9yZXN2X3Rlc3Rfc2lnbmFsZWQoZG1hYnVmLT5y
ZXN2LCBETUFfUkVTVl9VU0FHRV9SRUFEKSkgew0KKwkJcHJfdmRlYnVnKCJGRlMgUkVBRCBmZW5j
ZSBpcyBub3Qgc2lnbmFsZWRcbiIpOw0KKwkJcmV0ID0gLUVCVVNZOw0KKwkJZ290byBlcnJfcmVz
dl91bmxvY2s7DQorCX0NCisNCisJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoZG1hYnVm
LT5yZXN2LCAxKTsNCisJaWYgKHJldCkNCisJCWdvdG8gZXJyX3Jlc3ZfdW5sb2NrOw0KKw0KKwlm
ZW5jZSA9IGttYWxsb2Moc2l6ZW9mKCpmZW5jZSksIEdGUF9LRVJORUwpOw0KKwlpZiAoIWZlbmNl
KSB7DQorCQlyZXQgPSAtRU5PTUVNOw0KKwkJZ290byBlcnJfcmVzdl91bmxvY2s7DQorCX0NCisN
CisJZmVuY2UtPnByaXYgPSBwcml2Ow0KKw0KKwlzcGluX2xvY2tfaXJxKCZlcGZpbGUtPmZmcy0+
ZXBzX2xvY2spOw0KKw0KKwkvKiBJbiB0aGUgbWVhbnRpbWUsIGVuZHBvaW50IGdvdCBkaXNhYmxl
ZCBvciBjaGFuZ2VkLiAqLw0KKwlpZiAoZXBmaWxlLT5lcCAhPSBlcCkgew0KKwkJcmV0ID0gLUVT
SFVURE9XTjsNCisJCWdvdG8gZXJyX2ZlbmNlX3B1dDsNCisJfQ0KKw0KKwl1c2JfcmVxID0gdXNi
X2VwX2FsbG9jX3JlcXVlc3QoZXAtPmVwLCBHRlBfQVRPTUlDKTsNCisJaWYgKCF1c2JfcmVxKSB7
DQorCQlyZXQgPSAtRU5PTUVNOw0KKwkJZ290byBlcnJfZmVuY2VfcHV0Ow0KKwl9DQorDQorCS8q
DQorCSAqIHVzYl9lcF9xdWV1ZSgpIGd1YXJhbnRlZXMgdGhhdCBhbGwgdHJhbnNmZXJzIGFyZSBw
cm9jZXNzZWQgaW4gdGhlDQorCSAqIG9yZGVyIHRoZXkgYXJlIGVucXVldWVkLCBzbyB3ZSBjYW4g
dXNlIGEgc2ltcGxlIGluY3JlbWVudGluZw0KKwkgKiBzZXF1ZW5jZSBudW1iZXIgZm9yIHRoZSBk
bWFfZmVuY2UuDQorCSAqLw0KKwlzZXFubyA9IGF0b21pY19hZGRfcmV0dXJuKDEsICZlcGZpbGUt
PnNlcW5vKTsNCisNCisJZG1hX2ZlbmNlX2luaXQoJmZlbmNlLT5iYXNlLCAmZmZzX2RtYWJ1Zl9m
ZW5jZV9vcHMsDQorCQkgICAgICAgJnByaXYtPmxvY2ssIHByaXYtPmNvbnRleHQsIHNlcW5vKTsN
CisNCisJZG1hX3Jlc3ZfYWRkX2ZlbmNlKGRtYWJ1Zi0+cmVzdiwgJmZlbmNlLT5iYXNlLA0KKwkJ
CSAgIGRtYV9yZXN2X3VzYWdlX3J3KGVwZmlsZS0+aW4pKTsNCisJZG1hX3Jlc3ZfdW5sb2NrKGRt
YWJ1Zi0+cmVzdik7DQorDQorCS8qIE5vdyB0aGF0IHRoZSBkbWFfZmVuY2UgaXMgaW4gcGxhY2Us
IHF1ZXVlIHRoZSB0cmFuc2Zlci4gKi8NCisNCisJdXNiX3JlcS0+bGVuZ3RoID0gcmVxLT5sZW5n
dGg7DQorCXVzYl9yZXEtPmJ1ZiA9IE5VTEw7DQorCXVzYl9yZXEtPnNnID0gcHJpdi0+c2d0LT5z
Z2w7DQorCXVzYl9yZXEtPm51bV9zZ3MgPSBzZ19uZW50c19mb3JfbGVuKHByaXYtPnNndC0+c2ds
LCByZXEtPmxlbmd0aCk7DQorCXVzYl9yZXEtPnNnX3dhc19tYXBwZWQgPSB0cnVlOw0KKwl1c2Jf
cmVxLT5jb250ZXh0ICA9IGZlbmNlOw0KKwl1c2JfcmVxLT5jb21wbGV0ZSA9IGZmc19lcGZpbGVf
ZG1hYnVmX2lvX2NvbXBsZXRlOw0KKw0KKwljb29raWUgPSBkbWFfZmVuY2VfYmVnaW5fc2lnbmFs
bGluZygpOw0KKwlyZXQgPSB1c2JfZXBfcXVldWUoZXAtPmVwLCB1c2JfcmVxLCBHRlBfQVRPTUlD
KTsNCisJZG1hX2ZlbmNlX2VuZF9zaWduYWxsaW5nKGNvb2tpZSk7DQorCWlmICghcmV0KSB7DQor
CQlwcml2LT5yZXEgPSB1c2JfcmVxOw0KKwkJcHJpdi0+ZXAgPSBlcC0+ZXA7DQorCX0gZWxzZSB7
DQorCQlwcl93YXJuKCJGRlM6IEZhaWxlZCB0byBxdWV1ZSBETUFCVUY6ICVkXG4iLCByZXQpOw0K
KwkJZmZzX2RtYWJ1Zl9zaWduYWxfZG9uZShmZW5jZSwgcmV0KTsNCisJCXVzYl9lcF9mcmVlX3Jl
cXVlc3QoZXAtPmVwLCB1c2JfcmVxKTsNCisJfQ0KKw0KKwlzcGluX3VubG9ja19pcnEoJmVwZmls
ZS0+ZmZzLT5lcHNfbG9jayk7DQorCWRtYV9idWZfcHV0KGRtYWJ1Zik7DQorDQorCXJldHVybiBy
ZXQ7DQorDQorZXJyX2ZlbmNlX3B1dDoNCisJc3Bpbl91bmxvY2tfaXJxKCZlcGZpbGUtPmZmcy0+
ZXBzX2xvY2spOw0KKwlkbWFfZmVuY2VfcHV0KCZmZW5jZS0+YmFzZSk7DQorZXJyX3Jlc3ZfdW5s
b2NrOg0KKwlkbWFfcmVzdl91bmxvY2soZG1hYnVmLT5yZXN2KTsNCitlcnJfYXR0YWNobWVudF9w
dXQ6DQorCWZmc19kbWFidWZfcHV0KGF0dGFjaCk7DQorZXJyX2RtYWJ1Zl9wdXQ6DQorCWRtYV9i
dWZfcHV0KGRtYWJ1Zik7DQorDQorCXJldHVybiByZXQ7DQorfQ0KKw0KIHN0YXRpYyBsb25nIGZm
c19lcGZpbGVfaW9jdGwoc3RydWN0IGZpbGUgKmZpbGUsIHVuc2lnbmVkIGNvZGUsDQogCQkJICAg
ICB1bnNpZ25lZCBsb25nIHZhbHVlKQ0KIHsNCkBAIC0xMjkyLDYgKzE3MTksNDQgQEAgc3RhdGlj
IGxvbmcgZmZzX2VwZmlsZV9pb2N0bChzdHJ1Y3QgZmlsZSAqZmlsZSwgdW5zaWduZWQgY29kZSwN
CiAJaWYgKFdBUk5fT04oZXBmaWxlLT5mZnMtPnN0YXRlICE9IEZGU19BQ1RJVkUpKQ0KIAkJcmV0
dXJuIC1FTk9ERVY7DQogDQorCXN3aXRjaCAoY29kZSkgew0KKwljYXNlIEZVTkNUSU9ORlNfRE1B
QlVGX0FUVEFDSDoNCisJew0KKwkJaW50IGZkOw0KKw0KKwkJaWYgKGNvcHlfZnJvbV91c2VyKCZm
ZCwgKHZvaWQgX191c2VyICopdmFsdWUsIHNpemVvZihmZCkpKSB7DQorCQkJcmV0ID0gLUVGQVVM
VDsNCisJCQlicmVhazsNCisJCX0NCisNCisJCXJldHVybiBmZnNfZG1hYnVmX2F0dGFjaChmaWxl
LCBmZCk7DQorCX0NCisJY2FzZSBGVU5DVElPTkZTX0RNQUJVRl9ERVRBQ0g6DQorCXsNCisJCWlu
dCBmZDsNCisNCisJCWlmIChjb3B5X2Zyb21fdXNlcigmZmQsICh2b2lkIF9fdXNlciAqKXZhbHVl
LCBzaXplb2YoZmQpKSkgew0KKwkJCXJldCA9IC1FRkFVTFQ7DQorCQkJYnJlYWs7DQorCQl9DQor
DQorCQlyZXR1cm4gZmZzX2RtYWJ1Zl9kZXRhY2goZmlsZSwgZmQpOw0KKwl9DQorCWNhc2UgRlVO
Q1RJT05GU19ETUFCVUZfVFJBTlNGRVI6DQorCXsNCisJCXN0cnVjdCB1c2JfZmZzX2RtYWJ1Zl90
cmFuc2Zlcl9yZXEgcmVxOw0KKw0KKwkJaWYgKGNvcHlfZnJvbV91c2VyKCZyZXEsICh2b2lkIF9f
dXNlciAqKXZhbHVlLCBzaXplb2YocmVxKSkpIHsNCisJCQlyZXQgPSAtRUZBVUxUOw0KKwkJCWJy
ZWFrOw0KKwkJfQ0KKw0KKwkJcmV0dXJuIGZmc19kbWFidWZfdHJhbnNmZXIoZmlsZSwgJnJlcSk7
DQorCX0NCisJZGVmYXVsdDoNCisJCWJyZWFrOw0KKwl9DQorDQogCS8qIFdhaXQgZm9yIGVuZHBv
aW50IHRvIGJlIGVuYWJsZWQgKi8NCiAJZXAgPSBmZnNfZXBmaWxlX3dhaXRfZXAoZmlsZSk7DQog
CWlmIChJU19FUlIoZXApKQ0KQEAgLTE4NjksNiArMjMzNCw4IEBAIHN0YXRpYyBpbnQgZmZzX2Vw
ZmlsZXNfY3JlYXRlKHN0cnVjdCBmZnNfZGF0YSAqZmZzKQ0KIAlmb3IgKGkgPSAxOyBpIDw9IGNv
dW50OyArK2ksICsrZXBmaWxlKSB7DQogCQllcGZpbGUtPmZmcyA9IGZmczsNCiAJCW11dGV4X2lu
aXQoJmVwZmlsZS0+bXV0ZXgpOw0KKwkJbXV0ZXhfaW5pdCgmZXBmaWxlLT5kbWFidWZzX211dGV4
KTsNCisJCUlOSVRfTElTVF9IRUFEKCZlcGZpbGUtPmRtYWJ1ZnMpOw0KIAkJaWYgKGZmcy0+dXNl
cl9mbGFncyAmIEZVTkNUSU9ORlNfVklSVFVBTF9BRERSKQ0KIAkJCXNwcmludGYoZXBmaWxlLT5u
YW1lLCAiZXAlMDJ4IiwgZmZzLT5lcHNfYWRkcm1hcFtpXSk7DQogCQllbHNlDQpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS91YXBpL2xpbnV4L3VzYi9mdW5jdGlvbmZzLmggYi9pbmNsdWRlL3VhcGkvbGlu
dXgvdXNiL2Z1bmN0aW9uZnMuaA0KaW5kZXggMDc4MDk4ZTczZmQzLi45Zjg4ZGU5YzNkNjYgMTAw
NjQ0DQotLS0gYS9pbmNsdWRlL3VhcGkvbGludXgvdXNiL2Z1bmN0aW9uZnMuaA0KKysrIGIvaW5j
bHVkZS91YXBpL2xpbnV4L3VzYi9mdW5jdGlvbmZzLmgNCkBAIC04Niw2ICs4NiwyMiBAQCBzdHJ1
Y3QgdXNiX2V4dF9wcm9wX2Rlc2Mgew0KIAlfX2xlMTYJd1Byb3BlcnR5TmFtZUxlbmd0aDsNCiB9
IF9fYXR0cmlidXRlX18oKHBhY2tlZCkpOw0KIA0KKy8qIEZsYWdzIGZvciB1c2JfZmZzX2RtYWJ1
Zl90cmFuc2Zlcl9yZXEtPmZsYWdzIChub25lIGZvciBub3cpICovDQorI2RlZmluZSBVU0JfRkZT
X0RNQUJVRl9UUkFOU0ZFUl9NQVNLCTB4MA0KKw0KKy8qKg0KKyAqIHN0cnVjdCB1c2JfZmZzX2Rt
YWJ1Zl90cmFuc2Zlcl9yZXEgLSBUcmFuc2ZlciByZXF1ZXN0IGZvciBhIERNQUJVRiBvYmplY3QN
CisgKiBAZmQ6CQlmaWxlIGRlc2NyaXB0b3Igb2YgdGhlIERNQUJVRiBvYmplY3QNCisgKiBAZmxh
Z3M6CW9uZSBvciBtb3JlIFVTQl9GRlNfRE1BQlVGX1RSQU5TRkVSXyogZmxhZ3MNCisgKiBAbGVu
Z3RoOgludW1iZXIgb2YgYnl0ZXMgdXNlZCBpbiB0aGlzIERNQUJVRiBmb3IgdGhlIGRhdGEgdHJh
bnNmZXIuDQorICoJCVNob3VsZCBnZW5lcmFsbHkgYmUgc2V0IHRvIHRoZSBETUFCVUYncyBzaXpl
Lg0KKyAqLw0KK3N0cnVjdCB1c2JfZmZzX2RtYWJ1Zl90cmFuc2Zlcl9yZXEgew0KKwlpbnQgZmQ7
DQorCV9fdTMyIGZsYWdzOw0KKwlfX3U2NCBsZW5ndGg7DQorfSBfX2F0dHJpYnV0ZV9fKChwYWNr
ZWQpKTsNCisNCiAjaWZuZGVmIF9fS0VSTkVMX18NCiANCiAvKg0KQEAgLTI5MCw2ICszMDYsMzEg
QEAgc3RydWN0IHVzYl9mdW5jdGlvbmZzX2V2ZW50IHsNCiAjZGVmaW5lCUZVTkNUSU9ORlNfRU5E
UE9JTlRfREVTQwlfSU9SKCdnJywgMTMwLCBcDQogCQkJCQkgICAgIHN0cnVjdCB1c2JfZW5kcG9p
bnRfZGVzY3JpcHRvcikNCiANCisvKg0KKyAqIEF0dGFjaCB0aGUgRE1BQlVGIG9iamVjdCwgaWRl
bnRpZmllZCBieSBpdHMgZmlsZSBkZXNjcmlwdG9yLCB0byB0aGUNCisgKiBkYXRhIGVuZHBvaW50
LiBSZXR1cm5zIHplcm8gb24gc3VjY2VzcywgYW5kIGEgbmVnYXRpdmUgZXJybm8gdmFsdWUNCisg
KiBvbiBlcnJvci4NCisgKi8NCisjZGVmaW5lIEZVTkNUSU9ORlNfRE1BQlVGX0FUVEFDSAlfSU9X
KCdnJywgMTMxLCBpbnQpDQorDQogDQorLyoNCisgKiBEZXRhY2ggdGhlIGdpdmVuIERNQUJVRiBv
YmplY3QsIGlkZW50aWZpZWQgYnkgaXRzIGZpbGUgZGVzY3JpcHRvciwNCisgKiBmcm9tIHRoZSBk
YXRhIGVuZHBvaW50LiBSZXR1cm5zIHplcm8gb24gc3VjY2VzcywgYW5kIGEgbmVnYXRpdmUNCisg
KiBlcnJubyB2YWx1ZSBvbiBlcnJvci4gTm90ZSB0aGF0IGNsb3NpbmcgdGhlIGVuZHBvaW50J3Mg
ZmlsZQ0KKyAqIGRlc2NyaXB0b3Igd2lsbCBhdXRvbWF0aWNhbGx5IGRldGFjaCBhbGwgYXR0YWNo
ZWQgRE1BQlVGcy4NCisgKi8NCisjZGVmaW5lIEZVTkNUSU9ORlNfRE1BQlVGX0RFVEFDSAlfSU9X
KCdnJywgMTMyLCBpbnQpDQorDQorLyoNCisgKiBFbnF1ZXVlIHRoZSBwcmV2aW91c2x5IGF0dGFj
aGVkIERNQUJVRiB0byB0aGUgdHJhbnNmZXIgcXVldWUuDQorICogVGhlIGFyZ3VtZW50IGlzIGEg
c3RydWN0dXJlIHRoYXQgcGFja3MgdGhlIERNQUJVRidzIGZpbGUgZGVzY3JpcHRvciwNCisgKiB0
aGUgc2l6ZSBpbiBieXRlcyB0byB0cmFuc2ZlciAod2hpY2ggc2hvdWxkIGdlbmVyYWxseSBjb3Jy
ZXNwb25kIHRvDQorICogdGhlIHNpemUgb2YgdGhlIERNQUJVRiksIGFuZCBhICdmbGFncycgZmll
bGQgd2hpY2ggaXMgdW51c2VkDQorICogZm9yIG5vdy4gUmV0dXJucyB6ZXJvIG9uIHN1Y2Nlc3Ms
IGFuZCBhIG5lZ2F0aXZlIGVycm5vIHZhbHVlIG9uDQorICogZXJyb3IuDQorICovDQorI2RlZmlu
ZSBGVU5DVElPTkZTX0RNQUJVRl9UUkFOU0ZFUglfSU9XKCdnJywgMTMzLCBcDQorCQkJCQkgICAg
IHN0cnVjdCB1c2JfZmZzX2RtYWJ1Zl90cmFuc2Zlcl9yZXEpDQogDQogI2VuZGlmIC8qIF9VQVBJ
X19MSU5VWF9GVU5DVElPTkZTX0hfXyAqLw0KLS0gDQoyLjQzLjANCg0KX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxp
c3QgLS0gbGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQg
YW4gZW1haWwgdG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
