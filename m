Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 9A3A29E196C
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  3 Dec 2024 11:36:07 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id A74264423B
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  3 Dec 2024 10:36:06 +0000 (UTC)
Received: from mail-ua1-f42.google.com (mail-ua1-f42.google.com [209.85.222.42])
	by lists.linaro.org (Postfix) with ESMTPS id 1EEC640D0F
	for <linaro-mm-sig@lists.linaro.org>; Tue,  3 Dec 2024 10:35:49 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linaro.org header.s=google header.b=QJKapy5n;
	spf=pass (lists.linaro.org: domain of sumit.garg@linaro.org designates 209.85.222.42 as permitted sender) smtp.mailfrom=sumit.garg@linaro.org;
	dmarc=pass (policy=none) header.from=linaro.org
Received: by mail-ua1-f42.google.com with SMTP id a1e0cc1a2514c-85bad9e0214so561865241.3
        for <linaro-mm-sig@lists.linaro.org>; Tue, 03 Dec 2024 02:35:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google; t=1733222148; x=1733826948; darn=lists.linaro.org;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:from:to:cc:subject:date
         :message-id:reply-to;
        bh=Mhcd8tztzrsmrTpDpmUC17ZGpaAP23msF4wpZXXLsYA=;
        b=QJKapy5n+FRN7l+ZYotKOO4fFLzKTewYhBguRR0MVjCzJ2/63BF0zjSYnBhtyF17Hp
         3gf15u2UKXy8tki/2D4ueVMJGAMkcr+NgEWuOrdfBTNMz9aB0WNS76gHO9kYKOsnNE9z
         hsFVc0SLDyumayx56tgKaJeyKUZA90pWzV/HDenL5RSBj47SKJT6fgp2h4TpS0rNDIDZ
         lUCXMpHsmtHqAZ+dT18YQC7Uv0AhXGKqh9J0oL1fAg3+2pLZncV++GGqXt6yTkthu/DK
         iU5hOyq3qbb9ptRS2cWQtc98giDdz6u1HfjB5alQyFeWybPNoSLOzumqpUhlbILWcCbE
         KGng==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1733222148; x=1733826948;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=Mhcd8tztzrsmrTpDpmUC17ZGpaAP23msF4wpZXXLsYA=;
        b=En9z3nZT4/0rA6yyBfLxq90/+k2NTw9cayOBlC3GxuQwzzRpbbEq4haq68JmypYsuK
         B0l76Pedp9/lS8jmF/rmWHTjFPxRYUQag9jebDKJIHEDyKtHWhoW76j4f731FKaMlrOT
         ib7X0MNdKqjX6ybvYoDUmD5Y1yHt6hRZAl1vVURAMRgnr4ZCVrzulSuEtlLliE3X3uIy
         mtp45CuxOLwrRmodtnnoFmOCFOQaZ27eBd4t1F1Tx6Y/4F1oP6KOeiRj3qTi+vHpoGlN
         3bo68h4MIEegg+GlxA0vmGkN0CF+LxkkpaYPu8vkPFpqDRaNhzEZ32MaN/steVrJEHy/
         c/wQ==
X-Forwarded-Encrypted: i=1; AJvYcCWkqHBvgIvq8HBqr4rsWq7TCwx/npQ5M2PiWNLYd1VKn8ggrgRWKgNYqlcgC10+3ZT8jFS5n8LTqRabINh9@lists.linaro.org
X-Gm-Message-State: AOJu0Yx8UmHBBHiPNg+ow78IjPxZVGGkLQZSbggaW9gcTJkI3rZPiiY1
	glF1GXDM3JOGAXUaL7ONB7YPKOBQ/IxSOifNFBTCRb6BLaenzbqpk0Sp2T6K/Aa+4eJD02eeT9c
	A0H7s89I8JnxCltdF0mO7rddckRSB6a70Kdwk64BF
X-Gm-Gg: ASbGncvlOoKKdzN+SvUctB+GocTkPXBDjORVqmbAHGJ3k4FCLPD7wYGm2uSq2Z7K2kr
	cvFdaCkl2GQ0TM1sb/4cu/zfqEDszA9OBqw==
X-Google-Smtp-Source: AGHT+IGS5QRdKZKgvFetcUI6SJ/XQoEF4YoWpYvC25d7VilnMb7bCdwwJFJte6YnS2v3sC+E4tET6IdKyVvzSDI6XjE=
X-Received: by 2002:a05:6102:5111:b0:4af:4d78:4b61 with SMTP id
 ada2fe7eead31-4af971ad0bfmr2955304137.10.1733222148485; Tue, 03 Dec 2024
 02:35:48 -0800 (PST)
MIME-Version: 1.0
References: <20241128150927.1377981-1-jens.wiklander@linaro.org>
 <20241128150927.1377981-3-jens.wiklander@linaro.org> <CAFA6WYPEqCWyvD=pCj6DEkZWN9SCfXMnq4tKbSx1-e8UmgXb=Q@mail.gmail.com>
 <CAHUa44H0go3fSMt_jreWz4EQgYvo8GOZ5woc-x5Cyi680oWZWw@mail.gmail.com>
In-Reply-To: <CAHUa44H0go3fSMt_jreWz4EQgYvo8GOZ5woc-x5Cyi680oWZWw@mail.gmail.com>
From: Sumit Garg <sumit.garg@linaro.org>
Date: Tue, 3 Dec 2024 16:05:37 +0530
Message-ID: <CAFA6WYNJQEjs29AniqC7mdmo7Fe+fCmW1kFcJ1Z2HSjQQ36LBw@mail.gmail.com>
To: Jens Wiklander <jens.wiklander@linaro.org>
X-Rspamd-Queue-Id: 1EEC640D0F
X-Spamd-Bar: ------
X-Spamd-Result: default: False [-6.50 / 15.00];
	REPLY(-4.00)[];
	BAYES_HAM(-3.00)[100.00%];
	SUSPICIOUS_RECIPS(1.50)[];
	DMARC_POLICY_ALLOW(-0.50)[linaro.org,none];
	R_DKIM_ALLOW(-0.20)[linaro.org:s=google];
	R_SPF_ALLOW(-0.20)[+ip4:209.85.128.0/17];
	MIME_GOOD(-0.10)[text/plain];
	FREEMAIL_CC(0.00)[vger.kernel.org,lists.freedesktop.org,lists.linaro.org,lists.trustedfirmware.org,lists.infradead.org,nxp.com,gmail.com,mediatek.com,linaro.org,collabora.com,arm.com,google.com,amd.com,qti.qualcomm.com];
	FROM_HAS_DN(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	ARC_NA(0.00)[];
	DKIM_TRACE(0.00)[linaro.org:+];
	MIME_TRACE(0.00)[0:+];
	MISSING_XM_UA(0.00)[];
	RCVD_COUNT_ONE(0.00)[1];
	ASN(0.00)[asn:15169, ipnet:209.85.128.0/17, country:US];
	DNSWL_BLOCKED(0.00)[209.85.222.42:from];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	RCPT_COUNT_TWELVE(0.00)[19];
	PREVIOUSLY_DELIVERED(0.00)[linaro-mm-sig@lists.linaro.org];
	TAGGED_RCPT(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	RBL_SENDERSCORE_REPUT_8(0.00)[209.85.222.42:from];
	RWL_MAILSPIKE_POSSIBLE(0.00)[209.85.222.42:from];
	TO_DN_SOME(0.00)[]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
Message-ID-Hash: LRJCZRNP5KZ7PWQWBBCGON6TYEGTQXZQ
X-Message-ID-Hash: LRJCZRNP5KZ7PWQWBBCGON6TYEGTQXZQ
X-MailFrom: sumit.garg@linaro.org
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: linux-kernel@vger.kernel.org, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, op-tee@lists.trustedfirmware.org, linux-arm-kernel@lists.infradead.org, Olivier Masse <olivier.masse@nxp.com>, Thierry Reding <thierry.reding@gmail.com>, Yong Wu <yong.wu@mediatek.com>, Sumit Semwal <sumit.semwal@linaro.org>, Benjamin Gaignard <benjamin.gaignard@collabora.com>, Brian Starkey <Brian.Starkey@arm.com>, John Stultz <jstultz@google.com>, "T . J . Mercier" <tjmercier@google.com>, =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>, Matthias Brugger <matthias.bgg@gmail.com>, AngeloGioacchino Del Regno <angelogioacchino.delregno@collabora.com>, azarrabi@qti.qualcomm.com
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] Re: [PATCH v3 2/4] optee: account for direction while converting parameters
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/LRJCZRNP5KZ7PWQWBBCGON6TYEGTQXZQ/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

T24gVHVlLCAzIERlYyAyMDI0IGF0IDE1OjU4LCBKZW5zIFdpa2xhbmRlciA8amVucy53aWtsYW5k
ZXJAbGluYXJvLm9yZz4gd3JvdGU6DQo+DQo+IEhpIFN1bWl0LA0KPg0KPiBPbiBUdWUsIERlYyAz
LCAyMDI0IGF0IDk6MjfigK9BTSBTdW1pdCBHYXJnIDxzdW1pdC5nYXJnQGxpbmFyby5vcmc+IHdy
b3RlOg0KPiA+DQo+ID4gSGkgSmVucywNCj4gPg0KPiA+IE9uIFRodSwgMjggTm92IDIwMjQgYXQg
MjA6MzksIEplbnMgV2lrbGFuZGVyIDxqZW5zLndpa2xhbmRlckBsaW5hcm8ub3JnPiB3cm90ZToN
Cj4gPiA+DQo+ID4gPiBUaGUgT1AtVEVFIGJhY2tlbmQgZHJpdmVyIGhhcyB0d28gaW50ZXJuYWwg
ZnVuY3Rpb24gcG9pbnRlcnMgdG8gY29udmVydA0KPiA+ID4gYmV0d2VlbiB0aGUgc3Vic3lzdGVt
IHR5cGUgc3RydWN0IHRlZV9wYXJhbSBhbmQgdGhlIE9QLVRFRSB0eXBlIHN0cnVjdA0KPiA+ID4g
b3B0ZWVfbXNnX3BhcmFtLg0KPiA+ID4NCj4gPiA+IFRoZSBjb252ZXJzaW9uIGlzIGRvbmUgZnJv
bSBvbmUgb2YgdGhlIHR5cGVzIHRvIHRoZSBvdGhlciwgd2hpY2ggaXMgdGhlbg0KPiA+ID4gaW52
b2x2ZWQgaW4gc29tZSBvcGVyYXRpb24gYW5kIGZpbmFsbHkgY29udmVydGVkIGJhY2sgdG8gdGhl
IG9yaWdpbmFsDQo+ID4gPiB0eXBlLiBXaGVuIGNvbnZlcnRpbmcgdG8gcHJlcGFyZSB0aGUgcGFy
YW1ldGVycyBmb3IgdGhlIG9wZXJhdGlvbiwgYWxsDQo+ID4gPiBmaWVsZHMgbXVzdCBiZSB0YWtl
biBpbnRvIGFjY291bnQsIGJ1dCB0aGVuIGNvbnZlcnRpbmcgYmFjaywgaXQncyBlbm91Z2gNCj4g
PiA+IHRvIHVwZGF0ZSBvbmx5IG91dC12YWx1ZXMgYW5kIG91dC1zaXplcy4gU28sIGFuIHVwZGF0
ZV9vdXQgcGFyYW1ldGVyIGlzDQo+ID4gPiBhZGRlZCB0byB0aGUgY29udmVyc2lvbiBmdW5jdGlv
bnMgdG8gdGVsbCBpZiBhbGwgb3Igb25seSBzb21lIGZpZWxkcw0KPiA+ID4gbXVzdCBiZSBjb3Bp
ZWQuDQo+ID4NCj4gPiBJcyB0aGlzIHBhdGNoIGp1c3QgYSByZWZhY3RvcmluZyBvZiBURUUgcGFy
YW1zIGhhbmRsaW5nPyBPciBhcmUgd2UNCj4gPiBmaXhpbmcgYSByZWFsIEFCSSBpc3N1ZSBoZXJl
PyBBbHNvLCBpcyB0aGlzIHJlcXVpcmVkIGZvciByZXN0cmljdGVkDQo+ID4gc2hhcmVkIG1lbW9y
eSBzdXBwb3J0IHRvIHdvcms/IEp1c3QgYXNraW5nIGlmIHdlIHdhbnQgdG8gY29uc2lkZXIgaXQN
Cj4gPiBhcyBhIGZpeCBmb3IgYmFja3BvcnRpbmcgb3IgaWYgd2UgY2FuIGhhbmRsZSB0aGlzIHJl
ZmFjdG9yaW5nIHBhdGNoDQo+ID4gaW5kZXBlbmRlbnRseSBvZiB0aGlzIHNlcmllcz8NCj4NCj4g
VGhpcyBpcyBuZWVkZWQgaW4gdGhpcyBzZXJpZXMuIFdpdGhvdXQgdGhpcyBwYXRjaCwgaXQgbWln
aHQgZ2V0DQo+IGNvbmZ1c2luZyB3aGVuIGNvbnZlcnRpbmcgYmFjayBpbiBmcm9tX21zZ19wYXJh
bSgpIGNhbGxiYWNrIHNpbmNlIGFuDQo+IGFsbG9jYXRlZCByZXN0cmljdGVkIFNITSBjYW4gYmUg
dXNpbmcgdGhlIHNlY193b3JsZF9pZCBvZiB0aGUgcG9vbCBhbmQNCj4gdGhhdCBkb2Vzbid0IHRy
YW5zbGF0ZSBiYWNrIHdlbGwuIHBhcmFtc190b191c2VyKCkgaW4NCj4gZHJpdmVycy90ZWUvdGVl
X2NvcmUuYyBhbHJlYWR5IHRha2VzIHRoZSBkaXJlY3Rpb24gaW50byBhY2NvdW50IHNvIGl0DQo+
IHdvdWxkbid0IHNwcmVhZCB0byB1c2VyLXNwYWNlLg0KDQpUaGFua3MgSmVucyBmb3IgdGhlIGNs
YXJpZmljYXRpb24sIGlmIHlvdSBjYW4gdXBkYXRlIHRoZSBjb21taXQgdGV4dA0KYWNjb3JkaW5n
bHkgd2lsbCBoZWxwIGNsYXJpZnkgdGhlIG1vdGl2YXRpb24gZm9yIHRoZSBjaGFuZ2UuDQoNCi1T
dW1pdA0KDQo+DQo+IENoZWVycywNCj4gSmVucw0KPg0KPiA+DQo+ID4gLVN1bWl0DQo+ID4NCj4g
PiA+DQo+ID4gPiBTaWduZWQtb2ZmLWJ5OiBKZW5zIFdpa2xhbmRlciA8amVucy53aWtsYW5kZXJA
bGluYXJvLm9yZz4NCj4gPiA+IC0tLQ0KPiA+ID4gIGRyaXZlcnMvdGVlL29wdGVlL2NhbGwuYyAg
ICAgICAgICB8IDEwICsrLS0NCj4gPiA+ICBkcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMgICAg
ICAgfCA0MyArKysrKysrKysrKysrLS0tLQ0KPiA+ID4gIGRyaXZlcnMvdGVlL29wdGVlL29wdGVl
X3ByaXZhdGUuaCB8IDQyICsrKysrKysrKysrLS0tLS0tDQo+ID4gPiAgZHJpdmVycy90ZWUvb3B0
ZWUvcnBjLmMgICAgICAgICAgIHwgMzEgKysrKysrKysrLS0tLQ0KPiA+ID4gIGRyaXZlcnMvdGVl
L29wdGVlL3NtY19hYmkuYyAgICAgICB8IDc2ICsrKysrKysrKysrKysrKysrKysrKysrLS0tLS0t
LS0NCj4gPiA+ICA1IGZpbGVzIGNoYW5nZWQsIDE0NCBpbnNlcnRpb25zKCspLCA1OCBkZWxldGlv
bnMoLSkNCj4gPiA+DQo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvb3B0ZWUvY2FsbC5j
IGIvZHJpdmVycy90ZWUvb3B0ZWUvY2FsbC5jDQo+ID4gPiBpbmRleCAxNmViOTUzZTE0YmIuLmYx
NTMzYjg5NDcyNiAxMDA2NDQNCj4gPiA+IC0tLSBhL2RyaXZlcnMvdGVlL29wdGVlL2NhbGwuYw0K
PiA+ID4gKysrIGIvZHJpdmVycy90ZWUvb3B0ZWUvY2FsbC5jDQo+ID4gPiBAQCAtNDAwLDcgKzQw
MCw4IEBAIGludCBvcHRlZV9vcGVuX3Nlc3Npb24oc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsDQo+
ID4gPiAgICAgICAgIGV4cG9ydF91dWlkKG1zZ19hcmctPnBhcmFtc1sxXS51Lm9jdGV0cywgJmNs
aWVudF91dWlkKTsNCj4gPiA+DQo+ID4gPiAgICAgICAgIHJjID0gb3B0ZWUtPm9wcy0+dG9fbXNn
X3BhcmFtKG9wdGVlLCBtc2dfYXJnLT5wYXJhbXMgKyAyLA0KPiA+ID4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBhcmctPm51bV9wYXJhbXMsIHBhcmFtKTsNCj4gPiA+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJh
bSwNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFsc2UgLyoh
dXBkYXRlX291dCovKTsNCj4gPiA+ICAgICAgICAgaWYgKHJjKQ0KPiA+ID4gICAgICAgICAgICAg
ICAgIGdvdG8gb3V0Ow0KPiA+ID4NCj4gPiA+IEBAIC00MjcsNyArNDI4LDggQEAgaW50IG9wdGVl
X29wZW5fc2Vzc2lvbihzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwNCj4gPiA+ICAgICAgICAgfQ0K
PiA+ID4NCj4gPiA+ICAgICAgICAgaWYgKG9wdGVlLT5vcHMtPmZyb21fbXNnX3BhcmFtKG9wdGVl
LCBwYXJhbSwgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFyYW1zICsgMikpIHsNCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZ19hcmctPnBhcmFtcyArIDIsDQo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnVlIC8qdXBkYXRlX291dCov
KSkgew0KPiA+ID4gICAgICAgICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9DT01NVU5J
Q0FUSU9OOw0KPiA+ID4gICAgICAgICAgICAgICAgIGFyZy0+cmV0X29yaWdpbiA9IFRFRUNfT1JJ
R0lOX0NPTU1TOw0KPiA+ID4gICAgICAgICAgICAgICAgIC8qIENsb3NlIHNlc3Npb24gYWdhaW4g
dG8gYXZvaWQgbGVha2FnZSAqLw0KPiA+ID4gQEAgLTU0MSw3ICs1NDMsNyBAQCBpbnQgb3B0ZWVf
aW52b2tlX2Z1bmMoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsIHN0cnVjdCB0ZWVfaW9jdGxfaW52
b2tlX2FyZyAqYXJnLA0KPiA+ID4gICAgICAgICBtc2dfYXJnLT5jYW5jZWxfaWQgPSBhcmctPmNh
bmNlbF9pZDsNCj4gPiA+DQo+ID4gPiAgICAgICAgIHJjID0gb3B0ZWUtPm9wcy0+dG9fbXNnX3Bh
cmFtKG9wdGVlLCBtc2dfYXJnLT5wYXJhbXMsIGFyZy0+bnVtX3BhcmFtcywNCj4gPiA+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyYW0pOw0KPiA+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbSwgZmFsc2UgLyohdXBkYXRlX291dCov
KTsNCj4gPiA+ICAgICAgICAgaWYgKHJjKQ0KPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gb3V0
Ow0KPiA+ID4NCj4gPiA+IEBAIC01NTEsNyArNTUzLDcgQEAgaW50IG9wdGVlX2ludm9rZV9mdW5j
KHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4LCBzdHJ1Y3QgdGVlX2lvY3RsX2ludm9rZV9hcmcgKmFy
ZywNCj4gPiA+ICAgICAgICAgfQ0KPiA+ID4NCj4gPiA+ICAgICAgICAgaWYgKG9wdGVlLT5vcHMt
PmZyb21fbXNnX3BhcmFtKG9wdGVlLCBwYXJhbSwgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFyYW1zKSkgew0K
PiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnX2FyZy0+cGFy
YW1zLCB0cnVlIC8qdXBkYXRlX291dCovKSkgew0KPiA+ID4gICAgICAgICAgICAgICAgIG1zZ19h
cmctPnJldCA9IFRFRUNfRVJST1JfQ09NTVVOSUNBVElPTjsNCj4gPiA+ICAgICAgICAgICAgICAg
ICBtc2dfYXJnLT5yZXRfb3JpZ2luID0gVEVFQ19PUklHSU5fQ09NTVM7DQo+ID4gPiAgICAgICAg
IH0NCj4gPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMgYi9kcml2
ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMNCj4gPiA+IGluZGV4IGYzYWY1NjY2YmIxMS4uMDJlNjE3
NWFjNWYwIDEwMDY0NA0KPiA+ID4gLS0tIGEvZHJpdmVycy90ZWUvb3B0ZWUvZmZhX2FiaS5jDQo+
ID4gPiArKysgYi9kcml2ZXJzL3RlZS9vcHRlZS9mZmFfYWJpLmMNCj4gPiA+IEBAIC0xMjIsMTUg
KzEyMiwyMSBAQCBzdGF0aWMgaW50IG9wdGVlX3NobV9yZW1fZmZhX2hhbmRsZShzdHJ1Y3Qgb3B0
ZWUgKm9wdGVlLCB1NjQgZ2xvYmFsX2lkKQ0KPiA+ID4gICAqLw0KPiA+ID4NCj4gPiA+ICBzdGF0
aWMgdm9pZCBmcm9tX21zZ19wYXJhbV9mZmFfbWVtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsIHN0cnVj
dCB0ZWVfcGFyYW0gKnAsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHUzMiBhdHRyLCBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCkNCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdTMyIGF0dHIsIGNvbnN0IHN0cnVjdCBvcHRl
ZV9tc2dfcGFyYW0gKm1wLA0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBib29sIHVwZGF0ZV9vdXQpDQo+ID4gPiAgew0KPiA+ID4gICAgICAgICBzdHJ1Y3QgdGVlX3No
bSAqc2htID0gTlVMTDsNCj4gPiA+ICAgICAgICAgdTY0IG9mZnNfaGlnaCA9IDA7DQo+ID4gPiAg
ICAgICAgIHU2NCBvZmZzX2xvdyA9IDA7DQo+ID4gPg0KPiA+ID4gKyAgICAgICBpZiAodXBkYXRl
X291dCkgew0KPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChhdHRyID09IE9QVEVFX01TR19BVFRS
X1RZUEVfRk1FTV9JTlBVVCkNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsN
Cj4gPiA+ICsgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiA+ICsgICAgICAgfQ0KPiA+ID4g
Kw0KPiA+ID4gICAgICAgICBwLT5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1S
RUZfSU5QVVQgKw0KPiA+ID4gICAgICAgICAgICAgICAgICAgYXR0ciAtIE9QVEVFX01TR19BVFRS
X1RZUEVfRk1FTV9JTlBVVDsNCj4gPiA+IC0gICAgICAgcC0+dS5tZW1yZWYuc2l6ZSA9IG1wLT51
LmZtZW0uc2l6ZTsNCj4gPiA+DQo+ID4gPiAgICAgICAgIGlmIChtcC0+dS5mbWVtLmdsb2JhbF9p
ZCAhPSBPUFRFRV9NU0dfRk1FTV9JTlZBTElEX0dMT0JBTF9JRCkNCj4gPiA+ICAgICAgICAgICAg
ICAgICBzaG0gPSBvcHRlZV9zaG1fZnJvbV9mZmFfaGFuZGxlKG9wdGVlLCBtcC0+dS5mbWVtLmds
b2JhbF9pZCk7DQo+ID4gPiBAQCAtMTQxLDYgKzE0Nyw4IEBAIHN0YXRpYyB2b2lkIGZyb21fbXNn
X3BhcmFtX2ZmYV9tZW0oc3RydWN0IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAqcCwN
Cj4gPiA+ICAgICAgICAgICAgICAgICBvZmZzX2hpZ2ggPSBtcC0+dS5mbWVtLm9mZnNfaGlnaDsN
Cj4gPiA+ICAgICAgICAgfQ0KPiA+ID4gICAgICAgICBwLT51Lm1lbXJlZi5zaG1fb2ZmcyA9IG9m
ZnNfbG93IHwgb2Zmc19oaWdoIDw8IDMyOw0KPiA+ID4gK291dDoNCj4gPiA+ICsgICAgICAgcC0+
dS5tZW1yZWYuc2l6ZSA9IG1wLT51LmZtZW0uc2l6ZTsNCj4gPiA+ICB9DQo+ID4gPg0KPiA+ID4g
IC8qKg0KPiA+ID4gQEAgLTE1MCwxMiArMTU4LDE0IEBAIHN0YXRpYyB2b2lkIGZyb21fbXNnX3Bh
cmFtX2ZmYV9tZW0oc3RydWN0IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAqcCwNCj4g
PiA+ICAgKiBAcGFyYW1zOiAgICBzdWJzeXN0ZW0gaW50ZXJuYWwgcGFyYW1ldGVyIHJlcHJlc2Vu
dGF0aW9uDQo+ID4gPiAgICogQG51bV9wYXJhbXM6ICAgICAgICBudW1iZXIgb2YgZWxlbWVudHMg
aW4gdGhlIHBhcmFtZXRlciBhcnJheXMNCj4gPiA+ICAgKiBAbXNnX3BhcmFtczogICAgICAgIE9Q
VEVFX01TRyBwYXJhbWV0ZXJzDQo+ID4gPiArICogQHVwZGF0ZV9vdXQ6IHVwZGF0ZSBwYXJhbWV0
ZXIgZm9yIG91dHB1dCBvbmx5DQo+ID4gPiAgICoNCj4gPiA+ICAgKiBSZXR1cm5zIDAgb24gc3Vj
Y2VzcyBvciA8MCBvbiBmYWlsdXJlDQo+ID4gPiAgICovDQo+ID4gPiAgc3RhdGljIGludCBvcHRl
ZV9mZmFfZnJvbV9tc2dfcGFyYW0oc3RydWN0IG9wdGVlICpvcHRlZSwNCj4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcywgc2l6
ZV90IG51bV9wYXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptc2dfcGFyYW1zKQ0KPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJh
bSAqbXNnX3BhcmFtcywNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ICB7DQo+ID4gPiAgICAgICAgIHNpemVfdCBuOw0KPiA+
ID4NCj4gPiA+IEBAIC0xNjYsMTggKzE3NiwyMCBAQCBzdGF0aWMgaW50IG9wdGVlX2ZmYV9mcm9t
X21zZ19wYXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4NCj4gPiA+ICAgICAgICAgICAg
ICAgICBzd2l0Y2ggKGF0dHIpIHsNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01T
R19BVFRSX1RZUEVfTk9ORToNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICh1cGRh
dGVfb3V0KQ0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4g
PiA+ICAgICAgICAgICAgICAgICAgICAgICAgIHAtPmF0dHIgPSBURUVfSU9DVExfUEFSQU1fQVRU
Ul9UWVBFX05PTkU7DQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBtZW1zZXQoJnAtPnUs
IDAsIHNpemVvZihwLT51KSk7DQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsN
Cj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfVkFMVUVfSU5Q
VVQ6DQo+ID4gPiAgICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVF
X09VVFBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVf
VkFMVUVfSU5PVVQ6DQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV9mcm9tX21z
Z19wYXJhbV92YWx1ZShwLCBhdHRyLCBtcCk7DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAg
ICBvcHRlZV9mcm9tX21zZ19wYXJhbV92YWx1ZShwLCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gPiA+ICAgICAgICAgICAgICAg
ICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9JTlBVVDoNCj4gPiA+ICAgICAgICAgICAg
ICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfRk1FTV9PVVRQVVQ6DQo+ID4gPiAgICAgICAg
ICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9UWVBFX0ZNRU1fSU5PVVQ6DQo+ID4gPiAtICAg
ICAgICAgICAgICAgICAgICAgICBmcm9tX21zZ19wYXJhbV9mZmFfbWVtKG9wdGVlLCBwLCBhdHRy
LCBtcCk7DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBmcm9tX21zZ19wYXJhbV9mZmFf
bWVtKG9wdGVlLCBwLCBhdHRyLCBtcCwgdXBkYXRlX291dCk7DQo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICBicmVhazsNCj4gPiA+ICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ID4gPiBAQCAtMTg4LDEw
ICsyMDAsMTYgQEAgc3RhdGljIGludCBvcHRlZV9mZmFfZnJvbV9tc2dfcGFyYW0oc3RydWN0IG9w
dGVlICpvcHRlZSwNCj4gPiA+ICB9DQo+ID4gPg0KPiA+ID4gIHN0YXRpYyBpbnQgdG9fbXNnX3Bh
cmFtX2ZmYV9tZW0oc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gPiAtICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnApDQo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnAs
IGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ICB7DQo+ID4gPiAgICAgICAgIHN0cnVjdCB0ZWVfc2ht
ICpzaG0gPSBwLT51Lm1lbXJlZi5zaG07DQo+ID4gPg0KPiA+ID4gKyAgICAgICBpZiAodXBkYXRl
X291dCkgew0KPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChwLT5hdHRyID09IFRFRV9JT0NUTF9Q
QVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOUFVUKQ0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAg
ICAgcmV0dXJuIDA7DQo+ID4gPiArICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gPiArICAg
ICAgIH0NCj4gPiA+ICsNCj4gPiA+ICAgICAgICAgbXAtPmF0dHIgPSBPUFRFRV9NU0dfQVRUUl9U
WVBFX0ZNRU1fSU5QVVQgKyBwLT5hdHRyIC0NCj4gPiA+ICAgICAgICAgICAgICAgICAgICBURUVf
SU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVDsNCj4gPiA+DQo+ID4gPiBAQCAtMjEx
LDYgKzIyOSw3IEBAIHN0YXRpYyBpbnQgdG9fbXNnX3BhcmFtX2ZmYV9tZW0oc3RydWN0IG9wdGVl
X21zZ19wYXJhbSAqbXAsDQo+ID4gPiAgICAgICAgICAgICAgICAgbWVtc2V0KCZtcC0+dSwgMCwg
c2l6ZW9mKG1wLT51KSk7DQo+ID4gPiAgICAgICAgICAgICAgICAgbXAtPnUuZm1lbS5nbG9iYWxf
aWQgPSBPUFRFRV9NU0dfRk1FTV9JTlZBTElEX0dMT0JBTF9JRDsNCj4gPiA+ICAgICAgICAgfQ0K
PiA+ID4gK291dDoNCj4gPiA+ICAgICAgICAgbXAtPnUuZm1lbS5zaXplID0gcC0+dS5tZW1yZWYu
c2l6ZTsNCj4gPiA+DQo+ID4gPiAgICAgICAgIHJldHVybiAwOw0KPiA+ID4gQEAgLTIyMiwxMyAr
MjQxLDE1IEBAIHN0YXRpYyBpbnQgdG9fbXNnX3BhcmFtX2ZmYV9tZW0oc3RydWN0IG9wdGVlX21z
Z19wYXJhbSAqbXAsDQo+ID4gPiAgICogQG9wdGVlOiAgICAgbWFpbiBzZXJ2aWNlIHN0cnVjdA0K
PiA+ID4gICAqIEBtc2dfcGFyYW1zOiAgICAgICAgT1BURUVfTVNHIHBhcmFtZXRlcnMNCj4gPiA+
ICAgKiBAbnVtX3BhcmFtczogICAgICAgIG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgcGFyYW1l
dGVyIGFycmF5cw0KPiA+ID4gLSAqIEBwYXJhbXM6ICAgIHN1YnN5c3RlbSBpdG5lcm5hbCBwYXJh
bWV0ZXIgcmVwcmVzZW50YXRpb24NCj4gPiA+ICsgKiBAcGFyYW1zOiAgICBzdWJzeXN0ZW0gaW50
ZXJuYWwgcGFyYW1ldGVyIHJlcHJlc2VudGF0aW9uDQo+ID4gPiArICogQHVwZGF0ZV9vdXQ6IHVw
ZGF0ZSBwYXJhbWV0ZXIgZm9yIG91dHB1dCBvbmx5DQo+ID4gPiAgICogUmV0dXJucyAwIG9uIHN1
Y2Nlc3Mgb3IgPDAgb24gZmFpbHVyZQ0KPiA+ID4gICAqLw0KPiA+ID4gIHN0YXRpYyBpbnQgb3B0
ZWVfZmZhX3RvX21zZ19wYXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJh
bXMsDQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bV9w
YXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3Ry
dWN0IHRlZV9wYXJhbSAqcGFyYW1zKQ0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcywNCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpDQo+ID4gPiAgew0KPiA+ID4g
ICAgICAgICBzaXplX3QgbjsNCj4gPiA+DQo+ID4gPiBAQCAtMjM4LDE4ICsyNTksMjAgQEAgc3Rh
dGljIGludCBvcHRlZV9mZmFfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4g
Pg0KPiA+ID4gICAgICAgICAgICAgICAgIHN3aXRjaCAocC0+YXR0cikgew0KPiA+ID4gICAgICAg
ICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOg0KPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKHVwZGF0ZV9vdXQpDQo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAg
bXAtPmF0dHIgPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX05PTkU7DQo+ID4gPiAgICAgICAg
ICAgICAgICAgICAgICAgICBtZW1zZXQoJm1wLT51LCAwLCBzaXplb2YobXAtPnUpKTsNCj4gPiA+
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gICAgICAgICAgICAgICAgIGNh
c2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTlBVVDoNCj4gPiA+ICAgICAgICAg
ICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUOg0KPiA+
ID4gICAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9J
Tk9VVDoNCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIG9wdGVlX3RvX21zZ19wYXJhbV92
YWx1ZShtcCwgcCk7DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV90b19tc2df
cGFyYW1fdmFsdWUobXAsIHAsIHVwZGF0ZV9vdXQpOw0KPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgYnJlYWs7DQo+ID4gPiAgICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1f
QVRUUl9UWVBFX01FTVJFRl9JTlBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVDoNCj4gPiA+ICAgICAgICAgICAgICAg
ICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOT1VUOg0KPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgaWYgKHRvX21zZ19wYXJhbV9mZmFfbWVtKG1wLCBwKSkNCj4g
PiA+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICh0b19tc2dfcGFyYW1fZmZhX21lbShtcCwg
cCwgdXBkYXRlX291dCkpDQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOw0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4g
PiAgICAgICAgICAgICAgICAgZGVmYXVsdDoNCj4gPiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3Rl
ZS9vcHRlZS9vcHRlZV9wcml2YXRlLmggYi9kcml2ZXJzL3RlZS9vcHRlZS9vcHRlZV9wcml2YXRl
LmgNCj4gPiA+IGluZGV4IGRjMGYzNTVlZjcyYS4uMjBlZGE1MDhkYmFjIDEwMDY0NA0KPiA+ID4g
LS0tIGEvZHJpdmVycy90ZWUvb3B0ZWUvb3B0ZWVfcHJpdmF0ZS5oDQo+ID4gPiArKysgYi9kcml2
ZXJzL3RlZS9vcHRlZS9vcHRlZV9wcml2YXRlLmgNCj4gPiA+IEBAIC0xODUsMTAgKzE4NSwxMiBA
QCBzdHJ1Y3Qgb3B0ZWVfb3BzIHsNCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYm9vbCBzeXN0ZW1fdGhyZWFkKTsNCj4gPiA+ICAgICAgICAgaW50ICgqdG9fbXNnX3BhcmFt
KShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc2l6ZV90IG51bV9wYXJhbXMsIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0g
KnBhcmFtcyk7DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bV9w
YXJhbXMsIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcywNCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpOw0KPiA+ID4gICAgICAgICBpbnQgKCpm
cm9tX21zZ19wYXJhbSkoc3RydWN0IG9wdGVlICpvcHRlZSwgc3RydWN0IHRlZV9wYXJhbSAqcGFy
YW1zLA0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bV9wYXJh
bXMsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0
ZWVfbXNnX3BhcmFtICptc2dfcGFyYW1zKTsNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMsDQo+ID4gPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBib29sIHVwZGF0ZV9vdXQpOw0KPiA+ID4gIH07
DQo+ID4gPg0KPiA+ID4gIC8qKg0KPiA+ID4gQEAgLTMxNiwyMyArMzE4LDM1IEBAIHZvaWQgb3B0
ZWVfcmVsZWFzZShzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCk7DQo+ID4gPiAgdm9pZCBvcHRlZV9y
ZWxlYXNlX3N1cHAoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgpOw0KPiA+ID4NCj4gPiA+ICBzdGF0
aWMgaW5saW5lIHZvaWQgb3B0ZWVfZnJvbV9tc2dfcGFyYW1fdmFsdWUoc3RydWN0IHRlZV9wYXJh
bSAqcCwgdTMyIGF0dHIsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXApDQo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9w
dGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ID4gIHsNCj4gPiA+IC0gICAgICAg
cC0+YXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5QVVQgKw0KPiA+ID4g
LSAgICAgICAgICAgICAgICAgYXR0ciAtIE9QVEVFX01TR19BVFRSX1RZUEVfVkFMVUVfSU5QVVQ7
DQo+ID4gPiAtICAgICAgIHAtPnUudmFsdWUuYSA9IG1wLT51LnZhbHVlLmE7DQo+ID4gPiAtICAg
ICAgIHAtPnUudmFsdWUuYiA9IG1wLT51LnZhbHVlLmI7DQo+ID4gPiAtICAgICAgIHAtPnUudmFs
dWUuYyA9IG1wLT51LnZhbHVlLmM7DQo+ID4gPiArICAgICAgIGlmICghdXBkYXRlX291dCkNCj4g
PiA+ICsgICAgICAgICAgICAgICBwLT5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9W
QUxVRV9JTlBVVCArDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIgLSBPUFRF
RV9NU0dfQVRUUl9UWVBFX1ZBTFVFX0lOUFVUOw0KPiA+ID4gKw0KPiA+ID4gKyAgICAgICBpZiAo
YXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX09VVFBVVCB8fA0KPiA+ID4gKyAgICAg
ICAgICAgYXR0ciA9PSBPUFRFRV9NU0dfQVRUUl9UWVBFX1ZBTFVFX0lOT1VUIHx8ICF1cGRhdGVf
b3V0KSB7DQo+ID4gPiArICAgICAgICAgICAgICAgcC0+dS52YWx1ZS5hID0gbXAtPnUudmFsdWUu
YTsNCj4gPiA+ICsgICAgICAgICAgICAgICBwLT51LnZhbHVlLmIgPSBtcC0+dS52YWx1ZS5iOw0K
PiA+ID4gKyAgICAgICAgICAgICAgIHAtPnUudmFsdWUuYyA9IG1wLT51LnZhbHVlLmM7DQo+ID4g
PiArICAgICAgIH0NCj4gPiA+ICB9DQo+ID4gPg0KPiA+ID4gIHN0YXRpYyBpbmxpbmUgdm9pZCBv
cHRlZV90b19tc2dfcGFyYW1fdmFsdWUoc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVj
dCB0ZWVfcGFyYW0gKnApDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnAsDQo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ICB7
DQo+ID4gPiAtICAgICAgIG1wLT5hdHRyID0gT1BURUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9JTlBV
VCArIHAtPmF0dHIgLQ0KPiA+ID4gLSAgICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9B
VFRSX1RZUEVfVkFMVUVfSU5QVVQ7DQo+ID4gPiAtICAgICAgIG1wLT51LnZhbHVlLmEgPSBwLT51
LnZhbHVlLmE7DQo+ID4gPiAtICAgICAgIG1wLT51LnZhbHVlLmIgPSBwLT51LnZhbHVlLmI7DQo+
ID4gPiAtICAgICAgIG1wLT51LnZhbHVlLmMgPSBwLT51LnZhbHVlLmM7DQo+ID4gPiArICAgICAg
IGlmICghdXBkYXRlX291dCkNCj4gPiA+ICsgICAgICAgICAgICAgICBtcC0+YXR0ciA9IE9QVEVF
X01TR19BVFRSX1RZUEVfVkFMVUVfSU5QVVQgKyBwLT5hdHRyIC0NCj4gPiA+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5QVVQ7DQo+
ID4gPiArDQo+ID4gPiArICAgICAgIGlmIChwLT5hdHRyID09IFRFRV9JT0NUTF9QQVJBTV9BVFRS
X1RZUEVfVkFMVUVfT1VUUFVUIHx8DQo+ID4gPiArICAgICAgICAgICBwLT5hdHRyID09IFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5PVVQgfHwgIXVwZGF0ZV9vdXQpIHsNCj4gPiA+
ICsgICAgICAgICAgICAgICBtcC0+dS52YWx1ZS5hID0gcC0+dS52YWx1ZS5hOw0KPiA+ID4gKyAg
ICAgICAgICAgICAgIG1wLT51LnZhbHVlLmIgPSBwLT51LnZhbHVlLmI7DQo+ID4gPiArICAgICAg
ICAgICAgICAgbXAtPnUudmFsdWUuYyA9IHAtPnUudmFsdWUuYzsNCj4gPiA+ICsgICAgICAgfQ0K
PiA+ID4gIH0NCj4gPiA+DQo+ID4gPiAgdm9pZCBvcHRlZV9jcV9pbml0KHN0cnVjdCBvcHRlZV9j
YWxsX3F1ZXVlICpjcSwgaW50IHRocmVhZF9jb3VudCk7DQo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJp
dmVycy90ZWUvb3B0ZWUvcnBjLmMgYi9kcml2ZXJzL3RlZS9vcHRlZS9ycGMuYw0KPiA+ID4gaW5k
ZXggZWJiYmQ0MmIwZTNlLi41ODBlNmI5YjA2MDYgMTAwNjQ0DQo+ID4gPiAtLS0gYS9kcml2ZXJz
L3RlZS9vcHRlZS9ycGMuYw0KPiA+ID4gKysrIGIvZHJpdmVycy90ZWUvb3B0ZWUvcnBjLmMNCj4g
PiA+IEBAIC02Myw3ICs2Myw3IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV9ycGNfZnVuY19jbWRfaTJj
X3RyYW5zZmVyKHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4LA0KPiA+ID4gICAgICAgICB9DQo+ID4g
Pg0KPiA+ID4gICAgICAgICBpZiAob3B0ZWUtPm9wcy0+ZnJvbV9tc2dfcGFyYW0ob3B0ZWUsIHBh
cmFtcywgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgYXJnLT5wYXJhbXMpKQ0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMsIGZhbHNlIC8qIXVwZGF0ZV9vdXQqLykpDQo+ID4g
PiAgICAgICAgICAgICAgICAgZ290byBiYWQ7DQo+ID4gPg0KPiA+ID4gICAgICAgICBmb3IgKGkg
PSAwOyBpIDwgYXJnLT5udW1fcGFyYW1zOyBpKyspIHsNCj4gPiA+IEBAIC0xMDcsNyArMTA3LDgg
QEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX2NtZF9pMmNfdHJhbnNmZXIoc3RydWN0IHRl
ZV9jb250ZXh0ICpjdHgsDQo+ID4gPiAgICAgICAgIH0gZWxzZSB7DQo+ID4gPiAgICAgICAgICAg
ICAgICAgcGFyYW1zWzNdLnUudmFsdWUuYSA9IG1zZy5sZW47DQo+ID4gPiAgICAgICAgICAgICAg
ICAgaWYgKG9wdGVlLT5vcHMtPnRvX21zZ19wYXJhbShvcHRlZSwgYXJnLT5wYXJhbXMsDQo+ID4g
PiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPm51bV9w
YXJhbXMsIHBhcmFtcykpDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBhcmctPm51bV9wYXJhbXMsIHBhcmFtcywNCj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyp1cGRhdGVfb3V0Ki8pKQ0KPiA+
ID4gICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJB
TUVURVJTOw0KPiA+ID4gICAgICAgICAgICAgICAgIGVsc2UNCj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19TVUNDRVNTOw0KPiA+ID4gQEAgLTE4OCw2ICsxODks
NyBAQCBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX2Z1bmNfY21kX3dhaXQoc3RydWN0IG9wdGVlX21z
Z19hcmcgKmFyZykNCj4gPiA+ICBzdGF0aWMgdm9pZCBoYW5kbGVfcnBjX3N1cHBfY21kKHN0cnVj
dCB0ZWVfY29udGV4dCAqY3R4LCBzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLA0KPiA+ID4gICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0ZWVfbXNnX2FyZyAqYXJnKQ0KPiA+ID4g
IHsNCj4gPiA+ICsgICAgICAgYm9vbCB1cGRhdGVfb3V0ID0gZmFsc2U7DQo+ID4gPiAgICAgICAg
IHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtczsNCj4gPiA+DQo+ID4gPiAgICAgICAgIGFyZy0+cmV0
X29yaWdpbiA9IFRFRUNfT1JJR0lOX0NPTU1TOw0KPiA+ID4gQEAgLTIwMCwxNSArMjAyLDIxIEBA
IHN0YXRpYyB2b2lkIGhhbmRsZV9ycGNfc3VwcF9jbWQoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgs
IHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4gPiAgICAgICAgIH0NCj4gPiA+DQo+ID4gPiAgICAg
ICAgIGlmIChvcHRlZS0+b3BzLT5mcm9tX21zZ19wYXJhbShvcHRlZSwgcGFyYW1zLCBhcmctPm51
bV9wYXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBh
cmctPnBhcmFtcykpIHsNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGFyZy0+cGFyYW1zLCB1cGRhdGVfb3V0KSkgew0KPiA+ID4gICAgICAgICAgICAgICAgIGFy
Zy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiA+ICAgICAgICAgICAgICAg
ICBnb3RvIG91dDsNCj4gPiA+ICAgICAgICAgfQ0KPiA+ID4NCj4gPiA+ICAgICAgICAgYXJnLT5y
ZXQgPSBvcHRlZV9zdXBwX3RocmRfcmVxKGN0eCwgYXJnLT5jbWQsIGFyZy0+bnVtX3BhcmFtcywg
cGFyYW1zKTsNCj4gPiA+DQo+ID4gPiArICAgICAgIC8qDQo+ID4gPiArICAgICAgICAqIFNwZWNp
YWwgdHJlYXRtZW50IGZvciBPUFRFRV9SUENfQ01EX1NITV9BTExPQyBzaW5jZSBpbnB1dCBpcyBh
DQo+ID4gPiArICAgICAgICAqIHZhbHVlIHR5cGUsIGJ1dCB0aGUgb3V0cHV0IGlzIGEgbWVtcmVm
IHR5cGUuDQo+ID4gPiArICAgICAgICAqLw0KPiA+ID4gKyAgICAgICBpZiAoYXJnLT5jbWQgIT0g
T1BURUVfUlBDX0NNRF9TSE1fQUxMT0MpDQo+ID4gPiArICAgICAgICAgICAgICAgdXBkYXRlX291
dCA9IHRydWU7DQo+ID4gPiAgICAgICAgIGlmIChvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0
ZWUsIGFyZy0+cGFyYW1zLCBhcmctPm51bV9wYXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgcGFyYW1zKSkNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBwYXJhbXMsIHVwZGF0ZV9vdXQpKQ0KPiA+ID4gICAgICAgICAgICAg
ICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiA+ICBvdXQ6DQo+
ID4gPiAgICAgICAgIGtmcmVlKHBhcmFtcyk7DQo+ID4gPiBAQCAtMjcwLDcgKzI3OCw3IEBAIHN0
YXRpYyB2b2lkIGhhbmRsZV9ycGNfZnVuY19ycG1iX3Byb2JlX3Jlc2V0KHN0cnVjdCB0ZWVfY29u
dGV4dCAqY3R4LA0KPiA+ID4NCj4gPiA+ICAgICAgICAgaWYgKGFyZy0+bnVtX3BhcmFtcyAhPSBB
UlJBWV9TSVpFKHBhcmFtcykgfHwNCj4gPiA+ICAgICAgICAgICAgIG9wdGVlLT5vcHMtPmZyb21f
bXNnX3BhcmFtKG9wdGVlLCBwYXJhbXMsIGFyZy0+bnVtX3BhcmFtcywNCj4gPiA+IC0gICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+cGFyYW1zKSB8fA0KPiA+ID4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMsIGZhbHNlIC8q
IXVwZGF0ZV9vdXQqLykgfHwNCj4gPiA+ICAgICAgICAgICAgIHBhcmFtc1swXS5hdHRyICE9IFRF
RV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUKSB7DQo+ID4gPiAgICAgICAgICAg
ICAgICAgYXJnLT5yZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gICAgICAg
ICAgICAgICAgIHJldHVybjsNCj4gPiA+IEBAIC0yODAsNyArMjg4LDggQEAgc3RhdGljIHZvaWQg
aGFuZGxlX3JwY19mdW5jX3JwbWJfcHJvYmVfcmVzZXQoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgs
DQo+ID4gPiAgICAgICAgIHBhcmFtc1swXS51LnZhbHVlLmIgPSAwOw0KPiA+ID4gICAgICAgICBw
YXJhbXNbMF0udS52YWx1ZS5jID0gMDsNCj4gPiA+ICAgICAgICAgaWYgKG9wdGVlLT5vcHMtPnRv
X21zZ19wYXJhbShvcHRlZSwgYXJnLT5wYXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMpKSB7DQo+ID4gPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJnLT5udW1fcGFyYW1zLCBwYXJhbXMs
DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ1ZSAvKnVwZGF0
ZV9vdXQqLykpIHsNCj4gPiA+ICAgICAgICAgICAgICAgICBhcmctPnJldCA9IFRFRUNfRVJST1Jf
QkFEX1BBUkFNRVRFUlM7DQo+ID4gPiAgICAgICAgICAgICAgICAgcmV0dXJuOw0KPiA+ID4gICAg
ICAgICB9DQo+ID4gPiBAQCAtMzI0LDcgKzMzMyw3IEBAIHN0YXRpYyB2b2lkIGhhbmRsZV9ycGNf
ZnVuY19ycG1iX3Byb2JlX25leHQoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsDQo+ID4gPg0KPiA+
ID4gICAgICAgICBpZiAoYXJnLT5udW1fcGFyYW1zICE9IEFSUkFZX1NJWkUocGFyYW1zKSB8fA0K
PiA+ID4gICAgICAgICAgICAgb3B0ZWUtPm9wcy0+ZnJvbV9tc2dfcGFyYW0ob3B0ZWUsIHBhcmFt
cywgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYXJnLT5wYXJhbXMpIHx8DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBhcmctPnBhcmFtcywgZmFsc2UgLyohdXBkYXRlX291dCovKSB8fA0KPiA+
ID4gICAgICAgICAgICAgcGFyYW1zWzBdLmF0dHIgIT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQ
RV9WQUxVRV9PVVRQVVQgfHwNCj4gPiA+ICAgICAgICAgICAgIHBhcmFtc1sxXS5hdHRyICE9IFRF
RV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVCkgew0KPiA+ID4gICAgICAgICAg
ICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsNCj4gPiA+IEBAIC0z
NTgsNyArMzY3LDggQEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX3JwbWJfcHJvYmVfbmV4
dChzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwNCj4gPiA+ICAgICAgICAgcGFyYW1zWzBdLnUudmFs
dWUuYiA9IHJkZXYtPmRlc2NyLmNhcGFjaXR5Ow0KPiA+ID4gICAgICAgICBwYXJhbXNbMF0udS52
YWx1ZS5jID0gcmRldi0+ZGVzY3IucmVsaWFibGVfd3JfY291bnQ7DQo+ID4gPiAgICAgICAgIGlm
IChvcHRlZS0+b3BzLT50b19tc2dfcGFyYW0ob3B0ZWUsIGFyZy0+cGFyYW1zLA0KPiA+ID4gLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+bnVtX3BhcmFtcywgcGFyYW1z
KSkgew0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+bnVt
X3BhcmFtcywgcGFyYW1zLA0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHRydWUgLyp1cGRhdGVfb3V0Ki8pKSB7DQo+ID4gPiAgICAgICAgICAgICAgICAgYXJnLT5y
ZXQgPSBURUVDX0VSUk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gICAgICAgICAgICAgICAgIHJl
dHVybjsNCj4gPiA+ICAgICAgICAgfQ0KPiA+ID4gQEAgLTM4NCw3ICszOTQsNyBAQCBzdGF0aWMg
dm9pZCBoYW5kbGVfcnBjX2Z1bmNfcnBtYl9mcmFtZXMoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgs
DQo+ID4gPg0KPiA+ID4gICAgICAgICBpZiAoYXJnLT5udW1fcGFyYW1zICE9IEFSUkFZX1NJWkUo
cGFyYW1zKSB8fA0KPiA+ID4gICAgICAgICAgICAgb3B0ZWUtPm9wcy0+ZnJvbV9tc2dfcGFyYW0o
b3B0ZWUsIHBhcmFtcywgYXJnLT5udW1fcGFyYW1zLA0KPiA+ID4gLSAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgYXJnLT5wYXJhbXMpIHx8DQo+ID4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhcmctPnBhcmFtcywgZmFsc2UgLyohdXBkYXRlX291
dCovKSB8fA0KPiA+ID4gICAgICAgICAgICAgcGFyYW1zWzBdLmF0dHIgIT0gVEVFX0lPQ1RMX1BB
UkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQgfHwNCj4gPiA+ICAgICAgICAgICAgIHBhcmFtc1sx
XS5hdHRyICE9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX09VVFBVVCkgew0KPiA+
ID4gICAgICAgICAgICAgICAgIGFyZy0+cmV0ID0gVEVFQ19FUlJPUl9CQURfUEFSQU1FVEVSUzsN
Cj4gPiA+IEBAIC00MDEsNyArNDExLDggQEAgc3RhdGljIHZvaWQgaGFuZGxlX3JwY19mdW5jX3Jw
bWJfZnJhbWVzKHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4LA0KPiA+ID4gICAgICAgICAgICAgICAg
IGdvdG8gb3V0Ow0KPiA+ID4gICAgICAgICB9DQo+ID4gPiAgICAgICAgIGlmIChvcHRlZS0+b3Bz
LT50b19tc2dfcGFyYW0ob3B0ZWUsIGFyZy0+cGFyYW1zLA0KPiA+ID4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGFyZy0+bnVtX3BhcmFtcywgcGFyYW1zKSkgew0KPiA+ID4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFyZy0+bnVtX3BhcmFtcywgcGFy
YW1zLA0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRydWUgLyp1
cGRhdGVfb3V0Ki8pKSB7DQo+ID4gPiAgICAgICAgICAgICAgICAgYXJnLT5yZXQgPSBURUVDX0VS
Uk9SX0JBRF9QQVJBTUVURVJTOw0KPiA+ID4gICAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+
ID4gICAgICAgICB9DQo+ID4gPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvb3B0ZWUvc21jX2Fi
aS5jIGIvZHJpdmVycy90ZWUvb3B0ZWUvc21jX2FiaS5jDQo+ID4gPiBpbmRleCBlOTQ1NmUzZTc0
Y2MuLmQxZjc5OTQ3ZjU4YSAxMDA2NDQNCj4gPiA+IC0tLSBhL2RyaXZlcnMvdGVlL29wdGVlL3Nt
Y19hYmkuYw0KPiA+ID4gKysrIGIvZHJpdmVycy90ZWUvb3B0ZWUvc21jX2FiaS5jDQo+ID4gPiBA
QCAtODEsMjAgKzgxLDI2IEBAIHN0YXRpYyBpbnQgb3B0ZWVfY3B1aHBfZGlzYWJsZV9wY3B1X2ly
cSh1bnNpZ25lZCBpbnQgY3B1KQ0KPiA+ID4gICAqLw0KPiA+ID4NCj4gPiA+ICBzdGF0aWMgaW50
IGZyb21fbXNnX3BhcmFtX3RtcF9tZW0oc3RydWN0IHRlZV9wYXJhbSAqcCwgdTMyIGF0dHIsDQo+
ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IG9wdGVl
X21zZ19wYXJhbSAqbXApDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ID4gIHsNCj4gPiA+ICAgICAg
ICAgc3RydWN0IHRlZV9zaG0gKnNobTsNCj4gPiA+ICAgICAgICAgcGh5c19hZGRyX3QgcGE7DQo+
ID4gPiAgICAgICAgIGludCByYzsNCj4gPiA+DQo+ID4gPiArICAgICAgIGlmICh1cGRhdGVfb3V0
KSB7DQo+ID4gPiArICAgICAgICAgICAgICAgaWYgKGF0dHIgPT0gT1BURUVfTVNHX0FUVFJfVFlQ
RV9UTUVNX0lOUFVUKQ0KPiA+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7DQo+
ID4gPiArICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gPiArICAgICAgIH0NCj4gPiA+ICsN
Cj4gPiA+ICAgICAgICAgcC0+YXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVG
X0lOUFVUICsNCj4gPiA+ICAgICAgICAgICAgICAgICAgIGF0dHIgLSBPUFRFRV9NU0dfQVRUUl9U
WVBFX1RNRU1fSU5QVVQ7DQo+ID4gPiAtICAgICAgIHAtPnUubWVtcmVmLnNpemUgPSBtcC0+dS50
bWVtLnNpemU7DQo+ID4gPiAgICAgICAgIHNobSA9IChzdHJ1Y3QgdGVlX3NobSAqKSh1bnNpZ25l
ZCBsb25nKW1wLT51LnRtZW0uc2htX3JlZjsNCj4gPiA+ICAgICAgICAgaWYgKCFzaG0pIHsNCj4g
PiA+ICAgICAgICAgICAgICAgICBwLT51Lm1lbXJlZi5zaG1fb2ZmcyA9IDA7DQo+ID4gPiAgICAg
ICAgICAgICAgICAgcC0+dS5tZW1yZWYuc2htID0gTlVMTDsNCj4gPiA+IC0gICAgICAgICAgICAg
ICByZXR1cm4gMDsNCj4gPiA+ICsgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiA+ICAgICAg
ICAgfQ0KPiA+ID4NCj4gPiA+ICAgICAgICAgcmMgPSB0ZWVfc2htX2dldF9wYShzaG0sIDAsICZw
YSk7DQo+ID4gPiBAQCAtMTAzLDE4ICsxMDksMjUgQEAgc3RhdGljIGludCBmcm9tX21zZ19wYXJh
bV90bXBfbWVtKHN0cnVjdCB0ZWVfcGFyYW0gKnAsIHUzMiBhdHRyLA0KPiA+ID4NCj4gPiA+ICAg
ICAgICAgcC0+dS5tZW1yZWYuc2htX29mZnMgPSBtcC0+dS50bWVtLmJ1Zl9wdHIgLSBwYTsNCj4g
PiA+ICAgICAgICAgcC0+dS5tZW1yZWYuc2htID0gc2htOw0KPiA+ID4gLQ0KPiA+ID4gK291dDoN
Cj4gPiA+ICsgICAgICAgcC0+dS5tZW1yZWYuc2l6ZSA9IG1wLT51LnRtZW0uc2l6ZTsNCj4gPiA+
ICAgICAgICAgcmV0dXJuIDA7DQo+ID4gPiAgfQ0KPiA+ID4NCj4gPiA+ICBzdGF0aWMgdm9pZCBm
cm9tX21zZ19wYXJhbV9yZWdfbWVtKHN0cnVjdCB0ZWVfcGFyYW0gKnAsIHUzMiBhdHRyLA0KPiA+
ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3Qgb3B0ZWVf
bXNnX3BhcmFtICptcCkNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
Y29uc3Qgc3RydWN0IG9wdGVlX21zZ19wYXJhbSAqbXAsDQo+ID4gPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4gPiA+ICB7DQo+ID4gPiAgICAg
ICAgIHN0cnVjdCB0ZWVfc2htICpzaG07DQo+ID4gPg0KPiA+ID4gKyAgICAgICBpZiAodXBkYXRl
X291dCkgew0KPiA+ID4gKyAgICAgICAgICAgICAgIGlmIChhdHRyID09IE9QVEVFX01TR19BVFRS
X1RZUEVfUk1FTV9JTlBVVCkNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsN
Cj4gPiA+ICsgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gPiA+ICsgICAgICAgfQ0KPiA+ID4g
Kw0KPiA+ID4gICAgICAgICBwLT5hdHRyID0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1S
RUZfSU5QVVQgKw0KPiA+ID4gICAgICAgICAgICAgICAgICAgYXR0ciAtIE9QVEVFX01TR19BVFRS
X1RZUEVfUk1FTV9JTlBVVDsNCj4gPiA+IC0gICAgICAgcC0+dS5tZW1yZWYuc2l6ZSA9IG1wLT51
LnJtZW0uc2l6ZTsNCj4gPiA+ICAgICAgICAgc2htID0gKHN0cnVjdCB0ZWVfc2htICopKHVuc2ln
bmVkIGxvbmcpbXAtPnUucm1lbS5zaG1fcmVmOw0KPiA+ID4NCj4gPiA+ICAgICAgICAgaWYgKHNo
bSkgew0KPiA+ID4gQEAgLTEyNCw2ICsxMzcsOCBAQCBzdGF0aWMgdm9pZCBmcm9tX21zZ19wYXJh
bV9yZWdfbWVtKHN0cnVjdCB0ZWVfcGFyYW0gKnAsIHUzMiBhdHRyLA0KPiA+ID4gICAgICAgICAg
ICAgICAgIHAtPnUubWVtcmVmLnNobV9vZmZzID0gMDsNCj4gPiA+ICAgICAgICAgICAgICAgICBw
LT51Lm1lbXJlZi5zaG0gPSBOVUxMOw0KPiA+ID4gICAgICAgICB9DQo+ID4gPiArb3V0Og0KPiA+
ID4gKyAgICAgICBwLT51Lm1lbXJlZi5zaXplID0gbXAtPnUucm1lbS5zaXplOw0KPiA+ID4gIH0N
Cj4gPiA+DQo+ID4gPiAgLyoqDQo+ID4gPiBAQCAtMTMzLDExICsxNDgsMTMgQEAgc3RhdGljIHZv
aWQgZnJvbV9tc2dfcGFyYW1fcmVnX21lbShzdHJ1Y3QgdGVlX3BhcmFtICpwLCB1MzIgYXR0ciwN
Cj4gPiA+ICAgKiBAcGFyYW1zOiAgICBzdWJzeXN0ZW0gaW50ZXJuYWwgcGFyYW1ldGVyIHJlcHJl
c2VudGF0aW9uDQo+ID4gPiAgICogQG51bV9wYXJhbXM6ICAgICAgICBudW1iZXIgb2YgZWxlbWVu
dHMgaW4gdGhlIHBhcmFtZXRlciBhcnJheXMNCj4gPiA+ICAgKiBAbXNnX3BhcmFtczogICAgICAg
IE9QVEVFX01TRyBwYXJhbWV0ZXJzDQo+ID4gPiArICogQHVwZGF0ZV9vdXQ6ICAgICAgICB1cGRh
dGUgcGFyYW1ldGVyIGZvciBvdXRwdXQgb25seQ0KPiA+ID4gICAqIFJldHVybnMgMCBvbiBzdWNj
ZXNzIG9yIDwwIG9uIGZhaWx1cmUNCj4gPiA+ICAgKi8NCj4gPiA+ICBzdGF0aWMgaW50IG9wdGVl
X2Zyb21fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsIHN0cnVjdCB0ZWVfcGFyYW0gKnBh
cmFtcywNCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90IG51bV9w
YXJhbXMsDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0cnVj
dCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMpDQo+ID4gPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGNvbnN0IHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1zZ19wYXJhbXMsDQo+
ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvb2wgdXBkYXRlX291dCkNCj4g
PiA+ICB7DQo+ID4gPiAgICAgICAgIGludCByYzsNCj4gPiA+ICAgICAgICAgc2l6ZV90IG47DQo+
ID4gPiBAQCAtMTQ5LDI1ICsxNjYsMjcgQEAgc3RhdGljIGludCBvcHRlZV9mcm9tX21zZ19wYXJh
bShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsDQo+ID4gPg0K
PiA+ID4gICAgICAgICAgICAgICAgIHN3aXRjaCAoYXR0cikgew0KPiA+ID4gICAgICAgICAgICAg
ICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9OT05FOg0KPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHVwZGF0ZV9vdXQpDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOw0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgcC0+YXR0ciA9IFRF
RV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTk9ORTsNCj4gPiA+ICAgICAgICAgICAgICAgICAgICAg
ICAgIG1lbXNldCgmcC0+dSwgMCwgc2l6ZW9mKHAtPnUpKTsNCj4gPiA+ICAgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOw0KPiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FU
VFJfVFlQRV9WQUxVRV9JTlBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01T
R19BVFRSX1RZUEVfVkFMVUVfT1VUUFVUOg0KPiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BU
RUVfTVNHX0FUVFJfVFlQRV9WQUxVRV9JTk9VVDoNCj4gPiA+IC0gICAgICAgICAgICAgICAgICAg
ICAgIG9wdGVlX2Zyb21fbXNnX3BhcmFtX3ZhbHVlKHAsIGF0dHIsIG1wKTsNCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgIG9wdGVlX2Zyb21fbXNnX3BhcmFtX3ZhbHVlKHAsIGF0dHIsIG1w
LCB1cGRhdGVfb3V0KTsNCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiA+
ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9UTUVNX0lOUFVUOg0K
PiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgT1BURUVfTVNHX0FUVFJfVFlQRV9UTUVNX09VVFBV
VDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfVE1FTV9J
Tk9VVDoNCj4gPiA+IC0gICAgICAgICAgICAgICAgICAgICAgIHJjID0gZnJvbV9tc2dfcGFyYW1f
dG1wX21lbShwLCBhdHRyLCBtcCk7DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICByYyA9
IGZyb21fbXNnX3BhcmFtX3RtcF9tZW0ocCwgYXR0ciwgbXAsIHVwZGF0ZV9vdXQpOw0KPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJjKQ0KPiA+ID4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXR1cm4gcmM7DQo+ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICBi
cmVhazsNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVfUk1F
TV9JTlBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIE9QVEVFX01TR19BVFRSX1RZUEVf
Uk1FTV9PVVRQVVQ6DQo+ID4gPiAgICAgICAgICAgICAgICAgY2FzZSBPUFRFRV9NU0dfQVRUUl9U
WVBFX1JNRU1fSU5PVVQ6DQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICBmcm9tX21zZ19w
YXJhbV9yZWdfbWVtKHAsIGF0dHIsIG1wKTsNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAg
IGZyb21fbXNnX3BhcmFtX3JlZ19tZW0ocCwgYXR0ciwgbXAsIHVwZGF0ZV9vdXQpOw0KPiA+ID4g
ICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4gPg0KPiA+ID4gICAgICAgICAgICAg
ICAgIGRlZmF1bHQ6DQo+ID4gPiBAQCAtMTc4LDIwICsxOTcsMjUgQEAgc3RhdGljIGludCBvcHRl
ZV9mcm9tX21zZ19wYXJhbShzdHJ1Y3Qgb3B0ZWUgKm9wdGVlLCBzdHJ1Y3QgdGVlX3BhcmFtICpw
YXJhbXMsDQo+ID4gPiAgfQ0KPiA+ID4NCj4gPiA+ICBzdGF0aWMgaW50IHRvX21zZ19wYXJhbV90
bXBfbWVtKHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wLA0KPiA+ID4gLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwKQ0KPiA+ID4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzdHJ1Y3QgdGVlX3BhcmFtICpwLCBib29s
IHVwZGF0ZV9vdXQpDQo+ID4gPiAgew0KPiA+ID4gICAgICAgICBpbnQgcmM7DQo+ID4gPiAgICAg
ICAgIHBoeXNfYWRkcl90IHBhOw0KPiA+ID4NCj4gPiA+ICsgICAgICAgaWYgKHVwZGF0ZV9vdXQp
IHsNCj4gPiA+ICsgICAgICAgICAgICAgICBpZiAocC0+YXR0ciA9PSBURUVfSU9DVExfUEFSQU1f
QVRUUl9UWVBFX01FTVJFRl9JTlBVVCkNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiAwOw0KPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+ID4gKyAgICAgICB9
DQo+ID4gPiArDQo+ID4gPiAgICAgICAgIG1wLT5hdHRyID0gT1BURUVfTVNHX0FUVFJfVFlQRV9U
TUVNX0lOUFVUICsgcC0+YXR0ciAtDQo+ID4gPiAgICAgICAgICAgICAgICAgICAgVEVFX0lPQ1RM
X1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQ7DQo+ID4gPg0KPiA+ID4gICAgICAgICBtcC0+
dS50bWVtLnNobV9yZWYgPSAodW5zaWduZWQgbG9uZylwLT51Lm1lbXJlZi5zaG07DQo+ID4gPiAt
ICAgICAgIG1wLT51LnRtZW0uc2l6ZSA9IHAtPnUubWVtcmVmLnNpemU7DQo+ID4gPg0KPiA+ID4g
ICAgICAgICBpZiAoIXAtPnUubWVtcmVmLnNobSkgew0KPiA+ID4gICAgICAgICAgICAgICAgIG1w
LT51LnRtZW0uYnVmX3B0ciA9IDA7DQo+ID4gPiAtICAgICAgICAgICAgICAgcmV0dXJuIDA7DQo+
ID4gPiArICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ID4gPiAgICAgICAgIH0NCj4gPiA+DQo+
ID4gPiAgICAgICAgIHJjID0gdGVlX3NobV9nZXRfcGEocC0+dS5tZW1yZWYuc2htLCBwLT51Lm1l
bXJlZi5zaG1fb2ZmcywgJnBhKTsNCj4gPiA+IEBAIC0yMDEsMTkgKzIyNSwyNyBAQCBzdGF0aWMg
aW50IHRvX21zZ19wYXJhbV90bXBfbWVtKHN0cnVjdCBvcHRlZV9tc2dfcGFyYW0gKm1wLA0KPiA+
ID4gICAgICAgICBtcC0+dS50bWVtLmJ1Zl9wdHIgPSBwYTsNCj4gPiA+ICAgICAgICAgbXAtPmF0
dHIgfD0gT1BURUVfTVNHX0FUVFJfQ0FDSEVfUFJFREVGSU5FRCA8PA0KPiA+ID4gICAgICAgICAg
ICAgICAgICAgICBPUFRFRV9NU0dfQVRUUl9DQUNIRV9TSElGVDsNCj4gPiA+IC0NCj4gPiA+ICtv
dXQ6DQo+ID4gPiArICAgICAgIG1wLT51LnRtZW0uc2l6ZSA9IHAtPnUubWVtcmVmLnNpemU7DQo+
ID4gPiAgICAgICAgIHJldHVybiAwOw0KPiA+ID4gIH0NCj4gPiA+DQo+ID4gPiAgc3RhdGljIGlu
dCB0b19tc2dfcGFyYW1fcmVnX21lbShzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFtICptcCwNCj4gPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHRlZV9wYXJhbSAq
cCkNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3RydWN0IHRl
ZV9wYXJhbSAqcCwgYm9vbCB1cGRhdGVfb3V0KQ0KPiA+ID4gIHsNCj4gPiA+ICsgICAgICAgaWYg
KHVwZGF0ZV9vdXQpIHsNCj4gPiA+ICsgICAgICAgICAgICAgICBpZiAocC0+YXR0ciA9PSBURUVf
SU9DVExfUEFSQU1fQVRUUl9UWVBFX01FTVJFRl9JTlBVVCkNCj4gPiA+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHJldHVybiAwOw0KPiA+ID4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiA+
ID4gKyAgICAgICB9DQo+ID4gPiArDQo+ID4gPiAgICAgICAgIG1wLT5hdHRyID0gT1BURUVfTVNH
X0FUVFJfVFlQRV9STUVNX0lOUFVUICsgcC0+YXR0ciAtDQo+ID4gPiAgICAgICAgICAgICAgICAg
ICAgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9NRU1SRUZfSU5QVVQ7DQo+ID4gPg0KPiA+ID4g
ICAgICAgICBtcC0+dS5ybWVtLnNobV9yZWYgPSAodW5zaWduZWQgbG9uZylwLT51Lm1lbXJlZi5z
aG07DQo+ID4gPiAtICAgICAgIG1wLT51LnJtZW0uc2l6ZSA9IHAtPnUubWVtcmVmLnNpemU7DQo+
ID4gPiAgICAgICAgIG1wLT51LnJtZW0ub2ZmcyA9IHAtPnUubWVtcmVmLnNobV9vZmZzOw0KPiA+
ID4gK291dDoNCj4gPiA+ICsgICAgICAgbXAtPnUucm1lbS5zaXplID0gcC0+dS5tZW1yZWYuc2l6
ZTsNCj4gPiA+ICAgICAgICAgcmV0dXJuIDA7DQo+ID4gPiAgfQ0KPiA+ID4NCj4gPiA+IEBAIC0y
MjMsMTEgKzI1NSwxMyBAQCBzdGF0aWMgaW50IHRvX21zZ19wYXJhbV9yZWdfbWVtKHN0cnVjdCBv
cHRlZV9tc2dfcGFyYW0gKm1wLA0KPiA+ID4gICAqIEBtc2dfcGFyYW1zOiAgICAgICAgT1BURUVf
TVNHIHBhcmFtZXRlcnMNCj4gPiA+ICAgKiBAbnVtX3BhcmFtczogICAgICAgIG51bWJlciBvZiBl
bGVtZW50cyBpbiB0aGUgcGFyYW1ldGVyIGFycmF5cw0KPiA+ID4gICAqIEBwYXJhbXM6ICAgIHN1
YnN5c3RlbSBpdG5lcm5hbCBwYXJhbWV0ZXIgcmVwcmVzZW50YXRpb24NCj4gPiA+ICsgKiBAdXBk
YXRlX291dDogICAgICAgIHVwZGF0ZSBwYXJhbWV0ZXIgZm9yIG91dHB1dCBvbmx5DQo+ID4gPiAg
ICogUmV0dXJucyAwIG9uIHN1Y2Nlc3Mgb3IgPDAgb24gZmFpbHVyZQ0KPiA+ID4gICAqLw0KPiA+
ID4gIHN0YXRpYyBpbnQgb3B0ZWVfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+
ID4gPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qgb3B0ZWVfbXNnX3BhcmFt
ICptc2dfcGFyYW1zLA0KPiA+ID4gLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZV90
IG51bV9wYXJhbXMsIGNvbnN0IHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcykNCj4gPiA+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHNpemVfdCBudW1fcGFyYW1zLCBjb25zdCBzdHJ1Y3Qg
dGVlX3BhcmFtICpwYXJhbXMsDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICBi
b29sIHVwZGF0ZV9vdXQpDQo+ID4gPiAgew0KPiA+ID4gICAgICAgICBpbnQgcmM7DQo+ID4gPiAg
ICAgICAgIHNpemVfdCBuOw0KPiA+ID4gQEAgLTIzOCwyMSArMjcyLDIzIEBAIHN0YXRpYyBpbnQg
b3B0ZWVfdG9fbXNnX3BhcmFtKHN0cnVjdCBvcHRlZSAqb3B0ZWUsDQo+ID4gPg0KPiA+ID4gICAg
ICAgICAgICAgICAgIHN3aXRjaCAocC0+YXR0cikgew0KPiA+ID4gICAgICAgICAgICAgICAgIGNh
c2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9OT05FOg0KPiA+ID4gKyAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHVwZGF0ZV9vdXQpDQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOw0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgbXAtPmF0dHIgPSBU
RUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX05PTkU7DQo+ID4gPiAgICAgICAgICAgICAgICAgICAg
ICAgICBtZW1zZXQoJm1wLT51LCAwLCBzaXplb2YobXAtPnUpKTsNCj4gPiA+ICAgICAgICAgICAg
ICAgICAgICAgICAgIGJyZWFrOw0KPiA+ID4gICAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RM
X1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTlBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNl
IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVUOg0KPiA+ID4gICAgICAgICAg
ICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9JTk9VVDoNCj4gPiA+
IC0gICAgICAgICAgICAgICAgICAgICAgIG9wdGVlX3RvX21zZ19wYXJhbV92YWx1ZShtcCwgcCk7
DQo+ID4gPiArICAgICAgICAgICAgICAgICAgICAgICBvcHRlZV90b19tc2dfcGFyYW1fdmFsdWUo
bXAsIHAsIHVwZGF0ZV9vdXQpOw0KPiA+ID4gICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7
DQo+ID4gPiAgICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX01F
TVJFRl9JTlBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJBTV9B
VFRSX1RZUEVfTUVNUkVGX09VVFBVVDoNCj4gPiA+ICAgICAgICAgICAgICAgICBjYXNlIFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfTUVNUkVGX0lOT1VUOg0KPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHRlZV9zaG1faXNfZHluYW1pYyhwLT51Lm1lbXJlZi5zaG0pKQ0KPiA+ID4g
LSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByYyA9IHRvX21zZ19wYXJhbV9yZWdfbWVt
KG1wLCBwKTsNCj4gPiA+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmMgPSB0b19t
c2dfcGFyYW1fcmVnX21lbShtcCwgcCwgdXBkYXRlX291dCk7DQo+ID4gPiAgICAgICAgICAgICAg
ICAgICAgICAgICBlbHNlDQo+ID4gPiAtICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJj
ID0gdG9fbXNnX3BhcmFtX3RtcF9tZW0obXAsIHApOw0KPiA+ID4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByYyA9IHRvX21zZ19wYXJhbV90bXBfbWVtKG1wLCBwLCB1cGRhdGVfb3V0
KTsNCj4gPiA+ICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyYykNCj4gPiA+ICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJjOw0KPiA+ID4gICAgICAgICAgICAgICAg
ICAgICAgICAgYnJlYWs7DQo+ID4gPiAtLQ0KPiA+ID4gMi40My4wDQo+ID4gPg0KX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWls
aW5nIGxpc3QgLS0gbGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJl
IHNlbmQgYW4gZW1haWwgdG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
