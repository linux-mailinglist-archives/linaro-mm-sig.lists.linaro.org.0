Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 9F9045118CC
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 27 Apr 2022 16:34:52 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id D1A4D47FC7
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 27 Apr 2022 14:34:51 +0000 (UTC)
Received: from mail-yw1-f201.google.com (mail-yw1-f201.google.com [209.85.128.201])
	by lists.linaro.org (Postfix) with ESMTPS id 53D8C3EC43
	for <linaro-mm-sig@lists.linaro.org>; Wed, 20 Apr 2022 23:52:48 +0000 (UTC)
Received: by mail-yw1-f201.google.com with SMTP id 00721157ae682-2e644c76556so29206197b3.15
        for <linaro-mm-sig@lists.linaro.org>; Wed, 20 Apr 2022 16:52:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=google.com; s=20210112;
        h=date:in-reply-to:message-id:mime-version:references:subject:from:to
         :cc:content-transfer-encoding;
        bh=MFjiN2c4422vfH3G5XH/W0LypfixtCAuep+NsTNNNpQ=;
        b=O9DK+nzovZ+3UKgC7FIOwT0aMuF2SvsCaF3ZXeSoWy1EhpK0ePx8O/H08V2UqVfgNE
         UN5jw6LkKrD8qnmQ8yNpabAi8LYhV7IVlIhIyxjzWt3DwY0xQYzoGMBwBTocnz0s4rQ5
         ZOKGBkrXwliivGK3Dk1OOuz1iBAnoM5/GpdgoZDvda2LQ+79y+gHEcN4hEcic5si8/tq
         BgIQcchgyZXlLHtJLZrCzUf6RpuLOSrX5iJi0+Wk0Z3RcDlTPXgAj1jg8XJPOdnclJ4g
         1cwxGcpXpjpo6GYI8wlIE6qmSSkrnjGd9jEmnSx6WLGCOCS3QWAGjtKo+pr14uahGroF
         uPhQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=x-gm-message-state:date:in-reply-to:message-id:mime-version
         :references:subject:from:to:cc:content-transfer-encoding;
        bh=MFjiN2c4422vfH3G5XH/W0LypfixtCAuep+NsTNNNpQ=;
        b=lv1oRLfDDJFkDfZtGBSMpAB1g5/V0YJOWZiZA20NH9xR6lW5Nl2B/NRCWENBVWvEFN
         3GVg2/60IuRT+fA2TDt5nfeKo4Dv8MzspU1vqi1hM94GQ8zMW5HIxbC5ur7EYrBMhYqd
         /4eldB3czsWOnueIMxIZHjpjUD1tRhAHTViqVt4maU8gyI9fk1PZNMlK9LT9EvRq6lBA
         YhqZbOW+4tKt9e+INZJOoLIBQ1BzTYJ4NTwW8GD0uZWvxhYCH4KzbwgURCAOEfj01q+w
         Th3Us04sDF6yUBMunmskuK8Nztg1FMYXjMILbT+LZS/YfPE4skLz2frz+dOrT0IxUFWW
         yleA==
X-Gm-Message-State: AOAM533fXQ7HtYTCy2rhrEmE2yetQ10rSkgOau4bn4Vnl32zEr/u+csn
	e0DHzz5VKO0R4fcGihUF0m3HzD0zIPBmC/s=
X-Google-Smtp-Source: ABdhPJwgj/q1pkBqUx+EtmezTxZVaTnub+E1mqztCIeOzLZpLnxcjiZoZHoIs2LVhmVe02tDSbzgfaHA7Of00Js=
X-Received: from tj.c.googlers.com ([fda3:e722:ac3:cc00:20:ed76:c0a8:53a])
 (user=tjmercier job=sendgmr) by 2002:a0d:f0c3:0:b0:2f4:d291:9dde with SMTP id
 z186-20020a0df0c3000000b002f4d2919ddemr1882789ywe.437.1650498767961; Wed, 20
 Apr 2022 16:52:47 -0700 (PDT)
Date: Wed, 20 Apr 2022 23:52:22 +0000
In-Reply-To: <20220420235228.2767816-1-tjmercier@google.com>
Message-Id: <20220420235228.2767816-5-tjmercier@google.com>
Mime-Version: 1.0
References: <20220420235228.2767816-1-tjmercier@google.com>
X-Mailer: git-send-email 2.36.0.rc0.470.gd361397f0d-goog
From: "T.J. Mercier" <tjmercier@google.com>
To: tjmercier@google.com, daniel@ffwll.ch, tj@kernel.org,
	Sumit Semwal <sumit.semwal@linaro.org>,
	"=?UTF-8?q?Christian=20K=C3=B6nig?=" <christian.koenig@amd.com>, Zefan Li <lizefan.x@bytedance.com>,
	Johannes Weiner <hannes@cmpxchg.org>
X-MailFrom: 3z5xgYgkKDaQXNQIVGMIVKSSKPI.GSQPMREVS-QQ-WMKPMWXW.PMREVS.SVK@flex--tjmercier.bounces.google.com
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
Message-ID-Hash: NBGOWQU7PMXHAIPZ2MYTOB7RULKYAG5M
X-Message-ID-Hash: NBGOWQU7PMXHAIPZ2MYTOB7RULKYAG5M
X-Mailman-Approved-At: Wed, 27 Apr 2022 14:34:45 +0000
CC: hridya@google.com, jstultz@google.com, tkjos@android.com, cmllamas@google.com, surenb@google.com, kaleshsingh@google.com, Kenny.Ho@amd.com, mkoutny@suse.com, skhan@linuxfoundation.org, kernel-team@android.com, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org, cgroups@vger.kernel.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [RFC v5 4/6] dmabuf: Add gpu cgroup charge transfer function
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/NBGOWQU7PMXHAIPZ2MYTOB7RULKYAG5M/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

VGhlIGRtYV9idWZfdHJhbnNmZXJfY2hhcmdlIGZ1bmN0aW9uIHByb3ZpZGVzIGEgd2F5IGZvciBw
cm9jZXNzZXMgdG8NCnRyYW5zZmVyIGNoYXJnZSBvZiBhIGJ1ZmZlciB0byBhIGRpZmZlcmVudCBw
cm9jZXNzLiBUaGlzIGlzIGVzc2VudGlhbA0KZm9yIHRoZSBjYXNlcyB3aGVyZSBhIGNlbnRyYWwg
YWxsb2NhdG9yIHByb2Nlc3MgZG9lcyBhbGxvY2F0aW9ucyBmb3INCnZhcmlvdXMgc3Vic3lzdGVt
cywgaGFuZHMgb3ZlciB0aGUgZmQgdG8gdGhlIGNsaWVudCB3aG8gcmVxdWVzdGVkIHRoZQ0KbWVt
b3J5IGFuZCBkcm9wcyBhbGwgcmVmZXJlbmNlcyB0byB0aGUgYWxsb2NhdGVkIG1lbW9yeS4NCg0K
T3JpZ2luYWxseS1ieTogSHJpZHlhIFZhbHNhcmFqdSA8aHJpZHlhQGdvb2dsZS5jb20+DQpTaWdu
ZWQtb2ZmLWJ5OiBULkouIE1lcmNpZXIgPHRqbWVyY2llckBnb29nbGUuY29tPg0KDQotLS0NCnY1
IGNoYW5nZXMNCkZpeCBjb21taXQgbWVzc2FnZSB3aGljaCBzdGlsbCBjb250YWluZWQgdGhlIG9s
ZCBuYW1lIGZvcg0KZG1hX2J1Zl90cmFuc2Zlcl9jaGFyZ2UgcGVyIE1pY2hhbCBLb3V0bsO9Lg0K
DQpNb2RpZnkgdGhlIGRtYV9idWZfdHJhbnNmZXJfY2hhcmdlIEFQSSB0byBhY2NlcHQgYSB0YXNr
X3N0cnVjdCBpbnN0ZWFkDQpvZiBhIGdwdWNnLiBUaGlzIGF2b2lkcyByZXF1aXJpbmcgdGhlIGNh
bGxlciB0byBtYW5hZ2UgdGhlIHJlZmNvdW50DQpvZiB0aGUgZ3B1Y2cgdXBvbiBmYWlsdXJlIGFu
ZCBjb25mdXNpbmcgb3duZXJzaGlwIHRyYW5zZmVyIGxvZ2ljLg0KDQp2NCBjaGFuZ2VzDQpBZGp1
c3Qgb3JkZXJpbmcgb2YgY2hhcmdlL3VuY2hhcmdlIGR1cmluZyB0cmFuc2ZlciB0byBhdm9pZCBw
b3RlbnRpYWxseQ0KaGl0dGluZyBjZ3JvdXAgbGltaXQgcGVyIE1pY2hhbCBLb3V0bsO9Lg0KDQp2
MyBjaGFuZ2VzDQpVc2UgbW9yZSBjb21tb24gZHVhbCBhdXRob3IgY29tbWl0IG1lc3NhZ2UgZm9y
bWF0IHBlciBKb2huIFN0dWx0ei4NCg0KdjIgY2hhbmdlcw0KTW92ZSBkbWEtYnVmIGNncm91cCBj
aGFyZ2UgdHJhbnNmZXIgZnJvbSBhIGRtYV9idWZfb3AgZGVmaW5lZCBieSBldmVyeQ0KaGVhcCB0
byBhIHNpbmdsZSBkbWEtYnVmIGZ1bmN0aW9uIGZvciBhbGwgaGVhcHMgcGVyIERhbmllbCBWZXR0
ZXIgYW5kDQpDaHJpc3RpYW4gS8O2bmlnLg0KLS0tDQogZHJpdmVycy9kbWEtYnVmL2RtYS1idWYu
YyAgfCA1NyArKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKw0KIGluY2x1ZGUvbGlu
dXgvY2dyb3VwX2dwdS5oIHwgMTQgKysrKysrKysrDQogaW5jbHVkZS9saW51eC9kbWEtYnVmLmgg
ICAgfCAgNiArKysrDQoga2VybmVsL2Nncm91cC9ncHUuYyAgICAgICAgfCA2MiArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKw0KIDQgZmlsZXMgY2hhbmdlZCwgMTM5IGluc2Vy
dGlvbnMoKykNCg0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMgYi9kcml2
ZXJzL2RtYS1idWYvZG1hLWJ1Zi5jDQppbmRleCBiYzg5YzQ0YmQ5YjkuLmYzZmI4NDQ5MjVlMiAx
MDA2NDQNCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtYnVmLmMNCisrKyBiL2RyaXZlcnMvZG1h
LWJ1Zi9kbWEtYnVmLmMNCkBAIC0xMzQxLDYgKzEzNDEsNjMgQEAgdm9pZCBkbWFfYnVmX3Z1bm1h
cChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgaW9zeXNfbWFwICptYXApDQogfQ0KIEVY
UE9SVF9TWU1CT0xfTlNfR1BMKGRtYV9idWZfdnVubWFwLCBETUFfQlVGKTsNCiANCisvKioNCisg
KiBkbWFfYnVmX3RyYW5zZmVyX2NoYXJnZSAtIENoYW5nZSB0aGUgR1BVIGNncm91cCB0byB3aGlj
aCB0aGUgcHJvdmlkZWQgZG1hX2J1ZiBpcyBjaGFyZ2VkLg0KKyAqIEBkbWFidWY6CVtpbl0JYnVm
ZmVyIHdob3NlIGNoYXJnZSB3aWxsIGJlIG1pZ3JhdGVkIHRvIGEgZGlmZmVyZW50IEdQVSBjZ3Jv
dXANCisgKiBAdGFyZ2V0OglbaW5dCXRoZSB0YXNrX3N0cnVjdCBvZiB0aGUgZGVzdGluYXRpb24g
cHJvY2VzcyBmb3IgdGhlIEdQVSBjZ3JvdXAgY2hhcmdlDQorICoNCisgKiBPbmx5IHRhc2tzIHRo
YXQgYmVsb25nIHRvIHRoZSBzYW1lIGNncm91cCB0aGUgYnVmZmVyIGlzIGN1cnJlbnRseSBjaGFy
Z2VkIHRvDQorICogbWF5IGNhbGwgdGhpcyBmdW5jdGlvbiwgb3RoZXJ3aXNlIGl0IHdpbGwgcmV0
dXJuIC1FUEVSTS4NCisgKg0KKyAqIFJldHVybnMgMCBvbiBzdWNjZXNzLCBvciBhIG5lZ2F0aXZl
IGVycm5vIGNvZGUgb3RoZXJ3aXNlLg0KKyAqLw0KK2ludCBkbWFfYnVmX3RyYW5zZmVyX2NoYXJn
ZShzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhcmdldCkNCit7
DQorCXN0cnVjdCBncHVjZyAqY3VycmVudF9ncHVjZywgKnRhcmdldF9ncHVjZywgKnRvX3JlbGVh
c2U7DQorCWludCByZXQ7DQorDQorCWlmICghZG1hYnVmLT5ncHVjZyB8fCAhZG1hYnVmLT5ncHVj
Z19idWNrZXQpIHsNCisJCS8qIFRoaXMgZG1hYnVmIGlzIG5vdCB0cmFja2VkIHVuZGVyIEdQVSBj
Z3JvdXAgYWNjb3VudGluZyAqLw0KKwkJcmV0dXJuIDA7DQorCX0NCisNCisJY3VycmVudF9ncHVj
ZyA9IGdwdWNnX2dldChjdXJyZW50KTsNCisJdGFyZ2V0X2dwdWNnID0gZ3B1Y2dfZ2V0KHRhcmdl
dCk7DQorCXRvX3JlbGVhc2UgPSB0YXJnZXRfZ3B1Y2c7DQorDQorCS8qIElmIHRoZSBzb3VyY2Ug
YW5kIGRlc3RpbmF0aW9uIGNncm91cHMgYXJlIHRoZSBzYW1lLCBkb24ndCBkbyBhbnl0aGluZy4g
Ki8NCisJaWYgKGN1cnJlbnRfZ3B1Y2cgPT0gdGFyZ2V0X2dwdWNnKSB7DQorCQlyZXQgPSAwOw0K
KwkJZ290byBza2lwX3RyYW5zZmVyOw0KKwl9DQorDQorCS8qDQorCSAqIFZlcmlmeSB0aGF0IHRo
ZSBjZ3JvdXAgb2YgdGhlIHByb2Nlc3MgcmVxdWVzdGluZyB0aGUgdHJhbnNmZXINCisJICogaXMg
dGhlIHNhbWUgYXMgdGhlIG9uZSB0aGUgYnVmZmVyIGlzIGN1cnJlbnRseSBjaGFyZ2VkIHRvLg0K
KwkgKi8NCisJbXV0ZXhfbG9jaygmZG1hYnVmLT5sb2NrKTsNCisJaWYgKGN1cnJlbnRfZ3B1Y2cg
IT0gZG1hYnVmLT5ncHVjZykgew0KKwkJcmV0ID0gLUVQRVJNOw0KKwkJZ290byBlcnI7DQorCX0N
CisNCisJcmV0ID0gZ3B1Y2dfdHJhbnNmZXJfY2hhcmdlKA0KKwkJZG1hYnVmLT5ncHVjZywgdGFy
Z2V0X2dwdWNnLCBkbWFidWYtPmdwdWNnX2J1Y2tldCwgZG1hYnVmLT5zaXplKTsNCisJaWYgKHJl
dCkNCisJCWdvdG8gZXJyOw0KKw0KKwl0b19yZWxlYXNlID0gZG1hYnVmLT5ncHVjZzsNCisJZG1h
YnVmLT5ncHVjZyA9IHRhcmdldF9ncHVjZzsNCisNCitlcnI6DQorCW11dGV4X3VubG9jaygmZG1h
YnVmLT5sb2NrKTsNCitza2lwX3RyYW5zZmVyOg0KKwlncHVjZ19wdXQoY3VycmVudF9ncHVjZyk7
DQorCWdwdWNnX3B1dCh0b19yZWxlYXNlKTsNCisJcmV0dXJuIHJldDsNCit9DQorRVhQT1JUX1NZ
TUJPTF9OU19HUEwoZG1hX2J1Zl90cmFuc2Zlcl9jaGFyZ2UsIERNQV9CVUYpOw0KKw0KICNpZmRl
ZiBDT05GSUdfREVCVUdfRlMNCiBzdGF0aWMgaW50IGRtYV9idWZfZGVidWdfc2hvdyhzdHJ1Y3Qg
c2VxX2ZpbGUgKnMsIHZvaWQgKnVudXNlZCkNCiB7DQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51
eC9jZ3JvdXBfZ3B1LmggYi9pbmNsdWRlL2xpbnV4L2Nncm91cF9ncHUuaA0KaW5kZXggNGRmZTYz
M2Q2ZWM3Li5mNTk3M2VmOWY5MjYgMTAwNjQ0DQotLS0gYS9pbmNsdWRlL2xpbnV4L2Nncm91cF9n
cHUuaA0KKysrIGIvaW5jbHVkZS9saW51eC9jZ3JvdXBfZ3B1LmgNCkBAIC04Myw3ICs4MywxMyBA
QCBzdGF0aWMgaW5saW5lIHN0cnVjdCBncHVjZyAqZ3B1Y2dfcGFyZW50KHN0cnVjdCBncHVjZyAq
Y2cpDQogfQ0KIA0KIGludCBncHVjZ19jaGFyZ2Uoc3RydWN0IGdwdWNnICpncHVjZywgc3RydWN0
IGdwdWNnX2J1Y2tldCAqYnVja2V0LCB1NjQgc2l6ZSk7DQorDQogdm9pZCBncHVjZ191bmNoYXJn
ZShzdHJ1Y3QgZ3B1Y2cgKmdwdWNnLCBzdHJ1Y3QgZ3B1Y2dfYnVja2V0ICpidWNrZXQsIHU2NCBz
aXplKTsNCisNCitpbnQgZ3B1Y2dfdHJhbnNmZXJfY2hhcmdlKHN0cnVjdCBncHVjZyAqc291cmNl
LA0KKwkJCSAgc3RydWN0IGdwdWNnICpkZXN0LA0KKwkJCSAgc3RydWN0IGdwdWNnX2J1Y2tldCAq
YnVja2V0LA0KKwkJCSAgdTY0IHNpemUpOw0KIGludCBncHVjZ19yZWdpc3Rlcl9idWNrZXQoc3Ry
dWN0IGdwdWNnX2J1Y2tldCAqYnVja2V0LCBjb25zdCBjaGFyICpuYW1lKTsNCiAjZWxzZSAvKiBD
T05GSUdfQ0dST1VQX0dQVSAqLw0KIA0KQEAgLTExOCw2ICsxMjQsMTQgQEAgc3RhdGljIGlubGlu
ZSB2b2lkIGdwdWNnX3VuY2hhcmdlKHN0cnVjdCBncHVjZyAqZ3B1Y2csDQogCQkJCSAgc3RydWN0
IGdwdWNnX2J1Y2tldCAqYnVja2V0LA0KIAkJCQkgIHU2NCBzaXplKSB7fQ0KIA0KK3N0YXRpYyBp
bmxpbmUgaW50IGdwdWNnX3RyYW5zZmVyX2NoYXJnZShzdHJ1Y3QgZ3B1Y2cgKnNvdXJjZSwNCisJ
CQkJCXN0cnVjdCBncHVjZyAqZGVzdCwNCisJCQkJCXN0cnVjdCBncHVjZ19idWNrZXQgKmJ1Y2tl
dCwNCisJCQkJCXU2NCBzaXplKQ0KK3sNCisJcmV0dXJuIDA7DQorfQ0KKw0KIHN0YXRpYyBpbmxp
bmUgaW50IGdwdWNnX3JlZ2lzdGVyX2J1Y2tldChzdHJ1Y3QgZ3B1Y2dfYnVja2V0ICpidWNrZXQs
IGNvbnN0IGNoYXIgKm5hbWUpIHt9DQogI2VuZGlmIC8qIENPTkZJR19DR1JPVVBfR1BVICovDQog
I2VuZGlmIC8qIF9DR1JPVVBfR1BVX0ggKi8NCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2Rt
YS1idWYuaCBiL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oDQppbmRleCA4ZTdjNTVjODMwYjMuLjQz
OGFkODU3N2I3NiAxMDA2NDQNCi0tLSBhL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oDQorKysgYi9p
bmNsdWRlL2xpbnV4L2RtYS1idWYuaA0KQEAgLTE4LDYgKzE4LDcgQEANCiAjaW5jbHVkZSA8bGlu
dXgvZmlsZS5oPg0KICNpbmNsdWRlIDxsaW51eC9lcnIuaD4NCiAjaW5jbHVkZSA8bGludXgvc2Nh
dHRlcmxpc3QuaD4NCisjaW5jbHVkZSA8bGludXgvc2NoZWQuaD4NCiAjaW5jbHVkZSA8bGludXgv
bGlzdC5oPg0KICNpbmNsdWRlIDxsaW51eC9kbWEtbWFwcGluZy5oPg0KICNpbmNsdWRlIDxsaW51
eC9mcy5oPg0KQEAgLTY1MCw5ICs2NTEsMTQgQEAgdm9pZCBkbWFfYnVmX3Z1bm1hcChzdHJ1Y3Qg
ZG1hX2J1ZiAqZG1hYnVmLCBzdHJ1Y3QgaW9zeXNfbWFwICptYXApOw0KIHZvaWQgZG1hX2J1Zl9l
eHBfaW5mb19zZXRfZ3B1Y2coc3RydWN0IGRtYV9idWZfZXhwb3J0X2luZm8gKmV4cF9pbmZvLA0K
IAkJCQlzdHJ1Y3QgZ3B1Y2cgKmdwdWNnLA0KIAkJCQlzdHJ1Y3QgZ3B1Y2dfYnVja2V0ICpncHVj
Z19idWNrZXQpOw0KKw0KK2ludCBkbWFfYnVmX3RyYW5zZmVyX2NoYXJnZShzdHJ1Y3QgZG1hX2J1
ZiAqZG1hYnVmLCBzdHJ1Y3QgdGFza19zdHJ1Y3QgKnRhcmdldCk7DQogI2Vsc2UvKiBDT05GSUdf
Q0dST1VQX0dQVSAqLw0KIHN0YXRpYyBpbmxpbmUgdm9pZCBkbWFfYnVmX2V4cF9pbmZvX3NldF9n
cHVjZyhzdHJ1Y3QgZG1hX2J1Zl9leHBvcnRfaW5mbyAqZXhwX2luZm8sDQogCQkJCQkgICAgICBz
dHJ1Y3QgZ3B1Y2cgKmdwdWNnLA0KIAkJCQkJICAgICAgc3RydWN0IGdwdWNnX2J1Y2tldCAqZ3B1
Y2dfYnVja2V0KSB7fQ0KKw0KK3N0YXRpYyBpbmxpbmUgaW50IGRtYV9idWZfdHJhbnNmZXJfY2hh
cmdlKHN0cnVjdCBkbWFfYnVmICpkbWFidWYsIHN0cnVjdCB0YXNrX3N0cnVjdCAqdGFyZ2V0KQ0K
K3sgcmV0dXJuIDA7IH0NCiAjZW5kaWYgLyogQ09ORklHX0NHUk9VUF9HUFUgKi8NCiAjZW5kaWYg
LyogX19ETUFfQlVGX0hfXyAqLw0KZGlmZiAtLWdpdCBhL2tlcm5lbC9jZ3JvdXAvZ3B1LmMgYi9r
ZXJuZWwvY2dyb3VwL2dwdS5jDQppbmRleCAzNGQwYTViODU4MzQuLjdkZmJlMGZkN2U0NSAxMDA2
NDQNCi0tLSBhL2tlcm5lbC9jZ3JvdXAvZ3B1LmMNCisrKyBiL2tlcm5lbC9jZ3JvdXAvZ3B1LmMN
CkBAIC0yNTIsNiArMjUyLDY4IEBAIHZvaWQgZ3B1Y2dfdW5jaGFyZ2Uoc3RydWN0IGdwdWNnICpn
cHVjZywgc3RydWN0IGdwdWNnX2J1Y2tldCAqYnVja2V0LCB1NjQgc2l6ZSkNCiAJY3NzX3B1dCgm
Z3B1Y2ctPmNzcyk7DQogfQ0KIA0KKy8qKg0KKyAqIGdwdWNnX3RyYW5zZmVyX2NoYXJnZSAtIFRy
YW5zZmVyIGEgR1BVIGNoYXJnZSBmcm9tIG9uZSBjZ3JvdXAgdG8gYW5vdGhlci4NCisgKg0KKyAq
IEBzb3VyY2U6CVtpbl0JVGhlIEdQVSBjZ3JvdXAgdGhlIGNoYXJnZSB3aWxsIGJlIHRyYW5zZmVy
cmVkIGZyb20uDQorICogQGRlc3Q6CVtpbl0JVGhlIEdQVSBjZ3JvdXAgdGhlIGNoYXJnZSB3aWxs
IGJlIHRyYW5zZmVycmVkIHRvLg0KKyAqIEBidWNrZXQ6CVtpbl0JVGhlIEdQVSBjZ3JvdXAgYnVj
a2V0IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGNoYXJnZS4NCisgKiBAc2l6ZToJW2luXQlUaGUgc2l6
ZSBvZiB0aGUgbWVtb3J5IGluIGJ5dGVzLg0KKyAqICAgICAgICAgICAgICAgICAgICAgIFRoaXMg
c2l6ZSB3aWxsIGJlIHJvdW5kZWQgdXAgdG8gdGhlIG5lYXJlc3QgcGFnZSBzaXplLg0KKyAqDQor
ICogUmV0dXJucyAwIG9uIHN1Y2Nlc3MsIG9yIGEgbmVnYXRpdmUgZXJybm8gY29kZSBvdGhlcndp
c2UuDQorICovDQoraW50IGdwdWNnX3RyYW5zZmVyX2NoYXJnZShzdHJ1Y3QgZ3B1Y2cgKnNvdXJj
ZSwNCisJCQkgIHN0cnVjdCBncHVjZyAqZGVzdCwNCisJCQkgIHN0cnVjdCBncHVjZ19idWNrZXQg
KmJ1Y2tldCwNCisJCQkgIHU2NCBzaXplKQ0KK3sNCisJc3RydWN0IHBhZ2VfY291bnRlciAqY291
bnRlcjsNCisJdTY0IG5yX3BhZ2VzOw0KKwlzdHJ1Y3QgZ3B1Y2dfcmVzb3VyY2VfcG9vbCAqcnBf
c291cmNlLCAqcnBfZGVzdDsNCisJaW50IHJldCA9IDA7DQorDQorCW5yX3BhZ2VzID0gUEFHRV9B
TElHTihzaXplKSA+PiBQQUdFX1NISUZUOw0KKw0KKwltdXRleF9sb2NrKCZncHVjZ19tdXRleCk7
DQorCXJwX3NvdXJjZSA9IGNnX3Jwb29sX2ZpbmRfbG9ja2VkKHNvdXJjZSwgYnVja2V0KTsNCisJ
aWYgKHVubGlrZWx5KCFycF9zb3VyY2UpKSB7DQorCQlyZXQgPSAtRU5PRU5UOw0KKwkJZ290byBl
eGl0X2Vhcmx5Ow0KKwl9DQorDQorCXJwX2Rlc3QgPSBjZ19ycG9vbF9nZXRfbG9ja2VkKGRlc3Qs
IGJ1Y2tldCk7DQorCWlmIChJU19FUlIocnBfZGVzdCkpIHsNCisJCXJldCA9IFBUUl9FUlIocnBf
ZGVzdCk7DQorCQlnb3RvIGV4aXRfZWFybHk7DQorCX0NCisNCisJLyoNCisJICogRmlyc3QgdW5j
aGFyZ2UgZnJvbSB0aGUgcG9vbCBpdCdzIGN1cnJlbnRseSBjaGFyZ2VkIHRvLiBUaGlzIG9yZGVy
aW5nIGF2b2lkcyBkb3VibGUNCisJICogY2hhcmdpbmcgd2hpbGUgdGhlIHRyYW5zZmVyIGlzIGlu
IHByb2dyZXNzLCB3aGljaCBjb3VsZCBjYXVzZSB1cyB0byBoaXQgYSBsaW1pdC4NCisJICogSWYg
dGhlIHRyeV9jaGFyZ2UgZmFpbHMgZm9yIHRoaXMgdHJhbnNmZXIsIHdlIG5lZWQgdG8gYmUgYWJs
ZSB0byByZXZlcnNlIHRoaXMgdW5jaGFyZ2UsDQorCSAqIHNvIHdlIGNvbnRpbnVlIHRvIGhvbGQg
dGhlIGdwdWNnX211dGV4IGhlcmUuDQorCSAqLw0KKwlwYWdlX2NvdW50ZXJfdW5jaGFyZ2UoJnJw
X3NvdXJjZS0+dG90YWwsIG5yX3BhZ2VzKTsNCisJY3NzX3B1dCgmc291cmNlLT5jc3MpOw0KKw0K
KwkvKiBOb3cgYXR0ZW1wdCB0aGUgbmV3IGNoYXJnZSAqLw0KKwlpZiAocGFnZV9jb3VudGVyX3Ry
eV9jaGFyZ2UoJnJwX2Rlc3QtPnRvdGFsLCBucl9wYWdlcywgJmNvdW50ZXIpKSB7DQorCQljc3Nf
Z2V0KCZkZXN0LT5jc3MpOw0KKwl9IGVsc2Ugew0KKwkJLyoNCisJCSAqIFRoZSBuZXcgY2hhcmdl
IGZhaWxlZCwgc28gcmV2ZXJzZSB0aGUgdW5jaGFyZ2UgZnJvbSBhYm92ZS4gVGhpcyBzaG91bGQg
YWx3YXlzDQorCQkgKiBzdWNjZWVkIHNpbmNlIGNoYXJnZXMgb24gc291cmNlIGFyZSBibG9ja2Vk
IGJ5IGdwdWNnX211dGV4Lg0KKwkJICovDQorCQlXQVJOX09OKCFwYWdlX2NvdW50ZXJfdHJ5X2No
YXJnZSgmcnBfc291cmNlLT50b3RhbCwgbnJfcGFnZXMsICZjb3VudGVyKSk7DQorCQljc3NfZ2V0
KCZzb3VyY2UtPmNzcyk7DQorCQlyZXQgPSAtRU5PTUVNOw0KKwl9DQorZXhpdF9lYXJseToNCisJ
bXV0ZXhfdW5sb2NrKCZncHVjZ19tdXRleCk7DQorCXJldHVybiByZXQ7DQorfQ0KKw0KIC8qKg0K
ICAqIGdwdWNnX3JlZ2lzdGVyX2J1Y2tldCAtIFJlZ2lzdGVycyBhIGJ1Y2tldCBmb3IgbWVtb3J5
IGFjY291bnRpbmcgdXNpbmcgdGhlDQogICogR1BVIGNncm91cCBjb250cm9sbGVyLg0KLS0gDQoy
LjM2LjAucmMwLjQ3MC5nZDM2MTM5N2YwZC1nb29nDQoNCl9fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fCkxpbmFyby1tbS1zaWcgbWFpbGluZyBsaXN0IC0tIGxp
bmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpUbyB1bnN1YnNjcmliZSBzZW5kIGFuIGVtYWls
IHRvIGxpbmFyby1tbS1zaWctbGVhdmVAbGlzdHMubGluYXJvLm9yZwo=
