Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 67A8D3F8B8B
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 26 Aug 2021 18:08:23 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 0DD716102D
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 26 Aug 2021 16:08:12 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id F1EFC629CD; Thu, 26 Aug 2021 16:08:10 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 9CCDE610D0;
	Thu, 26 Aug 2021 16:08:07 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 37B5060DC1
 for <linaro-mm-sig@lists.linaro.org>; Thu, 26 Aug 2021 16:08:05 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 35792610D0; Thu, 26 Aug 2021 16:08:05 +0000 (UTC)
Received: from mail-wr1-f47.google.com (mail-wr1-f47.google.com
 [209.85.221.47])
 by lists.linaro.org (Postfix) with ESMTPS id 2E10760DC1
 for <linaro-mm-sig@lists.linaro.org>; Thu, 26 Aug 2021 16:08:03 +0000 (UTC)
Received: by mail-wr1-f47.google.com with SMTP id u9so5886052wrg.8
 for <linaro-mm-sig@lists.linaro.org>; Thu, 26 Aug 2021 09:08:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc:content-transfer-encoding;
 bh=4P77TwOPdHVoIP43EVGu36WwTX3449lDutu56CYSjjI=;
 b=IIMsONKwMj2Q0i/dKhcqnhE1+axnJPRhRgJSsjaFOo8Fi301W7IyIU/vvC0kIZ8bgu
 Je8GdZqD8Q+N5ptSmRVGI3epIzsZDcDnm/k++bXrc9tMepWA8tbXMxHqk3RQHTK/HDQM
 avf10fHLSNVM9n97yiDhZ8mQdjq02j6mqSNwWVdIBjaMFbU2sJSgr4fzt+qpGFIq8dpl
 SFShP3yZA9ShUK1nVbF6Ea+PmQApjEJW3IG30Nk5QCLV2eL6THX4rLDjXuzBoV/rs6Uk
 ZNRM13LILVQwTEdkszgBpPzHc+HSb57pJNc7f25Xv0tkpu5YML8YaKsR8f2Um7NOAGrO
 0Oxw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc:content-transfer-encoding;
 bh=4P77TwOPdHVoIP43EVGu36WwTX3449lDutu56CYSjjI=;
 b=QLHX/BP5z8waR43eNQFOg5CZf1XqGBOEWWEqJTxH5g9EUThG2NN9CbSMaM8ieWG69+
 qVev3iSQ9vRH/Iby/dHEIpLhGiwlxMOMrK/3A8QfDpmfiCtA8uEMuZ9u/9EEkxy5sz/H
 YeYks2jAUdaI7dnGBXZlbTqd9AxKl41UA2R7gSLQtrTwNSTlwYaSx0wUR+/VxmsUatXZ
 BEO/FdlANNl0qJsWDytz4GJHwyIfUyzlosQBX2aVqkfQoAumDzFGxqDcGF+GRaNJmeAE
 08OiaGB6Uypea6vpDzbcae4MynHiX+g0AUI9QDmyDprAYSwNWpaNySJojq5ZyOI2g2Q1
 pMBA==
X-Gm-Message-State: AOAM530i8S45mK9wI3ULoBnm5kUbkFXeD/BJVwJAmM+md8eETXIobtNy
 U1RK5czo5uZpWy0DhnsusquORQ4VcRzbOWDiV80=
X-Google-Smtp-Source: ABdhPJwLEP2d6R9vXs1Mn5jrbDqd3fYAXN3EKb1gwE4cg5t3k5Lj8O18agn2DnUySbO35LQra3OhJpgNFQKmONRXbZA=
X-Received: by 2002:adf:f90e:: with SMTP id b14mr5170152wrr.28.1629994082123; 
 Thu, 26 Aug 2021 09:08:02 -0700 (PDT)
MIME-Version: 1.0
References: <20210805104705.862416-1-daniel.vetter@ffwll.ch>
 <20210805104705.862416-13-daniel.vetter@ffwll.ch>
In-Reply-To: <20210805104705.862416-13-daniel.vetter@ffwll.ch>
From: Rob Clark <robdclark@gmail.com>
Date: Thu, 26 Aug 2021 09:12:21 -0700
Message-ID: <CAF6AEGs2yxBe2oW_wPkodL80jkFNPhrrAtmuc60=pzV_dp=igg@mail.gmail.com>
To: Daniel Vetter <daniel.vetter@ffwll.ch>
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: Re: [Linaro-mm-sig] [PATCH v5 12/20] drm/msm: Use scheduler
 dependency handling
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: freedreno <freedreno@lists.freedesktop.org>,
 linux-arm-msm <linux-arm-msm@vger.kernel.org>,
 Intel Graphics Development <intel-gfx@lists.freedesktop.org>,
 DRI Development <dri-devel@lists.freedesktop.org>,
 =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>,
 "moderated list:DMA BUFFER SHARING FRAMEWORK" <linaro-mm-sig@lists.linaro.org>,
 Daniel Vetter <daniel.vetter@intel.com>, Sean Paul <sean@poorly.run>,
 "open list:DMA BUFFER SHARING FRAMEWORK" <linux-media@vger.kernel.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

T24gVGh1LCBBdWcgNSwgMjAyMSBhdCAzOjQ3IEFNIERhbmllbCBWZXR0ZXIgPGRhbmllbC52ZXR0
ZXJAZmZ3bGwuY2g+IHdyb3RlOgo+Cj4gZHJtX3NjaGVkX2pvYl9pbml0IGlzIGFscmVhZHkgYXQg
dGhlIHJpZ2h0IHBsYWNlLCBzbyB0aGlzIGJvaWxzIGRvd24KPiB0byBkZWxldGluZyBjb2RlLgo+
Cj4gU2lnbmVkLW9mZi1ieTogRGFuaWVsIFZldHRlciA8ZGFuaWVsLnZldHRlckBpbnRlbC5jb20+
Cj4gQ2M6IFJvYiBDbGFyayA8cm9iZGNsYXJrQGdtYWlsLmNvbT4KPiBDYzogU2VhbiBQYXVsIDxz
ZWFuQHBvb3JseS5ydW4+Cj4gQ2M6IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5v
cmc+Cj4gQ2M6ICJDaHJpc3RpYW4gS8O2bmlnIiA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPgo+
IENjOiBsaW51eC1hcm0tbXNtQHZnZXIua2VybmVsLm9yZwo+IENjOiBmcmVlZHJlbm9AbGlzdHMu
ZnJlZWRlc2t0b3Aub3JnCj4gQ2M6IGxpbnV4LW1lZGlhQHZnZXIua2VybmVsLm9yZwo+IENjOiBs
aW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKCnItYgoKPiAtLS0KPiAgZHJpdmVycy9ncHUv
ZHJtL21zbS9tc21fZ2VtLmggICAgICAgIHwgIDUgLS0tLS0KPiAgZHJpdmVycy9ncHUvZHJtL21z
bS9tc21fZ2VtX3N1Ym1pdC5jIHwgMTkgKysrKystLS0tLS0tLS0tLS0tLQo+ICBkcml2ZXJzL2dw
dS9kcm0vbXNtL21zbV9yaW5nYnVmZmVyLmMgfCAxMiAtLS0tLS0tLS0tLS0KPiAgMyBmaWxlcyBj
aGFuZ2VkLCA1IGluc2VydGlvbnMoKyksIDMxIGRlbGV0aW9ucygtKQo+Cj4gZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dlbS5oIGIvZHJpdmVycy9ncHUvZHJtL21zbS9tc21f
Z2VtLmgKPiBpbmRleCBmOWUzZmZiMjMwOWEuLjhiZjBhYzcwN2ZkNyAxMDA2NDQKPiAtLS0gYS9k
cml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW0uaAo+ICsrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20v
bXNtX2dlbS5oCj4gQEAgLTMxMiwxMSArMzEyLDYgQEAgc3RydWN0IG1zbV9nZW1fc3VibWl0IHsK
PiAgICAgICAgIHN0cnVjdCB3d19hY3F1aXJlX2N0eCB0aWNrZXQ7Cj4gICAgICAgICB1aW50MzJf
dCBzZXFubzsgICAgICAgICAvKiBTZXF1ZW5jZSBudW1iZXIgb2YgdGhlIHN1Ym1pdCBvbiB0aGUg
cmluZyAqLwo+Cj4gLSAgICAgICAvKiBBcnJheSBvZiBzdHJ1Y3QgZG1hX2ZlbmNlICogdG8gYmxv
Y2sgb24gYmVmb3JlIHN1Ym1pdHRpbmcgdGhpcyBqb2IuCj4gLSAgICAgICAgKi8KPiAtICAgICAg
IHN0cnVjdCB4YXJyYXkgZGVwczsKPiAtICAgICAgIHVuc2lnbmVkIGxvbmcgbGFzdF9kZXA7Cj4g
LQo+ICAgICAgICAgLyogSHcgZmVuY2UsIHdoaWNoIGlzIGNyZWF0ZWQgd2hlbiB0aGUgc2NoZWR1
bGVyIGV4ZWN1dGVzIHRoZSBqb2IsIGFuZAo+ICAgICAgICAgICogaXMgc2lnbmFsZWQgd2hlbiB0
aGUgaHcgZmluaXNoZXMgKHZpYSBzZXFubyB3cml0ZSBmcm9tIGNtZHN0cmVhbSkKPiAgICAgICAg
ICAqLwo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMKPiBpbmRleCA5NmNlYTBiYTRj
ZmQuLmZiNWEyZWFiMjdhMiAxMDA2NDQKPiAtLS0gYS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9n
ZW1fc3VibWl0LmMKPiArKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMK
PiBAQCAtNTIsOCArNTIsNiBAQCBzdGF0aWMgc3RydWN0IG1zbV9nZW1fc3VibWl0ICpzdWJtaXRf
Y3JlYXRlKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsCj4gICAgICAgICAgICAgICAgIHJldHVybiBF
UlJfUFRSKHJldCk7Cj4gICAgICAgICB9Cj4KPiAtICAgICAgIHhhX2luaXRfZmxhZ3MoJnN1Ym1p
dC0+ZGVwcywgWEFfRkxBR1NfQUxMT0MpOwo+IC0KPiAgICAgICAgIGtyZWZfaW5pdCgmc3VibWl0
LT5yZWYpOwo+ICAgICAgICAgc3VibWl0LT5kZXYgPSBkZXY7Cj4gICAgICAgICBzdWJtaXQtPmFz
cGFjZSA9IHF1ZXVlLT5jdHgtPmFzcGFjZTsKPiBAQCAtNzIsOCArNzAsNiBAQCB2b2lkIF9fbXNt
X2dlbV9zdWJtaXRfZGVzdHJveShzdHJ1Y3Qga3JlZiAqa3JlZikKPiAgewo+ICAgICAgICAgc3Ry
dWN0IG1zbV9nZW1fc3VibWl0ICpzdWJtaXQgPQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGNv
bnRhaW5lcl9vZihrcmVmLCBzdHJ1Y3QgbXNtX2dlbV9zdWJtaXQsIHJlZik7Cj4gLSAgICAgICB1
bnNpZ25lZCBsb25nIGluZGV4Owo+IC0gICAgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7Cj4g
ICAgICAgICB1bnNpZ25lZCBpOwo+Cj4gICAgICAgICBpZiAoc3VibWl0LT5mZW5jZV9pZCkgewo+
IEBAIC04MiwxMiArNzgsNiBAQCB2b2lkIF9fbXNtX2dlbV9zdWJtaXRfZGVzdHJveShzdHJ1Y3Qg
a3JlZiAqa3JlZikKPiAgICAgICAgICAgICAgICAgbXV0ZXhfdW5sb2NrKCZzdWJtaXQtPnF1ZXVl
LT5sb2NrKTsKPiAgICAgICAgIH0KPgo+IC0gICAgICAgeGFfZm9yX2VhY2ggKCZzdWJtaXQtPmRl
cHMsIGluZGV4LCBmZW5jZSkgewo+IC0gICAgICAgICAgICAgICBkbWFfZmVuY2VfcHV0KGZlbmNl
KTsKPiAtICAgICAgIH0KPiAtCj4gLSAgICAgICB4YV9kZXN0cm95KCZzdWJtaXQtPmRlcHMpOwo+
IC0KPiAgICAgICAgIGRtYV9mZW5jZV9wdXQoc3VibWl0LT51c2VyX2ZlbmNlKTsKPiAgICAgICAg
IGRtYV9mZW5jZV9wdXQoc3VibWl0LT5od19mZW5jZSk7Cj4KPiBAQCAtMzQzLDggKzMzMyw5IEBA
IHN0YXRpYyBpbnQgc3VibWl0X2ZlbmNlX3N5bmMoc3RydWN0IG1zbV9nZW1fc3VibWl0ICpzdWJt
aXQsIGJvb2wgbm9faW1wbGljaXQpCj4gICAgICAgICAgICAgICAgIGlmIChub19pbXBsaWNpdCkK
PiAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKPgo+IC0gICAgICAgICAgICAgICBy
ZXQgPSBkcm1fZ2VtX2ZlbmNlX2FycmF5X2FkZF9pbXBsaWNpdCgmc3VibWl0LT5kZXBzLCBvYmos
Cj4gLSAgICAgICAgICAgICAgICAgICAgICAgd3JpdGUpOwo+ICsgICAgICAgICAgICAgICByZXQg
PSBkcm1fc2NoZWRfam9iX2FkZF9pbXBsaWNpdF9kZXBlbmRlbmNpZXMoJnN1Ym1pdC0+YmFzZSwK
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIG9iaiwKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHdyaXRlKTsKPiAgICAgICAgICAgICAgICAgaWYgKHJldCkKPiAg
ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKPiAgICAgICAgIH0KPiBAQCAtNTg4LDcgKzU3
OSw3IEBAIHN0YXRpYyBzdHJ1Y3QgZHJtX3N5bmNvYmogKiptc21fcGFyc2VfZGVwcyhzdHJ1Y3Qg
bXNtX2dlbV9zdWJtaXQgKnN1Ym1pdCwKPiAgICAgICAgICAgICAgICAgaWYgKHJldCkKPiAgICAg
ICAgICAgICAgICAgICAgICAgICBicmVhazsKPgo+IC0gICAgICAgICAgICAgICByZXQgPSBkcm1f
Z2VtX2ZlbmNlX2FycmF5X2FkZCgmc3VibWl0LT5kZXBzLCBmZW5jZSk7Cj4gKyAgICAgICAgICAg
ICAgIHJldCA9IGRybV9zY2hlZF9qb2JfYWRkX2RlcGVuZGVuY3koJnN1Ym1pdC0+YmFzZSwgZmVu
Y2UpOwo+ICAgICAgICAgICAgICAgICBpZiAocmV0KQo+ICAgICAgICAgICAgICAgICAgICAgICAg
IGJyZWFrOwo+Cj4gQEAgLTc5OCw3ICs3ODksNyBAQCBpbnQgbXNtX2lvY3RsX2dlbV9zdWJtaXQo
c3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKPiAgICAgICAgICAgICAgICAgICAg
ICAgICBnb3RvIG91dF91bmxvY2s7Cj4gICAgICAgICAgICAgICAgIH0KPgo+IC0gICAgICAgICAg
ICAgICByZXQgPSBkcm1fZ2VtX2ZlbmNlX2FycmF5X2FkZCgmc3VibWl0LT5kZXBzLCBpbl9mZW5j
ZSk7Cj4gKyAgICAgICAgICAgICAgIHJldCA9IGRybV9zY2hlZF9qb2JfYWRkX2RlcGVuZGVuY3ko
JnN1Ym1pdC0+YmFzZSwgaW5fZmVuY2UpOwo+ICAgICAgICAgICAgICAgICBpZiAocmV0KQo+ICAg
ICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X3VubG9jazsKPiAgICAgICAgIH0KPiBkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fcmluZ2J1ZmZlci5jIGIvZHJpdmVycy9n
cHUvZHJtL21zbS9tc21fcmluZ2J1ZmZlci5jCj4gaW5kZXggYmQ1NGMxNDEyNjQ5Li42NTJiMWRl
ZGQ3YzEgMTAwNjQ0Cj4gLS0tIGEvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fcmluZ2J1ZmZlci5j
Cj4gKysrIGIvZHJpdmVycy9ncHUvZHJtL21zbS9tc21fcmluZ2J1ZmZlci5jCj4gQEAgLTExLDE3
ICsxMSw2IEBAIHN0YXRpYyB1aW50IG51bV9od19zdWJtaXNzaW9ucyA9IDg7Cj4gIE1PRFVMRV9Q
QVJNX0RFU0MobnVtX2h3X3N1Ym1pc3Npb25zLCAiVGhlIG1heCAjIG9mIGpvYnMgdG8gd3JpdGUg
aW50byByaW5nYnVmZmVyIChkZWZhdWx0IDgpIik7Cj4gIG1vZHVsZV9wYXJhbShudW1faHdfc3Vi
bWlzc2lvbnMsIHVpbnQsIDA2MDApOwo+Cj4gLXN0YXRpYyBzdHJ1Y3QgZG1hX2ZlbmNlICptc21f
am9iX2RlcGVuZGVuY3koc3RydWN0IGRybV9zY2hlZF9qb2IgKmpvYiwKPiAtICAgICAgICAgICAg
ICAgc3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKnNfZW50aXR5KQo+IC17Cj4gLSAgICAgICBzdHJ1
Y3QgbXNtX2dlbV9zdWJtaXQgKnN1Ym1pdCA9IHRvX21zbV9zdWJtaXQoam9iKTsKPiAtCj4gLSAg
ICAgICBpZiAoIXhhX2VtcHR5KCZzdWJtaXQtPmRlcHMpKQo+IC0gICAgICAgICAgICAgICByZXR1
cm4geGFfZXJhc2UoJnN1Ym1pdC0+ZGVwcywgc3VibWl0LT5sYXN0X2RlcCsrKTsKPiAtCj4gLSAg
ICAgICByZXR1cm4gTlVMTDsKPiAtfQo+IC0KPiAgc3RhdGljIHN0cnVjdCBkbWFfZmVuY2UgKm1z
bV9qb2JfcnVuKHN0cnVjdCBkcm1fc2NoZWRfam9iICpqb2IpCj4gIHsKPiAgICAgICAgIHN0cnVj
dCBtc21fZ2VtX3N1Ym1pdCAqc3VibWl0ID0gdG9fbXNtX3N1Ym1pdChqb2IpOwo+IEBAIC01Miw3
ICs0MSw2IEBAIHN0YXRpYyB2b2lkIG1zbV9qb2JfZnJlZShzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAq
am9iKQo+ICB9Cj4KPiAgY29uc3Qgc3RydWN0IGRybV9zY2hlZF9iYWNrZW5kX29wcyBtc21fc2No
ZWRfb3BzID0gewo+IC0gICAgICAgLmRlcGVuZGVuY3kgPSBtc21fam9iX2RlcGVuZGVuY3ksCj4g
ICAgICAgICAucnVuX2pvYiA9IG1zbV9qb2JfcnVuLAo+ICAgICAgICAgLmZyZWVfam9iID0gbXNt
X2pvYl9mcmVlCj4gIH07Cj4gLS0KPiAyLjMyLjAKPgpfX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdApMaW5hcm8t
bW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9saXN0cy5saW5hcm8ub3JnL21haWxtYW4v
bGlzdGluZm8vbGluYXJvLW1tLXNpZwo=
