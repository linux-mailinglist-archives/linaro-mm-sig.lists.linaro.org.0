Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id F3D811CF1F2
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 12 May 2020 11:52:48 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 1A37261892
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 12 May 2020 09:52:48 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 0BFF9618EF; Tue, 12 May 2020 09:52:48 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_BLOCKED,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,
	SPF_HELO_PASS autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E175C66051;
	Tue, 12 May 2020 09:08:43 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 4540365FAD
 for <linaro-mm-sig@lists.linaro.org>; Tue, 12 May 2020 09:08:27 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 2CF436656E; Tue, 12 May 2020 09:08:27 +0000 (UTC)
Received: from mailout1.w1.samsung.com (mailout1.w1.samsung.com
 [210.118.77.11])
 by lists.linaro.org (Postfix) with ESMTPS id F41D265FA5
 for <linaro-mm-sig@lists.linaro.org>; Tue, 12 May 2020 09:01:31 +0000 (UTC)
Received: from eucas1p2.samsung.com (unknown [182.198.249.207])
 by mailout1.w1.samsung.com (KnoxPortal) with ESMTP id
 20200512090131euoutp010533635e51744f489b76573e7114d355~OPF2VQinz2636526365euoutp01a
 for <linaro-mm-sig@lists.linaro.org>; Tue, 12 May 2020 09:01:31 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout1.w1.samsung.com
 20200512090131euoutp010533635e51744f489b76573e7114d355~OPF2VQinz2636526365euoutp01a
Received: from eusmges3new.samsung.com (unknown [203.254.199.245]) by
 eucas1p2.samsung.com (KnoxPortal) with ESMTP id
 20200512090130eucas1p2b81adfa94a097e03f320141842c3f1b4~OPF2G42Za2399923999eucas1p2r;
 Tue, 12 May 2020 09:01:30 +0000 (GMT)
Received: from eucas1p2.samsung.com ( [182.198.249.207]) by
 eusmges3new.samsung.com (EUCPMTA) with SMTP id 4F.7B.60698.AE56ABE5; Tue, 12
 May 2020 10:01:30 +0100 (BST)
Received: from eusmtrp2.samsung.com (unknown [182.198.249.139]) by
 eucas1p2.samsung.com (KnoxPortal) with ESMTPA id
 20200512090130eucas1p2eb86c5d34be56bbc81032bc0b6927d1e~OPF10kf9w2662726627eucas1p2f;
 Tue, 12 May 2020 09:01:30 +0000 (GMT)
Received: from eusmgms1.samsung.com (unknown [182.198.249.179]) by
 eusmtrp2.samsung.com (KnoxPortal) with ESMTP id
 20200512090130eusmtrp2dd079707b04541b50c83029cd93549aa~OPF1z322C0472504725eusmtrp2g;
 Tue, 12 May 2020 09:01:30 +0000 (GMT)
X-AuditID: cbfec7f5-a0fff7000001ed1a-67-5eba65ea4e36
Received: from eusmtip1.samsung.com ( [203.254.199.221]) by
 eusmgms1.samsung.com (EUCPMTA) with SMTP id 84.55.08375.AE56ABE5; Tue, 12
 May 2020 10:01:30 +0100 (BST)
Received: from AMDC2765.digital.local (unknown [106.120.51.73]) by
 eusmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200512090129eusmtip1a34e21c012665469a855771a71f3e9e7~OPF1Ju9Qd0919809198eusmtip18;
 Tue, 12 May 2020 09:01:29 +0000 (GMT)
From: Marek Szyprowski <m.szyprowski@samsung.com>
To: dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
Date: Tue, 12 May 2020 11:00:58 +0200
Message-Id: <20200512090058.14910-38-m.szyprowski@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200512090058.14910-1-m.szyprowski@samsung.com>
X-Brightmail-Tracker: H4sIAAAAAAAAA0WSeUiTYRzHed5rr8PZ6yb5YKEwKCjIIw1esMTA6kWprCAq8pj5oqZO2zyy
 Itdh6dQuDU0jTbydTZdHLkud2jxomYqYZmZGpmBmU8G7zbfjv8/ve/B7noeHRIWduB0ZJo1h
 ZVJJhJjgY3VvFt/tmmK1/s4TCjc63dCJ0NXZapxer7uP0v3zMwRdVtGO0O8fjWB0fpM7Pdc/
 htCa8QGc7tM+Jui0qlqcrmwb4dHFmhWEzpxe5NEtP7/inpsY1RMVYF4t5GOMpjyFYOoXPuPM
 aKoeYZ4XJjLDa+MokzFYApiXHxQEM740STB3asoBY9TYM13zRp6v4Ax/bzAbERbHypw8Avmh
 s+3rWPTQ8YuZtRcUYNhLCSxISLnBpZS3PCXgk0KqFMChAgMwG0JqDsDVDCvOMAKY3T+B/G2U
 9lzDOKMEwKKcu4AbTA1tzzRuThGUC1ROKwkz21BJAHakW5oZpdQoLFBRZhZRPrA3PQM1M0Zt
 g99HFjdYQHnA223pf7Y5wIqq5g3dwqSP5q1sbIbUJx4s7s7FuJAXTJqaJDgWwSl9DY/jrXC9
 IQ/hCjcAHDNU8rghDcC+69mAS7nDj4YlU5s0HW8HVGudOHk/7Jt7CMwypKzg4LQ1dwEr+KAu
 C+VkAUy+JeTS22GO/tm/tS09vSjHDPxW0YpyD9QOYHVmOX4POOT8X5YPQDmwZWPlkSGs3FXK
 xjvKJZHyWGmI47moSA0wfbDuNf38C/B6JUgHKBKILQXJuxv8hbgkTp4QqQOQRMU2gpthJkkQ
 LEm4xMqiAmSxEaxcB7aQmNhW4Fow6SekQiQxbDjLRrOyvy5CWtgpQIL6sAFbdg/qTIz3FbZr
 Cx3PrwU9NXr/iju959iV6lPR2aP6L0CU63xoUOopWm3eHDGyqpvIN0pD0X2tAcoDHXzrLhfP
 FkWmVaPOVnQ0/HJjzMzVcafUsobZgbJBSqzy8ZzMdT7i7oV4nz3xY7gpK/HgyWVHXqBD93yx
 fVG9X5sYk4dKXHaiMrnkN/yokBRcAwAA
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrDIsWRmVeSWpSXmKPExsVy+t/xu7qvUnfFGcxdJ2fRe+4kk8XGGetZ
 Lf5vm8hsceXrezaLlauPMllcnHmXxWLBfmuLL1ceMllsenyN1eLyrjlsFj0btrJarD1yl91i
 2aY/TBZT3v5ktzj44QmrA7/HmnlrGD32flvA4rFpVSebx/ZvD1g97ncfZ/LYvKTe4/a/x8we
 k28sZ/TYfbOBzePxr5dsHn1bVjF6fN4k53Hq62f2AN4oPZui/NKSVIWM/OISW6VoQwsjPUNL
 Cz0jE0s9Q2PzWCsjUyV9O5uU1JzMstQifbsEvYyPR/+zFNwKqpiytbCB8bZLFyMnh4SAicSK
 C40sXYxcHEICSxklXt85xwSRkJE4Oa2BFcIWlvhzrYsNougTo0T7sauMIAk2AUOJrrcQCRGB
 TkaJad0f2UEcZoGdzBL7bz8FqxIW8Ja41DuZGcRmEVCVeHH3J5jNK2An0X6kF2qdvMTqDQfA
 4pxA8fvz/7CA2EIChRKPrr5lmcDIt4CRYRWjSGppcW56brGhXnFibnFpXrpecn7uJkZgTG07
 9nPzDsZLG4MPMQpwMCrx8HYY7YwTYk0sK67MPcQowcGsJMLbkgkU4k1JrKxKLcqPLyrNSS0+
 xGgKdNREZinR5HxgvOeVxBuaGppbWBqaG5sbm1koifN2CByMERJITyxJzU5NLUgtgulj4uCU
 amB0vpzLouz9jb9k2sflk3oPsdle0jGN5V3u5LPMP713YjNXwncNwaYzNzfNXSv69VLObxuV
 q2dmWgrMnCez3nr/oj3FSx5t0G7b4CHXlCwk1X/0aLiqp1TtQiPJBafcNn0uOGp/4jHPDAEO
 JUPvQxsCcxeclQucbJLVm1z8aeKyFR/5Q98a+NxUYinOSDTUYi4qTgQAHzs3fr8CAAA=
X-CMS-MailID: 20200512090130eucas1p2eb86c5d34be56bbc81032bc0b6927d1e
X-Msg-Generator: CA
X-RootMTR: 20200512090130eucas1p2eb86c5d34be56bbc81032bc0b6927d1e
X-EPHeader: CA
CMS-TYPE: 201P
X-CMS-RootMailID: 20200512090130eucas1p2eb86c5d34be56bbc81032bc0b6927d1e
References: <20200512085710.14688-1-m.szyprowski@samsung.com>
 <20200512090058.14910-1-m.szyprowski@samsung.com>
 <CGME20200512090130eucas1p2eb86c5d34be56bbc81032bc0b6927d1e@eucas1p2.samsung.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Pawel Osciak <pawel@osciak.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, linux-media@vger.kernel.org,
 Daniel Vetter <daniel@ffwll.ch>, Hans Verkuil <hverkuil-cisco@xs4all.nl>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Robin Murphy <robin.murphy@arm.com>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH v4 38/38] videobuf2: use sgtable-based
	scatterlist wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VXNlIHJlY2VudGx5IGludHJvZHVjZWQgY29tbW9uIHdyYXBwZXJzIG9wZXJhdGluZyBkaXJlY3Rs
eSBvbiB0aGUgc3RydWN0CnNnX3RhYmxlIG9iamVjdHMgYW5kIHNjYXR0ZXJsaXN0IHBhZ2UgaXRl
cmF0b3JzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQKbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2ll
ciB0byBmb2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLCBi
ZWNhdXNlIHRoZSBjb2RlIGFscmVhZHkgcHJvcGVybHkgZGlkIGFsbCB0aGUKc2NhdGVybGlzdCBy
ZWxhdGVkIGNhbGxzLgoKU2lnbmVkLW9mZi1ieTogTWFyZWsgU3p5cHJvd3NraSA8bS5zenlwcm93
c2tpQHNhbXN1bmcuY29tPgotLS0KRm9yIG1vcmUgaW5mb3JtYXRpb24sIHNlZSAnW1BBVENIIHY0
IDAwLzM4XSBEUk06IGZpeCBzdHJ1Y3Qgc2dfdGFibGUgbmVudHMKdnMuIG9yaWdfbmVudHMgbWlz
dXNlJyB0aHJlYWQ6Cmh0dHBzOi8vbG9yZS5rZXJuZWwub3JnL2RyaS1kZXZlbC8yMDIwMDUxMjA4
NTcxMC4xNDY4OC0xLW0uc3p5cHJvd3NraUBzYW1zdW5nLmNvbS9ULwotLS0KIC4uLi9tZWRpYS9j
b21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMgIHwgNDEgKysrKysrKysrKy0t
LS0tLS0tLS0tLQogZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEt
c2cuYyAgfCAzMiArKysrKysrLS0tLS0tLS0tLQogZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9i
dWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMgfCAxMiArKystLS0tCiAzIGZpbGVzIGNoYW5nZWQsIDM0
IGluc2VydGlvbnMoKyksIDUxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jIGIvZHJpdmVycy9tZWRp
YS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMKaW5kZXggZDNhM2VlNS4u
YmYzMWE5ZCAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVv
YnVmMi1kbWEtY29udGlnLmMKKysrIGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3Zp
ZGVvYnVmMi1kbWEtY29udGlnLmMKQEAgLTQ4LDE2ICs0OCwxNSBAQCBzdHJ1Y3QgdmIyX2RjX2J1
ZiB7CiAKIHN0YXRpYyB1bnNpZ25lZCBsb25nIHZiMl9kY19nZXRfY29udGlndW91c19zaXplKHN0
cnVjdCBzZ190YWJsZSAqc2d0KQogewotCXN0cnVjdCBzY2F0dGVybGlzdCAqczsKIAlkbWFfYWRk
cl90IGV4cGVjdGVkID0gc2dfZG1hX2FkZHJlc3Moc2d0LT5zZ2wpOwotCXVuc2lnbmVkIGludCBp
OworCXN0cnVjdCBzZ19kbWFfcGFnZV9pdGVyIGRtYV9pdGVyOwogCXVuc2lnbmVkIGxvbmcgc2l6
ZSA9IDA7CiAKLQlmb3JfZWFjaF9zZyhzZ3QtPnNnbCwgcywgc2d0LT5uZW50cywgaSkgewotCQlp
ZiAoc2dfZG1hX2FkZHJlc3MocykgIT0gZXhwZWN0ZWQpCisJZm9yX2VhY2hfc2d0YWJsZV9kbWFf
cGFnZShzZ3QsICZkbWFfaXRlciwgMCkgeworCQlpZiAoc2dfcGFnZV9pdGVyX2RtYV9hZGRyZXNz
KCZkbWFfaXRlcikgIT0gZXhwZWN0ZWQpCiAJCQlicmVhazsKLQkJZXhwZWN0ZWQgPSBzZ19kbWFf
YWRkcmVzcyhzKSArIHNnX2RtYV9sZW4ocyk7Ci0JCXNpemUgKz0gc2dfZG1hX2xlbihzKTsKKwkJ
ZXhwZWN0ZWQgKz0gUEFHRV9TSVpFOworCQlzaXplICs9IFBBR0VfU0laRTsKIAl9CiAJcmV0dXJu
IHNpemU7CiB9CkBAIC05OSw4ICs5OCw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kY19wcmVwYXJlKHZv
aWQgKmJ1Zl9wcml2KQogCWlmICghc2d0IHx8IGJ1Zi0+ZGJfYXR0YWNoKQogCQlyZXR1cm47CiAK
LQlkbWFfc3luY19zZ19mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25l
bnRzLAotCQkJICAgICAgIGJ1Zi0+ZG1hX2Rpcik7CisJZG1hX3N5bmNfc2d0YWJsZV9mb3JfZGV2
aWNlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9CiAKIHN0YXRpYyB2b2lkIHZiMl9k
Y19maW5pc2godm9pZCAqYnVmX3ByaXYpCkBAIC0xMTIsNyArMTEwLDcgQEAgc3RhdGljIHZvaWQg
dmIyX2RjX2ZpbmlzaCh2b2lkICpidWZfcHJpdikKIAlpZiAoIXNndCB8fCBidWYtPmRiX2F0dGFj
aCkKIAkJcmV0dXJuOwogCi0JZG1hX3N5bmNfc2dfZm9yX2NwdShidWYtPmRldiwgc2d0LT5zZ2ws
IHNndC0+b3JpZ19uZW50cywgYnVmLT5kbWFfZGlyKTsKKwlkbWFfc3luY19zZ3RhYmxlX2Zvcl9j
cHUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyKTsKIH0KIAogLyoqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KQEAgLTI3Myw4ICsyNzEsOCBAQCBzdGF0aWMg
dm9pZCB2YjJfZGNfZG1hYnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCiAJCSAq
IG1lbW9yeSBsb2NhdGlvbnMgZG8gbm90IHJlcXVpcmUgYW55IGV4cGxpY2l0IGNhY2hlCiAJCSAq
IG1haW50ZW5hbmNlIHByaW9yIG9yIGFmdGVyIGJlaW5nIHVzZWQgYnkgdGhlIGRldmljZS4KIAkJ
ICovCi0JCWRtYV91bm1hcF9zZ19hdHRycyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+
b3JpZ19uZW50cywKLQkJCQkgICBhdHRhY2gtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZ
TkMpOworCQlkbWFfdW5tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRt
YV9kaXIsCisJCQkJICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAlzZ19mcmVlX3RhYmxlKHNn
dCk7CiAJa2ZyZWUoYXR0YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtMjk5LDgg
KzI5Nyw4IEBAIHN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kY19kbWFidWZfb3BzX21hcCgK
IAogCS8qIHJlbGVhc2UgYW55IHByZXZpb3VzIGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2Rp
ciAhPSBETUFfTk9ORSkgewotCQlkbWFfdW5tYXBfc2dfYXR0cnMoZGJfYXR0YWNoLT5kZXYsIHNn
dC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgYXR0YWNoLT5kbWFfZGlyLCBETUFfQVRU
Ul9TS0lQX0NQVV9TWU5DKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNn
dCwgYXR0YWNoLT5kbWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJCWF0
dGFjaC0+ZG1hX2RpciA9IERNQV9OT05FOwogCX0KIApAQCAtMzA4LDkgKzMwNiw4IEBAIHN0YXRp
YyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kY19kbWFidWZfb3BzX21hcCgKIAkgKiBtYXBwaW5nIHRv
IHRoZSBjbGllbnQgd2l0aCBuZXcgZGlyZWN0aW9uLCBubyBjYWNoZSBzeW5jCiAJICogcmVxdWly
ZWQgc2VlIGNvbW1lbnQgaW4gdmIyX2RjX2RtYWJ1Zl9vcHNfZGV0YWNoKCkKIAkgKi8KLQlzZ3Qt
Pm5lbnRzID0gZG1hX21hcF9zZ19hdHRycyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+
b3JpZ19uZW50cywKLQkJCQkgICAgICBkbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsK
LQlpZiAoIXNndC0+bmVudHMpIHsKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QsIGRtYV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpIHsKIAkJcHJf
ZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhfdW5sb2NrKGxvY2sp
OwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKQEAgLTQyMyw4ICs0MjAsOCBAQCBzdGF0aWMgdm9p
ZCB2YjJfZGNfcHV0X3VzZXJwdHIodm9pZCAqYnVmX3ByaXYpCiAJCSAqIE5vIG5lZWQgdG8gc3lu
YyB0byBDUFUsIGl0J3MgYWxyZWFkeSBzeW5jZWQgdG8gdGhlIENQVQogCQkgKiBzaW5jZSB0aGUg
ZmluaXNoKCkgbWVtb3Agd2lsbCBoYXZlIGJlZW4gY2FsbGVkIGJlZm9yZSB0aGlzLgogCQkgKi8K
LQkJZG1hX3VubWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRz
LAotCQkJCSAgIGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91
bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRS
X1NLSVBfQ1BVX1NZTkMpOwogCQlwYWdlcyA9IGZyYW1lX3ZlY3Rvcl9wYWdlcyhidWYtPnZlYyk7
CiAJCS8qIHNndCBzaG91bGQgZXhpc3Qgb25seSBpZiB2ZWN0b3IgY29udGFpbnMgcGFnZXMuLi4g
Ki8KIAkJQlVHX09OKElTX0VSUihwYWdlcykpOwpAQCAtNTIxLDkgKzUxOCw4IEBAIHN0YXRpYyB2
b2lkICp2YjJfZGNfZ2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25n
IHZhZGRyLAogCSAqIE5vIG5lZWQgdG8gc3luYyB0byB0aGUgZGV2aWNlLCB0aGlzIHdpbGwgaGFw
cGVuIGxhdGVyIHdoZW4gdGhlCiAJICogcHJlcGFyZSgpIG1lbW9wIGlzIGNhbGxlZC4KIAkgKi8K
LQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+
b3JpZ19uZW50cywKLQkJCQkgICAgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZ
TkMpOwotCWlmIChzZ3QtPm5lbnRzIDw9IDApIHsKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGJ1Zi0+
ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCSAgICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKSkg
ewogCQlwcl9lcnIoImZhaWxlZCB0byBtYXAgc2NhdHRlcmxpc3RcbiIpOwogCQlyZXQgPSAtRUlP
OwogCQlnb3RvIGZhaWxfc2d0X2luaXQ7CkBAIC01NDUsOCArNTQxLDcgQEAgc3RhdGljIHZvaWQg
KnZiMl9kY19nZXRfdXNlcnB0cihzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgdmFk
ZHIsCiAJcmV0dXJuIGJ1ZjsKIAogZmFpbF9tYXBfc2c6Ci0JZG1hX3VubWFwX3NnX2F0dHJzKGJ1
Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJICAgYnVmLT5kbWFfZGlyLCBE
TUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKKwlkbWFfdW5tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0
LCBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwogCiBmYWlsX3NndF9pbml0
OgogCXNnX2ZyZWVfdGFibGUoc2d0KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvY29tbW9u
L3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMgYi9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRl
b2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jCmluZGV4IDkyMDcyYTAuLjZkZGY5NTMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMKKysr
IGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYwpAQCAt
MTQyLDkgKzE0Miw4IEBAIHN0YXRpYyB2b2lkICp2YjJfZG1hX3NnX2FsbG9jKHN0cnVjdCBkZXZp
Y2UgKmRldiwgdW5zaWduZWQgbG9uZyBkbWFfYXR0cnMsCiAJICogTm8gbmVlZCB0byBzeW5jIHRv
IHRoZSBkZXZpY2UsIHRoaXMgd2lsbCBoYXBwZW4gbGF0ZXIgd2hlbiB0aGUKIAkgKiBwcmVwYXJl
KCkgbWVtb3AgaXMgY2FsbGVkLgogCSAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnX2F0dHJz
KGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgICAgIGJ1Zi0+ZG1h
X2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7Ci0JaWYgKCFzZ3QtPm5lbnRzKQorCWlmIChk
bWFfbWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLAorCQkJICAgIERNQV9B
VFRSX1NLSVBfQ1BVX1NZTkMpKSB7CiAJCWdvdG8gZmFpbF9tYXA7CiAKIAlidWYtPmhhbmRsZXIu
cmVmY291bnQgPSAmYnVmLT5yZWZjb3VudDsKQEAgLTE4MCw4ICsxNzksOCBAQCBzdGF0aWMgdm9p
ZCB2YjJfZG1hX3NnX3B1dCh2b2lkICpidWZfcHJpdikKIAlpZiAocmVmY291bnRfZGVjX2FuZF90
ZXN0KCZidWYtPnJlZmNvdW50KSkgewogCQlkcHJpbnRrKDEsICIlczogRnJlZWluZyBidWZmZXIg
b2YgJWQgcGFnZXNcbiIsIF9fZnVuY19fLAogCQkJYnVmLT5udW1fcGFnZXMpOwotCQlkbWFfdW5t
YXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAg
YnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKKwkJZG1hX3VubWFwX3NndGFi
bGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVf
U1lOQyk7CiAJCWlmIChidWYtPnZhZGRyKQogCQkJdm1fdW5tYXBfcmFtKGJ1Zi0+dmFkZHIsIGJ1
Zi0+bnVtX3BhZ2VzKTsKIAkJc2dfZnJlZV90YWJsZShidWYtPmRtYV9zZ3QpOwpAQCAtMjAyLDgg
KzIwMSw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfcHJlcGFyZSh2b2lkICpidWZfcHJpdikK
IAlpZiAoYnVmLT5kYl9hdHRhY2gpCiAJCXJldHVybjsKIAotCWRtYV9zeW5jX3NnX2Zvcl9kZXZp
Y2UoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkgICAgICAgYnVmLT5k
bWFfZGlyKTsKKwlkbWFfc3luY19zZ3RhYmxlX2Zvcl9kZXZpY2UoYnVmLT5kZXYsIHNndCwgYnVm
LT5kbWFfZGlyKTsKIH0KIAogc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19maW5pc2godm9pZCAqYnVm
X3ByaXYpCkBAIC0yMTUsNyArMjEzLDcgQEAgc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19maW5pc2go
dm9pZCAqYnVmX3ByaXYpCiAJaWYgKGJ1Zi0+ZGJfYXR0YWNoKQogCQlyZXR1cm47CiAKLQlkbWFf
c3luY19zZ19mb3JfY3B1KGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLCBidWYt
PmRtYV9kaXIpOworCWRtYV9zeW5jX3NndGFibGVfZm9yX2NwdShidWYtPmRldiwgc2d0LCBidWYt
PmRtYV9kaXIpOwogfQogCiBzdGF0aWMgdm9pZCAqdmIyX2RtYV9zZ19nZXRfdXNlcnB0cihzdHJ1
Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgdmFkZHIsCkBAIC0yNTgsOSArMjU2LDggQEAg
c3RhdGljIHZvaWQgKnZiMl9kbWFfc2dfZ2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1
bnNpZ25lZCBsb25nIHZhZGRyLAogCSAqIE5vIG5lZWQgdG8gc3luYyB0byB0aGUgZGV2aWNlLCB0
aGlzIHdpbGwgaGFwcGVuIGxhdGVyIHdoZW4gdGhlCiAJICogcHJlcGFyZSgpIG1lbW9wIGlzIGNh
bGxlZC4KIAkgKi8KLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0
LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICAgICBidWYtPmRtYV9kaXIsIERNQV9BVFRS
X1NLSVBfQ1BVX1NZTkMpOwotCWlmICghc2d0LT5uZW50cykKKwlpZiAoZG1hX21hcF9zZ3RhYmxl
KGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCSAgICBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKSkgewogCQlnb3RvIHVzZXJwdHJfZmFpbF9tYXA7CiAKIAlyZXR1cm4gYnVmOwpAQCAtMjg2
LDggKzI4Myw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfcHV0X3VzZXJwdHIodm9pZCAqYnVm
X3ByaXYpCiAKIAlkcHJpbnRrKDEsICIlczogUmVsZWFzaW5nIHVzZXJzcGFjZSBidWZmZXIgb2Yg
JWQgcGFnZXNcbiIsCiAJICAgICAgIF9fZnVuY19fLCBidWYtPm51bV9wYWdlcyk7Ci0JZG1hX3Vu
bWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLCBidWYtPmRt
YV9kaXIsCi0JCQkgICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKKwlkbWFfdW5tYXBfc2d0YWJs
ZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwog
CWlmIChidWYtPnZhZGRyKQogCQl2bV91bm1hcF9yYW0oYnVmLT52YWRkciwgYnVmLT5udW1fcGFn
ZXMpOwogCXNnX2ZyZWVfdGFibGUoYnVmLT5kbWFfc2d0KTsKQEAgLTQxMCw4ICs0MDYsNyBAQCBz
dGF0aWMgdm9pZCB2YjJfZG1hX3NnX2RtYWJ1Zl9vcHNfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpk
YnVmLAogCiAJLyogcmVsZWFzZSB0aGUgc2NhdHRlcmxpc3QgY2FjaGUgKi8KIAlpZiAoYXR0YWNo
LT5kbWFfZGlyICE9IERNQV9OT05FKQotCQlkbWFfdW5tYXBfc2coZGJfYXR0YWNoLT5kZXYsIHNn
dC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQlhdHRhY2gtPmRtYV9kaXIpOworCQlkbWFfdW5t
YXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIpOwogCXNnX2Zy
ZWVfdGFibGUoc2d0KTsKIAlrZnJlZShhdHRhY2gpOwogCWRiX2F0dGFjaC0+cHJpdiA9IE5VTEw7
CkBAIC00MzYsMTUgKzQzMSwxMiBAQCBzdGF0aWMgc3RydWN0IHNnX3RhYmxlICp2YjJfZG1hX3Nn
X2RtYWJ1Zl9vcHNfbWFwKAogCiAJLyogcmVsZWFzZSBhbnkgcHJldmlvdXMgY2FjaGUgKi8KIAlp
ZiAoYXR0YWNoLT5kbWFfZGlyICE9IERNQV9OT05FKSB7Ci0JCWRtYV91bm1hcF9zZyhkYl9hdHRh
Y2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCWF0dGFjaC0+ZG1hX2Rpcik7
CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2Rp
cik7CiAJCWF0dGFjaC0+ZG1hX2RpciA9IERNQV9OT05FOwogCX0KIAogCS8qIG1hcHBpbmcgdG8g
dGhlIGNsaWVudCB3aXRoIG5ldyBkaXJlY3Rpb24gKi8KLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9z
ZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQlkbWFfZGly
KTsKLQlpZiAoIXNndC0+bmVudHMpIHsKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+
ZGV2LCBzZ3QsIGRtYV9kaXIsIDApKSB7CiAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBzY2F0dGVy
bGlzdFxuIik7CiAJCW11dGV4X3VubG9jayhsb2NrKTsKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTyk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLXZt
YWxsb2MuYyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxv
Yy5jCmluZGV4IGM2NmZkYTQuLmJmNWFjNjMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29t
bW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jCisrKyBiL2RyaXZlcnMvbWVkaWEvY29t
bW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jCkBAIC0yMjksNyArMjI5LDcgQEAgc3Rh
dGljIGludCB2YjJfdm1hbGxvY19kbWFidWZfb3BzX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1
ZiwKIAkJa2ZyZWUoYXR0YWNoKTsKIAkJcmV0dXJuIHJldDsKIAl9Ci0JZm9yX2VhY2hfc2coc2d0
LT5zZ2wsIHNnLCBzZ3QtPm5lbnRzLCBpKSB7CisJZm9yX2VhY2hfc2d0YWJsZV9zZyhzZ3QsIHNn
LCBpKSB7CiAJCXN0cnVjdCBwYWdlICpwYWdlID0gdm1hbGxvY190b19wYWdlKHZhZGRyKTsKIAog
CQlpZiAoIXBhZ2UpIHsKQEAgLTI1OSw4ICsyNTksNyBAQCBzdGF0aWMgdm9pZCB2YjJfdm1hbGxv
Y19kbWFidWZfb3BzX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAogCS8qIHJlbGVhc2Ug
dGhlIHNjYXR0ZXJsaXN0IGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9O
RSkKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25l
bnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNo
LT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAlzZ19mcmVlX3RhYmxlKHNndCk7CiAJ
a2ZyZWUoYXR0YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtMjg1LDE1ICsyODQs
MTIgQEAgc3RhdGljIHN0cnVjdCBzZ190YWJsZSAqdmIyX3ZtYWxsb2NfZG1hYnVmX29wc19tYXAo
CiAKIAkvKiByZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9k
aXIgIT0gRE1BX05PTkUpIHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNn
bCwgc2d0LT5vcmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3Nn
dGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAkJYXR0YWNo
LT5kbWFfZGlyID0gRE1BX05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdp
dGggbmV3IGRpcmVjdGlvbiAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+
ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0
LT5uZW50cykgeworCWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1h
X2RpciwgMCkpIHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJ
bXV0ZXhfdW5sb2NrKGxvY2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKLS0gCjEuOS4xCgpf
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0t
c2lnIG1haWxpbmcgbGlzdApMaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9s
aXN0cy5saW5hcm8ub3JnL21haWxtYW4vbGlzdGluZm8vbGluYXJvLW1tLXNpZwo=
