Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 127533B30B7
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 24 Jun 2021 16:00:57 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 2186063522
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 24 Jun 2021 14:00:56 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 163256350E; Thu, 24 Jun 2021 14:00:53 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E41B360773;
	Thu, 24 Jun 2021 14:00:49 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 5E68863570
 for <linaro-mm-sig@lists.linaro.org>; Thu, 24 Jun 2021 14:00:44 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id C8A8C63564; Thu, 24 Jun 2021 14:00:43 +0000 (UTC)
Received: from mail-wr1-f50.google.com (mail-wr1-f50.google.com
 [209.85.221.50])
 by lists.linaro.org (Postfix) with ESMTPS id 756826350E
 for <linaro-mm-sig@lists.linaro.org>; Thu, 24 Jun 2021 14:00:40 +0000 (UTC)
Received: by mail-wr1-f50.google.com with SMTP id u11so6762115wrw.11
 for <linaro-mm-sig@lists.linaro.org>; Thu, 24 Jun 2021 07:00:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=ffwll.ch; s=google;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=uw+bJEz7Z1LPFg3qYJohlw+E0J/p7vlfvaHzmAGHctw=;
 b=kPGnMijBQ8kHKTBge9tfX0CO4KdXNDBJknX0WihYjA1ziN1JJhl3aElUpWhObbhs8H
 mi3adulYRFNY78eVm6ZDHDr78tnMPv/md8lG+FPTCeK1LLa2wc/qcOJ1cKrjPrNr794/
 E9PQd/3+1YLZaoHUr6YFJmHangsprhv/E/gjM=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=uw+bJEz7Z1LPFg3qYJohlw+E0J/p7vlfvaHzmAGHctw=;
 b=kLQJDrsWupNIdwVzHOLhVHpY1HYSzmfFalksLACKW2JolH5btu1teFj+u8HmdqzlCf
 nD/p3gihdiRBS6h1uGDUDYK4o7qal6N1MXx6IAi1abEGF4ET54HgwntazEnrOUBj9bSa
 no/Ebk4fE4hx93COtNHguFxnRY41Bf3M9tcOZnBtCVlmDtB4hpjKHsuJlaigvrCJEflo
 /xZfPiktB6lIT4HuWcaxNChr47Y8XqhdyVNgGn4Feu/QDjc+iwpTtGLZQ3cPrX69amqt
 ldG+BA8EaoGM1kjhuJjb0O6BwT7Q+b/P18p0fQVthddeKXcDs7Brn5yNha5E6Dvjp034
 fbhw==
X-Gm-Message-State: AOAM530V8w/CwkrKq3JnuWQ9ch438tP8Bzn2dmO4oR69byDNsNm2ypPk
 az1jzJYR8cFMqPuxaDvryPdrmw==
X-Google-Smtp-Source: ABdhPJwt4Pa32VKcAnoEaVhsp8XXr3Z73SMm28b6Hu/r5m7IrgKvP3Fldc+leuO1AJIdnT4N4HNJXw==
X-Received: by 2002:adf:e445:: with SMTP id t5mr4720921wrm.191.1624543239412; 
 Thu, 24 Jun 2021 07:00:39 -0700 (PDT)
Received: from phenom.ffwll.local ([2a02:168:57f4:0:efd0:b9e5:5ae6:c2fa])
 by smtp.gmail.com with ESMTPSA id p5sm3600167wrd.25.2021.06.24.07.00.38
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Thu, 24 Jun 2021 07:00:38 -0700 (PDT)
From: Daniel Vetter <daniel.vetter@ffwll.ch>
To: DRI Development <dri-devel@lists.freedesktop.org>
Date: Thu, 24 Jun 2021 16:00:22 +0200
Message-Id: <20210624140025.438303-9-daniel.vetter@ffwll.ch>
X-Mailer: git-send-email 2.32.0.rc2
In-Reply-To: <20210624140025.438303-1-daniel.vetter@ffwll.ch>
References: <20210624140025.438303-1-daniel.vetter@ffwll.ch>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: [Linaro-mm-sig] [PATCH 08/11] drm/etnaviv: Use scheduler dependency
 handling
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: etnaviv@lists.freedesktop.org,
 =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>,
 linaro-mm-sig@lists.linaro.org,
 Christian Gmeiner <christian.gmeiner@gmail.com>,
 Russell King <linux+etnaviv@armlinux.org.uk>,
 Daniel Vetter <daniel.vetter@intel.com>, linux-media@vger.kernel.org
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

V2UgbmVlZCB0byBwdWxsIHRoZSBkcm1fc2NoZWRfam9iX2luaXQgbXVjaCBlYXJsaWVyLCBidXQg
dGhhdCdzIHZlcnkKbWlub3Igc3VyZ2VyeS4KClNpZ25lZC1vZmYtYnk6IERhbmllbCBWZXR0ZXIg
PGRhbmllbC52ZXR0ZXJAaW50ZWwuY29tPgpDYzogTHVjYXMgU3RhY2ggPGwuc3RhY2hAcGVuZ3V0
cm9uaXguZGU+CkNjOiBSdXNzZWxsIEtpbmcgPGxpbnV4K2V0bmF2aXZAYXJtbGludXgub3JnLnVr
PgpDYzogQ2hyaXN0aWFuIEdtZWluZXIgPGNocmlzdGlhbi5nbWVpbmVyQGdtYWlsLmNvbT4KQ2M6
IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+CkNjOiAiQ2hyaXN0aWFuIEvD
tm5pZyIgPGNocmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KQ2M6IGV0bmF2aXZAbGlzdHMuZnJlZWRl
c2t0b3Aub3JnCkNjOiBsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmcKQ2M6IGxpbmFyby1tbS1z
aWdAbGlzdHMubGluYXJvLm9yZwotLS0KIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZf
Z2VtLmggICAgICAgIHwgIDUgKy0KIGRyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2Vt
X3N1Ym1pdC5jIHwgMzIgKysrKystLS0tLQogZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZp
dl9zY2hlZC5jICAgICAgfCA2MSArLS0tLS0tLS0tLS0tLS0tLS0tLQogZHJpdmVycy9ncHUvZHJt
L2V0bmF2aXYvZXRuYXZpdl9zY2hlZC5oICAgICAgfCAgMyArLQogNCBmaWxlcyBjaGFuZ2VkLCAy
MCBpbnNlcnRpb25zKCspLCA4MSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbS5oIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRu
YXZpdl9nZW0uaAppbmRleCA5OGU2MGRmODgyYjYuLjYzNjg4ZTZlNDU4MCAxMDA2NDQKLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW0uaAorKysgYi9kcml2ZXJzL2dwdS9k
cm0vZXRuYXZpdi9ldG5hdml2X2dlbS5oCkBAIC04MCw5ICs4MCw2IEBAIHN0cnVjdCBldG5hdml2
X2dlbV9zdWJtaXRfYm8gewogCXU2NCB2YTsKIAlzdHJ1Y3QgZXRuYXZpdl9nZW1fb2JqZWN0ICpv
Ymo7CiAJc3RydWN0IGV0bmF2aXZfdnJhbV9tYXBwaW5nICptYXBwaW5nOwotCXN0cnVjdCBkbWFf
ZmVuY2UgKmV4Y2w7Ci0JdW5zaWduZWQgaW50IG5yX3NoYXJlZDsKLQlzdHJ1Y3QgZG1hX2ZlbmNl
ICoqc2hhcmVkOwogfTsKIAogLyogQ3JlYXRlZCBwZXIgc3VibWl0LWlvY3RsLCB0byB0cmFjayBi
bydzIGFuZCBjbWRzdHJlYW0gYnVmcywgZXRjLApAQCAtOTUsNyArOTIsNyBAQCBzdHJ1Y3QgZXRu
YXZpdl9nZW1fc3VibWl0IHsKIAlzdHJ1Y3QgZXRuYXZpdl9maWxlX3ByaXZhdGUgKmN0eDsKIAlz
dHJ1Y3QgZXRuYXZpdl9ncHUgKmdwdTsKIAlzdHJ1Y3QgZXRuYXZpdl9pb21tdV9jb250ZXh0ICpt
bXVfY29udGV4dCwgKnByZXZfbW11X2NvbnRleHQ7Ci0Jc3RydWN0IGRtYV9mZW5jZSAqb3V0X2Zl
bmNlLCAqaW5fZmVuY2U7CisJc3RydWN0IGRtYV9mZW5jZSAqb3V0X2ZlbmNlOwogCWludCBvdXRf
ZmVuY2VfaWQ7CiAJc3RydWN0IGxpc3RfaGVhZCBub2RlOyAvKiBHUFUgYWN0aXZlIHN1Ym1pdCBs
aXN0ICovCiAJc3RydWN0IGV0bmF2aXZfY21kYnVmIGNtZGJ1ZjsKZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jIGIvZHJpdmVycy9ncHUvZHJt
L2V0bmF2aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMKaW5kZXggNGRkN2Q5ZDU0MWMwLi45MjQ3OGE1
MGE1ODAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1
Ym1pdC5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5j
CkBAIC0xODgsMTYgKzE4OCwxMCBAQCBzdGF0aWMgaW50IHN1Ym1pdF9mZW5jZV9zeW5jKHN0cnVj
dCBldG5hdml2X2dlbV9zdWJtaXQgKnN1Ym1pdCkKIAkJaWYgKHN1Ym1pdC0+ZmxhZ3MgJiBFVE5B
X1NVQk1JVF9OT19JTVBMSUNJVCkKIAkJCWNvbnRpbnVlOwogCi0JCWlmIChiby0+ZmxhZ3MgJiBF
VE5BX1NVQk1JVF9CT19XUklURSkgewotCQkJcmV0ID0gZG1hX3Jlc3ZfZ2V0X2ZlbmNlcyhyb2Jq
LCAmYm8tPmV4Y2wsCi0JCQkJCQkgICZiby0+bnJfc2hhcmVkLAotCQkJCQkJICAmYm8tPnNoYXJl
ZCk7Ci0JCQlpZiAocmV0KQotCQkJCXJldHVybiByZXQ7Ci0JCX0gZWxzZSB7Ci0JCQliby0+ZXhj
bCA9IGRtYV9yZXN2X2dldF9leGNsX3VubG9ja2VkKHJvYmopOwotCQl9Ci0KKwkJcmV0ID0gZHJt
X3NjaGVkX2pvYl9hd2FpdF9pbXBsaWNpdCgmc3VibWl0LT5zY2hlZF9qb2IsICZiby0+b2JqLT5i
YXNlLAorCQkJCQkJICAgYm8tPmZsYWdzICYgRVROQV9TVUJNSVRfQk9fV1JJVEUpOworCQlpZiAo
cmV0KQorCQkJcmV0dXJuIHJldDsKIAl9CiAKIAlyZXR1cm4gcmV0OwpAQCAtNDAzLDggKzM5Nyw2
IEBAIHN0YXRpYyB2b2lkIHN1Ym1pdF9jbGVhbnVwKHN0cnVjdCBrcmVmICprcmVmKQogCiAJd2Fr
ZV91cF9hbGwoJnN1Ym1pdC0+Z3B1LT5mZW5jZV9ldmVudCk7CiAKLQlpZiAoc3VibWl0LT5pbl9m
ZW5jZSkKLQkJZG1hX2ZlbmNlX3B1dChzdWJtaXQtPmluX2ZlbmNlKTsKIAlpZiAoc3VibWl0LT5v
dXRfZmVuY2UpIHsKIAkJLyogZmlyc3QgcmVtb3ZlIGZyb20gSURSLCBzbyBmZW5jZSBjYW4gbm90
IGJlIGZvdW5kIGFueW1vcmUgKi8KIAkJbXV0ZXhfbG9jaygmc3VibWl0LT5ncHUtPmZlbmNlX2xv
Y2spOwpAQCAtNTM3LDYgKzUyOSwxMiBAQCBpbnQgZXRuYXZpdl9pb2N0bF9nZW1fc3VibWl0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIHZvaWQgKmRhdGEsCiAJc3VibWl0LT5leGVjX3N0YXRlID0g
YXJncy0+ZXhlY19zdGF0ZTsKIAlzdWJtaXQtPmZsYWdzID0gYXJncy0+ZmxhZ3M7CiAKKwlyZXQg
PSBkcm1fc2NoZWRfam9iX2luaXQoJnN1Ym1pdC0+c2NoZWRfam9iLAorCQkJCSAmY3R4LT5zY2hl
ZF9lbnRpdHlbYXJncy0+cGlwZV0sCisJCQkJIHN1Ym1pdC0+Y3R4KTsKKwlpZiAocmV0KQorCQln
b3RvIGVycl9zdWJtaXRfb2JqZWN0czsKKwogCXJldCA9IHN1Ym1pdF9sb29rdXBfb2JqZWN0cyhz
dWJtaXQsIGZpbGUsIGJvcywgYXJncy0+bnJfYm9zKTsKIAlpZiAocmV0KQogCQlnb3RvIGVycl9z
dWJtaXRfb2JqZWN0czsKQEAgLTU0OSwxMSArNTQ3LDE1IEBAIGludCBldG5hdml2X2lvY3RsX2dl
bV9zdWJtaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0YSwKIAl9CiAKIAlpZiAo
YXJncy0+ZmxhZ3MgJiBFVE5BX1NVQk1JVF9GRU5DRV9GRF9JTikgewotCQlzdWJtaXQtPmluX2Zl
bmNlID0gc3luY19maWxlX2dldF9mZW5jZShhcmdzLT5mZW5jZV9mZCk7Ci0JCWlmICghc3VibWl0
LT5pbl9mZW5jZSkgeworCQlzdHJ1Y3QgZG1hX2ZlbmNlICppbl9mZW5jZSA9IHN5bmNfZmlsZV9n
ZXRfZmVuY2UoYXJncy0+ZmVuY2VfZmQpOworCQlpZiAoIWluX2ZlbmNlKSB7CiAJCQlyZXQgPSAt
RUlOVkFMOwogCQkJZ290byBlcnJfc3VibWl0X29iamVjdHM7CiAJCX0KKworCQlyZXQgPSBkcm1f
c2NoZWRfam9iX2F3YWl0X2ZlbmNlKCZzdWJtaXQtPnNjaGVkX2pvYiwgaW5fZmVuY2UpOworCQlp
ZiAocmV0KQorCQkJZ290byBlcnJfc3VibWl0X29iamVjdHM7CiAJfQogCiAJcmV0ID0gc3VibWl0
X3Bpbl9vYmplY3RzKHN1Ym1pdCk7CkBAIC01NzksNyArNTgxLDcgQEAgaW50IGV0bmF2aXZfaW9j
dGxfZ2VtX3N1Ym1pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCB2b2lkICpkYXRhLAogCWlmIChy
ZXQpCiAJCWdvdG8gZXJyX3N1Ym1pdF9vYmplY3RzOwogCi0JcmV0ID0gZXRuYXZpdl9zY2hlZF9w
dXNoX2pvYigmY3R4LT5zY2hlZF9lbnRpdHlbYXJncy0+cGlwZV0sIHN1Ym1pdCk7CisJcmV0ID0g
ZXRuYXZpdl9zY2hlZF9wdXNoX2pvYihzdWJtaXQpOwogCWlmIChyZXQpCiAJCWdvdG8gZXJyX3N1
Ym1pdF9vYmplY3RzOwogCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5h
dml2X3NjaGVkLmMgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmMKaW5k
ZXggNzc5OTVmMTkwNzkwLi5kNjIwNTNiNjk5NTMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9ldG5hdml2L2V0bmF2aXZfc2NoZWQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9l
dG5hdml2X3NjaGVkLmMKQEAgLTE3LDU4ICsxNyw2IEBAIG1vZHVsZV9wYXJhbV9uYW1lZChqb2Jf
aGFuZ19saW1pdCwgZXRuYXZpdl9qb2JfaGFuZ19saW1pdCwgaW50ICwgMDQ0NCk7CiBzdGF0aWMg
aW50IGV0bmF2aXZfaHdfam9ic19saW1pdCA9IDQ7CiBtb2R1bGVfcGFyYW1fbmFtZWQoaHdfam9i
X2xpbWl0LCBldG5hdml2X2h3X2pvYnNfbGltaXQsIGludCAsIDA0NDQpOwogCi1zdGF0aWMgc3Ry
dWN0IGRtYV9mZW5jZSAqCi1ldG5hdml2X3NjaGVkX2RlcGVuZGVuY3koc3RydWN0IGRybV9zY2hl
ZF9qb2IgKnNjaGVkX2pvYiwKLQkJCSBzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eSAqZW50aXR5KQot
ewotCXN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXQgKnN1Ym1pdCA9IHRvX2V0bmF2aXZfc3VibWl0
KHNjaGVkX2pvYik7Ci0Jc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7Ci0JaW50IGk7Ci0KLQlpZiAo
dW5saWtlbHkoc3VibWl0LT5pbl9mZW5jZSkpIHsKLQkJZmVuY2UgPSBzdWJtaXQtPmluX2ZlbmNl
OwotCQlzdWJtaXQtPmluX2ZlbmNlID0gTlVMTDsKLQotCQlpZiAoIWRtYV9mZW5jZV9pc19zaWdu
YWxlZChmZW5jZSkpCi0JCQlyZXR1cm4gZmVuY2U7Ci0KLQkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7
Ci0JfQotCi0JZm9yIChpID0gMDsgaSA8IHN1Ym1pdC0+bnJfYm9zOyBpKyspIHsKLQkJc3RydWN0
IGV0bmF2aXZfZ2VtX3N1Ym1pdF9ibyAqYm8gPSAmc3VibWl0LT5ib3NbaV07Ci0JCWludCBqOwot
Ci0JCWlmIChiby0+ZXhjbCkgewotCQkJZmVuY2UgPSBiby0+ZXhjbDsKLQkJCWJvLT5leGNsID0g
TlVMTDsKLQotCQkJaWYgKCFkbWFfZmVuY2VfaXNfc2lnbmFsZWQoZmVuY2UpKQotCQkJCXJldHVy
biBmZW5jZTsKLQotCQkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7Ci0JCX0KLQotCQlmb3IgKGogPSAw
OyBqIDwgYm8tPm5yX3NoYXJlZDsgaisrKSB7Ci0JCQlpZiAoIWJvLT5zaGFyZWRbal0pCi0JCQkJ
Y29udGludWU7Ci0KLQkJCWZlbmNlID0gYm8tPnNoYXJlZFtqXTsKLQkJCWJvLT5zaGFyZWRbal0g
PSBOVUxMOwotCi0JCQlpZiAoIWRtYV9mZW5jZV9pc19zaWduYWxlZChmZW5jZSkpCi0JCQkJcmV0
dXJuIGZlbmNlOwotCi0JCQlkbWFfZmVuY2VfcHV0KGZlbmNlKTsKLQkJfQotCQlrZnJlZShiby0+
c2hhcmVkKTsKLQkJYm8tPm5yX3NoYXJlZCA9IDA7Ci0JCWJvLT5zaGFyZWQgPSBOVUxMOwotCX0K
LQotCXJldHVybiBOVUxMOwotfQotCiBzdGF0aWMgc3RydWN0IGRtYV9mZW5jZSAqZXRuYXZpdl9z
Y2hlZF9ydW5fam9iKHN0cnVjdCBkcm1fc2NoZWRfam9iICpzY2hlZF9qb2IpCiB7CiAJc3RydWN0
IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqc3VibWl0ID0gdG9fZXRuYXZpdl9zdWJtaXQoc2NoZWRfam9i
KTsKQEAgLTE0MCwxNCArODgsMTIgQEAgc3RhdGljIHZvaWQgZXRuYXZpdl9zY2hlZF9mcmVlX2pv
YihzdHJ1Y3QgZHJtX3NjaGVkX2pvYiAqc2NoZWRfam9iKQogfQogCiBzdGF0aWMgY29uc3Qgc3Ry
dWN0IGRybV9zY2hlZF9iYWNrZW5kX29wcyBldG5hdml2X3NjaGVkX29wcyA9IHsKLQkuZGVwZW5k
ZW5jeSA9IGV0bmF2aXZfc2NoZWRfZGVwZW5kZW5jeSwKIAkucnVuX2pvYiA9IGV0bmF2aXZfc2No
ZWRfcnVuX2pvYiwKIAkudGltZWRvdXRfam9iID0gZXRuYXZpdl9zY2hlZF90aW1lZG91dF9qb2Is
CiAJLmZyZWVfam9iID0gZXRuYXZpdl9zY2hlZF9mcmVlX2pvYiwKIH07CiAKLWludCBldG5hdml2
X3NjaGVkX3B1c2hfam9iKHN0cnVjdCBkcm1fc2NoZWRfZW50aXR5ICpzY2hlZF9lbnRpdHksCi0J
CQkgICBzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQpCitpbnQgZXRuYXZpdl9zY2hl
ZF9wdXNoX2pvYihzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQpCiB7CiAJaW50IHJl
dCA9IDA7CiAKQEAgLTE1OCwxMSArMTA0LDYgQEAgaW50IGV0bmF2aXZfc2NoZWRfcHVzaF9qb2Io
c3RydWN0IGRybV9zY2hlZF9lbnRpdHkgKnNjaGVkX2VudGl0eSwKIAkgKi8KIAltdXRleF9sb2Nr
KCZzdWJtaXQtPmdwdS0+ZmVuY2VfbG9jayk7CiAKLQlyZXQgPSBkcm1fc2NoZWRfam9iX2luaXQo
JnN1Ym1pdC0+c2NoZWRfam9iLCBzY2hlZF9lbnRpdHksCi0JCQkJIHN1Ym1pdC0+Y3R4KTsKLQlp
ZiAocmV0KQotCQlnb3RvIG91dF91bmxvY2s7Ci0KIAlkcm1fc2NoZWRfam9iX2FybSgmc3VibWl0
LT5zY2hlZF9qb2IpOwogCiAJc3VibWl0LT5vdXRfZmVuY2UgPSBkbWFfZmVuY2VfZ2V0KCZzdWJt
aXQtPnNjaGVkX2pvYi5zX2ZlbmNlLT5maW5pc2hlZCk7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmggYi9kcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9l
dG5hdml2X3NjaGVkLmgKaW5kZXggYzBhNjc5NmUyMmM5Li5iYWViZmEwNjlhZmMgMTAwNjQ0Ci0t
LSBhL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfc2NoZWQuaAorKysgYi9kcml2ZXJz
L2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X3NjaGVkLmgKQEAgLTE4LDcgKzE4LDYgQEAgc3RydWN0
IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqdG9fZXRuYXZpdl9zdWJtaXQoc3RydWN0IGRybV9zY2hlZF9q
b2IgKnNjaGVkX2pvYikKIAogaW50IGV0bmF2aXZfc2NoZWRfaW5pdChzdHJ1Y3QgZXRuYXZpdl9n
cHUgKmdwdSk7CiB2b2lkIGV0bmF2aXZfc2NoZWRfZmluaShzdHJ1Y3QgZXRuYXZpdl9ncHUgKmdw
dSk7Ci1pbnQgZXRuYXZpdl9zY2hlZF9wdXNoX2pvYihzdHJ1Y3QgZHJtX3NjaGVkX2VudGl0eSAq
c2NoZWRfZW50aXR5LAotCQkJICAgc3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqc3VibWl0KTsK
K2ludCBldG5hdml2X3NjaGVkX3B1c2hfam9iKHN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXQgKnN1
Ym1pdCk7CiAKICNlbmRpZiAvKiBfX0VUTkFWSVZfU0NIRURfSF9fICovCi0tIAoyLjMyLjAucmMy
CgpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8t
bW0tc2lnIG1haWxpbmcgbGlzdApMaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6
Ly9saXN0cy5saW5hcm8ub3JnL21haWxtYW4vbGlzdGluZm8vbGluYXJvLW1tLXNpZwo=
