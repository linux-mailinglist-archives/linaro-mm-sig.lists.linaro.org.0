Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 0D85625DADC
	for <lists+linaro-mm-sig@lfdr.de>; Fri,  4 Sep 2020 16:03:11 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 329DA66782
	for <lists+linaro-mm-sig@lfdr.de>; Fri,  4 Sep 2020 14:03:10 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 23D6F66784; Fri,  4 Sep 2020 14:03:10 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-7.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_HI,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,SPF_HELO_PASS
	autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id BB4B56679F;
	Fri,  4 Sep 2020 13:38:14 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 5972B60DC1
 for <linaro-mm-sig@lists.linaro.org>; Fri,  4 Sep 2020 13:36:34 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 4730260EFF; Fri,  4 Sep 2020 13:36:34 +0000 (UTC)
Received: from mailout2.w1.samsung.com (mailout2.w1.samsung.com
 [210.118.77.12])
 by lists.linaro.org (Postfix) with ESMTPS id 0DC3D66743
 for <linaro-mm-sig@lists.linaro.org>; Fri,  4 Sep 2020 13:35:14 +0000 (UTC)
Received: from eucas1p1.samsung.com (unknown [182.198.249.206])
 by mailout2.w1.samsung.com (KnoxPortal) with ESMTP id
 20200904133513euoutp027f9e71483cb62d3996fe8d0afef6336f~xmApwhGPS2889528895euoutp02z
 for <linaro-mm-sig@lists.linaro.org>; Fri,  4 Sep 2020 13:35:13 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout2.w1.samsung.com
 20200904133513euoutp027f9e71483cb62d3996fe8d0afef6336f~xmApwhGPS2889528895euoutp02z
Received: from eusmges3new.samsung.com (unknown [203.254.199.245]) by
 eucas1p1.samsung.com (KnoxPortal) with ESMTP id
 20200904133512eucas1p145f80f2b19797c06dd4f5e9cf4e9ab46~xmApRzR5M0113501135eucas1p14;
 Fri,  4 Sep 2020 13:35:12 +0000 (GMT)
Received: from eucas1p2.samsung.com ( [182.198.249.207]) by
 eusmges3new.samsung.com (EUCPMTA) with SMTP id 45.49.06318.092425F5; Fri,  4
 Sep 2020 14:35:12 +0100 (BST)
Received: from eusmtrp2.samsung.com (unknown [182.198.249.139]) by
 eucas1p2.samsung.com (KnoxPortal) with ESMTPA id
 20200904133512eucas1p204efa4e252ceb5fb50715239705f9965~xmAo1xrEI0694006940eucas1p2u;
 Fri,  4 Sep 2020 13:35:12 +0000 (GMT)
Received: from eusmgms2.samsung.com (unknown [182.198.249.180]) by
 eusmtrp2.samsung.com (KnoxPortal) with ESMTP id
 20200904133512eusmtrp232beaeb987bd28fb67d56e0a03ef7fcb~xmAo1FHBz0977009770eusmtrp2c;
 Fri,  4 Sep 2020 13:35:12 +0000 (GMT)
X-AuditID: cbfec7f5-371ff700000018ae-c5-5f524290806b
Received: from eusmtip1.samsung.com ( [203.254.199.221]) by
 eusmgms2.samsung.com (EUCPMTA) with SMTP id E5.B0.06017.092425F5; Fri,  4
 Sep 2020 14:35:12 +0100 (BST)
Received: from AMDC2765.digital.local (unknown [106.120.51.73]) by
 eusmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200904133511eusmtip1b44221af58e775e1d184c971b5b6ca60~xmAoOqUn41941819418eusmtip1K;
 Fri,  4 Sep 2020 13:35:11 +0000 (GMT)
From: Marek Szyprowski <m.szyprowski@samsung.com>
To: dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
Date: Fri,  4 Sep 2020 15:17:11 +0200
Message-Id: <20200904131711.12950-31-m.szyprowski@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200904131711.12950-1-m.szyprowski@samsung.com>
X-Brightmail-Tracker: H4sIAAAAAAAAA0WSe0hTYRjG/c5tR3FymoJflkqjooS8YH8cMK0s6gQFIlgklM08TZlT2fGS
 FbRVls7bVCTT0Bmi5iV1qZmVN7JlNi0V8ZKmuBAjs/KamuZ2zP77vc/zvLzv+/GRqKgJdyDD
 IqJZRYQkXExYYfVvfncf0Pj6B7mXTrrQqV0dCF2TU4XT6/UZKN03P0PQj8vbEVrb7EXP9Y0j
 tG6iH6d7Gx8SdEp1HU5Xvh4R0MW6VYRu/WHE6dmENeKIDVORXwGYPOVHjHm1oMUYXVkSwTxb
 GMOZz8l6hHladJMZXptAmayBEsC8GFQSTFptGWBmdU5+1oFWh0LY8LBYVuHmc8kq9E/urCCq
 1O+qKkuLKkG/rxpYkpA6CDMWCwQmFlGlACZUBKuB1QbPAdjRNIzwxSyAiao0Qg1Ic8fo/BW+
 oQTA0akbWw1LdbWYySAoD6ieVhMmtqMSAHybam0KodQ9FD74nmQ2bKnTcGx8wjwao/bAgvZE
 YGIh5QMzyt5j/HrOsLy6BTWx5YZel2PEeb1HAJPUkOfjsHHIsJm3hV/1tQKed8L15wXmCyB1
 G8DxrkoBX6QA2HsrB/ApL/ipa9l8Gkrth1WNbrx8FBre9QH+Yhs4ML3NJKMbmFl/H+VlIUy8
 K+LTe2Gu/snW2NYPPSjPDKxtHNp8xAwA+7sHEA1wzv0/TAtAGbBnYzi5lOU8I9g4V04i52Ii
 pK6XI+U6sPGrOtf08w2gaTW4DVAkEFsLLQ77B4lwSSwXL28DkETFdkJfQ+dFkTBEEn+NVUQG
 KWLCWa4N7CAxsb3Q89HUBREllUSzMpaNYhX/XIS0dFACychJrVCaILPQDQSeL8J6AxazyZLB
 b8UrRhsdo2lLXnEsNJTELV6fPHvHK8BxSX4m3TCanXxMHJak+kkal1sW/GWF56YyYzpPpOYL
 bRJfytq5GWv3MUS5zJ1y1TQE/MrTj3vv26VJVzkUZQ2rU5yk6Xizd82X+N2u4dvFS3FijAuV
 eLigCk7yF7Hz7YtRAwAA
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrIIsWRmVeSWpSXmKPExsVy+t/xu7oTnILiDba/5LPoPXeSyWLjjPWs
 Fv+3TWS2uPL1PZvFytVHmSwW7Le2+HLlIZPFpsfXWC0u75rDZtGzYSurxdojd9ktlm36w2Rx
 8MMTVovPrf/YHPg81sxbw+gxu+Eii8febwtYPDat6mTz2P7tAavH/e7jTB6bl9R73P73mNlj
 8o3ljB67bzawefRtWcXo8XmTXABPlJ5NUX5pSapCRn5xia1StKGFkZ6hpYWekYmlnqGxeayV
 kamSvp1NSmpOZllqkb5dgl7G31mf2QtWBFQ0Tl7A3MB4zamLkYNDQsBE4t7XtC5GLg4hgaWM
 EnNOXWLvYuQEistInJzWwAphC0v8udbFBlH0iVHiY8cZsASbgKFE11uIhIhAJ6PEtO6PYN3M
 Av3MEpMmsIHYwgI+Eg8ePgaLswioSsw/2sEIYvMK2ElMXHWGBWKDvMTqDQeYQWxOoPjWGU/A
 FggJ2Ep8mLOYZQIj3wJGhlWMIqmlxbnpucVGesWJucWleel6yfm5mxiB0bPt2M8tOxi73gUf
 YhTgYFTi4WWwD4oXYk0sK67MPcQowcGsJMLrdPZ0nBBvSmJlVWpRfnxRaU5q8SFGU6CjJjJL
 iSbnAyM7ryTe0NTQ3MLS0NzY3NjMQkmct0PgYIyQQHpiSWp2ampBahFMHxMHp1QD41S5KmNm
 ruyl6npL9SY0l6blJXDf6lveemrSLf+fzhVM5wo+LFr5M+e1Hvc7Z/dpjxXqK4ynmBqXb79y
 QsxaeJZ5zPT77lZvuBacYMvcvubFHUWOyvmOTT2aVzoflP+aNLtsomD5mjs1xrE6IgLsGfYS
 KqcZXhzl2KN38a9OnHua8M2cYml2JZbijERDLeai4kQA0phMDrQCAAA=
X-CMS-MailID: 20200904133512eucas1p204efa4e252ceb5fb50715239705f9965
X-Msg-Generator: CA
X-RootMTR: 20200904133512eucas1p204efa4e252ceb5fb50715239705f9965
X-EPHeader: CA
CMS-TYPE: 201P
X-CMS-RootMailID: 20200904133512eucas1p204efa4e252ceb5fb50715239705f9965
References: <20200904131711.12950-1-m.szyprowski@samsung.com>
 <CGME20200904133512eucas1p204efa4e252ceb5fb50715239705f9965@eucas1p2.samsung.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, linux-media@vger.kernel.org,
 Tomasz Figa <tfiga@chromium.org>, Daniel Vetter <daniel@ffwll.ch>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Robin Murphy <robin.murphy@arm.com>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH v10 30/30] videobuf2: use sgtable-based
	scatterlist wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VXNlIHJlY2VudGx5IGludHJvZHVjZWQgY29tbW9uIHdyYXBwZXJzIG9wZXJhdGluZyBkaXJlY3Rs
eSBvbiB0aGUgc3RydWN0CnNnX3RhYmxlIG9iamVjdHMgYW5kIHNjYXR0ZXJsaXN0IHBhZ2UgaXRl
cmF0b3JzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQKbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2ll
ciB0byBmb2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLCBi
ZWNhdXNlIHRoZSBjb2RlIGFscmVhZHkgcHJvcGVybHkgZGlkIGFsbCB0aGUKc2NhdHRlcmxpc3Qg
cmVsYXRlZCBjYWxscy4KClNpZ25lZC1vZmYtYnk6IE1hcmVrIFN6eXByb3dza2kgPG0uc3p5cHJv
d3NraUBzYW1zdW5nLmNvbT4KUmV2aWV3ZWQtYnk6IFJvYmluIE11cnBoeSA8cm9iaW4ubXVycGh5
QGFybS5jb20+Ci0tLQogLi4uL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1jb250aWcu
YyAgIHwgMzQgKysrKysrKystLS0tLS0tLS0tLQogLi4uL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIv
dmlkZW9idWYyLWRtYS1zZy5jIHwgMzIgKysrKysrKy0tLS0tLS0tLS0KIC4uLi9jb21tb24vdmlk
ZW9idWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMgICAgICB8IDEyICsrKy0tLS0KIDMgZmlsZXMgY2hh
bmdlZCwgMzEgaW5zZXJ0aW9ucygrKSwgNDcgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJp
dmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMgYi9kcml2
ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1jb250aWcuYwppbmRleCBl
YzM0NDZjYzQ1YjguLjFiMjQyZDg0NGRkZSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9jb21t
b24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMKKysrIGIvZHJpdmVycy9tZWRpYS9j
b21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMKQEAgLTU4LDEwICs1OCwxMCBA
QCBzdGF0aWMgdW5zaWduZWQgbG9uZyB2YjJfZGNfZ2V0X2NvbnRpZ3VvdXNfc2l6ZShzdHJ1Y3Qg
c2dfdGFibGUgKnNndCkKIAl1bnNpZ25lZCBpbnQgaTsKIAl1bnNpZ25lZCBsb25nIHNpemUgPSAw
OwogCi0JZm9yX2VhY2hfc2coc2d0LT5zZ2wsIHMsIHNndC0+bmVudHMsIGkpIHsKKwlmb3JfZWFj
aF9zZ3RhYmxlX2RtYV9zZyhzZ3QsIHMsIGkpIHsKIAkJaWYgKHNnX2RtYV9hZGRyZXNzKHMpICE9
IGV4cGVjdGVkKQogCQkJYnJlYWs7Ci0JCWV4cGVjdGVkID0gc2dfZG1hX2FkZHJlc3MocykgKyBz
Z19kbWFfbGVuKHMpOworCQlleHBlY3RlZCArPSBzZ19kbWFfbGVuKHMpOwogCQlzaXplICs9IHNn
X2RtYV9sZW4ocyk7CiAJfQogCXJldHVybiBzaXplOwpAQCAtMTAzLDggKzEwMyw3IEBAIHN0YXRp
YyB2b2lkIHZiMl9kY19wcmVwYXJlKHZvaWQgKmJ1Zl9wcml2KQogCWlmICghc2d0KQogCQlyZXR1
cm47CiAKLQlkbWFfc3luY19zZ19mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5v
cmlnX25lbnRzLAotCQkJICAgICAgIGJ1Zi0+ZG1hX2Rpcik7CisJZG1hX3N5bmNfc2d0YWJsZV9m
b3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9CiAKIHN0YXRpYyB2b2lk
IHZiMl9kY19maW5pc2godm9pZCAqYnVmX3ByaXYpCkBAIC0xMTUsNyArMTE0LDcgQEAgc3RhdGlj
IHZvaWQgdmIyX2RjX2ZpbmlzaCh2b2lkICpidWZfcHJpdikKIAlpZiAoIXNndCkKIAkJcmV0dXJu
OwogCi0JZG1hX3N5bmNfc2dfZm9yX2NwdShidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19u
ZW50cywgYnVmLT5kbWFfZGlyKTsKKwlkbWFfc3luY19zZ3RhYmxlX2Zvcl9jcHUoYnVmLT5kZXYs
IHNndCwgYnVmLT5kbWFfZGlyKTsKIH0KIAogLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKi8KQEAgLTI3NSw4ICsyNzQsOCBAQCBzdGF0aWMgdm9pZCB2YjJfZGNf
ZG1hYnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCiAJCSAqIG1lbW9yeSBsb2Nh
dGlvbnMgZG8gbm90IHJlcXVpcmUgYW55IGV4cGxpY2l0IGNhY2hlCiAJCSAqIG1haW50ZW5hbmNl
IHByaW9yIG9yIGFmdGVyIGJlaW5nIHVzZWQgYnkgdGhlIGRldmljZS4KIAkJICovCi0JCWRtYV91
bm1hcF9zZ19hdHRycyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCQkgICBhdHRhY2gtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOworCQlkbWFf
dW5tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIsCisJCQkJ
ICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAlzZ19mcmVlX3RhYmxlKHNndCk7CiAJa2ZyZWUo
YXR0YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtMzAxLDggKzMwMCw4IEBAIHN0
YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kY19kbWFidWZfb3BzX21hcCgKIAogCS8qIHJlbGVh
c2UgYW55IHByZXZpb3VzIGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9O
RSkgewotCQlkbWFfdW5tYXBfc2dfYXR0cnMoZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3Qt
Pm9yaWdfbmVudHMsCi0JCQkJICAgYXR0YWNoLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5k
bWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJCWF0dGFjaC0+ZG1hX2Rp
ciA9IERNQV9OT05FOwogCX0KIApAQCAtMzEwLDkgKzMwOSw4IEBAIHN0YXRpYyBzdHJ1Y3Qgc2df
dGFibGUgKnZiMl9kY19kbWFidWZfb3BzX21hcCgKIAkgKiBtYXBwaW5nIHRvIHRoZSBjbGllbnQg
d2l0aCBuZXcgZGlyZWN0aW9uLCBubyBjYWNoZSBzeW5jCiAJICogcmVxdWlyZWQgc2VlIGNvbW1l
bnQgaW4gdmIyX2RjX2RtYWJ1Zl9vcHNfZGV0YWNoKCkKIAkgKi8KLQlzZ3QtPm5lbnRzID0gZG1h
X21hcF9zZ19hdHRycyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCQkgICAgICBkbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKLQlpZiAoIXNndC0+
bmVudHMpIHsKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGRtYV9k
aXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpIHsKIAkJcHJfZXJyKCJmYWlsZWQg
dG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhfdW5sb2NrKGxvY2spOwogCQlyZXR1cm4g
RVJSX1BUUigtRUlPKTsKQEAgLTQ1NSw4ICs0NTMsOCBAQCBzdGF0aWMgdm9pZCB2YjJfZGNfcHV0
X3VzZXJwdHIodm9pZCAqYnVmX3ByaXYpCiAJCSAqIE5vIG5lZWQgdG8gc3luYyB0byBDUFUsIGl0
J3MgYWxyZWFkeSBzeW5jZWQgdG8gdGhlIENQVQogCQkgKiBzaW5jZSB0aGUgZmluaXNoKCkgbWVt
b3Agd2lsbCBoYXZlIGJlZW4gY2FsbGVkIGJlZm9yZSB0aGlzLgogCQkgKi8KLQkJZG1hX3VubWFw
X3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgIGJ1
Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91bm1hcF9zZ3RhYmxl
KGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRSX1NLSVBfQ1BVX1NZ
TkMpOwogCQlwYWdlcyA9IGZyYW1lX3ZlY3Rvcl9wYWdlcyhidWYtPnZlYyk7CiAJCS8qIHNndCBz
aG91bGQgZXhpc3Qgb25seSBpZiB2ZWN0b3IgY29udGFpbnMgcGFnZXMuLi4gKi8KIAkJQlVHX09O
KElTX0VSUihwYWdlcykpOwpAQCAtNTUzLDkgKzU1MSw4IEBAIHN0YXRpYyB2b2lkICp2YjJfZGNf
Z2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIHZhZGRyLAogCSAq
IE5vIG5lZWQgdG8gc3luYyB0byB0aGUgZGV2aWNlLCB0aGlzIHdpbGwgaGFwcGVuIGxhdGVyIHdo
ZW4gdGhlCiAJICogcHJlcGFyZSgpIG1lbW9wIGlzIGNhbGxlZC4KIAkgKi8KLQlzZ3QtPm5lbnRz
ID0gZG1hX21hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCQkgICAgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwotCWlmIChz
Z3QtPm5lbnRzIDw9IDApIHsKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1
Zi0+ZG1hX2RpciwKKwkJCSAgICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKSkgewogCQlwcl9lcnIo
ImZhaWxlZCB0byBtYXAgc2NhdHRlcmxpc3RcbiIpOwogCQlyZXQgPSAtRUlPOwogCQlnb3RvIGZh
aWxfc2d0X2luaXQ7CkBAIC01NzcsOCArNTc0LDcgQEAgc3RhdGljIHZvaWQgKnZiMl9kY19nZXRf
dXNlcnB0cihzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgdmFkZHIsCiAJcmV0dXJu
IGJ1ZjsKIAogZmFpbF9tYXBfc2c6Ci0JZG1hX3VubWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3Qt
PnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJICAgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQ
X0NQVV9TWU5DKTsKKwlkbWFfdW5tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9k
aXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwogCiBmYWlsX3NndF9pbml0OgogCXNnX2ZyZWVf
dGFibGUoc2d0KTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92
aWRlb2J1ZjItZG1hLXNnLmMgYi9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9i
dWYyLWRtYS1zZy5jCmluZGV4IDBhNDBlMDBmMGQ3ZS4uMGRkM2IxOTAyNWUwIDEwMDY0NAotLS0g
YS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jCisrKyBi
L2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLXNnLmMKQEAgLTE0
OCw5ICsxNDgsOCBAQCBzdGF0aWMgdm9pZCAqdmIyX2RtYV9zZ19hbGxvYyhzdHJ1Y3QgZGV2aWNl
ICpkZXYsIHVuc2lnbmVkIGxvbmcgZG1hX2F0dHJzLAogCSAqIE5vIG5lZWQgdG8gc3luYyB0byB0
aGUgZGV2aWNlLCB0aGlzIHdpbGwgaGFwcGVuIGxhdGVyIHdoZW4gdGhlCiAJICogcHJlcGFyZSgp
IG1lbW9wIGlzIGNhbGxlZC4KIAkgKi8KLQlzZ3QtPm5lbnRzID0gZG1hX21hcF9zZ19hdHRycyhi
dWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICAgICBidWYtPmRtYV9k
aXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwotCWlmICghc2d0LT5uZW50cykKKwlpZiAoZG1h
X21hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2RpciwKKwkJCSAgICBETUFfQVRU
Ul9TS0lQX0NQVV9TWU5DKSkKIAkJZ290byBmYWlsX21hcDsKIAogCWJ1Zi0+aGFuZGxlci5yZWZj
b3VudCA9ICZidWYtPnJlZmNvdW50OwpAQCAtMTg2LDggKzE4NSw4IEBAIHN0YXRpYyB2b2lkIHZi
Ml9kbWFfc2dfcHV0KHZvaWQgKmJ1Zl9wcml2KQogCWlmIChyZWZjb3VudF9kZWNfYW5kX3Rlc3Qo
JmJ1Zi0+cmVmY291bnQpKSB7CiAJCWRwcmludGsoMSwgIiVzOiBGcmVlaW5nIGJ1ZmZlciBvZiAl
ZCBwYWdlc1xuIiwgX19mdW5jX18sCiAJCQlidWYtPm51bV9wYWdlcyk7Ci0JCWRtYV91bm1hcF9z
Z19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICBidWYt
PmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOworCQlkbWFfdW5tYXBfc2d0YWJsZShi
dWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkJICBETUFfQVRUUl9TS0lQX0NQVV9TWU5D
KTsKIAkJaWYgKGJ1Zi0+dmFkZHIpCiAJCQl2bV91bm1hcF9yYW0oYnVmLT52YWRkciwgYnVmLT5u
dW1fcGFnZXMpOwogCQlzZ19mcmVlX3RhYmxlKGJ1Zi0+ZG1hX3NndCk7CkBAIC0yMDQsOCArMjAz
LDcgQEAgc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19wcmVwYXJlKHZvaWQgKmJ1Zl9wcml2KQogCXN0
cnVjdCB2YjJfZG1hX3NnX2J1ZiAqYnVmID0gYnVmX3ByaXY7CiAJc3RydWN0IHNnX3RhYmxlICpz
Z3QgPSBidWYtPmRtYV9zZ3Q7CiAKLQlkbWFfc3luY19zZ19mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBz
Z3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJICAgICAgIGJ1Zi0+ZG1hX2Rpcik7CisJZG1h
X3N5bmNfc2d0YWJsZV9mb3JfZGV2aWNlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9
CiAKIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQpAQCAtMjEz
LDcgKzIxMSw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZmluaXNoKHZvaWQgKmJ1Zl9wcml2
KQogCXN0cnVjdCB2YjJfZG1hX3NnX2J1ZiAqYnVmID0gYnVmX3ByaXY7CiAJc3RydWN0IHNnX3Rh
YmxlICpzZ3QgPSBidWYtPmRtYV9zZ3Q7CiAKLQlkbWFfc3luY19zZ19mb3JfY3B1KGJ1Zi0+ZGV2
LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLCBidWYtPmRtYV9kaXIpOworCWRtYV9zeW5jX3Nn
dGFibGVfZm9yX2NwdShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwogfQogCiBzdGF0aWMg
dm9pZCAqdmIyX2RtYV9zZ19nZXRfdXNlcnB0cihzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVk
IGxvbmcgdmFkZHIsCkBAIC0yNTYsOSArMjU0LDggQEAgc3RhdGljIHZvaWQgKnZiMl9kbWFfc2df
Z2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIHZhZGRyLAogCSAq
IE5vIG5lZWQgdG8gc3luYyB0byB0aGUgZGV2aWNlLCB0aGlzIHdpbGwgaGFwcGVuIGxhdGVyIHdo
ZW4gdGhlCiAJICogcHJlcGFyZSgpIG1lbW9wIGlzIGNhbGxlZC4KIAkgKi8KLQlzZ3QtPm5lbnRz
ID0gZG1hX21hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCQkgICAgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpOwotCWlmICgh
c2d0LT5uZW50cykKKwlpZiAoZG1hX21hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1h
X2RpciwKKwkJCSAgICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKSkKIAkJZ290byB1c2VycHRyX2Zh
aWxfbWFwOwogCiAJcmV0dXJuIGJ1ZjsKQEAgLTI4NCw4ICsyODEsNyBAQCBzdGF0aWMgdm9pZCB2
YjJfZG1hX3NnX3B1dF91c2VycHRyKHZvaWQgKmJ1Zl9wcml2KQogCiAJZHByaW50aygxLCAiJXM6
IFJlbGVhc2luZyB1c2Vyc3BhY2UgYnVmZmVyIG9mICVkIHBhZ2VzXG4iLAogCSAgICAgICBfX2Z1
bmNfXywgYnVmLT5udW1fcGFnZXMpOwotCWRtYV91bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0
LT5zZ2wsIHNndC0+b3JpZ19uZW50cywgYnVmLT5kbWFfZGlyLAotCQkJICAgRE1BX0FUVFJfU0tJ
UF9DUFVfU1lOQyk7CisJZG1hX3VubWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFf
ZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAlpZiAoYnVmLT52YWRkcikKIAkJdm1fdW5t
YXBfcmFtKGJ1Zi0+dmFkZHIsIGJ1Zi0+bnVtX3BhZ2VzKTsKIAlzZ19mcmVlX3RhYmxlKGJ1Zi0+
ZG1hX3NndCk7CkBAIC00MDgsOCArNDA0LDcgQEAgc3RhdGljIHZvaWQgdmIyX2RtYV9zZ19kbWFi
dWZfb3BzX2RldGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAogCS8qIHJlbGVhc2UgdGhlIHNj
YXR0ZXJsaXN0IGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9ORSkKLQkJ
ZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAot
CQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYs
IHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAlzZ19mcmVlX3RhYmxlKHNndCk7CiAJa2ZyZWUo
YXR0YWNoKTsKIAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtNDM0LDE1ICs0MjksMTIgQEAg
c3RhdGljIHN0cnVjdCBzZ190YWJsZSAqdmIyX2RtYV9zZ19kbWFidWZfb3BzX21hcCgKIAogCS8q
IHJlbGVhc2UgYW55IHByZXZpb3VzIGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBE
TUFfTk9ORSkgewotCQlkbWFfdW5tYXBfc2coZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3Qt
Pm9yaWdfbmVudHMsCi0JCQlhdHRhY2gtPmRtYV9kaXIpOworCQlkbWFfdW5tYXBfc2d0YWJsZShk
Yl9hdHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIsIDApOwogCQlhdHRhY2gtPmRtYV9k
aXIgPSBETUFfTk9ORTsKIAl9CiAKIAkvKiBtYXBwaW5nIHRvIHRoZSBjbGllbnQgd2l0aCBuZXcg
ZGlyZWN0aW9uICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2coZGJfYXR0YWNoLT5kZXYsIHNn
dC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJZG1hX2Rpcik7Ci0JaWYgKCFzZ3QtPm5lbnRz
KSB7CisJaWYgKGRtYV9tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBkbWFfZGlyLCAw
KSkgewogCQlwcl9lcnIoImZhaWxlZCB0byBtYXAgc2NhdHRlcmxpc3RcbiIpOwogCQltdXRleF91
bmxvY2sobG9jayk7CiAJCXJldHVybiBFUlJfUFRSKC1FSU8pOwpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMgYi9kcml2ZXJzL21l
ZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLXZtYWxsb2MuYwppbmRleCBjNjZmZGE0YTY1
ZTQuLmJmNWFjNjNhNTc0MiAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9i
dWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMKKysrIGIvZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9i
dWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMKQEAgLTIyOSw3ICsyMjksNyBAQCBzdGF0aWMgaW50IHZi
Ml92bWFsbG9jX2RtYWJ1Zl9vcHNfYXR0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVmLAogCQlrZnJl
ZShhdHRhY2gpOwogCQlyZXR1cm4gcmV0OwogCX0KLQlmb3JfZWFjaF9zZyhzZ3QtPnNnbCwgc2cs
IHNndC0+bmVudHMsIGkpIHsKKwlmb3JfZWFjaF9zZ3RhYmxlX3NnKHNndCwgc2csIGkpIHsKIAkJ
c3RydWN0IHBhZ2UgKnBhZ2UgPSB2bWFsbG9jX3RvX3BhZ2UodmFkZHIpOwogCiAJCWlmICghcGFn
ZSkgewpAQCAtMjU5LDggKzI1OSw3IEBAIHN0YXRpYyB2b2lkIHZiMl92bWFsbG9jX2RtYWJ1Zl9v
cHNfZGV0YWNoKHN0cnVjdCBkbWFfYnVmICpkYnVmLAogCiAJLyogcmVsZWFzZSB0aGUgc2NhdHRl
cmxpc3QgY2FjaGUgKi8KIAlpZiAoYXR0YWNoLT5kbWFfZGlyICE9IERNQV9OT05FKQotCQlkbWFf
dW5tYXBfc2coZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQlh
dHRhY2gtPmRtYV9kaXIpOworCQlkbWFfdW5tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0
LCBhdHRhY2gtPmRtYV9kaXIsIDApOwogCXNnX2ZyZWVfdGFibGUoc2d0KTsKIAlrZnJlZShhdHRh
Y2gpOwogCWRiX2F0dGFjaC0+cHJpdiA9IE5VTEw7CkBAIC0yODUsMTUgKzI4NCwxMiBAQCBzdGF0
aWMgc3RydWN0IHNnX3RhYmxlICp2YjJfdm1hbGxvY19kbWFidWZfb3BzX21hcCgKIAogCS8qIHJl
bGVhc2UgYW55IHByZXZpb3VzIGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFf
Tk9ORSkgewotCQlkbWFfdW5tYXBfc2coZGJfYXR0YWNoLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9y
aWdfbmVudHMsCi0JCQlhdHRhY2gtPmRtYV9kaXIpOworCQlkbWFfdW5tYXBfc2d0YWJsZShkYl9h
dHRhY2gtPmRldiwgc2d0LCBhdHRhY2gtPmRtYV9kaXIsIDApOwogCQlhdHRhY2gtPmRtYV9kaXIg
PSBETUFfTk9ORTsKIAl9CiAKIAkvKiBtYXBwaW5nIHRvIHRoZSBjbGllbnQgd2l0aCBuZXcgZGly
ZWN0aW9uICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2coZGJfYXR0YWNoLT5kZXYsIHNndC0+
c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJZG1hX2Rpcik7Ci0JaWYgKCFzZ3QtPm5lbnRzKSB7
CisJaWYgKGRtYV9tYXBfc2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBkbWFfZGlyLCAwKSkg
ewogCQlwcl9lcnIoImZhaWxlZCB0byBtYXAgc2NhdHRlcmxpc3RcbiIpOwogCQltdXRleF91bmxv
Y2sobG9jayk7CiAJCXJldHVybiBFUlJfUFRSKC1FSU8pOwotLSAKMi4xNy4xCgpfX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxp
bmcgbGlzdApMaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9saXN0cy5saW5h
cm8ub3JnL21haWxtYW4vbGlzdGluZm8vbGluYXJvLW1tLXNpZwo=
