Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 9EECE4B2668
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 11 Feb 2022 13:51:22 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id D54D13EEC4
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 11 Feb 2022 12:51:21 +0000 (UTC)
Received: from mail-ed1-f54.google.com (mail-ed1-f54.google.com [209.85.208.54])
	by lists.linaro.org (Postfix) with ESMTPS id 2BA743EEAE
	for <linaro-mm-sig@lists.linaro.org>; Fri, 11 Feb 2022 12:50:18 +0000 (UTC)
Received: by mail-ed1-f54.google.com with SMTP id s7so16378333edd.3
        for <linaro-mm-sig@lists.linaro.org>; Fri, 11 Feb 2022 04:50:18 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20210112;
        h=from:to:subject:date:message-id:in-reply-to:references:mime-version
         :content-transfer-encoding;
        bh=W1YQyQuAE1A9s4RL4Vb3Neq3nBzO549B7NxcpaZ1VM0=;
        b=cNdKV7j2sMO3vY4Q4f8/KkjFdhIAkcTg3Vd5xsccw+L2TUw79CTQxlpSz/q9Q33eSA
         qxgiBiYegTq/fytIj5sSOnIYzTnwEZxrFF51nVp27NCGOLyBpvX5KXk8TPkZySiFril6
         QlA9nNGb4kqHXTpCPsbdzDVXrJqXjmjBGfxT4AtaoIzjYs7b0rYz7T8Seoh2RD4aI837
         RmYR8eZZWUR+qFZ+1aodVgAQiev4xyRT11Fre0G5R/XYow5srKAPd1b3lQbaOTr/FgFZ
         vIjvIKHq8+gX7dvZXzxG7QCIcfJypRvw0lX7Uhz8IeL4iEVR/vem6eS4gVeRqxN9DjmL
         4O1A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
         :references:mime-version:content-transfer-encoding;
        bh=W1YQyQuAE1A9s4RL4Vb3Neq3nBzO549B7NxcpaZ1VM0=;
        b=zC86+lTEnCCbImQR7KpHM3gwFy4QzaiIzTEOBu8uMA0WDsu6JJZuB1DGAnqnZ2dHMn
         iNznU/EkdKtt2Ns0cN72thMMgjSUAVCX4+EfLmwaqJVaMGcuZVQMP0AdUePaFZAnMKaq
         5bqFc+HqvjZXxYb+m2uRXwCCN1lGUfEd8co/EifnQqiaTLVIy6D4/bi0bYOMetR5aAlk
         TX54kj2NxB1/Z8/IrqEf05tCZWy/HyIGl4666GdLOQMOpve+b8aZY/w2dxcY/j5CiRwC
         YXKpMhlQglMV49iMlanRbSU0vzxwoo3LwiJbgWxDCzxc7Jx30585ZMeznQ416qwbTPFD
         6Kmw==
X-Gm-Message-State: AOAM530fGwrizsBNwxQ4COXnhbrizHabad4rGuy0wMamdZExki0qrrYq
	7glf5V4F1Hich6nZ5s2KMlQ=
X-Google-Smtp-Source: ABdhPJyumpvAU/dpkb1mpcFTs9ayYkVBnh/IN+bn+cnKBESHvdJ24+NZSrdOjRQCcms1MzMqvlbbuw==
X-Received: by 2002:a05:6402:206e:: with SMTP id bd14mr1708981edb.296.1644583817062;
        Fri, 11 Feb 2022 04:50:17 -0800 (PST)
Received: from able.fritz.box (p57b0bff8.dip0.t-ipconnect.de. [87.176.191.248])
        by smtp.gmail.com with ESMTPSA id w22sm7868604ejc.137.2022.02.11.04.50.16
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Fri, 11 Feb 2022 04:50:16 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
To: daniel@ffwll.ch,
	sumit.semwal@linaro.org,
	dri-devel@lists.freedesktop.org,
	linaro-mm-sig@lists.linaro.org
Date: Fri, 11 Feb 2022 13:49:52 +0100
Message-Id: <20220211125003.918447-13-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20220211125003.918447-1-christian.koenig@amd.com>
References: <20220211125003.918447-1-christian.koenig@amd.com>
MIME-Version: 1.0
Message-ID-Hash: JU7TU3QW3Q4B2IPWANMHEC3XQCUDPSX7
X-Message-ID-Hash: JU7TU3QW3Q4B2IPWANMHEC3XQCUDPSX7
X-MailFrom: ckoenig.leichtzumerken@gmail.com
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 12/23] dma-buf/drivers: make reserving a shared slot mandatory v3
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/JU7TU3QW3Q4B2IPWANMHEC3XQCUDPSX7/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

QXVkaXQgYWxsIHRoZSB1c2VycyBvZiBkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZSgpIGFuZCBtYWtl
IHN1cmUgdGhleQ0KcmVzZXJ2ZSBhIHNoYXJlZCBzbG90IGFsc28gd2hlbiBvbmx5IHRyeWluZyB0
byBhZGQgYW4gZXhjbHVzaXZlIGZlbmNlLg0KDQpUaGlzIGlzIHRoZSBuZXh0IHN0ZXAgdG93YXJk
cyBoYW5kbGluZyB0aGUgZXhjbHVzaXZlIGZlbmNlIGxpa2UgYQ0Kc2hhcmVkIG9uZS4NCg0KdjI6
IGZpeCBtaXNzZWQgY2FzZSBpbiBhbWRncHUNCnYzOiBhbmQgdHdvIG1vcmUgcmFkZW9uLCByZW5h
bWUgZnVuY3Rpb24NCg0KU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFu
LmtvZW5pZ0BhbWQuY29tPg0KLS0tDQogZHJpdmVycy9kbWEtYnVmL2RtYS1yZXN2LmMgICAgICAg
ICAgICAgICAgICAgIHwgMTAgKy0tDQogZHJpdmVycy9kbWEtYnVmL3N0LWRtYS1yZXN2LmMgICAg
ICAgICAgICAgICAgIHwgNjQgKysrKysrKysrLS0tLS0tLS0tLQ0KIC4uLi9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jICB8ICA0ICstDQogZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X29iamVjdC5jICAgIHwgIDggKysrDQogZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZtLmMgICAgICAgIHwgIDQgKy0NCiBkcml2ZXJzL2dwdS9kcm0vYW1k
L2FtZGtmZC9rZmRfc3ZtLmMgICAgICAgICAgfCAgMiArLQ0KIGRyaXZlcnMvZ3B1L2RybS9ldG5h
dml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jICB8ICA4ICstLQ0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMgICB8ICAzICstDQogLi4uL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fZXhlY2J1ZmZlci5jICAgIHwgMTAgKystDQogZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX3R0bV9tb3ZlLmMgIHwgIDYgKy0NCiAuLi4vZHJtL2k5MTUvZ2VtL3NlbGZ0
ZXN0cy9pOTE1X2dlbV9taWdyYXRlLmMgfCAgNSArLQ0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmMgICAgICAgICAgICAgICB8ICA4ICsrLQ0KIC4uLi9kcm0vaTkxNS9zZWxmdGVzdHMv
aW50ZWxfbWVtb3J5X3JlZ2lvbi5jICB8ICA3ICsrDQogZHJpdmVycy9ncHUvZHJtL2xpbWEvbGlt
YV9nZW0uYyAgICAgICAgICAgICAgIHwgMTAgKystDQogZHJpdmVycy9ncHUvZHJtL21zbS9tc21f
Z2VtX3N1Ym1pdC5jICAgICAgICAgIHwgMTggKysrLS0tDQogZHJpdmVycy9ncHUvZHJtL25vdXZl
YXUvbm91dmVhdV9mZW5jZS5jICAgICAgIHwgIDggKy0tDQogZHJpdmVycy9ncHUvZHJtL3BhbmZy
b3N0L3BhbmZyb3N0X2pvYi5jICAgICAgIHwgIDQgKysNCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4
bF9yZWxlYXNlLmMgICAgICAgICAgICAgfCAgMiArLQ0KIGRyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uX2NzLmMgICAgICAgICAgICB8ICA0ICsrDQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fb2JqZWN0LmMgICAgICAgIHwgIDggKysrDQogZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fdm0uYyAgICAgICAgICAgIHwgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9i
by5jICAgICAgICAgICAgICAgICAgfCAgNCArLQ0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2Jv
X3V0aWwuYyAgICAgICAgICAgICB8IDEyICsrKy0NCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9l
eGVjYnVmX3V0aWwuYyAgICAgICAgfCAxNSArKy0tLQ0KIGRyaXZlcnMvZ3B1L2RybS92M2QvdjNk
X2dlbS5jICAgICAgICAgICAgICAgICB8IDE1ICsrKy0tDQogZHJpdmVycy9ncHUvZHJtL3ZjNC92
YzRfZ2VtLmMgICAgICAgICAgICAgICAgIHwgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdmdlbS92
Z2VtX2ZlbmNlLmMgICAgICAgICAgICAgfCAxMiArKy0tDQogZHJpdmVycy9ncHUvZHJtL3ZpcnRp
by92aXJ0Z3B1X2dlbS5jICAgICAgICAgIHwgIDkgKysrDQogZHJpdmVycy9ncHUvZHJtL3Ztd2dm
eC92bXdnZnhfYm8uYyAgICAgICAgICAgIHwgMTYgKysrLS0NCiBpbmNsdWRlL2xpbnV4L2RtYS1y
ZXN2LmggICAgICAgICAgICAgICAgICAgICAgfCAgNCArLQ0KIDMwIGZpbGVzIGNoYW5nZWQsIDE3
MSBpbnNlcnRpb25zKCspLCAxMTMgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2RtYS1idWYvZG1hLXJlc3YuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtcmVzdi5jDQppbmRleCBl
MDRhZmMzMGJjMGEuLmNjZWY1ZTUzZjhlNyAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9k
bWEtcmVzdi5jDQorKysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLXJlc3YuYw0KQEAgLTE1Miw3ICsx
NTIsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBkbWFfcmVzdl9saXN0ICpkbWFfcmVzdl9zaGFy
ZWRfbGlzdChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaikNCiB9DQogDQogLyoqDQotICogZG1hX3Jlc3Zf
cmVzZXJ2ZV9zaGFyZWQgLSBSZXNlcnZlIHNwYWNlIHRvIGFkZCBzaGFyZWQgZmVuY2VzIHRvDQor
ICogZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMgLSBSZXNlcnZlIHNwYWNlIHRvIGFkZCBzaGFyZWQg
ZmVuY2VzIHRvDQogICogYSBkbWFfcmVzdi4NCiAgKiBAb2JqOiByZXNlcnZhdGlvbiBvYmplY3QN
CiAgKiBAbnVtX2ZlbmNlczogbnVtYmVyIG9mIGZlbmNlcyB3ZSB3YW50IHRvIGFkZA0KQEAgLTE2
Nyw3ICsxNjcsNyBAQCBzdGF0aWMgaW5saW5lIHN0cnVjdCBkbWFfcmVzdl9saXN0ICpkbWFfcmVz
dl9zaGFyZWRfbGlzdChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaikNCiAgKiBSRVRVUk5TDQogICogWmVy
byBmb3Igc3VjY2Vzcywgb3IgLWVycm5vDQogICovDQotaW50IGRtYV9yZXN2X3Jlc2VydmVfc2hh
cmVkKHN0cnVjdCBkbWFfcmVzdiAqb2JqLCB1bnNpZ25lZCBpbnQgbnVtX2ZlbmNlcykNCitpbnQg
ZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpvYmosIHVuc2lnbmVkIGlu
dCBudW1fZmVuY2VzKQ0KIHsNCiAJc3RydWN0IGRtYV9yZXN2X2xpc3QgKm9sZCwgKm5ldzsNCiAJ
dW5zaWduZWQgaW50IGksIGosIGssIG1heDsNCkBAIC0yMzAsNyArMjMwLDcgQEAgaW50IGRtYV9y
ZXN2X3Jlc2VydmVfc2hhcmVkKHN0cnVjdCBkbWFfcmVzdiAqb2JqLCB1bnNpZ25lZCBpbnQgbnVt
X2ZlbmNlcykNCiANCiAJcmV0dXJuIDA7DQogfQ0KLUVYUE9SVF9TWU1CT0woZG1hX3Jlc3ZfcmVz
ZXJ2ZV9zaGFyZWQpOw0KK0VYUE9SVF9TWU1CT0woZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMpOw0K
IA0KICNpZmRlZiBDT05GSUdfREVCVUdfTVVURVhFUw0KIC8qKg0KQEAgLTIzOCw3ICsyMzgsNyBA
QCBFWFBPUlRfU1lNQk9MKGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKTsNCiAgKiBAb2JqOiB0aGUg
ZG1hX3Jlc3Ygb2JqZWN0IHRvIHJlc2V0DQogICoNCiAgKiBSZXNldCB0aGUgbnVtYmVyIG9mIHBy
ZS1yZXNlcnZlZCBzaGFyZWQgc2xvdHMgdG8gdGVzdCB0aGF0IGRyaXZlcnMgZG8NCi0gKiBjb3Jy
ZWN0IHNsb3QgYWxsb2NhdGlvbiB1c2luZyBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZCgpLiBTZWUg
YWxzbw0KKyAqIGNvcnJlY3Qgc2xvdCBhbGxvY2F0aW9uIHVzaW5nIGRtYV9yZXN2X3Jlc2VydmVf
ZmVuY2VzKCkuIFNlZSBhbHNvDQogICogJmRtYV9yZXN2X2xpc3Quc2hhcmVkX21heC4NCiAgKi8N
CiB2b2lkIGRtYV9yZXN2X3Jlc2V0X3NoYXJlZF9tYXgoc3RydWN0IGRtYV9yZXN2ICpvYmopDQpA
QCAtMjYwLDcgKzI2MCw3IEBAIEVYUE9SVF9TWU1CT0woZG1hX3Jlc3ZfcmVzZXRfc2hhcmVkX21h
eCk7DQogICogQGZlbmNlOiB0aGUgc2hhcmVkIGZlbmNlIHRvIGFkZA0KICAqDQogICogQWRkIGEg
ZmVuY2UgdG8gYSBzaGFyZWQgc2xvdCwgQG9iaiBtdXN0IGJlIGxvY2tlZCB3aXRoIGRtYV9yZXN2
X2xvY2soKSwgYW5kDQotICogZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoKSBoYXMgYmVlbiBjYWxs
ZWQuDQorICogZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoKSBoYXMgYmVlbiBjYWxsZWQuDQogICoN
CiAgKiBTZWUgYWxzbyAmZG1hX3Jlc3YuZmVuY2UgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGUgc2Vt
YW50aWNzLg0KICAqLw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtcmVzdi5j
IGIvZHJpdmVycy9kbWEtYnVmL3N0LWRtYS1yZXN2LmMNCmluZGV4IGNiZTk5OWM2ZTdhNi4uZDJl
NjFmNmFlOTg5IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9kbWEtYnVmL3N0LWRtYS1yZXN2LmMNCisr
KyBiL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtcmVzdi5jDQpAQCAtNzUsMTcgKzc1LDE2IEBAIHN0
YXRpYyBpbnQgdGVzdF9zaWduYWxpbmcodm9pZCAqYXJnLCBib29sIHNoYXJlZCkNCiAJCWdvdG8g
ZXJyX2ZyZWU7DQogCX0NCiANCi0JaWYgKHNoYXJlZCkgew0KLQkJciA9IGRtYV9yZXN2X3Jlc2Vy
dmVfc2hhcmVkKCZyZXN2LCAxKTsNCi0JCWlmIChyKSB7DQotCQkJcHJfZXJyKCJSZXN2IHNoYXJl
ZCBzbG90IGFsbG9jYXRpb24gZmFpbGVkXG4iKTsNCi0JCQlnb3RvIGVycl91bmxvY2s7DQotCQl9
DQorCXIgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcygmcmVzdiwgMSk7DQorCWlmIChyKSB7DQor
CQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNsb3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOw0KKwkJZ290
byBlcnJfdW5sb2NrOw0KKwl9DQogDQorCWlmIChzaGFyZWQpDQogCQlkbWFfcmVzdl9hZGRfc2hh
cmVkX2ZlbmNlKCZyZXN2LCBmKTsNCi0JfSBlbHNlIHsNCisJZWxzZQ0KIAkJZG1hX3Jlc3ZfYWRk
X2V4Y2xfZmVuY2UoJnJlc3YsIGYpOw0KLQl9DQogDQogCWlmIChkbWFfcmVzdl90ZXN0X3NpZ25h
bGVkKCZyZXN2LCBzaGFyZWQpKSB7DQogCQlwcl9lcnIoIlJlc3YgdW5leHBlY3RlZGx5IHNpZ25h
bGVkXG4iKTsNCkBAIC0xMzQsMTcgKzEzMywxNiBAQCBzdGF0aWMgaW50IHRlc3RfZm9yX2VhY2go
dm9pZCAqYXJnLCBib29sIHNoYXJlZCkNCiAJCWdvdG8gZXJyX2ZyZWU7DQogCX0NCiANCi0JaWYg
KHNoYXJlZCkgew0KLQkJciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKCZyZXN2LCAxKTsNCi0J
CWlmIChyKSB7DQotCQkJcHJfZXJyKCJSZXN2IHNoYXJlZCBzbG90IGFsbG9jYXRpb24gZmFpbGVk
XG4iKTsNCi0JCQlnb3RvIGVycl91bmxvY2s7DQotCQl9DQorCXIgPSBkbWFfcmVzdl9yZXNlcnZl
X2ZlbmNlcygmcmVzdiwgMSk7DQorCWlmIChyKSB7DQorCQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNs
b3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOw0KKwkJZ290byBlcnJfdW5sb2NrOw0KKwl9DQogDQor
CWlmIChzaGFyZWQpDQogCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKCZyZXN2LCBmKTsNCi0J
fSBlbHNlIHsNCisJZWxzZQ0KIAkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UoJnJlc3YsIGYpOw0K
LQl9DQogDQogCXIgPSAtRU5PRU5UOw0KIAlkbWFfcmVzdl9mb3JfZWFjaF9mZW5jZSgmY3Vyc29y
LCAmcmVzdiwgc2hhcmVkLCBmZW5jZSkgew0KQEAgLTIwNiwxOCArMjA0LDE3IEBAIHN0YXRpYyBp
bnQgdGVzdF9mb3JfZWFjaF91bmxvY2tlZCh2b2lkICphcmcsIGJvb2wgc2hhcmVkKQ0KIAkJZ290
byBlcnJfZnJlZTsNCiAJfQ0KIA0KLQlpZiAoc2hhcmVkKSB7DQotCQlyID0gZG1hX3Jlc3ZfcmVz
ZXJ2ZV9zaGFyZWQoJnJlc3YsIDEpOw0KLQkJaWYgKHIpIHsNCi0JCQlwcl9lcnIoIlJlc3Ygc2hh
cmVkIHNsb3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOw0KLQkJCWRtYV9yZXN2X3VubG9jaygmcmVz
dik7DQotCQkJZ290byBlcnJfZnJlZTsNCi0JCX0NCisJciA9IGRtYV9yZXN2X3Jlc2VydmVfZmVu
Y2VzKCZyZXN2LCAxKTsNCisJaWYgKHIpIHsNCisJCXByX2VycigiUmVzdiBzaGFyZWQgc2xvdCBh
bGxvY2F0aW9uIGZhaWxlZFxuIik7DQorCQlkbWFfcmVzdl91bmxvY2soJnJlc3YpOw0KKwkJZ290
byBlcnJfZnJlZTsNCisJfQ0KIA0KKwlpZiAoc2hhcmVkKQ0KIAkJZG1hX3Jlc3ZfYWRkX3NoYXJl
ZF9mZW5jZSgmcmVzdiwgZik7DQotCX0gZWxzZSB7DQorCWVsc2UNCiAJCWRtYV9yZXN2X2FkZF9l
eGNsX2ZlbmNlKCZyZXN2LCBmKTsNCi0JfQ0KIAlkbWFfcmVzdl91bmxvY2soJnJlc3YpOw0KIA0K
IAlyID0gLUVOT0VOVDsNCkBAIC0yOTAsMTggKzI4NywxNyBAQCBzdGF0aWMgaW50IHRlc3RfZ2V0
X2ZlbmNlcyh2b2lkICphcmcsIGJvb2wgc2hhcmVkKQ0KIAkJZ290byBlcnJfcmVzdjsNCiAJfQ0K
IA0KLQlpZiAoc2hhcmVkKSB7DQotCQlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoJnJlc3Ys
IDEpOw0KLQkJaWYgKHIpIHsNCi0JCQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNsb3QgYWxsb2NhdGlv
biBmYWlsZWRcbiIpOw0KLQkJCWRtYV9yZXN2X3VubG9jaygmcmVzdik7DQotCQkJZ290byBlcnJf
cmVzdjsNCi0JCX0NCisJciA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKCZyZXN2LCAxKTsNCisJ
aWYgKHIpIHsNCisJCXByX2VycigiUmVzdiBzaGFyZWQgc2xvdCBhbGxvY2F0aW9uIGZhaWxlZFxu
Iik7DQorCQlkbWFfcmVzdl91bmxvY2soJnJlc3YpOw0KKwkJZ290byBlcnJfcmVzdjsNCisJfQ0K
IA0KKwlpZiAoc2hhcmVkKQ0KIAkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZSgmcmVzdiwgZik7
DQotCX0gZWxzZSB7DQorCWVsc2UNCiAJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKCZyZXN2LCBm
KTsNCi0JfQ0KIAlkbWFfcmVzdl91bmxvY2soJnJlc3YpOw0KIA0KIAlyID0gZG1hX3Jlc3ZfZ2V0
X2ZlbmNlcygmcmVzdiwgc2hhcmVkLCAmaSwgJmZlbmNlcyk7DQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2FtZGtmZF9ncHV2bS5jDQppbmRleCBiNmYyNjZmNjEyZWEu
LjdkZThmNjdmN2RkZSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9hbWRrZmRfZ3B1dm0uYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X2FtZGtmZF9ncHV2bS5jDQpAQCAtMTIyMCw3ICsxMjIwLDcgQEAgc3RhdGljIGludCBpbml0
X2tmZF92bShzdHJ1Y3QgYW1kZ3B1X3ZtICp2bSwgdm9pZCAqKnByb2Nlc3NfaW5mbywNCiAJCQkJ
ICBBTURHUFVfRkVOQ0VfT1dORVJfS0ZELCBmYWxzZSk7DQogCWlmIChyZXQpDQogCQlnb3RvIHdh
aXRfcGRfZmFpbDsNCi0JcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQodm0tPnJvb3QuYm8t
PnRiby5iYXNlLnJlc3YsIDEpOw0KKwlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyh2bS0+
cm9vdC5iby0+dGJvLmJhc2UucmVzdiwgMSk7DQogCWlmIChyZXQpDQogCQlnb3RvIHJlc2VydmVf
c2hhcmVkX2ZhaWw7DQogCWFtZGdwdV9ib19mZW5jZSh2bS0+cm9vdC5ibywNCkBAIC0yNTMwLDcg
KzI1MzAsNyBAQCBpbnQgYW1kZ3B1X2FtZGtmZF9hZGRfZ3dzX3RvX3Byb2Nlc3Modm9pZCAqaW5m
bywgdm9pZCAqZ3dzLCBzdHJ1Y3Qga2dkX21lbSAqKm1lbQ0KIAkgKiBBZGQgcHJvY2VzcyBldmlj
dGlvbiBmZW5jZSB0byBibyBzbyB0aGV5IGNhbg0KIAkgKiBldmljdCBlYWNoIG90aGVyLg0KIAkg
Ki8NCi0JcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoZ3dzX2JvLT50Ym8uYmFzZS5yZXN2
LCAxKTsNCisJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoZ3dzX2JvLT50Ym8uYmFzZS5y
ZXN2LCAxKTsNCiAJaWYgKHJldCkNCiAJCWdvdG8gcmVzZXJ2ZV9zaGFyZWRfZmFpbDsNCiAJYW1k
Z3B1X2JvX2ZlbmNlKGd3c19ibywgJnByb2Nlc3NfaW5mby0+ZXZpY3Rpb25fZmVuY2UtPmJhc2Us
IHRydWUpOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9v
YmplY3QuYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9vYmplY3QuYw0KaW5k
ZXggNTY2MWI4MmQ4NGQ0Li5lYTYzYTBkMTM2MjEgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQv
YW1kZ3B1L2FtZGdwdV9vYmplY3QuYw0KQEAgLTEzODQsNiArMTM4NCwxNCBAQCB2b2lkIGFtZGdw
dV9ib19mZW5jZShzdHJ1Y3QgYW1kZ3B1X2JvICpibywgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2Us
DQogCQkgICAgIGJvb2wgc2hhcmVkKQ0KIHsNCiAJc3RydWN0IGRtYV9yZXN2ICpyZXN2ID0gYm8t
PnRiby5iYXNlLnJlc3Y7DQorCWludCByOw0KKw0KKwlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5j
ZXMocmVzdiwgMSk7DQorCWlmIChyKSB7DQorCQkvKiBBcyBsYXN0IHJlc29ydCBvbiBPT00gd2Ug
YmxvY2sgZm9yIHRoZSBmZW5jZSAqLw0KKwkJZG1hX2ZlbmNlX3dhaXQoZmVuY2UsIGZhbHNlKTsN
CisJCXJldHVybjsNCisJfQ0KIA0KIAlpZiAoc2hhcmVkKQ0KIAkJZG1hX3Jlc3ZfYWRkX3NoYXJl
ZF9mZW5jZShyZXN2LCBmZW5jZSk7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9h
bWRncHUvYW1kZ3B1X3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0u
Yw0KaW5kZXggYjM3ZmM3ZDdkMmM3Li4wYWI4NTI4MGU4ZWQgMTAwNjQ0DQotLS0gYS9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfdm0uYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2Ft
ZC9hbWRncHUvYW1kZ3B1X3ZtLmMNCkBAIC0yOTY4LDcgKzI5NjgsNyBAQCBpbnQgYW1kZ3B1X3Zt
X2luaXQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHN0cnVjdCBhbWRncHVfdm0gKnZtKQ0K
IAlpZiAocikNCiAJCWdvdG8gZXJyb3JfZnJlZV9yb290Ow0KIA0KLQlyID0gZG1hX3Jlc3ZfcmVz
ZXJ2ZV9zaGFyZWQocm9vdF9iby0+dGJvLmJhc2UucmVzdiwgMSk7DQorCXIgPSBkbWFfcmVzdl9y
ZXNlcnZlX2ZlbmNlcyhyb290X2JvLT50Ym8uYmFzZS5yZXN2LCAxKTsNCiAJaWYgKHIpDQogCQln
b3RvIGVycm9yX3VucmVzZXJ2ZTsNCiANCkBAIC0zNDExLDcgKzM0MTEsNyBAQCBib29sIGFtZGdw
dV92bV9oYW5kbGVfZmF1bHQoc3RydWN0IGFtZGdwdV9kZXZpY2UgKmFkZXYsIHUzMiBwYXNpZCwN
CiAJCXZhbHVlID0gMDsNCiAJfQ0KIA0KLQlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQocm9v
dC0+dGJvLmJhc2UucmVzdiwgMSk7DQorCXIgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyhyb290
LT50Ym8uYmFzZS5yZXN2LCAxKTsNCiAJaWYgKHIpIHsNCiAJCXByX2RlYnVnKCJmYWlsZWQgJWQg
dG8gcmVzZXJ2ZSBmZW5jZSBzbG90XG4iLCByKTsNCiAJCWdvdG8gZXJyb3JfdW5sb2NrOw0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9zdm0uYyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9zdm0uYw0KaW5kZXggZjI4MDViYTc0YzgwLi43Yjg3ODIy
MWYxZDMgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGtmZC9rZmRfc3ZtLmMN
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1ka2ZkL2tmZF9zdm0uYw0KQEAgLTU0Myw3ICs1
NDMsNyBAQCBzdm1fcmFuZ2VfdnJhbV9ub2RlX25ldyhzdHJ1Y3QgYW1kZ3B1X2RldmljZSAqYWRl
diwgc3RydWN0IHN2bV9yYW5nZSAqcHJhbmdlLA0KIAkJZ290byByZXNlcnZlX2JvX2ZhaWxlZDsN
CiAJfQ0KIA0KLQlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoYm8tPnRiby5iYXNlLnJlc3Ys
IDEpOw0KKwlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoYm8tPnRiby5iYXNlLnJlc3YsIDEp
Ow0KIAlpZiAocikgew0KIAkJcHJfZGVidWcoImZhaWxlZCAlZCB0byByZXNlcnZlIGJvXG4iLCBy
KTsNCiAJCWFtZGdwdV9ib191bnJlc2VydmUoYm8pOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2
aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMNCmluZGV4IDM4NWVhMTQxYzIzZS4uYjgwOGRkYjlkYTQ4
IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW1fc3VibWl0
LmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jDQpA
QCAtMTc5LDExICsxNzksOSBAQCBzdGF0aWMgaW50IHN1Ym1pdF9mZW5jZV9zeW5jKHN0cnVjdCBl
dG5hdml2X2dlbV9zdWJtaXQgKnN1Ym1pdCkNCiAJCXN0cnVjdCBldG5hdml2X2dlbV9zdWJtaXRf
Ym8gKmJvID0gJnN1Ym1pdC0+Ym9zW2ldOw0KIAkJc3RydWN0IGRtYV9yZXN2ICpyb2JqID0gYm8t
Pm9iai0+YmFzZS5yZXN2Ow0KIA0KLQkJaWYgKCEoYm8tPmZsYWdzICYgRVROQV9TVUJNSVRfQk9f
V1JJVEUpKSB7DQotCQkJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQocm9iaiwgMSk7DQot
CQkJaWYgKHJldCkNCi0JCQkJcmV0dXJuIHJldDsNCi0JCX0NCisJCXJldCA9IGRtYV9yZXN2X3Jl
c2VydmVfZmVuY2VzKHJvYmosIDEpOw0KKwkJaWYgKHJldCkNCisJCQlyZXR1cm4gcmV0Ow0KIA0K
IAkJaWYgKHN1Ym1pdC0+ZmxhZ3MgJiBFVE5BX1NVQk1JVF9OT19JTVBMSUNJVCkNCiAJCQljb250
aW51ZTsNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xm
bHVzaC5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYw0KaW5k
ZXggOGEyNDgwMDNkZmFlLi44YTIyMjNlYjBiYTkgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5jDQpAQCAtMTA2LDcgKzEwNiw4IEBAIGJvb2wgaTkxNV9n
ZW1fY2xmbHVzaF9vYmplY3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwNCiAJdHJh
Y2VfaTkxNV9nZW1fb2JqZWN0X2NsZmx1c2gob2JqKTsNCiANCiAJY2xmbHVzaCA9IE5VTEw7DQot
CWlmICghKGZsYWdzICYgSTkxNV9DTEZMVVNIX1NZTkMpKQ0KKwlpZiAoIShmbGFncyAmIEk5MTVf
Q0xGTFVTSF9TWU5DKSAmJg0KKwkgICAgZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMob2JqLT5iYXNl
LnJlc3YsIDEpID09IDApDQogCQljbGZsdXNoID0gY2xmbHVzaF93b3JrX2NyZWF0ZShvYmopOw0K
IAlpZiAoY2xmbHVzaCkgew0KIAkJaTkxNV9zd19mZW5jZV9hd2FpdF9yZXNlcnZhdGlvbigmY2xm
bHVzaC0+YmFzZS5jaGFpbiwNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fZXhlY2J1ZmZlci5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2Vt
X2V4ZWNidWZmZXIuYw0KaW5kZXggM2E1YjI0N2JlNzM4Li5lOGViNmVlODNmMjQgMTAwNjQ0DQot
LS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jDQorKysg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jDQpAQCAtOTk0
LDExICs5OTQsOSBAQCBzdGF0aWMgaW50IGViX3ZhbGlkYXRlX3ZtYXMoc3RydWN0IGk5MTVfZXhl
Y2J1ZmZlciAqZWIpDQogCQkJfQ0KIAkJfQ0KIA0KLQkJaWYgKCEoZXYtPmZsYWdzICYgRVhFQ19P
QkpFQ1RfV1JJVEUpKSB7DQotCQkJZXJyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQodm1hLT5v
YmotPmJhc2UucmVzdiwgMSk7DQotCQkJaWYgKGVycikNCi0JCQkJcmV0dXJuIGVycjsNCi0JCX0N
CisJCWVyciA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKHZtYS0+b2JqLT5iYXNlLnJlc3YsIDEp
Ow0KKwkJaWYgKGVycikNCisJCQlyZXR1cm4gZXJyOw0KIA0KIAkJR0VNX0JVR19PTihkcm1fbW1f
bm9kZV9hbGxvY2F0ZWQoJnZtYS0+bm9kZSkgJiYNCiAJCQkgICBlYl92bWFfbWlzcGxhY2VkKCZl
Yi0+ZXhlY1tpXSwgdm1hLCBldi0+ZmxhZ3MpKTsNCkBAIC0yMjk3LDcgKzIyOTUsNyBAQCBzdGF0
aWMgaW50IGViX3BhcnNlKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViKQ0KIAkJZ290byBlcnJf
dHJhbXBvbGluZTsNCiAJfQ0KIA0KLQllcnIgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChzaGFk
b3ctPm9iai0+YmFzZS5yZXN2LCAxKTsNCisJZXJyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMo
c2hhZG93LT5vYmotPmJhc2UucmVzdiwgMSk7DQogCWlmIChlcnIpDQogCQlnb3RvIGVycl90cmFt
cG9saW5lOw0KIA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dl
bV90dG1fbW92ZS5jIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3R0bV9tb3Zl
LmMNCmluZGV4IGVlOTYxMmEzZWU1ZS4uNGRlNjUwMGYzYzU1IDEwMDY0NA0KLS0tIGEvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3R0bV9tb3ZlLmMNCisrKyBiL2RyaXZlcnMvZ3B1
L2RybS9pOTE1L2dlbS9pOTE1X2dlbV90dG1fbW92ZS5jDQpAQCAtNTk2LDcgKzU5NiwxMSBAQCBp
bnQgaTkxNV9nZW1fb2JqX2NvcHlfdHRtKHN0cnVjdCBkcm1faTkxNV9nZW1fb2JqZWN0ICpkc3Qs
DQogCWFzc2VydF9vYmplY3RfaGVsZChzcmMpOw0KIAlpOTE1X2RlcHNfaW5pdCgmZGVwcywgR0ZQ
X0tFUk5FTCB8IF9fR0ZQX05PUkVUUlkgfCBfX0dGUF9OT1dBUk4pOw0KIA0KLQlyZXQgPSBkbWFf
cmVzdl9yZXNlcnZlX3NoYXJlZChzcmNfYm8tPmJhc2UucmVzdiwgMSk7DQorCXJldCA9IGRtYV9y
ZXN2X3Jlc2VydmVfZmVuY2VzKHNyY19iby0+YmFzZS5yZXN2LCAxKTsNCisJaWYgKHJldCkNCisJ
CXJldHVybiByZXQ7DQorDQorCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKGRzdF9iby0+
YmFzZS5yZXN2LCAxKTsNCiAJaWYgKHJldCkNCiAJCXJldHVybiByZXQ7DQogDQpkaWZmIC0tZ2l0
IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9taWdyYXRlLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21pZ3JhdGUuYw0K
aW5kZXggZWNiNjkxYzgxZDFlLi5mOWIzNjllZDRiNTAgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vc2VsZnRlc3RzL2k5MTVfZ2VtX21pZ3JhdGUuYw0KKysrIGIvZHJpdmVy
cy9ncHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9taWdyYXRlLmMNCkBAIC0xODAs
NyArMTgwLDEwIEBAIHN0YXRpYyBpbnQgaWd0X2xtZW1fcGFnZXNfbWlncmF0ZSh2b2lkICphcmcp
DQogCQkJCQkgIGk5MTVfZ2VtX29iamVjdF9pc19sbWVtKG9iaiksDQogCQkJCQkgIDB4ZGVhZGJl
YWYsICZycSk7DQogCQlpZiAocnEpIHsNCi0JCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShvYmot
PmJhc2UucmVzdiwgJnJxLT5mZW5jZSk7DQorCQkJZXJyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5j
ZXMob2JqLT5iYXNlLnJlc3YsIDEpOw0KKwkJCWlmICghZXJyKQ0KKwkJCQlkbWFfcmVzdl9hZGRf
ZXhjbF9mZW5jZShvYmotPmJhc2UucmVzdiwNCisJCQkJCQkJJnJxLT5mZW5jZSk7DQogCQkJaTkx
NV9yZXF1ZXN0X3B1dChycSk7DQogCQl9DQogCQlpZiAoZXJyKQ0KZGlmZiAtLWdpdCBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3Zt
YS5jDQppbmRleCBjMGQ2ZDU1MjZhYmUuLmZlOWY4OTI4OTQxOCAxMDA2NDQNCi0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmMNCkBAIC0xNjMzLDYgKzE2MzMsMTIgQEAgaW50IF9pOTE1X3ZtYV9tb3ZlX3RvX2Fj
dGl2ZShzdHJ1Y3QgaTkxNV92bWEgKnZtYSwNCiAJCQlpbnRlbF9mcm9udGJ1ZmZlcl9wdXQoZnJv
bnQpOw0KIAkJfQ0KIA0KKwkJaWYgKCEoZmxhZ3MgJiBfX0VYRUNfT0JKRUNUX05PX1JFU0VSVkUp
KSB7DQorCQkJZXJyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXModm1hLT5vYmotPmJhc2UucmVz
diwgMSk7DQorCQkJaWYgKHVubGlrZWx5KGVycikpDQorCQkJCXJldHVybiBlcnI7DQorCQl9DQor
DQogCQlpZiAoZmVuY2UpIHsNCiAJCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZSh2bWEtPm9iai0+
YmFzZS5yZXN2LCBmZW5jZSk7DQogCQkJb2JqLT53cml0ZV9kb21haW4gPSBJOTE1X0dFTV9ET01B
SU5fUkVOREVSOw0KQEAgLTE2NDAsNyArMTY0Niw3IEBAIGludCBfaTkxNV92bWFfbW92ZV90b19h
Y3RpdmUoc3RydWN0IGk5MTVfdm1hICp2bWEsDQogCQl9DQogCX0gZWxzZSB7DQogCQlpZiAoIShm
bGFncyAmIF9fRVhFQ19PQkpFQ1RfTk9fUkVTRVJWRSkpIHsNCi0JCQllcnIgPSBkbWFfcmVzdl9y
ZXNlcnZlX3NoYXJlZCh2bWEtPm9iai0+YmFzZS5yZXN2LCAxKTsNCisJCQllcnIgPSBkbWFfcmVz
dl9yZXNlcnZlX2ZlbmNlcyh2bWEtPm9iai0+YmFzZS5yZXN2LCAxKTsNCiAJCQlpZiAodW5saWtl
bHkoZXJyKSkNCiAJCQkJcmV0dXJuIGVycjsNCiAJCX0NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9zZWxmdGVzdHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX21lbW9yeV9yZWdpb24uYw0KaW5kZXggN2FjYmExZDIx
MzVlLi43ZjQwNTAyYjJjMWUgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9zZWxm
dGVzdHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9z
ZWxmdGVzdHMvaW50ZWxfbWVtb3J5X3JlZ2lvbi5jDQpAQCAtODk1LDYgKzg5NSwxMyBAQCBzdGF0
aWMgaW50IGlndF9sbWVtX3dyaXRlX2NwdSh2b2lkICphcmcpDQogCX0NCiANCiAJaTkxNV9nZW1f
b2JqZWN0X2xvY2sob2JqLCBOVUxMKTsNCisNCisJZXJyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5j
ZXMob2JqLT5iYXNlLnJlc3YsIDEpOw0KKwlpZiAoZXJyKSB7DQorCQlpOTE1X2dlbV9vYmplY3Rf
dW5sb2NrKG9iaik7DQorCQlnb3RvIG91dF9wdXQ7DQorCX0NCisNCiAJLyogUHV0IHRoZSBwYWdl
cyBpbnRvIGEga25vd24gc3RhdGUgLS0gZnJvbSB0aGUgZ3B1IGZvciBhZGRlZCBmdW4gKi8NCiAJ
aW50ZWxfZW5naW5lX3BtX2dldChlbmdpbmUpOw0KIAllcnIgPSBpbnRlbF9jb250ZXh0X21pZ3Jh
dGVfY2xlYXIoZW5naW5lLT5ndC0+bWlncmF0ZS5jb250ZXh0LCBOVUxMLA0KZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vbGltYS9s
aW1hX2dlbS5jDQppbmRleCBmOWE5MTk4ZWYxOTguLjY1NjgxMmYwYmYzOCAxMDA2NDQNCi0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfZ2VtLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9s
aW1hL2xpbWFfZ2VtLmMNCkBAIC0yNTUsMTMgKzI1NSwxMSBAQCBpbnQgbGltYV9nZW1fZ2V0X2lu
Zm8oc3RydWN0IGRybV9maWxlICpmaWxlLCB1MzIgaGFuZGxlLCB1MzIgKnZhLCB1NjQgKm9mZnNl
dCkNCiBzdGF0aWMgaW50IGxpbWFfZ2VtX3N5bmNfYm8oc3RydWN0IGxpbWFfc2NoZWRfdGFzayAq
dGFzaywgc3RydWN0IGxpbWFfYm8gKmJvLA0KIAkJCSAgICBib29sIHdyaXRlLCBib29sIGV4cGxp
Y2l0KQ0KIHsNCi0JaW50IGVyciA9IDA7DQorCWludCBlcnI7DQogDQotCWlmICghd3JpdGUpIHsN
Ci0JCWVyciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKGxpbWFfYm9fcmVzdihibyksIDEpOw0K
LQkJaWYgKGVycikNCi0JCQlyZXR1cm4gZXJyOw0KLQl9DQorCWVyciA9IGRtYV9yZXN2X3Jlc2Vy
dmVfZmVuY2VzKGxpbWFfYm9fcmVzdihibyksIDEpOw0KKwlpZiAoZXJyKQ0KKwkJcmV0dXJuIGVy
cjsNCiANCiAJLyogZXhwbGljaXQgc3luYyB1c2UgdXNlciBwYXNzZWQgZGVwIGZlbmNlICovDQog
CWlmIChleHBsaWNpdCkNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1f
c3VibWl0LmMgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMNCmluZGV4IDZj
ZmE5ODRkZWU2YS4uOTkzZGJjZDdhNTg2IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL21z
bS9tc21fZ2VtX3N1Ym1pdC5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3Vi
bWl0LmMNCkBAIC0zMjAsMTYgKzMyMCwxNCBAQCBzdGF0aWMgaW50IHN1Ym1pdF9mZW5jZV9zeW5j
KHN0cnVjdCBtc21fZ2VtX3N1Ym1pdCAqc3VibWl0LCBib29sIG5vX2ltcGxpY2l0KQ0KIAkJc3Ry
dWN0IGRybV9nZW1fb2JqZWN0ICpvYmogPSAmc3VibWl0LT5ib3NbaV0ub2JqLT5iYXNlOw0KIAkJ
Ym9vbCB3cml0ZSA9IHN1Ym1pdC0+Ym9zW2ldLmZsYWdzICYgTVNNX1NVQk1JVF9CT19XUklURTsN
CiANCi0JCWlmICghd3JpdGUpIHsNCi0JCQkvKiBOT1RFOiBfcmVzZXJ2ZV9zaGFyZWQoKSBtdXN0
IGhhcHBlbiBiZWZvcmUNCi0JCQkgKiBfYWRkX3NoYXJlZF9mZW5jZSgpLCB3aGljaCBtYWtlcyB0
aGlzIGEgc2xpZ2h0bHkNCi0JCQkgKiBzdHJhbmdlIHBsYWNlIHRvIGNhbGwgaXQuICBPVE9IIHRo
aXMgaXMgYQ0KLQkJCSAqIGNvbnZlbmllbnQgY2FuLWZhaWwgcG9pbnQgdG8gaG9vayBpdCBpbi4N
Ci0JCQkgKi8NCi0JCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChvYmotPnJlc3YsIDEp
Ow0KLQkJCWlmIChyZXQpDQotCQkJCXJldHVybiByZXQ7DQotCQl9DQorCQkvKiBOT1RFOiBfcmVz
ZXJ2ZV9zaGFyZWQoKSBtdXN0IGhhcHBlbiBiZWZvcmUNCisJCSAqIF9hZGRfc2hhcmVkX2ZlbmNl
KCksIHdoaWNoIG1ha2VzIHRoaXMgYSBzbGlnaHRseQ0KKwkJICogc3RyYW5nZSBwbGFjZSB0byBj
YWxsIGl0LiAgT1RPSCB0aGlzIGlzIGENCisJCSAqIGNvbnZlbmllbnQgY2FuLWZhaWwgcG9pbnQg
dG8gaG9vayBpdCBpbi4NCisJCSAqLw0KKwkJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMo
b2JqLT5yZXN2LCAxKTsNCisJCWlmIChyZXQpDQorCQkJcmV0dXJuIHJldDsNCiANCiAJCS8qIGV4
Y2x1c2l2ZSBmZW5jZXMgbXVzdCBiZSBvcmRlcmVkICovDQogCQlpZiAobm9faW1wbGljaXQgJiYg
IXdyaXRlKQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmVu
Y2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmVuY2UuYw0KaW5kZXggYTNh
MDRlMGQ3NmVjLi4wMjY4MjU5ZTk3ZWIgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2ZlbmNlLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZl
YXVfZmVuY2UuYw0KQEAgLTM0NiwxMSArMzQ2LDkgQEAgbm91dmVhdV9mZW5jZV9zeW5jKHN0cnVj
dCBub3V2ZWF1X2JvICpudmJvLCBzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpjaGFuLA0KIAlzdHJ1
Y3QgZG1hX3Jlc3YgKnJlc3YgPSBudmJvLT5iby5iYXNlLnJlc3Y7DQogCWludCBpLCByZXQ7DQog
DQotCWlmICghZXhjbHVzaXZlKSB7DQotCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChy
ZXN2LCAxKTsNCi0JCWlmIChyZXQpDQotCQkJcmV0dXJuIHJldDsNCi0JfQ0KKwlyZXQgPSBkbWFf
cmVzdl9yZXNlcnZlX2ZlbmNlcyhyZXN2LCAxKTsNCisJaWYgKHJldCkNCisJCXJldHVybiByZXQ7
DQogDQogCS8qIFdhaXRpbmcgZm9yIHRoZSBleGNsdXNpdmUgZmVuY2UgZmlyc3QgY2F1c2VzIHBl
cmZvcm1hbmNlIHJlZ3Jlc3Npb25zDQogCSAqIHVuZGVyIHNvbWUgY2lyY3Vtc3RhbmNlcy4gU28g
bWFudWFsbHkgd2FpdCBmb3IgdGhlIHNoYXJlZCBvbmVzIGZpcnN0Lg0KZGlmZiAtLWdpdCBhL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuYyBiL2RyaXZlcnMvZ3B1L2RybS9w
YW5mcm9zdC9wYW5mcm9zdF9qb2IuYw0KaW5kZXggOTA4ZDc5NTIwODUzLi5jY2E1MGNiYjdmMGIg
MTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMNCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuYw0KQEAgLTI0Nyw2ICsy
NDcsMTAgQEAgc3RhdGljIGludCBwYW5mcm9zdF9hY3F1aXJlX29iamVjdF9mZW5jZXMoc3RydWN0
IGRybV9nZW1fb2JqZWN0ICoqYm9zLA0KIAlpbnQgaSwgcmV0Ow0KIA0KIAlmb3IgKGkgPSAwOyBp
IDwgYm9fY291bnQ7IGkrKykgew0KKwkJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoYm9z
W2ldLT5yZXN2LCAxKTsNCisJCWlmIChyZXQpDQorCQkJcmV0dXJuIHJldDsNCisNCiAJCS8qIHBh
bmZyb3N0IGFsd2F5cyB1c2VzIHdyaXRlIG1vZGUgaW4gaXRzIGN1cnJlbnQgdWFwaSAqLw0KIAkJ
cmV0ID0gZHJtX3NjaGVkX2pvYl9hZGRfaW1wbGljaXRfZGVwZW5kZW5jaWVzKGpvYiwgYm9zW2ld
LA0KIAkJCQkJCQkgICAgICB0cnVlKTsNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcXhs
L3F4bF9yZWxlYXNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9yZWxlYXNlLmMNCmluZGV4
IDQ2OTk3OWNkMDM0MS4uY2RlMWU4ZGRhZWFhIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJt
L3F4bC9xeGxfcmVsZWFzZS5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9yZWxlYXNl
LmMNCkBAIC0yMDAsNyArMjAwLDcgQEAgc3RhdGljIGludCBxeGxfcmVsZWFzZV92YWxpZGF0ZV9i
byhzdHJ1Y3QgcXhsX2JvICpibykNCiAJCQlyZXR1cm4gcmV0Ow0KIAl9DQogDQotCXJldCA9IGRt
YV9yZXN2X3Jlc2VydmVfc2hhcmVkKGJvLT50Ym8uYmFzZS5yZXN2LCAxKTsNCisJcmV0ID0gZG1h
X3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoYm8tPnRiby5iYXNlLnJlc3YsIDEpOw0KIAlpZiAocmV0KQ0K
IAkJcmV0dXJuIHJldDsNCiANCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRlb25fY3MuYw0KaW5kZXggOWVk
MmIyNzAwZTBhLi40NDZmN2JhZTU0YzQgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcmFk
ZW9uL3JhZGVvbl9jcy5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9jcy5j
DQpAQCAtNTM1LDYgKzUzNSwxMCBAQCBzdGF0aWMgaW50IHJhZGVvbl9ib192bV91cGRhdGVfcHRl
KHN0cnVjdCByYWRlb25fY3NfcGFyc2VyICpwLA0KIAkJCXJldHVybiByOw0KIA0KIAkJcmFkZW9u
X3N5bmNfZmVuY2UoJnAtPmliLnN5bmMsIGJvX3ZhLT5sYXN0X3B0X3VwZGF0ZSk7DQorDQorCQly
ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoYm8tPnRiby5iYXNlLnJlc3YsIDEpOw0KKwkJaWYg
KHIpDQorCQkJcmV0dXJuIHI7DQogCX0NCiANCiAJcmV0dXJuIHJhZGVvbl92bV9jbGVhcl9pbnZh
bGlkcyhyZGV2LCB2bSk7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9yYWRl
b25fb2JqZWN0LmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYw0KaW5k
ZXggNTZlZGU5ZDYzYjEyLi44NzBiMTM2MzVkYmYgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9k
cm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3JhZGVvbi9y
YWRlb25fb2JqZWN0LmMNCkBAIC04MDgsNiArODA4LDE0IEBAIHZvaWQgcmFkZW9uX2JvX2ZlbmNl
KHN0cnVjdCByYWRlb25fYm8gKmJvLCBzdHJ1Y3QgcmFkZW9uX2ZlbmNlICpmZW5jZSwNCiAJCSAg
ICAgYm9vbCBzaGFyZWQpDQogew0KIAlzdHJ1Y3QgZG1hX3Jlc3YgKnJlc3YgPSBiby0+dGJvLmJh
c2UucmVzdjsNCisJaW50IHI7DQorDQorCXIgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyhyZXN2
LCAxKTsNCisJaWYgKHIpIHsNCisJCS8qIEFzIGxhc3QgcmVzb3J0IG9uIE9PTSB3ZSBibG9jayBm
b3IgdGhlIGZlbmNlICovDQorCQlkbWFfZmVuY2Vfd2FpdCgmZmVuY2UtPmJhc2UsIGZhbHNlKTsN
CisJCXJldHVybjsNCisJfQ0KIA0KIAlpZiAoc2hhcmVkKQ0KIAkJZG1hX3Jlc3ZfYWRkX3NoYXJl
ZF9mZW5jZShyZXN2LCAmZmVuY2UtPmJhc2UpOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS9yYWRlb24vcmFkZW9uX3ZtLmMgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl92bS5j
DQppbmRleCBiYjUzMDE2ZjMxMzguLjk4N2NhYmJmMTMxOCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMv
Z3B1L2RybS9yYWRlb24vcmFkZW9uX3ZtLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24v
cmFkZW9uX3ZtLmMNCkBAIC04MzEsNyArODMxLDcgQEAgc3RhdGljIGludCByYWRlb25fdm1fdXBk
YXRlX3B0ZXMoc3RydWN0IHJhZGVvbl9kZXZpY2UgKnJkZXYsDQogCQlpbnQgcjsNCiANCiAJCXJh
ZGVvbl9zeW5jX3Jlc3YocmRldiwgJmliLT5zeW5jLCBwdC0+dGJvLmJhc2UucmVzdiwgdHJ1ZSk7
DQotCQlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQocHQtPnRiby5iYXNlLnJlc3YsIDEpOw0K
KwkJciA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKHB0LT50Ym8uYmFzZS5yZXN2LCAxKTsNCiAJ
CWlmIChyKQ0KIAkJCXJldHVybiByOw0KIA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jDQppbmRleCBkYjNkYzdl
ZjUzODIuLjFkZDZmMTNiYjAzYyAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRt
X2JvLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvLmMNCkBAIC03NjIsNyArNzYy
LDcgQEAgc3RhdGljIGludCB0dG1fYm9fYWRkX21vdmVfZmVuY2Uoc3RydWN0IHR0bV9idWZmZXJf
b2JqZWN0ICpibywNCiANCiAJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShiby0+YmFzZS5yZXN2
LCBmZW5jZSk7DQogDQotCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKGJvLT5iYXNlLnJl
c3YsIDEpOw0KKwlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyhiby0+YmFzZS5yZXN2LCAx
KTsNCiAJaWYgKHVubGlrZWx5KHJldCkpIHsNCiAJCWRtYV9mZW5jZV9wdXQoZmVuY2UpOw0KIAkJ
cmV0dXJuIHJldDsNCkBAIC04MjEsNyArODIxLDcgQEAgaW50IHR0bV9ib19tZW1fc3BhY2Uoc3Ry
dWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywNCiAJYm9vbCB0eXBlX2ZvdW5kID0gZmFsc2U7DQog
CWludCBpLCByZXQ7DQogDQotCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKGJvLT5iYXNl
LnJlc3YsIDEpOw0KKwlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyhiby0+YmFzZS5yZXN2
LCAxKTsNCiAJaWYgKHVubGlrZWx5KHJldCkpDQogCQlyZXR1cm4gcmV0Ow0KIA0KZGlmZiAtLWdp
dCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2RybS90
dG0vdHRtX2JvX3V0aWwuYw0KaW5kZXggNTQ0YTg0ZmE2NTg5Li44NjJkMmYyMjQxMmEgMTAwNjQ0
DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS90dG0vdHRtX2JvX3V0aWwuYw0KQEAgLTIyMSw5ICsyMjEsNiBAQCBzdGF0aWMgaW50
IHR0bV9idWZmZXJfb2JqZWN0X3RyYW5zZmVyKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8s
DQogDQogCWZiby0+YmFzZSA9ICpibzsNCiANCi0JdHRtX2JvX2dldChibyk7DQotCWZiby0+Ym8g
PSBibzsNCi0NCiAJLyoqDQogCSAqIEZpeCB1cCBtZW1iZXJzIHRoYXQgd2Ugc2hvdWxkbid0IGNv
cHkgZGlyZWN0bHk6DQogCSAqIFRPRE86IEV4cGxpY2l0IG1lbWJlciBjb3B5IHdvdWxkIHByb2Jh
Ymx5IGJlIGJldHRlciBoZXJlLg0KQEAgLTI1MSw2ICsyNDgsMTUgQEAgc3RhdGljIGludCB0dG1f
YnVmZmVyX29iamVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLA0KIAly
ZXQgPSBkbWFfcmVzdl90cnlsb2NrKCZmYm8tPmJhc2UuYmFzZS5fcmVzdik7DQogCVdBUk5fT04o
IXJldCk7DQogDQorCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKCZmYm8tPmJhc2UuYmFz
ZS5fcmVzdiwgMSk7DQorCWlmIChyZXQpIHsNCisJCWtmcmVlKGZibyk7DQorCQlyZXR1cm4gcmV0
Ow0KKwl9DQorDQorCXR0bV9ib19nZXQoYm8pOw0KKwlmYm8tPmJvID0gYm87DQorDQogCXR0bV9i
b19tb3ZlX3RvX2xydV90YWlsX3VubG9ja2VkKCZmYm8tPmJhc2UpOw0KIA0KIAkqbmV3X29iaiA9
ICZmYm8tPmJhc2U7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZXhlY2J1
Zl91dGlsLmMgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYw0KaW5kZXgg
MDcxYzQ4ZDY3MmM2Li43ODljNjQ1ZjAwNGUgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0v
dHRtL3R0bV9leGVjYnVmX3V0aWwuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZXhl
Y2J1Zl91dGlsLmMNCkBAIC05MCw2ICs5MCw3IEBAIGludCB0dG1fZXVfcmVzZXJ2ZV9idWZmZXJz
KHN0cnVjdCB3d19hY3F1aXJlX2N0eCAqdGlja2V0LA0KIA0KIAlsaXN0X2Zvcl9lYWNoX2VudHJ5
KGVudHJ5LCBsaXN0LCBoZWFkKSB7DQogCQlzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvID0g
ZW50cnktPmJvOw0KKwkJdW5zaWduZWQgaW50IG51bV9mZW5jZXM7DQogDQogCQlyZXQgPSB0dG1f
Ym9fcmVzZXJ2ZShibywgaW50ciwgKHRpY2tldCA9PSBOVUxMKSwgdGlja2V0KTsNCiAJCWlmIChy
ZXQgPT0gLUVBTFJFQURZICYmIGR1cHMpIHsNCkBAIC0xMDAsMTIgKzEwMSwxMCBAQCBpbnQgdHRt
X2V1X3Jlc2VydmVfYnVmZmVycyhzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKnRpY2tldCwNCiAJCQlj
b250aW51ZTsNCiAJCX0NCiANCisJCW51bV9mZW5jZXMgPSBtaW4oZW50cnktPm51bV9zaGFyZWQs
IDF1KTsNCiAJCWlmICghcmV0KSB7DQotCQkJaWYgKCFlbnRyeS0+bnVtX3NoYXJlZCkNCi0JCQkJ
Y29udGludWU7DQotDQotCQkJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoYm8tPmJhc2Uu
cmVzdiwNCi0JCQkJCQkJCWVudHJ5LT5udW1fc2hhcmVkKTsNCisJCQlyZXQgPSBkbWFfcmVzdl9y
ZXNlcnZlX2ZlbmNlcyhiby0+YmFzZS5yZXN2LA0KKwkJCQkJCSAgICAgIG51bV9mZW5jZXMpOw0K
IAkJCWlmICghcmV0KQ0KIAkJCQljb250aW51ZTsNCiAJCX0NCkBAIC0xMjAsOSArMTE5LDkgQEAg
aW50IHR0bV9ldV9yZXNlcnZlX2J1ZmZlcnMoc3RydWN0IHd3X2FjcXVpcmVfY3R4ICp0aWNrZXQs
DQogCQkJcmV0ID0gdHRtX2JvX3Jlc2VydmVfc2xvd3BhdGgoYm8sIGludHIsIHRpY2tldCk7DQog
CQl9DQogDQotCQlpZiAoIXJldCAmJiBlbnRyeS0+bnVtX3NoYXJlZCkNCi0JCQlyZXQgPSBkbWFf
cmVzdl9yZXNlcnZlX3NoYXJlZChiby0+YmFzZS5yZXN2LA0KLQkJCQkJCQkJZW50cnktPm51bV9z
aGFyZWQpOw0KKwkJaWYgKCFyZXQpDQorCQkJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMo
Ym8tPmJhc2UucmVzdiwNCisJCQkJCQkgICAgICBudW1fZmVuY2VzKTsNCiANCiAJCWlmICh1bmxp
a2VseShyZXQgIT0gMCkpIHsNCiAJCQlpZiAodGlja2V0KSB7DQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9ncHUvZHJtL3YzZC92M2RfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdjNkL3YzZF9nZW0uYw0K
aW5kZXggOTJiYzBmYWVlODRmLi45NjE4MTJkMzM4MjcgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vdjNkL3YzZF9nZW0uYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3YzZC92M2RfZ2VtLmMN
CkBAIC0yNTksMTYgKzI1OSwyMSBAQCB2M2RfbG9ja19ib19yZXNlcnZhdGlvbnMoc3RydWN0IHYz
ZF9qb2IgKmpvYiwNCiAJCXJldHVybiByZXQ7DQogDQogCWZvciAoaSA9IDA7IGkgPCBqb2ItPmJv
X2NvdW50OyBpKyspIHsNCisJCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKGpvYi0+Ym9b
aV0tPnJlc3YsIDEpOw0KKwkJaWYgKHJldCkNCisJCQlnb3RvIGZhaWw7DQorDQogCQlyZXQgPSBk
cm1fc2NoZWRfam9iX2FkZF9pbXBsaWNpdF9kZXBlbmRlbmNpZXMoJmpvYi0+YmFzZSwNCiAJCQkJ
CQkJICAgICAgam9iLT5ib1tpXSwgdHJ1ZSk7DQotCQlpZiAocmV0KSB7DQotCQkJZHJtX2dlbV91
bmxvY2tfcmVzZXJ2YXRpb25zKGpvYi0+Ym8sIGpvYi0+Ym9fY291bnQsDQotCQkJCQkJICAgIGFj
cXVpcmVfY3R4KTsNCi0JCQlyZXR1cm4gcmV0Ow0KLQkJfQ0KKwkJaWYgKHJldCkNCisJCQlnb3Rv
IGZhaWw7DQogCX0NCiANCiAJcmV0dXJuIDA7DQorDQorZmFpbDoNCisJZHJtX2dlbV91bmxvY2tf
cmVzZXJ2YXRpb25zKGpvYi0+Ym8sIGpvYi0+Ym9fY291bnQsIGFjcXVpcmVfY3R4KTsNCisJcmV0
dXJuIHJldDsNCiB9DQogDQogLyoqDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZjNC92
YzRfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9nZW0uYw0KaW5kZXggNDQ1ZDNiYWI4
OWUwLi40YWFjYzVkZTIxOTkgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9n
ZW0uYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZjNC92YzRfZ2VtLmMNCkBAIC02NDEsNyArNjQx
LDcgQEAgdmM0X2xvY2tfYm9fcmVzZXJ2YXRpb25zKHN0cnVjdCBkcm1fZGV2aWNlICpkZXYsDQog
CWZvciAoaSA9IDA7IGkgPCBleGVjLT5ib19jb3VudDsgaSsrKSB7DQogCQlibyA9ICZleGVjLT5i
b1tpXS0+YmFzZTsNCiANCi0JCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKGJvLT5yZXN2
LCAxKTsNCisJCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKGJvLT5yZXN2LCAxKTsNCiAJ
CWlmIChyZXQpIHsNCiAJCQl2YzRfdW5sb2NrX2JvX3Jlc2VydmF0aW9ucyhkZXYsIGV4ZWMsIGFj
cXVpcmVfY3R4KTsNCiAJCQlyZXR1cm4gcmV0Ow0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2Ry
bS92Z2VtL3ZnZW1fZmVuY2UuYyBiL2RyaXZlcnMvZ3B1L2RybS92Z2VtL3ZnZW1fZmVuY2UuYw0K
aW5kZXggYmQ2Zjc1Mjg1ZmQ5Li4yZGRiZWJjYTg3ZDkgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vdmdlbS92Z2VtX2ZlbmNlLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92Z2VtL3ZnZW1f
ZmVuY2UuYw0KQEAgLTE1NywxMiArMTU3LDE0IEBAIGludCB2Z2VtX2ZlbmNlX2F0dGFjaF9pb2N0
bChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LA0KIAl9DQogDQogCS8qIEV4cG9zZSB0aGUgZmVuY2Ug
dmlhIHRoZSBkbWEtYnVmICovDQotCXJldCA9IDA7DQogCWRtYV9yZXN2X2xvY2socmVzdiwgTlVM
TCk7DQotCWlmIChhcmctPmZsYWdzICYgVkdFTV9GRU5DRV9XUklURSkNCi0JCWRtYV9yZXN2X2Fk
ZF9leGNsX2ZlbmNlKHJlc3YsIGZlbmNlKTsNCi0JZWxzZSBpZiAoKHJldCA9IGRtYV9yZXN2X3Jl
c2VydmVfc2hhcmVkKHJlc3YsIDEpKSA9PSAwKQ0KLQkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5j
ZShyZXN2LCBmZW5jZSk7DQorCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKHJlc3YsIDEp
Ow0KKwlpZiAoIXJldCkgew0KKwkJaWYgKGFyZy0+ZmxhZ3MgJiBWR0VNX0ZFTkNFX1dSSVRFKQ0K
KwkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHJlc3YsIGZlbmNlKTsNCisJCWVsc2UNCisJCQlk
bWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHJlc3YsIGZlbmNlKTsNCisJfQ0KIAlkbWFfcmVzdl91
bmxvY2socmVzdik7DQogDQogCS8qIFJlY29yZCB0aGUgZmVuY2UgaW4gb3VyIGlkciBmb3IgbGF0
ZXIgc2lnbmFsaW5nICovDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0
Z3B1X2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2dlbS5jDQppbmRleCA0
OGQzYzk5NTVmMGQuLjE4MjBjYTZjZjY3MyAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS92
aXJ0aW8vdmlydGdwdV9nZW0uYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1
X2dlbS5jDQpAQCAtMjE0LDYgKzIxNCw3IEBAIHZvaWQgdmlydGlvX2dwdV9hcnJheV9hZGRfb2Jq
KHN0cnVjdCB2aXJ0aW9fZ3B1X29iamVjdF9hcnJheSAqb2JqcywNCiANCiBpbnQgdmlydGlvX2dw
dV9hcnJheV9sb2NrX3Jlc3Yoc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5ICpvYmpzKQ0K
IHsNCisJdW5zaWduZWQgaW50IGk7DQogCWludCByZXQ7DQogDQogCWlmIChvYmpzLT5uZW50cyA9
PSAxKSB7DQpAQCAtMjIyLDYgKzIyMywxNCBAQCBpbnQgdmlydGlvX2dwdV9hcnJheV9sb2NrX3Jl
c3Yoc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5ICpvYmpzKQ0KIAkJcmV0ID0gZHJtX2dl
bV9sb2NrX3Jlc2VydmF0aW9ucyhvYmpzLT5vYmpzLCBvYmpzLT5uZW50cywNCiAJCQkJCQkmb2Jq
cy0+dGlja2V0KTsNCiAJfQ0KKwlpZiAocmV0KQ0KKwkJcmV0dXJuIHJldDsNCisNCisJZm9yIChp
ID0gMDsgaSA8IG9ianMtPm5lbnRzOyArK2kpIHsNCisJCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVf
ZmVuY2VzKG9ianMtPm9ianNbaV0tPnJlc3YsIDEpOw0KKwkJaWYgKHJldCkNCisJCQlyZXR1cm4g
cmV0Ow0KKwl9DQogCXJldHVybiByZXQ7DQogfQ0KIA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS92bXdnZngvdm13Z2Z4X2JvLmMgYi9kcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9i
by5jDQppbmRleCAzMWFlY2M0NjYyNGIuLmZlMTNhYThiNGE2NCAxMDA2NDQNCi0tLSBhL2RyaXZl
cnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdn
Zngvdm13Z2Z4X2JvLmMNCkBAIC03NDcsMTYgKzc0NywyMiBAQCB2b2lkIHZtd19ib19mZW5jZV9z
aW5nbGUoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywNCiAJCQkgc3RydWN0IHZtd19mZW5j
ZV9vYmogKmZlbmNlKQ0KIHsNCiAJc3RydWN0IHR0bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsN
Ci0NCiAJc3RydWN0IHZtd19wcml2YXRlICpkZXZfcHJpdiA9DQogCQljb250YWluZXJfb2YoYmRl
diwgc3RydWN0IHZtd19wcml2YXRlLCBiZGV2KTsNCisJaW50IHJldDsNCiANCi0JaWYgKGZlbmNl
ID09IE5VTEwpIHsNCisJaWYgKGZlbmNlID09IE5VTEwpDQogCQl2bXdfZXhlY2J1Zl9mZW5jZV9j
b21tYW5kcyhOVUxMLCBkZXZfcHJpdiwgJmZlbmNlLCBOVUxMKTsNCisJZWxzZQ0KKwkJZG1hX2Zl
bmNlX2dldCgmZmVuY2UtPmJhc2UpOw0KKw0KKwlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNl
cyhiby0+YmFzZS5yZXN2LCAxKTsNCisJaWYgKCFyZXQpDQogCQlkbWFfcmVzdl9hZGRfZXhjbF9m
ZW5jZShiby0+YmFzZS5yZXN2LCAmZmVuY2UtPmJhc2UpOw0KLQkJZG1hX2ZlbmNlX3B1dCgmZmVu
Y2UtPmJhc2UpOw0KLQl9IGVsc2UNCi0JCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKGJvLT5iYXNl
LnJlc3YsICZmZW5jZS0+YmFzZSk7DQorCWVsc2UNCisJCS8qIExhc3QgcmVzb3J0IGZhbGxiYWNr
IHdoZW4gd2UgYXJlIE9PTSAqLw0KKwkJZG1hX2ZlbmNlX3dhaXQoJmZlbmNlLT5iYXNlLCBmYWxz
ZSk7DQorCWRtYV9mZW5jZV9wdXQoJmZlbmNlLT5iYXNlKTsNCiB9DQogDQogDQpkaWZmIC0tZ2l0
IGEvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oIGIvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oDQpp
bmRleCBlY2I2OTdkNGQ4NjEuLjVmYTA0ZDBmY2NhZCAxMDA2NDQNCi0tLSBhL2luY2x1ZGUvbGlu
dXgvZG1hLXJlc3YuaA0KKysrIGIvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oDQpAQCAtMTE3LDcg
KzExNyw3IEBAIHN0cnVjdCBkbWFfcmVzdiB7DQogCSAqIEEgbmV3IGZlbmNlIGlzIGFkZGVkIGJ5
IGNhbGxpbmcgZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZSgpLiBTaW5jZQ0KIAkgKiB0aGlzIG9m
dGVuIG5lZWRzIHRvIGJlIGRvbmUgcGFzdCB0aGUgcG9pbnQgb2Ygbm8gcmV0dXJuIGluIGNvbW1h
bmQNCiAJICogc3VibWlzc2lvbiBpdCBjYW5ub3QgZmFpbCwgYW5kIHRoZXJlZm9yZSBzdWZmaWNp
ZW50IHNsb3RzIG5lZWQgdG8gYmUNCi0JICogcmVzZXJ2ZWQgYnkgY2FsbGluZyBkbWFfcmVzdl9y
ZXNlcnZlX3NoYXJlZCgpLg0KKwkgKiByZXNlcnZlZCBieSBjYWxsaW5nIGRtYV9yZXN2X3Jlc2Vy
dmVfZmVuY2VzKCkuDQogCSAqDQogCSAqIE5vdGUgdGhhdCBhY3R1YWwgc2VtYW50aWNzIG9mIHdo
YXQgYW4gZXhjbHVzaXZlIG9yIHNoYXJlZCBmZW5jZSBtZWFuDQogCSAqIGlzIGRlZmluZWQgYnkg
dGhlIHVzZXIsIGZvciByZXNlcnZhdGlvbiBvYmplY3RzIHNoYXJlZCBhY3Jvc3MgZHJpdmVycw0K
QEAgLTQxMyw3ICs0MTMsNyBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZG1hX3Jlc3ZfdW5sb2NrKHN0
cnVjdCBkbWFfcmVzdiAqb2JqKQ0KIA0KIHZvaWQgZG1hX3Jlc3ZfaW5pdChzdHJ1Y3QgZG1hX3Jl
c3YgKm9iaik7DQogdm9pZCBkbWFfcmVzdl9maW5pKHN0cnVjdCBkbWFfcmVzdiAqb2JqKTsNCi1p
bnQgZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoc3RydWN0IGRtYV9yZXN2ICpvYmosIHVuc2lnbmVk
IGludCBudW1fZmVuY2VzKTsNCitpbnQgZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoc3RydWN0IGRt
YV9yZXN2ICpvYmosIHVuc2lnbmVkIGludCBudW1fZmVuY2VzKTsNCiB2b2lkIGRtYV9yZXN2X2Fk
ZF9zaGFyZWRfZmVuY2Uoc3RydWN0IGRtYV9yZXN2ICpvYmosIHN0cnVjdCBkbWFfZmVuY2UgKmZl
bmNlKTsNCiB2b2lkIGRtYV9yZXN2X3JlcGxhY2VfZmVuY2VzKHN0cnVjdCBkbWFfcmVzdiAqb2Jq
LCB1aW50NjRfdCBjb250ZXh0LA0KIAkJCSAgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOw0K
LS0gDQoyLjI1LjENCg0KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QgLS0gbGluYXJvLW1tLXNpZ0BsaXN0cy5s
aW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1haWwgdG8gbGluYXJvLW1tLXNpZy1s
ZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
