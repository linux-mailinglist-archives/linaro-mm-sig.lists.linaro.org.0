Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id D3910A808AE
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  8 Apr 2025 14:47:48 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E7407446CB
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  8 Apr 2025 12:47:47 +0000 (UTC)
Received: from mail-oa1-f50.google.com (mail-oa1-f50.google.com [209.85.160.50])
	by lists.linaro.org (Postfix) with ESMTPS id 6CFE940B40
	for <linaro-mm-sig@lists.linaro.org>; Tue,  8 Apr 2025 12:47:29 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linaro.org header.s=google header.b=Gvj+2FaE;
	spf=pass (lists.linaro.org: domain of jens.wiklander@linaro.org designates 209.85.160.50 as permitted sender) smtp.mailfrom=jens.wiklander@linaro.org;
	dmarc=pass (policy=none) header.from=linaro.org
Received: by mail-oa1-f50.google.com with SMTP id 586e51a60fabf-2c2ada8264aso2902280fac.2
        for <linaro-mm-sig@lists.linaro.org>; Tue, 08 Apr 2025 05:47:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=linaro.org; s=google; t=1744116449; x=1744721249; darn=lists.linaro.org;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:from:to:cc:subject:date
         :message-id:reply-to;
        bh=9zsV4NSDGfF9NfL6GoAOSh4jtNrxcTH/u03HhqixjCw=;
        b=Gvj+2FaEUczYWNLMKGhGqW+r2YAi9+xOUTCaxepJB7Mi6Nil3XW6TthdXBTeexJKwT
         H+LdccVzlaSyRipXGbKAnB+TlEFLDa1ISWKh9ArQCSgzHZwobBOZvHG2iIxaGIqqGMzX
         eEVEnHfNowx9VhaANJ3GyL/KMLIqQYa46P9KrWkSAYpegDd8DtdFsbqbNiWYqXtN+kIM
         99EhcFMRum8ppFWakhaApWuOHnnxhxA2ntpzQgncKFEHG2GCbCP9I4iG/yZaFq6l9TER
         UWo0BusypD+L13zDd/R4njhQEB92ZHw2xHe+JSPN0YXE/eCs0dRZxURZzTf4cSj3YULB
         5sRw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1744116449; x=1744721249;
        h=content-transfer-encoding:cc:to:subject:message-id:date:from
         :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=9zsV4NSDGfF9NfL6GoAOSh4jtNrxcTH/u03HhqixjCw=;
        b=A3m40QwazE4VzNpIbk3rEYgCYVhZgZMVtu9LHbFx+3s5KJ7G69Pckc2sqFFfmAAsMH
         QS4W9ksVw6eS/+btnfkawi3zdN0vOucqrxIzAHA0HH5KXMUk+9eTF+8rSuReusbIHF4Z
         M6PTvhrxArMTUOKIbhAKFeTpXcbBLrzVNdXgXDL+KWz82WC2Y68iAwQVpKO9ebKMd2q3
         QK9gRc2mFoFTxWKdSfaA0xyoD8ZmLCbVRzsz4M/xEo9BbFoKC19Ct2TGlg0VOT5p15Au
         ElOvwRbsLKP2+HJy8Vk+AloJaOjWqvyy9MN4SZkr2Qh2p5+oqCVIzDpExHwfjxdYcFdC
         mUaA==
X-Forwarded-Encrypted: i=1; AJvYcCV4o82YyqiehET0CiGMVkTvwjDsIgJLQ0R0JMZKVD0X3/G7fofxZWamBY1nouzHDkW4n6oAYBhOs9IDzYFt@lists.linaro.org
X-Gm-Message-State: AOJu0Yz7srY7PKz55PZDOSCgnTBZcDFAy1DtnS589d6Hd/8kHobhOuDV
	ornR8873KIxzgLbzzMDg/R097EyylTwFvA9BKz+WBjsqhI9UXWsmJFlnmLX2FC/LVAH7yOCWgOj
	iFP1tvpqkNcX5ljSKB/+ILwIkibQcx23FeRQ9i5jh
X-Gm-Gg: ASbGncufBXTjexJ9r5Ypw50ijEZQP08y36Hw7RXNEAtgRfeYjKFJ4YB6N3OOJCFDuaT
	5jRG6kE7AYYZBztA7aDVKC176FlODBQP6VaWPzVCwuUVlU4/s7wH+Awqg6/cCOXFRzV8DXBSiQO
	MB2MX5jV5AWG4IRLvdClhcJ/k18Xc=
X-Google-Smtp-Source: AGHT+IGQ+InJjr9vRlHtScfgzWytv6bSiWjP8GM25jgquZnarl2NxfPknn1e644RQLcdKqN4hSXokRVTWoPVKAUVMRI=
X-Received: by 2002:a05:6871:4d16:b0:2cf:bc73:7bbb with SMTP id
 586e51a60fabf-2cfbc744d28mr4481022fac.25.1744116446842; Tue, 08 Apr 2025
 05:47:26 -0700 (PDT)
MIME-Version: 1.0
References: <20250327-qcom-tee-using-tee-ss-without-mem-obj-v3-0-7f457073282d@oss.qualcomm.com>
 <20250327-qcom-tee-using-tee-ss-without-mem-obj-v3-8-7f457073282d@oss.qualcomm.com>
In-Reply-To: <20250327-qcom-tee-using-tee-ss-without-mem-obj-v3-8-7f457073282d@oss.qualcomm.com>
From: Jens Wiklander <jens.wiklander@linaro.org>
Date: Tue, 8 Apr 2025 14:47:13 +0200
X-Gm-Features: ATxdqUHDeeKFT73TZQO09gxbe_rq4eS8MqGhAN0iJw2OER71cI-c_tIbaFpvxtU
Message-ID: <CAHUa44E7OT-v0Ui_fjWPSN+HL8dm1BLkF3K_GYe3Wp6zpFpN0Q@mail.gmail.com>
To: Amirreza Zarrabi <amirreza.zarrabi@oss.qualcomm.com>
X-Rspamd-Queue-Id: 6CFE940B40
X-Spamd-Bar: -----
X-Spamd-Result: default: False [-5.10 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	RBL_SENDERSCORE_REPUT_9(-1.00)[209.85.160.50:from];
	DMARC_POLICY_ALLOW(-0.50)[linaro.org,none];
	R_SPF_ALLOW(-0.20)[+ip4:209.85.128.0/17];
	R_DKIM_ALLOW(-0.20)[linaro.org:s=google];
	MIME_GOOD(-0.10)[text/plain];
	RWL_MAILSPIKE_GOOD(-0.10)[209.85.160.50:from];
	MIME_TRACE(0.00)[0:+];
	ARC_NA(0.00)[];
	RCVD_COUNT_ONE(0.00)[1];
	TO_DN_SOME(0.00)[];
	RCPT_COUNT_TWELVE(0.00)[17];
	ASN(0.00)[asn:15169, ipnet:209.85.128.0/17, country:US];
	NEURAL_HAM(-0.00)[-1.000];
	MISSING_XM_UA(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	FROM_HAS_DN(0.00)[];
	DWL_DNSWL_BLOCKED(0.00)[linaro.org:dkim];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	PREVIOUSLY_DELIVERED(0.00)[linaro-mm-sig@lists.linaro.org];
	DKIM_TRACE(0.00)[linaro.org:+]
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
Message-ID-Hash: HQOFZPA54MAO2N5U2BNKAWVSVVT4FKYQ
X-Message-ID-Hash: HQOFZPA54MAO2N5U2BNKAWVSVVT4FKYQ
X-MailFrom: jens.wiklander@linaro.org
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: Sumit Garg <sumit.garg@kernel.org>, Bjorn Andersson <andersson@kernel.org>, Konrad Dybcio <konradybcio@kernel.org>, Bartosz Golaszewski <bartosz.golaszewski@linaro.org>, Apurupa Pattapu <quic_apurupa@quicinc.com>, Kees Cook <kees@kernel.org>, "Gustavo A. R. Silva" <gustavoars@kernel.org>, Sumit Semwal <sumit.semwal@linaro.org>, =?UTF-8?Q?Christian_K=C3=B6nig?= <christian.koenig@amd.com>, linux-arm-msm@vger.kernel.org, op-tee@lists.trustedfirmware.org, linux-kernel@vger.kernel.org, linux-hardening@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org, linux-doc@vger.kernel.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] Re: [PATCH v3 08/11] tee: add Qualcomm TEE driver
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/HQOFZPA54MAO2N5U2BNKAWVSVVT4FKYQ/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

SGkgQW1pcnJlemEsDQoNCk9uIEZyaSwgTWFyIDI4LCAyMDI1IGF0IDM6NDjigK9BTSBBbWlycmV6
YSBaYXJyYWJpDQo8YW1pcnJlemEuemFycmFiaUBvc3MucXVhbGNvbW0uY29tPiB3cm90ZToNCj4N
Cj4gSW50cm9kdWNlIHFjb210ZWVfb2JqZWN0LCB3aGljaCByZXByZXNlbnRzIGFuIG9iamVjdCBp
biBib3RoIFFURUUgYW5kDQo+IHRoZSBrZXJuZWwuIFFURUUgY2xpZW50cyBjYW4gaW52b2tlIGFu
IGluc3RhbmNlIG9mIHFjb210ZWVfb2JqZWN0IHRvDQo+IGFjY2VzcyBRVEVFIHNlcnZpY2VzLiBJ
ZiB0aGlzIGludm9jYXRpb24gcHJvZHVjZXMgYSBuZXcgb2JqZWN0IGluIFFURUUsDQo+IGFuIGlu
c3RhbmNlIG9mIHFjb210ZWVfb2JqZWN0IHdpbGwgYmUgcmV0dXJuZWQuDQo+DQo+IFNpbWlsYXJs
eSwgUVRFRSBjYW4gcmVxdWVzdCBzZXJ2aWNlcyBmcm9tIHRoZSBrZXJuZWwgYnkgaXNzdWluZyBh
IGNhbGxiYWNrDQo+IHJlcXVlc3QsIHdoaWNoIGludm9rZXMgYW4gaW5zdGFuY2Ugb2YgcWNvbXRl
ZV9vYmplY3QgaW4gdGhlIGtlcm5lbC4NCj4gQW55IHN1YnN5c3RlbSB0aGF0IGV4cG9zZXMgYSBz
ZXJ2aWNlIHRvIFFURUUgc2hvdWxkIGFsbG9jYXRlIGFuZCBpbml0aWFsaXplDQo+IGFuIGluc3Rh
bmNlIG9mIHFjb210ZWVfb2JqZWN0IHdpdGggYSBkaXNwYXRjaGVyIGNhbGxiYWNrIHRoYXQgaXMg
Y2FsbGVkDQo+IHdoZW4gdGhlIG9iamVjdCBpcyBpbnZva2VkLg0KPg0KPiBJbXBsZW1lbnQgaW5p
dGlhbCBzdXBwb3J0IGZvciBleHBvcnRpbmcgcWNvbXRlZV9vYmplY3QgdG8gdXNlcnNwYWNlDQo+
IGFuZCBRVEVFLCBlbmFibGluZyB0aGUgaW52b2NhdGlvbiBvZiBvYmplY3RzIGhvc3RlZCBpbiBR
VEVFIGFuZCB1c2Vyc3BhY2UNCj4gdGhyb3VnaCB0aGUgVEVFIHN1YnN5c3RlbS4NCj4NCj4gU2ln
bmVkLW9mZi1ieTogQW1pcnJlemEgWmFycmFiaSA8YW1pcnJlemEuemFycmFiaUBvc3MucXVhbGNv
bW0uY29tPg0KPiAtLS0NCj4gIGRyaXZlcnMvdGVlL0tjb25maWcgICAgICAgICAgICAgICAgICAg
IHwgICAxICsNCj4gIGRyaXZlcnMvdGVlL01ha2VmaWxlICAgICAgICAgICAgICAgICAgIHwgICAx
ICsNCj4gIGRyaXZlcnMvdGVlL3Fjb210ZWUvS2NvbmZpZyAgICAgICAgICAgIHwgIDEwICsNCj4g
IGRyaXZlcnMvdGVlL3Fjb210ZWUvTWFrZWZpbGUgICAgICAgICAgIHwgICA5ICsNCj4gIGRyaXZl
cnMvdGVlL3Fjb210ZWUvYXN5bmMuYyAgICAgICAgICAgIHwgMTYwICsrKysrKysNCj4gIGRyaXZl
cnMvdGVlL3Fjb210ZWUvY2FsbC5jICAgICAgICAgICAgIHwgNzUzICsrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysNCj4gIGRyaXZlcnMvdGVlL3Fjb210ZWUvY29yZS5jICAgICAgICAgICAg
IHwgODAxICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKw0KPiAgZHJpdmVycy90ZWUv
cWNvbXRlZS9xY29tX3NjbS5jICAgICAgICAgfCAgMzggKysNCj4gIGRyaXZlcnMvdGVlL3Fjb210
ZWUvcWNvbXRlZV9tc2cuaCAgICAgIHwgMjM5ICsrKysrKysrKysNCj4gIGRyaXZlcnMvdGVlL3Fj
b210ZWUvcWNvbXRlZV9wcml2YXRlLmggIHwgMjIyICsrKysrKysrKw0KPiAgZHJpdmVycy90ZWUv
cWNvbXRlZS9yZWxlYXNlLmMgICAgICAgICAgfCAgNDggKysNCj4gIGRyaXZlcnMvdGVlL3Fjb210
ZWUvc2htLmMgICAgICAgICAgICAgIHwgMTQ5ICsrKysrKw0KPiAgZHJpdmVycy90ZWUvcWNvbXRl
ZS91c2VyX29iai5jICAgICAgICAgfCA3MTAgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysN
Cj4gIGluY2x1ZGUvbGludXgvZmlybXdhcmUvcWNvbS9xY29tX3RlZS5oIHwgMzAyICsrKysrKysr
KysrKysNCj4gIGluY2x1ZGUvdWFwaS9saW51eC90ZWUuaCAgICAgICAgICAgICAgIHwgICAxICsN
Cj4gIDE1IGZpbGVzIGNoYW5nZWQsIDM0NDQgaW5zZXJ0aW9ucygrKQ0KPg0KPiBkaWZmIC0tZ2l0
IGEvZHJpdmVycy90ZWUvS2NvbmZpZyBiL2RyaXZlcnMvdGVlL0tjb25maWcNCj4gaW5kZXggNjFi
NTA3YzE4NzgwLi4zYTk5NWQ3ZjBkNzQgMTAwNjQ0DQo+IC0tLSBhL2RyaXZlcnMvdGVlL0tjb25m
aWcNCj4gKysrIGIvZHJpdmVycy90ZWUvS2NvbmZpZw0KPiBAQCAtMTYsNSArMTYsNiBAQCBpZiBU
RUUNCj4gIHNvdXJjZSAiZHJpdmVycy90ZWUvb3B0ZWUvS2NvbmZpZyINCj4gIHNvdXJjZSAiZHJp
dmVycy90ZWUvYW1kdGVlL0tjb25maWciDQo+ICBzb3VyY2UgImRyaXZlcnMvdGVlL3RzdGVlL0tj
b25maWciDQo+ICtzb3VyY2UgImRyaXZlcnMvdGVlL3Fjb210ZWUvS2NvbmZpZyINCj4NCj4gIGVu
ZGlmDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9NYWtlZmlsZSBiL2RyaXZlcnMvdGVlL01h
a2VmaWxlDQo+IGluZGV4IDU0ODhjYmEzMGJkMi4uNzRlOTg3ZjhmN2VhIDEwMDY0NA0KPiAtLS0g
YS9kcml2ZXJzL3RlZS9NYWtlZmlsZQ0KPiArKysgYi9kcml2ZXJzL3RlZS9NYWtlZmlsZQ0KPiBA
QCAtNiwzICs2LDQgQEAgdGVlLW9ianMgKz0gdGVlX3NobV9wb29sLm8NCj4gIG9iai0kKENPTkZJ
R19PUFRFRSkgKz0gb3B0ZWUvDQo+ICBvYmotJChDT05GSUdfQU1EVEVFKSArPSBhbWR0ZWUvDQo+
ICBvYmotJChDT05GSUdfQVJNX1RTVEVFKSArPSB0c3RlZS8NCj4gK29iai0kKENPTkZJR19RQ09N
VEVFKSArPSBxY29tdGVlLw0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS9LY29u
ZmlnIGIvZHJpdmVycy90ZWUvcWNvbXRlZS9LY29uZmlnDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0
DQo+IGluZGV4IDAwMDAwMDAwMDAwMC4uZDE4MGE2ZDA3ZDMzDQo+IC0tLSAvZGV2L251bGwNCj4g
KysrIGIvZHJpdmVycy90ZWUvcWNvbXRlZS9LY29uZmlnDQo+IEBAIC0wLDAgKzEsMTAgQEANCj4g
KyMgU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seQ0KPiArIyBRdWFsY29tbSBU
cnVzdGVkIEV4ZWN1dGlvbiBFbnZpcm9ubWVudCBDb25maWd1cmF0aW9uDQo+ICtjb25maWcgUUNP
TVRFRQ0KPiArICAgICAgIHRyaXN0YXRlICJRdWFsY29tbSBURUUgU3VwcG9ydCINCj4gKyAgICAg
ICBzZWxlY3QgUUNPTV9TQ00NCj4gKyAgICAgICBoZWxwDQo+ICsgICAgICAgICBUaGlzIG9wdGlv
biBlbmFibGVzIHRoZSBRdWFsY29tbSBUcnVzdGVkIEV4ZWN1dGlvbiBFbnZpcm9ubWVudCAoUVRF
RSkNCj4gKyAgICAgICAgIGRyaXZlci4gSXQgcHJvdmlkZXMgYW4gQVBJIHRvIGFjY2VzcyBzZXJ2
aWNlcyBvZmZlcmVkIGJ5IFFURUUgYW5kIGFueQ0KPiArICAgICAgICAgbG9hZGVkIFRydXN0ZWQg
QXBwbGljYXRpb25zIChUQXMpLCBhcyB3ZWxsIGFzIGV4cG9ydGluZyBrZXJuZWwNCj4gKyAgICAg
ICAgIHNlcnZpY2VzIHRvIFFURUUuDQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9xY29tdGVl
L01ha2VmaWxlIGIvZHJpdmVycy90ZWUvcWNvbXRlZS9NYWtlZmlsZQ0KPiBuZXcgZmlsZSBtb2Rl
IDEwMDY0NA0KPiBpbmRleCAwMDAwMDAwMDAwMDAuLjFiMTRiOTQzZTVmNQ0KPiAtLS0gL2Rldi9u
dWxsDQo+ICsrKyBiL2RyaXZlcnMvdGVlL3Fjb210ZWUvTWFrZWZpbGUNCj4gQEAgLTAsMCArMSw5
IEBADQo+ICsjIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkNCj4gK29iai0k
KENPTkZJR19RQ09NVEVFKSArPSBxY29tdGVlLm8NCj4gK3Fjb210ZWUtb2JqcyArPSBhc3luYy5v
DQo+ICtxY29tdGVlLW9ianMgKz0gY2FsbC5vDQo+ICtxY29tdGVlLW9ianMgKz0gY29yZS5vDQo+
ICtxY29tdGVlLW9ianMgKz0gcWNvbV9zY20ubw0KPiArcWNvbXRlZS1vYmpzICs9IHJlbGVhc2Uu
bw0KPiArcWNvbXRlZS1vYmpzICs9IHNobS5vDQo+ICtxY29tdGVlLW9ianMgKz0gdXNlcl9vYmou
bw0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS9hc3luYy5jIGIvZHJpdmVycy90
ZWUvcWNvbXRlZS9hc3luYy5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGluZGV4IDAwMDAw
MDAwMDAwMC4uNGM4ODBjMzQ0MWEyDQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIvZHJpdmVycy90
ZWUvcWNvbXRlZS9hc3luYy5jDQo+IEBAIC0wLDAgKzEsMTYwIEBADQo+ICsvLyBTUERYLUxpY2Vu
c2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5DQo+ICsvKg0KPiArICogQ29weXJpZ2h0IChjKSAy
MDI0IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
DQo+ICsgKi8NCj4gKw0KPiArI2luY2x1ZGUgInFjb210ZWVfcHJpdmF0ZS5oIg0KPiArI2luY2x1
ZGUgInFjb210ZWVfbXNnLmgiDQo+ICsNCj4gKyNkZWZpbmUgUUNPTVRFRV9BU1lOQ19WRVJTSU9O
XzFfMCAweDAwMDEwMDAwVSAvKiBNYWo6IDB4MDAwMSwgTWluOiAweDAwMDAuICovDQo+ICsjZGVm
aW5lIFFDT01URUVfQVNZTkNfVkVSU0lPTl8xXzEgMHgwMDAxMDAwMVUgLyogTWFqOiAweDAwMDEs
IE1pbjogMHgwMDAxLiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX0FTWU5DX1ZFUlNJT05fMV8yIDB4
MDAwMTAwMDJVIC8qIE1hajogMHgwMDAxLCBNaW46IDB4MDAwMi4gKi8NCj4gKyNkZWZpbmUgUUNP
TVRFRV9BU1lOQ19WRVJTSU9OIFFDT01URUVfQVNZTkNfVkVSU0lPTl8xXzIgLyogQ3VycmVudCBW
ZXJzaW9uLiAqLw0KPiArDQo+ICsjZGVmaW5lIFFDT01URUVfQVNZTkNfVkVSU0lPTl9NQUpPUihu
KSB1cHBlcl8xNl9iaXRzKG4pDQo+ICsjZGVmaW5lIFFDT01URUVfQVNZTkNfVkVSU0lPTl9NSU5P
UihuKSBsb3dlcl8xNl9iaXRzKG4pDQo+ICsNCj4gKy8qKg0KPiArICogc3RydWN0IHFjb210ZWVf
YXN5bmNfbXNnX2hkciAtIEFzeW5jaHJvbm91cyBtZXNzYWdlIGhlYWRlciBmb3JtYXQuDQo+ICsg
KiBAdmVyc2lvbjogY3VycmVudCBhc3luYyBwcm90b2NvbCB2ZXJzaW9uIG9mIHRoZSByZW1vdGUg
ZW5kcG9pbnQuDQo+ICsgKiBAb3A6IGFzeW5jIG9wZXJhdGlvbi4NCj4gKyAqDQo+ICsgKiBAdmVy
c2lvbiBzcGVjaWZpZXMgdGhlIGVuZHBvaW50J3MgKFFURUUgb3IgZHJpdmVyKSBzdXBwb3J0ZWQg
YXN5bmMgcHJvdG9jb2wuDQo+ICsgKiBGb3IgZXhhbXBsZSwgaWYgUVRFRSBzZXRzIEB2ZXJzaW9u
IHRvICVRQ09NVEVFX0FTWU5DX1ZFUlNJT05fMV8xLCBRVEVFDQo+ICsgKiBoYW5kbGVzIG9wZXJh
dGlvbnMgc3VwcG9ydGVkIGluICVRQ09NVEVFX0FTWU5DX1ZFUlNJT05fMV8xIG9yDQo+ICsgKiAl
UUNPTVRFRV9BU1lOQ19WRVJTSU9OXzFfMC4gQG9wIGRldGVybWluZXMgdGhlIG1lc3NhZ2UgZm9y
bWF0Lg0KPiArICovDQo+ICtzdHJ1Y3QgcWNvbXRlZV9hc3luY19tc2dfaGRyIHsNCj4gKyAgICAg
ICB1MzIgdmVyc2lvbjsNCj4gKyAgICAgICB1MzIgb3A7DQo+ICt9Ow0KPiArDQo+ICsvKiBTaXpl
IG9mIGFuIGVtcHR5IGFzeW5jIG1lc3NhZ2UuICovDQo+ICsjZGVmaW5lIFFDT01URUVfQVNZTkNf
TVNHX1pFUk8gc2l6ZW9mKHN0cnVjdCBxY29tdGVlX2FzeW5jX21zZ19oZHIpDQo+ICsNCj4gKy8q
Kg0KPiArICogc3RydWN0IHFjb210ZWVfYXN5bmNfcmVsZWFzZV9tc2cgLSBSZWxlYXNlIGFzeW5j
aHJvbm91cyBtZXNzYWdlLg0KPiArICogQGhkcjogbWVzc2FnZSBoZWFkZXIgYXMgJnN0cnVjdCBx
Y29tdGVlX2FzeW5jX21zZ19oZHIuDQo+ICsgKiBAY291bnRzOiBudW1iZXIgb2Ygb2JqZWN0cyBp
biBAb2JqZWN0X2lkcy4NCj4gKyAqIEBvYmplY3RfaWRzOiBhcnJheSBvZiBvYmplY3QgSURzIHRo
YXQgc2hvdWxkIGJlIHJlbGVhc2VkLg0KPiArICoNCj4gKyAqIEF2YWlsYWJsZSBpbiBNYWogPSAw
eDAwMDEsIE1pbiA+PSAweDAwMDAuDQo+ICsgKi8NCj4gK3N0cnVjdCBxY29tdGVlX2FzeW5jX3Jl
bGVhc2VfbXNnIHsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9hc3luY19tc2dfaGRyIGhkcjsN
Cj4gKyAgICAgICB1MzIgY291bnRzOw0KPiArICAgICAgIHUzMiBvYmplY3RfaWRzW10gX19jb3Vu
dGVkX2J5KGNvdW50cyk7DQo+ICt9Ow0KPiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfZ2V0X2Fz
eW5jX2J1ZmZlcigpIC0gR2V0IHRoZSBzdGFydCBvZiB0aGUgYXN5bmNocm9ub3VzIG1lc3NhZ2Uu
DQo+ICsgKiBAb2ljOiBjb250ZXh0IHVzZWQgZm9yIHRoZSBjdXJyZW50IGludm9jYXRpb24uDQo+
ICsgKiBAYXN5bmNfYnVmZmVyOiByZXR1cm4gYnVmZmVyIHRvIGV4dHJhY3QgZnJvbSBvciBmaWxs
IGluIGFzeW5jIG1lc3NhZ2VzLg0KPiArICoNCj4gKyAqIElmIEBvaWMgaXMgdXNlZCBmb3IgZGly
ZWN0IG9iamVjdCBpbnZvY2F0aW9uLCB0aGUgd2hvbGUgb3V0Ym91bmQgYnVmZmVyDQo+ICsgKiBp
cyBhdmFpbGFibGUgZm9yIHRoZSBhc3luYyBtZXNzYWdlLiBJZiBAb2ljIGlzIHVzZWQgZm9yIGEg
Y2FsbGJhY2sgcmVxdWVzdCwNCj4gKyAqIHRoZSB0YWlsIG9mIHRoZSBvdXRib3VuZCBidWZmZXIg
KGFmdGVyIHRoZSBjYWxsYmFjayByZXF1ZXN0IG1lc3NhZ2UpIGlzDQo+ICsgKiBhdmFpbGFibGUg
Zm9yIHRoZSBhc3luYyBtZXNzYWdlLg0KPiArICoNCj4gKyAqIFRoZSBzdGFydCBvZiB0aGUgYXN5
bmMgYnVmZmVyIGlzIGFsaWduZWQsIHNlZSBxY29tdGVlX21zZ19vZmZzZXRfYWxpZ24oKS4NCj4g
KyAqLw0KPiArc3RhdGljIHZvaWQgcWNvbXRlZV9nZXRfYXN5bmNfYnVmZmVyKHN0cnVjdCBxY29t
dGVlX29iamVjdF9pbnZva2VfY3R4ICpvaWMsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9idWZmZXIgKmFzeW5jX2J1ZmZlcikNCj4gK3sNCj4g
KyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9tc2dfY2FsbGJhY2sgKm1zZzsNCj4gKyAgICAgICB1bnNp
Z25lZCBpbnQgb2Zmc2V0Ow0KPiArICAgICAgIGludCBpOw0KPiArDQo+ICsgICAgICAgaWYgKCEo
b2ljLT5mbGFncyAmIFFDT01URUVfT0lDX0ZMQUdfQlVTWSkpIHsNCj4gKyAgICAgICAgICAgICAg
IC8qIFRoZSBvdXRib3VuZCBidWZmZXIgaXMgZW1wdHkuIFVzaW5nIHRoZSB3aG9sZSBidWZmZXIu
ICovDQo+ICsgICAgICAgICAgICAgICBvZmZzZXQgPSAwOw0KPiArICAgICAgIH0gZWxzZSB7DQo+
ICsgICAgICAgICAgICAgICBtc2cgPSAoc3RydWN0IHFjb210ZWVfbXNnX2NhbGxiYWNrICopb2lj
LT5vdXRfbXNnLmFkZHI7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIC8qIFN0YXJ0IG9mZnNldCBp
biBhIG1lc3NhZ2UgZm9yIGJ1ZmZlciBhcmd1bWVudHMuICovDQo+ICsgICAgICAgICAgICAgICBv
ZmZzZXQgPSBxY29tdGVlX21zZ19idWZmZXJfYXJncyhzdHJ1Y3QgcWNvbXRlZV9tc2dfY2FsbGJh
Y2ssDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBx
Y29tdGVlX21zZ19hcmdzKG1zZykpOw0KPiArDQo+ICsgICAgICAgICAgICAgICAvKiBBZGQgc2l6
ZSBvZiBJQiBhcmd1bWVudHMuICovDQo+ICsgICAgICAgICAgICAgICBxY29tdGVlX21zZ19mb3Jf
ZWFjaF9pbnB1dF9idWZmZXIoaSwgbXNnKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBvZmZz
ZXQgKz0gcWNvbXRlZV9tc2dfb2Zmc2V0X2FsaWduKG1zZy0+YXJnc1tpXS5iLnNpemUpOw0KPiAr
DQo+ICsgICAgICAgICAgICAgICAvKiBBZGQgc2l6ZSBvZiBPQiBhcmd1bWVudHMuICovDQo+ICsg
ICAgICAgICAgICAgICBxY29tdGVlX21zZ19mb3JfZWFjaF9vdXRwdXRfYnVmZmVyKGksIG1zZykN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IHFjb210ZWVfbXNnX29mZnNldF9h
bGlnbihtc2ctPmFyZ3NbaV0uYi5zaXplKTsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBh
c3luY19idWZmZXItPmFkZHIgPSBvaWMtPm91dF9tc2cuYWRkciArIG9mZnNldDsNCj4gKyAgICAg
ICBhc3luY19idWZmZXItPnNpemUgPSBvaWMtPm91dF9tc2cuc2l6ZSAtIG9mZnNldDsNCj4gK30N
Cj4gKw0KPiArLyoqDQo+ICsgKiBhc3luY19yZWxlYXNlKCkgLSBQcm9jZXNzIFFURUUgYXN5bmMg
cmVsZWFzZSByZXF1ZXN0cy4NCj4gKyAqIEBvaWM6IGNvbnRleHQgdXNlZCBmb3IgdGhlIGN1cnJl
bnQgaW52b2NhdGlvbi4NCj4gKyAqIEBtc2c6IGFzeW5jIG1lc3NhZ2UgZm9yIG9iamVjdCByZWxl
YXNlLg0KPiArICogQHNpemU6IHNpemUgb2YgdGhlIGFzeW5jIGJ1ZmZlciBhdmFpbGFibGUuDQo+
ICsgKg0KPiArICogUmV0dXJuOiBTaXplIG9mIHRoZSBvdXRib3VuZCBidWZmZXIgdXNlZCB3aGVu
IHByb2Nlc3NpbmcgQG1zZy4NCj4gKyAqLw0KPiArc3RhdGljIHNpemVfdCBhc3luY19yZWxlYXNl
KHN0cnVjdCBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4ICpvaWMsDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9hc3luY19tc2dfaGRyICphc3luY19tc2csDQo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplX3Qgc2l6ZSkNCj4gK3sNCj4gKyAgICAg
ICBzdHJ1Y3QgcWNvbXRlZV9hc3luY19yZWxlYXNlX21zZyAqbXNnOw0KPiArICAgICAgIHN0cnVj
dCBxY29tdGVlX29iamVjdCAqb2JqZWN0Ow0KPiArICAgICAgIGludCBpOw0KPiArDQo+ICsgICAg
ICAgbXNnID0gKHN0cnVjdCBxY29tdGVlX2FzeW5jX3JlbGVhc2VfbXNnICopYXN5bmNfbXNnOw0K
PiArDQo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IG1zZy0+Y291bnRzOyBpKyspIHsNCj4gKyAg
ICAgICAgICAgICAgIG9iamVjdCA9IHFjb210ZWVfaWR4X2VyYXNlKG1zZy0+b2JqZWN0X2lkc1tp
XSk7DQo+ICsgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQob2JqZWN0KTsNCj4gKyAg
ICAgICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gc3RydWN0X3NpemUobXNnLCBvYmplY3RfaWRz
LCBtc2ctPmNvdW50cyk7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogcWNvbXRlZV9mZXRjaF9h
c3luY19yZXFzKCkgLSBGZXRjaCBhbmQgcHJvY2VzcyBhc3luY2hyb25vdXMgbWVzc2FnZXMuDQo+
ICsgKiBAb2ljOiBjb250ZXh0IHVzZWQgZm9yIHRoZSBjdXJyZW50IGludm9jYXRpb24uDQo+ICsg
Kg0KPiArICogQ2FsbHMgaGFuZGxlcnMgdG8gcHJvY2VzcyB0aGUgcmVxdWVzdGVkIG9wZXJhdGlv
bnMgaW4gdGhlIGFzeW5jIG1lc3NhZ2UuDQo+ICsgKiBDdXJyZW50bHksIG9ubHkgc3VwcG9ydHMg
YXN5bmMgcmVsZWFzZSByZXF1ZXN0cy4NCj4gKyAqLw0KPiArdm9pZCBxY29tdGVlX2ZldGNoX2Fz
eW5jX3JlcXMoc3RydWN0IHFjb210ZWVfb2JqZWN0X2ludm9rZV9jdHggKm9pYykNCj4gK3sNCj4g
KyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9hc3luY19tc2dfaGRyICphc3luY19tc2c7DQo+ICsgICAg
ICAgc3RydWN0IHFjb210ZWVfYnVmZmVyIGFzeW5jX2J1ZmZlcjsNCj4gKyAgICAgICBzaXplX3Qg
Y29uc3VtZWQsIHVzZWQgPSAwOw0KPiArDQo+ICsgICAgICAgcWNvbXRlZV9nZXRfYXN5bmNfYnVm
ZmVyKG9pYywgJmFzeW5jX2J1ZmZlcik7DQo+ICsNCj4gKyAgICAgICB3aGlsZSAoYXN5bmNfYnVm
ZmVyLnNpemUgLSB1c2VkID4gUUNPTVRFRV9BU1lOQ19NU0dfWkVSTykgew0KPiArICAgICAgICAg
ICAgICAgYXN5bmNfbXNnID0gKHN0cnVjdCBxY29tdGVlX2FzeW5jX21zZ19oZHIgKikoYXN5bmNf
YnVmZmVyLmFkZHIgKw0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgdXNlZCk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIGlmIChR
Q09NVEVFX0FTWU5DX1ZFUlNJT05fTUFKT1IoYXN5bmNfbXNnLT52ZXJzaW9uKSAhPQ0KPiArICAg
ICAgICAgICAgICAgICAgIFFDT01URUVfQVNZTkNfVkVSU0lPTl9NQUpPUihRQ09NVEVFX0FTWU5D
X1ZFUlNJT04pKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gKw0KPiAr
ICAgICAgICAgICAgICAgc3dpdGNoIChhc3luY19tc2ctPm9wKSB7DQo+ICsgICAgICAgICAgICAg
ICBjYXNlIFFDT01URUVfTVNHX09CSkVDVF9PUF9SRUxFQVNFOg0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBjb25zdW1lZCA9IGFzeW5jX3JlbGVhc2Uob2ljLCBhc3luY19tc2csDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc3luY19idWZmZXIu
c2l6ZSAtIHVzZWQpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAg
ICAgICAgICAgIGRlZmF1bHQ6DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0K
PiArICAgICAgICAgICAgICAgfQ0KPiArDQo+ICsgICAgICAgICAgICAgICAvKiBTdXBwb3J0ZWQg
b3BlcmF0aW9uIGJ1dCB1bmFibGUgdG8gcGFyc2UgdGhlIG1lc3NhZ2UuICovDQo+ICsgICAgICAg
ICAgICAgICBpZiAoIWNvbnN1bWVkKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91
dDsNCj4gKw0KPiArICAgICAgICAgICAgICAgLyogTmV4dCBhc3luYyBtZXNzYWdlLiAqLw0KPiAr
ICAgICAgICAgICAgICAgdXNlZCArPSBxY29tdGVlX21zZ19vZmZzZXRfYWxpZ24oY29uc3VtZWQp
Ow0KPiArICAgICAgIH0NCj4gKw0KPiArb3V0Og0KPiArICAgICAgIC8qIFJlc2V0IHRoZSBhc3lu
YyBidWZmZXIgc28gYXN5bmMgcmVxdWVzdHMgZG8gbm90IGxvb3AgdG8gUVRFRS4gKi8NCj4gKyAg
ICAgICBtZW16ZXJvX2V4cGxpY2l0KGFzeW5jX2J1ZmZlci5hZGRyLCBhc3luY19idWZmZXIuc2l6
ZSk7DQo+ICt9DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9xY29tdGVlL2NhbGwuYyBiL2Ry
aXZlcnMvdGVlL3Fjb210ZWUvY2FsbC5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGluZGV4
IDAwMDAwMDAwMDAwMC4uZjdmNWMyYzBiZWJiDQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIvZHJp
dmVycy90ZWUvcWNvbXRlZS9jYWxsLmMNCj4gQEAgLTAsMCArMSw3NTMgQEANCj4gKy8vIFNQRFgt
TGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkNCj4gKy8qDQo+ICsgKiBDb3B5cmlnaHQg
KGMpIDIwMjQgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIHJpZ2h0cyByZXNl
cnZlZC4NCj4gKyAqLw0KPiArDQo+ICsjZGVmaW5lIHByX2ZtdChmbXQpIEtCVUlMRF9NT0ROQU1F
ICI6ICIgZm10DQo+ICsNCj4gKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+DQo+ICsjaW5jbHVkZSA8
bGludXgvdGVlLmg+DQo+ICsjaW5jbHVkZSA8bGludXgvcGxhdGZvcm1fZGV2aWNlLmg+DQo+ICsN
Cj4gKyNpbmNsdWRlICJxY29tdGVlX3ByaXZhdGUuaCINCj4gKw0KPiArc3RhdGljIGludCBmaW5k
X3F0ZWVfb2JqZWN0KHN0cnVjdCBxY29tdGVlX29iamVjdCAqKm9iamVjdCwgdW5zaWduZWQgbG9u
ZyBpZCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBxY29tdGVlX2NvbnRl
eHRfZGF0YSAqY3R4ZGF0YSkNCj4gK3sNCj4gKyAgICAgICBpbnQgZXJyID0gMDsNCj4gKw0KPiAr
ICAgICAgIGd1YXJkKHJjdSkoKTsNCg0KRG9lcyB0aGUgcWNvbXRlZV9vYmplY3RfZ2V0KCkgY2Fs
bCBuZWVkIHRvIGJlIFJDVSBwcm90ZWN0ZWQ/DQoNCj4gKyAgICAgICAvKiBPYmplY3QgcmVsZWFz
ZSBpcyBSQ1UgcHJvdGVjdGVkLiAqLw0KPiArICAgICAgICpvYmplY3QgPSBpZHJfZmluZCgmY3R4
ZGF0YS0+cXRlZV9vYmplY3RzX2lkciwgaWQpOw0KPiArICAgICAgIGlmICghcWNvbXRlZV9vYmpl
Y3RfZ2V0KCpvYmplY3QpKQ0KPiArICAgICAgICAgICAgICAgZXJyID0gLUVJTlZBTDsNCj4gKw0K
PiArICAgICAgIHJldHVybiBlcnI7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIGRlbF9xdGVl
X29iamVjdCh1bnNpZ25lZCBsb25nIGlkLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IHFjb210ZWVfY29udGV4dF9kYXRhICpjdHhkYXRhKQ0KPiArew0KPiArICAgICAgIHN0
cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0Ow0KPiArDQo+ICsgICAgICAgc2NvcGVkX2d1YXJk
KHNwaW5sb2NrLCAmY3R4ZGF0YS0+cXRlZV9sb2NrKQ0KPiArICAgICAgICAgICAgICAgb2JqZWN0
ID0gaWRyX3JlbW92ZSgmY3R4ZGF0YS0+cXRlZV9vYmplY3RzX2lkciwgaWQpOw0KPiArDQo+ICsg
ICAgICAgcWNvbXRlZV9vYmplY3RfcHV0KG9iamVjdCk7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiAr
ICogcWNvbXRlZV9jb250ZXh0X2FkZF9xdGVlX29iamVjdCgpIC0gQWRkIGEgUVRFRSBvYmplY3Qg
dG8gdGhlIGNvbnRleHQuDQo+ICsgKiBAcGFyYW06IFRFRSBwYXJhbWV0ZXIgcmVwcmVzZW50aW5n
IEBvYmplY3QuDQo+ICsgKiBAb2JqZWN0OiBRVEVFIG9iamVjdC4NCj4gKyAqIEBjdHg6IGNvbnRl
eHQgdG8gYWRkIHRoZSBvYmplY3QuDQo+ICsgKg0KPiArICogSXQgYXNzdW1lcyBAb2JqZWN0IGlz
ICVRQ09NVEVFX09CSkVDVF9UWVBFX1RFRSBhbmQgdGhlIGNhbGxlciBoYXMgYWxyZWFkeQ0KPiAr
ICogaXNzdWVkIHFjb210ZWVfb2JqZWN0X2dldCgpIGZvciBAb2JqZWN0Lg0KPiArICoNCj4gKyAq
IFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4N
Cj4gKyAqLw0KPiAraW50IHFjb210ZWVfY29udGV4dF9hZGRfcXRlZV9vYmplY3Qoc3RydWN0IHRl
ZV9wYXJhbSAqcGFyYW0sDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCkNCj4gK3sNCj4gKyAgICAgICBpbnQg
cmV0Ow0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX2NvbnRleHRfZGF0YSAqY3R4ZGF0YSA9IGN0
eC0+ZGF0YTsNCj4gKw0KPiArICAgICAgIGd1YXJkKHNwaW5sb2NrKSgmY3R4ZGF0YS0+cXRlZV9s
b2NrKTsNCj4gKyAgICAgICByZXQgPSBpZHJfYWxsb2MoJmN0eGRhdGEtPnF0ZWVfb2JqZWN0c19p
ZHIsIG9iamVjdCwgMCwgMCwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgaWYgKHJldCA8IDApDQo+
ICsgICAgICAgICAgICAgICByZXR1cm4gcmV0Ow0KPiArDQoNCklzIHRoZSBzcGlubG9jayBuZWVk
ZWQgd2hlbiB1cGRhdGluZyBwYXJhbSBiZWxvdz8NCg0KPiArICAgICAgIHBhcmFtLT51Lm9ianJl
Zi5pZCA9IHJldDsNCj4gKyAgICAgICAvKiBRVEVFIE9iamVjdDogUUNPTVRFRV9PQkpSRUZfRkxB
R19URUUgc2V0LiAqLw0KPiArICAgICAgIHBhcmFtLT51Lm9ianJlZi5mbGFncyA9IFFDT01URUVf
T0JKUkVGX0ZMQUdfVEVFOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4g
Ky8qIFJldHJpZXZlIHRoZSBRVEVFIG9iamVjdCBhZGRlZCB3aXRoIHFjb210ZWVfY29udGV4dF9h
ZGRfcXRlZV9vYmplY3QoKS4gKi8NCj4gK2ludCBxY29tdGVlX2NvbnRleHRfZmluZF9xdGVlX29i
amVjdChzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKipvYmplY3QsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4KQ0KPiAr
ew0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX2NvbnRleHRfZGF0YSAqY3R4ZGF0YSA9IGN0eC0+
ZGF0YTsNCj4gKw0KPiArICAgICAgIC8qICdxdGVlX29iamVjdHNfaWRyJyBzdG9yZXMgUVRFRSBv
YmplY3RzIG9ubHkuICovDQo+ICsgICAgICAgaWYgKCEocGFyYW0tPnUub2JqcmVmLmZsYWdzICYg
UUNPTVRFRV9PQkpSRUZfRkxBR19URUUpKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5W
QUw7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gZmluZF9xdGVlX29iamVjdChvYmplY3QsIHBhcmFt
LT51Lm9ianJlZi5pZCwgY3R4ZGF0YSk7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogcWNvbXRl
ZV9jb250ZXh0X2RlbF9xdGVlX29iamVjdCgpIC0gRGVsZXRlIGEgUVRFRSBvYmplY3QgZnJvbSB0
aGUgY29udGV4dC4NCj4gKyAqIEBwYXJhbTogVEVFIHBhcmFtZXRlciByZXByZXNlbnRpbmcgQG9i
amVjdC4NCj4gKyAqIEBjdHg6IGNvbnRleHQgZm9yIGRlbGV0aW5nIHRoZSBvYmplY3QuDQo+ICsg
Kg0KPiArICogVGhlIEBwYXJhbSBoYXMgYmVlbiBpbml0aWFsaXplZCBieSBxY29tdGVlX2NvbnRl
eHRfYWRkX3F0ZWVfb2JqZWN0KCkuDQo+ICsgKi8NCj4gK3ZvaWQgcWNvbXRlZV9jb250ZXh0X2Rl
bF9xdGVlX29iamVjdChzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4KQ0KPiArew0KPiAr
ICAgICAgIHN0cnVjdCBxY29tdGVlX2NvbnRleHRfZGF0YSAqY3R4ZGF0YSA9IGN0eC0+ZGF0YTsN
Cj4gKw0KPiArICAgICAgIC8qICdxdGVlX29iamVjdHNfaWRyJyBzdG9yZXMgUVRFRSBvYmplY3Rz
IG9ubHkuICovDQo+ICsgICAgICAgaWYgKHBhcmFtLT51Lm9ianJlZi5mbGFncyAmIFFDT01URUVf
T0JKUkVGX0ZMQUdfVEVFKQ0KPiArICAgICAgICAgICAgICAgZGVsX3F0ZWVfb2JqZWN0KHBhcmFt
LT51Lm9ianJlZi5pZCwgY3R4ZGF0YSk7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogcWNvbXRl
ZV9vYmpyZWZfdG9fYXJnKCkgLSBDb252ZXJ0IE9CSlJFRiBwYXJhbWV0ZXIgdG8gUVRFRSBhcmd1
bWVudC4NCj4gKyAqIEBhcmc6IFFURUUgYXJndW1lbnQuDQo+ICsgKiBAcGFyYW06IFRFRSBwYXJh
bWV0ZXIuDQo+ICsgKiBAY3R4OiBjb250ZXh0IGluIHdoaWNoIHRoZSBjb252ZXJzaW9uIHNob3Vs
ZCBoYXBwZW4uDQo+ICsgKg0KPiArICogSXQgYXNzdW1lcyBAcGFyYW0gaXMgYW4gT0JKUkVGLg0K
PiArICogSXQgZG9lcyBub3Qgc2V0IEBhcmcudHlwZTsgdGhlIGNhbGxlciBzaG91bGQgaW5pdGlh
bGl6ZSBpdCB0byBhIGNvcnJlY3QNCj4gKyAqICZlbnVtIHFjb210ZWVfYXJnX3R5cGUgdmFsdWUu
IEl0IGdldHMgdGhlIG9iamVjdCdzIHJlZmNvdW50IGluIEBhcmc7DQo+ICsgKiB0aGUgY2FsbGVy
IHNob3VsZCBtYW5hZ2UgdG8gcHV0IGl0IGFmdGVyd2FyZC4NCj4gKyAqDQo+ICsgKiBGb3Igb2Jq
ZWN0cyB0aGF0IGFyZSBub3QgaW4gUVRFRSAoaS5lLiAhKHBhcmFtLT51Lm9ianJlZi5mbGFncyAm
DQo+ICsgKiBRQ09NVEVFX09CSlJFRl9GTEFHX1RFRSkpLCBpdCBhbHNvIGNhbGxzIHFjb210ZWVf
b2JqZWN0X2dldCgpIHRvIGtlZXAgYQ0KPiArICogdGVtcG9yYXJ5IGNvcHkgZm9yIHRoZSBkcml2
ZXIgYXMgdGhlIHJlbGVhc2Ugb2YgdGhlbSBhcmUgYXN5bmNocm9ub3VzIGFuZA0KPiArICogbWF5
IGdvIGF3YXkgZXZlbiBiZWZvcmUgcmV0dXJuaW5nIGZyb20gdGhlIGludm9jYXRpb24uDQo+ICsg
Kg0KPiArICogUmV0dXJuOiBPbiBzdWNjZXNzLCByZXR1cm5zIDA7IG9uIGZhaWx1cmUsIHJldHVy
bnMgPCAwLg0KPiArICovDQo+ICtpbnQgcWNvbXRlZV9vYmpyZWZfdG9fYXJnKHN0cnVjdCBxY29t
dGVlX2FyZyAqYXJnLCBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCkNCj4gK3sNCj4gKyAgICAgICBzdHJ1
Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdDsNCj4gKyAgICAgICBpbnQgZXJyOw0KPiArDQo+ICsg
ICAgICAgLyogcGFyYW0gaXMgYSBOVUxMIG9iamVjdDogKi8NCj4gKyAgICAgICBpZiAocGFyYW0t
PnUub2JqcmVmLmlkID09IFRFRV9PQkpSRUZfTlVMTCkgew0KPiArICAgICAgICAgICAgICAgYXJn
LT5vID0gTlVMTF9RQ09NVEVFX09CSkVDVDsNCj4gKw0KPiArICAgICAgICAgICAgICAgcmV0dXJu
IDA7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgLyogcGFyYW0gaXMgYSBjYWxsYmFjayBv
YmplY3Q6ICovDQo+ICsgICAgICAgaWYgKHBhcmFtLT51Lm9ianJlZi5mbGFncyAmIFFDT01URUVf
T0JKUkVGX0ZMQUdfVVNFUikgew0KPiArICAgICAgICAgICAgICAgZXJyID0gcWNvbXRlZV91c2Vy
X3BhcmFtX3RvX29iamVjdCgmb2JqZWN0LCBwYXJhbSwgY3R4KTsNCg0KSG93IGFib3V0IGEgcWNv
bXRlZV9nZXRfb2JqZWN0X2Zyb21fdXNlcl9wYXJhbSgpIHRoYXQgYWxyZWFkeSBoYXMNCmluY3Jl
YXNlZCB0aGUgcmVmY291bnQ/IFRoYXQgc2hvdWxkIGJhbGFuY2UgYmV0dGVyIHdpdGgNCnFjb210
ZWVfY29udGV4dF9maW5kX3F0ZWVfb2JqZWN0KCkuDQoNCj4gKyAgICAgICAgICAgICAgIGlmICgh
ZXJyKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9nZXQob2JqZWN0
KTsNCj4gKyAgICAgICAvKiBwYXJhbSBpcyBhIFFURUUgb2JqZWN0OiAqLw0KPiArICAgICAgIH0g
ZWxzZSBpZiAocGFyYW0tPnUub2JqcmVmLmZsYWdzICYgUUNPTVRFRV9PQkpSRUZfRkxBR19URUUp
IHsNCj4gKyAgICAgICAgICAgICAgIGVyciA9IHFjb210ZWVfY29udGV4dF9maW5kX3F0ZWVfb2Jq
ZWN0KCZvYmplY3QsIHBhcmFtLCBjdHgpOw0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAg
ICAgICAgICBlcnIgPSAtRUlOVkFMOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIGFyZy0+
byA9IGVyciA/IE5VTExfUUNPTVRFRV9PQkpFQ1QgOiBvYmplY3Q7DQoNCkkgcHJlZmVyIGFuIGlm
IHN0YXRlbWVudCBoZXJlIGluc3RlYWQgb2YgdGhlIHRlcm5hcnkgb3BlcmF0b3INCg0KPiArDQo+
ICsgICAgICAgcmV0dXJuIGVycjsNCj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX29i
anJlZl9mcm9tX2FyZygpIC0gQ29udmVydCBRVEVFIGFyZ3VtZW50IHRvIE9CSlJFRiBwYXJhbS4N
Cj4gKyAqIEBwYXJhbTogVEVFIHBhcmFtZXRlci4NCj4gKyAqIEBhcmc6IFFURUUgYXJndW1lbnQu
DQo+ICsgKiBAY3R4OiBjb250ZXh0IGluIHdoaWNoIHRoZSBjb252ZXJzaW9uIHNob3VsZCBoYXBw
ZW4uDQo+ICsgKg0KPiArICogSXQgYXNzdW1lcyBAYXJnIGlzIG9mICVRQ09NVEVFX0FSR19UWVBF
X0lPIG9yICVRQ09NVEVFX0FSR19UWVBFX09PLg0KPiArICogSXQgZG9lcyBub3Qgc2V0IEBwYXJh
bS5hdHRyOyB0aGUgY2FsbGVyIHNob3VsZCBpbml0aWFsaXplIGl0IHRvIGENCj4gKyAqIGNvcnJl
Y3QgdHlwZS4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMDsgb24g
ZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK2ludCBxY29tdGVlX29ianJlZl9mcm9t
X2FyZyhzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwgc3RydWN0IHFjb210ZWVfYXJnICphcmcsDQo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCkNCj4g
K3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdDsNCj4gKyAgICAgICBp
bnQgZXJyOw0KPiArDQo+ICsgICAgICAgLyogcGFyYW0gc2hvdWxkIGJlIG9mIE9CSlJFRi4gKi8N
Cj4gKyAgICAgICBpZiAocGFyYW0tPmF0dHIgIT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9P
QkpSRUZfSU5QVVQgJiYNCj4gKyAgICAgICAgICAgcGFyYW0tPmF0dHIgIT0gVEVFX0lPQ1RMX1BB
UkFNX0FUVFJfVFlQRV9PQkpSRUZfT1VUUFVUICYmDQo+ICsgICAgICAgICAgIHBhcmFtLT5hdHRy
ICE9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfT0JKUkVGX0lOT1VUKQ0KPiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKyAgICAgICBvYmplY3QgPSBhcmctPm87DQo+
ICsNCj4gKyAgICAgICBzd2l0Y2ggKHR5cGVvZl9xY29tdGVlX29iamVjdChvYmplY3QpKSB7DQo+
ICsgICAgICAgY2FzZSBRQ09NVEVFX09CSkVDVF9UWVBFX05VTEw6DQo+ICsgICAgICAgICAgICAg
ICBwYXJhbS0+dS5vYmpyZWYuaWQgPSBURUVfT0JKUkVGX05VTEw7DQo+ICsgICAgICAgICAgICAg
ICBlcnIgPSAwOw0KPiArDQo+ICsgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAgICBjYXNl
IFFDT01URUVfT0JKRUNUX1RZUEVfQ0I6DQo+ICsgICAgICAgICAgICAgICBpZiAoaXNfcWNvbXRl
ZV91c2VyX29iamVjdChvYmplY3QpKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBlcnIgPSBx
Y29tdGVlX3VzZXJfcGFyYW1fZnJvbV9vYmplY3QocGFyYW0sIG9iamVjdCwNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0eCk7
DQo+ICsgICAgICAgICAgICAgICBlbHNlDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVyciA9
IC1FSU5WQUw7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgIGNhc2Ug
UUNPTVRFRV9PQkpFQ1RfVFlQRV9URUU6DQo+ICsgICAgICAgICAgICAgICBlcnIgPSBxY29tdGVl
X2NvbnRleHRfYWRkX3F0ZWVfb2JqZWN0KHBhcmFtLCBvYmplY3QsIGN0eCk7DQo+ICsNCj4gKyAg
ICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgIGNhc2UgUUNPTVRFRV9PQkpFQ1RfVFlQRV9S
T09UOg0KPiArICAgICAgIGRlZmF1bHQ6DQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZB
TDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gZXJyOw0KPiArfQ0KPiArDQo+
ICsvKioNCj4gKyAqIHFjb210ZWVfcGFyYW1zX3RvX2FyZ3MoKSAtIENvbnZlcnQgVEVFIHBhcmFt
ZXRlcnMgdG8gUVRFRSBhcmd1bWVudHMuDQo+ICsgKiBAdTogUVRFRSBhcmd1bWVudHMuDQo+ICsg
KiBAcGFyYW1zOiBURUUgcGFyYW1ldGVycy4NCj4gKyAqIEBudW1fcGFyYW1zOiBudW1iZXIgb2Yg
ZWxlbWVudHMgaW4gdGhlIHBhcmFtZXRlciBhcnJheS4NCj4gKyAqIEBjdHg6IGNvbnRleHQgaW4g
d2hpY2ggdGhlIGNvbnZlcnNpb24gc2hvdWxkIGhhcHBlbi4NCj4gKyAqDQo+ICsgKiBJdCBhc3N1
bWVzIEB1IGhhcyBhdCBsZWFzdCBAbnVtX3BhcmFtcyArIDEgZW50cmllcyBhbmQgaGFzIGJlZW4g
aW5pdGlhbGl6ZWQNCj4gKyAqIHdpdGggJVFDT01URUVfQVJHX1RZUEVfSU5WIGFzICZzdHJ1Y3Qg
cWNvbXRlZV9hcmcudHlwZS4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVy
bnMgMDsgb24gZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgcWNv
bXRlZV9wYXJhbXNfdG9fYXJncyhzdHJ1Y3QgcWNvbXRlZV9hcmcgKnUsDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbXMsIGludCBudW1f
cGFyYW1zLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHRlZV9j
b250ZXh0ICpjdHgpDQo+ICt7DQo+ICsgICAgICAgaW50IGk7DQo+ICsNCj4gKyAgICAgICBmb3Ig
KGkgPSAwOyBpIDwgbnVtX3BhcmFtczsgaSsrKSB7DQo+ICsgICAgICAgICAgICAgICBzd2l0Y2gg
KHBhcmFtc1tpXS5hdHRyKSB7DQo+ICsgICAgICAgICAgICAgICBjYXNlIFRFRV9JT0NUTF9QQVJB
TV9BVFRSX1RZUEVfVUJVRl9JTlBVVDoNCj4gKyAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RM
X1BBUkFNX0FUVFJfVFlQRV9VQlVGX09VVFBVVDoNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
dVtpXS5mbGFncyA9IFFDT01URUVfQVJHX0ZMQUdTX1VBRERSOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICB1W2ldLmIudWFkZHIgPSBwYXJhbXNbaV0udS51YnVmLnVhZGRyOw0KPiArICAgICAg
ICAgICAgICAgICAgICAgICB1W2ldLmIuc2l6ZSA9IHBhcmFtc1tpXS51LnVidWYuc2l6ZTsNCj4g
Kw0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zW2ldLmF0dHIgPT0NCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVUJVRl9J
TlBVVCkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1W2ldLnR5cGUgPSBRQ09N
VEVFX0FSR19UWVBFX0lCOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBlbHNlIC8qIFRFRV9J
T0NUTF9QQVJBTV9BVFRSX1RZUEVfVUJVRl9PVVRQVVQgKi8NCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB1W2ldLnR5cGUgPSBRQ09NVEVFX0FSR19UWVBFX09COw0KPiArDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgY2FzZSBURUVf
SU9DVExfUEFSQU1fQVRUUl9UWVBFX09CSlJFRl9JTlBVVDoNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgdVtpXS50eXBlID0gUUNPTVRFRV9BUkdfVFlQRV9JTzsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgaWYgKHFjb210ZWVfb2JqcmVmX3RvX2FyZygmdVtpXSwgJnBhcmFtc1tpXSwgY3R4
KSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9mYWlsZWQ7DQo+
ICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgICAgICAgICBj
YXNlIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfT0JKUkVGX09VVFBVVDoNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgdVtpXS50eXBlID0gUUNPTVRFRV9BUkdfVFlQRV9PTzsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgdVtpXS5vID0gTlVMTF9RQ09NVEVFX09CSkVDVDsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgICAgICAgICBkZWZhdWx0Og0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9mYWlsZWQ7DQo+ICsgICAgICAgICAgICAg
ICB9DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcmV0dXJuIDA7DQo+ICsNCj4gK291dF9m
YWlsZWQ6DQo+ICsgICAgICAgLyogVW5kbyBxY29tdGVlX29ianJlZl90b19hcmcoKS4gKi8NCj4g
KyAgICAgICBmb3IgKGktLTsgaSA+PSAwOyBpLS0pIHsNCj4gKyAgICAgICAgICAgICAgIGlmICh1
W2ldLnR5cGUgIT0gUUNPTVRFRV9BUkdfVFlQRV9JTykNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgY29udGludWU7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIHFjb210ZWVfdXNlcl9vYmplY3Rf
c2V0X25vdGlmeSh1W2ldLm8sIGZhbHNlKTsNCj4gKyAgICAgICAgICAgICAgIGlmICh0eXBlb2Zf
cWNvbXRlZV9vYmplY3QodVtpXS5vKSA9PSBRQ09NVEVFX09CSkVDVF9UWVBFX0NCKQ0KPiArICAg
ICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQodVtpXS5vKTsNCj4gKw0KPiAr
ICAgICAgICAgICAgICAgcWNvbXRlZV9vYmplY3RfcHV0KHVbaV0ubyk7DQo+ICsgICAgICAgfQ0K
PiArDQo+ICsgICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICog
cWNvbXRlZV9wYXJhbXNfZnJvbV9hcmdzKCkgLSBDb252ZXJ0IFFURUUgYXJndW1lbnRzIHRvIFRF
RSBwYXJhbWV0ZXJzLg0KPiArICogQHBhcmFtczogVEVFIHBhcmFtZXRlcnMuDQo+ICsgKiBAdTog
UVRFRSBhcmd1bWVudHMuDQo+ICsgKiBAbnVtX3BhcmFtczogbnVtYmVyIG9mIGVsZW1lbnRzIGlu
IHRoZSBwYXJhbWV0ZXIgYXJyYXkuDQo+ICsgKiBAY3R4OiBjb250ZXh0IGluIHdoaWNoIHRoZSBj
b252ZXJzaW9uIHNob3VsZCBoYXBwZW4uDQo+ICsgKg0KPiArICogQHUgc2hvdWxkIGhhdmUgYWxy
ZWFkeSBiZWVuIGluaXRpYWxpemVkIGJ5IHFjb210ZWVfcGFyYW1zX3RvX2FyZ3MoKS4NCj4gKyAq
IFRoaXMgYWxzbyByZXByZXNlbnRzIHRoZSBlbmQgb2YgYSBRVEVFIGludm9jYXRpb24gdGhhdCBz
dGFydGVkIHdpdGgNCj4gKyAqIHFjb210ZWVfcGFyYW1zX3RvX2FyZ3MoKSBieSByZWxlYXNpbmcg
JVFDT01URUVfQVJHX1RZUEVfSU8gb2JqZWN0cy4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1
Y2Nlc3MsIHJldHVybnMgMDsgb24gZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK3N0
YXRpYyBpbnQgcWNvbXRlZV9wYXJhbXNfZnJvbV9hcmdzKHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFt
cywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210ZWVf
YXJnICp1LCBpbnQgbnVtX3BhcmFtcywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHRlZV9jb250ZXh0ICpjdHgpDQo+ICt7DQo+ICsgICAgICAgaW50IGksIG5w
Ow0KPiArDQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2gobnAsIHUpIHsNCj4gKyAgICAg
ICAgICAgICAgIGlmICh1W25wXS50eXBlID09IFFDT01URUVfQVJHX1RZUEVfT0IpIHsNCg0KQ2Fu
IHdlIHVzZSBzd2l0Y2godVtucF0udHlwZSk/DQoNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
LyogVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9VQlVGX09VVFBVVCAqLw0KPiArICAgICAgICAg
ICAgICAgICAgICAgICBwYXJhbXNbbnBdLnUudmFsdWUuYiA9IHVbbnBdLmIuc2l6ZTsNCg0KU2hv
dWxkIHRoaXMgYmUgcGFyYW1zW25wXS51LnVidWYuc2l6ZT8NCg0KPiArDQo+ICsgICAgICAgICAg
ICAgICB9IGVsc2UgaWYgKHVbbnBdLnR5cGUgPT0gUUNPTVRFRV9BUkdfVFlQRV9JTykgew0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAvKiBJRUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX09CSlJF
Rl9JTlBVVCAqLw0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQo
dVtucF0ubyk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodVtucF0udHlwZSA9
PSBRQ09NVEVFX0FSR19UWVBFX09PKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8qIFRF
RV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfT0JKUkVGX09VVFBVVCAqLw0KPiArICAgICAgICAgICAg
ICAgICAgICAgICBpZiAocWNvbXRlZV9vYmpyZWZfZnJvbV9hcmcoJnBhcmFtc1tucF0sICZ1W25w
XSwgY3R4KSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnb3RvIG91dF9mYWls
ZWQ7DQo+ICsgICAgICAgICAgICAgICB9DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcmV0
dXJuIDA7DQo+ICsNCj4gK291dF9mYWlsZWQ6DQo+ICsgICAgICAgLyogVW5kbyBxY29tdGVlX29i
anJlZl9mcm9tX2FyZygpLiAqLw0KPiArICAgICAgIGZvciAoaSA9IDA7IGkgPCBucDsgaSsrKSB7
DQo+ICsgICAgICAgICAgICAgICBpZiAocGFyYW1zW2ldLmF0dHIgPT0gVEVFX0lPQ1RMX1BBUkFN
X0FUVFJfVFlQRV9PQkpSRUZfT1VUUFVUKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29t
dGVlX2NvbnRleHRfZGVsX3F0ZWVfb2JqZWN0KCZwYXJhbXNbaV0sIGN0eCk7DQo+ICsgICAgICAg
fQ0KPiArDQo+ICsgICAgICAgLyogUmVsZWFzZSBhbnkgSU8gYW5kIE9PIG9iamVjdHMgbm90IHBy
b2Nlc3NlZC4gKi8NCj4gKyAgICAgICBmb3IgKDsgdVtpXS50eXBlOyBpKyspIHsNCj4gKyAgICAg
ICAgICAgICAgIGlmICh1W2ldLnR5cGUgPT0gUUNPTVRFRV9BUkdfVFlQRV9PTyB8fA0KPiArICAg
ICAgICAgICAgICAgICAgIHVbaV0udHlwZSA9PSBRQ09NVEVFX0FSR19UWVBFX0lPKQ0KPiArICAg
ICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQodVtpXS5vKTsNCj4gKyAgICAg
ICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gK30NCj4gKw0KPiArLyogVEVF
IERldmljZSBPcHMuICovDQo+ICsNCj4gK3N0YXRpYyBpbnQgcWNvbXRlZV9wYXJhbXNfY2hlY2so
c3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLCBpbnQgbnVtX3BhcmFtcykNCj4gK3sNCj4gKyAgICAg
ICBpbnQgaW8gPSAwLCBvbyA9IDAsIGliID0gMCwgb2IgPSAwOw0KPiArICAgICAgIGludCBpOw0K
PiArDQo+ICsgICAgICAgLyogUVRFRSBhY2NlcHRzIDY0IGFyZ3VtZW50cy4gKi8NCj4gKyAgICAg
ICBpZiAobnVtX3BhcmFtcyA+IFFDT01URUVfQVJHU19NQVgpDQo+ICsgICAgICAgICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArICAgICAgIC8qIFN1cHBvcnRlZCBwYXJhbWV0ZXIgdHlw
ZXMuICovDQo+ICsgICAgICAgZm9yIChpID0gMDsgaSA8IG51bV9wYXJhbXM7IGkrKykgew0KPiAr
ICAgICAgICAgICAgICAgc3dpdGNoIChwYXJhbXNbaV0uYXR0cikgew0KPiArICAgICAgICAgICAg
ICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1VCVUZfSU5QVVQ6DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGliKys7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0K
PiArICAgICAgICAgICAgICAgY2FzZSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1VCVUZfT1VU
UFVUOg0KPiArICAgICAgICAgICAgICAgICAgICAgICBvYisrOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBicmVhazsNCj4gKyAgICAgICAgICAgICAgIGNhc2UgVEVFX0lPQ1RMX1BBUkFNX0FU
VFJfVFlQRV9PQkpSRUZfSU5QVVQ6DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlvKys7DQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgY2FzZSBU
RUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX09CSlJFRl9PVVRQVVQ6DQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIG9vKys7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAg
ICAgICAgICAgICAgZGVmYXVsdDoNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7DQo+ICsgICAgICAgICAgICAgICB9DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAg
LyogIFFURUUgYWNjZXB0cyAxNiBhcmd1bWVudHMgb2YgZWFjaCBzdXBwb3J0ZWQgdHlwZXMuICov
DQo+ICsgICAgICAgaWYgKGlvID4gUUNPTVRFRV9BUkdTX1BFUl9UWVBFIHx8IG9vID4gUUNPTVRF
RV9BUkdTX1BFUl9UWVBFIHx8DQo+ICsgICAgICAgICAgIGliID4gUUNPTVRFRV9BUkdTX1BFUl9U
WVBFIHx8IG9iID4gUUNPTVRFRV9BUkdTX1BFUl9UWVBFKQ0KPiArICAgICAgICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArLyog
Q2hlY2sgaWYgYW4gb3BlcmF0aW9uIG9uIFJPT1RfUUNPTVRFRV9PQkpFQ1QgZnJvbSB1c2Vyc3Bh
Y2UgaXMgcGVybWl0dGVkLiAqLw0KPiArc3RhdGljIGludCBxY29tdGVlX3Jvb3Rfb2JqZWN0X2No
ZWNrKHUzMiBvcCwgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgaW50IG51bV9wYXJhbXMpDQo+ICt7DQo+ICsgICAgICAgLyog
U29tZSBwcml2aWxlZ2VkIG9wZXJhdGlvbnMgcmVjb2duaXplZCBieSBRVEVFLiAqLw0KPiArICAg
ICAgIGlmIChvcCA9PSBRQ09NVEVFX1JPT1RfT1BfTk9USUZZX0RPTUFJTl9DSEFOR0UgfHwNCj4g
KyAgICAgICAgICAgb3AgPT0gUUNPTVRFRV9ST09UX09QX0FEQ0lfQUNDRVBUIHx8DQo+ICsgICAg
ICAgICAgIG9wID09IFFDT01URUVfUk9PVF9PUF9BRENJX1NIVVRET1dOKQ0KPiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FSU5WQUw7DQo+ICsNCj4gKyAgICAgICAvKg0KPiArICAgICAgICAqIFFD
T01URUVfUk9PVF9PUF9SRUdJU1RFUl9XSVRIX0NSRURFTlRJQUxTIGlzIHRvIHJlZ2lzdGVyIHdp
dGggUVRFRQ0KPiArICAgICAgICAqIGJ5IHBhc3NpbmcgYSBjcmVkZW50aWFsIG9iamVjdCBhcyBp
bnB1dCBPQkpSRUYuIFRFRV9PQkpSRUZfTlVMTCBhcyBhDQo+ICsgICAgICAgICogY3JlZGVudGlh
bCBvYmplY3QgcmVwcmVzZW50cyBhIHByaXZpbGVnZWQgY2xpZW50IGZvciBRVEVFIGFuZA0KPiAr
ICAgICAgICAqIGlzIHVzZWQgYnkgdGhlIGtlcm5lbCBvbmx5Lg0KPiArICAgICAgICAqLw0KPiAr
ICAgICAgIGlmIChvcCA9PSBRQ09NVEVFX1JPT1RfT1BfUkVHSVNURVJfV0lUSF9DUkVERU5USUFM
UyAmJg0KPiArICAgICAgICAgICBudW1fcGFyYW1zID09IDIpIHsNCj4gKyAgICAgICAgICAgICAg
IGlmIChwYXJhbXNbMF0uYXR0ciA9PSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX09CSlJFRl9J
TlBVVCAmJg0KPiArICAgICAgICAgICAgICAgICAgIHBhcmFtc1sxXS5hdHRyID09IFRFRV9JT0NU
TF9QQVJBTV9BVFRSX1RZUEVfT0JKUkVGX09VVFBVVCkgew0KPiArICAgICAgICAgICAgICAgICAg
ICAgICBpZiAocGFyYW1zWzBdLnUub2JqcmVmLmlkID09IFRFRV9PQkpSRUZfTlVMTCkNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gKyAgICAgICAg
ICAgICAgIH0NCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gMDsNCj4gK30NCj4g
Kw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX29iamVjdF9pbnZva2UoKSAtIEludm9rZSBhIFFURUUg
b2JqZWN0Lg0KPiArICogQGN0eDogVEVFIGNvbnRleHQuDQo+ICsgKiBAYXJnOiBpb2N0bCBhcmd1
bWVudHMuDQo+ICsgKiBAcGFyYW1zOiBwYXJhbWV0ZXJzIGZvciB0aGUgb2JqZWN0Lg0KPiArICoN
Cj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJlLCByZXR1cm5z
IDwgMC4NCj4gKyAqLw0KPiArc3RhdGljIGludCBxY29tdGVlX29iamVjdF9pbnZva2Uoc3RydWN0
IHRlZV9jb250ZXh0ICpjdHgsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0
cnVjdCB0ZWVfaW9jdGxfb2JqZWN0X2ludm9rZV9hcmcgKmFyZywNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zKQ0KPiArew0KPiArICAg
ICAgIHN0cnVjdCBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4ICpvaWMgX19mcmVlKGtmcmVlKSA9
IE5VTEw7DQo+ICsgICAgICAgc3RydWN0IHFjb210ZWVfY29udGV4dF9kYXRhICpjdHhkYXRhID0g
Y3R4LT5kYXRhOw0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX2FyZyAqdSBfX2ZyZWUoa2ZyZWUp
ID0gTlVMTDsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdDsNCj4gKyAg
ICAgICBpbnQgaSwgcmV0LCByZXN1bHQ7DQo+ICsNCj4gKyAgICAgICBpZiAocWNvbXRlZV9wYXJh
bXNfY2hlY2socGFyYW1zLCBhcmctPm51bV9wYXJhbXMpKQ0KPiArICAgICAgICAgICAgICAgcmV0
dXJuIC1FSU5WQUw7DQo+ICsNCj4gKyAgICAgICAvKiBGaXJzdCwgaGFuZGxlIHJlc2VydmVkIG9w
ZXJhdGlvbnM6ICovDQo+ICsgICAgICAgaWYgKGFyZy0+b3AgPT0gUUNPTVRFRV9NU0dfT0JKRUNU
X09QX1JFTEVBU0UpIHsNCj4gKyAgICAgICAgICAgICAgIGRlbF9xdGVlX29iamVjdChhcmctPm9i
amVjdCwgY3R4ZGF0YSk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAwOw0KPiArICAg
ICAgIH0NCj4gKw0KPiArICAgICAgIC8qIE90aGVyd2lzZSwgaW52b2tlIGEgUVRFRSBvYmplY3Q6
ICovDQo+ICsgICAgICAgb2ljID0gcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eF9hbGxvYyhjdHgp
Ow0KPiArICAgICAgIGlmICghb2ljKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07
DQo+ICsNCj4gKyAgICAgICAvKiArMSBmb3IgZW5kaW5nIFFDT01URUVfQVJHX1RZUEVfSU5WLiAq
Lw0KPiArICAgICAgIHUgPSBrY2FsbG9jKGFyZy0+bnVtX3BhcmFtcyArIDEsIHNpemVvZigqdSks
IEdGUF9LRVJORUwpOw0KPiArICAgICAgIGlmICghdSkNCj4gKyAgICAgICAgICAgICAgIHJldHVy
biAtRU5PTUVNOw0KPiArDQo+ICsgICAgICAgLyogR2V0IGFuIG9iamVjdCB0byBpbnZva2UuICov
DQo+ICsgICAgICAgaWYgKGFyZy0+b2JqZWN0ID09IFRFRV9PQkpSRUZfTlVMTCkgew0KPiArICAg
ICAgICAgICAgICAgLyogVXNlIFJPT1QgaWYgVEVFX09CSlJFRl9OVUxMIGlzIGludm9rZWQuICov
DQo+ICsgICAgICAgICAgICAgICBpZiAocWNvbXRlZV9yb290X29iamVjdF9jaGVjayhhcmctPm9w
LCBwYXJhbXMsIGFyZy0+bnVtX3BhcmFtcykpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJl
dHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgICAgICAgICBvYmplY3QgPSBST09UX1FDT01U
RUVfT0JKRUNUOw0KPiArICAgICAgIH0gZWxzZSBpZiAoZmluZF9xdGVlX29iamVjdCgmb2JqZWN0
LCBhcmctPm9iamVjdCwgY3R4ZGF0YSkpIHsNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHJldCA9IHFjb210ZWVfcGFyYW1zX3Rv
X2FyZ3ModSwgcGFyYW1zLCBhcmctPm51bV9wYXJhbXMsIGN0eCk7DQo+ICsgICAgICAgaWYgKHJl
dCkNCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0Ow0KPiArDQo+ICsgICAgICAgcmV0ID0gcWNv
bXRlZV9vYmplY3RfZG9faW52b2tlKG9pYywgb2JqZWN0LCBhcmctPm9wLCB1LCAmcmVzdWx0KTsN
Cj4gKyAgICAgICBpZiAocmV0KSB7DQo+ICsgICAgICAgICAgICAgICBxY29tdGVlX2FyZ19mb3Jf
ZWFjaF9pbnB1dF9vYmplY3QoaSwgdSkgew0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29t
dGVlX3VzZXJfb2JqZWN0X3NldF9ub3RpZnkodVtpXS5vLCBmYWxzZSk7DQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIHFjb210ZWVfb2JqZWN0X3B1dCh1W2ldLm8pOw0KPiArICAgICAgICAgICAg
ICAgfQ0KPiArDQo+ICsgICAgICAgICAgICAgICBnb3RvIG91dDsNCj4gKyAgICAgICB9DQo+ICsN
Cj4gKyAgICAgICBpZiAoIXJlc3VsdCkgew0KPiArICAgICAgICAgICAgICAgLyogQXNzdW1lIHNl
cnZpY2UgaXMgVU5BVkFJTCBpZiB1bmFibGUgdG8gcHJvY2VzcyB0aGUgcmVzdWx0LiAqLw0KPiAr
ICAgICAgICAgICAgICAgaWYgKHFjb210ZWVfcGFyYW1zX2Zyb21fYXJncyhwYXJhbXMsIHUsIGFy
Zy0+bnVtX3BhcmFtcywgY3R4KSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0g
UUNPTVRFRV9NU0dfRVJST1JfVU5BVkFJTDsNCj4gKyAgICAgICB9IGVsc2Ugew0KPiArICAgICAg
ICAgICAgICAgLyoNCj4gKyAgICAgICAgICAgICAgICAqIHFjb210ZWVfcGFyYW1zX3RvX2FyZ3Mo
KSBnZXRzIGEgY29weSBvZiBJTyBmb3IgdGhlIGRyaXZlciB0bw0KPiArICAgICAgICAgICAgICAg
ICogbWFrZSBzdXJlIHRoZXkgZG8gbm90IGdldCByZWxlYXNlZCB3aGlsZSBpbiB0aGUgbWlkZGxl
IG9mDQo+ICsgICAgICAgICAgICAgICAgKiBpbnZvY2F0aW9uLiBPbiBzdWNjZXNzICghcmVzdWx0
KSwgcWNvbXRlZV9wYXJhbXNfZnJvbV9hcmdzKCkNCj4gKyAgICAgICAgICAgICAgICAqIHB1dHMg
dGhlbS4NCj4gKyAgICAgICAgICAgICAgICAqLw0KPiArICAgICAgICAgICAgICAgcWNvbXRlZV9h
cmdfZm9yX2VhY2hfaW5wdXRfb2JqZWN0KGksIHUpDQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IHFjb210ZWVfb2JqZWN0X3B1dCh1W2ldLm8pOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAg
IGFyZy0+cmV0ID0gcmVzdWx0Ow0KPiArb3V0Og0KPiArICAgICAgIHFjb210ZWVfb2JqZWN0X3B1
dChvYmplY3QpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJldDsNCj4gK30NCj4gKw0KPiArLyoq
DQo+ICsgKiBxY29tdGVlX3N1cHBfcmVjdigpIC0gV2FpdCBmb3IgYSByZXF1ZXN0IGZvciB0aGUg
c3VwcGxpY2FudC4NCj4gKyAqIEBjdHg6IFRFRSBjb250ZXh0Lg0KPiArICogQG9wOiByZXF1ZXN0
ZWQgb3BlcmF0aW9uIG9uIHRoZSBvYmplY3QuDQo+ICsgKiBAbnVtX3BhcmFtczogbnVtYmVyIG9m
IGVsZW1lbnRzIGluIHRoZSBwYXJhbWV0ZXIgYXJyYXkuDQo+ICsgKiBAcGFyYW1zOiBwYXJhbWV0
ZXJzIGZvciBAb3AuDQo+ICsgKg0KPiArICogVGhlIGZpcnN0IHBhcmFtZXRlciBpcyBhIG1ldGEg
JVRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfSU5PVVQuDQo+ICsgKiBPbiBpbnB1dCwg
aXQgcHJvdmlkZXMgYSB1c2VyIGJ1ZmZlci4gVGhpcyBidWZmZXIgaXMgdXNlZCBmb3IgcGFyYW1l
dGVycyBvZg0KPiArICogdHlwZSAlVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9VQlVGX0lOUFVU
IGluIHFjb210ZWVfY2JfcGFyYW1zX2Zyb21fYXJncygpLg0KPiArICogT24gb3V0cHV0LCB0aGUg
b2JqZWN0IElEIGFuZCByZXF1ZXN0IElEIGFyZSBzdG9yZWQgaW4gdGhlIG1ldGEgcGFyYW1ldGVy
Lg0KPiArICoNCj4gKyAqIEBudW1fcGFyYW1zIGlzIHVwZGF0ZWQgdG8gdGhlIG51bWJlciBvZiBw
YXJhbWV0ZXJzIHRoYXQgYWN0dWFsbHkgZXhpc3QNCj4gKyAqIGluIEBwYXJhbXMgb24gcmV0dXJu
Lg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJl
LCByZXR1cm5zIDwgMC4NCj4gKyAqLw0KPiArc3RhdGljIGludCBxY29tdGVlX3N1cHBfcmVjdihz
dHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCwgdTMyICpvcCwgdTMyICpudW1fcGFyYW1zLA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtcykNCj4gK3sN
Cj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV91c2VyX29iamVjdF9yZXF1ZXN0X2RhdGEgZGF0YTsN
Cj4gKyAgICAgICB2b2lkIF9fdXNlciAqdWFkZHI7DQo+ICsgICAgICAgc2l6ZV90IHVidWZfc2l6
ZTsNCj4gKyAgICAgICBpbnQgaSwgcmV0Ow0KPiArDQo+ICsgICAgICAgaWYgKCEqbnVtX3BhcmFt
cykNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgLyog
V2UgZXhwZWN0IHRoZSBmaXJzdCBwYXJhbWV0ZXIgdG8gYmUgYW4gSU5PVVQgKyBtZXRhIHBhcmFt
ZXRlci4gKi8NCj4gKyAgICAgICBpZiAocGFyYW1zLT5hdHRyICE9DQo+ICsgICAgICAgICAgIChU
RUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1ZBTFVFX0lOT1VUIHwgVEVFX0lPQ1RMX1BBUkFNX0FU
VFJfTUVUQSkpDQoNCldoeSBhcmVuJ3QgeW91IHVzaW5nIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZ
UEVfVUJVRl8qPw0KDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiAr
ICAgICAgIC8qIE90aGVyIHBhcmFtZXRlcnMgYXJlIG5vbmUuICovDQo+ICsgICAgICAgZm9yIChp
ID0gMTsgaSA8ICpudW1fcGFyYW1zOyBpKyspDQo+ICsgICAgICAgICAgICAgICBpZiAocGFyYW1z
W2ldLmF0dHIpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiAr
DQo+ICsgICAgICAgaWYgKCFJU19BTElHTkVEKHBhcmFtcy0+dS52YWx1ZS5hLCA4KSkNCj4gKyAg
ICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgLyogVXNlciBidWZm
ZXIgYW5kIHNpemUgZnJvbSBtZXRhIHBhcmFtZXRlci4gKi8NCj4gKyAgICAgICB1YWRkciA9IHU2
NF90b191c2VyX3B0cihwYXJhbXMtPnUudmFsdWUuYSk7DQo+ICsgICAgICAgdWJ1Zl9zaXplID0g
cGFyYW1zLT51LnZhbHVlLmI7DQoNClBsZWFzZSB1c2UgcGFyYW1zLT51LnVidWYudWFkZHIgYW5k
IHBhcmFtcy0+dS51YnVmLnNpemUgaW5zdGVhZA0KDQo+ICsgICAgICAgLyogUHJvY2VzcyBURUUg
cGFyYW1ldGVycy4gKy8tMSB0byBpZ25vcmUgdGhlIG1ldGEgcGFyYW1ldGVyLiAqLw0KPiArICAg
ICAgIHJldCA9IHFjb210ZWVfdXNlcl9vYmplY3Rfc2VsZWN0KGN0eCwgcGFyYW1zICsgMSwgKm51
bV9wYXJhbXMgLSAxLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHVhZGRyLCB1YnVmX3NpemUsICZkYXRhKTsNCj4gKyAgICAgICBpZiAocmV0KQ0KPiArICAgICAg
ICAgICAgICAgcmV0dXJuIHJldDsNCj4gKw0KPiArICAgICAgIHBhcmFtcy0+dS52YWx1ZS5hID0g
ZGF0YS5vYmplY3RfaWQ7DQo+ICsgICAgICAgcGFyYW1zLT51LnZhbHVlLmIgPSBkYXRhLmlkOw0K
DQogcGFyYW1zLT51Lm9ianJlZi57aWQsIGZsYWdzfT8NClNob3VsZCBwYXJhbXMtPmF0dHIgYmUg
dXBkYXRlZCB3aXRoIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfT0JKUkVGXyo/DQoNCj4gKyAg
ICAgICBwYXJhbXMtPnUudmFsdWUuYyA9IDA7DQo+ICsgICAgICAgKm9wID0gZGF0YS5vcDsNCj4g
KyAgICAgICAqbnVtX3BhcmFtcyA9IGRhdGEubnAgKyAxOw0KPiArDQo+ICsgICAgICAgcmV0dXJu
IDA7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogcWNvbXRlZV9zdXBwX3NlbmQoKSAtIFN1Ym1p
dCBhIHJlc3BvbnNlIGZvciBhIHJlcXVlc3QuDQo+ICsgKiBAY3R4OiBURUUgY29udGV4dC4NCj4g
KyAqIEBlcnJubzogcmV0dXJuIHZhbHVlIGZvciB0aGUgcmVxdWVzdC4NCj4gKyAqIEBudW1fcGFy
YW1zOiBudW1iZXIgb2YgZWxlbWVudHMgaW4gdGhlIHBhcmFtZXRlciBhcnJheS4NCj4gKyAqIEBw
YXJhbXM6IHJldHVybmVkIHBhcmFtZXRlcnMuDQo+ICsgKg0KPiArICogVGhlIGZpcnN0IHBhcmFt
ZXRlciBpcyBhIG1ldGEgJVRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVkFMVUVfT1VUUFVULg0K
PiArICogSXQgc3BlY2lmaWVzIHRoZSByZXF1ZXN0IElEIHRoaXMgcmVzcG9uc2UgYmVsb25ncyB0
by4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMDsgb24gZmFpbHVy
ZSwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgcWNvbXRlZV9zdXBwX3NlbmQo
c3RydWN0IHRlZV9jb250ZXh0ICpjdHgsIHUzMiBlcnJubywgdTMyIG51bV9wYXJhbXMsDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zKQ0KPiAr
ew0KPiArICAgICAgIGlmICghbnVtX3BhcmFtcykNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAt
RUlOVkFMOw0KPiArDQo+ICsgICAgICAgLyogV2UgZXhwZWN0IHRoZSBmaXJzdCBwYXJhbWV0ZXIg
dG8gYmUgYW4gT1VUUFVUICsgbWV0YSBwYXJhbWV0ZXIuICovDQo+ICsgICAgICAgaWYgKHBhcmFt
cy0+YXR0ciAhPSAoVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9WQUxVRV9PVVRQVVQgfA0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9BVFRSX01FVEEpKQ0K
PiArICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7DQoNCldoeSBpcyB0aGlzIHVzZWQgaWYg
aXQncyB0byBiZSBpZ25vcmVkLCBtYWtpbmcgcm9vbSBmb3IgZm9yd2FyZCBjb21wYXRpYmlsaXR5
Pw0KDQo+ICsNCj4gKyAgICAgICAvKiBQcm9jZXNzIFRFRSBwYXJhbWV0ZXJzLiArLy0xIHRvIGln
bm9yZSB0aGUgbWV0YSBwYXJhbWV0ZXIuICovDQo+ICsgICAgICAgcmV0dXJuIHFjb210ZWVfdXNl
cl9vYmplY3Rfc3VibWl0KGN0eCwgcGFyYW1zICsgMSwgbnVtX3BhcmFtcyAtIDEsDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtcy0+dS52YWx1ZS5hLCBl
cnJubyk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyBpbnQgcWNvbXRlZV9vcGVuKHN0cnVjdCB0ZWVf
Y29udGV4dCAqY3R4KQ0KPiArew0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX2NvbnRleHRfZGF0
YSAqY3R4ZGF0YSBfX2ZyZWUoa2ZyZWUpID0gTlVMTDsNCj4gKw0KPiArICAgICAgIGN0eGRhdGEg
PSBremFsbG9jKHNpemVvZigqY3R4ZGF0YSksIEdGUF9LRVJORUwpOw0KPiArICAgICAgIGlmICgh
Y3R4ZGF0YSkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiArDQo+ICsgICAg
ICAgLyoNCj4gKyAgICAgICAgKiBJbiB0aGUgUVRFRSBkcml2ZXIsIHRoZSBzYW1lIGNvbnRleHQg
aXMgdXNlZCB0byByZWZjb3VudCByZXNvdXJjZXMNCj4gKyAgICAgICAgKiBzaGFyZWQgYnkgUVRF
RS4gRm9yIGV4YW1wbGUsIHRlZWRldl9jdHhfZ2V0KCkgaXMgY2FsbGVkIGZvciBhbnkNCj4gKyAg
ICAgICAgKiBpbnN0YW5jZSBvZiBjYWxsYmFjayBvYmplY3RzIChzZWUgcWNvbXRlZV91c2VyX3Bh
cmFtX3RvX29iamVjdCgpKS4NCj4gKyAgICAgICAgKg0KPiArICAgICAgICAqIE1haW50YWluIGEg
Y29weSBvZiB0ZWVkZXYgZm9yIFFURUUgYXMgaXQgc2VydmVzIGFzIGEgZGlyZWN0IHVzZXIgb2YN
Cj4gKyAgICAgICAgKiB0aGlzIGNvbnRleHQuIFRoZSB0ZWVkZXYgd2lsbCBiZSByZWxlYXNlZCBp
biB0aGUgY29udGV4dCdzIHJlbGVhc2UoKS4NCj4gKyAgICAgICAgKg0KPiArICAgICAgICAqIHRl
ZV9kZXZpY2VfdW5yZWdpc3RlcigpIHdpbGwgcmVtYWluIGJsb2NrZWQgdW50aWwgYWxsIGNvbnRl
eHRzDQo+ICsgICAgICAgICogYXJlIHJlbGVhc2VkLiBUaGlzIGluY2x1ZGVzIGNvbnRleHRzIG93
bmVkIGJ5IHRoZSB1c2VyLCB3aGljaCBhcmUNCj4gKyAgICAgICAgKiBjbG9zZWQgYnkgdGVlZGV2
X2Nsb3NlX2NvbnRleHQoKSwgYXMgd2VsbCBhcyB0aG9zZSBvd25lZCBieSBRVEVFDQo+ICsgICAg
ICAgICogY2xvc2VkIGJ5IHRlZV9jb250ZXh0X3B1dCgpIGluIG9iamVjdCdzIHJlbGVhc2UoKS4N
Cj4gKyAgICAgICAgKi8NCj4gKyAgICAgICBpZiAoIXRlZV9kZXZpY2VfZ2V0KGN0eC0+dGVlZGV2
KSkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgaWRy
X2luaXQoJmN0eGRhdGEtPnF0ZWVfb2JqZWN0c19pZHIpOw0KPiArICAgICAgIHNwaW5fbG9ja19p
bml0KCZjdHhkYXRhLT5xdGVlX2xvY2spOw0KPiArICAgICAgIGlkcl9pbml0KCZjdHhkYXRhLT5y
ZXFzX2lkcik7DQo+ICsgICAgICAgSU5JVF9MSVNUX0hFQUQoJmN0eGRhdGEtPnJlcXNfbGlzdCk7
DQo+ICsgICAgICAgbXV0ZXhfaW5pdCgmY3R4ZGF0YS0+cmVxc19sb2NrKTsNCj4gKyAgICAgICBp
bml0X2NvbXBsZXRpb24oJmN0eGRhdGEtPnJlcV9jKTsNCj4gKw0KPiArICAgICAgIGN0eC0+ZGF0
YSA9IG5vX2ZyZWVfcHRyKGN0eGRhdGEpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIDA7DQo+ICt9
DQo+ICsNCj4gKy8qIFRoaXMgaXMgY2FsbGVkIHdoZW4gdGhlIHVzZXIgY2xvc2VzIHRoZSBkZXZp
Y2UuICovDQo+ICtzdGF0aWMgdm9pZCBxY29tdGVlX2Nsb3NlX2NvbnRleHQoc3RydWN0IHRlZV9j
b250ZXh0ICpjdHgpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHFjb210ZWVfY29udGV4dF9kYXRh
ICpjdHhkYXRhID0gY3R4LT5kYXRhOw0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX29iamVjdCAq
b2JqZWN0Ow0KPiArICAgICAgIGludCBpZDsNCj4gKw0KPiArICAgICAgIC8qIFByb2Nlc3MgUVVF
VUVEIG9yIFBST0NFU1NJTkcgcmVxdWVzdHMuICovDQo+ICsgICAgICAgcWNvbXRlZV9yZXF1ZXN0
c19kZXN0cm95KGN0eGRhdGEpOw0KPiArICAgICAgIC8qIFJlbGVhc2UgUVRFRSBvYmplY3RzLiAq
Lw0KPiArICAgICAgIGlkcl9mb3JfZWFjaF9lbnRyeSgmY3R4ZGF0YS0+cXRlZV9vYmplY3RzX2lk
ciwgb2JqZWN0LCBpZCkNCj4gKyAgICAgICAgICAgICAgIHFjb210ZWVfb2JqZWN0X3B1dChvYmpl
Y3QpOw0KPiArfQ0KPiArDQo+ICsvKiBUaGlzIGlzIGNhbGxlZCB3aGVuIHRoZSBmaW5hbCByZWZl
cmVuY2UgdG8gdGhlIGNvbnRleHQgZ29lcyBhd2F5LiAqLw0KPiArc3RhdGljIHZvaWQgcWNvbXRl
ZV9yZWxlYXNlKHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4KQ0KPiArew0KPiArICAgICAgIHN0cnVj
dCBxY29tdGVlX2NvbnRleHRfZGF0YSAqY3R4ZGF0YSA9IGN0eC0+ZGF0YTsNCj4gKw0KPiArICAg
ICAgIGlkcl9kZXN0cm95KCZjdHhkYXRhLT5xdGVlX29iamVjdHNfaWRyKTsNCj4gKyAgICAgICBp
ZHJfZGVzdHJveSgmY3R4ZGF0YS0+cmVxc19pZHIpOw0KPiArICAgICAgIGtmcmVlKGN0eGRhdGEp
Ow0KPiArDQo+ICsgICAgICAgLyogVGhlcmUgaXMgbm90aGluZyBzaGFyZWQgaW4gdGhpcyBjb250
ZXh0IHdpdGggUVRFRS4gKi8NCj4gKyAgICAgICB0ZWVfZGV2aWNlX3B1dChjdHgtPnRlZWRldik7
DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHFjb210ZWVfZ2V0X3ZlcnNpb24oc3RydWN0IHRl
ZV9kZXZpY2UgKnRlZWRldiwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgdGVlX2lvY3RsX3ZlcnNpb25fZGF0YSAqdmVycykNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3Qg
dGVlX2lvY3RsX3ZlcnNpb25fZGF0YSB2ID0gew0KPiArICAgICAgICAgICAgICAgLmltcGxfaWQg
PSBURUVfSU1QTF9JRF9RVEVFLA0KPiArICAgICAgICAgICAgICAgLmdlbl9jYXBzID0gVEVFX0dF
Tl9DQVBfT0JKUkVGLA0KPiArICAgICAgIH07DQo+ICsNCj4gKyAgICAgICAqdmVycyA9IHY7DQo+
ICt9DQo+ICsNCj4gK3N0YXRpYyBjb25zdCBzdHJ1Y3QgdGVlX2RyaXZlcl9vcHMgcWNvbXRlZV9v
cHMgPSB7DQo+ICsgICAgICAgLmdldF92ZXJzaW9uID0gcWNvbXRlZV9nZXRfdmVyc2lvbiwNCj4g
KyAgICAgICAub3BlbiA9IHFjb210ZWVfb3BlbiwNCj4gKyAgICAgICAuY2xvc2VfY29udGV4dCA9
IHFjb210ZWVfY2xvc2VfY29udGV4dCwNCj4gKyAgICAgICAucmVsZWFzZSA9IHFjb210ZWVfcmVs
ZWFzZSwNCj4gKyAgICAgICAub2JqZWN0X2ludm9rZV9mdW5jID0gcWNvbXRlZV9vYmplY3RfaW52
b2tlLA0KPiArICAgICAgIC5zdXBwX3JlY3YgPSBxY29tdGVlX3N1cHBfcmVjdiwNCj4gKyAgICAg
ICAuc3VwcF9zZW5kID0gcWNvbXRlZV9zdXBwX3NlbmQsDQo+ICt9Ow0KPiArDQo+ICtzdGF0aWMg
Y29uc3Qgc3RydWN0IHRlZV9kZXNjIHFjb210ZWVfZGVzYyA9IHsNCj4gKyAgICAgICAubmFtZSA9
ICJxY29tdGVlIiwNCj4gKyAgICAgICAub3BzID0gJnFjb210ZWVfb3BzLA0KPiArICAgICAgIC5v
d25lciA9IFRISVNfTU9EVUxFLA0KPiArfTsNCj4gKw0KPiArc3RhdGljIGludCBxY29tdGVlX3By
b2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKnBkZXYpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0
IHdvcmtxdWV1ZV9zdHJ1Y3QgKmFzeW5jX3dxOw0KPiArICAgICAgIHN0cnVjdCB0ZWVfZGV2aWNl
ICp0ZWVkZXY7DQo+ICsgICAgICAgc3RydWN0IHRlZV9zaG1fcG9vbCAqcG9vbDsNCj4gKyAgICAg
ICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eDsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZSAqcWNv
bXRlZTsNCj4gKyAgICAgICBpbnQgZXJyOw0KPiArDQo+ICsgICAgICAgcWNvbXRlZSA9IGt6YWxs
b2Moc2l6ZW9mKCpxY29tdGVlKSwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgaWYgKCFxY29tdGVl
KQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9NRU07DQo+ICsNCj4gKyAgICAgICBwb29s
ID0gcWNvbXRlZV9zaG1fcG9vbF9hbGxvYygpOw0KPiArICAgICAgIGlmIChJU19FUlIocG9vbCkp
IHsNCj4gKyAgICAgICAgICAgICAgIGVyciA9IFBUUl9FUlIocG9vbCk7DQo+ICsNCj4gKyAgICAg
ICAgICAgICAgIGdvdG8gZXJyX2ZyZWVfcWNvbXRlZTsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAg
ICAgICB0ZWVkZXYgPSB0ZWVfZGV2aWNlX2FsbG9jKCZxY29tdGVlX2Rlc2MsIE5VTEwsIHBvb2ws
IHFjb210ZWUpOw0KPiArICAgICAgIGlmIChJU19FUlIodGVlZGV2KSkgew0KPiArICAgICAgICAg
ICAgICAgZXJyID0gUFRSX0VSUih0ZWVkZXYpOw0KPiArDQo+ICsgICAgICAgICAgICAgICBnb3Rv
IGVycl9wb29sX2Rlc3Ryb3k7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcWNvbXRlZS0+
dGVlZGV2ID0gdGVlZGV2Ow0KPiArICAgICAgIHFjb210ZWUtPnBvb2wgPSBwb29sOw0KPiArICAg
ICAgIGVyciA9IHRlZV9kZXZpY2VfcmVnaXN0ZXIocWNvbXRlZS0+dGVlZGV2KTsNCj4gKyAgICAg
ICBpZiAoZXJyKQ0KPiArICAgICAgICAgICAgICAgZ290byBlcnJfdW5yZWdfdGVlZGV2Ow0KPiAr
DQo+ICsgICAgICAgcGxhdGZvcm1fc2V0X2RydmRhdGEocGRldiwgcWNvbXRlZSk7DQo+ICsgICAg
ICAgLyogU3RhcnQgYXN5bmMgd3EuICovDQo+ICsgICAgICAgYXN5bmNfd3EgPSBhbGxvY19vcmRl
cmVkX3dvcmtxdWV1ZSgicWNvbXRlZV93cSIsIDApOw0KPiArICAgICAgIGlmICghYXN5bmNfd3Ep
DQo+ICsgICAgICAgICAgICAgICBnb3RvIGVycl91bnJlZ190ZWVkZXY7DQo+ICsNCj4gKyAgICAg
ICBxY29tdGVlLT53cSA9IGFzeW5jX3dxOw0KPiArICAgICAgIC8qIERyaXZlciBjb250ZXh0IHVz
ZWQgZm9yIGFzeW5jIG9wZXJhdGlvbnMgb2YgdGVlZGV2LiAqLw0KPiArICAgICAgIGN0eCA9IHRl
ZWRldl9vcGVuKHFjb210ZWUtPnRlZWRldik7DQo+ICsgICAgICAgaWYgKElTX0VSUihjdHgpKSB7
DQo+ICsgICAgICAgICAgICAgICBlcnIgPSBQVFJfRVJSKGN0eCk7DQo+ICsNCj4gKyAgICAgICAg
ICAgICAgIGdvdG8gZXJyX2Rlc3Rfd3E7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcWNv
bXRlZS0+Y3R4ID0gY3R4Ow0KPiArDQo+ICsgICAgICAgcmV0dXJuIDA7DQo+ICsNCj4gK2Vycl9k
ZXN0X3dxOg0KPiArICAgICAgIGRlc3Ryb3lfd29ya3F1ZXVlKHFjb210ZWUtPndxKTsNCj4gK2Vy
cl91bnJlZ190ZWVkZXY6DQo+ICsgICAgICAgdGVlX2RldmljZV91bnJlZ2lzdGVyKHFjb210ZWUt
PnRlZWRldik7DQo+ICtlcnJfcG9vbF9kZXN0cm95Og0KPiArICAgICAgIHRlZV9zaG1fcG9vbF9m
cmVlKHBvb2wpOw0KPiArZXJyX2ZyZWVfcWNvbXRlZToNCj4gKyAgICAgICBrZnJlZShxY29tdGVl
KTsNCj4gKw0KPiArICAgICAgIHJldHVybiBlcnI7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICog
cWNvbXRlZV9yZW1vdmUoKSAtIERldmljZSBSZW1vdmFsIFJvdXRpbmUuDQo+ICsgKiBAcGRldjog
cGxhdGZvcm0gZGV2aWNlIGluZm9ybWF0aW9uIHN0cnVjdC4NCj4gKyAqDQo+ICsgKiBJdCBpcyBj
YWxsZWQgYnkgdGhlIHBsYXRmb3JtIHN1YnN5c3RlbSB0byBhbGVydCB0aGUgZHJpdmVyIHRoYXQg
aXQgc2hvdWxkDQo+ICsgKiByZWxlYXNlIHRoZSBkZXZpY2UuDQo+ICsgKg0KPiArICogUVRFRSBk
b2VzIG5vdCBwcm92aWRlIGFuIEFQSSB0byBpbmZvcm0gaXQgYWJvdXQgYSBjYWxsYmFjayBvYmpl
Y3QgZ29pbmcgYXdheS4NCj4gKyAqIEhvd2V2ZXIsIHdoZW4gcmVsZWFzaW5nIFFURUUgb2JqZWN0
cywgYW55IGNhbGxiYWNrIG9iamVjdCBzZW50IHRvIFFURUUNCj4gKyAqIHByZXZpb3VzbHkgd291
bGQgYmUgcmVsZWFzZWQgYnkgUVRFRSBhcyBwYXJ0IG9mIHRoZSBvYmplY3QgcmVsZWFzZS4NCj4g
KyAqLw0KPiArc3RhdGljIHZvaWQgcWNvbXRlZV9yZW1vdmUoc3RydWN0IHBsYXRmb3JtX2Rldmlj
ZSAqcGRldikNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZSAqcWNvbXRlZSA9IHBsYXRm
b3JtX2dldF9kcnZkYXRhKHBkZXYpOw0KPiArDQo+ICsgICAgICAgdGVlZGV2X2Nsb3NlX2NvbnRl
eHQocWNvbXRlZS0+Y3R4KTsNCj4gKyAgICAgICAvKiBXYWl0IGZvciBSRUxFQVNFIG9wZXJhdGlv
bnMgdG8gYmUgcHJvY2Vzc2VkIGZvciBRVEVFIG9iamVjdHMuICovDQo+ICsgICAgICAgdGVlX2Rl
dmljZV91bnJlZ2lzdGVyKHFjb210ZWUtPnRlZWRldik7DQo+ICsgICAgICAgZGVzdHJveV93b3Jr
cXVldWUocWNvbXRlZS0+d3EpOw0KPiArICAgICAgIHRlZV9zaG1fcG9vbF9mcmVlKHFjb210ZWUt
PnBvb2wpOw0KPiArICAgICAgIGtmcmVlKHFjb210ZWUpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMg
Y29uc3Qgc3RydWN0IHBsYXRmb3JtX2RldmljZV9pZCBxY29tdGVlX2lkc1tdID0geyB7ICJxY29t
dGVlIiwgMCB9LCB7fSB9Ow0KPiArTU9EVUxFX0RFVklDRV9UQUJMRShwbGF0Zm9ybSwgcWNvbXRl
ZV9pZHMpOw0KPiArDQo+ICtzdGF0aWMgc3RydWN0IHBsYXRmb3JtX2RyaXZlciBxY29tdGVlX3Bs
YXRmb3JtX2RyaXZlciA9IHsNCj4gKyAgICAgICAucHJvYmUgPSBxY29tdGVlX3Byb2JlLA0KPiAr
ICAgICAgIC5yZW1vdmUgPSBxY29tdGVlX3JlbW92ZSwNCj4gKyAgICAgICAuZHJpdmVyID0gew0K
PiArICAgICAgICAgICAgICAgLm5hbWUgPSAicWNvbXRlZSIsDQo+ICsgICAgICAgfSwNCj4gKyAg
ICAgICAuaWRfdGFibGUgPSBxY29tdGVlX2lkcywNCj4gK307DQo+ICsNCj4gK21vZHVsZV9wbGF0
Zm9ybV9kcml2ZXIocWNvbXRlZV9wbGF0Zm9ybV9kcml2ZXIpOw0KPiArDQo+ICtNT0RVTEVfQVVU
SE9SKCJRdWFsY29tbSIpOw0KPiArTU9EVUxFX0RFU0NSSVBUSU9OKCJRVEVFIGRyaXZlciIpOw0K
PiArTU9EVUxFX1ZFUlNJT04oIjEuMCIpOw0KPiArTU9EVUxFX0xJQ0VOU0UoIkdQTCIpOw0KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS9jb3JlLmMgYi9kcml2ZXJzL3RlZS9xY29t
dGVlL2NvcmUuYw0KPiBuZXcgZmlsZSBtb2RlIDEwMDY0NA0KPiBpbmRleCAwMDAwMDAwMDAwMDAu
LjE2MmUzMmRiNjU2YQ0KPiAtLS0gL2Rldi9udWxsDQo+ICsrKyBiL2RyaXZlcnMvdGVlL3Fjb210
ZWUvY29yZS5jDQo+IEBAIC0wLDAgKzEsODAxIEBADQo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRp
ZmllcjogR1BMLTIuMC1vbmx5DQo+ICsvKg0KPiArICogQ29weXJpZ2h0IChjKSAyMDI0IFF1YWxj
b21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQo+ICsgKi8N
Cj4gKw0KPiArI2RlZmluZSBwcl9mbXQoZm10KSBLQlVJTERfTU9ETkFNRSAiOiAiIGZtdA0KPiAr
DQo+ICsjaW5jbHVkZSA8bGludXgvaW5pdC5oPg0KPiArI2luY2x1ZGUgPGxpbnV4L21vZHVsZS5o
Pg0KPiArI2luY2x1ZGUgPGxpbnV4L3NsYWIuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC94YXJyYXku
aD4NCj4gKw0KPiArI2luY2x1ZGUgInFjb210ZWVfbXNnLmgiDQo+ICsjaW5jbHVkZSAicWNvbXRl
ZV9wcml2YXRlLmgiDQo+ICsNCj4gKy8qIFRoaXMgaXMgdGhlIFFURUUgcm9vdCBvYmplY3QuICov
DQo+ICtzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgcWNvbXRlZV9vYmplY3Rfcm9vdCA9IHsNCj4gKyAg
ICAgICAubmFtZSA9ICJyb290IiwNCj4gKyAgICAgICAub2JqZWN0X3R5cGUgPSBRQ09NVEVFX09C
SkVDVF9UWVBFX1JPT1QsDQo+ICsgICAgICAgLmluZm8ucXRlZV9pZCA9IFFDT01URUVfTVNHX09C
SkVDVF9ST09ULA0KPiArfTsNCj4gK0VYUE9SVF9TWU1CT0xfR1BMKHFjb210ZWVfb2JqZWN0X3Jv
b3QpOw0KPiArDQo+ICsvKiBOZXh0IGFyZ3VtZW50IG9mIHR5cGUgQHR5cGUgYWZ0ZXIgaW5kZXgg
QGkuICovDQo+ICtpbnQgcWNvbXRlZV9uZXh0X2FyZ190eXBlKHN0cnVjdCBxY29tdGVlX2FyZyAq
dSwgaW50IGksDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgZW51bSBxY29tdGVlX2FyZ190
eXBlIHR5cGUpDQo+ICt7DQo+ICsgICAgICAgd2hpbGUgKHVbaV0udHlwZSAhPSBRQ09NVEVFX0FS
R19UWVBFX0lOViAmJiB1W2ldLnR5cGUgIT0gdHlwZSkNCj4gKyAgICAgICAgICAgICAgIGkrKzsN
Cj4gKyAgICAgICByZXR1cm4gaTsNCj4gK30NCj4gKw0KPiArLyoNCj4gKyAqIFFURUUgZXhwZWN0
cyBJRHMgd2l0aCB0aGUgUUNPTVRFRV9NU0dfT0JKRUNUX05TX0JJVCBzZXQgZm9yIG9iamVjdHMN
Cj4gKyAqIG9mIHRoZSBRQ09NVEVFX09CSkVDVF9UWVBFX0NCIHR5cGUuDQo+ICsgKi8NCj4gKyNk
ZWZpbmUgUUNPTVRFRV9PQkpFQ1RfSURfU1RBUlQgKFFDT01URUVfTVNHX09CSkVDVF9OU19CSVQg
KyAxKQ0KPiArI2RlZmluZSBRQ09NVEVFX09CSkVDVF9JRF9FTkQgKFVJTlRfTUFYKQ0KDQpTaG91
bGQgdGhpcyBiZSBVMzJfTUFYIGNvbnNpZGVyaW5nIHRoYXQgUUNPTVRFRV9NU0dfT0JKRUNUX05T
X0JJVCBpcw0KZGVmaW5lZCBhcyBCSVQoMzEpPw0KDQo+ICsNCj4gKyNkZWZpbmUgUUNPTVRFRV9P
QkpFQ1RfU0VUKHAsIHR5cGUsIC4uLikgXA0KPiArICAgICAgIF9fUUNPTVRFRV9PQkpFQ1RfU0VU
KHAsIHR5cGUsICMjX19WQV9BUkdTX18sIDBVTCkNCj4gKyNkZWZpbmUgX19RQ09NVEVFX09CSkVD
VF9TRVQocCwgdHlwZSwgb3B0ciwgLi4uKSAgICAgICAgICAgXA0KPiArICAgICAgIGRvIHsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwNCj4gKyAgICAgICAg
ICAgICAgIChwKS0+b2JqZWN0X3R5cGUgPSAodHlwZSk7ICAgICAgICAgICAgICAgICBcDQo+ICsg
ICAgICAgICAgICAgICAocCktPmluZm8ucXRlZV9pZCA9ICh1bnNpZ25lZCBsb25nKShvcHRyKTsg
XA0KPiArICAgICAgIH0gd2hpbGUgKDApDQo+ICsNCj4gK3N0YXRpYyBzdHJ1Y3QgcWNvbXRlZV9v
YmplY3QgKg0KPiArcWNvbXRlZV9xdGVlX29iamVjdF9hbGxvYyhzdHJ1Y3QgcWNvbXRlZV9vYmpl
Y3RfaW52b2tlX2N0eCAqb2ljLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVk
IGludCBvYmplY3RfaWQpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHFjb210ZWUgKnFjb210ZWUg
PSB0ZWVfZ2V0X2RydmRhdGEob2ljLT5jdHgtPnRlZWRldik7DQo+ICsgICAgICAgc3RydWN0IHFj
b210ZWVfb2JqZWN0ICpvYmplY3QgX19mcmVlKGtmcmVlKTsNCj4gKw0KPiArICAgICAgIG9iamVj
dCA9IGt6YWxsb2Moc2l6ZW9mKCpvYmplY3QpLCBHRlBfS0VSTkVMKTsNCj4gKyAgICAgICBpZiAo
IW9iamVjdCkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiBOVUxMX1FDT01URUVfT0JKRUNUOw0K
PiArDQo+ICsgICAgICAgLyogSWYgZmFpbGVkLCAibm8tbmFtZSIuICovDQo+ICsgICAgICAgb2Jq
ZWN0LT5uYW1lID0ga2FzcHJpbnRmKEdGUF9LRVJORUwsICJxY29tdGVlLSV1Iiwgb2JqZWN0X2lk
KTsNCg0KV2hlcmUgZG9lcyBpdCBiZWNvbWUgIm5vLW5hbWUiIGlmIG9iamVjdC0+bmFtZSBpcyBO
VUxMPyBJcyBpdCB3b3J0aCBpdA0Kd2l0aCBhIHNwZWNpYWwgY2FzZSBmb3IgdGhlIHVubGlrZWx5
IGNvbmRpdGlvbiB0aGF0IGthc3ByaW50ZigpIGZhaWxzDQp3aGlsZSBubyBvdGhlciBtZW1vcnkg
YWxsb2NhdGlvbnMgZmFpbD8NCg0KPiArICAgICAgIFFDT01URUVfT0JKRUNUX1NFVChvYmplY3Qs
IFFDT01URUVfT0JKRUNUX1RZUEVfVEVFLCBvYmplY3RfaWQpOw0KPiArICAgICAgIGtyZWZfaW5p
dCgmb2JqZWN0LT5yZWZjb3VudCk7DQo+ICsgICAgICAgLyogQSBRVEVFIG9iamVjdCByZXF1aXJl
cyBhIGNvbnRleHQgZm9yIGFzeW5jIG9wZXJhdGlvbnMuICovDQo+ICsgICAgICAgb2JqZWN0LT5p
bmZvLnFjb210ZWVfYXN5bmNfY3R4ID0gcWNvbXRlZS0+Y3R4Ow0KPiArICAgICAgIHRlZWRldl9j
dHhfZ2V0KG9iamVjdC0+aW5mby5xY29tdGVlX2FzeW5jX2N0eCk7DQo+ICsNCj4gKyAgICAgICBy
ZXR1cm4gbm9fZnJlZV9wdHIob2JqZWN0KTsNCj4gK30NCj4gKw0KPiArdm9pZCBxY29tdGVlX3F0
ZWVfb2JqZWN0X2ZyZWUoc3RydWN0IHFjb210ZWVfb2JqZWN0ICpvYmplY3QpDQo+ICt7DQo+ICsg
ICAgICAgLyogU2VlIHFjb210ZWVfcXRlZV9vYmplY3RfYWxsb2MoKS4gKi8NCj4gKyAgICAgICB0
ZWVkZXZfY3R4X3B1dChvYmplY3QtPmluZm8ucWNvbXRlZV9hc3luY19jdHgpOw0KPiArDQo+ICsg
ICAgICAga2ZyZWUob2JqZWN0LT5uYW1lKTsNCj4gKyAgICAgICBrZnJlZShvYmplY3QpOw0KPiAr
fQ0KPiArDQo+ICtzdGF0aWMgdm9pZCBxY29tdGVlX29iamVjdF9yZWxlYXNlKHN0cnVjdCBrcmVm
ICpyZWZjb3VudCkNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVj
dDsNCj4gKyAgICAgICBjb25zdCBjaGFyICpuYW1lOw0KPiArDQo+ICsgICAgICAgb2JqZWN0ID0g
Y29udGFpbmVyX29mKHJlZmNvdW50LCBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QsIHJlZmNvdW50KTsN
Cj4gKw0KPiArICAgICAgIHN5bmNocm9uaXplX3JjdSgpOw0KDQpQbGVhc2UgYWRkIGEgY29tbWVu
dCBpbiB0aGUgY29kZSBleHBsYWluaW5nIHdoeSB0aGlzIGlzIG5lZWRlZC4NCg0KPiArDQo+ICsg
ICAgICAgc3dpdGNoICh0eXBlb2ZfcWNvbXRlZV9vYmplY3Qob2JqZWN0KSkgew0KPiArICAgICAg
IGNhc2UgUUNPTVRFRV9PQkpFQ1RfVFlQRV9URUU6DQo+ICsgICAgICAgICAgICAgICBxY29tdGVl
X3JlbGVhc2VfdGVlX29iamVjdChvYmplY3QpOw0KPiArDQo+ICsgICAgICAgICAgICAgICBicmVh
azsNCj4gKyAgICAgICBjYXNlIFFDT01URUVfT0JKRUNUX1RZUEVfQ0I6DQo+ICsgICAgICAgICAg
ICAgICBuYW1lID0gb2JqZWN0LT5uYW1lOw0KPiArDQo+ICsgICAgICAgICAgICAgICBpZiAob2Jq
ZWN0LT5vcHMtPnJlbGVhc2UpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdC0+b3Bz
LT5yZWxlYXNlKG9iamVjdCk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIGtmcmVlX2NvbnN0KG5h
bWUpOw0KPiArDQo+ICsgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAgICBjYXNlIFFDT01U
RUVfT0JKRUNUX1RZUEVfUk9PVDoNCj4gKyAgICAgICBjYXNlIFFDT01URUVfT0JKRUNUX1RZUEVf
TlVMTDoNCj4gKyAgICAgICBkZWZhdWx0Og0KPiArICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsg
ICAgICAgfQ0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfb2JqZWN0X2dldCgpIC0g
SW5jcmVhc2UgdGhlIG9iamVjdCdzIHJlZmVyZW5jZSBjb3VudC4NCj4gKyAqIEBvYmplY3Q6IG9i
amVjdCB0byBpbmNyZWFzZSB0aGUgcmVmZXJlbmNlIGNvdW50Lg0KPiArICovDQo+ICtpbnQgcWNv
bXRlZV9vYmplY3RfZ2V0KHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0KQ0KPiArew0KPiAr
ICAgICAgIGlmIChvYmplY3QgIT0gTlVMTF9RQ09NVEVFX09CSkVDVCAmJiBvYmplY3QgIT0gUk9P
VF9RQ09NVEVFX09CSkVDVCkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiBrcmVmX2dldF91bmxl
c3NfemVybygmb2JqZWN0LT5yZWZjb3VudCk7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gMDsNCj4g
K30NCj4gK0VYUE9SVF9TWU1CT0xfR1BMKHFjb210ZWVfb2JqZWN0X2dldCk7DQo+ICsNCj4gKy8q
Kg0KPiArICogcWNvbXRlZV9vYmplY3RfcHV0KCkgLSBEZWNyZWFzZSB0aGUgb2JqZWN0J3MgcmVm
ZXJlbmNlIGNvdW50Lg0KPiArICogQG9iamVjdDogb2JqZWN0IHRvIGRlY3JlYXNlIHRoZSByZWZl
cmVuY2UgY291bnQuDQo+ICsgKi8NCj4gK3ZvaWQgcWNvbXRlZV9vYmplY3RfcHV0KHN0cnVjdCBx
Y29tdGVlX29iamVjdCAqb2JqZWN0KQ0KPiArew0KPiArICAgICAgIGlmIChvYmplY3QgIT0gTlVM
TF9RQ09NVEVFX09CSkVDVCAmJiBvYmplY3QgIT0gUk9PVF9RQ09NVEVFX09CSkVDVCkNCj4gKyAg
ICAgICAgICAgICAgIGtyZWZfcHV0KCZvYmplY3QtPnJlZmNvdW50LCBxY29tdGVlX29iamVjdF9y
ZWxlYXNlKTsNCj4gK30NCj4gK0VYUE9SVF9TWU1CT0xfR1BMKHFjb210ZWVfb2JqZWN0X3B1dCk7
DQo+ICsNCj4gKy8qDQo+ICsgKiAnJ0xvY2FsIE9iamVjdCBUYWJsZScnLg0KPiArICogT2JqZWN0
cyBmcm9tIHRoZSBrZXJuZWwgZXhwb3J0ZWQgdG8gUVRFRSBhcmUgYXNzaWduZWQgYW4gSUQgYW5k
IHN0b3JlZA0KPiArICogaW4geGFfcWNvbV9sb2NhbF9vYmplY3RzIChhbHNvIGtub3duIGFzIHRo
ZSBrZXJuZWwgb2JqZWN0IHRhYmxlKS4NCj4gKyAqIFFURUUgdXNlcyB0aGlzIElEIHRvIHJlZmVy
ZW5jZSB0aGUgb2JqZWN0cyB1c2luZyBxY29tdGVlX2xvY2FsX29iamVjdF9nZXQoKS4NCj4gKyAq
Lw0KPiArc3RhdGljIERFRklORV9YQVJSQVlfQUxMT0MoeGFfcWNvbV9sb2NhbF9vYmplY3RzKTsN
Cg0KUGxlYXNlIG1vdmUgdGhpcyB0byB0aGUgdG9wIG9mIHRoaXMgZmlsZSB3aGVyZSB0aGUgb3Ro
ZXIgZ2xvYmFsDQp2YXJpYWJsZXMgYXJlIGtlcHQuIERvIHdlIGhhdmUvbmVlZCBhbnkgY2hlY2tz
IHRvIHNlZSB0aGUgdW5yZWxhdGVkDQpwcm9jZXNzZXMgZG9lc24ndCB1c2Ugb2JqZWN0cyBmcm9t
IGVhY2ggb3RoZXIgYmVjYXVzZSB0aGV5IG1hbmFnZSB0bw0KZ3Vlc3MgYW4gaWQ/DQoNCj4gKw0K
PiArc3RhdGljIGludCBxY29tdGVlX2lkeF9hbGxvYyh1MzIgKmlkeCwgc3RydWN0IHFjb210ZWVf
b2JqZWN0ICpvYmplY3QpDQo+ICt7DQo+ICsgICAgICAgc3RhdGljIHUzMiB4YV9sYXN0X2lkID0g
UUNPTVRFRV9PQkpFQ1RfSURfU1RBUlQ7DQo+ICsNCj4gKyAgICAgICAvKiBFdmVyeSBJRCBhbGxv
Y2F0ZWQgaGVyZSBoYXMgUUNPTVRFRV9NU0dfT0JKRUNUX05TX0JJVCBzZXQuICovDQo+ICsgICAg
ICAgcmV0dXJuIHhhX2FsbG9jX2N5Y2xpYygmeGFfcWNvbV9sb2NhbF9vYmplY3RzLCBpZHgsIG9i
amVjdCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhBX0xJTUlUKFFDT01URUVf
T0JKRUNUX0lEX1NUQVJULA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgUUNPTVRFRV9PQkpFQ1RfSURfRU5EKSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICZ4YV9sYXN0X2lkLCBHRlBfS0VSTkVMKTsNCj4gK30NCj4gKw0KPiArc3RydWN0IHFjb210
ZWVfb2JqZWN0ICpxY29tdGVlX2lkeF9lcmFzZSh1MzIgaWR4KQ0KPiArew0KPiArICAgICAgIGlm
IChpZHggPCBRQ09NVEVFX09CSkVDVF9JRF9TVEFSVCB8fCBpZHggPiBRQ09NVEVFX09CSkVDVF9J
RF9FTkQpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gTlVMTF9RQ09NVEVFX09CSkVDVDsNCj4g
Kw0KPiArICAgICAgIHJldHVybiB4YV9lcmFzZSgmeGFfcWNvbV9sb2NhbF9vYmplY3RzLCBpZHgp
Ow0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfb2JqZWN0X2lkX2dldCgpIC0gR2V0
IGFuIElEIGZvciBhbiBvYmplY3QgdG8gc2VuZCB0byBRVEVFLg0KPiArICogQG9iamVjdDogb2Jq
ZWN0IHRvIGFzc2lnbiBhbiBJRC4NCj4gKyAqIEBvYmplY3RfaWQ6IG9iamVjdCBJRC4NCj4gKyAq
DQo+ICsgKiBUaGlzIGlzIGNhbGxlZCBvbiB0aGUgcGF0aCB0byBRVEVFIHRvIGNvbnN0cnVjdCB0
aGUgbWVzc2FnZTsgc2VlDQo+ICsgKiBxY29tdGVlX3ByZXBhcmVfbXNnKCkgYW5kIHFjb210ZWVf
dXBkYXRlX21zZygpLg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAw
OyBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4NCj4gKyAqLw0KPiArc3RhdGljIGludCBxY29tdGVl
X29iamVjdF9pZF9nZXQoc3RydWN0IHFjb210ZWVfb2JqZWN0ICpvYmplY3QsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHVuc2lnbmVkIGludCAqb2JqZWN0X2lkKQ0KPiArew0K
PiArICAgICAgIHUzMiBpZHg7DQo+ICsNCj4gKyAgICAgICBzd2l0Y2ggKHR5cGVvZl9xY29tdGVl
X29iamVjdChvYmplY3QpKSB7DQo+ICsgICAgICAgY2FzZSBRQ09NVEVFX09CSkVDVF9UWVBFX0NC
Og0KPiArICAgICAgICAgICAgICAgaWYgKHFjb210ZWVfaWR4X2FsbG9jKCZpZHgsIG9iamVjdCkg
PCAwKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVOT1NQQzsNCj4gKw0KPiAr
ICAgICAgICAgICAgICAgKm9iamVjdF9pZCA9IGlkeDsNCj4gKw0KPiArICAgICAgICAgICAgICAg
YnJlYWs7DQo+ICsgICAgICAgY2FzZSBRQ09NVEVFX09CSkVDVF9UWVBFX1JPT1Q6DQo+ICsgICAg
ICAgY2FzZSBRQ09NVEVFX09CSkVDVF9UWVBFX1RFRToNCj4gKyAgICAgICAgICAgICAgICpvYmpl
Y3RfaWQgPSBvYmplY3QtPmluZm8ucXRlZV9pZDsNCj4gKw0KPiArICAgICAgICAgICAgICAgYnJl
YWs7DQo+ICsgICAgICAgY2FzZSBRQ09NVEVFX09CSkVDVF9UWVBFX05VTEw6DQo+ICsgICAgICAg
ICAgICAgICAqb2JqZWN0X2lkID0gUUNPTVRFRV9NU0dfT0JKRUNUX05VTEw7DQo+ICsNCj4gKyAg
ICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHJldHVybiAw
Ow0KPiArfQ0KPiArDQo+ICsvKiBSZWxlYXNlIG9iamVjdCBJRCBhc3NpZ25lZCBpbiBxY29tdGVl
X29iamVjdF9pZF9nZXQuICovDQo+ICtzdGF0aWMgdm9pZCBxY29tdGVlX29iamVjdF9pZF9wdXQo
dW5zaWduZWQgaW50IG9iamVjdF9pZCkNCj4gK3sNCj4gKyAgICAgICBxY29tdGVlX2lkeF9lcmFz
ZShvYmplY3RfaWQpOw0KPiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfbG9jYWxfb2Jq
ZWN0X2dldCgpIC0gR2V0IHRoZSBvYmplY3QgcmVmZXJlbmNlZCBieSB0aGUgSUQuDQo+ICsgKiBA
b2JqZWN0X2lkOiBvYmplY3QgSUQuDQo+ICsgKg0KPiArICogSXQgaXMgY2FsbGVkIG9uIHRoZSBw
YXRoIGZyb20gUVRFRS4NCj4gKyAqIEl0IGlzIGNhbGxlZCBvbiBiZWhhbGYgb2YgUVRFRSB0byBv
YnRhaW4gYW4gaW5zdGFuY2Ugb2YgYW4gb2JqZWN0DQo+ICsgKiBmb3IgYSBnaXZlbiBJRC4gSXQg
aW5jcmVhc2VzIHRoZSBvYmplY3QncyByZWZlcmVuY2UgY291bnQgb24gc3VjY2Vzcy4NCj4gKyAq
DQo+ICsgKiBSZXR1cm46IE9uIGVycm9yLCByZXR1cm5zICVOVUxMX1FDT01URUVfT0JKRUNULg0K
PiArICogICAgICAgICBPbiBzdWNjZXNzLCByZXR1cm5zIHRoZSBvYmplY3QuDQo+ICsgKi8NCj4g
K3N0YXRpYyBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKnFjb210ZWVfbG9jYWxfb2JqZWN0X2dldCh1
bnNpZ25lZCBpbnQgb2JqZWN0X2lkKQ0KPiArew0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX29i
amVjdCAqb2JqZWN0Ow0KPiArDQo+ICsgICAgICAgLyoNCj4gKyAgICAgICAgKiBUaGlzIGlzIG5v
dCBwcm90ZWN0ZWQgYnkgYW4gUkNVIHJlYWQgbG9jayBiZWNhdXNlIHdlIGFyZQ0KPiArICAgICAg
ICAqIGNvbmZpZGVudCB0aGF0IFFURUUgZG9lcyBub3QgaXNzdWUgYSBSRUxFQVNFIHJlcXVlc3Qg
YW5kDQo+ICsgICAgICAgICogcWNvbXRlZV9sb2NhbF9vYmplY3RfZ2V0KCkgY29uY3VycmVudGx5
Lg0KPiArICAgICAgICAqLw0KDQpJIHRoaW5rIGl0IHdvdWxkIGJlIGJldHRlciB0byBub3QgZGVw
ZW5kIG9uIHRoYXQuIEFuIFJDVSByZWFkIGxvY2sNCm11c3QgYmUgdmVyeSBjaGVhcCBjb21wYXJl
ZCB0byB3aGF0IHdlIGRvIGluIHRoaXMgY29udGV4dC4NCg0KPiArICAgICAgIG9iamVjdCA9IHhh
X2xvYWQoJnhhX3Fjb21fbG9jYWxfb2JqZWN0cywgb2JqZWN0X2lkKTsNCj4gKw0KPiArICAgICAg
IHFjb210ZWVfb2JqZWN0X2dldChvYmplY3QpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIG9iamVj
dDsNCj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX29iamVjdF91c2VyX2luaXQoKSAt
IEluaXRpYWxpemUgYW4gb2JqZWN0IGZvciB0aGUgdXNlci4NCj4gKyAqIEBvYmplY3Q6IG9iamVj
dCB0byBpbml0aWFsaXplLg0KPiArICogQG90OiB0eXBlIG9mIG9iamVjdCBhcyAmZW51bSBxY29t
dGVlX29iamVjdF90eXBlLg0KPiArICogQG9wczogaW5zdGFuY2Ugb2YgY2FsbGJhY2tzLg0KPiAr
ICogQGZtdDogbmFtZSBhc3NpZ25lZCB0byB0aGUgb2JqZWN0Lg0KPiArICoNCj4gKyAqIFJldHVy
bjogT24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4NCj4gKyAq
Lw0KPiAraW50IHFjb210ZWVfb2JqZWN0X3VzZXJfaW5pdChzdHJ1Y3QgcWNvbXRlZV9vYmplY3Qg
Km9iamVjdCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIHFjb210ZWVfb2Jq
ZWN0X3R5cGUgb3QsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210
ZWVfb2JqZWN0X29wZXJhdGlvbnMgKm9wcywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpmbXQsIC4uLikNCj4gK3sNCj4gKyAgICAgICB2YV9saXN0IGFwOw0KPiAr
ICAgICAgIGludCByZXQ7DQo+ICsNCj4gKyAgICAgICBrcmVmX2luaXQoJm9iamVjdC0+cmVmY291
bnQpOw0KPiArICAgICAgIFFDT01URUVfT0JKRUNUX1NFVChvYmplY3QsIFFDT01URUVfT0JKRUNU
X1RZUEVfTlVMTCk7DQo+ICsNCj4gKyAgICAgICB2YV9zdGFydChhcCwgZm10KTsNCj4gKyAgICAg
ICBzd2l0Y2ggKG90KSB7DQo+ICsgICAgICAgY2FzZSBRQ09NVEVFX09CSkVDVF9UWVBFX05VTEw6
DQo+ICsgICAgICAgICAgICAgICByZXQgPSAwOw0KPiArDQo+ICsgICAgICAgICAgICAgICBicmVh
azsNCj4gKyAgICAgICBjYXNlIFFDT01URUVfT0JKRUNUX1RZUEVfQ0I6DQo+ICsgICAgICAgICAg
ICAgICBvYmplY3QtPm9wcyA9IG9wczsNCj4gKyAgICAgICAgICAgICAgIGlmICghb2JqZWN0LT5v
cHMtPmRpc3BhdGNoKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLUVJTlZBTDsN
Cj4gKw0KPiArICAgICAgICAgICAgICAgLyogSWYgZmFpbGVkLCAibm8tbmFtZSIuICovDQo+ICsg
ICAgICAgICAgICAgICBvYmplY3QtPm5hbWUgPSBrdmFzcHJpbnRmX2NvbnN0KEdGUF9LRVJORUws
IGZtdCwgYXApOw0KPiArICAgICAgICAgICAgICAgUUNPTVRFRV9PQkpFQ1RfU0VUKG9iamVjdCwg
UUNPTVRFRV9PQkpFQ1RfVFlQRV9DQik7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIHJldCA9IDA7
DQo+ICsgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAgICBjYXNlIFFDT01URUVfT0JKRUNU
X1RZUEVfUk9PVDoNCj4gKyAgICAgICBjYXNlIFFDT01URUVfT0JKRUNUX1RZUEVfVEVFOg0KPiAr
ICAgICAgIGRlZmF1bHQ6DQo+ICsgICAgICAgICAgICAgICByZXQgPSAtRUlOVkFMOw0KPiArICAg
ICAgIH0NCj4gKyAgICAgICB2YV9lbmQoYXApOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJldDsN
Cj4gK30NCj4gK0VYUE9SVF9TWU1CT0xfR1BMKHFjb210ZWVfb2JqZWN0X3VzZXJfaW5pdCk7DQo+
ICsNCj4gKy8qKg0KPiArICogcWNvbXRlZV9vYmplY3RfdHlwZSgpIC0gUmV0dXJucyB0aGUgdHlw
ZSBvZiBvYmplY3QgcmVwcmVzZW50ZWQgYnkgYW4gSUQuDQo+ICsgKiBAb2JqZWN0X2lkOiBvYmpl
Y3QgSUQgZm9yIHRoZSBvYmplY3QuDQo+ICsgKg0KPiArICogVGhpcyBpcyBzaW1pbGFyIHRvIHR5
cGVvZl9xY29tdGVlX29iamVjdCgpLCBidXQgaW5zdGVhZCBvZiByZWNlaXZpbmcgYW4NCj4gKyAq
IG9iamVjdCBhcyBhbiBhcmd1bWVudCwgaXQgcmVjZWl2ZXMgYW4gb2JqZWN0IElELiBJdCBpcyB1
c2VkIGludGVybmFsbHkNCj4gKyAqIG9uIHRoZSByZXR1cm4gcGF0aCBmcm9tIFFURUUuDQo+ICsg
Kg0KPiArICogUmV0dXJuOiBSZXR1cm5zIHRoZSB0eXBlIG9mIG9iamVjdCByZWZlcmVuY2VkIGJ5
IEBvYmplY3RfaWQuDQo+ICsgKi8NCj4gK3N0YXRpYyBlbnVtIHFjb210ZWVfb2JqZWN0X3R5cGUg
cWNvbXRlZV9vYmplY3RfdHlwZSh1bnNpZ25lZCBpbnQgb2JqZWN0X2lkKQ0KPiArew0KPiArICAg
ICAgIGlmIChvYmplY3RfaWQgPT0gUUNPTVRFRV9NU0dfT0JKRUNUX05VTEwpDQo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gUUNPTVRFRV9PQkpFQ1RfVFlQRV9OVUxMOw0KPiArDQo+ICsgICAgICAg
aWYgKG9iamVjdF9pZCAmIFFDT01URUVfTVNHX09CSkVDVF9OU19CSVQpDQo+ICsgICAgICAgICAg
ICAgICByZXR1cm4gUUNPTVRFRV9PQkpFQ1RfVFlQRV9DQjsNCj4gKw0KPiArICAgICAgIHJldHVy
biBRQ09NVEVFX09CSkVDVF9UWVBFX1RFRTsNCj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29t
dGVlX29iamVjdF9xdGVlX2luaXQoKSAtIEluaXRpYWxpemUgYW4gb2JqZWN0IGZvciBRVEVFLg0K
PiArICogQG9iamVjdDogb2JqZWN0IHJldHVybmVkLg0KPiArICogQG9iamVjdF9pZDogb2JqZWN0
IElEIHJlY2VpdmVkIGZyb20gUVRFRS4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIGZhaWx1cmUs
IHJldHVybnMgPCAwIGFuZCBzZXRzIEBvYmplY3QgdG8gJU5VTExfUUNPTVRFRV9PQkpFQ1QuDQo+
ICsgKiAgICAgICAgIE9uIHN1Y2Nlc3MsIHJldHVybnMgMA0KPiArICovDQo+ICtzdGF0aWMgaW50
IHFjb210ZWVfb2JqZWN0X3F0ZWVfaW5pdChzdHJ1Y3QgcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0
eCAqb2ljLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcWNv
bXRlZV9vYmplY3QgKipvYmplY3QsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHVuc2lnbmVkIGludCBvYmplY3RfaWQpDQo+ICt7DQo+ICsgICAgICAgaW50IHJldCA9IDA7
DQo+ICsNCj4gKyAgICAgICBzd2l0Y2ggKHFjb210ZWVfb2JqZWN0X3R5cGUob2JqZWN0X2lkKSkg
ew0KPiArICAgICAgIGNhc2UgUUNPTVRFRV9PQkpFQ1RfVFlQRV9OVUxMOg0KPiArICAgICAgICAg
ICAgICAgKm9iamVjdCA9IE5VTExfUUNPTVRFRV9PQkpFQ1Q7DQo+ICsNCj4gKyAgICAgICAgICAg
ICAgIGJyZWFrOw0KPiArICAgICAgIGNhc2UgUUNPTVRFRV9PQkpFQ1RfVFlQRV9DQjoNCj4gKyAg
ICAgICAgICAgICAgICpvYmplY3QgPSBxY29tdGVlX2xvY2FsX29iamVjdF9nZXQob2JqZWN0X2lk
KTsNCj4gKyAgICAgICAgICAgICAgIGlmICgqb2JqZWN0ID09IE5VTExfUUNPTVRFRV9PQkpFQ1Qp
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IC1FSU5WQUw7DQo+ICsNCj4gKyAgICAg
ICAgICAgICAgIGJyZWFrOw0KPiArDQo+ICsgICAgICAgZGVmYXVsdDogLyogUUNPTVRFRV9PQkpF
Q1RfVFlQRV9URUUgKi8NCj4gKyAgICAgICAgICAgICAgICpvYmplY3QgPSBxY29tdGVlX3F0ZWVf
b2JqZWN0X2FsbG9jKG9pYywgb2JqZWN0X2lkKTsNCj4gKyAgICAgICAgICAgICAgIGlmICgqb2Jq
ZWN0ID09IE5VTExfUUNPTVRFRV9PQkpFQ1QpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJl
dCA9IC1FTk9NRU07DQo+ICsNCj4gKyAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgIH0N
Cj4gKw0KPiArICAgICAgIHJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKy8qDQo+ICsgKiAnJ01h
cnNoYWxpbmcgQVBJJycNCj4gKyAqIHFjb210ZWVfcHJlcGFyZV9tc2cgIC0gUHJlcGFyZSB0aGUg
aW5ib3VuZCBidWZmZXIgZm9yIHNlbmRpbmcgdG8gUVRFRQ0KPiArICogcWNvbXRlZV91cGRhdGVf
YXJncyAgLSBQYXJzZSB0aGUgUVRFRSByZXNwb25zZSBpbiB0aGUgaW5ib3VuZCBidWZmZXINCj4g
KyAqIHFjb210ZWVfcHJlcGFyZV9hcmdzIC0gUGFyc2UgdGhlIFFURUUgcmVxdWVzdCBmcm9tIHRo
ZSBvdXRib3VuZCBidWZmZXINCj4gKyAqIHFjb210ZWVfdXBkYXRlX21zZyAgIC0gVXBkYXRlIHRo
ZSBvdXRib3VuZCBidWZmZXIgd2l0aCB0aGUgcmVzcG9uc2UgZm9yIFFURUUNCj4gKyAqLw0KPiAr
DQo+ICtzdGF0aWMgaW50IHFjb210ZWVfcHJlcGFyZV9tc2coc3RydWN0IHFjb210ZWVfb2JqZWN0
X2ludm9rZV9jdHggKm9pYywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBxY29tdGVlX29iamVjdCAqb2JqZWN0LCB1MzIgb3AsDQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9hcmcgKnUpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0
IHFjb210ZWVfbXNnX29iamVjdF9pbnZva2UgKm1zZzsNCj4gKyAgICAgICB1bnNpZ25lZCBpbnQg
b2JqZWN0X2lkOw0KPiArICAgICAgIGludCBpLCBpYiwgb2IsIGlvLCBvbzsNCj4gKyAgICAgICBz
aXplX3Qgb2ZmOw0KPiArDQo+ICsgICAgICAgLyogVXNlIHRoZSBpbnB1dCBtZXNzYWdlIGJ1ZmZl
ciBpbiAnb2ljJy4gKi8NCj4gKyAgICAgICBtc2cgPSBvaWMtPmluX21zZy5hZGRyOw0KPiArDQo+
ICsgICAgICAgLyogU3RhcnQgb2Zmc2V0IGluIGEgbWVzc2FnZSBmb3IgYnVmZmVyIGFyZ3VtZW50
cy4gKi8NCj4gKyAgICAgICBvZmYgPSBxY29tdGVlX21zZ19idWZmZXJfYXJncyhzdHJ1Y3QgcWNv
bXRlZV9tc2dfb2JqZWN0X2ludm9rZSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBxY29tdGVlX2FyZ3NfbGVuKHUpKTsNCj4gKw0KPiArICAgICAgIC8qIEdldCB0aGUg
SUQgb2YgdGhlIG9iamVjdCBiZWluZyBpbnZva2VkLiAqLw0KPiArICAgICAgIGlmIChxY29tdGVl
X29iamVjdF9pZF9nZXQob2JqZWN0LCAmb2JqZWN0X2lkKSkNCj4gKyAgICAgICAgICAgICAgIHJl
dHVybiAtRU5PU1BDOw0KPiArDQo+ICsgICAgICAgaWIgPSAwOw0KPiArICAgICAgIHFjb210ZWVf
YXJnX2Zvcl9lYWNoX2lucHV0X2J1ZmZlcihpLCB1KSB7DQo+ICsgICAgICAgICAgICAgICB2b2lk
ICpwdHI7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIC8qIE92ZXJmbG93IGFscmVhZHkgY2hlY2tl
ZCBpbiBxY29tdGVlX21zZ19idWZmZXJzX2FsbG9jKCkuICovDQo+ICsgICAgICAgICAgICAgICBt
c2ctPmFyZ3NbaWJdLmIub2Zmc2V0ID0gb2ZmOw0KPiArICAgICAgICAgICAgICAgbXNnLT5hcmdz
W2liXS5iLnNpemUgPSB1W2ldLmIuc2l6ZTsNCj4gKw0KPiArICAgICAgICAgICAgICAgcHRyID0g
cWNvbXRlZV9tc2dfb2Zmc2V0X3RvX3B0cihtc2csIG9mZik7DQo+ICsgICAgICAgICAgICAgICAv
KiBVc2Vyc3BhY2UgY2xpZW50IG9yIGtlcm5lbCBjbGllbnQhPyAqLw0KPiArICAgICAgICAgICAg
ICAgaWYgKCEodVtpXS5mbGFncyAmIFFDT01URUVfQVJHX0ZMQUdTX1VBRERSKSkNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgbWVtY3B5KHB0ciwgdVtpXS5iLmFkZHIsIHVbaV0uYi5zaXplKTsN
Cj4gKyAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvcHlfZnJvbV91c2VyKHB0ciwgdVtpXS5iLnVh
ZGRyLCB1W2ldLmIuc2l6ZSkpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtRUlO
VkFMOw0KPiArDQo+ICsgICAgICAgICAgICAgICBvZmYgKz0gcWNvbXRlZV9tc2dfb2Zmc2V0X2Fs
aWduKHVbaV0uYi5zaXplKTsNCj4gKyAgICAgICAgICAgICAgIGliKys7DQo+ICsgICAgICAgfQ0K
PiArDQo+ICsgICAgICAgb2IgPSBpYjsNCj4gKyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF9v
dXRwdXRfYnVmZmVyKGksIHUpIHsNCj4gKyAgICAgICAgICAgICAgIC8qIE92ZXJmbG93IGFscmVh
ZHkgY2hlY2tlZCBpbiBxY29tdGVlX21zZ19idWZmZXJzX2FsbG9jKCkuICovDQo+ICsgICAgICAg
ICAgICAgICBtc2ctPmFyZ3Nbb2JdLmIub2Zmc2V0ID0gb2ZmOw0KPiArICAgICAgICAgICAgICAg
bXNnLT5hcmdzW29iXS5iLnNpemUgPSB1W2ldLmIuc2l6ZTsNCj4gKw0KPiArICAgICAgICAgICAg
ICAgb2ZmICs9IHFjb210ZWVfbXNnX29mZnNldF9hbGlnbih1W2ldLmIuc2l6ZSk7DQo+ICsgICAg
ICAgICAgICAgICBvYisrOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIGlvID0gb2I7DQo+
ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfaW5wdXRfb2JqZWN0KGksIHUpIHsNCj4gKyAg
ICAgICAgICAgICAgIGlmIChxY29tdGVlX29iamVjdF9pZF9nZXQodVtpXS5vLCAmbXNnLT5hcmdz
W2lvXS5vKSkgew0KPiArICAgICAgICAgICAgICAgICAgICAgICAvKiBQdXQgd2hhdGV2ZXIgd2Ug
Z290LiAqLw0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9pZF9wdXQo
b2JqZWN0X2lkKTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpby0tOyBpbyA+PSBv
YjsgaW8tLSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVj
dF9pZF9wdXQobXNnLT5hcmdzW2lvXS5vKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgICAgICAg
ICByZXR1cm4gLUVOT1NQQzsNCj4gKyAgICAgICAgICAgICAgIH0NCj4gKw0KPiArICAgICAgICAg
ICAgICAgaW8rKzsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBvbyA9IGlvOw0KPiArICAg
ICAgIHFjb210ZWVfYXJnX2Zvcl9lYWNoX291dHB1dF9vYmplY3QoaSwgdSkNCj4gKyAgICAgICAg
ICAgICAgIG9vKys7DQo+ICsNCj4gKyAgICAgICAvKiBTZXQgb2JqZWN0LCBvcGVyYXRpb24sIGFu
ZCBhcmd1bWVudCBjb3VudHMuICovDQo+ICsgICAgICAgcWNvbXRlZV9tc2dfaW5pdChtc2csIG9i
amVjdF9pZCwgb3AsIGliLCBvYiwgaW8sIG9vKTsNCj4gKw0KPiArICAgICAgIHJldHVybiAwOw0K
PiArfQ0KPiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfdXBkYXRlX2FyZ3MoKSAtIFBhcnNlIHRo
ZSBRVEVFIHJlc3BvbnNlIGluIHRoZSBpbmJvdW5kIGJ1ZmZlci4NCj4gKyAqIEB1OiBhcnJheSBv
ZiBhcmd1bWVudHMgZm9yIHRoZSBpbnZvY2F0aW9uLg0KPiArICogQG9pYzogY29udGV4dCB0byB1
c2UgZm9yIHRoZSBpbnZvY2F0aW9uLg0KPiArICoNCj4gKyAqIEB1IG11c3QgYmUgdGhlIHNhbWUg
YXMgdGhlIG9uZSB1c2VkIGluIHFjb210ZWVfcHJlcGFyZV9tc2coKSB3aGVuDQo+ICsgKiBpbml0
aWFsaXppbmcgdGhlIGluYm91bmQgYnVmZmVyLg0KPiArICoNCj4gKyAqIE9uIGZhaWx1cmUsIGl0
IGNvbnRpbnVlcyBwcm9jZXNzaW5nIHRoZSBRVEVFIG1lc3NhZ2UuIFRoZSBjYWxsZXIgc2hvdWxk
DQo+ICsgKiBkbyB0aGUgbmVjZXNzYXJ5IGNsZWFudXAsIGluY2x1ZGluZyBjYWxsaW5nIHFjb210
ZWVfb2JqZWN0X3B1dCgpDQo+ICsgKiBvbiB0aGUgb3V0cHV0IG9iamVjdHMuDQo+ICsgKg0KPiAr
ICogUmV0dXJuOiBPbiBzdWNjZXNzLCByZXR1cm5zIDA7IG9uIGZhaWx1cmUsIHJldHVybnMgPCAw
Lg0KPiArICovDQo+ICtzdGF0aWMgaW50IHFjb210ZWVfdXBkYXRlX2FyZ3Moc3RydWN0IHFjb210
ZWVfYXJnICp1LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210
ZWVfb2JqZWN0X2ludm9rZV9jdHggKm9pYykNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRl
ZV9tc2dfb2JqZWN0X2ludm9rZSAqbXNnOw0KPiArICAgICAgIGludCBpLCBpYiwgb2IsIGlvLCBv
bzsNCj4gKyAgICAgICBpbnQgcmV0ID0gMDsNCj4gKw0KPiArICAgICAgIC8qIFVzZSB0aGUgaW5w
dXQgbWVzc2FnZSBidWZmZXIgaW4gJ29pYycuICovDQo+ICsgICAgICAgbXNnID0gb2ljLT5pbl9t
c2cuYWRkcjsNCj4gKw0KPiArICAgICAgIGliID0gMDsNCj4gKyAgICAgICBxY29tdGVlX2FyZ19m
b3JfZWFjaF9pbnB1dF9idWZmZXIoaSwgdSkNCj4gKyAgICAgICAgICAgICAgIGliKys7DQo+ICsN
Cj4gKyAgICAgICBvYiA9IGliOw0KPiArICAgICAgIHFjb210ZWVfYXJnX2Zvcl9lYWNoX291dHB1
dF9idWZmZXIoaSwgdSkgew0KPiArICAgICAgICAgICAgICAgdm9pZCAqcHRyOw0KPiArDQo+ICsg
ICAgICAgICAgICAgICAvKiBRVEVFIGNhbiBvdmVycmlkZSB0aGUgc2l6ZSB0byBhIHNtYWxsZXIg
dmFsdWUuICovDQo+ICsgICAgICAgICAgICAgICB1W2ldLmIuc2l6ZSA9IG1zZy0+YXJnc1tvYl0u
Yi5zaXplOw0KPiArDQo+ICsgICAgICAgICAgICAgICBwdHIgPSBxY29tdGVlX21zZ19vZmZzZXRf
dG9fcHRyKG1zZywgbXNnLT5hcmdzW29iXS5iLm9mZnNldCk7DQo+ICsgICAgICAgICAgICAgICAv
KiBVc2Vyc3BhY2UgY2xpZW50IG9yIGtlcm5lbCBjbGllbnQhPyAqLw0KPiArICAgICAgICAgICAg
ICAgaWYgKCEodVtpXS5mbGFncyAmIFFDT01URUVfQVJHX0ZMQUdTX1VBRERSKSkNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgbWVtY3B5KHVbaV0uYi5hZGRyLCBwdHIsIHVbaV0uYi5zaXplKTsN
Cj4gKyAgICAgICAgICAgICAgIGVsc2UgaWYgKGNvcHlfdG9fdXNlcih1W2ldLmIudWFkZHIsIHB0
ciwgdVtpXS5iLnNpemUpKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICByZXQgPSAtRUlOVkFM
Ow0KPiArDQo+ICsgICAgICAgICAgICAgICBvYisrOw0KPiArICAgICAgIH0NCj4gKw0KPiArICAg
ICAgIGlvID0gb2I7DQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfaW5wdXRfb2JqZWN0
KGksIHUpDQo+ICsgICAgICAgICAgICAgICBpbysrOw0KPiArDQo+ICsgICAgICAgb28gPSBpbzsN
Cj4gKyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF9vdXRwdXRfb2JqZWN0KGksIHUpIHsNCj4g
KyAgICAgICAgICAgICAgIGlmIChxY29tdGVlX29iamVjdF9xdGVlX2luaXQob2ljLCAmdVtpXS5v
LCBtc2ctPmFyZ3Nbb29dLm8pKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICByZXQgPSAtRUlO
VkFMOw0KPiArDQo+ICsgICAgICAgICAgICAgICBvbysrOw0KPiArICAgICAgIH0NCj4gKw0KPiAr
ICAgICAgIHJldHVybiByZXQ7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogcWNvbXRlZV9wcmVw
YXJlX2FyZ3MoKSAtIFBhcnNlIHRoZSBRVEVFIHJlcXVlc3QgZnJvbSB0aGUgb3V0Ym91bmQgYnVm
ZmVyLg0KPiArICogQG9pYzogY29udGV4dCB0byB1c2UgZm9yIHRoZSBpbnZvY2F0aW9uLg0KPiAr
ICoNCj4gKyAqIEl0IGluaXRpYWxpemVzICZxY29tdGVlX29iamVjdF9pbnZva2VfY3R4LT51IGJh
c2VkIG9uIHRoZSBRVEVFIHJlcXVlc3QgaW4NCj4gKyAqIHRoZSBvdXRib3VuZCBidWZmZXIuIEl0
IHNldHMgJVFDT01URUVfQVJHX1RZUEVfSU5WIGF0IHRoZSBlbmQgb2YgdGhlIGFycmF5Lg0KPiAr
ICoNCj4gKyAqIE9uIGZhaWx1cmUsIGl0IGNvbnRpbnVlcyBwcm9jZXNzaW5nIHRoZSBRVEVFIG1l
c3NhZ2UuIFRoZSBjYWxsZXIgc2hvdWxkDQo+ICsgKiBkbyB0aGUgbmVjZXNzYXJ5IGNsZWFudXAs
IGluY2x1ZGluZyBjYWxsaW5nIHFjb210ZWVfb2JqZWN0X3B1dCgpDQo+ICsgKiBvbiB0aGUgaW5w
dXQgb2JqZWN0cy4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMDsg
b24gZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK3N0YXRpYyBpbnQgcWNvbXRlZV9w
cmVwYXJlX2FyZ3Moc3RydWN0IHFjb210ZWVfb2JqZWN0X2ludm9rZV9jdHggKm9pYykNCj4gK3sN
Cj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9tc2dfY2FsbGJhY2sgKm1zZzsNCj4gKyAgICAgICB1
bmlvbiBxY29tdGVlX21zZ19hcmcgKmFyZzsNCj4gKyAgICAgICBpbnQgaSwgcmV0ID0gMDsNCj4g
Kw0KPiArICAgICAgIC8qIFVzZSB0aGUgb3V0cHV0IG1lc3NhZ2UgYnVmZmVyIGluICdvaWMnLiAq
Lw0KPiArICAgICAgIG1zZyA9IG9pYy0+b3V0X21zZy5hZGRyOw0KPiArDQo+ICsgICAgICAgcWNv
bXRlZV9tc2dfZm9yX2VhY2hfaW5wdXRfYnVmZmVyKGksIG1zZykgew0KPiArICAgICAgICAgICAg
ICAgYXJnID0gJm1zZy0+YXJnc1tpXTsNCj4gKyAgICAgICAgICAgICAgIG9pYy0+dVtpXS5iLmFk
ZHIgPQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX21zZ19vZmZzZXRfdG9fcHRy
KG1zZywgYXJnLT5iLm9mZnNldCk7DQo+ICsgICAgICAgICAgICAgICBvaWMtPnVbaV0uYi5zaXpl
ID0gYXJnLT5iLnNpemU7DQo+ICsgICAgICAgICAgICAgICBvaWMtPnVbaV0udHlwZSA9IFFDT01U
RUVfQVJHX1RZUEVfSUI7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcWNvbXRlZV9tc2df
Zm9yX2VhY2hfb3V0cHV0X2J1ZmZlcihpLCBtc2cpIHsNCj4gKyAgICAgICAgICAgICAgIGFyZyA9
ICZtc2ctPmFyZ3NbaV07DQo+ICsgICAgICAgICAgICAgICBvaWMtPnVbaV0uYi5hZGRyID0NCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgcWNvbXRlZV9tc2dfb2Zmc2V0X3RvX3B0cihtc2csIGFy
Zy0+Yi5vZmZzZXQpOw0KPiArICAgICAgICAgICAgICAgb2ljLT51W2ldLmIuc2l6ZSA9IGFyZy0+
Yi5zaXplOw0KPiArICAgICAgICAgICAgICAgb2ljLT51W2ldLnR5cGUgPSBRQ09NVEVFX0FSR19U
WVBFX09COw0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIHFjb210ZWVfbXNnX2Zvcl9lYWNo
X2lucHV0X29iamVjdChpLCBtc2cpIHsNCj4gKyAgICAgICAgICAgICAgIGlmIChxY29tdGVlX29i
amVjdF9xdGVlX2luaXQob2ljLCAmb2ljLT51W2ldLm8sIG1zZy0+YXJnc1tpXS5vKSkNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgcmV0ID0gLUVJTlZBTDsNCj4gKw0KPiArICAgICAgICAgICAg
ICAgb2ljLT51W2ldLnR5cGUgPSBRQ09NVEVFX0FSR19UWVBFX0lPOw0KPiArICAgICAgIH0NCj4g
Kw0KPiArICAgICAgIHFjb210ZWVfbXNnX2Zvcl9lYWNoX291dHB1dF9vYmplY3QoaSwgbXNnKQ0K
PiArICAgICAgICAgICAgICAgb2ljLT51W2ldLnR5cGUgPSBRQ09NVEVFX0FSR19UWVBFX09POw0K
PiArDQo+ICsgICAgICAgLyogRW5kIG9mIEFyZ3VtZW50cy4gKi8NCj4gKyAgICAgICBvaWMtPnVb
aV0udHlwZSA9IFFDT01URUVfQVJHX1RZUEVfSU5WOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHJl
dDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBxY29tdGVlX3VwZGF0ZV9tc2coc3RydWN0IHFj
b210ZWVfb2JqZWN0X2ludm9rZV9jdHggKm9pYykNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNv
bXRlZV9tc2dfY2FsbGJhY2sgKm1zZzsNCj4gKyAgICAgICBpbnQgaSwgaWIsIG9iLCBpbywgb287
DQo+ICsNCj4gKyAgICAgICAvKiBVc2UgdGhlIG91dHB1dCBtZXNzYWdlIGJ1ZmZlciBpbiAnb2lj
Jy4gKi8NCj4gKyAgICAgICBtc2cgPSBvaWMtPm91dF9tc2cuYWRkcjsNCj4gKw0KPiArICAgICAg
IGliID0gMDsNCj4gKyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF9pbnB1dF9idWZmZXIoaSwg
b2ljLT51KQ0KPiArICAgICAgICAgICAgICAgaWIrKzsNCj4gKw0KPiArICAgICAgIG9iID0gaWI7
DQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfb3V0cHV0X2J1ZmZlcihpLCBvaWMtPnUp
IHsNCj4gKyAgICAgICAgICAgICAgIC8qIE9ubHkgcmVkdWNlIHNpemU7IG5ldmVyIGluY3JlYXNl
IGl0LiAqLw0KPiArICAgICAgICAgICAgICAgaWYgKG1zZy0+YXJnc1tvYl0uYi5zaXplIDwgb2lj
LT51W2ldLmIuc2l6ZSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FSU5WQUw7
DQo+ICsNCj4gKyAgICAgICAgICAgICAgIG1zZy0+YXJnc1tvYl0uYi5zaXplID0gb2ljLT51W2ld
LmIuc2l6ZTsNCj4gKyAgICAgICAgICAgICAgIG9iKys7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsg
ICAgICAgaW8gPSBvYjsNCj4gKyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF9pbnB1dF9vYmpl
Y3QoaSwgb2ljLT51KQ0KPiArICAgICAgICAgICAgICAgaW8rKzsNCj4gKw0KPiArICAgICAgIG9v
ID0gaW87DQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfb3V0cHV0X29iamVjdChpLCBv
aWMtPnUpIHsNCj4gKyAgICAgICAgICAgICAgIGlmIChxY29tdGVlX29iamVjdF9pZF9nZXQob2lj
LT51W2ldLm8sICZtc2ctPmFyZ3Nbb29dLm8pKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IC8qIFB1dCB3aGF0ZXZlciB3ZSBnb3QuICovDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGZv
ciAob28tLTsgb28gPj0gaW87IG9vLS0pDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgcWNvbXRlZV9vYmplY3RfaWRfcHV0KG1zZy0+YXJnc1tvb10ubyk7DQo+ICsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9TUEM7DQo+ICsgICAgICAgICAgICAgICB9DQo+
ICsNCj4gKyAgICAgICAgICAgICAgIG9vKys7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAg
cmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gKy8qIEludm9rZSBhIGNhbGxiYWNrIG9iamVjdC4gKi8N
Cj4gK3N0YXRpYyB2b2lkIHFjb210ZWVfY2Jfb2JqZWN0X2ludm9rZShzdHJ1Y3QgcWNvbXRlZV9v
YmplY3RfaW52b2tlX2N0eCAqb2ljLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHFjb210ZWVfbXNnX2NhbGxiYWNrICptc2cpDQo+ICt7DQo+ICsgICAgICAg
aW50IGksIGVycm5vOw0KPiArICAgICAgIHUzMiBvcDsNCj4gKw0KPiArICAgICAgIC8qIEdldCB0
aGUgb2JqZWN0IGJlaW5nIGludm9rZWQuICovDQo+ICsgICAgICAgdW5zaWduZWQgaW50IG9iamVj
dF9pZCA9IG1zZy0+Y3h0Ow0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0
Ow0KPiArDQo+ICsgICAgICAgLyogUVRFRSBjYW5ub3QgaW52b2tlIGEgTlVMTCBvYmplY3Qgb3Ig
b2JqZWN0cyBpdCBob3N0cy4gKi8NCj4gKyAgICAgICBpZiAocWNvbXRlZV9vYmplY3RfdHlwZShv
YmplY3RfaWQpID09IFFDT01URUVfT0JKRUNUX1RZUEVfTlVMTCB8fA0KPiArICAgICAgICAgICBx
Y29tdGVlX29iamVjdF90eXBlKG9iamVjdF9pZCkgPT0gUUNPTVRFRV9PQkpFQ1RfVFlQRV9URUUp
IHsNCj4gKyAgICAgICAgICAgICAgIGVycm5vID0gLUVJTlZBTDsNCj4gKyAgICAgICAgICAgICAg
IGdvdG8gb3V0Ow0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIG9iamVjdCA9IHFjb210ZWVf
bG9jYWxfb2JqZWN0X2dldChvYmplY3RfaWQpOw0KPiArICAgICAgIGlmIChvYmplY3QgPT0gTlVM
TF9RQ09NVEVFX09CSkVDVCkgew0KPiArICAgICAgICAgICAgICAgZXJybm8gPSAtRUlOVkFMOw0K
PiArICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAg
b2ljLT5vYmplY3QgPSBvYmplY3Q7DQo+ICsNCj4gKyAgICAgICAvKiBGaWx0ZXIgYml0cyB1c2Vk
IGJ5IHRyYW5zcG9ydC4gKi8NCj4gKyAgICAgICBvcCA9IG1zZy0+b3AgJiBRQ09NVEVFX01TR19P
QkpFQ1RfT1BfTUFTSzsNCj4gKw0KPiArICAgICAgIHN3aXRjaCAob3ApIHsNCj4gKyAgICAgICBj
YXNlIFFDT01URUVfTVNHX09CSkVDVF9PUF9SRUxFQVNFOg0KPiArICAgICAgICAgICAgICAgcWNv
bXRlZV9vYmplY3RfaWRfcHV0KG9iamVjdF9pZCk7DQo+ICsgICAgICAgICAgICAgICBxY29tdGVl
X29iamVjdF9wdXQob2JqZWN0KTsNCj4gKyAgICAgICAgICAgICAgIGVycm5vID0gMDsNCj4gKw0K
PiArICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAgICAgY2FzZSBRQ09NVEVFX01TR19PQkpF
Q1RfT1BfUkVUQUlOOg0KPiArICAgICAgICAgICAgICAgcWNvbXRlZV9vYmplY3RfZ2V0KG9iamVj
dCk7DQo+ICsgICAgICAgICAgICAgICBlcnJubyA9IDA7DQo+ICsNCj4gKyAgICAgICAgICAgICAg
IGJyZWFrOw0KPiArICAgICAgIGRlZmF1bHQ6DQo+ICsgICAgICAgICAgICAgICBlcnJubyA9IHFj
b210ZWVfcHJlcGFyZV9hcmdzKG9pYyk7DQo+ICsgICAgICAgICAgICAgICBpZiAoZXJybm8pIHsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgLyogUmVsZWFzZSBhbnkgb2JqZWN0IHRoYXQgYXJy
aXZlZCBhcyBpbnB1dC4gKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcWNvbXRlZV9hcmdf
Zm9yX2VhY2hfaW5wdXRfYnVmZmVyKGksIG9pYy0+dSkNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQob2ljLT51W2ldLm8pOw0KPiArDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgfQ0KPiArDQo+ICsg
ICAgICAgICAgICAgICBlcnJubyA9IG9iamVjdC0+b3BzLT5kaXNwYXRjaChvaWMsIG9iamVjdCwg
b3AsIG9pYy0+dSk7DQo+ICsgICAgICAgICAgICAgICBpZiAoIWVycm5vKSB7DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIC8qIE9uIHN1Y2Nlc3MsIG5vdGlmeSBhdCB0aGUgYXBwcm9wcmlhdGUg
dGltZS4gKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgb2ljLT5mbGFncyB8PSBRQ09NVEVF
X09JQ19GTEFHX05PVElGWTsNCj4gKyAgICAgICAgICAgICAgIH0NCj4gKyAgICAgICB9DQo+ICsN
Cj4gK291dDoNCj4gKw0KPiArICAgICAgIG9pYy0+ZXJybm8gPSBlcnJubzsNCj4gK30NCj4gKw0K
PiArLyoqDQo+ICsgKiBxY29tdGVlX3F0ZWVfb2JqZWN0c19wdXQoKSAtIFB1dCB0aGUgY2FsbGJh
Y2sgb2JqZWN0cyBpbiB0aGUgYXJndW1lbnQgYXJyYXkuDQo+ICsgKiBAdTogYXJyYXkgb2YgYXJn
dW1lbnRzLg0KPiArICoNCj4gKyAqIFdoZW4gcWNvbXRlZV9vYmplY3RfZG9faW52b2tlX2ludGVy
bmFsKCkgaXMgc3VjY2Vzc2Z1bGx5IGludm9rZWQsDQo+ICsgKiBRVEVFIHRha2VzIG93bmVyc2hp
cCBvZiB0aGUgY2FsbGJhY2sgb2JqZWN0cy4gSWYgdGhlIGludm9jYXRpb24gZmFpbHMsDQo+ICsg
KiBxY29tdGVlX29iamVjdF9kb19pbnZva2VfaW50ZXJuYWwoKSBjYWxscyBxY29tdGVlX3F0ZWVf
b2JqZWN0c19wdXQoKQ0KPiArICogdG8gbWltaWMgdGhlIHJlbGVhc2Ugb2YgY2FsbGJhY2sgb2Jq
ZWN0cyBieSBRVEVFLg0KPiArICovDQo+ICtzdGF0aWMgdm9pZCBxY29tdGVlX3F0ZWVfb2JqZWN0
c19wdXQoc3RydWN0IHFjb210ZWVfYXJnICp1KQ0KPiArew0KPiArICAgICAgIGludCBpOw0KPiAr
DQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfaW5wdXRfb2JqZWN0KGksIHUpIHsNCj4g
KyAgICAgICAgICAgICAgIGlmICh0eXBlb2ZfcWNvbXRlZV9vYmplY3QodVtpXS5vKSA9PSBRQ09N
VEVFX09CSkVDVF9UWVBFX0NCKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29i
amVjdF9wdXQodVtpXS5vKTsNCj4gKyAgICAgICB9DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICog
cWNvbXRlZV9vYmplY3RfZG9faW52b2tlX2ludGVybmFsKCkgLSBTdWJtaXQgYW4gaW52b2NhdGlv
biBmb3IgYW4gb2JqZWN0Lg0KPiArICogQG9pYzogY29udGV4dCB0byB1c2UgZm9yIHRoZSBjdXJy
ZW50IGludm9jYXRpb24uDQo+ICsgKiBAb2JqZWN0OiBvYmplY3QgYmVpbmcgaW52b2tlZC4NCj4g
KyAqIEBvcDogcmVxdWVzdGVkIG9wZXJhdGlvbiBvbiB0aGUgb2JqZWN0Lg0KPiArICogQHU6IGFy
cmF5IG9mIGFyZ3VtZW50cyBmb3IgdGhlIGN1cnJlbnQgaW52b2NhdGlvbi4NCj4gKyAqIEByZXN1
bHQ6IHJlc3VsdCByZXR1cm5lZCBmcm9tIFFURUUuDQo+ICsgKg0KPiArICogVGhlIGNhbGxlciBp
cyByZXNwb25zaWJsZSBmb3Iga2VlcGluZyB0cmFjayBvZiB0aGUgcmVmY291bnQgZm9yIGVhY2gN
Cj4gKyAqIG9iamVjdCwgaW5jbHVkaW5nIEBvYmplY3QuIE9uIHJldHVybiwgdGhlIGNhbGxlciBs
b3NlcyBvd25lcnNoaXAgb2YgYWxsDQo+ICsgKiBpbnB1dCBvYmplY3RzIG9mIHR5cGUgJVFDT01U
RUVfT0JKRUNUX1RZUEVfQ0IuDQo+ICsgKg0KPiArICogUmV0dXJuOiBPbiBzdWNjZXNzLCByZXR1
cm5zIDAuIE9uIGVycm9yLCByZXR1cm5zIC1FQUdBSU4gaWYgaW52b2NhdGlvbg0KPiArICogZmFp
bGVkIGFuZCB0aGUgdXNlciBtYXkgcmV0cnkgdGhlIGludm9jYXRpb24sIC1FTk9ERVYgb24gZmF0
YWwgZmFpbHVyZS4NCj4gKyAqLw0KPiAraW50IHFjb210ZWVfb2JqZWN0X2RvX2ludm9rZV9pbnRl
cm5hbChzdHJ1Y3QgcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eCAqb2ljLA0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0
LCB1MzIgb3AsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHFjb210ZWVfYXJnICp1LCBpbnQgKnJlc3VsdCkNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNv
bXRlZV9tc2dfY2FsbGJhY2sgKmNiX21zZzsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmpl
Y3QgKnF0bzsNCj4gKyAgICAgICBpbnQgaSwgcmV0LCBlcnJubzsNCj4gKyAgICAgICB1NjQgcmVz
X3R5cGU7DQo+ICsNCj4gKyAgICAgICAvKiBBbGxvY2F0ZSBpbmJvdW5kIGFuZCBvdXRib3VuZCBi
dWZmZXJzLiAqLw0KPiArICAgICAgIGlmIChxY29tdGVlX21zZ19idWZmZXJzX2FsbG9jKG9pYywg
dSkpIHsNCj4gKyAgICAgICAgICAgICAgIHFjb210ZWVfcXRlZV9vYmplY3RzX3B1dCh1KTsNCj4g
Kw0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FQUdBSU47DQo+ICsgICAgICAgfQ0KPiArDQo+
ICsgICAgICAgaWYgKHFjb210ZWVfcHJlcGFyZV9tc2cob2ljLCBvYmplY3QsIG9wLCB1KSkgew0K
PiArICAgICAgICAgICAgICAgcWNvbXRlZV9xdGVlX29iamVjdHNfcHV0KHUpOw0KPiArDQo+ICsg
ICAgICAgICAgICAgICByZXQgPSAtRUFHQUlOOw0KPiArICAgICAgICAgICAgICAgZ290byBvdXQ7
DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgLyogVXNlIGlucHV0IG1lc3NhZ2UgYnVmZmVy
IGluICdvaWMnLiAqLw0KPiArICAgICAgIGNiX21zZyA9IG9pYy0+b3V0X21zZy5hZGRyOw0KPiAr
DQo+ICsgICAgICAgd2hpbGUgKDEpIHsNCj4gKyAgICAgICAgICAgICAgIGlmIChvaWMtPmZsYWdz
ICYgUUNPTVRFRV9PSUNfRkxBR19CVVNZKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGVy
cm5vID0gb2ljLT5lcnJubzsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJubykN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJubyA9IHFjb210ZWVfdXBkYXRl
X21zZyhvaWMpOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX21zZ19zZXRfcmVz
dWx0KGNiX21zZywgZXJybm8pOw0KPiArICAgICAgICAgICAgICAgfQ0KPiArDQo+ICsgICAgICAg
ICAgICAgICAvKiBJbnZva2UgdGhlIHJlbW90ZSBvYmplY3QuICovDQo+ICsgICAgICAgICAgICAg
ICByZXQgPSBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4X2ludm9rZShvaWMsIHJlc3VsdCwgJnJl
c190eXBlKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgaWYgKG9pYy0+ZmxhZ3MgJiBRQ09NVEVF
X09JQ19GTEFHX0JVU1kpIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcXRvID0gb2ljLT5v
YmplY3Q7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChxdG8pIHsNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBpZiAob2ljLT5mbGFncyAmIFFDT01URUVfT0lDX0ZMQUdf
Tk9USUZZKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBE
b24ndCBjYXJlIGFib3V0IHRoZSBleGFjdCBlcnJuby4gKi8NCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIGlmIChxdG8tPm9wcy0+bm90aWZ5KQ0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxdG8tPm9wcy0+bm90aWZ5KG9p
YywgcXRvLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGVycm5vIHx8IHJldCk7DQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgfQ0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyog
R2V0IGlzIGluIHFjb210ZWVfY2Jfb2JqZWN0X2ludm9rZSgpLiAqLw0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHFjb210ZWVfb2JqZWN0X3B1dChxdG8pOw0KPiArICAgICAgICAg
ICAgICAgICAgICAgICB9DQo+ICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgb2ljLT5vYmpl
Y3QgPSBOVUxMX1FDT01URUVfT0JKRUNUOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBvaWMt
PmZsYWdzICY9IH4oUUNPTVRFRV9PSUNfRkxBR19CVVNZIHwNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFFDT01URUVfT0lDX0ZMQUdfTk9USUZZKTsNCj4gKyAgICAg
ICAgICAgICAgIH0NCj4gKw0KPiArICAgICAgICAgICAgICAgaWYgKHJldCkgew0KPiArICAgICAg
ICAgICAgICAgICAgICAgICBpZiAoIShvaWMtPmZsYWdzICYgUUNPTVRFRV9PSUNfRkxBR19TSEFS
RUQpKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWNvbXRlZV9xdGVlX29i
amVjdHNfcHV0KHUpOw0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0
ID0gLUVBR0FJTjsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAvKg0KPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAqIE9uIGVycm9yLCB0aGVyZSBpcyBubyBjbGVhbiB3YXkgdG8gZXhpdC4NCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBGb3Igc29tZSByZWFzb24sIHdlIGNhbm5v
dCBjb21tdW5pY2F0ZSB3aXRoDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICog
UVRFRSwgc28gd2UgY2Fubm90IG5vdGlmeSBRVEVFIGFib3V0IHRoZQ0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAqIGZhaWx1cmUgYW5kIGRvIGZ1cnRoZXIgY2xlYW51cC4NCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8NCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICByZXQgPSAtRU5PREVWOw0KPiArICAgICAgICAgICAgICAgICAgICAgICB9
DQo+ICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXQ7DQo+ICsNCj4gKyAgICAg
ICAgICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8qDQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAqIFFURUUgb2J0YWluZWQgb3duZXJzaGlwIG9mIFFDT01URUVf
T0JKRUNUX1RZUEVfQ0INCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICogaW5wdXQgb2JqZWN0
cyBpbiAndScuIE9uIGZ1cnRoZXIgZmFpbHVyZSwgUVRFRSBpcw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgKiByZXNwb25zaWJsZSBmb3IgcmVsZWFzaW5nIHRoZW0uDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAqLw0KPiArICAgICAgICAgICAgICAgICAgICAgICBvaWMtPmZsYWdzIHw9
IFFDT01URUVfT0lDX0ZMQUdfU0hBUkVEOw0KPiArICAgICAgICAgICAgICAgfQ0KPiArDQo+ICsg
ICAgICAgICAgICAgICAvKiBJcyBpdCBhIGNhbGxiYWNrIHJlcXVlc3Q/ICovDQo+ICsgICAgICAg
ICAgICAgICBpZiAocmVzX3R5cGUgIT0gUUNPTVRFRV9SRVNVTFRfSU5CT1VORF9SRVFfTkVFREVE
KSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmICghKnJlc3VsdCkgew0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHJldCA9IHFjb210ZWVfdXBkYXRlX2FyZ3ModSwgb2lj
KTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0KSB7DQo+ICsgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBQdXQgb3V0cHV0IG9iamVjdHMu
IFJldHJ5LiAqLw0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWNv
bXRlZV9hcmdfZm9yX2VhY2hfb3V0cHV0X29iamVjdChpLCB1KQ0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQodVtpXS5v
KTsNCj4gKw0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0ID0g
LUVBR0FJTjsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIH0NCj4gKw0KPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsN
Cj4gKw0KPiArICAgICAgICAgICAgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgb2ljLT5mbGFncyB8PSBRQ09NVEVFX09JQ19GTEFHX0JVU1k7DQo+ICsNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgcWNvbXRlZV9mZXRjaF9hc3luY19yZXFzKG9pYyk7DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIHFjb210ZWVfY2Jfb2JqZWN0X2ludm9rZShvaWMsIGNiX21zZyk7DQo+
ICsgICAgICAgICAgICAgICB9DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgcWNvbXRlZV9m
ZXRjaF9hc3luY19yZXFzKG9pYyk7DQo+ICtvdXQ6DQo+ICsgICAgICAgcWNvbXRlZV9tc2dfYnVm
ZmVyc19mcmVlKG9pYyk7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gcmV0Ow0KPiArfQ0KPiArDQo+
ICtpbnQgcWNvbXRlZV9vYmplY3RfZG9faW52b2tlKHN0cnVjdCBxY29tdGVlX29iamVjdF9pbnZv
a2VfY3R4ICpvaWMsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210
ZWVfb2JqZWN0ICpvYmplY3QsIHUzMiBvcCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgcWNvbXRlZV9hcmcgKnUsIGludCAqcmVzdWx0KQ0KPiArew0KPiArICAgICAgIC8q
IFVzZXIgY2FuIG5vdCBzZXQgYml0cyB1c2VkIGJ5IHRyYW5zcG9ydC4gKi8NCj4gKyAgICAgICBp
ZiAob3AgJiB+UUNPTVRFRV9NU0dfT0JKRUNUX09QX01BU0spDQo+ICsgICAgICAgICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsNCj4gKw0KPiArICAgICAgIC8qIFVzZXIgY2FuIG9ubHkgaW52b2tlIFFU
RUUgaG9zdGVkIG9iamVjdHMuICovDQo+ICsgICAgICAgaWYgKHR5cGVvZl9xY29tdGVlX29iamVj
dChvYmplY3QpICE9IFFDT01URUVfT0JKRUNUX1RZUEVfVEVFICYmDQo+ICsgICAgICAgICAgIHR5
cGVvZl9xY29tdGVlX29iamVjdChvYmplY3QpICE9IFFDT01URUVfT0JKRUNUX1RZUEVfUk9PVCkN
Cj4gKyAgICAgICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgLyogVXNl
ciBjYW5ub3QgZGlyZWN0bHkgaXNzdWUgdGhlc2Ugb3BlcmF0aW9ucyB0byBRVEVFLiAqLw0KPiAr
ICAgICAgIGlmIChvcCA9PSBRQ09NVEVFX01TR19PQkpFQ1RfT1BfUkVMRUFTRSkNCj4gKyAgICAg
ICAgICAgICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHFjb210ZWVf
b2JqZWN0X2RvX2ludm9rZV9pbnRlcm5hbChvaWMsIG9iamVjdCwgb3AsIHUsIHJlc3VsdCk7DQo+
ICt9DQo+ICtFWFBPUlRfU1lNQk9MX0dQTChxY29tdGVlX29iamVjdF9kb19pbnZva2UpOw0KPiBk
aWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS9xY29tX3NjbS5jIGIvZHJpdmVycy90ZWUv
cWNvbXRlZS9xY29tX3NjbS5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0DQo+IGluZGV4IDAwMDAw
MDAwMDAwMC4uMzhhM2QwODBmODZkDQo+IC0tLSAvZGV2L251bGwNCj4gKysrIGIvZHJpdmVycy90
ZWUvcWNvbXRlZS9xY29tX3NjbS5jDQo+IEBAIC0wLDAgKzEsMzggQEANCj4gKy8vIFNQRFgtTGlj
ZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9ubHkNCj4gKy8qDQo+ICsgKiBDb3B5cmlnaHQgKGMp
IDIwMjQgUXVhbGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZl
ZC4NCj4gKyAqLw0KPiArDQo+ICsjaW5jbHVkZSA8bGludXgvZmlybXdhcmUvcWNvbS9xY29tX3Nj
bS5oPg0KPiArDQo+ICsjaW5jbHVkZSAicWNvbXRlZV9wcml2YXRlLmgiDQo+ICsNCj4gK2ludCBx
Y29tdGVlX29iamVjdF9pbnZva2VfY3R4X2ludm9rZShzdHJ1Y3QgcWNvbXRlZV9vYmplY3RfaW52
b2tlX2N0eCAqb2ljLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50
ICpyZXN1bHQsIHU2NCAqcmVzX3R5cGUpDQo+ICt7DQo+ICsgICAgICAgcGh5c19hZGRyX3Qgb3V0
X21zZ19wYWRkcjsNCj4gKyAgICAgICBwaHlzX2FkZHJfdCBpbl9tc2dfcGFkZHI7DQo+ICsgICAg
ICAgaW50IHJldDsNCj4gKyAgICAgICB1NjQgcmVzOw0KPiArDQo+ICsgICAgICAgdGVlX3NobV9n
ZXRfcGEob2ljLT5vdXRfc2htLCAwLCAmb3V0X21zZ19wYWRkcik7DQo+ICsgICAgICAgdGVlX3No
bV9nZXRfcGEob2ljLT5pbl9zaG0sIDAsICZpbl9tc2dfcGFkZHIpOw0KPiArICAgICAgIGlmICgh
KG9pYy0+ZmxhZ3MgJiBRQ09NVEVFX09JQ19GTEFHX0JVU1kpKSB7DQo+ICsgICAgICAgICAgICAg
ICAvKiBEaXJlY3QgUVRFRSBvYmplY3QgaW52b2NhdGlvbi4gKi8NCj4gKyAgICAgICAgICAgICAg
IHJldCA9IHFjb21fc2NtX3F0ZWVfaW52b2tlX3NtYyhpbl9tc2dfcGFkZHIsIG9pYy0+aW5fbXNn
LnNpemUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
b3V0X21zZ19wYWRkciwgb2ljLT5vdXRfbXNnLnNpemUsDQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJnJlcywgcmVzX3R5cGUpOw0KPiArICAgICAgIH0g
ZWxzZSB7DQo+ICsgICAgICAgICAgICAgICAvKiBTdWJtaXQgY2FsbGJhY2sgcmVzcG9uc2UuICov
DQo+ICsgICAgICAgICAgICAgICByZXQgPSBxY29tX3NjbV9xdGVlX2NhbGxiYWNrX3Jlc3BvbnNl
KG91dF9tc2dfcGFkZHIsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIG9pYy0+b3V0X21zZy5zaXplLA0KPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmcmVzLCByZXNfdHlwZSk7DQo+ICsg
ICAgICAgfQ0KPiArDQo+ICsgICAgICAgaWYgKHJldCkNCj4gKyAgICAgICAgICAgICAgIHByX2Vy
cigiUVRFRSByZXR1cm5lZCB3aXRoICVkLlxuIiwgcmV0KTsNCj4gKyAgICAgICBlbHNlDQo+ICsg
ICAgICAgICAgICAgICAqcmVzdWx0ID0gKGludClyZXM7DQo+ICsNCj4gKyAgICAgICByZXR1cm4g
cmV0Ow0KPiArfQ0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS9xY29tdGVlX21z
Zy5oIGIvZHJpdmVycy90ZWUvcWNvbXRlZS9xY29tdGVlX21zZy5oDQo+IG5ldyBmaWxlIG1vZGUg
MTAwNjQ0DQo+IGluZGV4IDAwMDAwMDAwMDAwMC4uMzNhNmI0MjYxNTNjDQo+IC0tLSAvZGV2L251
bGwNCj4gKysrIGIvZHJpdmVycy90ZWUvcWNvbXRlZS9xY29tdGVlX21zZy5oDQo+IEBAIC0wLDAg
KzEsMjM5IEBADQo+ICsvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5ICov
DQo+ICsvKg0KPiArICogQ29weXJpZ2h0IChjKSAyMDI0IFF1YWxjb21tIElubm92YXRpb24gQ2Vu
dGVyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQo+ICsgKi8NCj4gKw0KPiArI2lmbmRlZiBR
Q09NVEVFX01TR19IDQo+ICsjZGVmaW5lIFFDT01URUVfTVNHX0gNCj4gKw0KPiArI2luY2x1ZGUg
PGxpbnV4L2Zpcm13YXJlL3Fjb20vcWNvbV90ZWUuaD4NCj4gKw0KPiArLyoqDQo+ICsgKiBET0M6
ICcnUXVhbGNvbW0gVEVFJycgKFFURUUpIFRyYW5zcG9ydCBNZXNzYWdlDQo+ICsgKg0KPiArICog
VGhlcmUgYXJlIHR3byBidWZmZXJzIHNoYXJlZCB3aXRoIFFURUU6IGluYm91bmQgYW5kIG91dGJv
dW5kIGJ1ZmZlcnMuDQo+ICsgKiBUaGUgaW5ib3VuZCBidWZmZXIgaXMgdXNlZCBmb3IgZGlyZWN0
IG9iamVjdCBpbnZvY2F0aW9uLCBhbmQgdGhlIG91dGJvdW5kDQo+ICsgKiBidWZmZXIgaXMgdXNl
ZCB0byBtYWtlIGEgcmVxdWVzdCBmcm9tIFFURUUgdG8gdGhlIGtlcm5lbDsgaS5lLiwgYSBjYWxs
YmFjaw0KPiArICogcmVxdWVzdC4NCj4gKyAqDQo+ICsgKiBUaGUgdW51c2VkIHRhaWwgb2YgdGhl
IG91dGJvdW5kIGJ1ZmZlciBpcyBhbHNvIHVzZWQgZm9yIHNlbmRpbmcgYW5kDQo+ICsgKiByZWNl
aXZpbmcgYXN5bmNocm9ub3VzIG1lc3NhZ2VzLiBBbiBhc3luY2hyb25vdXMgbWVzc2FnZSBpcyBp
bmRlcGVuZGVudCBvZg0KPiArICogdGhlIGN1cnJlbnQgb2JqZWN0IGludm9jYXRpb24gKGkuZS4s
IGNvbnRlbnRzIG9mIHRoZSBpbmJvdW5kIGJ1ZmZlcikgb3INCj4gKyAqIGNhbGxiYWNrIHJlcXVl
c3QgKGkuZS4sIHRoZSBoZWFkIG9mIHRoZSBvdXRib3VuZCBidWZmZXIpOyBzZWUNCj4gKyAqIHFj
b210ZWVfZ2V0X2FzeW5jX2J1ZmZlcigpLiBJdCBpcyB1c2VkIGJ5IGVuZHBvaW50cyAoUVRFRSBv
ciBrZXJuZWwpIGFzIGFuDQo+ICsgKiBvcHRpbWl6YXRpb24gdG8gcmVkdWNlIHRoZSBudW1iZXIg
b2YgY29udGV4dCBzd2l0Y2hlcyBiZXR3ZWVuIHRoZSBzZWN1cmUgYW5kDQo+ICsgKiBub24tc2Vj
dXJlIHdvcmxkcy4NCj4gKyAqDQo+ICsgKiBGb3IgaW5zdGFuY2UsIFFURUUgbmV2ZXIgc2VuZHMg
YW4gZXhwbGljaXQgY2FsbGJhY2sgcmVxdWVzdCB0byByZWxlYXNlIGFuDQo+ICsgKiBvYmplY3Qg
aW4gdGhlIGtlcm5lbC4gSW5zdGVhZCwgaXQgc2VuZHMgYXN5bmNocm9ub3VzIHJlbGVhc2UgbWVz
c2FnZXMgaW4gdGhlDQo+ICsgKiBvdXRib3VuZCBidWZmZXIgd2hlbiBRVEVFIHJldHVybnMgZnJv
bSB0aGUgcHJldmlvdXMgZGlyZWN0IG9iamVjdCBpbnZvY2F0aW9uLA0KPiArICogb3IgYXBwZW5k
cyBhc3luY2hyb25vdXMgcmVsZWFzZSBtZXNzYWdlcyBhZnRlciB0aGUgY3VycmVudCBjYWxsYmFj
ayByZXF1ZXN0Lg0KPiArICoNCj4gKyAqIFFURUUgc3VwcG9ydHMgdHdvIHR5cGVzIG9mIGFyZ3Vt
ZW50cyBpbiBhIG1lc3NhZ2U6IGJ1ZmZlciBhbmQgb2JqZWN0DQo+ICsgKiBhcmd1bWVudHMuIERl
cGVuZGluZyBvbiB0aGUgZGlyZWN0aW9uIG9mIGRhdGEgZmxvdywgdGhleSBjb3VsZCBiZSBpbnB1
dA0KPiArICogYnVmZmVyIChJTykgdG8gUVRFRSwgb3V0cHV0IGJ1ZmZlciAoT0IpIGZyb20gUVRF
RSwgaW5wdXQgb2JqZWN0IChJTykgdG8gUVRFRSwNCj4gKyAqIG9yIG91dHB1dCBvYmplY3QgKE9P
KSBmcm9tIFFURUUuIE9iamVjdCBhcmd1bWVudHMgaG9sZCBvYmplY3QgSURzLiBCdWZmZXINCj4g
KyAqIGFyZ3VtZW50cyBob2xkIChvZmZzZXQsIHNpemUpIHBhaXJzIGludG8gdGhlIGluYm91bmQg
b3Igb3V0Ym91bmQgYnVmZmVycy4NCj4gKyAqDQo+ICsgKiBRVEVFIGhvbGRzIGFuIG9iamVjdCB0
YWJsZSBmb3Igb2JqZWN0cyBpdCBob3N0cyBhbmQgZXhwb3NlcyB0byB0aGUga2VybmVsLg0KPiAr
ICogQW4gb2JqZWN0IElEIGlzIGFuIGluZGV4IHRvIHRoZSBvYmplY3QgdGFibGUgaW4gUVRFRS4N
Cj4gKyAqDQo+ICsgKiBGb3IgdGhlIGRpcmVjdCBvYmplY3QgaW52b2NhdGlvbiBtZXNzYWdlIGZv
cm1hdCBpbiB0aGUgaW5ib3VuZCBidWZmZXIsIHNlZQ0KPiArICogJnN0cnVjdCBxY29tdGVlX21z
Z19vYmplY3RfaW52b2tlLiBGb3IgdGhlIGNhbGxiYWNrIHJlcXVlc3QgbWVzc2FnZSBmb3JtYXQN
Cj4gKyAqIGluIHRoZSBvdXRib3VuZCBidWZmZXIsIHNlZSAmc3RydWN0IHFjb210ZWVfbXNnX2Nh
bGxiYWNrLiBGb3IgdGhlIG1lc3NhZ2UNCj4gKyAqIGZvcm1hdCBmb3IgYXN5bmNocm9ub3VzIG1l
c3NhZ2VzIGluIHRoZSBvdXRib3VuZCBidWZmZXIsIHNlZQ0KPiArICogJnN0cnVjdCBxY29tdGVl
X2FzeW5jX21zZ19oZHIuDQo+ICsgKi8NCj4gKw0KPiArLyoqDQo+ICsgKiBkZWZpbmUgUUNPTVRF
RV9NU0dfT0JKRUNUX05TX0JJVCAtIE5vbi1zZWN1cmUgYml0DQo+ICsgKg0KPiArICogT2JqZWN0
IElEIGlzIGEgZ2xvYmFsbHkgdW5pcXVlIDMyLWJpdCBudW1iZXIuIElEcyByZWZlcmVuY2luZyBv
YmplY3RzDQo+ICsgKiBpbiB0aGUga2VybmVsIHNob3VsZCBoYXZlICVRQ09NVEVFX01TR19PQkpF
Q1RfTlNfQklUIHNldC4NCj4gKyAqLw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19PQkpFQ1RfTlNf
QklUIEJJVCgzMSkNCj4gKw0KPiArLyogU3RhdGljIG9iamVjdCBJRHMgcmVjb2duaXplZCBieSBR
VEVFLiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19PQkpFQ1RfTlVMTCAoMFUpDQo+ICsjZGVm
aW5lIFFDT01URUVfTVNHX09CSkVDVF9ST09UICgxVSkNCj4gKw0KPiArLyogRGVmaW5pdGlvbnMg
ZnJvbSBRVEVFIGFzIHBhcnQgb2YgdGhlIHRyYW5zcG9ydCBwcm90b2NvbC4gKi8NCj4gKw0KPiAr
LyogcWNvbXRlZV9tc2dfYXJnIGlzIGFuIGFyZ3VtZW50IGFzIHJlY29nbml6ZWQgYnkgUVRFRS4g
Ki8NCj4gK3VuaW9uIHFjb210ZWVfbXNnX2FyZyB7DQo+ICsgICAgICAgc3RydWN0IHsNCj4gKyAg
ICAgICAgICAgICAgIHUzMiBvZmZzZXQ7DQo+ICsgICAgICAgICAgICAgICB1MzIgc2l6ZTsNCj4g
KyAgICAgICB9IGI7DQo+ICsgICAgICAgdTMyIG87DQo+ICt9Ow0KPiArDQo+ICsvKiBCSSBhbmQg
Qk8gcGF5bG9hZHMgaW4gUVRFRSBtZXNzYWdlcyBzaG91bGQgYmUgYXQgNjQtYml0IGJvdW5kYXJp
ZXMuICovDQo+ICsjZGVmaW5lIHFjb210ZWVfbXNnX29mZnNldF9hbGlnbihvKSBBTElHTigobyks
IHNpemVvZih1NjQpKQ0KPiArDQo+ICsvKiBPcGVyYXRpb25zIGZvciBvYmplY3RzIGFyZSAzMi1i
aXQuIFRyYW5zcG9ydCB1c2VzIHRoZSB1cHBlciAxNiBiaXRzLiAqLw0KPiArI2RlZmluZSBRQ09N
VEVFX01TR19PQkpFQ1RfT1BfTUFTSyBHRU5NQVNLKDE1LCAwKQ0KPiArDQo+ICsvKiBSZXNlcnZl
ZCBPcGVyYXRpb24gSURzIHNlbnQgdG8gUVRFRTogKi8NCj4gKy8qIFFDT01URUVfTVNHX09CSkVD
VF9PUF9SRUxFQVNFIC0gUmVkdWNlcyB0aGUgcmVmY291bnQgYW5kIHJlbGVhc2VzIHRoZSBvYmpl
Y3QuDQo+ICsgKiBRQ09NVEVFX01TR19PQkpFQ1RfT1BfUkVUQUlOICAtIEluY3JlYXNlcyB0aGUg
cmVmY291bnQuDQo+ICsgKg0KPiArICogVGhlc2Ugb3BlcmF0aW9uIElEcyBhcmUgdmFsaWQgZm9y
IGFsbCBvYmplY3RzLg0KPiArICovDQo+ICsNCj4gKyNkZWZpbmUgUUNPTVRFRV9NU0dfT0JKRUNU
X09QX1JFTEVBU0UgKFFDT01URUVfTVNHX09CSkVDVF9PUF9NQVNLIC0gMCkNCj4gKyNkZWZpbmUg
UUNPTVRFRV9NU0dfT0JKRUNUX09QX1JFVEFJTiAgKFFDT01URUVfTVNHX09CSkVDVF9PUF9NQVNL
IC0gMSkNCj4gKw0KPiArLyogU3Vic2V0IG9mIG9wZXJhdGlvbnMgc3VwcG9ydGVkIGJ5IFFURUUg
cm9vdCBvYmplY3QuICovDQo+ICsNCj4gKyNkZWZpbmUgUUNPTVRFRV9ST09UX09QX1JFR0lTVEVS
X1dJVEhfQ1JFREVOVElBTFMgNQ0KPiArI2RlZmluZSBRQ09NVEVFX1JPT1RfT1BfTk9USUZZX0RP
TUFJTl9DSEFOR0UgNA0KPiArI2RlZmluZSBRQ09NVEVFX1JPT1RfT1BfQURDSV9BQ0NFUFQgOA0K
PiArI2RlZmluZSBRQ09NVEVFX1JPT1RfT1BfQURDSV9TSFVURE9XTiA5DQo+ICsNCj4gKy8qIFJl
c3BvbnNlIHR5cGVzIGFzIHJldHVybmVkIGZyb20gcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eF9p
bnZva2UoKS4gKi8NCj4gKw0KPiArLyogVGhlIG1lc3NhZ2UgY29udGFpbnMgYSBjYWxsYmFjayBy
ZXF1ZXN0LiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX1JFU1VMVF9JTkJPVU5EX1JFUV9ORUVERUQg
Mw0KPiArDQo+ICsvKioNCj4gKyAqIHN0cnVjdCBxY29tdGVlX21zZ19vYmplY3RfaW52b2tlIC0g
RGlyZWN0IG9iamVjdCBpbnZvY2F0aW9uIG1lc3NhZ2UuDQo+ICsgKiBAY3R4OiBvYmplY3QgSUQg
aG9zdGVkIGluIFFURUUuDQo+ICsgKiBAb3A6IG9wZXJhdGlvbiBmb3IgdGhlIG9iamVjdC4NCj4g
KyAqIEBjb3VudHM6IG51bWJlciBvZiBkaWZmZXJlbnQgdHlwZXMgb2YgYXJndW1lbnRzIGluIEBh
cmdzLg0KPiArICogQGFyZ3M6IGFycmF5IG9mIGFyZ3VtZW50cy4NCj4gKyAqDQo+ICsgKiBAY291
bnRzIGNvbnNpc3RzIG9mIDQgKiA0LWJpdCBmaWVsZHMuIEJpdHMgMCAtIDMgcmVwcmVzZW50IHRo
ZSBudW1iZXIgb2YNCj4gKyAqIGlucHV0IGJ1ZmZlcnMsIGJpdHMgNCAtIDcgcmVwcmVzZW50IHRo
ZSBudW1iZXIgb2Ygb3V0cHV0IGJ1ZmZlcnMsDQo+ICsgKiBiaXRzIDggLSAxMSByZXByZXNlbnQg
dGhlIG51bWJlciBvZiBpbnB1dCBvYmplY3RzLCBhbmQgYml0cyAxMiAtIDE1DQo+ICsgKiByZXBy
ZXNlbnQgdGhlIG51bWJlciBvZiBvdXRwdXQgb2JqZWN0cy4gVGhlIHJlbWFpbmluZyBiaXRzIHNo
b3VsZCBiZSB6ZXJvLg0KPiArICoNCj4gKyAqIFRoZSBtYXhpbXVtIG51bWJlciBvZiBhcmd1bWVu
dHMgb2YgZWFjaCB0eXBlIGlzIGRlZmluZWQgYnkNCj4gKyAqICVRQ09NVEVFX0FSR1NfUEVSX1RZ
UEUuDQo+ICsgKi8NCj4gK3N0cnVjdCBxY29tdGVlX21zZ19vYmplY3RfaW52b2tlIHsNCj4gKyAg
ICAgICB1MzIgY3h0Ow0KPiArICAgICAgIHUzMiBvcDsNCj4gKyAgICAgICB1MzIgY291bnRzOw0K
PiArICAgICAgIHVuaW9uIHFjb210ZWVfbXNnX2FyZyBhcmdzW107DQo+ICt9Ow0KPiArDQo+ICsv
KioNCj4gKyAqIHN0cnVjdCBxY29tdGVlX21zZ19jYWxsYmFjayAtIENhbGxiYWNrIHJlcXVlc3Qg
bWVzc2FnZS4NCj4gKyAqIEByZXN1bHQ6IHJlc3VsdCBvZiBvcGVyYXRpb24gQG9wIG9uIHRoZSBv
YmplY3QgcmVmZXJlbmNlZCBieSBAY3h0Lg0KPiArICogQGN4dDogb2JqZWN0IElEIGhvc3RlZCBp
biB0aGUga2VybmVsLg0KPiArICogQG9wOiBvcGVyYXRpb24gZm9yIHRoZSBvYmplY3QuDQo+ICsg
KiBAY291bnRzOiBudW1iZXIgb2YgZGlmZmVyZW50IHR5cGVzIG9mIGFyZ3VtZW50cyBpbiBAYXJn
cy4NCj4gKyAqIEBhcmdzOiBhcnJheSBvZiBhcmd1bWVudHMuDQo+ICsgKg0KPiArICogRm9yIGRl
dGFpbHMgb2YgQGNvdW50cywgc2VlICZxY29tdGVlX21zZ19vYmplY3RfaW52b2tlLmNvdW50cy4N
Cj4gKyAqLw0KPiArc3RydWN0IHFjb210ZWVfbXNnX2NhbGxiYWNrIHsNCj4gKyAgICAgICB1MzIg
cmVzdWx0Ow0KPiArICAgICAgIHUzMiBjeHQ7DQo+ICsgICAgICAgdTMyIG9wOw0KPiArICAgICAg
IHUzMiBjb3VudHM7DQo+ICsgICAgICAgdW5pb24gcWNvbXRlZV9tc2dfYXJnIGFyZ3NbXTsNCj4g
K307DQo+ICsNCj4gKy8qIE9mZnNldCBpbiB0aGUgbWVzc2FnZSBmb3IgdGhlIGJlZ2lubmluZyBv
ZiB0aGUgYnVmZmVyIGFyZ3VtZW50J3MgY29udGVudHMuICovDQo+ICsjZGVmaW5lIHFjb210ZWVf
bXNnX2J1ZmZlcl9hcmdzKHQsIG4pIFwNCj4gKyAgICAgICBxY29tdGVlX21zZ19vZmZzZXRfYWxp
Z24oc3RydWN0X3NpemVfdCh0LCBhcmdzLCBuKSkNCj4gKy8qIFBvaW50ZXIgdG8gdGhlIGJlZ2lu
bmluZyBvZiBhIGJ1ZmZlciBhcmd1bWVudCdzIGNvbnRlbnQgYXQgYW4gb2Zmc2V0LiAqLw0KPiAr
I2RlZmluZSBxY29tdGVlX21zZ19vZmZzZXRfdG9fcHRyKG0sIG9mZikgKCh2b2lkICopJigoY2hh
ciAqKShtKSlbKG9mZildKQ0KPiArDQo+ICsvKiBTb21lIGhlbHBlcnMgdG8gbWFuYWdlIG1zZy5j
b3VudHMuICovDQo+ICsNCj4gKyNkZWZpbmUgUUNPTVRFRV9NU0dfTlVNX0lCKHgpICgoeCkgJiAw
eGZVKQ0KPiArI2RlZmluZSBRQ09NVEVFX01TR19OVU1fT0IoeCkgKCgoeCkgPj4gNCkgJiAweGZV
KQ0KPiArI2RlZmluZSBRQ09NVEVFX01TR19OVU1fSU8oeCkgKCgoeCkgPj4gOCkgJiAweGZVKQ0K
PiArI2RlZmluZSBRQ09NVEVFX01TR19OVU1fT08oeCkgKCgoeCkgPj4gMTIpICYgMHhmVSkNCj4g
Kw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19JRFhfSUIoeCkgKDBVKQ0KPiArI2RlZmluZSBRQ09N
VEVFX01TR19JRFhfT0IoeCkgKFFDT01URUVfTVNHX0lEWF9JQih4KSArIFFDT01URUVfTVNHX05V
TV9JQih4KSkNCj4gKyNkZWZpbmUgUUNPTVRFRV9NU0dfSURYX0lPKHgpIChRQ09NVEVFX01TR19J
RFhfT0IoeCkgKyBRQ09NVEVFX01TR19OVU1fT0IoeCkpDQo+ICsjZGVmaW5lIFFDT01URUVfTVNH
X0lEWF9PTyh4KSAoUUNPTVRFRV9NU0dfSURYX0lPKHgpICsgUUNPTVRFRV9NU0dfTlVNX0lPKHgp
KQ0KPiArDQo+ICsjZGVmaW5lIHFjb210ZWVfbXNnX2Zvcl9lYWNoKGksIGMsIHR5cGUpICAgIFwN
Cj4gKyAgICAgICBmb3IgKGkgPSBRQ09NVEVFX01TR19JRFhfIyN0eXBlKGMpOyBcDQo+ICsgICAg
ICAgICAgICBpIDwgKFFDT01URUVfTVNHX0lEWF8jI3R5cGUoYykgKyBRQ09NVEVFX01TR19OVU1f
IyN0eXBlKGMpKTsgaSsrKQ0KPiArDQo+ICsjZGVmaW5lIHFjb210ZWVfbXNnX2Zvcl9lYWNoX2lu
cHV0X2J1ZmZlcihpLCBtKSBcDQo+ICsgICAgICAgcWNvbXRlZV9tc2dfZm9yX2VhY2goaSwgKG0p
LT5jb3VudHMsIElCKQ0KPiArI2RlZmluZSBxY29tdGVlX21zZ19mb3JfZWFjaF9vdXRwdXRfYnVm
ZmVyKGksIG0pIFwNCj4gKyAgICAgICBxY29tdGVlX21zZ19mb3JfZWFjaChpLCAobSktPmNvdW50
cywgT0IpDQo+ICsjZGVmaW5lIHFjb210ZWVfbXNnX2Zvcl9lYWNoX2lucHV0X29iamVjdChpLCBt
KSBcDQo+ICsgICAgICAgcWNvbXRlZV9tc2dfZm9yX2VhY2goaSwgKG0pLT5jb3VudHMsIElPKQ0K
PiArI2RlZmluZSBxY29tdGVlX21zZ19mb3JfZWFjaF9vdXRwdXRfb2JqZWN0KGksIG0pIFwNCj4g
KyAgICAgICBxY29tdGVlX21zZ19mb3JfZWFjaChpLCAobSktPmNvdW50cywgT08pDQo+ICsNCj4g
Ky8qIFN1bSBvZiBhcmd1bWVudHMgaW4gYSBtZXNzYWdlLiAqLw0KPiArI2RlZmluZSBxY29tdGVl
X21zZ19hcmdzKG0pIFwNCj4gKyAgICAgICAoUUNPTVRFRV9NU0dfSURYX09PKChtKS0+Y291bnRz
KSArIFFDT01URUVfTVNHX05VTV9PTygobSktPmNvdW50cykpDQo+ICsNCj4gK3N0YXRpYyBpbmxp
bmUgdm9pZCBxY29tdGVlX21zZ19pbml0KHN0cnVjdCBxY29tdGVlX21zZ19vYmplY3RfaW52b2tl
ICptc2csDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHUzMiBjeHQsIHUz
MiBvcCwgaW50IGluX2J1ZmZlciwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgaW50IG91dF9idWZmZXIsIGludCBpbl9vYmplY3QsDQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGludCBvdXRfb2JqZWN0KQ0KPiArew0KPiArICAgICAgIG1zZy0+Y291
bnRzIHw9IChpbl9idWZmZXIgJiAweGZVKTsNCj4gKyAgICAgICBtc2ctPmNvdW50cyB8PSAoKG91
dF9idWZmZXIgLSBpbl9idWZmZXIpICYgMHhmVSkgPDwgNDsNCj4gKyAgICAgICBtc2ctPmNvdW50
cyB8PSAoKGluX29iamVjdCAtIG91dF9idWZmZXIpICYgMHhmVSkgPDwgODsNCj4gKyAgICAgICBt
c2ctPmNvdW50cyB8PSAoKG91dF9vYmplY3QgLSBpbl9vYmplY3QpICYgMHhmVSkgPDwgMTI7DQo+
ICsgICAgICAgbXNnLT5jeHQgPSBjeHQ7DQo+ICsgICAgICAgbXNnLT5vcCA9IG9wOw0KPiArfQ0K
PiArDQo+ICsvKiBHZW5lcmljIGVycm9yIGNvZGVzLiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX01T
R19PSyAgICAgICAgICAgICAgICAgMCAgICAvKiBub24tc3BlY2lmaWMgc3VjY2VzcyBjb2RlLiAq
Lw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19FUlJPUiAgICAgICAgICAgICAgMSAgICAvKiBub24t
c3BlY2lmaWMgZXJyb3IuICovDQo+ICsjZGVmaW5lIFFDT01URUVfTVNHX0VSUk9SX0lOVkFMSUQg
ICAgICAyICAgIC8qIHVuc3VwcG9ydGVkL3VucmVjb2duaXplZCByZXF1ZXN0LiAqLw0KPiArI2Rl
ZmluZSBRQ09NVEVFX01TR19FUlJPUl9TSVpFX0lOICAgICAgMyAgICAvKiBzdXBwbGllZCBidWZm
ZXIvc3RyaW5nIHRvbyBsYXJnZS4gKi8NCj4gKyNkZWZpbmUgUUNPTVRFRV9NU0dfRVJST1JfU0la
RV9PVVQgICAgIDQgICAgLyogc3VwcGxpZWQgb3V0cHV0IGJ1ZmZlciB0b28gc21hbGwuICovDQo+
ICsjZGVmaW5lIFFDT01URUVfTVNHX0VSUk9SX1VTRVJCQVNFICAgICAxMCAgIC8qIHN0YXJ0IG9m
IHVzZXItZGVmaW5lZCBlcnJvciByYW5nZS4gKi8NCj4gKw0KPiArLyogVHJhbnNwb3J0IGxheWVy
IGVycm9yIGNvZGVzLiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19FUlJPUl9ERUZVTkNUICAg
ICAgLTkwICAvKiBvYmplY3Qgbm8gbG9uZ2VyIGV4aXN0cy4gKi8NCj4gKyNkZWZpbmUgUUNPTVRF
RV9NU0dfRVJST1JfQUJPUlQgICAgICAgICAgICAgICAgLTkxICAvKiBjYWxsaW5nIHRocmVhZCBt
dXN0IGV4aXQuICovDQo+ICsjZGVmaW5lIFFDT01URUVfTVNHX0VSUk9SX0JBRE9CSiAgICAgICAt
OTIgIC8qIGludmFsaWQgb2JqZWN0IGNvbnRleHQuICovDQo+ICsjZGVmaW5lIFFDT01URUVfTVNH
X0VSUk9SX05PU0xPVFMgICAgICAtOTMgIC8qIGNhbGxlcidzIG9iamVjdCB0YWJsZSBmdWxsLiAq
Lw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19FUlJPUl9NQVhBUkdTICAgICAgLTk0ICAvKiB0b28g
bWFueSBhcmdzLiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19FUlJPUl9NQVhEQVRBICAgICAg
LTk1ICAvKiBidWZmZXJzIHRvbyBsYXJnZS4gKi8NCj4gKyNkZWZpbmUgUUNPTVRFRV9NU0dfRVJS
T1JfVU5BVkFJTCAgICAgIC05NiAgLyogdGhlIHJlcXVlc3QgY291bGQgbm90IGJlIHByb2Nlc3Nl
ZC4gKi8NCj4gKyNkZWZpbmUgUUNPTVRFRV9NU0dfRVJST1JfS01FTSAgICAgICAgIC05NyAgLyog
a2VybmVsIG91dCBvZiBtZW1vcnkuICovDQo+ICsjZGVmaW5lIFFDT01URUVfTVNHX0VSUk9SX1JF
TU9URSAgICAgICAtOTggIC8qIGxvY2FsIG1ldGhvZCBzZW50IHRvIHJlbW90ZSBvYmplY3QuICov
DQo+ICsjZGVmaW5lIFFDT01URUVfTVNHX0VSUk9SX0JVU1kgICAgICAgICAtOTkgIC8qIE9iamVj
dCBpcyBidXN5LiAqLw0KPiArI2RlZmluZSBRQ09NVEVFX01TR19FUlJPUl9USU1FT1VUICAgICAg
LTEwMyAvKiBDYWxsIEJhY2sgT2JqZWN0IGludm9jYXRpb24gdGltZWQgb3V0LiAqLw0KPiArDQo+
ICtzdGF0aWMgaW5saW5lIHZvaWQgcWNvbXRlZV9tc2dfc2V0X3Jlc3VsdChzdHJ1Y3QgcWNvbXRl
ZV9tc2dfY2FsbGJhY2sgKmNiX21zZywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgaW50IGVycikNCj4gK3sNCj4gKyAgICAgICBpZiAoIWVycikgew0KPiArICAg
ICAgICAgICAgICAgY2JfbXNnLT5yZXN1bHQgPSBRQ09NVEVFX01TR19PSzsNCj4gKyAgICAgICB9
IGVsc2UgaWYgKGVyciA8IDApIHsNCj4gKyAgICAgICAgICAgICAgIC8qIElmIGVyciA8IDAsIHRo
ZW4gaXQgaXMgYSB0cmFuc3BvcnQgZXJyb3IuICovDQo+ICsgICAgICAgICAgICAgICBzd2l0Y2gg
KGVycikgew0KPiArICAgICAgICAgICAgICAgY2FzZSAtRU5PTUVNOg0KPiArICAgICAgICAgICAg
ICAgICAgICAgICBjYl9tc2ctPnJlc3VsdCA9IFFDT01URUVfTVNHX0VSUk9SX0tNRU07DQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgY2FzZSAtRU5P
REVWOg0KPiArICAgICAgICAgICAgICAgICAgICAgICBjYl9tc2ctPnJlc3VsdCA9IFFDT01URUVf
TVNHX0VSUk9SX0RFRlVOQ1Q7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiAr
ICAgICAgICAgICAgICAgY2FzZSAtRU5PU1BDOg0KPiArICAgICAgICAgICAgICAgY2FzZSAtRUJV
U1k6DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNiX21zZy0+cmVzdWx0ID0gUUNPTVRFRV9N
U0dfRVJST1JfQlVTWTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ICsgICAg
ICAgICAgICAgICBjYXNlIC1FQkFERjoNCj4gKyAgICAgICAgICAgICAgIGNhc2UgLUVJTlZBTDoN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY2JfbXNnLT5yZXN1bHQgPSBRQ09NVEVFX01TR19F
UlJPUl9VTkFWQUlMOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAg
ICAgICAgICAgIGRlZmF1bHQ6DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNiX21zZy0+cmVz
dWx0ID0gUUNPTVRFRV9NU0dfRVJST1I7DQo+ICsgICAgICAgICAgICAgICB9DQo+ICsgICAgICAg
fSBlbHNlIHsNCj4gKyAgICAgICAgICAgICAgIC8qIElmIGVyciA+IDAsIHRoZW4gaXQgaXMgdXNl
ciBkZWZpbmVkIGVycm9yLCBwYXNzIGl0IGFzIGlzLiAqLw0KPiArICAgICAgICAgICAgICAgY2Jf
bXNnLT5yZXN1bHQgPSBlcnI7DQo+ICsgICAgICAgfQ0KPiArfQ0KPiArDQo+ICsjZW5kaWYgLyog
UUNPTVRFRV9NU0dfSCAqLw0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS9xY29t
dGVlX3ByaXZhdGUuaCBiL2RyaXZlcnMvdGVlL3Fjb210ZWUvcWNvbXRlZV9wcml2YXRlLmgNCj4g
bmV3IGZpbGUgbW9kZSAxMDA2NDQNCj4gaW5kZXggMDAwMDAwMDAwMDAwLi5hYjNhY2FkNDAzNTkN
Cj4gLS0tIC9kZXYvbnVsbA0KPiArKysgYi9kcml2ZXJzL3RlZS9xY29tdGVlL3Fjb210ZWVfcHJp
dmF0ZS5oDQo+IEBAIC0wLDAgKzEsMjIyIEBADQo+ICsvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmll
cjogR1BMLTIuMC1vbmx5ICovDQo+ICsvKg0KPiArICogQ29weXJpZ2h0IChjKSAyMDI0IFF1YWxj
b21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQo+ICsgKi8N
Cj4gKw0KPiArI2lmbmRlZiBRQ09NVEVFX1BSSVZBVEVfSA0KPiArI2RlZmluZSBRQ09NVEVFX1BS
SVZBVEVfSA0KPiArDQo+ICsjaW5jbHVkZSA8bGludXgvZmlybXdhcmUvcWNvbS9xY29tX3RlZS5o
Pg0KPiArI2luY2x1ZGUgPGxpbnV4L2tvYmplY3QuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC90ZWVf
Y29yZS5oPg0KPiArDQo+ICsjaW5jbHVkZSAicWNvbXRlZV9tc2cuaCINCj4gKw0KPiArLyogRmxh
Z3MgcmVsYXRpbmcgdG8gb2JqZWN0IHJlZmVyZW5jZS4gKi8NCj4gKyNkZWZpbmUgUUNPTVRFRV9P
QkpSRUZfRkxBR19URUUgQklUKDApDQo+ICsjZGVmaW5lIFFDT01URUVfT0JKUkVGX0ZMQUdfVVNF
UiBCSVQoMSkNCj4gKw0KPiArLyoqDQo+ICsgKiBzdHJ1Y3QgcWNvbXRlZSAtIE1haW4gc2Vydmlj
ZSBzdHJ1Y3QuDQo+ICsgKiBAdGVlZGV2OiBjbGllbnQgZGV2aWNlLg0KPiArICogQHBvb2w6IHNo
YXJlZCBtZW1vcnkgcG9vbC4NCj4gKyAqIEBjdHg6IGRyaXZlciBwcml2YXRlIGNvbnRleHQuDQo+
ICsgKiBAd3E6IHdvcmtxdWV1ZSBmb3IgUVRFRSBhc3luYyBvcGVyYXRpb25zLg0KPiArICovDQo+
ICtzdHJ1Y3QgcWNvbXRlZSB7DQo+ICsgICAgICAgc3RydWN0IHRlZV9kZXZpY2UgKnRlZWRldjsN
Cj4gKyAgICAgICBzdHJ1Y3QgdGVlX3NobV9wb29sICpwb29sOw0KPiArICAgICAgIHN0cnVjdCB0
ZWVfY29udGV4dCAqY3R4Ow0KPiArICAgICAgIHN0cnVjdCB3b3JrcXVldWVfc3RydWN0ICp3cTsN
Cj4gK307DQo+ICsNCj4gK3N0cnVjdCBxY29tdGVlX29iamVjdCAqcWNvbXRlZV9pZHhfZXJhc2Uo
dTMyIGlkeCk7DQo+ICt2b2lkIHFjb210ZWVfcXRlZV9vYmplY3RfZnJlZShzdHJ1Y3QgcWNvbXRl
ZV9vYmplY3QgKm9iamVjdCk7DQo+ICt2b2lkIHFjb210ZWVfZmV0Y2hfYXN5bmNfcmVxcyhzdHJ1
Y3QgcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eCAqb2ljKTsNCj4gK3ZvaWQgcWNvbXRlZV9yZWxl
YXNlX3RlZV9vYmplY3Qoc3RydWN0IHFjb210ZWVfb2JqZWN0ICpvYmplY3QpOw0KPiArDQo+ICtz
dHJ1Y3QgdGVlX3NobV9wb29sICpxY29tdGVlX3NobV9wb29sX2FsbG9jKHZvaWQpOw0KPiArdm9p
ZCBxY29tdGVlX21zZ19idWZmZXJzX2ZyZWUoc3RydWN0IHFjb210ZWVfb2JqZWN0X2ludm9rZV9j
dHggKm9pYyk7DQo+ICtpbnQgcWNvbXRlZV9tc2dfYnVmZmVyc19hbGxvYyhzdHJ1Y3QgcWNvbXRl
ZV9vYmplY3RfaW52b2tlX2N0eCAqb2ljLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgcWNvbXRlZV9hcmcgKnUpOw0KPiArDQo+ICtpbnQgcWNvbXRlZV9vYmplY3RfaW52
b2tlX2N0eF9pbnZva2Uoc3RydWN0IHFjb210ZWVfb2JqZWN0X2ludm9rZV9jdHggKm9pYywNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGludCAqcmVzdWx0LCB1NjQgKnJl
c190eXBlKTsNCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX29iamVjdF9kb19pbnZva2VfaW50
ZXJuYWwoKSAtIFN1Ym1pdCBhbiBpbnZvY2F0aW9uIGZvciBhbiBvYmplY3QuDQo+ICsgKiBAb2lj
OiBjb250ZXh0IHRvIHVzZSBmb3IgdGhlIGN1cnJlbnQgaW52b2NhdGlvbi4NCj4gKyAqIEBvYmpl
Y3Q6IG9iamVjdCBiZWluZyBpbnZva2VkLg0KPiArICogQG9wOiByZXF1ZXN0ZWQgb3BlcmF0aW9u
IG9uIHRoZSBvYmplY3QuDQo+ICsgKiBAdTogYXJyYXkgb2YgYXJndW1lbnRzIGZvciB0aGUgY3Vy
cmVudCBpbnZvY2F0aW9uLg0KPiArICogQHJlc3VsdDogcmVzdWx0IHJldHVybmVkIGZyb20gUVRF
RS4NCj4gKyAqDQo+ICsgKiBUaGUgY2FsbGVyIGlzIHJlc3BvbnNpYmxlIGZvciBrZWVwaW5nIHRy
YWNrIG9mIHRoZSByZWZjb3VudCBmb3IgZWFjaA0KPiArICogb2JqZWN0LCBpbmNsdWRpbmcgQG9i
amVjdC4gT24gcmV0dXJuLCB0aGUgY2FsbGVyIGxvc2VzIG93bmVyc2hpcCBvZiBhbGwNCj4gKyAq
IGlucHV0IG9iamVjdHMgb2YgdHlwZSAlUUNPTVRFRV9PQkpFQ1RfVFlQRV9DQi4NCj4gKyAqDQo+
ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMC4gT24gZXJyb3IsIHJldHVybnMgLUVB
R0FJTiBpZiBpbnZvY2F0aW9uDQo+ICsgKiBmYWlsZWQgYW5kIHRoZSB1c2VyIG1heSByZXRyeSB0
aGUgaW52b2NhdGlvbiwgLUVOT0RFViBvbiBmYXRhbCBmYWlsdXJlLg0KPiArICovDQo+ICtpbnQg
cWNvbXRlZV9vYmplY3RfZG9faW52b2tlX2ludGVybmFsKHN0cnVjdCBxY29tdGVlX29iamVjdF9p
bnZva2VfY3R4ICpvaWMsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c3RydWN0IHFjb210ZWVfb2JqZWN0ICpvYmplY3QsIHUzMiBvcCwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9hcmcgKnUsIGludCAqcmVzdWx0
KTsNCj4gKw0KPiArLyoqDQo+ICsgKiBzdHJ1Y3QgcWNvbXRlZV9jb250ZXh0X2RhdGEgLSBDbGll
bnRzJyBvciBzdXBwbGljYW50cycgY29udGV4dC4NCj4gKyAqIEBxdGVlX29iamVjdHNfaWRyOiBR
VEVFIG9iamVjdHMgaW4gdGhpcyBjb250ZXh0Lg0KPiArICogQHF0ZWVfbG9jazogc3BpbmxvY2sg
Zm9yIEBxdGVlX29iamVjdHNfaWRyLg0KPiArICogQHJlcXNfaWRyOiByZXF1ZXN0cyBjdXJyZW50
bHkgYmVpbmcgcHJvY2Vzc2VkIGluIHRoaXMgY29udGV4dC4NCj4gKyAqIEByZXFzX2xpc3Q6IEZJ
Rk8gZm9yIHJlcXVlc3RzLg0KPiArICogQHJlcXNfbG9jazogbXV0ZXggZm9yIEByZXFzX2lkciwg
QHJlcXNfbGlzdCBhbmQgcmVxdWVzdCBzdGF0ZXMuDQo+ICsgKiBAcmVxX2M6IGNvbXBsZXRpb24g
dXNlZCB3aGVuIHRoZSBzdXBwbGljYW50IGlzIHdhaXRpbmcgZm9yIHJlcXVlc3RzLg0KPiArICog
QHJlbGVhc2VkOiBzdGF0ZSBvZiB0aGlzIGNvbnRleHQuDQo+ICsgKi8NCj4gK3N0cnVjdCBxY29t
dGVlX2NvbnRleHRfZGF0YSB7DQo+ICsgICAgICAgc3RydWN0IGlkciBxdGVlX29iamVjdHNfaWRy
Ow0KPiArICAgICAgIC8qIFN5bmNocm9uaXplIGFjY2VzcyB0byBAcXRlZV9vYmplY3RzX2lkci4g
Ki8NCj4gKyAgICAgICBzcGlubG9ja190IHF0ZWVfbG9jazsNCj4gKw0KPiArICAgICAgIHN0cnVj
dCBpZHIgcmVxc19pZHI7DQo+ICsgICAgICAgc3RydWN0IGxpc3RfaGVhZCByZXFzX2xpc3Q7DQo+
ICsgICAgICAgLyogU3luY2hyb25pemUgYWNjZXNzIHRvIEByZXFzX2lkciwgQHJlcXNfbGlzdCBh
bmQgdXBkYXRpbmcgcmVxdWVzdHMgc3RhdGVzLiAqLw0KPiArICAgICAgIHN0cnVjdCBtdXRleCBy
ZXFzX2xvY2s7DQo+ICsNCj4gKyAgICAgICBzdHJ1Y3QgY29tcGxldGlvbiByZXFfYzsNCj4gKw0K
PiArICAgICAgIGludCByZWxlYXNlZDsNCg0KU2hvdWxkIHRoaXMgcmF0aGVyIGJlIGEgYm9vbCwg
b3IgYW4gZW51bSBkZXBlbmRpbmcgb24gaG93IG1hbnkNCmRpZmZlcmVudCBzdGF0ZXMgaXQncyBz
dXBwb3NlZCB0byBoYXZlPw0KDQo+ICt9Ow0KPiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfY29u
dGV4dF9hZGRfcXRlZV9vYmplY3QoKSAtIEFkZCBhIFFURUUgb2JqZWN0IHRvIHRoZSBjb250ZXh0
Lg0KPiArICogQHBhcmFtOiBURUUgcGFyYW1ldGVyIHJlcHJlc2VudGluZyBAb2JqZWN0Lg0KPiAr
ICogQG9iamVjdDogUVRFRSBvYmplY3QuDQo+ICsgKiBAY3R4OiBjb250ZXh0IHRvIGFkZCB0aGUg
b2JqZWN0Lg0KPiArICoNCj4gKyAqIEl0IGFzc3VtZXMgQG9iamVjdCBpcyAlUUNPTVRFRV9PQkpF
Q1RfVFlQRV9URUUgYW5kIHRoZSBjYWxsZXIgaGFzIGFscmVhZHkNCj4gKyAqIGlzc3VlZCBxY29t
dGVlX29iamVjdF9nZXQoKSBmb3IgQG9iamVjdC4NCj4gKyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1
Y2Nlc3MsIHJldHVybnMgMDsgb24gZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK2lu
dCBxY29tdGVlX2NvbnRleHRfYWRkX3F0ZWVfb2JqZWN0KHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFt
LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9v
YmplY3QgKm9iamVjdCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Ry
dWN0IHRlZV9jb250ZXh0ICpjdHgpOw0KPiArDQo+ICsvKiBSZXRyaWV2ZSB0aGUgUVRFRSBvYmpl
Y3QgYWRkZWQgd2l0aCBxY29tdGVlX2NvbnRleHRfYWRkX3F0ZWVfb2JqZWN0KCkuICovDQo+ICtp
bnQgcWNvbXRlZV9jb250ZXh0X2ZpbmRfcXRlZV9vYmplY3Qoc3RydWN0IHFjb210ZWVfb2JqZWN0
ICoqb2JqZWN0LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHRlZV9wYXJhbSAqcGFyYW0sDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCk7DQo+ICsNCj4gKy8qKg0KPiArICogcWNvbXRlZV9j
b250ZXh0X2RlbF9xdGVlX29iamVjdCgpIC0gRGVsZXRlIGEgUVRFRSBvYmplY3QgZnJvbSB0aGUg
Y29udGV4dC4NCj4gKyAqIEBwYXJhbTogVEVFIHBhcmFtZXRlciByZXByZXNlbnRpbmcgQG9iamVj
dC4NCj4gKyAqIEBjdHg6IGNvbnRleHQgZm9yIGRlbGV0aW5nIHRoZSBvYmplY3QuDQo+ICsgKg0K
PiArICogVGhlIEBwYXJhbSBoYXMgYmVlbiBpbml0aWFsaXplZCBieSBxY29tdGVlX2NvbnRleHRf
YWRkX3F0ZWVfb2JqZWN0KCkuDQo+ICsgKi8NCj4gK3ZvaWQgcWNvbXRlZV9jb250ZXh0X2RlbF9x
dGVlX29iamVjdChzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4KTsNCj4gKw0KPiArLyoq
DQo+ICsgKiBxY29tdGVlX29ianJlZl90b19hcmcoKSAtIENvbnZlcnQgT0JKUkVGIHBhcmFtZXRl
ciB0byBRVEVFIGFyZ3VtZW50Lg0KPiArICogQGFyZzogUVRFRSBhcmd1bWVudC4NCj4gKyAqIEBw
YXJhbTogVEVFIHBhcmFtZXRlci4NCj4gKyAqIEBjdHg6IGNvbnRleHQgaW4gd2hpY2ggdGhlIGNv
bnZlcnNpb24gc2hvdWxkIGhhcHBlbi4NCj4gKyAqDQo+ICsgKiBJdCBhc3N1bWVzIEBwYXJhbSBp
cyBhbiBPQkpSRUYuDQo+ICsgKiBJdCBkb2VzIG5vdCBzZXQgQGFyZy50eXBlOyB0aGUgY2FsbGVy
IHNob3VsZCBpbml0aWFsaXplIGl0IHRvIGEgY29ycmVjdA0KPiArICogJmVudW0gcWNvbXRlZV9h
cmdfdHlwZSB2YWx1ZS4gSXQgZ2V0cyB0aGUgb2JqZWN0J3MgcmVmY291bnQgaW4gQGFyZzsNCj4g
KyAqIHRoZSBjYWxsZXIgc2hvdWxkIG1hbmFnZSB0byBwdXQgaXQgYWZ0ZXJ3YXJkLg0KPiArICoN
Cj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJlLCByZXR1cm5z
IDwgMC4NCj4gKyAqLw0KPiAraW50IHFjb210ZWVfb2JqcmVmX3RvX2FyZyhzdHJ1Y3QgcWNvbXRl
ZV9hcmcgKmFyZywgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW0sDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgc3RydWN0IHRlZV9jb250ZXh0ICpjdHgpOw0KPiArDQo+ICsvKioNCj4gKyAqIHFj
b210ZWVfb2JqcmVmX2Zyb21fYXJnKCkgLSBDb252ZXJ0IFFURUUgYXJndW1lbnQgdG8gT0JKUkVG
IHBhcmFtLg0KPiArICogQHBhcmFtOiBURUUgcGFyYW1ldGVyLg0KPiArICogQGFyZzogUVRFRSBh
cmd1bWVudC4NCj4gKyAqIEBjdHg6IGNvbnRleHQgaW4gd2hpY2ggdGhlIGNvbnZlcnNpb24gc2hv
dWxkIGhhcHBlbi4NCj4gKyAqDQo+ICsgKiBJdCBhc3N1bWVzIEBhcmcgaXMgb2YgJVFDT01URUVf
QVJHX1RZUEVfSU8gb3IgJVFDT01URUVfQVJHX1RZUEVfT08uDQo+ICsgKiBJdCBkb2VzIG5vdCBz
ZXQgQHBhcmFtLmF0dHI7IHRoZSBjYWxsZXIgc2hvdWxkIGluaXRpYWxpemUgaXQgdG8gYQ0KPiAr
ICogY29ycmVjdCB0eXBlLg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJu
cyAwOyBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4NCj4gKyAqLw0KPiAraW50IHFjb210ZWVfb2Jq
cmVmX2Zyb21fYXJnKHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtLCBzdHJ1Y3QgcWNvbXRlZV9hcmcg
KmFyZywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfY29udGV4dCAq
Y3R4KTsNCj4gKw0KPiArLyogT0JKRUNUUzogKi8NCj4gKw0KPiArLyogKDEpIFVzZXIgT2JqZWN0
IEFQSS4gKi8NCj4gKw0KPiArLyogSXMgaXQgYSB1c2VyIG9iamVjdD8gKi8NCj4gK2ludCBpc19x
Y29tdGVlX3VzZXJfb2JqZWN0KHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0KTsNCj4gKw0K
PiArLyogU2V0IHRoZSB1c2VyIG9iamVjdCdzICdub3RpZnkgb24gcmVsZWFzZScgZmxhZy4gKi8N
Cj4gK3ZvaWQgcWNvbXRlZV91c2VyX29iamVjdF9zZXRfbm90aWZ5KHN0cnVjdCBxY29tdGVlX29i
amVjdCAqb2JqZWN0LCBib29sIG5vdGlmeSk7DQo+ICsNCj4gKy8qIFRoaXMgaXMgY2FsbGVkIHdo
ZW4gdGhlcmUgYXJlIG5vIG1vcmUgdXNlcnMgZm9yIHRoZSBjdHhkYXRhLiAqLw0KPiArdm9pZCBx
Y29tdGVlX3JlcXVlc3RzX2Rlc3Ryb3koc3RydWN0IHFjb210ZWVfY29udGV4dF9kYXRhICpjdHhk
YXRhKTsNCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX3VzZXJfcGFyYW1fdG9fb2JqZWN0KCkg
LSBPQkpSRUYgcGFyYW1ldGVyIHRvICZzdHJ1Y3QgcWNvbXRlZV9vYmplY3QuDQo+ICsgKiBAb2Jq
ZWN0OiBvYmplY3QgcmV0dXJuZWQuDQo+ICsgKiBAcGFyYW06IFRFRSBwYXJhbWV0ZXIuDQo+ICsg
KiBAY3R4OiBjb250ZXh0IGluIHdoaWNoIHRoZSBjb252ZXJzaW9uIHNob3VsZCBoYXBwZW4uDQo+
ICsgKg0KPiArICogQHBhcmFtIGlzIGFuIE9CSlJFRiB3aXRoICVRQ09NVEVFX09CSlJFRl9GTEFH
X1VTRVIgZmxhZ3MuDQo+ICsgKg0KPiArICogUmV0dXJuOiBPbiBzdWNjZXNzLCByZXR1cm5zIDA7
IG9uIGZhaWx1cmUsIHJldHVybnMgPCAwLg0KPiArICovDQo+ICtpbnQgcWNvbXRlZV91c2VyX3Bh
cmFtX3RvX29iamVjdChzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKipvYmplY3QsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfcGFyYW0gKnBhcmFtLA0KPiArICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCk7DQo+
ICsNCj4gKy8qIFJldmVyc2Ugd2hhdCBxY29tdGVlX3VzZXJfcGFyYW1fdG9fb2JqZWN0KCkgZG9l
cy4gKi8NCj4gK2ludCBxY29tdGVlX3VzZXJfcGFyYW1fZnJvbV9vYmplY3Qoc3RydWN0IHRlZV9w
YXJhbSAqcGFyYW0sDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHFjb210ZWVfb2JqZWN0ICpvYmplY3QsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgc3RydWN0IHRlZV9jb250ZXh0ICpjdHgpOw0KPiArDQo+ICtzdHJ1Y3QgcWNvbXRlZV91
c2VyX29iamVjdF9yZXF1ZXN0X2RhdGEgew0KPiArICAgICAgIGludCBpZDsgLyogSUQgYXNzaWdu
ZWQgdG8gdGhlIHJlcXVlc3QuICovDQo+ICsgICAgICAgdTY0IG9iamVjdF9pZDsgLyogT2JqZWN0
IElEIGJlaW5nIGludm9rZWQgYnkgUVRFRS4gKi8NCj4gKyAgICAgICB1MzIgb3A7IC8qIFJlcXVl
c3RlZCBvcGVyYXRpb24gb24gb2JqZWN0LiAqLw0KPiArICAgICAgIGludCBucDsgLyogTnVtYmVy
IG9mIHBhcmFtZXRlcnMgaW4gdGhlIHJlcXVlc3QuKi8NCj4gK307DQo+ICsNCj4gKy8qKg0KPiAr
ICogcWNvbXRlZV91c2VyX29iamVjdF9zZWxlY3QoKSAtIFNlbGVjdCBhIHJlcXVlc3QgZm9yIGEg
dXNlciBvYmplY3QuDQo+ICsgKiBAY3R4OiBjb250ZXh0IHRvIGxvb2sgZm9yIGEgdXNlciBvYmpl
Y3QuDQo+ICsgKiBAcGFyYW1zOiBwYXJhbWV0ZXJzIGZvciBAb3AuDQo+ICsgKiBAbnVtX3BhcmFt
czogbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBwYXJhbWV0ZXIgYXJyYXkuDQo+ICsgKiBAdWFk
ZHI6IHVzZXIgYnVmZmVyIGZvciBvdXRwdXQgVUJVRiBwYXJhbWV0ZXJzLg0KPiArICogQHNpemU6
IHNpemUgb2YgdXNlciBidWZmZXIgQHVhZGRyLg0KPiArICogQGRhdGE6IGluZm9ybWF0aW9uIGZv
ciB0aGUgc2VsZWN0ZWQgcmVxdWVzdC4NCj4gKyAqDQo+ICsgKiBAcGFyYW1zIGlzIGZpbGxlZCBh
bG9uZyB3aXRoIEBkYXRhIGZvciB0aGUgc2VsZWN0ZWQgcmVxdWVzdC4NCj4gKyAqDQo+ICsgKiBS
ZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMDsgb24gZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+
ICsgKi8NCj4gK2ludCBxY29tdGVlX3VzZXJfb2JqZWN0X3NlbGVjdChzdHJ1Y3QgdGVlX2NvbnRl
eHQgKmN0eCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfcGFy
YW0gKnBhcmFtcywgaW50IG51bV9wYXJhbXMsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB2b2lkIF9fdXNlciAqdWFkZHIsIHNpemVfdCBzaXplLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IHFjb210ZWVfdXNlcl9vYmplY3RfcmVxdWVzdF9kYXRhICpk
YXRhKTsNCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX3VzZXJfb2JqZWN0X3N1Ym1pdCgpIC0g
U3VibWl0IGEgcmVzcG9uc2UgZm9yIGEgdXNlciBvYmplY3QuDQo+ICsgKiBAY3R4OiBjb250ZXh0
IHRvIGxvb2sgZm9yIGEgdXNlciBvYmplY3QuDQo+ICsgKiBAcGFyYW1zOiByZXR1cm5lZCBwYXJh
bWV0ZXJzLg0KPiArICogQG51bV9wYXJhbXM6IG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgcGFy
YW1ldGVyIGFycmF5Lg0KPiArICogQHJlcV9pZDogcmVxdWVzdCBJRCBmb3IgdGhlIHJlc3BvbnNl
Lg0KPiArICogQGVycm5vOiByZXN1bHQgb2YgdXNlciBvYmplY3QgaW52b2NhdGlvbi4NCj4gKyAq
DQo+ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMDsgb24gZmFpbHVyZSwgcmV0dXJu
cyA8IDAuDQo+ICsgKi8NCj4gK2ludCBxY29tdGVlX3VzZXJfb2JqZWN0X3N1Ym1pdChzdHJ1Y3Qg
dGVlX2NvbnRleHQgKmN0eCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCB0ZWVfcGFyYW0gKnBhcmFtcywgaW50IG51bV9wYXJhbXMsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpbnQgcmVxX2lkLCBpbnQgZXJybm8pOw0KPiArDQo+ICsjZW5kaWYgLyog
UUNPTVRFRV9QUklWQVRFX0ggKi8NCj4gZGlmZiAtLWdpdCBhL2RyaXZlcnMvdGVlL3Fjb210ZWUv
cmVsZWFzZS5jIGIvZHJpdmVycy90ZWUvcWNvbXRlZS9yZWxlYXNlLmMNCj4gbmV3IGZpbGUgbW9k
ZSAxMDA2NDQNCj4gaW5kZXggMDAwMDAwMDAwMDAwLi43ZDE0OWVmM2QyNmYNCj4gLS0tIC9kZXYv
bnVsbA0KPiArKysgYi9kcml2ZXJzL3RlZS9xY29tdGVlL3JlbGVhc2UuYw0KPiBAQCAtMCwwICsx
LDQ4IEBADQo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5DQo+ICsv
Kg0KPiArICogQ29weXJpZ2h0IChjKSAyMDI0IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJ
bmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQo+ICsgKi8NCj4gKw0KPiArI2luY2x1ZGUgInFjb210
ZWVfcHJpdmF0ZS5oIg0KPiArDQo+ICtzdGF0aWMgdm9pZCBxY29tdGVlX2Rlc3Ryb3lfdXNlcl9v
YmplY3Qoc3RydWN0IHdvcmtfc3RydWN0ICp3b3JrKQ0KPiArew0KPiArICAgICAgIHN0cnVjdCBx
Y29tdGVlX29iamVjdCAqb2JqZWN0Ow0KPiArICAgICAgIHN0cnVjdCBxY29tdGVlICpxY29tdGVl
Ow0KPiArICAgICAgIGludCByZXQsIHJlc3VsdDsNCj4gKw0KPiArICAgICAgIHN0YXRpYyBzdHJ1
Y3QgcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eCBvaWM7DQo+ICsgICAgICAgLyogUkVMRUFTRSBk
b2VzIG5vdCByZXF1aXJlIGFueSBhcmd1bWVudC4gKi8NCj4gKyAgICAgICBzdGF0aWMgc3RydWN0
IHFjb210ZWVfYXJnIGFyZ3NbXSA9IHsgeyAudHlwZSA9IFFDT01URUVfQVJHX1RZUEVfSU5WIH0g
fTsNCj4gKw0KPiArICAgICAgIG9iamVjdCA9IGNvbnRhaW5lcl9vZih3b3JrLCBzdHJ1Y3QgcWNv
bXRlZV9vYmplY3QsIHdvcmspOw0KPiArICAgICAgIHFjb210ZWUgPSB0ZWVfZ2V0X2RydmRhdGEo
b2JqZWN0LT5pbmZvLnFjb210ZWVfYXN5bmNfY3R4LT50ZWVkZXYpOw0KPiArICAgICAgIC8qIEdl
dCB0aGUgVEVFIGNvbnRleHQgdXNlZCBmb3IgYXN5bmNocm9ub3VzIG9wZXJhdGlvbnMuICovDQo+
ICsgICAgICAgb2ljLmN0eCA9IG9iamVjdC0+aW5mby5xY29tdGVlX2FzeW5jX2N0eDsNCj4gKw0K
PiArICAgICAgIHJldCA9IHFjb210ZWVfb2JqZWN0X2RvX2ludm9rZV9pbnRlcm5hbCgmb2ljLCBv
YmplY3QsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IFFDT01URUVfTVNHX09CSkVDVF9PUF9SRUxFQVNFLA0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhcmdzLCAmcmVzdWx0KTsNCj4gKw0KPiArICAgICAg
IC8qIElzIGl0IHNhZmUgdG8gcmV0cnkgdGhlIHJlbGVhc2U/ICovDQo+ICsgICAgICAgaWYgKHJl
dCA9PSAtRUFHQUlOKSB7DQo+ICsgICAgICAgICAgICAgICBxdWV1ZV93b3JrKHFjb210ZWUtPndx
LCAmb2JqZWN0LT53b3JrKTsNCj4gKyAgICAgICB9IGVsc2Ugew0KPiArICAgICAgICAgICAgICAg
aWYgKHJldCB8fCByZXN1bHQpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHByX2VycigiJXM6
ICVzIHJlbGVhc2UgZmFpbGVkLCByZXQgPSAlZCAoJXgpLlxuIiwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIF9fZnVuY19fLCBxY29tdGVlX29iamVjdF9uYW1lKG9iamVjdCksIHJl
dCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCk7DQo+ICsNCj4gKyAg
ICAgICAgICAgICAgIHFjb210ZWVfcXRlZV9vYmplY3RfZnJlZShvYmplY3QpOw0KPiArICAgICAg
IH0NCj4gK30NCj4gKw0KPiArLyogcWNvbXRlZV9yZWxlYXNlX3RlZV9vYmplY3QgcHV0cyBvYmpl
Y3QgaW4gcmVsZWFzZSB3b3JrIHF1ZXVlLiAqLw0KPiArdm9pZCBxY29tdGVlX3JlbGVhc2VfdGVl
X29iamVjdChzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdCkNCj4gK3sNCj4gKyAgICAgICBz
dHJ1Y3QgcWNvbXRlZSAqcWNvbXRlZSA9DQo+ICsgICAgICAgICAgICAgICB0ZWVfZ2V0X2RydmRh
dGEob2JqZWN0LT5pbmZvLnFjb210ZWVfYXN5bmNfY3R4LT50ZWVkZXYpOw0KPiArDQo+ICsgICAg
ICAgSU5JVF9XT1JLKCZvYmplY3QtPndvcmssIHFjb210ZWVfZGVzdHJveV91c2VyX29iamVjdCk7
DQo+ICsgICAgICAgcXVldWVfd29yayhxY29tdGVlLT53cSwgJm9iamVjdC0+d29yayk7DQo+ICt9
DQo+IGRpZmYgLS1naXQgYS9kcml2ZXJzL3RlZS9xY29tdGVlL3NobS5jIGIvZHJpdmVycy90ZWUv
cWNvbXRlZS9zaG0uYw0KPiBuZXcgZmlsZSBtb2RlIDEwMDY0NA0KPiBpbmRleCAwMDAwMDAwMDAw
MDAuLjk5OGFhYmU5NjQzNA0KPiAtLS0gL2Rldi9udWxsDQo+ICsrKyBiL2RyaXZlcnMvdGVlL3Fj
b210ZWUvc2htLmMNCj4gQEAgLTAsMCArMSwxNDkgQEANCj4gKy8vIFNQRFgtTGljZW5zZS1JZGVu
dGlmaWVyOiBHUEwtMi4wLW9ubHkNCj4gKy8qDQo+ICsgKiBDb3B5cmlnaHQgKGMpIDIwMjQgUXVh
bGNvbW0gSW5ub3ZhdGlvbiBDZW50ZXIsIEluYy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4NCj4gKyAq
Lw0KPiArDQo+ICsjZGVmaW5lIHByX2ZtdChmbXQpIEtCVUlMRF9NT0ROQU1FICI6ICIgZm10DQo+
ICsNCj4gKyNpbmNsdWRlIDxsaW51eC9maXJtd2FyZS9xY29tL3Fjb21fdHptZW0uaD4NCj4gKyNp
bmNsdWRlIDxsaW51eC9tbS5oPg0KPiArDQo+ICsjaW5jbHVkZSAicWNvbXRlZV9tc2cuaCINCj4g
KyNpbmNsdWRlICJxY29tdGVlX3ByaXZhdGUuaCINCj4gKw0KPiArLyoqDQo+ICsgKiBkZWZpbmUg
TUFYX09VVEJPVU5EX0JVRkZFUl9TSVpFIC0gTWF4aW11bSBzaXplIG9mIG91dGJvdW5kIGJ1ZmZl
cnMuDQo+ICsgKg0KPiArICogVGhlIHNpemUgb2Ygb3V0Ym91bmQgYnVmZmVyIGRlcGVuZHMgb24g
UVRFRSBjYWxsYmFjayByZXF1ZXN0cy4NCj4gKyAqIElmIGFuIGludm9jYXRpb24gcmVxdWlyZXMg
YW55IHNpemUgbGFyZ2VyIHRoYW4gJU1BWF9PVVRCT1VORF9CVUZGRVJfU0laRSwNCj4gKyAqIHRo
ZSB1c2VyIHNob3VsZCBwcm9iYWJseSB1c2Ugc29tZSBvdGhlciBmb3JtIG9mIHNoYXJlZCBtZW1v
cnkgd2l0aCBRVEVFLg0KPiArICovDQo+ICsjZGVmaW5lIE1BWF9PVVRCT1VORF9CVUZGRVJfU0la
RSBTWl80Sw0KPiArDQo+ICsvKiBTYW1lIGFzICVNQVhfT1VUQk9VTkRfQlVGRkVSX1NJWkUgYnV0
IGZvciBpbmJvdW5kIGJ1ZmZlci4gKi8NCj4gKyNkZWZpbmUgTUFYX0lOQk9VTkRfQlVGRkVSX1NJ
WkUgU1pfNE0NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX21zZ19idWZmZXJzX2FsbG9jKCkg
LSBBbGxvY2F0ZSBpbmJvdW5kIGFuZCBvdXRib3VuZCBidWZmZXJzLg0KPiArICogQG9pYzogY29u
dGV4dCB0byB1c2UgZm9yIHRoZSBjdXJyZW50IGludm9jYXRpb24uDQo+ICsgKiBAdTogYXJyYXkg
b2YgYXJndW1lbnRzIGZvciB0aGUgY3VycmVudCBpbnZvY2F0aW9uLg0KPiArICoNCj4gKyAqIEl0
IGNhbGN1bGF0ZXMgdGhlIHNpemUgb2YgaW5ib3VuZCBhbmQgb3V0Ym91bmQgYnVmZmVycyBiYXNl
ZCBvbiB0aGUNCj4gKyAqIGFyZ3VtZW50cyBpbiBAdS4gSXQgYWxsb2NhdGVzIHRoZSBidWZmZXJz
IGZyb20gdGhlIHRlZWRldiBwb29sLg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2Vzcywg
cmV0dXJucyAwLiBPbiBlcnJvciwgcmV0dXJucyA8IDAuDQo+ICsgKi8NCj4gK2ludCBxY29tdGVl
X21zZ19idWZmZXJzX2FsbG9jKHN0cnVjdCBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4ICpvaWMs
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBxY29tdGVlX2FyZyAqdSkN
Cj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCA9IG9pYy0+Y3R4Ow0KPiAr
ICAgICAgIHN0cnVjdCB0ZWVfc2htICpzaG07DQo+ICsgICAgICAgc2l6ZV90IHNpemU7DQo+ICsg
ICAgICAgaW50IGk7DQo+ICsNCj4gKyAgICAgICAvKiBTdGFydCBvZmZzZXQgaW4gYSBtZXNzYWdl
IGZvciBidWZmZXIgYXJndW1lbnRzLiAqLw0KPiArICAgICAgIHNpemUgPSBxY29tdGVlX21zZ19i
dWZmZXJfYXJncyhzdHJ1Y3QgcWNvbXRlZV9tc2dfb2JqZWN0X2ludm9rZSwNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcWNvbXRlZV9hcmdzX2xlbih1KSk7DQo+ICsg
ICAgICAgaWYgKHNpemUgPiBNQVhfSU5CT1VORF9CVUZGRVJfU0laRSkNCj4gKyAgICAgICAgICAg
ICAgIHJldHVybiAtRUlOVkFMOw0KPiArDQo+ICsgICAgICAgLyogQWRkIHNpemUgb2YgSUIgYXJn
dW1lbnRzLiAqLw0KPiArICAgICAgIHFjb210ZWVfYXJnX2Zvcl9lYWNoX2lucHV0X2J1ZmZlcihp
LCB1KSB7DQo+ICsgICAgICAgICAgICAgICBzaXplID0gc2l6ZV9hZGQoc2l6ZSwgcWNvbXRlZV9t
c2dfb2Zmc2V0X2FsaWduKHVbaV0uYi5zaXplKSk7DQo+ICsgICAgICAgICAgICAgICBpZiAoc2l6
ZSA+IE1BWF9JTkJPVU5EX0JVRkZFUl9TSVpFKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBy
ZXR1cm4gLUVJTlZBTDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICAvKiBBZGQgc2l6ZSBv
ZiBPQiBhcmd1bWVudHMuICovDQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfb3V0cHV0
X2J1ZmZlcihpLCB1KSB7DQo+ICsgICAgICAgICAgICAgICBzaXplID0gc2l6ZV9hZGQoc2l6ZSwg
cWNvbXRlZV9tc2dfb2Zmc2V0X2FsaWduKHVbaV0uYi5zaXplKSk7DQo+ICsgICAgICAgICAgICAg
ICBpZiAoc2l6ZSA+IE1BWF9JTkJPVU5EX0JVRkZFUl9TSVpFKQ0KPiArICAgICAgICAgICAgICAg
ICAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICBzaG0g
PSB0ZWVfc2htX2FsbG9jX3ByaXZfYnVmKGN0eCwgc2l6ZSk7DQo+ICsgICAgICAgaWYgKElTX0VS
UihzaG0pKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIoc2htKTsNCj4gKw0KPiAr
ICAgICAgIC8qIEFsbG9jYXRlIGluYm91bmQgYnVmZmVyLiAqLw0KPiArICAgICAgIG9pYy0+aW5f
c2htID0gc2htOw0KPiArICAgICAgIHNobSA9IHRlZV9zaG1fYWxsb2NfcHJpdl9idWYoY3R4LCBN
QVhfT1VUQk9VTkRfQlVGRkVSX1NJWkUpOw0KPiArICAgICAgIGlmIChJU19FUlIoc2htKSkgew0K
PiArICAgICAgICAgICAgICAgdGVlX3NobV9mcmVlKG9pYy0+aW5fc2htKTsNCj4gKw0KPiArICAg
ICAgICAgICAgICAgcmV0dXJuIFBUUl9FUlIoc2htKTsNCj4gKyAgICAgICB9DQo+ICsgICAgICAg
LyogQWxsb2NhdGUgb3V0Ym91bmQgYnVmZmVyLiAqLw0KPiArICAgICAgIG9pYy0+b3V0X3NobSA9
IHNobTsNCj4gKw0KPiArICAgICAgIG9pYy0+aW5fbXNnLmFkZHIgPSB0ZWVfc2htX2dldF92YShv
aWMtPmluX3NobSwgMCk7DQo+ICsgICAgICAgb2ljLT5pbl9tc2cuc2l6ZSA9IHRlZV9zaG1fZ2V0
X3NpemUob2ljLT5pbl9zaG0pOw0KPiArICAgICAgIG9pYy0+b3V0X21zZy5hZGRyID0gdGVlX3No
bV9nZXRfdmEob2ljLT5vdXRfc2htLCAwKTsNCj4gKyAgICAgICBvaWMtPm91dF9tc2cuc2l6ZSA9
IHRlZV9zaG1fZ2V0X3NpemUob2ljLT5vdXRfc2htKTsNCj4gKyAgICAgICAvKiBRVEVFIGFzc3Vt
ZSB1bnVzZWQgYnVmZmVycyBhcmUgemVyb2VkLiAqLw0KPiArICAgICAgIG1lbXplcm9fZXhwbGlj
aXQob2ljLT5pbl9tc2cuYWRkciwgb2ljLT5pbl9tc2cuc2l6ZSk7DQo+ICsgICAgICAgbWVtemVy
b19leHBsaWNpdChvaWMtPm91dF9tc2cuYWRkciwgb2ljLT5vdXRfbXNnLnNpemUpOw0KPiArDQo+
ICsgICAgICAgcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gK3ZvaWQgcWNvbXRlZV9tc2dfYnVmZmVy
c19mcmVlKHN0cnVjdCBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4ICpvaWMpDQo+ICt7DQo+ICsg
ICAgICAgdGVlX3NobV9mcmVlKG9pYy0+aW5fc2htKTsNCj4gKyAgICAgICB0ZWVfc2htX2ZyZWUo
b2ljLT5vdXRfc2htKTsNCj4gK30NCj4gKw0KPiArLyogRHluYW1pYyBzaGFyZWQgbWVtb3J5IHBv
b2wgYmFzZWQgb24gdGVlX2R5bl9zaG1fYWxsb2NfaGVscGVyKCkuICovDQo+ICsNCj4gK3N0YXRp
YyBpbnQgcWNvbXRlZV9zaG1fcmVnaXN0ZXIoc3RydWN0IHRlZV9jb250ZXh0ICpjdHgsIHN0cnVj
dCB0ZWVfc2htICpzaG0sDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0
IHBhZ2UgKipwYWdlcywgc2l6ZV90IG51bV9wYWdlcywNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICB1bnNpZ25lZCBsb25nIHN0YXJ0KQ0KPiArew0KPiArICAgICAgIHJldHVybiBx
Y29tX3R6bWVtX3NobV9icmlkZ2VfY3JlYXRlKHNobS0+cGFkZHIsIHNobS0+c2l6ZSwNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAmc2htLT5zZWNfd29ybGRf
aWQpOw0KPiArfQ0KPiArDQo+ICtzdGF0aWMgaW50IHFjb210ZWVfc2htX3VucmVnaXN0ZXIoc3Ry
dWN0IHRlZV9jb250ZXh0ICpjdHgsIHN0cnVjdCB0ZWVfc2htICpzaG0pDQo+ICt7DQo+ICsgICAg
ICAgcWNvbV90em1lbV9zaG1fYnJpZGdlX2RlbGV0ZShzaG0tPnNlY193b3JsZF9pZCk7DQo+ICsN
Cj4gKyAgICAgICByZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArc3RhdGljIGludCBwb29sX29wX2Fs
bG9jKHN0cnVjdCB0ZWVfc2htX3Bvb2wgKnBvb2wsIHN0cnVjdCB0ZWVfc2htICpzaG0sDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICBzaXplX3Qgc2l6ZSwgc2l6ZV90IGFsaWduKQ0KPiArew0K
PiArICAgICAgIGlmICghKHNobS0+ZmxhZ3MgJiBURUVfU0hNX1BSSVYpKQ0KPiArICAgICAgICAg
ICAgICAgcmV0dXJuIC1FTk9NRU07DQo+ICsNCj4gKyAgICAgICByZXR1cm4gdGVlX2R5bl9zaG1f
YWxsb2NfaGVscGVyKHNobSwgc2l6ZSwgYWxpZ24sIHFjb210ZWVfc2htX3JlZ2lzdGVyKTsNCj4g
K30NCj4gKw0KPiArc3RhdGljIHZvaWQgcG9vbF9vcF9mcmVlKHN0cnVjdCB0ZWVfc2htX3Bvb2wg
KnBvb2wsIHN0cnVjdCB0ZWVfc2htICpzaG0pDQo+ICt7DQo+ICsgICAgICAgdGVlX2R5bl9zaG1f
ZnJlZV9oZWxwZXIoc2htLCBxY29tdGVlX3NobV91bnJlZ2lzdGVyKTsNCj4gK30NCj4gKw0KPiAr
c3RhdGljIHZvaWQgcG9vbF9vcF9kZXN0cm95X3Bvb2woc3RydWN0IHRlZV9zaG1fcG9vbCAqcG9v
bCkNCj4gK3sNCj4gKyAgICAgICBrZnJlZShwb29sKTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGNv
bnN0IHN0cnVjdCB0ZWVfc2htX3Bvb2xfb3BzIHBvb2xfb3BzID0gew0KPiArICAgICAgIC5hbGxv
YyA9IHBvb2xfb3BfYWxsb2MsDQo+ICsgICAgICAgLmZyZWUgPSBwb29sX29wX2ZyZWUsDQo+ICsg
ICAgICAgLmRlc3Ryb3lfcG9vbCA9IHBvb2xfb3BfZGVzdHJveV9wb29sLA0KPiArfTsNCj4gKw0K
PiArc3RydWN0IHRlZV9zaG1fcG9vbCAqcWNvbXRlZV9zaG1fcG9vbF9hbGxvYyh2b2lkKQ0KPiAr
ew0KPiArICAgICAgIHN0cnVjdCB0ZWVfc2htX3Bvb2wgKnBvb2w7DQo+ICsNCj4gKyAgICAgICBw
b29sID0ga3phbGxvYyhzaXplb2YoKnBvb2wpLCBHRlBfS0VSTkVMKTsNCj4gKyAgICAgICBpZiAo
IXBvb2wpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gRVJSX1BUUigtRU5PTUVNKTsNCj4gKw0K
PiArICAgICAgIHBvb2wtPm9wcyA9ICZwb29sX29wczsNCj4gKw0KPiArICAgICAgIHJldHVybiBw
b29sOw0KPiArfQ0KPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy90ZWUvcWNvbXRlZS91c2VyX29iai5j
IGIvZHJpdmVycy90ZWUvcWNvbXRlZS91c2VyX29iai5jDQo+IG5ldyBmaWxlIG1vZGUgMTAwNjQ0
DQo+IGluZGV4IDAwMDAwMDAwMDAwMC4uOTVkMjJlNzIwZGU3DQo+IC0tLSAvZGV2L251bGwNCj4g
KysrIGIvZHJpdmVycy90ZWUvcWNvbXRlZS91c2VyX29iai5jDQo+IEBAIC0wLDAgKzEsNzEwIEBA
DQo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vbmx5DQo+ICsvKg0KPiAr
ICogQ29weXJpZ2h0IChjKSAyMDI0IFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJbmMuIEFs
bCByaWdodHMgcmVzZXJ2ZWQuDQo+ICsgKi8NCj4gKw0KPiArI2RlZmluZSBwcl9mbXQoZm10KSBL
QlVJTERfTU9ETkFNRSAiOiAiIGZtdA0KPiArDQo+ICsjaW5jbHVkZSA8bGludXgvc2xhYi5oPg0K
PiArI2luY2x1ZGUgInFjb210ZWVfcHJpdmF0ZS5oIg0KPiArDQo+ICsvKioNCj4gKyAqIERPQzog
VXNlciBPYmplY3RzIGFrYSBTdXBwbGljYW50cw0KPiArICoNCj4gKyAqIEFueSB1c2Vyc3BhY2Ug
cHJvY2VzcyB3aXRoIGFjY2VzcyB0byB0aGUgVEVFIGRldmljZSBmaWxlIGNhbiBiZWhhdmUgYXMg
YQ0KPiArICogc3VwcGxpY2FudCBieSBjcmVhdGluZyBhIHVzZXIgb2JqZWN0LiBBbnkgVEVFIHBh
cmFtZXRlciBvZiB0eXBlIE9CSlJFRiB3aXRoDQo+ICsgKiAlUUNPTVRFRV9PQkpSRUZfRkxBR19V
U0VSIGZsYWcgc2V0IGlzIGNvbnNpZGVyZWQgYSB1c2VyIG9iamVjdC4NCj4gKyAqDQo+ICsgKiBB
IHN1cHBsaWNhbnQgdXNlcyBxY29tdGVlX3VzZXJfb2JqZWN0X3NlbGVjdCgpIChpLmUuIFRFRV9J
T0NfU1VQUExfUkVDVikgdG8NCj4gKyAqIHJlY2VpdmUgYSBRVEVFIHVzZXIgb2JqZWN0IHJlcXVl
c3QgYW5kIHFjb210ZWVfdXNlcl9vYmplY3Rfc3VibWl0KCkNCj4gKyAqIChpLmUuIFRFRV9JT0Nf
U1VQUExfU0VORCkgdG8gc3VibWl0IGEgcmVzcG9uc2UuIFFURUUgZXhwZWN0cyB0byByZWNlaXZl
IHRoZQ0KPiArICogcmVzcG9uc2UsIGluY2x1ZGluZyBPQiBhbmQgT08gaW4gYSBzcGVjaWZpYyBv
cmRlciBpbiB0aGUgbWVzc2FnZTsgcGFyYW1ldGVycw0KPiArICogc3VibWl0dGVkIHdpdGggcWNv
bXRlZV91c2VyX29iamVjdF9zdWJtaXQoKSBzaG91bGQgbWFpbnRhaW4gdGhpcyBvcmRlci4NCj4g
KyAqLw0KPiArDQo+ICsvKioNCj4gKyAqIHN0cnVjdCBxY29tdGVlX3VzZXJfb2JqZWN0IC0gVXNl
ciBvYmplY3QuDQo+ICsgKiBAb2JqZWN0OiAmc3RydWN0IHFjb210ZWVfb2JqZWN0IHJlcHJlc2Vu
dGluZyB0aGlzIHVzZXIgb2JqZWN0Lg0KPiArICogQGN0eDogY29udGV4dCBmb3Igd2hpY2ggdGhl
IHVzZXIgb2JqZWN0IGlzIGRlZmluZWQuDQo+ICsgKiBAb2JqZWN0X2lkOiBvYmplY3QgSUQgaW4g
QGN0eC4NCj4gKyAqIEBub3I6IG5vdGlmeSBvbiByZWxlYXNlLg0KPiArICoNCj4gKyAqIEFueSBv
YmplY3QgbWFuYWdlZCBpbiB1c2Vyc3BhY2UgaXMgcmVwcmVzZW50ZWQgYnkgdGhpcyBzdHJ1Y3Qu
DQo+ICsgKiBJZiBAbm9yIGlzIHNldCwgYSBub3RpZmljYXRpb24gbWVzc2FnZSBpcyBzZW50IGJh
Y2sgdG8gdXNlcnNwYWNlDQo+ICsgKiB1cG9uIHJlbGVhc2UuDQo+ICsgKi8NCj4gK3N0cnVjdCBx
Y29tdGVlX3VzZXJfb2JqZWN0IHsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3Qgb2Jq
ZWN0Ow0KPiArICAgICAgIHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4Ow0KPiArICAgICAgIHU2NCBv
YmplY3RfaWQ7DQo+ICsgICAgICAgYm9vbCBub3I7DQo+ICt9Ow0KPiArDQo+ICsjZGVmaW5lIHRv
X3Fjb210ZWVfdXNlcl9vYmplY3QobykgXA0KPiArICAgICAgIGNvbnRhaW5lcl9vZigobyksIHN0
cnVjdCBxY29tdGVlX3VzZXJfb2JqZWN0LCBvYmplY3QpDQo+ICsNCj4gK3N0YXRpYyBzdHJ1Y3Qg
cWNvbXRlZV9vYmplY3Rfb3BlcmF0aW9ucyBxY29tdGVlX3VzZXJfb2JqZWN0X29wczsNCj4gKw0K
PiArLyogSXMgaXQgYSB1c2VyIG9iamVjdD8gKi8NCj4gK2ludCBpc19xY29tdGVlX3VzZXJfb2Jq
ZWN0KHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0KQ0KPiArew0KPiArICAgICAgIHJldHVy
biBvYmplY3QgIT0gTlVMTF9RQ09NVEVFX09CSkVDVCAmJg0KPiArICAgICAgICAgICAgICB0eXBl
b2ZfcWNvbXRlZV9vYmplY3Qob2JqZWN0KSA9PSBRQ09NVEVFX09CSkVDVF9UWVBFX0NCICYmDQo+
ICsgICAgICAgICAgICAgIG9iamVjdC0+b3BzID09ICZxY29tdGVlX3VzZXJfb2JqZWN0X29wczsN
Cj4gK30NCj4gKw0KPiArLyogU2V0IHRoZSB1c2VyIG9iamVjdCdzICdub3RpZnkgb24gcmVsZWFz
ZScgZmxhZy4gKi8NCj4gK3ZvaWQgcWNvbXRlZV91c2VyX29iamVjdF9zZXRfbm90aWZ5KHN0cnVj
dCBxY29tdGVlX29iamVjdCAqb2JqZWN0LCBib29sIG5vdGlmeSkNCj4gK3sNCj4gKyAgICAgICBp
ZiAoaXNfcWNvbXRlZV91c2VyX29iamVjdChvYmplY3QpKQ0KPiArICAgICAgICAgICAgICAgdG9f
cWNvbXRlZV91c2VyX29iamVjdChvYmplY3QpLT5ub3IgPSBub3RpZnk7DQo+ICt9DQo+ICsNCj4g
Ky8qIFN1cHBsaWNhbnQgUmVxdWVzdHM6ICovDQo+ICsNCj4gKy8qKg0KPiArICogZW51bSBxY29t
dGVlX3JlcV9zdGF0ZSAtIEN1cnJlbnQgc3RhdGUgb2YgcmVxdWVzdC4NCj4gKyAqIEBRQ09NVEVF
X1JFUV9RVUVVRUQ6IFJlcXVlc3QgaXMgd2FpdGluZyBmb3Igc3VwcGxpY2FudC4NCj4gKyAqIEBR
Q09NVEVFX1JFUV9QUk9DRVNTSU5HOiBSZXF1ZXN0IGhhcyBiZWVuIHBpY2tlZCBieSB0aGUgc3Vw
cGxpY2FudC4NCj4gKyAqIEBRQ09NVEVFX1JFUV9QUk9DRVNTRUQ6IFJlc3BvbnNlIGhhcyBiZWVu
IHN1Ym1pdHRlZCBmb3IgdGhlIHJlcXVlc3QuDQo+ICsgKi8NCj4gK2VudW0gcWNvbXRlZV9yZXFf
c3RhdGUgew0KPiArICAgICAgIFFDT01URUVfUkVRX1FVRVVFRCA9IDEsDQo+ICsgICAgICAgUUNP
TVRFRV9SRVFfUFJPQ0VTU0lORywNCj4gKyAgICAgICBRQ09NVEVFX1JFUV9QUk9DRVNTRUQsDQo+
ICt9Ow0KPiArDQo+ICsvKiBVc2VyIHJlcXVlc3RzIHNlbnQgdG8gc3VwcGxpY2FudHMuICovDQo+
ICtzdHJ1Y3QgcWNvbXRlZV91cmVxIHsNCj4gKyAgICAgICBlbnVtIHFjb210ZWVfcmVxX3N0YXRl
IHN0YXRlOw0KPiArDQo+ICsgICAgICAgLyogVXNlciBSZXF1ZXN0OiAqLw0KPiArICAgICAgIGlu
dCByZXFfaWQ7DQo+ICsgICAgICAgdTY0IG9iamVjdF9pZDsNCj4gKyAgICAgICB1MzIgb3A7DQo+
ICsgICAgICAgc3RydWN0IHFjb210ZWVfYXJnICphcmdzOw0KPiArICAgICAgIGludCBlcnJubzsN
Cj4gKw0KPiArICAgICAgIHN0cnVjdCBsaXN0X2hlYWQgbm9kZTsNCj4gKyAgICAgICBzdHJ1Y3Qg
Y29tcGxldGlvbiBjOyAvKiBDb21wbGV0aW9uIGZvciB3aG9ldmVyIHdhaXQuICovDQo+ICt9Ow0K
PiArDQo+ICsvKg0KPiArICogUGxhY2Vob2xkZXIgZm9yIGEgUFJPQ0VTU0lORyByZXF1ZXN0IGlu
IHFjb210ZWVfY29udGV4dC5yZXFzX2lkci4NCj4gKyAqDQo+ICsgKiBJZiB0aGUgdGhyZWFkIHRo
YXQgY2FsbHMgcWNvbXRlZV9vYmplY3RfaW52b2tlKCkgZGllcyBhbmQgdGhlIHN1cHBsaWNhbnQN
Cj4gKyAqIGlzIHByb2Nlc3NpbmcgdGhlIHJlcXVlc3QsIHdlIHJlcGxhY2UgdGhlIGVudHJ5IGlu
IHFjb210ZWVfY29udGV4dC5yZXFzX2lkcg0KPiArICogd2l0aCBlbXB0eV91cmVxLiBUaGlzIGVu
c3VyZXMgdGhhdCAoMSkgdGhlIHJlcV9pZCByZW1haW5zIGJ1c3kgYW5kIGlzIG5vdA0KPiArICog
cmV1c2VkLCBhbmQgKDIpIHRoZSBzdXBwbGljYW50IGZhaWxzIHRvIHN1Ym1pdCB0aGUgcmVzcG9u
c2UgYW5kIHBlcmZvcm1zDQo+ICsgKiB0aGUgbmVjZXNzYXJ5IHJvbGxiYWNrLg0KPiArICovDQo+
ICtzdGF0aWMgc3RydWN0IHFjb210ZWVfdXJlcSBlbXB0eV91cmVxID0geyAuc3RhdGUgPSBRQ09N
VEVFX1JFUV9QUk9DRVNTSU5HIH07DQo+ICsNCj4gKy8qIEVucXVldWUgYSB1c2VyIHJlcXVlc3Qg
Zm9yIGEgY29udGV4dCBhbmQgYXNzaWduIGEgcmVxdWVzdCBJRC4gKi8NCj4gK3N0YXRpYyBpbnQg
dXJlcV9lbnF1ZXVlKHN0cnVjdCBxY29tdGVlX2NvbnRleHRfZGF0YSAqY3R4ZGF0YSwNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210ZWVfdXJlcSAqdXJlcSkNCj4gK3sNCj4g
KyAgICAgICBpbnQgcmV0Ow0KPiArDQo+ICsgICAgICAgZ3VhcmQobXV0ZXgpKCZjdHhkYXRhLT5y
ZXFzX2xvY2spOw0KPiArICAgICAgIC8qIFN1cHBsaWNhbnQgaXMgZHlpbmcuICovDQo+ICsgICAg
ICAgaWYgKGN0eGRhdGEtPnJlbGVhc2VkKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1FTk9E
RVY7DQo+ICsNCj4gKyAgICAgICAvKiBBbGxvY2F0ZSBhbiBJRCBhbmQgcXVldWUgdGhlIHJlcXVl
c3QuICovDQo+ICsgICAgICAgcmV0ID0gaWRyX2FsbG9jKCZjdHhkYXRhLT5yZXFzX2lkciwgdXJl
cSwgMCwgMCwgR0ZQX0tFUk5FTCk7DQo+ICsgICAgICAgaWYgKHJldCA8IDApDQo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gcmV0Ow0KPiArDQo+ICsgICAgICAgdXJlcS0+cmVxX2lkID0gcmV0Ow0K
PiArICAgICAgIHVyZXEtPnN0YXRlID0gUUNPTVRFRV9SRVFfUVVFVUVEOw0KPiArICAgICAgIGxp
c3RfYWRkX3RhaWwoJnVyZXEtPm5vZGUsICZjdHhkYXRhLT5yZXFzX2xpc3QpOw0KPiArDQo+ICsg
ICAgICAgcmV0dXJuIDA7DQo+ICt9DQo+ICsNCj4gKy8qKg0KPiArICogdXJlcV9kZXF1ZXVlKCkg
LSBEZXF1ZXVlIGEgdXNlciByZXF1ZXN0IGZyb20gYSBjb250ZXh0Lg0KPiArICogQGN0eGRhdGE6
IGNvbnRleHQgZGF0YSBmb3IgYSBjb250ZXh0IHRvIGRlcXVldWUgdGhlIHJlcXVlc3QuDQo+ICsg
KiBAcmVxX2lkOiBJRCBvZiB0aGUgcmVxdWVzdCB0byBiZSBkZXF1ZXVlZC4NCj4gKyAqDQo+ICsg
KiBJdCBkZXF1ZXVlcyBhIHVzZXIgcmVxdWVzdCBhbmQgcmVsZWFzZXMgaXRzIHJlcXVlc3QgSUQu
DQo+ICsgKg0KPiArICogQ29udGV4dDogVGhlIGNhbGxlciBzaG91bGQgaG9sZCAmcWNvbXRlZV9j
b250ZXh0X2RhdGEtPnJlcXNfbG9jay4NCj4gKyAqIFJldHVybjogUmV0dXJucyB0aGUgdXNlciBy
ZXF1ZXN0IGFzc29jaWF0ZWQgd2l0aCB0aGlzIElEOyBvdGhlcndpc2UsIE5VTEwuDQo+ICsgKi8N
Cj4gK3N0YXRpYyBzdHJ1Y3QgcWNvbXRlZV91cmVxICp1cmVxX2RlcXVldWUoc3RydWN0IHFjb210
ZWVfY29udGV4dF9kYXRhICpjdHhkYXRhLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGludCByZXFfaWQpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHFjb210ZWVf
dXJlcSAqdXJlcTsNCj4gKw0KPiArICAgICAgIHVyZXEgPSBpZHJfcmVtb3ZlKCZjdHhkYXRhLT5y
ZXFzX2lkciwgcmVxX2lkKTsNCj4gKyAgICAgICBpZiAodXJlcSA9PSAmZW1wdHlfdXJlcSB8fCAh
dXJlcSkNCj4gKyAgICAgICAgICAgICAgIHJldHVybiBOVUxMOw0KPiArDQo+ICsgICAgICAgbGlz
dF9kZWwoJnVyZXEtPm5vZGUpOw0KPiArDQo+ICsgICAgICAgcmV0dXJuIHVyZXE7DQo+ICt9DQo+
ICsNCj4gKy8qKg0KPiArICogdXJlcV9yZXBsYWNlKCkgLSBSZXBsYWNlIGEgdXNlciByZXF1ZXN0
Lg0KPiArICogQGN0eGRhdGE6IGNvbnRleHQgZGF0YSBmb3IgYSBjb250ZXh0IHRvIHJlcGxhY2Ug
dGhlIHJlcXVlc3QuDQo+ICsgKiBAdXJlcTogcmVxdWVzdCB0byBiZSByZXBsYWNlZC4NCj4gKyAq
IEB1cmVxX25ldzogcmVxdWVzdCB0byByZXBsYWNlIGl0IHdpdGguDQo+ICsgKg0KPiArICogQ29u
dGV4dDogVGhlIGNhbGxlciBzaG91bGQgaG9sZCAmcWNvbXRlZV9jb250ZXh0X2RhdGEtPnJlcXNf
bG9jay4NCj4gKyAqLw0KPiArc3RhdGljIHZvaWQgdXJlcV9yZXBsYWNlKHN0cnVjdCBxY29tdGVl
X2NvbnRleHRfZGF0YSAqY3R4ZGF0YSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVj
dCBxY29tdGVlX3VyZXEgKnVyZXEsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
cWNvbXRlZV91cmVxICp1cmVxX25ldykNCj4gK3sNCj4gKyAgICAgICBpZHJfcmVwbGFjZSgmY3R4
ZGF0YS0+cmVxc19pZHIsIHVyZXFfbmV3LCB1cmVxLT5yZXFfaWQpOw0KPiArICAgICAgIC8qIHVy
ZXEgZG9lcyBub3QgaGF2ZSBhIHZhbGlkIElEIGFueW1vcmU7IHJlbW92ZSBpdCBmcm9tIHRoZSBx
dWV1ZS4gKi8NCj4gKyAgICAgICBsaXN0X2RlbCgmdXJlcS0+bm9kZSk7DQo+ICt9DQo+ICsNCj4g
Ky8qKg0KPiArICogdXJlcV9zZWxlY3QoKSAtIFNlbGVjdCB0aGUgbmV4dCByZXF1ZXN0IGluIGEg
Y29udGV4dC4NCj4gKyAqIEBjdHhkYXRhOiBjb250ZXh0IGRhdGEgZm9yIGEgY29udGV4dCB0byBw
b3AgYSByZXF1ZXN0Lg0KPiArICogQHVidWZfc2l6ZTogc2l6ZSBvZiB0aGUgYXZhaWxhYmxlIGJ1
ZmZlciBmb3IgVUJVRiBwYXJhbWV0ZXJzLg0KPiArICogQG51bV9wYXJhbXM6IG51bWJlciBvZiBl
bnRyaWVzIGZvciB0aGUgVEVFIHBhcmFtZXRlciBhcnJheS4NCj4gKyAqDQo+ICsgKiBJdCBjaGVj
a3MgaWYgQG51bV9wYXJhbXMgaXMgbGFyZ2UgZW5vdWdoIHRvIGZpdCB0aGUgbmV4dCByZXF1ZXN0
IGFyZ3VtZW50cy4NCj4gKyAqIEl0IGNoZWNrcyBpZiBAdWJ1Zl9zaXplIGlzIGxhcmdlIGVub3Vn
aCB0byBmaXQgSUIgYnVmZmVyIGFyZ3VtZW50cy4NCj4gKyAqDQo+ICsgKiBDb250ZXh0OiBUaGUg
Y2FsbGVyIHNob3VsZCBob2xkICZxY29tdGVlX2NvbnRleHRfZGF0YS0+cmVxc19sb2NrLg0KPiAr
ICogUmV0dXJuOiBPbiBzdWNjZXNzLCByZXR1cm5zIGEgcmVxdWVzdDsNCj4gKyAqICAgICAgICAg
b24gZmFpbHVyZSwgcmV0dXJucyBOVUxMIGFuZCBFUlJfUFRSLg0KPiArICovDQo+ICtzdGF0aWMg
c3RydWN0IHFjb210ZWVfdXJlcSAqdXJlcV9zZWxlY3Qoc3RydWN0IHFjb210ZWVfY29udGV4dF9k
YXRhICpjdHhkYXRhLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
c2l6ZV90IHVidWZfc2l6ZSwgaW50IG51bV9wYXJhbXMpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0
IHFjb210ZWVfdXJlcSAqcmVxLCAqdXJlcSA9IE5VTEw7DQo+ICsgICAgICAgc3RydWN0IHFjb210
ZWVfYXJnICp1Ow0KPiArICAgICAgIGludCBpOw0KPiArDQo+ICsgICAgICAgLyogRmluZCB0aGUg
YSBxdWV1ZWQgcmVxdWVzdC4gKi8NCj4gKyAgICAgICBsaXN0X2Zvcl9lYWNoX2VudHJ5KHJlcSwg
JmN0eGRhdGEtPnJlcXNfbGlzdCwgbm9kZSkgew0KPiArICAgICAgICAgICAgICAgaWYgKHJlcS0+
c3RhdGUgPT0gUUNPTVRFRV9SRVFfUVVFVUVEKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IHVyZXEgPSByZXE7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAg
ICAgICAgICAgfQ0KPiArICAgICAgIH0NCj4gKw0KPiArICAgICAgIGlmICghdXJlcSkNCj4gKyAg
ICAgICAgICAgICAgIHJldHVybiBOVUxMOw0KPiArDQo+ICsgICAgICAgdSA9IHVyZXEtPmFyZ3M7
DQo+ICsgICAgICAgLyogKDEpIElzIHRoZXJlIGVub3VnaCBURUUgcGFyYW1ldGVycz8gKi8NCj4g
KyAgICAgICBpZiAobnVtX3BhcmFtcyA8IHFjb210ZWVfYXJnc19sZW4odSkpDQo+ICsgICAgICAg
ICAgICAgICByZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsNCj4gKyAgICAgICAvKiAoMikgSXMgdGhl
cmUgZW5vdWdoIHNwYWNlIHRvIHBhc3MgaW5wdXQgYnVmZmVycz8gKi8NCj4gKyAgICAgICBxY29t
dGVlX2FyZ19mb3JfZWFjaF9pbnB1dF9idWZmZXIoaSwgdSkgew0KPiArICAgICAgICAgICAgICAg
dWJ1Zl9zaXplID0gc2l6ZV9zdWIodWJ1Zl9zaXplLCB1W2ldLmIuc2l6ZSk7DQo+ICsgICAgICAg
ICAgICAgICBpZiAodWJ1Zl9zaXplID09IFNJWkVfTUFYKQ0KPiArICAgICAgICAgICAgICAgICAg
ICAgICByZXR1cm4gRVJSX1BUUigtRUlOVkFMKTsNCj4gKw0KPiArICAgICAgICAgICAgICAgdWJ1
Zl9zaXplID0gcm91bmRfZG93bih1YnVmX3NpemUsIDgpOw0KPiArICAgICAgIH0NCj4gKw0KPiAr
ICAgICAgIHJldHVybiB1cmVxOw0KPiArfQ0KPiArDQo+ICsvKiBUaGlzIGlzIGNhbGxlZCB3aGVu
IHRoZXJlIGFyZSBubyBtb3JlIHVzZXJzIGZvciB0aGUgY3R4ZGF0YS4gKi8NCj4gK3ZvaWQgcWNv
bXRlZV9yZXF1ZXN0c19kZXN0cm95KHN0cnVjdCBxY29tdGVlX2NvbnRleHRfZGF0YSAqY3R4ZGF0
YSkNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV91cmVxICpyZXEsICp1cmVxOw0KPiAr
DQo+ICsgICAgICAgZ3VhcmQobXV0ZXgpKCZjdHhkYXRhLT5yZXFzX2xvY2spOw0KPiArICAgICAg
IC8qIFNvIHVyZXFfZW5xdWV1ZSgpIHJlZnVzZXMgbmV3IHJlcXVlc3RzIGZyb20gUVRFRS4gKi8N
Cj4gKyAgICAgICBjdHhkYXRhLT5yZWxlYXNlZCA9IDE7DQoNCk1hZ2ljIG51bWJlcj8NCg0KPiAr
DQo+ICsgICAgICAgbGlzdF9mb3JfZWFjaF9lbnRyeV9zYWZlKHVyZXEsIHJlcSwgJmN0eGRhdGEt
PnJlcXNfbGlzdCwgbm9kZSkgew0KPiArICAgICAgICAgICAgICAgdXJlcV9kZXF1ZXVlKGN0eGRh
dGEsIHVyZXEtPnJlcV9pZCk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgIC8qDQo+ICsgICAgICAg
ICAgICAgICAgKiBUZXJtaW5hdGUgcmVxdWVzdHMuDQo+ICsgICAgICAgICAgICAgICAgKiBEZXBl
bmRpbmcgb24gd2hvIGVucXVldWVzIHRoZSB1cmVxLCB0aGVyZSBtYXkgYmUgc29tZW9uZQ0KPiAr
ICAgICAgICAgICAgICAgICogd2FpdGluZyBmb3IgdGhlIHJlc3BvbnNlIG9yIG5vdDoNCj4gKyAg
ICAgICAgICAgICAgICAqLw0KPiArICAgICAgICAgICAgICAgaWYgKHVyZXEtPm9wICE9IFFDT01U
RUVfTVNHX09CSkVDVF9PUF9SRUxFQVNFKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8q
ICgxKSBlbnF1ZXVlZCBieSBxY29tdGVlX3VzZXJfb2JqZWN0X2Rpc3BhdGNoKCkuICovDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHVyZXEtPnN0YXRlID0gUUNPTVRFRV9SRVFfUFJPQ0VTU0VE
Ow0KPiArICAgICAgICAgICAgICAgICAgICAgICB1cmVxLT5lcnJubyA9IC1FTk9ERVY7DQo+ICsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGUoJnVyZXEtPmMpOw0KPiArICAgICAg
ICAgICAgICAgfSBlbHNlIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgLyogKDIpIGVucXVl
dWVkIGJ5IHFjb210ZWVfdXNlcl9vYmplY3RfcmVsZWFzZSgpLiAqLw0KPiArICAgICAgICAgICAg
ICAgICAgICAgICBrZnJlZSh1cmVxKTsNCj4gKyAgICAgICAgICAgICAgIH0NCj4gKyAgICAgICB9
DQo+ICt9DQo+ICsNCj4gKy8qIFVzZXIgT2JqZWN0IEFQSS4gKi8NCj4gKw0KPiArLyogVXNlciBv
YmplY3QgZGlzcGF0Y2hlci4gKi8NCj4gK3N0YXRpYyBpbnQgcWNvbXRlZV91c2VyX29iamVjdF9k
aXNwYXRjaChzdHJ1Y3QgcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eCAqb2ljLA0KPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210ZWVfb2JqZWN0ICpv
YmplY3QsIHUzMiBvcCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHN0cnVjdCBxY29tdGVlX2FyZyAqYXJncykNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRl
ZV91c2VyX29iamVjdCAqdW8gPSB0b19xY29tdGVlX3VzZXJfb2JqZWN0KG9iamVjdCk7DQo+ICsg
ICAgICAgc3RydWN0IHFjb210ZWVfY29udGV4dF9kYXRhICpjdHhkYXRhID0gdW8tPmN0eC0+ZGF0
YTsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV91cmVxICp1cmVxIF9fZnJlZShrZnJlZSkgPSBO
VUxMOw0KPiArICAgICAgIGludCBlcnJubzsNCj4gKw0KPiArICAgICAgIHVyZXEgPSBremFsbG9j
KHNpemVvZigqdXJlcSksIEdGUF9LRVJORUwpOw0KPiArICAgICAgIGlmICghdXJlcSkNCj4gKyAg
ICAgICAgICAgICAgIHJldHVybiAtRU5PTUVNOw0KPiArDQo+ICsgICAgICAgaW5pdF9jb21wbGV0
aW9uKCZ1cmVxLT5jKTsNCj4gKyAgICAgICB1cmVxLT5vYmplY3RfaWQgPSB1by0+b2JqZWN0X2lk
Ow0KPiArICAgICAgIHVyZXEtPm9wID0gb3A7DQo+ICsgICAgICAgdXJlcS0+YXJncyA9IGFyZ3M7
DQo+ICsNCj4gKyAgICAgICAvKiBRdWV1ZSB0aGUgcmVxdWVzdC4gKi8NCj4gKyAgICAgICBpZiAo
dXJlcV9lbnF1ZXVlKGN0eGRhdGEsIHVyZXEpKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1F
Tk9ERVY7DQo+ICsNCj4gKyAgICAgICAvKiBXYWtldXAgc3VwcGxpY2FudCB0byBwcm9jZXNzIGl0
LiAqLw0KPiArICAgICAgIGNvbXBsZXRlKCZjdHhkYXRhLT5yZXFfYyk7DQo+ICsNCj4gKyAgICAg
ICAvKg0KPiArICAgICAgICAqIFdhaXQgZm9yIHRoZSBzdXBwbGljYW50IHRvIHByb2Nlc3MgdGhl
IHJlcXVlc3QuDQo+ICsgICAgICAgICoNCj4gKyAgICAgICAgKiBUaGUgc3VwcGxpY2FudCBpcyBl
eHBlY3RlZCB0byBwcm9jZXNzIHRoZSByZXF1ZXN0IGluIGEgdGltZWx5IG1hbm5lci4NCj4gKyAg
ICAgICAgKiBXZSB3YWl0IGFzIEtJTExBQkxFIGluIGNhc2UgdGhlIHN1cHBsaWNhbnQgYW5kIGlu
dm9rZSB0aHJlYWQgYXJlDQo+ICsgICAgICAgICogYm90aCBydW5uaW5nIGZyb20gdGhlIHNhbWUg
dXNlciBwcm9jZXNzOyBvdGhlcndpc2UsIHRoZSBwcm9jZXNzDQo+ICsgICAgICAgICogd2lsbCBi
ZSBzdHVjayBvbiBhIGZhdGFsIHNpZ25hbC4NCj4gKyAgICAgICAgKi8NCj4gKyAgICAgICBpZiAo
IXdhaXRfZm9yX2NvbXBsZXRpb25fc3RhdGUoJnVyZXEtPmMsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIFRBU0tfS0lMTEFCTEUgfCBUQVNLX0ZSRUVaQUJMRSkpIHsN
Cj4gKyAgICAgICAgICAgICAgIGVycm5vID0gdXJlcS0+ZXJybm87DQo+ICsgICAgICAgICAgICAg
ICAvKiBPbiBzdWNjZXNzLCBub3RpZnkoKSBmcmVlcyB0aGUgcmVxdWVzdC4gKi8NCj4gKyAgICAg
ICAgICAgICAgIGlmICghZXJybm8pDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIG9pYy0+ZGF0
YSA9IG5vX2ZyZWVfcHRyKHVyZXEpOw0KPiArICAgICAgIH0gZWxzZSB7DQo+ICsgICAgICAgICAg
ICAgICBlbnVtIHFjb210ZWVfcmVxX3N0YXRlIHByZXZfc3RhdGU7DQo+ICsNCj4gKyAgICAgICAg
ICAgICAgIGVycm5vID0gLUVOT0RFVjsNCj4gKw0KPiArICAgICAgICAgICAgICAgc2NvcGVkX2d1
YXJkKG11dGV4LCAmY3R4ZGF0YS0+cmVxc19sb2NrKSB7DQo+ICsgICAgICAgICAgICAgICAgICAg
ICAgIHByZXZfc3RhdGUgPSB1cmVxLT5zdGF0ZTsNCj4gKw0KPiArICAgICAgICAgICAgICAgICAg
ICAgICAvKiBSZXBsYWNlIHdpdGggZW1wdHlfdXJlcSB0byBrZWVwIHJlcV9pZCByZXNlcnZlZC4g
Ki8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHByZXZfc3RhdGUgPT0gUUNPTVRFRV9S
RVFfUFJPQ0VTU0lORykNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmVxX3Jl
cGxhY2UoY3R4ZGF0YSwgdXJlcSwgJmVtcHR5X3VyZXEpOw0KPiArDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIC8qIFJlbW92ZSBhcyBzdXBwbGljYW50IGhhcyBuZXZlciBzZWVuIHRoaXMgcmVx
dWVzdC4gKi8NCj4gKyAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAocHJldl9zdGF0ZSA9
PSBRQ09NVEVFX1JFUV9RVUVVRUQpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
dXJlcV9kZXF1ZXVlKGN0eGRhdGEsIHVyZXEtPnJlcV9pZCk7DQo+ICsgICAgICAgICAgICAgICB9
DQo+ICsNCj4gKyAgICAgICAgICAgICAgIC8qIFN1cHBsaWNhbnQgZGlkIHNvbWUgd29yaywgd2Ug
c2hvdWxkIG5vdCBkaXNjYXJkIGl0LiAqLw0KPiArICAgICAgICAgICAgICAgaWYgKHByZXZfc3Rh
dGUgPT0gUUNPTVRFRV9SRVFfUFJPQ0VTU0VEKSB7DQo+ICsgICAgICAgICAgICAgICAgICAgICAg
IGVycm5vID0gdXJlcS0+ZXJybm87DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8qIE9uIHN1
Y2Nlc3MsIG5vdGlmeSgpIGZyZWVzIHRoZSByZXF1ZXN0LiAqLw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBpZiAoIWVycm5vKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9p
Yy0+ZGF0YSA9IG5vX2ZyZWVfcHRyKHVyZXEpOw0KPiArICAgICAgICAgICAgICAgfQ0KPiArICAg
ICAgIH0NCj4gKw0KPiArICAgICAgIHJldHVybiBlcnJubzsNCj4gK30NCj4gKw0KPiArLyogVGhp
cyBpcyBjYWxsZWQgYWZ0ZXIgc3VibWl0dGluZyB0aGUgZGlzcGF0Y2hlciByZXNwb25zZS4gKi8N
Cj4gK3N0YXRpYyB2b2lkIHFjb210ZWVfdXNlcl9vYmplY3Rfbm90aWZ5KHN0cnVjdCBxY29tdGVl
X29iamVjdF9pbnZva2VfY3R4ICpvaWMsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIHN0cnVjdCBxY29tdGVlX29iamVjdCAqdW51c2VkX29iamVjdCwNCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW50IGVycikNCj4gK3sNCj4gKyAgICAg
ICBzdHJ1Y3QgcWNvbXRlZV91cmVxICp1cmVxID0gb2ljLT5kYXRhOw0KPiArICAgICAgIHN0cnVj
dCBxY29tdGVlX2FyZyAqdSA9IHVyZXEtPmFyZ3M7DQo+ICsgICAgICAgaW50IGk7DQo+ICsNCj4g
KyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF9vdXRwdXRfb2JqZWN0KGksIHUpIHsNCj4gKyAg
ICAgICAgICAgICAgIC8qDQo+ICsgICAgICAgICAgICAgICAgKiBJZiBlcnIsIHRoZXJlIHdhcyBh
IHRyYW5zcG9ydCBpc3N1ZSwgYW5kIFFURUUgZGlkIG5vdA0KPiArICAgICAgICAgICAgICAgICog
cmVjZWl2ZSB0aGUgcmVzcG9uc2UgZm9yIHRoZSBkaXNwYXRjaGVyLiBSZWxlYXNlIHRoZSBjYWxs
YmFjaw0KPiArICAgICAgICAgICAgICAgICogb2JqZWN0IGNyZWF0ZWQgZm9yIFFURUUsIGluIGFk
ZGl0aW9uIHRvIHRoZSBjb3BpZXMgb2YNCj4gKyAgICAgICAgICAgICAgICAqIG9iamVjdHMga2Vw
dCBmb3IgdGhlIGRyaXZlcnMuDQo+ICsgICAgICAgICAgICAgICAgKi8NCj4gKyAgICAgICAgICAg
ICAgIGlmIChlcnIgJiYNCj4gKyAgICAgICAgICAgICAgICAgICAodHlwZW9mX3Fjb210ZWVfb2Jq
ZWN0KHVbaV0ubykgPT0gUUNPTVRFRV9PQkpFQ1RfVFlQRV9DQikpDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIHFjb210ZWVfb2JqZWN0X3B1dCh1W2ldLm8pOw0KPiArICAgICAgICAgICAgICAg
cWNvbXRlZV9vYmplY3RfcHV0KHVbaV0ubyk7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAg
a2ZyZWUodXJlcSk7DQo+ICt9DQo+ICsNCj4gK3N0YXRpYyB2b2lkIHFjb210ZWVfdXNlcl9vYmpl
Y3RfcmVsZWFzZShzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdCkNCj4gK3sNCj4gKyAgICAg
ICBzdHJ1Y3QgcWNvbXRlZV91c2VyX29iamVjdCAqdW8gPSB0b19xY29tdGVlX3VzZXJfb2JqZWN0
KG9iamVjdCk7DQo+ICsgICAgICAgc3RydWN0IHFjb210ZWVfY29udGV4dF9kYXRhICpjdHhkYXRh
ID0gdW8tPmN0eC0+ZGF0YTsNCj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV91cmVxICp1cmVxOw0K
PiArDQo+ICsgICAgICAgLyogUkVMRUFTRSBkb2VzIG5vdCByZXF1aXJlIGFueSBhcmd1bWVudC4g
Ki8NCj4gKyAgICAgICBzdGF0aWMgc3RydWN0IHFjb210ZWVfYXJnIGFyZ3NbXSA9IHsgeyAudHlw
ZSA9IFFDT01URUVfQVJHX1RZUEVfSU5WIH0gfTsNCj4gKw0KPiArICAgICAgIGlmICghdW8tPm5v
cikNCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X25vX25vdGlmeTsNCj4gKw0KPiArICAgICAg
IHVyZXEgPSBremFsbG9jKHNpemVvZigqdXJlcSksIEdGUF9LRVJORUwpOw0KPiArICAgICAgIGlm
ICghdXJlcSkNCj4gKyAgICAgICAgICAgICAgIGdvdG8gb3V0X25vX25vdGlmeTsNCj4gKw0KPiAr
ICAgICAgIC8qIFFVRVVFIGEgcmVsZWFzZSByZXF1ZXN0OiAqLw0KPiArICAgICAgIHVyZXEtPm9i
amVjdF9pZCA9IHVvLT5vYmplY3RfaWQ7DQo+ICsgICAgICAgdXJlcS0+b3AgPSBRQ09NVEVFX01T
R19PQkpFQ1RfT1BfUkVMRUFTRTsNCj4gKyAgICAgICB1cmVxLT5hcmdzID0gYXJnczsNCj4gKyAg
ICAgICBpZiAodXJlcV9lbnF1ZXVlKGN0eGRhdGEsIHVyZXEpKSB7DQo+ICsgICAgICAgICAgICAg
ICBrZnJlZSh1cmVxKTsNCj4gKyAgICAgICAgICAgICAgIC8qIElnbm9yZSB0aGUgbm90aWZpY2F0
aW9uIGlmIGl0IGNhbm5vdCBiZSBxdWV1ZWQuICovDQo+ICsgICAgICAgICAgICAgICBnb3RvIG91
dF9ub19ub3RpZnk7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgY29tcGxldGUoJmN0eGRh
dGEtPnJlcV9jKTsNCj4gKw0KPiArb3V0X25vX25vdGlmeToNCj4gKyAgICAgICB0ZWVkZXZfY3R4
X3B1dCh1by0+Y3R4KTsNCj4gKyAgICAgICBrZnJlZSh1byk7DQo+ICt9DQo+ICsNCj4gK3N0YXRp
YyBzdHJ1Y3QgcWNvbXRlZV9vYmplY3Rfb3BlcmF0aW9ucyBxY29tdGVlX3VzZXJfb2JqZWN0X29w
cyA9IHsNCj4gKyAgICAgICAucmVsZWFzZSA9IHFjb210ZWVfdXNlcl9vYmplY3RfcmVsZWFzZSwN
Cj4gKyAgICAgICAubm90aWZ5ID0gcWNvbXRlZV91c2VyX29iamVjdF9ub3RpZnksDQo+ICsgICAg
ICAgLmRpc3BhdGNoID0gcWNvbXRlZV91c2VyX29iamVjdF9kaXNwYXRjaCwNCj4gK307DQo+ICsN
Cj4gKy8qKg0KPiArICogcWNvbXRlZV91c2VyX3BhcmFtX3RvX29iamVjdCgpIC0gT0JKUkVGIHBh
cmFtZXRlciB0byAmc3RydWN0IHFjb210ZWVfb2JqZWN0Lg0KPiArICogQG9iamVjdDogb2JqZWN0
IHJldHVybmVkLg0KPiArICogQHBhcmFtOiBURUUgcGFyYW1ldGVyLg0KPiArICogQGN0eDogY29u
dGV4dCBpbiB3aGljaCB0aGUgY29udmVyc2lvbiBzaG91bGQgaGFwcGVuLg0KPiArICoNCj4gKyAq
IEBwYXJhbSBpcyBhbiBPQkpSRUYgd2l0aCAlUUNPTVRFRV9PQkpSRUZfRkxBR19VU0VSIGZsYWdz
Lg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJl
LCByZXR1cm5zIDwgMC4NCj4gKyAqLw0KPiAraW50IHFjb210ZWVfdXNlcl9wYXJhbV90b19vYmpl
Y3Qoc3RydWN0IHFjb210ZWVfb2JqZWN0ICoqb2JqZWN0LA0KPiArICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgc3RydWN0IHRlZV9jb250ZXh0ICpjdHgpDQo+ICt7DQo+ICsgICAg
ICAgc3RydWN0IHFjb210ZWVfdXNlcl9vYmplY3QgKnVzZXJfb2JqZWN0IF9fZnJlZShrZnJlZSkg
PSBOVUxMOw0KPiArICAgICAgIGludCBlcnI7DQo+ICsNCj4gKyAgICAgICB1c2VyX29iamVjdCA9
IGt6YWxsb2Moc2l6ZW9mKCp1c2VyX29iamVjdCksIEdGUF9LRVJORUwpOw0KPiArICAgICAgIGlm
ICghdXNlcl9vYmplY3QpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gLUVOT01FTTsNCj4gKw0K
PiArICAgICAgIHVzZXJfb2JqZWN0LT5jdHggPSBjdHg7DQo+ICsgICAgICAgdXNlcl9vYmplY3Qt
Pm9iamVjdF9pZCA9IHBhcmFtLT51Lm9ianJlZi5pZDsNCj4gKyAgICAgICAvKiBCeSBkZWZhdWx0
LCBhbHdheXMgbm90aWZ5IHVzZXJzcGFjZSB1cG9uIHJlbGVhc2UuICovDQo+ICsgICAgICAgdXNl
cl9vYmplY3QtPm5vciA9IHRydWU7DQo+ICsgICAgICAgZXJyID0gcWNvbXRlZV9vYmplY3RfdXNl
cl9pbml0KCZ1c2VyX29iamVjdC0+b2JqZWN0LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBRQ09NVEVFX09CSkVDVF9UWVBFX0NCLA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAmcWNvbXRlZV91c2VyX29iamVjdF9vcHMsICJ1by0lbHUi
LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbS0+dS5vYmpy
ZWYuaWQpOw0KPiArICAgICAgIGlmIChlcnIpDQo+ICsgICAgICAgICAgICAgICByZXR1cm4gZXJy
Ow0KPiArDQo+ICsgICAgICAgdGVlZGV2X2N0eF9nZXQoY3R4KTsNCj4gKw0KPiArICAgICAgICpv
YmplY3QgPSAmbm9fZnJlZV9wdHIodXNlcl9vYmplY3QpLT5vYmplY3Q7DQo+ICsNCj4gKyAgICAg
ICByZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArLyogUmV2ZXJzZSB3aGF0IHFjb210ZWVfdXNlcl9w
YXJhbV90b19vYmplY3QoKSBkb2VzLiAqLw0KPiAraW50IHFjb210ZWVfdXNlcl9wYXJhbV9mcm9t
X29iamVjdChzdHJ1Y3QgdGVlX3BhcmFtICpwYXJhbSwNCj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdCwNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCkNCj4gK3sN
Cj4gKyAgICAgICBzdHJ1Y3QgcWNvbXRlZV91c2VyX29iamVjdCAqdW87DQo+ICsNCj4gKyAgICAg
ICB1byA9IHRvX3Fjb210ZWVfdXNlcl9vYmplY3Qob2JqZWN0KTsNCj4gKyAgICAgICAvKiBFbnN1
cmUgdGhlIG9iamVjdCBpcyBpbiB0aGUgc2FtZSBjb250ZXh0IGFzIHRoZSBjYWxsZXIuICovDQo+
ICsgICAgICAgaWYgKHVvLT5jdHggIT0gY3R4KQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIC1F
SU5WQUw7DQo+ICsNCj4gKyAgICAgICBwYXJhbS0+dS5vYmpyZWYuaWQgPSB1by0+b2JqZWN0X2lk
Ow0KPiArICAgICAgIHBhcmFtLT51Lm9ianJlZi5mbGFncyA9IFFDT01URUVfT0JKUkVGX0ZMQUdf
VVNFUjsNCj4gKw0KPiArICAgICAgIC8qIFVzZXIgb2JqZWN0cyBhcmUgdmFsaWQgaW4gdXNlcnNw
YWNlOyBkbyBub3Qga2VlcCBhIGNvcHkuICovDQo+ICsgICAgICAgcWNvbXRlZV9vYmplY3RfcHV0
KG9iamVjdCk7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gMDsNCj4gK30NCj4gKw0KPiArLyoqDQo+
ICsgKiBxY29tdGVlX2NiX3BhcmFtc19mcm9tX2FyZ3MoKSAtIENvbnZlcnQgUVRFRSBhcmd1bWVu
dHMgdG8gVEVFIHBhcmFtZXRlcnMuDQo+ICsgKiBAcGFyYW1zOiBURUUgcGFyYW1ldGVycy4NCj4g
KyAqIEB1OiBRVEVFIGFyZ3VtZW50cy4NCj4gKyAqIEBudW1fcGFyYW1zOiBudW1iZXIgb2YgZWxl
bWVudHMgaW4gdGhlIHBhcmFtZXRlciBhcnJheS4NCj4gKyAqIEB1YnVmX2FkZHI6IHVzZXIgYnVm
ZmVyIGZvciBhcmd1bWVudHMgb2YgdHlwZSAlUUNPTVRFRV9BUkdfVFlQRV9JQi4NCj4gKyAqIEB1
YnVmX3NpemU6IHNpemUgb2YgdGhlIHVzZXIgYnVmZmVyLg0KPiArICogQGN0eDogY29udGV4dCBp
biB3aGljaCB0aGUgY29udmVyc2lvbiBzaG91bGQgaGFwcGVuLg0KPiArICoNCj4gKyAqIEl0IGV4
cGVjdHMgQHBhcmFtcyB0byBoYXZlIGVub3VnaCBlbnRyaWVzIGZvciBAdS4gRW50cmllcyBpbiBA
cGFyYW1zIGFyZSBvZg0KPiArICogJVRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfTk9ORS4NCj4g
KyAqDQo+ICsgKiBSZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgdGhlIG51bWJlciBvZiBpbnB1
dCBwYXJhbWV0ZXJzOw0KPiArICogICAgICAgICBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4NCj4g
KyAqLw0KPiArc3RhdGljIGludCBxY29tdGVlX2NiX3BhcmFtc19mcm9tX2FyZ3Moc3RydWN0IHRl
ZV9wYXJhbSAqcGFyYW1zLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBzdHJ1Y3QgcWNvbXRlZV9hcmcgKnUsIGludCBudW1fcGFyYW1zLA0KPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICB2b2lkIF9fdXNlciAqdWJ1Zl9hZGRyLCBzaXplX3Qg
dWJ1Zl9zaXplLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1
Y3QgdGVlX2NvbnRleHQgKmN0eCkNCj4gK3sNCj4gKyAgICAgICBpbnQgaSwgbnA7DQo+ICsgICAg
ICAgdm9pZCBfX3VzZXIgKnVhZGRyOw0KPiArDQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2Vh
Y2goaSwgdSkgew0KPiArICAgICAgICAgICAgICAgc3dpdGNoICh1W2ldLnR5cGUpIHsNCj4gKyAg
ICAgICAgICAgICAgIGNhc2UgUUNPTVRFRV9BUkdfVFlQRV9JQjoNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgcGFyYW1zW2ldLmF0dHIgPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1VCVUZf
SU5QVVQ7DQo+ICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgLyogVW5kZXJmbG93IGFscmVh
ZHkgY2hlY2tlZCBpbiB1cmVxX3NlbGVjdCgpLiAqLw0KPiArICAgICAgICAgICAgICAgICAgICAg
ICB1YnVmX3NpemUgPSByb3VuZF9kb3duKHVidWZfc2l6ZSAtIHVbaV0uYi5zaXplLCA4KTsNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgdWFkZHIgPSAodm9pZCAqX191c2VyKSh1YnVmX2FkZHIg
KyB1YnVmX3NpemUpOw0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtc1tpXS51
LnVidWYudWFkZHIgPSB1YWRkcjsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zW2ld
LnUudWJ1Zi5zaXplID0gdVtpXS5iLnNpemU7DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlm
IChjb3B5X3RvX3VzZXIocGFyYW1zW2ldLnUudWJ1Zi51YWRkciwgdVtpXS5iLmFkZHIsDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdVtpXS5iLnNpemUpKQ0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ZhaWxlZDsNCj4gKw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAgICAgICAgICAgIGNhc2UgUUNP
TVRFRV9BUkdfVFlQRV9PQjoNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcGFyYW1zW2ldLmF0
dHIgPSBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1VCVUZfT1VUUFVUOw0KPiArICAgICAgICAg
ICAgICAgICAgICAgICAvKiBMZXQgdGhlIHVzZXIga25vd3MgdGhlIG1heGltdW0gc2l6ZSB3ZSBl
eHBlY3QuICovDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHBhcmFtc1tpXS51LnVidWYuc2l6
ZSA9IHVbaV0uYi5zaXplOw0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0K
PiArICAgICAgICAgICAgICAgY2FzZSBRQ09NVEVFX0FSR19UWVBFX0lPOg0KPiArICAgICAgICAg
ICAgICAgICAgICAgICBwYXJhbXNbaV0uYXR0ciA9IFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVf
T0JKUkVGX0lOUFVUOw0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocWNvbXRlZV9vYmpy
ZWZfZnJvbV9hcmcoJnBhcmFtc1tpXSwgJnVbaV0sIGN0eCkpDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBvdXRfZmFpbGVkOw0KPiArDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgY2FzZSBRQ09NVEVFX0FSR19UWVBFX09P
Og0KPiArICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXNbaV0uYXR0ciA9DQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9PQkpSRUZf
T1VUUFVUOw0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAg
ICAgICAgICAgZGVmYXVsdDogLyogTmV2ZXIgZ2V0IGhlcmUhICovDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGdvdG8gb3V0X2ZhaWxlZDsNCj4gKyAgICAgICAgICAgICAgIH0NCj4gKyAgICAg
ICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gaTsNCj4gKw0KPiArb3V0X2ZhaWxlZDoNCj4gKyAg
ICAgICAvKiBVbmRvIHFjb210ZWVfb2JqcmVmX2Zyb21fYXJnKCkuICovDQo+ICsgICAgICAgZm9y
IChucCA9IGk7IG5wID49IDA7IG5wLS0pIHsNCj4gKyAgICAgICAgICAgICAgIGlmIChwYXJhbXNb
bnBdLmF0dHIgPT0gVEVFX0lPQ1RMX1BBUkFNX0FUVFJfVFlQRV9PQkpSRUZfSU5QVVQpDQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIHFjb210ZWVfY29udGV4dF9kZWxfcXRlZV9vYmplY3QoJnBh
cmFtc1tucF0sIGN0eCk7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsgICAgICAgLyogUmVsZWFzZSBh
bnkgSU8gb2JqZWN0cyBub3QgcHJvY2Vzc2VkLiAqLw0KPiArICAgICAgIGZvciAoOyB1W2ldLnR5
cGU7IGkrKykgew0KPiArICAgICAgICAgICAgICAgaWYgKHVbaV0udHlwZSA9PSBRQ09NVEVFX0FS
R19UWVBFX0lPKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBxY29tdGVlX29iamVjdF9wdXQo
dVtpXS5vKTsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gLUVJTlZBTDsNCj4g
K30NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX2NiX3BhcmFtc190b19hcmdzKCkgLSBDb252
ZXJ0IFRFRSBwYXJhbWV0ZXJzIHRvIFFURUUgYXJndW1lbnRzLg0KPiArICogQHU6IFFURUUgYXJn
dW1lbnRzLg0KPiArICogQHBhcmFtczogVEVFIHBhcmFtZXRlcnMuDQo+ICsgKiBAbnVtX3BhcmFt
czogbnVtYmVyIG9mIGVsZW1lbnRzIGluIHRoZSBwYXJhbWV0ZXIgYXJyYXkuDQo+ICsgKiBAY3R4
OiBjb250ZXh0IGluIHdoaWNoIHRoZSBjb252ZXJzaW9uIHNob3VsZCBoYXBwZW4uDQo+ICsgKg0K
PiArICogUmV0dXJuOiBPbiBzdWNjZXNzLCByZXR1cm5zIDA7IG9uIGZhaWx1cmUsIHJldHVybnMg
PCAwLg0KPiArICovDQo+ICtzdGF0aWMgaW50IHFjb210ZWVfY2JfcGFyYW1zX3RvX2FyZ3Moc3Ry
dWN0IHFjb210ZWVfYXJnICp1LA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLCBpbnQgbnVtX3BhcmFtcywNCj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4KQ0KPiAr
ew0KPiArICAgICAgIGludCBpOw0KPiArDQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2go
aSwgdSkgew0KPiArICAgICAgICAgICAgICAgc3dpdGNoICh1W2ldLnR5cGUpIHsNCj4gKyAgICAg
ICAgICAgICAgIGNhc2UgUUNPTVRFRV9BUkdfVFlQRV9JQjoNCj4gKyAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKHBhcmFtc1tpXS5hdHRyICE9DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICBURUVfSU9DVExfUEFSQU1fQVRUUl9UWVBFX1VCVUZfSU5QVVQpDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgZ290byBvdXRfZmFpbGVkOw0KPiArDQo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgY2FzZSBRQ09NVEVFX0FSR19UWVBF
X09COg0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zW2ldLmF0dHIgIT0NCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfVUJV
Rl9PVVRQVVQpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfZmFp
bGVkOw0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIC8qIENsaWVudCBjYW4gbm90IHNl
bmQgbW9yZSBkYXRhIHRoYW4gcmVxdWVzdGVkLiAqLw0KPiArICAgICAgICAgICAgICAgICAgICAg
ICBpZiAocGFyYW1zW2ldLnUudWJ1Zi5zaXplID4gdVtpXS5iLnNpemUpDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfZmFpbGVkOw0KPiArDQo+ICsgICAgICAgICAg
ICAgICAgICAgICAgIGlmIChjb3B5X2Zyb21fdXNlcih1W2ldLmIuYWRkciwgcGFyYW1zW2ldLnUu
dWJ1Zi51YWRkciwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHBhcmFtc1tpXS51LnVidWYuc2l6ZSkpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZ290byBvdXRfZmFpbGVkOw0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHVbaV0u
Yi5zaXplID0gcGFyYW1zW2ldLnUudWJ1Zi5zaXplOw0KPiArDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgY2FzZSBRQ09NVEVFX0FSR19UWVBFX0lP
Og0KPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyYW1zW2ldLmF0dHIgIT0NCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgIFRFRV9JT0NUTF9QQVJBTV9BVFRSX1RZUEVfT0JKUkVG
X0lOUFVUKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdvdG8gb3V0X2ZhaWxl
ZDsNCj4gKw0KPiArICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCj4gKyAgICAgICAgICAg
ICAgIGNhc2UgUUNPTVRFRV9BUkdfVFlQRV9PTzoNCj4gKyAgICAgICAgICAgICAgICAgICAgICAg
aWYgKHBhcmFtc1tpXS5hdHRyICE9DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICBURUVf
SU9DVExfUEFSQU1fQVRUUl9UWVBFX09CSlJFRl9PVVRQVVQpDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBvdXRfZmFpbGVkOw0KPiArDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgIGlmIChxY29tdGVlX29ianJlZl90b19hcmcoJnVbaV0sICZwYXJhbXNbaV0sIGN0eCkp
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290byBvdXRfZmFpbGVkOw0KPiAr
DQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KPiArICAgICAgICAgICAgICAgZGVm
YXVsdDogLyogTmV2ZXIgZ2V0IGhlcmUhICovDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGdv
dG8gb3V0X2ZhaWxlZDsNCj4gKyAgICAgICAgICAgICAgIH0NCj4gKyAgICAgICB9DQo+ICsNCj4g
KyAgICAgICByZXR1cm4gMDsNCj4gKw0KPiArb3V0X2ZhaWxlZDoNCj4gKyAgICAgICAvKiBVbmRv
IHFjb210ZWVfb2JqcmVmX3RvX2FyZygpLiAqLw0KPiArICAgICAgIGZvciAoaS0tOyBpID49IDA7
IGktLSkgew0KPiArICAgICAgICAgICAgICAgaWYgKHVbaV0udHlwZSAhPSBRQ09NVEVFX0FSR19U
WVBFX09PKQ0KPiArICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCj4gKw0KPiArICAg
ICAgICAgICAgICAgcWNvbXRlZV91c2VyX29iamVjdF9zZXRfbm90aWZ5KHVbaV0ubywgZmFsc2Up
Ow0KPiArICAgICAgICAgICAgICAgaWYgKHR5cGVvZl9xY29tdGVlX29iamVjdCh1W2ldLm8pID09
IFFDT01URUVfT0JKRUNUX1RZUEVfQ0IpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIHFjb210
ZWVfb2JqZWN0X3B1dCh1W2ldLm8pOw0KPiArDQo+ICsgICAgICAgICAgICAgICBxY29tdGVlX29i
amVjdF9wdXQodVtpXS5vKTsNCj4gKyAgICAgICB9DQo+ICsNCj4gKyAgICAgICByZXR1cm4gLUVJ
TlZBTDsNCj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX3VzZXJfb2JqZWN0X3NlbGVj
dCgpIC0gU2VsZWN0IGEgcmVxdWVzdCBmb3IgYSB1c2VyIG9iamVjdC4NCj4gKyAqIEBjdHg6IGNv
bnRleHQgdG8gbG9vayBmb3IgYSB1c2VyIG9iamVjdC4NCj4gKyAqIEBwYXJhbXM6IHBhcmFtZXRl
cnMgZm9yIEBvcC4NCj4gKyAqIEBudW1fcGFyYW1zOiBudW1iZXIgb2YgZWxlbWVudHMgaW4gdGhl
IHBhcmFtZXRlciBhcnJheS4NCj4gKyAqIEB1YWRkcjogdXNlciBidWZmZXIgZm9yIG91dHB1dCBV
QlVGIHBhcmFtZXRlcnMuDQo+ICsgKiBAc2l6ZTogc2l6ZSBvZiB1c2VyIGJ1ZmZlciBAdWFkZHIu
DQo+ICsgKiBAZGF0YTogaW5mb3JtYXRpb24gZm9yIHRoZSBzZWxlY3RlZCByZXF1ZXN0Lg0KPiAr
ICoNCj4gKyAqIEBwYXJhbXMgaXMgZmlsbGVkIGFsb25nIHdpdGggQGRhdGEgZm9yIHRoZSBzZWxl
Y3RlZCByZXF1ZXN0Lg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAw
OyBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4NCj4gKyAqLw0KPiAraW50IHFjb210ZWVfdXNlcl9v
YmplY3Rfc2VsZWN0KHN0cnVjdCB0ZWVfY29udGV4dCAqY3R4LA0KPiArICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc3RydWN0IHRlZV9wYXJhbSAqcGFyYW1zLCBpbnQgbnVtX3BhcmFtcywN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZvaWQgX191c2VyICp1YWRkciwgc2l6
ZV90IHNpemUsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRl
ZV91c2VyX29iamVjdF9yZXF1ZXN0X2RhdGEgKmRhdGEpDQo+ICt7DQo+ICsgICAgICAgc3RydWN0
IHFjb210ZWVfY29udGV4dF9kYXRhICpjdHhkYXRhID0gY3R4LT5kYXRhOw0KPiArICAgICAgIHN0
cnVjdCBxY29tdGVlX3VyZXEgKnVyZXE7DQo+ICsgICAgICAgaW50IHJldDsNCj4gKw0KPiArICAg
ICAgIHdoaWxlICgxKSB7DQo+ICsgICAgICAgICAgICAgICBzY29wZWRfZ3VhcmQobXV0ZXgsICZj
dHhkYXRhLT5yZXFzX2xvY2spIHsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgdXJlcSA9IHVy
ZXFfc2VsZWN0KGN0eGRhdGEsIHNpemUsIG51bV9wYXJhbXMpOw0KPiArICAgICAgICAgICAgICAg
ICAgICAgICBpZiAoIXVyZXEpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ290
byB3YWl0X2Zvcl9yZXF1ZXN0Ow0KPiArDQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGlmIChJ
U19FUlIodXJlcSkpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFBU
Ul9FUlIodXJlcSk7DQo+ICsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgLyogUHJvY2Vzc2lu
ZyB0aGUgcmVxdWVzdCAnUVVFVUVEIC0+IFBST0NFU1NJTkcnLiAqLw0KPiArICAgICAgICAgICAg
ICAgICAgICAgICB1cmVxLT5zdGF0ZSA9IFFDT01URUVfUkVRX1BST0NFU1NJTkc7DQo+ICsNCj4g
KyAgICAgICAgICAgICAgICAgICAgICAgLyogJydQcmVwYXJlIHVzZXIgcmVxdWVzdDonJyAqLw0K
PiArICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5pZCA9IHVyZXEtPnJlcV9pZDsNCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgZGF0YS0+b2JqZWN0X2lkID0gdXJlcS0+b2JqZWN0X2lkOw0K
PiArICAgICAgICAgICAgICAgICAgICAgICBkYXRhLT5vcCA9IHVyZXEtPm9wOw0KPiArICAgICAg
ICAgICAgICAgICAgICAgICByZXQgPSBxY29tdGVlX2NiX3BhcmFtc19mcm9tX2FyZ3MocGFyYW1z
LCB1cmVxLT5hcmdzLA0KPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgbnVtX3BhcmFtcywgdWFkZHIsDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplLCBjdHgpOw0KPiAr
ICAgICAgICAgICAgICAgICAgICAgICBpZiAocmV0ID49IDApDQo+ICsgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZ290byBkb25lX3JlcXVlc3Q7DQo+ICsNCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgLyogU29tZXRoaW5nIGlzIHdyb25nIHdpdGggdGhlIHJlcXVlc3QuICovDQo+ICsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgdXJlcV9kZXF1ZXVlKGN0eGRhdGEsIGRhdGEtPmlk
KTsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgLyogU2VuZCBlcnJvciB0byBRVEVFLiAqLw0K
PiArICAgICAgICAgICAgICAgICAgICAgICB1cmVxLT5zdGF0ZSA9IFFDT01URUVfUkVRX1BST0NF
U1NFRDsNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgdXJlcS0+ZXJybm8gPSByZXQ7DQo+ICsN
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29tcGxldGUoJnVyZXEtPmMpOw0KPiArICAgICAg
ICAgICAgICAgfQ0KPiArDQo+ICsgICAgICAgICAgICAgICBjb250aW51ZTsNCj4gK3dhaXRfZm9y
X3JlcXVlc3Q6DQo+ICsgICAgICAgICAgICAgICAvKiBXYWl0IGZvciBhIG5ldyBRVUVVRUQgcmVx
dWVzdC4gKi8NCj4gKyAgICAgICAgICAgICAgIGlmICh3YWl0X2Zvcl9jb21wbGV0aW9uX2ludGVy
cnVwdGlibGUoJmN0eGRhdGEtPnJlcV9jKSkNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIC1FUkVTVEFSVFNZUzsNCj4gKyAgICAgICB9DQo+ICsNCj4gK2RvbmVfcmVxdWVzdDoNCj4g
KyAgICAgICAvKiBObyBvbmUgaXMgd2FpdGluZyBmb3IgdGhlIHJlc3BvbnNlLiAqLw0KPiArICAg
ICAgIGlmIChkYXRhLT5vcCA9PSBRQ09NVEVFX01TR19PQkpFQ1RfT1BfUkVMRUFTRSkgew0KPiAr
ICAgICAgICAgICAgICAgc2NvcGVkX2d1YXJkKG11dGV4LCAmY3R4ZGF0YS0+cmVxc19sb2NrKQ0K
PiArICAgICAgICAgICAgICAgICAgICAgICB1cmVxX2RlcXVldWUoY3R4ZGF0YSwgZGF0YS0+aWQp
Ow0KPiArICAgICAgICAgICAgICAga2ZyZWUodXJlcSk7DQo+ICsgICAgICAgfQ0KPiArDQo+ICsg
ICAgICAgZGF0YS0+bnAgPSByZXQ7DQo+ICsNCj4gKyAgICAgICByZXR1cm4gMDsNCj4gK30NCj4g
Kw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX3VzZXJfb2JqZWN0X3N1Ym1pdCgpIC0gU3VibWl0IGEg
cmVzcG9uc2UgZm9yIGEgdXNlciBvYmplY3QuDQo+ICsgKiBAY3R4OiBjb250ZXh0IHRvIGxvb2sg
Zm9yIGEgdXNlciBvYmplY3QuDQo+ICsgKiBAcGFyYW1zOiByZXR1cm5lZCBwYXJhbWV0ZXJzLg0K
PiArICogQG51bV9wYXJhbXM6IG51bWJlciBvZiBlbGVtZW50cyBpbiB0aGUgcGFyYW1ldGVyIGFy
cmF5Lg0KPiArICogQHJlcV9pZDogcmVxdWVzdCBJRCBmb3IgdGhlIHJlc3BvbnNlLg0KPiArICog
QGVycm5vOiByZXN1bHQgb2YgdXNlciBvYmplY3QgaW52b2NhdGlvbi4NCj4gKyAqDQo+ICsgKiBS
ZXR1cm46IE9uIHN1Y2Nlc3MsIHJldHVybnMgMDsgb24gZmFpbHVyZSwgcmV0dXJucyA8IDAuDQo+
ICsgKi8NCj4gK2ludCBxY29tdGVlX3VzZXJfb2JqZWN0X3N1Ym1pdChzdHJ1Y3QgdGVlX2NvbnRl
eHQgKmN0eCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCB0ZWVfcGFy
YW0gKnBhcmFtcywgaW50IG51bV9wYXJhbXMsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBpbnQgcmVxX2lkLCBpbnQgZXJybm8pDQo+ICt7DQo+ICsgICAgICAgc3RydWN0IHFjb210
ZWVfY29udGV4dF9kYXRhICpjdHhkYXRhID0gY3R4LT5kYXRhOw0KPiArICAgICAgIHN0cnVjdCBx
Y29tdGVlX3VyZXEgKnVyZXE7DQo+ICsNCj4gKyAgICAgICBndWFyZChtdXRleCkoJmN0eGRhdGEt
PnJlcXNfbG9jayk7DQo+ICsNCj4gKyAgICAgICB1cmVxID0gdXJlcV9kZXF1ZXVlKGN0eGRhdGEs
IHJlcV9pZCk7DQo+ICsgICAgICAgaWYgKCF1cmVxKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJu
IC1FSU5WQUw7DQo+ICsNCj4gKyAgICAgICB1cmVxLT5zdGF0ZSA9IFFDT01URUVfUkVRX1BST0NF
U1NFRDsNCj4gKw0KPiArICAgICAgIGlmICghZXJybm8pDQo+ICsgICAgICAgICAgICAgICB1cmVx
LT5lcnJubyA9IHFjb210ZWVfY2JfcGFyYW1zX3RvX2FyZ3ModXJlcS0+YXJncywgcGFyYW1zLA0K
PiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IG51bV9wYXJhbXMsIGN0eCk7DQo+ICsgICAgICAgZWxzZQ0KPiArICAgICAgICAgICAgICAgdXJl
cS0+ZXJybm8gPSBlcnJubzsNCj4gKw0KPiArICAgICAgIC8qIFJldHVybiBlcnJubyBpZiBxY29t
dGVlX2NiX3BhcmFtc190b19hcmdzKCkgZmFpbGVkOyBvdGhlcndpc2UgMC4gKi8NCj4gKyAgICAg
ICBpZiAoIWVycm5vICYmIHVyZXEtPmVycm5vKQ0KPiArICAgICAgICAgICAgICAgZXJybm8gPSB1
cmVxLT5lcnJubzsNCj4gKyAgICAgICBlbHNlDQo+ICsgICAgICAgICAgICAgICBlcnJubyA9IDA7
DQo+ICsNCj4gKyAgICAgICAvKiBTZW5kIHJlc3VsdCB0byBRVEVFLiAqLw0KPiArICAgICAgIGNv
bXBsZXRlKCZ1cmVxLT5jKTsNCj4gKw0KPiArICAgICAgIHJldHVybiBlcnJubzsNCj4gK30NCj4g
ZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvZmlybXdhcmUvcWNvbS9xY29tX3RlZS5oIGIvaW5j
bHVkZS9saW51eC9maXJtd2FyZS9xY29tL3Fjb21fdGVlLmgNCj4gbmV3IGZpbGUgbW9kZSAxMDA2
NDQNCj4gaW5kZXggMDAwMDAwMDAwMDAwLi4xZDlmOWJjMzIwZmUNCj4gLS0tIC9kZXYvbnVsbA0K
PiArKysgYi9pbmNsdWRlL2xpbnV4L2Zpcm13YXJlL3Fjb20vcWNvbV90ZWUuaA0KPiBAQCAtMCww
ICsxLDMwMiBAQA0KPiArLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb25seSAq
Lw0KPiArLyogQ29weXJpZ2h0IChjKSAyMDIzIFF1YWxjb21tIElubm92YXRpb24gQ2VudGVyLCBJ
bmMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQo+ICsgKi8NCj4gKw0KPiArI2lmbmRlZiBfX1FDT01f
VEVFX0gNCj4gKyNkZWZpbmUgX19RQ09NX1RFRV9IDQo+ICsNCj4gKyNpbmNsdWRlIDxsaW51eC9j
b21wbGV0aW9uLmg+DQo+ICsjaW5jbHVkZSA8bGludXgva3JlZi5oPg0KPiArI2luY2x1ZGUgPGxp
bnV4L3NsYWIuaD4NCj4gKyNpbmNsdWRlIDxsaW51eC93b3JrcXVldWUuaD4NCj4gKw0KPiArc3Ry
dWN0IHFjb210ZWVfb2JqZWN0Ow0KPiArDQo+ICsvKioNCj4gKyAqIERPQzogT3ZlcnZpZXcNCj4g
KyAqDQo+ICsgKiBxY29tdGVlX29iamVjdCBwcm92aWRlcyBvYmplY3QgcmVmY291bnRpbmcsIElE
IGFsbG9jYXRpb24gZm9yIG9iamVjdHMgaG9zdGVkDQo+ICsgKiBpbiB0aGUga2VybmVsLCBhbmQg
bmVjZXNzYXJ5IG1lc3NhZ2UgbWFyc2hhbGluZyBmb3IgUXVhbGNvbW0gVEVFIChRVEVFKS4NCj4g
KyAqDQo+ICsgKiBUbyBpbnZva2UgYW4gb2JqZWN0IGluIFFURUUsIHRoZSB1c2VyIGNhbGxzIHFj
b210ZWVfb2JqZWN0X2RvX2ludm9rZSgpDQo+ICsgKiB3aGlsZSBwYXNzaW5nIGFuIGluc3RhbmNl
IG9mICZzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgYW5kIHRoZSByZXF1ZXN0ZWQNCj4gKyAqIG9wZXJh
dGlvbiArIGFyZ3VtZW50cy4NCj4gKyAqDQo+ICsgKiBBZnRlciBib290LCBRVEVFIHByb3ZpZGVz
IGEgc3RhdGljIG9iamVjdCAlUk9PVF9RQ09NVEVFX09CSkVDVCAodHlwZSBvZg0KPiArICogJVFD
T01URUVfT0JKRUNUX1RZUEVfUk9PVCkuIFRoZSByb290IG9iamVjdCBpcyBpbnZva2VkIHRvIHBh
c3MgdGhlIHVzZXIncw0KPiArICogY3JlZGVudGlhbHMgYW5kIG9idGFpbiBvdGhlciBpbnN0YW5j
ZXMgb2YgJnN0cnVjdCBxY29tdGVlX29iamVjdCAodHlwZSBvZg0KPiArICogJVFDT01URUVfT0JK
RUNUX1RZUEVfVEVFKSB0aGF0IHJlcHJlc2VudCBzZXJ2aWNlcyBhbmQgVEFzIGluIFFURUU7DQo+
ICsgKiBzZWUgJmVudW0gcWNvbXRlZV9vYmplY3RfdHlwZS4NCj4gKyAqDQo+ICsgKiBUaGUgb2Jq
ZWN0cyByZWNlaXZlZCBmcm9tIFFURUUgYXJlIHJlZmNvdW50ZWQuIFNvIHRoZSBvd25lciBvZiB0
aGVzZSBvYmplY3RzDQo+ICsgKiBjYW4gaXNzdWUgcWNvbXRlZV9vYmplY3RfZ2V0KCkgdG8gaW5j
cmVhc2UgdGhlIHJlZmNvdW50IGFuZCBwYXNzIG9iamVjdHMNCj4gKyAqIHRvIG90aGVyIGNsaWVu
dHMsIG9yIGlzc3VlIHFjb210ZWVfb2JqZWN0X3B1dCgpIHRvIGRlY3JlYXNlIHRoZSByZWZjb3Vu
dA0KPiArICogYW5kIHJlbGVhc2UgdGhlIHJlc291cmNlcyBpbiBRVEVFLg0KPiArICoNCj4gKyAq
IFRoZSBrZXJuZWwgY2FuIGhvc3Qgc2VydmljZXMgYWNjZXNzaWJsZSB0byBRVEVFLiBBIGRyaXZl
ciBzaG91bGQgZW1iZWQNCj4gKyAqIGFuIGluc3RhbmNlIG9mICZzdHJ1Y3QgcWNvbXRlZV9vYmpl
Y3QgaW4gdGhlIHN0cnVjdCBpdCB3YW50cyB0byBleHBvcnQgdG8NCj4gKyAqIFFURUUgKHRoaXMg
aXMgY2FsbGVkIGEgY2FsbGJhY2sgb2JqZWN0KS4gSXQgaXNzdWVzIHFjb210ZWVfb2JqZWN0X3Vz
ZXJfaW5pdCgpDQo+ICsgKiB0byBzZXQgdGhlIGRpc3BhdGNoKCkgb3BlcmF0aW9uIGZvciB0aGUg
Y2FsbGJhY2sgb2JqZWN0IGFuZCBzZXQgaXRzIHR5cGUNCj4gKyAqIHRvICVRQ09NVEVFX09CSkVD
VF9UWVBFX0NCLg0KPiArICoNCj4gKyAqIGNvcmUuYyBob2xkcyBhbiBvYmplY3QgdGFibGUgZm9y
IGNhbGxiYWNrIG9iamVjdHMuIEFuIG9iamVjdCBJRCBpcyBhc3NpZ25lZA0KPiArICogdG8gZWFj
aCBjYWxsYmFjayBvYmplY3QsIHdoaWNoIGlzIGFuIGluZGV4IHRvIHRoZSBvYmplY3QgdGFibGUu
IFFURUUgdXNlcw0KPiArICogdGhlc2UgSURzIHRvIHJlZmVyZW5jZSBvciBpbnZva2UgY2FsbGJh
Y2sgb2JqZWN0cy4NCj4gKyAqDQo+ICsgKiBJZiBRVEVFIGludm9rZXMgYSBjYWxsYmFjayBvYmpl
Y3QgaW4gdGhlIGtlcm5lbCwgdGhlIGRpc3BhdGNoKCkgb3BlcmF0aW9uIGlzDQo+ICsgKiBjYWxs
ZWQgaW4gdGhlIGNvbnRleHQgb2YgdGhlIHRocmVhZCB0aGF0IG9yaWdpbmFsbHkgY2FsbGVkDQo+
ICsgKiBxY29tdGVlX29iamVjdF9kb19pbnZva2UoKS4NCj4gKyAqLw0KPiArDQo+ICsvKioNCj4g
KyAqIGVudW0gcWNvbXRlZV9vYmplY3RfdHlwZSAtIE9iamVjdCB0eXBlcy4NCj4gKyAqIEBRQ09N
VEVFX09CSkVDVF9UWVBFX1RFRTogb2JqZWN0IGhvc3RlZCBvbiBRVEVFLg0KPiArICogQFFDT01U
RUVfT0JKRUNUX1RZUEVfQ0I6IG9iamVjdCBob3N0ZWQgb24ga2VybmVsLg0KPiArICogQFFDT01U
RUVfT0JKRUNUX1RZUEVfUk9PVDogJ3ByaW1vcmRpYWwnIG9iamVjdC4NCj4gKyAqIEBRQ09NVEVF
X09CSkVDVF9UWVBFX05VTEw6IE5VTEwgb2JqZWN0Lg0KPiArICoNCj4gKyAqIFRoZSBwcmltb3Jk
aWFsIG9iamVjdCBpcyB1c2VkIGZvciBib290c3RyYXBwaW5nIHRoZSBJUEMgY29ubmVjdGlvbiBi
ZXR3ZWVuDQo+ICsgKiB0aGUga2VybmVsIGFuZCBRVEVFLiBJdCBpcyBpbnZva2VkIGJ5IHRoZSBr
ZXJuZWwgd2hlbiBpdCB3YW50cyB0byBnZXQgYQ0KPiArICogJ2NsaWVudCBlbnYnLg0KPiArICov
DQo+ICtlbnVtIHFjb210ZWVfb2JqZWN0X3R5cGUgew0KPiArICAgICAgIFFDT01URUVfT0JKRUNU
X1RZUEVfVEVFLA0KPiArICAgICAgIFFDT01URUVfT0JKRUNUX1RZUEVfQ0IsDQo+ICsgICAgICAg
UUNPTVRFRV9PQkpFQ1RfVFlQRV9ST09ULA0KPiArICAgICAgIFFDT01URUVfT0JKRUNUX1RZUEVf
TlVMTCwNCj4gK307DQo+ICsNCj4gKy8qKg0KPiArICogZW51bSBxY29tdGVlX2FyZ190eXBlIC0g
VHlwZSBvZiBRVEVFIGFyZ3VtZW50Lg0KPiArICogQFFDT01URUVfQVJHX1RZUEVfSU5WOiBpbnZh
bGlkIHR5cGUuDQo+ICsgKiBAUUNPTVRFRV9BUkdfVFlQRV9PQjogb3V0cHV0IGJ1ZmZlciAoT0Ip
Lg0KPiArICogQFFDT01URUVfQVJHX1RZUEVfT086IG91dHB1dCBvYmplY3QgKE9PKS4NCj4gKyAq
IEBRQ09NVEVFX0FSR19UWVBFX0lCOiBpbnB1dCBidWZmZXIgKElCKS4NCj4gKyAqIEBRQ09NVEVF
X0FSR19UWVBFX0lPOiBpbnB1dCBvYmplY3QgKElPKS4NCj4gKyAqDQo+ICsgKiBVc2UgdGhlIGlu
dmFsaWQgdHlwZSB0byBzcGVjaWZ5IHRoZSBlbmQgb2YgdGhlIGFyZ3VtZW50IGFycmF5Lg0KPiAr
ICovDQo+ICtlbnVtIHFjb210ZWVfYXJnX3R5cGUgew0KPiArICAgICAgIFFDT01URUVfQVJHX1RZ
UEVfSU5WID0gMCwNCj4gKyAgICAgICBRQ09NVEVFX0FSR19UWVBFX09CLA0KPiArICAgICAgIFFD
T01URUVfQVJHX1RZUEVfT08sDQo+ICsgICAgICAgUUNPTVRFRV9BUkdfVFlQRV9JQiwNCj4gKyAg
ICAgICBRQ09NVEVFX0FSR19UWVBFX0lPLA0KPiArICAgICAgIFFDT01URUVfQVJHX1RZUEVfTlIs
DQo+ICt9Ow0KPiArDQo+ICsvKioNCj4gKyAqIGRlZmluZSBRQ09NVEVFX0FSR1NfUEVSX1RZUEUg
LSBNYXhpbXVtIGFyZ3VtZW50cyBvZiBhIHNwZWNpZmljIHR5cGUuDQo+ICsgKg0KPiArICogVGhl
IFFURUUgdHJhbnNwb3J0IHByb3RvY29sIGxpbWl0cyB0aGUgbWF4aW11bSBudW1iZXIgb2YgYXJn
dW1lbnRzIG9mDQo+ICsgKiBhIHNwZWNpZmljIHR5cGUgKGkuZS4sIElCLCBPQiwgSU8sIGFuZCBP
TykuDQo+ICsgKi8NCj4gKyNkZWZpbmUgUUNPTVRFRV9BUkdTX1BFUl9UWVBFIDE2DQo+ICsNCj4g
Ky8qIE1heGltdW0gYXJndW1lbnRzIHRoYXQgY2FuIGZpdCBpbiBhIFFURUUgbWVzc2FnZSwgaWdu
b3JpbmcgdGhlIHR5cGUuICovDQo+ICsjZGVmaW5lIFFDT01URUVfQVJHU19NQVggKFFDT01URUVf
QVJHU19QRVJfVFlQRSAqIChRQ09NVEVFX0FSR19UWVBFX05SIC0gMSkpDQo+ICsNCj4gK3N0cnVj
dCBxY29tdGVlX2J1ZmZlciB7DQo+ICsgICAgICAgdW5pb24gew0KPiArICAgICAgICAgICAgICAg
dm9pZCAqYWRkcjsNCj4gKyAgICAgICAgICAgICAgIHZvaWQgX191c2VyICp1YWRkcjsNCj4gKyAg
ICAgICB9Ow0KPiArICAgICAgIHNpemVfdCBzaXplOw0KPiArfTsNCj4gKw0KPiArLyoqDQo+ICsg
KiBzdHJ1Y3QgcWNvbXRlZV9hcmcgLSBBcmd1bWVudCBmb3IgUVRFRSBvYmplY3QgaW52b2NhdGlv
bi4NCj4gKyAqIEB0eXBlOiB0eXBlIG9mIGFyZ3VtZW50IGFzICZlbnVtIHFjb210ZWVfYXJnX3R5
cGUuDQo+ICsgKiBAZmxhZ3M6IGV4dHJhIGZsYWdzLg0KPiArICogQGI6IGFkZHJlc3MgYW5kIHNp
emUgaWYgdGhlIHR5cGUgb2YgYXJndW1lbnQgaXMgYSBidWZmZXIuDQo+ICsgKiBAbzogb2JqZWN0
IGluc3RhbmNlIGlmIHRoZSB0eXBlIG9mIGFyZ3VtZW50IGlzIGFuIG9iamVjdC4NCj4gKyAqDQo+
ICsgKiAmcWNvbXRlZV9hcmcuZmxhZ3Mgb25seSBhY2NlcHRzICVRQ09NVEVFX0FSR19GTEFHU19V
QUREUiBmb3Igbm93LCB3aGljaA0KPiArICogc3RhdGVzIHRoYXQgJnFjb210ZWVfYXJnLmIgY29u
dGFpbnMgYSB1c2Vyc3BhY2UgYWRkcmVzcyBpbiB1YWRkci4NCj4gKyAqLw0KPiArc3RydWN0IHFj
b210ZWVfYXJnIHsNCj4gKyAgICAgICBlbnVtIHFjb210ZWVfYXJnX3R5cGUgdHlwZTsNCj4gKy8q
ICdiLnVhZGRyJyBob2xkcyBhIF9fdXNlciBhZGRyZXNzLiAqLw0KPiArI2RlZmluZSBRQ09NVEVF
X0FSR19GTEFHU19VQUREUiBCSVQoMCkNCj4gKyAgICAgICB1bnNpZ25lZCBpbnQgZmxhZ3M7DQo+
ICsgICAgICAgdW5pb24gew0KPiArICAgICAgICAgICAgICAgc3RydWN0IHFjb210ZWVfYnVmZmVy
IGI7DQo+ICsgICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm87DQo+ICsgICAg
ICAgfTsNCj4gK307DQo+ICsNCj4gK3N0YXRpYyBpbmxpbmUgaW50IHFjb210ZWVfYXJnc19sZW4o
c3RydWN0IHFjb210ZWVfYXJnICphcmdzKQ0KPiArew0KPiArICAgICAgIGludCBpID0gMDsNCj4g
Kw0KPiArICAgICAgIHdoaWxlIChhcmdzW2ldLnR5cGUgIT0gUUNPTVRFRV9BUkdfVFlQRV9JTlYp
DQo+ICsgICAgICAgICAgICAgICBpKys7DQo+ICsgICAgICAgcmV0dXJuIGk7DQo+ICt9DQo+ICsN
Cj4gKy8qIENvbnRleHQgaXMgYnVzeSAoY2FsbGJhY2sgaXMgaW4gcHJvZ3Jlc3MpLiAqLw0KPiAr
I2RlZmluZSBRQ09NVEVFX09JQ19GTEFHX0JVU1kgQklUKDEpDQo+ICsvKiBDb250ZXh0IG5lZWRz
IHRvIG5vdGlmeSB0aGUgY3VycmVudCBvYmplY3QuICovDQo+ICsjZGVmaW5lIFFDT01URUVfT0lD
X0ZMQUdfTk9USUZZIEJJVCgyKQ0KPiArLyogQ29udGV4dCBoYXMgc2hhcmVkIHN0YXRlIHdpdGgg
UVRFRS4gKi8NCj4gKyNkZWZpbmUgUUNPTVRFRV9PSUNfRkxBR19TSEFSRUQgQklUKDMpDQo+ICsN
Cj4gK3N0cnVjdCBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4IHsNCj4gKyAgICAgICAvKiBURUUg
Y29udGV4dCBmb3IgdGhpcyBpbnZvY2F0aW9uLiAqLw0KPiArICAgICAgIHN0cnVjdCB0ZWVfY29u
dGV4dCAqY3R4Ow0KPiArICAgICAgIHVuc2lnbmVkIGxvbmcgZmxhZ3M7DQo+ICsgICAgICAgaW50
IGVycm5vOw0KPiArDQo+ICsgICAgICAgLyogQ3VycmVudCBvYmplY3QgaW52b2tlZCBpbiB0aGlz
IGNhbGxiYWNrIGNvbnRleHQuICovDQo+ICsgICAgICAgc3RydWN0IHFjb210ZWVfb2JqZWN0ICpv
YmplY3Q7DQo+ICsNCj4gKyAgICAgICAvKiBEaXNwYXRjaGVyIGFyZ3VtZW50IGFycmF5ICgrMSBm
b3IgZW5kaW5nIFFDT01URUVfQVJHX1RZUEVfSU5WKS4gKi8NCj4gKyAgICAgICBzdHJ1Y3QgcWNv
bXRlZV9hcmcgdVtRQ09NVEVFX0FSR1NfTUFYICsgMV07DQo+ICsNCj4gKyAgICAgICAvKiBJbmJv
dW5kIGFuZCBPdXRib3VuZCBidWZmZXJzIHNoYXJlZCB3aXRoIFFURUUuICovDQo+ICsgICAgICAg
c3RydWN0IHFjb210ZWVfYnVmZmVyIGluX21zZzsgLyogSW5ib3VuZCBidWZmZXIuICAqLw0KPiAr
ICAgICAgIHN0cnVjdCBxY29tdGVlX2J1ZmZlciBvdXRfbXNnOyAvKiBPdXRib3VuZCBidWZmZXIu
ICovDQo+ICsgICAgICAgc3RydWN0IHRlZV9zaG0gKmluX3NobTsgLyogVEVFIHNobSBhbGxvY2F0
ZWQgZm9yIGluYm91bmQgYnVmZmVyLiAqLw0KPiArICAgICAgIHN0cnVjdCB0ZWVfc2htICpvdXRf
c2htOyAvKiBURUUgc2htIGFsbG9jYXRlZCBmb3Igb3V0Ym91bmQgYnVmZmVyLiAqLw0KPiArDQo+
ICsgICAgICAgLyogRXh0cmEgZGF0YSBhdHRhY2hlZCB0byB0aGlzIGNvbnRleHQuICovDQo+ICsg
ICAgICAgdm9pZCAqZGF0YTsNCj4gK307DQo+ICsNCj4gK3N0YXRpYyBpbmxpbmUgc3RydWN0IHFj
b210ZWVfb2JqZWN0X2ludm9rZV9jdHggKg0KPiArcWNvbXRlZV9vYmplY3RfaW52b2tlX2N0eF9h
bGxvYyhzdHJ1Y3QgdGVlX2NvbnRleHQgKmN0eCkNCj4gK3sNCj4gKyAgICAgICBzdHJ1Y3QgcWNv
bXRlZV9vYmplY3RfaW52b2tlX2N0eCAqb2ljOw0KPiArDQo+ICsgICAgICAgb2ljID0ga3phbGxv
YyhzaXplb2YoKm9pYyksIEdGUF9LRVJORUwpOw0KPiArICAgICAgIGlmIChvaWMpDQo+ICsgICAg
ICAgICAgICAgICBvaWMtPmN0eCA9IGN0eDsNCj4gKyAgICAgICByZXR1cm4gb2ljOw0KPiArfQ0K
PiArDQo+ICsvKioNCj4gKyAqIHFjb210ZWVfb2JqZWN0X2RvX2ludm9rZSgpIC0gU3VibWl0IGFu
IGludm9jYXRpb24gZm9yIGFuIG9iamVjdC4NCj4gKyAqIEBvaWM6IGNvbnRleHQgdG8gdXNlIGZv
ciB0aGUgY3VycmVudCBpbnZvY2F0aW9uLg0KPiArICogQG9iamVjdDogb2JqZWN0IGJlaW5nIGlu
dm9rZWQuDQo+ICsgKiBAb3A6IHJlcXVlc3RlZCBvcGVyYXRpb24gb24gdGhlIG9iamVjdC4NCj4g
KyAqIEB1OiBhcnJheSBvZiBhcmd1bWVudHMgZm9yIHRoZSBjdXJyZW50IGludm9jYXRpb24uDQo+
ICsgKiBAcmVzdWx0OiByZXN1bHQgcmV0dXJuZWQgZnJvbSBRVEVFLg0KPiArICoNCj4gKyAqIFRo
ZSBjYWxsZXIgaXMgcmVzcG9uc2libGUgZm9yIGtlZXBpbmcgdHJhY2sgb2YgdGhlIHJlZmNvdW50
IGZvciBlYWNoIG9iamVjdCwNCj4gKyAqIGluY2x1ZGluZyBAb2JqZWN0LiBPbiByZXR1cm4sIHRo
ZSBjYWxsZXIgbG9zZXMgb3duZXJzaGlwIG9mIGFsbCBpbnB1dA0KPiArICogb2JqZWN0cyBvZiB0
eXBlICVRQ09NVEVFX09CSkVDVF9UWVBFX0NCLg0KPiArICoNCj4gKyAqIEBvYmplY3QgY2FuIGJl
IG9mICVRQ09NVEVFX09CSkVDVF9UWVBFX1JPT1Qgb3IgJVFDT01URUVfT0JKRUNUX1RZUEVfVEVF
Lg0KPiArICoNCj4gKyAqIFJldHVybjogT24gc3VjY2VzcywgcmV0dXJucyAwLiBPbiBlcnJvciwg
cmV0dXJucyAtRUFHQUlOIGlmIGludm9jYXRpb24NCj4gKyAqIGZhaWxlZCBhbmQgdGhlIHVzZXIg
bWF5IHJldHJ5IHRoZSBpbnZvY2F0aW9uLCAtRU5PREVWIG9uIGZhdGFsIGZhaWx1cmUuDQo+ICsg
Ki8NCj4gK2ludCBxY29tdGVlX29iamVjdF9kb19pbnZva2Uoc3RydWN0IHFjb210ZWVfb2JqZWN0
X2ludm9rZV9jdHggKm9pYywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3Qg
cWNvbXRlZV9vYmplY3QgKm9iamVjdCwgdTMyIG9wLA0KPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIHN0cnVjdCBxY29tdGVlX2FyZyAqdSwgaW50ICpyZXN1bHQpOw0KPiArDQo+ICsvKioN
Cj4gKyAqIHN0cnVjdCBxY29tdGVlX29iamVjdF9vcGVyYXRpb25zIC0gQ2FsbGJhY2sgb2JqZWN0
IG9wZXJhdGlvbnMuDQo+ICsgKiBAcmVsZWFzZTogcmVsZWFzZSB0aGUgb2JqZWN0IGlmIFFURUUg
aXMgbm90IHVzaW5nIGl0Lg0KPiArICogQGRpc3BhdGNoOiBkaXNwYXRjaCB0aGUgb3BlcmF0aW9u
IHJlcXVlc3RlZCBieSBRVEVFLg0KPiArICogQG5vdGlmeTogcmVwb3J0IHRoZSBzdGF0dXMgb2Yg
YW55IHBlbmRpbmcgcmVzcG9uc2Ugc3VibWl0dGVkIGJ5IEBkaXNwYXRjaC4NCj4gKyAqLw0KPiAr
c3RydWN0IHFjb210ZWVfb2JqZWN0X29wZXJhdGlvbnMgew0KPiArICAgICAgIHZvaWQgKCpyZWxl
YXNlKShzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVjdCk7DQo+ICsgICAgICAgaW50ICgqZGlz
cGF0Y2gpKHN0cnVjdCBxY29tdGVlX29iamVjdF9pbnZva2VfY3R4ICpvaWMsDQo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0LCB1MzIgb3AsDQo+
ICsgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdCBxY29tdGVlX2FyZyAqYXJncyk7DQo+ICsg
ICAgICAgdm9pZCAoKm5vdGlmeSkoc3RydWN0IHFjb210ZWVfb2JqZWN0X2ludm9rZV9jdHggKm9p
YywNCj4gKyAgICAgICAgICAgICAgICAgICAgICBzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9iamVj
dCwgaW50IGVycik7DQo+ICt9Ow0KPiArDQo+ICsvKioNCj4gKyAqIHN0cnVjdCBxY29tdGVlX29i
amVjdCAtIFFURUUgb3Iga2VybmVsIG9iamVjdC4NCj4gKyAqIEBuYW1lOiBvYmplY3QgbmFtZS4N
Cj4gKyAqIEByZWZjb3VudDogcmVmZXJlbmNlIGNvdW50ZXIuDQo+ICsgKiBAb2JqZWN0X3R5cGU6
IG9iamVjdCB0eXBlIGFzICZlbnVtIHFjb210ZWVfb2JqZWN0X3R5cGUuDQo+ICsgKiBAaW5mbzog
ZXh0cmEgaW5mb3JtYXRpb24gZm9yIHRoZSBvYmplY3QuDQo+ICsgKiBAb3BzOiBjYWxsYmFjayBv
cGVyYXRpb25zIGZvciBvYmplY3RzIG9mIHR5cGUgJVFDT01URUVfT0JKRUNUX1RZUEVfQ0IuDQo+
ICsgKiBAd29yazogd29yayBmb3IgYXN5bmMgb3BlcmF0aW9ucyBvbiB0aGUgb2JqZWN0Lg0KPiAr
ICoNCj4gKyAqIEB3b3JrIGlzIHVzZWQgZm9yIHJlbGVhc2luZyBvYmplY3RzIG9mICVRQ09NVEVF
X09CSkVDVF9UWVBFX1RFRSB0eXBlLg0KPiArICovDQo+ICtzdHJ1Y3QgcWNvbXRlZV9vYmplY3Qg
ew0KPiArICAgICAgIGNvbnN0IGNoYXIgKm5hbWU7DQo+ICsgICAgICAgc3RydWN0IGtyZWYgcmVm
Y291bnQ7DQo+ICsNCj4gKyAgICAgICBlbnVtIHFjb210ZWVfb2JqZWN0X3R5cGUgb2JqZWN0X3R5
cGU7DQo+ICsgICAgICAgc3RydWN0IG9iamVjdF9pbmZvIHsNCj4gKyAgICAgICAgICAgICAgIHVu
c2lnbmVkIGxvbmcgcXRlZV9pZDsNCj4gKyAgICAgICAgICAgICAgIC8qIFRFRSBjb250ZXh0IGZv
ciBRVEVFIG9iamVjdCBhc3luYyByZXF1ZXN0cy4gKi8NCj4gKyAgICAgICAgICAgICAgIHN0cnVj
dCB0ZWVfY29udGV4dCAqcWNvbXRlZV9hc3luY19jdHg7DQo+ICsgICAgICAgfSBpbmZvOw0KPiAr
DQo+ICsgICAgICAgc3RydWN0IHFjb210ZWVfb2JqZWN0X29wZXJhdGlvbnMgKm9wczsNCj4gKyAg
ICAgICBzdHJ1Y3Qgd29ya19zdHJ1Y3Qgd29yazsNCj4gK307DQo+ICsNCj4gKy8qIFN0YXRpYyBp
bnN0YW5jZXMgb2YgcWNvbXRlZV9vYmplY3Qgb2JqZWN0cy4gKi8NCj4gKyNkZWZpbmUgTlVMTF9R
Q09NVEVFX09CSkVDVCAoKHN0cnVjdCBxY29tdGVlX29iamVjdCAqKSgwKSkNCj4gK2V4dGVybiBz
dHJ1Y3QgcWNvbXRlZV9vYmplY3QgcWNvbXRlZV9vYmplY3Rfcm9vdDsNCj4gKyNkZWZpbmUgUk9P
VF9RQ09NVEVFX09CSkVDVCAoJnFjb210ZWVfb2JqZWN0X3Jvb3QpDQo+ICsNCj4gK3N0YXRpYyBp
bmxpbmUgZW51bSBxY29tdGVlX29iamVjdF90eXBlDQo+ICt0eXBlb2ZfcWNvbXRlZV9vYmplY3Qo
c3RydWN0IHFjb210ZWVfb2JqZWN0ICpvYmplY3QpDQo+ICt7DQo+ICsgICAgICAgaWYgKG9iamVj
dCA9PSBOVUxMX1FDT01URUVfT0JKRUNUKQ0KPiArICAgICAgICAgICAgICAgcmV0dXJuIFFDT01U
RUVfT0JKRUNUX1RZUEVfTlVMTDsNCj4gKyAgICAgICByZXR1cm4gb2JqZWN0LT5vYmplY3RfdHlw
ZTsNCj4gK30NCj4gKw0KPiArc3RhdGljIGlubGluZSBjb25zdCBjaGFyICpxY29tdGVlX29iamVj
dF9uYW1lKHN0cnVjdCBxY29tdGVlX29iamVjdCAqb2JqZWN0KQ0KPiArew0KPiArICAgICAgIGlm
IChvYmplY3QgPT0gTlVMTF9RQ09NVEVFX09CSkVDVCkNCj4gKyAgICAgICAgICAgICAgIHJldHVy
biAibnVsbCI7DQo+ICsNCj4gKyAgICAgICBpZiAoIW9iamVjdC0+bmFtZSkNCj4gKyAgICAgICAg
ICAgICAgIHJldHVybiAibm8tbmFtZSI7DQo+ICsgICAgICAgcmV0dXJuIG9iamVjdC0+bmFtZTsN
Cj4gK30NCj4gKw0KPiArLyoqDQo+ICsgKiBxY29tdGVlX29iamVjdF91c2VyX2luaXQoKSAtIElu
aXRpYWxpemUgYW4gb2JqZWN0IGZvciB0aGUgdXNlci4NCj4gKyAqIEBvYmplY3Q6IG9iamVjdCB0
byBpbml0aWFsaXplLg0KPiArICogQG90OiB0eXBlIG9mIG9iamVjdCBhcyAmZW51bSBxY29tdGVl
X29iamVjdF90eXBlLg0KPiArICogQG9wczogaW5zdGFuY2Ugb2YgY2FsbGJhY2tzLg0KPiArICog
QGZtdDogbmFtZSBhc3NpZ25lZCB0byB0aGUgb2JqZWN0Lg0KPiArICoNCj4gKyAqIFJldHVybjog
T24gc3VjY2VzcywgcmV0dXJucyAwOyBvbiBmYWlsdXJlLCByZXR1cm5zIDwgMC4NCj4gKyAqLw0K
PiAraW50IHFjb210ZWVfb2JqZWN0X3VzZXJfaW5pdChzdHJ1Y3QgcWNvbXRlZV9vYmplY3QgKm9i
amVjdCwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbnVtIHFjb210ZWVfb2JqZWN0
X3R5cGUgb3QsDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RydWN0IHFjb210ZWVf
b2JqZWN0X29wZXJhdGlvbnMgKm9wcywNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCBjaGFyICpmbXQsIC4uLik7DQo+ICsNCj4gKy8qIE9iamVjdCByZWxlYXNlIGlzIFJDVSBw
cm90ZWN0ZWQuICovDQo+ICtpbnQgcWNvbXRlZV9vYmplY3RfZ2V0KHN0cnVjdCBxY29tdGVlX29i
amVjdCAqb2JqZWN0KTsNCj4gK3ZvaWQgcWNvbXRlZV9vYmplY3RfcHV0KHN0cnVjdCBxY29tdGVl
X29iamVjdCAqb2JqZWN0KTsNCj4gKw0KPiArI2RlZmluZSBxY29tdGVlX2FyZ19mb3JfZWFjaChp
LCBhcmdzKSBcDQo+ICsgICAgICAgZm9yIChpID0gMDsgYXJnc1tpXS50eXBlICE9IFFDT01URUVf
QVJHX1RZUEVfSU5WOyBpKyspDQo+ICsNCj4gKy8qIE5leHQgYXJndW1lbnQgb2YgdHlwZSBAdHlw
ZSBhZnRlciBpbmRleCBAaS4gKi8NCj4gK2ludCBxY29tdGVlX25leHRfYXJnX3R5cGUoc3RydWN0
IHFjb210ZWVfYXJnICp1LCBpbnQgaSwNCj4gKyAgICAgICAgICAgICAgICAgICAgICAgICBlbnVt
IHFjb210ZWVfYXJnX3R5cGUgdHlwZSk7DQo+ICsNCj4gKy8qIEl0ZXJhdGUgb3ZlciBhcmd1bWVu
dCBvZiBnaXZlbiB0eXBlLiAqLw0KPiArI2RlZmluZSBxY29tdGVlX2FyZ19mb3JfZWFjaF90eXBl
KGksIGFyZ3MsIGF0KSAgICAgICAgICAgICAgXA0KPiArICAgICAgIGZvciAoaSA9IDAsIGkgPSBx
Y29tdGVlX25leHRfYXJnX3R5cGUoYXJncywgaSwgYXQpOyBcDQoNCmkgPSBxY29tdGVlX25leHRf
YXJnX3R5cGUoYXJncywgMCwgYXQpDQoNCj4gKyAgICAgICAgICAgIGFyZ3NbaV0udHlwZSAhPSBR
Q09NVEVFX0FSR19UWVBFX0lOVjsgICAgICAgICAgXA0KPiArICAgICAgICAgICAgaSsrLCBpID0g
cWNvbXRlZV9uZXh0X2FyZ190eXBlKGFyZ3MsIGksIGF0KSkNCg0KaSA9IHFjb210ZWVfbmV4dF9h
cmdfdHlwZShhcmdzLCBpICsgMSwgYXQpDQoNCkNoZWVycywNCkplbnMNCg0KPiArDQo+ICsjZGVm
aW5lIHFjb210ZWVfYXJnX2Zvcl9lYWNoX2lucHV0X2J1ZmZlcihpLCBhcmdzKSBcDQo+ICsgICAg
ICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfdHlwZShpLCBhcmdzLCBRQ09NVEVFX0FSR19UWVBFX0lC
KQ0KPiArI2RlZmluZSBxY29tdGVlX2FyZ19mb3JfZWFjaF9vdXRwdXRfYnVmZmVyKGksIGFyZ3Mp
IFwNCj4gKyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF90eXBlKGksIGFyZ3MsIFFDT01URUVf
QVJHX1RZUEVfT0IpDQo+ICsjZGVmaW5lIHFjb210ZWVfYXJnX2Zvcl9lYWNoX2lucHV0X29iamVj
dChpLCBhcmdzKSBcDQo+ICsgICAgICAgcWNvbXRlZV9hcmdfZm9yX2VhY2hfdHlwZShpLCBhcmdz
LCBRQ09NVEVFX0FSR19UWVBFX0lPKQ0KPiArI2RlZmluZSBxY29tdGVlX2FyZ19mb3JfZWFjaF9v
dXRwdXRfb2JqZWN0KGksIGFyZ3MpIFwNCj4gKyAgICAgICBxY29tdGVlX2FyZ19mb3JfZWFjaF90
eXBlKGksIGFyZ3MsIFFDT01URUVfQVJHX1RZUEVfT08pDQo+ICsNCj4gKyNlbmRpZiAvKiBfX1FD
T01fVEVFX0ggKi8NCj4gZGlmZiAtLWdpdCBhL2luY2x1ZGUvdWFwaS9saW51eC90ZWUuaCBiL2lu
Y2x1ZGUvdWFwaS9saW51eC90ZWUuaA0KPiBpbmRleCA4NjQyY2U3ZTQ3NzIuLjBlZmIyODM1ZDZk
YyAxMDA2NDQNCj4gLS0tIGEvaW5jbHVkZS91YXBpL2xpbnV4L3RlZS5oDQo+ICsrKyBiL2luY2x1
ZGUvdWFwaS9saW51eC90ZWUuaA0KPiBAQCAtNTksNiArNTksNyBAQA0KPiAgI2RlZmluZSBURUVf
SU1QTF9JRF9PUFRFRSAgICAgIDENCj4gICNkZWZpbmUgVEVFX0lNUExfSURfQU1EVEVFICAgICAy
DQo+ICAjZGVmaW5lIFRFRV9JTVBMX0lEX1RTVEVFICAgICAgMw0KPiArI2RlZmluZSBURUVfSU1Q
TF9JRF9RVEVFICAgICAgIDQNCj4NCj4gIC8qDQo+ICAgKiBPUC1URUUgc3BlY2lmaWMgY2FwYWJp
bGl0aWVzDQo+DQo+IC0tDQo+IDIuMzQuMQ0KPg0KX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QgLS0gbGluYXJv
LW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1haWwgdG8g
bGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
