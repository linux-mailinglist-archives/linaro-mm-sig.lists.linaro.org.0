Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 78D2EAFB426
	for <lists+linaro-mm-sig@lfdr.de>; Mon,  7 Jul 2025 15:15:38 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 1544345506
	for <lists+linaro-mm-sig@lfdr.de>; Mon,  7 Jul 2025 13:15:37 +0000 (UTC)
Received: from smtp-out2.suse.de (smtp-out2.suse.de [195.135.223.131])
	by lists.linaro.org (Postfix) with ESMTPS id 4B5743F6DD
	for <linaro-mm-sig@lists.linaro.org>; Mon,  7 Jul 2025 13:15:25 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=suse.de header.s=susede2_rsa header.b=gk7LV8Oz;
	dkim=pass header.d=suse.de header.s=susede2_ed25519 header.b=SufhylUm;
	dkim=pass header.d=suse.de header.s=susede2_rsa header.b=gk7LV8Oz;
	dkim=pass header.d=suse.de header.s=susede2_ed25519 header.b=SufhylUm;
	spf=pass (lists.linaro.org: domain of tzimmermann@suse.de designates 195.135.223.131 as permitted sender) smtp.mailfrom=tzimmermann@suse.de;
	dmarc=pass (policy=none) header.from=suse.de
Received: from imap1.dmz-prg2.suse.org (imap1.dmz-prg2.suse.org [IPv6:2a07:de40:b281:104:10:150:64:97])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	 key-exchange X25519 server-signature RSA-PSS (4096 bits) server-digest SHA256)
	(No client certificate requested)
	by smtp-out2.suse.de (Postfix) with ESMTPS id EB7C51F390;
	Mon,  7 Jul 2025 13:15:23 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
	t=1751894124; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
	 mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding;
	bh=C1Dhfr+8pCD1IYHBaTcTmQM8ZHAUNKPJlBoJluMTmOM=;
	b=gk7LV8OzXH0xQwoYIU01XxQQwayccpL/ryS42+1w++X1XaLujOmtL9/NgK7XqCQYJtI/PQ
	yoMGOxcvrBUu+STibWUO1e+savkgMYHIoEzzlrIXUo+Gx7ehY66fUK2+pqyWizGNm/eooU
	bpENS39t5dgrJDVUehMxbgXYh72Q7eA=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
	s=susede2_ed25519; t=1751894124;
	h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
	 mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding;
	bh=C1Dhfr+8pCD1IYHBaTcTmQM8ZHAUNKPJlBoJluMTmOM=;
	b=SufhylUm15tiX0SS4fZ5lnTwN4UyYrOtjrqQJQtsTsiB1111iwPhgck9Q4FK5TGasuC9ZI
	JxI0fs76hdhz+ECg==
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=suse.de; s=susede2_rsa;
	t=1751894124; h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
	 mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding;
	bh=C1Dhfr+8pCD1IYHBaTcTmQM8ZHAUNKPJlBoJluMTmOM=;
	b=gk7LV8OzXH0xQwoYIU01XxQQwayccpL/ryS42+1w++X1XaLujOmtL9/NgK7XqCQYJtI/PQ
	yoMGOxcvrBUu+STibWUO1e+savkgMYHIoEzzlrIXUo+Gx7ehY66fUK2+pqyWizGNm/eooU
	bpENS39t5dgrJDVUehMxbgXYh72Q7eA=
DKIM-Signature: v=1; a=ed25519-sha256; c=relaxed/relaxed; d=suse.de;
	s=susede2_ed25519; t=1751894124;
	h=from:from:reply-to:date:date:message-id:message-id:to:to:cc:cc:
	 mime-version:mime-version:content-type:content-type:
	 content-transfer-encoding:content-transfer-encoding;
	bh=C1Dhfr+8pCD1IYHBaTcTmQM8ZHAUNKPJlBoJluMTmOM=;
	b=SufhylUm15tiX0SS4fZ5lnTwN4UyYrOtjrqQJQtsTsiB1111iwPhgck9Q4FK5TGasuC9ZI
	JxI0fs76hdhz+ECg==
Received: from imap1.dmz-prg2.suse.org (localhost [127.0.0.1])
	(using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
	 key-exchange X25519 server-signature RSA-PSS (4096 bits) server-digest SHA256)
	(No client certificate requested)
	by imap1.dmz-prg2.suse.org (Postfix) with ESMTPS id 737EF13757;
	Mon,  7 Jul 2025 13:15:23 +0000 (UTC)
Received: from dovecot-director2.suse.de ([2a07:de40:b281:106:10:150:64:167])
	by imap1.dmz-prg2.suse.org with ESMTPSA
	id nrjKGmvIa2hgFgAAD6G6ig
	(envelope-from <tzimmermann@suse.de>); Mon, 07 Jul 2025 13:15:23 +0000
From: Thomas Zimmermann <tzimmermann@suse.de>
To: christian.koenig@amd.com,
	asrivats@redhat.com,
	maarten.lankhorst@linux.intel.com,
	mripard@kernel.org,
	airlied@gmail.com,
	simona@ffwll.ch,
	jean-christophe@guillain.net,
	superm1@kernel.org,
	satadru@gmail.com,
	bp@alien8.de
Date: Mon,  7 Jul 2025 15:11:55 +0200
Message-ID: <20250707131224.249496-1-tzimmermann@suse.de>
X-Mailer: git-send-email 2.50.0
MIME-Version: 1.0
X-Spam-Flag: NO
X-Spam-Level: 
X-Spam-Score: -3.51
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: 4B5743F6DD
X-Spamd-Bar: ----
X-Spamd-Result: default: False [-4.00 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	RBL_SENDERSCORE_REPUT_9(-1.00)[195.135.223.131:from];
	MID_CONTAINS_FROM(1.00)[];
	DMARC_POLICY_ALLOW(-0.50)[suse.de,none];
	R_SPF_ALLOW(-0.20)[+ip4:195.135.223.131/32];
	R_DKIM_ALLOW(-0.20)[suse.de:s=susede2_rsa,suse.de:s=susede2_ed25519];
	MIME_GOOD(-0.10)[text/plain];
	RCPT_COUNT_TWELVE(0.00)[18];
	ASN(0.00)[asn:29298, ipnet:195.135.223.0/24, country:DE];
	MIME_TRACE(0.00)[0:+];
	FREEMAIL_TO(0.00)[amd.com,redhat.com,linux.intel.com,kernel.org,gmail.com,ffwll.ch,guillain.net,alien8.de];
	RCVD_VIA_SMTP_AUTH(0.00)[];
	ARC_NA(0.00)[];
	RCVD_TLS_ALL(0.00)[];
	RCVD_COUNT_THREE(0.00)[3];
	TO_DN_SOME(0.00)[];
	FROM_HAS_DN(0.00)[];
	FREEMAIL_CC(0.00)[lists.freedesktop.org,vger.kernel.org,suse.de,web.de,linaro.org,lists.linaro.org];
	NEURAL_HAM(-0.00)[-1.000];
	FROM_EQ_ENVFROM(0.00)[];
	DNSWL_BLOCKED(0.00)[2a07:de40:b281:106:10:150:64:167:received,195.135.223.131:from];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	URIBL_BLOCKED(0.00)[linaro.org:email,suse.de:email,suse.de:dkim,suse.de:mid];
	DKIM_TRACE(0.00)[suse.de:+]
X-Rspamd-Action: no action
Message-ID-Hash: S2ENT4YAEKRADX6E2VXJCKTAMWEVEX4T
X-Message-ID-Hash: S2ENT4YAEKRADX6E2VXJCKTAMWEVEX4T
X-MailFrom: tzimmermann@suse.de
X-Mailman-Rule-Hits: nonmember-moderation
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation
CC: dri-devel@lists.freedesktop.org, linux-kernel@vger.kernel.org, Thomas Zimmermann <tzimmermann@suse.de>, Bert Karwatzki <spasswolf@web.de>, Sumit Semwal <sumit.semwal@linaro.org>, linux-media@vger.kernel.org, linaro-mm-sig@lists.linaro.org, stable@vger.kernel.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH v3] drm/framebuffer: Acquire internal references on GEM handles
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/S2ENT4YAEKRADX6E2VXJCKTAMWEVEX4T/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

QWNxdWlyZSBHRU0gaGFuZGxlcyBpbiBkcm1fZnJhbWVidWZmZXJfaW5pdCgpIGFuZCByZWxlYXNl
IHRoZW0gaW4NCnRoZSBjb3JyZXNwb25kaW5nIGRybV9mcmFtZWJ1ZmZlcl9jbGVhbnVwKCkuIFRp
ZXMgdGhlIGhhbmRsZSdzDQpsaWZldGltZSB0byB0aGUgZnJhbWVidWZmZXIuIE5vdCBhbGwgR0VN
IGJ1ZmZlciBvYmplY3RzIGhhdmUgR0VNDQpoYW5kbGVzLiBJZiBub3Qgc2V0LCBubyByZWZjb3Vu
dGluZyB0YWtlcyBwbGFjZS4gVGhpcyBpcyB0aGUgY2FzZQ0KZm9yIHNvbWUgZmJkZXYgZW11bGF0
aW9uLiBUaGlzIGlzIG5vdCBhIHByb2JsZW0gYXMgdGhlc2UgR0VNIG9iamVjdHMNCmRvIG5vdCB1
c2UgZG1hLWJ1ZnMgYW5kIGRyaXZlcnMgd2lsbCBub3QgcmVsZWFzZSB0aGVtIHdoaWxlIGZiZGV2
DQplbXVsYXRpb24gaXMgcnVubmluZy4gRnJhbWVidWZmZXIgZmxhZ3Mga2VlcCBhIGJpdCBwZXIg
Y29sb3IgcGxhbmUNCm9mIHdoaWNoIHRoZSBmcmFtZWJ1ZmZlciBob2xkcyBhIEdFTSBoYW5kbGUg
cmVmZXJlbmNlLg0KDQpBcyBhbGwgZHJpdmVycyB1c2UgZHJtX2ZyYW1lYnVmZmVyX2luaXQoKSwg
dGhleSB3aWxsIG5vdyBhbGwgaG9sZA0KZG1hLWJ1ZiByZWZlcmVuY2VzIGFzIGZpeGVkIGluIGNv
bW1pdCA1MzA3ZGNlODc4ZDQgKCJkcm0vZ2VtOiBBY3F1aXJlDQpyZWZlcmVuY2VzIG9uIEdFTSBo
YW5kbGVzIGZvciBmcmFtZWJ1ZmZlcnMiKS4NCg0KSW4gdGhlIEdFTSBmcmFtZWJ1ZmZlciBoZWxw
ZXJzLCByZXN0b3JlIHRoZSBvcmlnaW5hbCByZWYgY291bnRpbmcNCm9uIGJ1ZmZlciBvYmplY3Rz
LiBBcyB0aGUgaGVscGVycyBmb3IgaGFuZGxlIHJlZmNvdW50aW5nIGFyZSBub3cNCm5vIGxvbmdl
ciBjYWxsZWQgZnJvbSBvdXRzaWRlIHRoZSBEUk0gY29yZSwgdW5leHBvcnQgdGhlIHN5bWJvbHMu
DQoNCnYzOg0KLSBkb24ndCBtaXggaW50ZXJuYWwgZmxhZ3Mgd2l0aCBtb2RlIGZsYWdzIChDaHJp
c3RpYW4pDQp2MjoNCi0gdHJhY2sgZnJhbWVidWZmZXIgaGFuZGxlIHJlZnMgYnkgZmxhZw0KLSBk
cm9wIGdtYTUwMCBjbGVhbnVwIChDaHJpc3RpYW4pDQoNClNpZ25lZC1vZmYtYnk6IFRob21hcyBa
aW1tZXJtYW5uIDx0emltbWVybWFubkBzdXNlLmRlPg0KRml4ZXM6IDUzMDdkY2U4NzhkNCAoImRy
bS9nZW06IEFjcXVpcmUgcmVmZXJlbmNlcyBvbiBHRU0gaGFuZGxlcyBmb3IgZnJhbWVidWZmZXJz
IikNClJlcG9ydGVkLWJ5OiBCZXJ0IEthcndhdHpraSA8c3Bhc3N3b2xmQHdlYi5kZT4NCkNsb3Nl
czogaHR0cHM6Ly9sb3JlLmtlcm5lbC5vcmcvZHJpLWRldmVsLzIwMjUwNzAzMTE1OTE1LjMwOTYt
MS1zcGFzc3dvbGZAd2ViLmRlLw0KVGVzdGVkLWJ5OiBCZXJ0IEthcndhdHpraSA8c3Bhc3N3b2xm
QHdlYi5kZT4NClRlc3RlZC1ieTogTWFyaW8gTGltb25jaWVsbG8gPHN1cGVybTFAa2VybmVsLm9y
Zz4NCkNjOiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4NCkNjOiBBbnVz
aGEgU3JpdmF0c2EgPGFzcml2YXRzQHJlZGhhdC5jb20+DQpDYzogQ2hyaXN0aWFuIEvDtm5pZyA8
Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPg0KQ2M6IE1hYXJ0ZW4gTGFua2hvcnN0IDxtYWFydGVu
Lmxhbmtob3JzdEBsaW51eC5pbnRlbC5jb20+DQpDYzogTWF4aW1lIFJpcGFyZCA8bXJpcGFyZEBr
ZXJuZWwub3JnPg0KQ2M6IFN1bWl0IFNlbXdhbCA8c3VtaXQuc2Vtd2FsQGxpbmFyby5vcmc+DQpD
YzogIkNocmlzdGlhbiBLw7ZuaWciIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+DQpDYzogbGlu
dXgtbWVkaWFAdmdlci5rZXJuZWwub3JnDQpDYzogZHJpLWRldmVsQGxpc3RzLmZyZWVkZXNrdG9w
Lm9yZw0KQ2M6IGxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZw0KQ2M6IDxzdGFibGVAdmdl
ci5rZXJuZWwub3JnPg0KLS0tDQogZHJpdmVycy9ncHUvZHJtL2RybV9mcmFtZWJ1ZmZlci5jICAg
ICAgICAgICAgfCAzMSArKysrKysrKysrKysrKy0tDQogZHJpdmVycy9ncHUvZHJtL2RybV9nZW0u
YyAgICAgICAgICAgICAgICAgICAgfCAzOCArKysrKysrKysrKystLS0tLS0tLQ0KIGRyaXZlcnMv
Z3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5jIHwgMTYgKysrKy0tLS0tDQogZHJp
dmVycy9ncHUvZHJtL2RybV9pbnRlcm5hbC5oICAgICAgICAgICAgICAgfCAgMiArLQ0KIGluY2x1
ZGUvZHJtL2RybV9mcmFtZWJ1ZmZlci5oICAgICAgICAgICAgICAgIHwgIDcgKysrKw0KIDUgZmls
ZXMgY2hhbmdlZCwgNjggaW5zZXJ0aW9ucygrKSwgMjYgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ZyYW1lYnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0v
ZHJtX2ZyYW1lYnVmZmVyLmMNCmluZGV4IGI3ODE2MDE5NDZkYi4uNjNhNzBmMjg1Y2NlIDEwMDY0
NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9mcmFtZWJ1ZmZlci5jDQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vZHJtX2ZyYW1lYnVmZmVyLmMNCkBAIC04NjIsMTEgKzg2MiwyMyBAQCBFWFBPUlRf
U1lNQk9MX0ZPUl9URVNUU19PTkxZKGRybV9mcmFtZWJ1ZmZlcl9mcmVlKTsNCiBpbnQgZHJtX2Zy
YW1lYnVmZmVyX2luaXQoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgc3RydWN0IGRybV9mcmFtZWJ1
ZmZlciAqZmIsDQogCQkJIGNvbnN0IHN0cnVjdCBkcm1fZnJhbWVidWZmZXJfZnVuY3MgKmZ1bmNz
KQ0KIHsNCisJdW5zaWduZWQgaW50IGk7DQogCWludCByZXQ7DQorCWJvb2wgZXhpc3RzOw0KIA0K
IAlpZiAoV0FSTl9PTl9PTkNFKGZiLT5kZXYgIT0gZGV2IHx8ICFmYi0+Zm9ybWF0KSkNCiAJCXJl
dHVybiAtRUlOVkFMOw0KIA0KKwlmb3IgKGkgPSAwOyBpIDwgZmItPmZvcm1hdC0+bnVtX3BsYW5l
czsgaSsrKSB7DQorCQlpZiAoZHJtX1dBUk5fT05fT05DRShkZXYsIGZiLT5pbnRlcm5hbF9mbGFn
cyAmIERSTV9GUkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRihpKSkpDQorCQkJZmItPmludGVybmFs
X2ZsYWdzICY9IH5EUk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSk7DQorCQlpZiAoZmIt
Pm9ialtpXSkgew0KKwkJCWV4aXN0cyA9IGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfaWZfZXhp
c3RzX3VubG9ja2VkKGZiLT5vYmpbaV0pOw0KKwkJCWlmIChleGlzdHMpDQorCQkJCWZiLT5pbnRl
cm5hbF9mbGFncyB8PSBEUk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSk7DQorCQl9DQor
CX0NCisNCiAJSU5JVF9MSVNUX0hFQUQoJmZiLT5maWxwX2hlYWQpOw0KIA0KIAlmYi0+ZnVuY3Mg
PSBmdW5jczsNCkBAIC04NzUsNyArODg3LDcgQEAgaW50IGRybV9mcmFtZWJ1ZmZlcl9pbml0KHN0
cnVjdCBkcm1fZGV2aWNlICpkZXYsIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLA0KIAlyZXQg
PSBfX2RybV9tb2RlX29iamVjdF9hZGQoZGV2LCAmZmItPmJhc2UsIERSTV9NT0RFX09CSkVDVF9G
QiwNCiAJCQkJICAgIGZhbHNlLCBkcm1fZnJhbWVidWZmZXJfZnJlZSk7DQogCWlmIChyZXQpDQot
CQlnb3RvIG91dDsNCisJCWdvdG8gZXJyOw0KIA0KIAltdXRleF9sb2NrKCZkZXYtPm1vZGVfY29u
ZmlnLmZiX2xvY2spOw0KIAlkZXYtPm1vZGVfY29uZmlnLm51bV9mYisrOw0KQEAgLTg4Myw3ICs4
OTUsMTYgQEAgaW50IGRybV9mcmFtZWJ1ZmZlcl9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYs
IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgKmZiLA0KIAltdXRleF91bmxvY2soJmRldi0+bW9kZV9j
b25maWcuZmJfbG9jayk7DQogDQogCWRybV9tb2RlX29iamVjdF9yZWdpc3RlcihkZXYsICZmYi0+
YmFzZSk7DQotb3V0Og0KKw0KKwlyZXR1cm4gMDsNCisNCitlcnI6DQorCWZvciAoaSA9IDA7IGkg
PCBmYi0+Zm9ybWF0LT5udW1fcGxhbmVzOyBpKyspIHsNCisJCWlmIChmYi0+aW50ZXJuYWxfZmxh
Z3MgJiBEUk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSkpIHsNCisJCQlkcm1fZ2VtX29i
amVjdF9oYW5kbGVfcHV0X3VubG9ja2VkKGZiLT5vYmpbaV0pOw0KKwkJCWZiLT5pbnRlcm5hbF9m
bGFncyAmPSB+RFJNX0ZSQU1FQlVGRkVSX0hBU19IQU5ETEVfUkVGKGkpOw0KKwkJfQ0KKwl9DQog
CXJldHVybiByZXQ7DQogfQ0KIEVYUE9SVF9TWU1CT0woZHJtX2ZyYW1lYnVmZmVyX2luaXQpOw0K
QEAgLTk2MCw2ICs5ODEsMTIgQEAgRVhQT1JUX1NZTUJPTChkcm1fZnJhbWVidWZmZXJfdW5yZWdp
c3Rlcl9wcml2YXRlKTsNCiB2b2lkIGRybV9mcmFtZWJ1ZmZlcl9jbGVhbnVwKHN0cnVjdCBkcm1f
ZnJhbWVidWZmZXIgKmZiKQ0KIHsNCiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IGZiLT5kZXY7
DQorCXVuc2lnbmVkIGludCBpOw0KKw0KKwlmb3IgKGkgPSAwOyBpIDwgZmItPmZvcm1hdC0+bnVt
X3BsYW5lczsgaSsrKSB7DQorCQlpZiAoZmItPmludGVybmFsX2ZsYWdzICYgRFJNX0ZSQU1FQlVG
RkVSX0hBU19IQU5ETEVfUkVGKGkpKQ0KKwkJCWRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5s
b2NrZWQoZmItPm9ialtpXSk7DQorCX0NCiANCiAJbXV0ZXhfbG9jaygmZGV2LT5tb2RlX2NvbmZp
Zy5mYl9sb2NrKTsNCiAJbGlzdF9kZWwoJmZiLT5oZWFkKTsNCmRpZmYgLS1naXQgYS9kcml2ZXJz
L2dwdS9kcm0vZHJtX2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL2RybV9nZW0uYw0KaW5kZXggYmM1
MDVkOTM4YjNlLi40MWNkYWI2MDg4YWUgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJt
X2dlbS5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5jDQpAQCAtMjI0LDIzICsyMjQs
MzQgQEAgc3RhdGljIHZvaWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldChzdHJ1Y3QgZHJtX2dl
bV9vYmplY3QgKm9iaikNCiB9DQogDQogLyoqDQotICogZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dl
dF91bmxvY2tlZCAtIGFjcXVpcmUgcmVmZXJlbmNlIG9uIHVzZXItc3BhY2UgaGFuZGxlcw0KKyAq
IGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfaWZfZXhpc3RzX3VubG9ja2VkIC0gYWNxdWlyZSBy
ZWZlcmVuY2Ugb24gdXNlci1zcGFjZSBoYW5kbGUsIGlmIGFueQ0KICAqIEBvYmo6IEdFTSBvYmpl
Y3QNCiAgKg0KLSAqIEFjcXVpcmVzIGEgcmVmZXJlbmNlIG9uIHRoZSBHRU0gYnVmZmVyIG9iamVj
dCdzIGhhbmRsZS4gUmVxdWlyZWQNCi0gKiB0byBrZWVwIHRoZSBHRU0gb2JqZWN0IGFsaXZlLiBD
YWxsIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQoKQ0KLSAqIHRvIHJlbGVhc2Ug
dGhlIHJlZmVyZW5jZS4NCisgKiBBY3F1aXJlcyBhIHJlZmVyZW5jZSBvbiB0aGUgR0VNIGJ1ZmZl
ciBvYmplY3QncyBoYW5kbGUuIFJlcXVpcmVkIHRvIGtlZXANCisgKiB0aGUgR0VNIG9iamVjdCBh
bGl2ZS4gQ2FsbCBkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X2lmX2V4aXN0c191bmxvY2tlZCgp
DQorICogdG8gcmVsZWFzZSB0aGUgcmVmZXJlbmNlLiBEb2VzIG5vdGhpbmcgaWYgdGhlIGJ1ZmZl
ciBvYmplY3QgaGFzIG5vIGhhbmRsZS4NCisgKg0KKyAqIFJldHVybnM6DQorICogVHJ1ZSBpZiBh
IGhhbmRsZSBleGlzdHMsIG9yIGZhbHNlIG90aGVyd2lzZQ0KICAqLw0KLXZvaWQgZHJtX2dlbV9v
YmplY3RfaGFuZGxlX2dldF91bmxvY2tlZChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaikNCiti
b29sIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfaWZfZXhpc3RzX3VubG9ja2VkKHN0cnVjdCBk
cm1fZ2VtX29iamVjdCAqb2JqKQ0KIHsNCiAJc3RydWN0IGRybV9kZXZpY2UgKmRldiA9IG9iai0+
ZGV2Ow0KIA0KIAlndWFyZChtdXRleCkoJmRldi0+b2JqZWN0X25hbWVfbG9jayk7DQogDQotCWRy
bV9XQVJOX09OKGRldiwgIW9iai0+aGFuZGxlX2NvdW50KTsgLyogZmlyc3QgcmVmIHRha2VuIGlu
IGNyZWF0ZS10YWlsIGhlbHBlciAqLw0KKwkvKg0KKwkgKiBGaXJzdCByZWYgdGFrZW4gZHVyaW5n
IEdFTSBvYmplY3QgY3JlYXRpb24sIGlmIGFueS4gU29tZQ0KKwkgKiBkcml2ZXJzIHNldCB1cCBp
bnRlcm5hbCBmcmFtZWJ1ZmZlcnMgd2l0aCBHRU0gb2JqZWN0cyB0aGF0DQorCSAqIGRvIG5vdCBo
YXZlIGEgR0VNIGhhbmRsZS4gSGVuY2UsIHRoaXMgY291bnRlciBjYW4gYmUgemVyby4NCisJICov
DQorCWlmICghb2JqLT5oYW5kbGVfY291bnQpDQorCQlyZXR1cm4gZmFsc2U7DQorDQogCWRybV9n
ZW1fb2JqZWN0X2hhbmRsZV9nZXQob2JqKTsNCisNCisJcmV0dXJuIHRydWU7DQogfQ0KLUVYUE9S
VF9TWU1CT0woZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF91bmxvY2tlZCk7DQogDQogLyoqDQog
ICogZHJtX2dlbV9vYmplY3RfaGFuZGxlX2ZyZWUgLSByZWxlYXNlIHJlc291cmNlcyBib3VuZCB0
byB1c2Vyc3BhY2UgaGFuZGxlcw0KQEAgLTI3Myw3ICsyODQsNyBAQCBzdGF0aWMgdm9pZCBkcm1f
Z2VtX29iamVjdF9leHBvcnRlZF9kbWFfYnVmX2ZyZWUoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpv
YmopDQogfQ0KIA0KIC8qKg0KLSAqIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQg
LSByZWxlYXNlcyByZWZlcmVuY2Ugb24gdXNlci1zcGFjZSBoYW5kbGVzDQorICogZHJtX2dlbV9v
YmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZCAtIHJlbGVhc2VzIHJlZmVyZW5jZSBvbiB1c2VyLXNw
YWNlIGhhbmRsZQ0KICAqIEBvYmo6IEdFTSBvYmplY3QNCiAgKg0KICAqIFJlbGVhc2VzIGEgcmVm
ZXJlbmNlIG9uIHRoZSBHRU0gYnVmZmVyIG9iamVjdCdzIGhhbmRsZS4gUG9zc2libHkgcmVsZWFz
ZXMNCkBAIC0yODQsMTQgKzI5NSwxNCBAQCB2b2lkIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRf
dW5sb2NrZWQoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopDQogCXN0cnVjdCBkcm1fZGV2aWNl
ICpkZXYgPSBvYmotPmRldjsNCiAJYm9vbCBmaW5hbCA9IGZhbHNlOw0KIA0KLQlpZiAoV0FSTl9P
TihSRUFEX09OQ0Uob2JqLT5oYW5kbGVfY291bnQpID09IDApKQ0KKwlpZiAoZHJtX1dBUk5fT04o
ZGV2LCBSRUFEX09OQ0Uob2JqLT5oYW5kbGVfY291bnQpID09IDApKQ0KIAkJcmV0dXJuOw0KIA0K
IAkvKg0KLQkqIE11c3QgYnVtcCBoYW5kbGUgY291bnQgZmlyc3QgYXMgdGhpcyBtYXkgYmUgdGhl
IGxhc3QNCi0JKiByZWYsIGluIHdoaWNoIGNhc2UgdGhlIG9iamVjdCB3b3VsZCBkaXNhcHBlYXIg
YmVmb3JlIHdlDQotCSogY2hlY2tlZCBmb3IgYSBuYW1lDQotCSovDQorCSAqIE11c3QgYnVtcCBo
YW5kbGUgY291bnQgZmlyc3QgYXMgdGhpcyBtYXkgYmUgdGhlIGxhc3QNCisJICogcmVmLCBpbiB3
aGljaCBjYXNlIHRoZSBvYmplY3Qgd291bGQgZGlzYXBwZWFyIGJlZm9yZQ0KKwkgKiB3ZSBjaGVj
a2VkIGZvciBhIG5hbWUuDQorCSAqLw0KIA0KIAltdXRleF9sb2NrKCZkZXYtPm9iamVjdF9uYW1l
X2xvY2spOw0KIAlpZiAoLS1vYmotPmhhbmRsZV9jb3VudCA9PSAwKSB7DQpAQCAtMzA0LDcgKzMx
NSw2IEBAIHZvaWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZChzdHJ1Y3QgZHJt
X2dlbV9vYmplY3QgKm9iaikNCiAJaWYgKGZpbmFsKQ0KIAkJZHJtX2dlbV9vYmplY3RfcHV0KG9i
aik7DQogfQ0KLUVYUE9SVF9TWU1CT0woZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tl
ZCk7DQogDQogLyoNCiAgKiBDYWxsZWQgYXQgZGV2aWNlIG9yIG9iamVjdCBjbG9zZSB0byByZWxl
YXNlIHRoZSBmaWxlJ3MNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbV9mcmFt
ZWJ1ZmZlcl9oZWxwZXIuYyBiL2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hl
bHBlci5jDQppbmRleCBjNjBkMDA0NGQwMzYuLjYxOGNlNzI1Y2Q3NSAxMDA2NDQNCi0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5jDQorKysgYi9kcml2ZXJz
L2dwdS9kcm0vZHJtX2dlbV9mcmFtZWJ1ZmZlcl9oZWxwZXIuYw0KQEAgLTEwMCw3ICsxMDAsNyBA
QCB2b2lkIGRybV9nZW1fZmJfZGVzdHJveShzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYikNCiAJ
dW5zaWduZWQgaW50IGk7DQogDQogCWZvciAoaSA9IDA7IGkgPCBmYi0+Zm9ybWF0LT5udW1fcGxh
bmVzOyBpKyspDQotCQlkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X3VubG9ja2VkKGZiLT5vYmpb
aV0pOw0KKwkJZHJtX2dlbV9vYmplY3RfcHV0KGZiLT5vYmpbaV0pOw0KIA0KIAlkcm1fZnJhbWVi
dWZmZXJfY2xlYW51cChmYik7DQogCWtmcmVlKGZiKTsNCkBAIC0xODMsMTAgKzE4Myw4IEBAIGlu
dCBkcm1fZ2VtX2ZiX2luaXRfd2l0aF9mdW5jcyhzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LA0KIAkJ
aWYgKCFvYmpzW2ldKSB7DQogCQkJZHJtX2RiZ19rbXMoZGV2LCAiRmFpbGVkIHRvIGxvb2t1cCBH
RU0gb2JqZWN0XG4iKTsNCiAJCQlyZXQgPSAtRU5PRU5UOw0KLQkJCWdvdG8gZXJyX2dlbV9vYmpl
Y3RfaGFuZGxlX3B1dF91bmxvY2tlZDsNCisJCQlnb3RvIGVycl9nZW1fb2JqZWN0X3B1dDsNCiAJ
CX0NCi0JCWRybV9nZW1fb2JqZWN0X2hhbmRsZV9nZXRfdW5sb2NrZWQob2Jqc1tpXSk7DQotCQlk
cm1fZ2VtX29iamVjdF9wdXQob2Jqc1tpXSk7DQogDQogCQltaW5fc2l6ZSA9IChoZWlnaHQgLSAx
KSAqIG1vZGVfY21kLT5waXRjaGVzW2ldDQogCQkJICsgZHJtX2Zvcm1hdF9pbmZvX21pbl9waXRj
aChpbmZvLCBpLCB3aWR0aCkNCkBAIC0xOTYsMjIgKzE5NCwyMiBAQCBpbnQgZHJtX2dlbV9mYl9p
bml0X3dpdGhfZnVuY3Moc3RydWN0IGRybV9kZXZpY2UgKmRldiwNCiAJCQlkcm1fZGJnX2ttcyhk
ZXYsDQogCQkJCSAgICAiR0VNIG9iamVjdCBzaXplICglenUpIHNtYWxsZXIgdGhhbiBtaW5pbXVt
IHNpemUgKCV1KSBmb3IgcGxhbmUgJWRcbiIsDQogCQkJCSAgICBvYmpzW2ldLT5zaXplLCBtaW5f
c2l6ZSwgaSk7DQotCQkJZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZChvYmpzW2ld
KTsNCisJCQlkcm1fZ2VtX29iamVjdF9wdXQob2Jqc1tpXSk7DQogCQkJcmV0ID0gLUVJTlZBTDsN
Ci0JCQlnb3RvIGVycl9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQ7DQorCQkJZ290byBl
cnJfZ2VtX29iamVjdF9wdXQ7DQogCQl9DQogCX0NCiANCiAJcmV0ID0gZHJtX2dlbV9mYl9pbml0
KGRldiwgZmIsIG1vZGVfY21kLCBvYmpzLCBpLCBmdW5jcyk7DQogCWlmIChyZXQpDQotCQlnb3Rv
IGVycl9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2NrZWQ7DQorCQlnb3RvIGVycl9nZW1fb2Jq
ZWN0X3B1dDsNCiANCiAJcmV0dXJuIDA7DQogDQotZXJyX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91
bmxvY2tlZDoNCitlcnJfZ2VtX29iamVjdF9wdXQ6DQogCXdoaWxlIChpID4gMCkgew0KIAkJLS1p
Ow0KLQkJZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZChvYmpzW2ldKTsNCisJCWRy
bV9nZW1fb2JqZWN0X3B1dChvYmpzW2ldKTsNCiAJfQ0KIAlyZXR1cm4gcmV0Ow0KIH0NCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2ludGVybmFsLmggYi9kcml2ZXJzL2dwdS9kcm0v
ZHJtX2ludGVybmFsLmgNCmluZGV4IGY5MjFjYzczZjhiOC4uZTc5YzNjNjIzYzlhIDEwMDY0NA0K
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9pbnRlcm5hbC5oDQorKysgYi9kcml2ZXJzL2dwdS9k
cm0vZHJtX2ludGVybmFsLmgNCkBAIC0xNjEsNyArMTYxLDcgQEAgdm9pZCBkcm1fc3lzZnNfbGVh
c2VfZXZlbnQoc3RydWN0IGRybV9kZXZpY2UgKmRldik7DQogDQogLyogZHJtX2dlbS5jICovDQog
aW50IGRybV9nZW1faW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2KTsNCi12b2lkIGRybV9nZW1f
b2JqZWN0X2hhbmRsZV9nZXRfdW5sb2NrZWQoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopOw0K
K2Jvb2wgZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF9pZl9leGlzdHNfdW5sb2NrZWQoc3RydWN0
IGRybV9nZW1fb2JqZWN0ICpvYmopOw0KIHZvaWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91
bmxvY2tlZChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaik7DQogaW50IGRybV9nZW1faGFuZGxl
X2NyZWF0ZV90YWlsKHN0cnVjdCBkcm1fZmlsZSAqZmlsZV9wcml2LA0KIAkJCSAgICAgICBzdHJ1
Y3QgZHJtX2dlbV9vYmplY3QgKm9iaiwNCmRpZmYgLS1naXQgYS9pbmNsdWRlL2RybS9kcm1fZnJh
bWVidWZmZXIuaCBiL2luY2x1ZGUvZHJtL2RybV9mcmFtZWJ1ZmZlci5oDQppbmRleCA2NjgwNzcw
MDlmY2UuLjM4YjI0ZmM4OTc4ZCAxMDA2NDQNCi0tLSBhL2luY2x1ZGUvZHJtL2RybV9mcmFtZWJ1
ZmZlci5oDQorKysgYi9pbmNsdWRlL2RybS9kcm1fZnJhbWVidWZmZXIuaA0KQEAgLTIzLDYgKzIz
LDcgQEANCiAjaWZuZGVmIF9fRFJNX0ZSQU1FQlVGRkVSX0hfXw0KICNkZWZpbmUgX19EUk1fRlJB
TUVCVUZGRVJfSF9fDQogDQorI2luY2x1ZGUgPGxpbnV4L2JpdHMuaD4NCiAjaW5jbHVkZSA8bGlu
dXgvY3R5cGUuaD4NCiAjaW5jbHVkZSA8bGludXgvbGlzdC5oPg0KICNpbmNsdWRlIDxsaW51eC9z
Y2hlZC5oPg0KQEAgLTEwMCw2ICsxMDEsOCBAQCBzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyX2Z1bmNz
IHsNCiAJCSAgICAgdW5zaWduZWQgbnVtX2NsaXBzKTsNCiB9Ow0KIA0KKyNkZWZpbmUgRFJNX0ZS
QU1FQlVGRkVSX0hBU19IQU5ETEVfUkVGKF9pKQlCSVQoMHUgKyAoX2kpKQ0KKw0KIC8qKg0KICAq
IHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgLSBmcmFtZSBidWZmZXIgb2JqZWN0DQogICoNCkBAIC0x
ODgsNiArMTkxLDEwIEBAIHN0cnVjdCBkcm1fZnJhbWVidWZmZXIgew0KIAkgKiBEUk1fTU9ERV9G
Ql9NT0RJRklFUlMuDQogCSAqLw0KIAlpbnQgZmxhZ3M7DQorCS8qKg0KKwkgKiBAaW50ZXJuYWxf
ZmxhZ3M6IEZyYW1lYnVmZmVyIGZsYWdzIGxpa2UgRFJNX0ZSQU1FQlVGRkVSX0hBU19IQU5ETEVf
UkVGLg0KKwkgKi8NCisJdW5zaWduZWQgaW50IGludGVybmFsX2ZsYWdzOw0KIAkvKioNCiAJICog
QGZpbHBfaGVhZDogUGxhY2VkIG9uICZkcm1fZmlsZS5mYnMsIHByb3RlY3RlZCBieSAmZHJtX2Zp
bGUuZmJzX2xvY2suDQogCSAqLw0KLS0gDQoyLjUwLjANCg0KX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QgLS0g
bGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1h
aWwgdG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
