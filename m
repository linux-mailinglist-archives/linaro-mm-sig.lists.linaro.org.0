Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id C4D9E2B6D29
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 17 Nov 2020 19:21:34 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id DDD93666F4
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 17 Nov 2020 18:21:33 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id D04F5666F9; Tue, 17 Nov 2020 18:21:33 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-7.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_HI,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,SPF_HELO_NONE
	autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E553E666EF;
	Tue, 17 Nov 2020 18:20:01 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 714C566596
 for <linaro-mm-sig@lists.linaro.org>; Tue, 17 Nov 2020 18:19:51 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 6285B666EF; Tue, 17 Nov 2020 18:19:51 +0000 (UTC)
Received: from mail-pj1-f68.google.com (mail-pj1-f68.google.com
 [209.85.216.68])
 by lists.linaro.org (Postfix) with ESMTPS id 099CC66596
 for <linaro-mm-sig@lists.linaro.org>; Tue, 17 Nov 2020 18:19:48 +0000 (UTC)
Received: by mail-pj1-f68.google.com with SMTP id mn12so736703pjb.1
 for <linaro-mm-sig@lists.linaro.org>; Tue, 17 Nov 2020 10:19:48 -0800 (PST)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:sender:from:to:cc:subject:date:message-id
 :in-reply-to:references:mime-version:content-transfer-encoding;
 bh=uO92xm4brn088z6K9xBnUjWL7itcyhZywUJ7fkQYnbM=;
 b=OjSM0yUU1wyS7hWWe19X1kNH9MXddtDi5lhklw9InNDbknlCwJ66+MuhlziRGTgmtN
 G+l5QU1zRt21y9kFN1FeNbBHYQzAweXnTmmKtC9nanF1zAdYJOH0Q6VRPXEYerf60shR
 TVCa8okNeVsT41oIXRO9mvMdjBpPJEABmZKqYTIkDVPE6GQo4+VE1dNKAjMusfFCal0L
 5LSnN9daQ8I3Tce19ijeutJe3DWpwRIrSXOIsj1zpwsMnaW5IgOrxtW92TBP7ByBO1bu
 B3zTYgywZeMvJoCb9HeiI9w64EOntwRXeuovk8rMtZvfjuwSfVzuXLCQx3/gI2jHpsUM
 RWsw==
X-Gm-Message-State: AOAM5339ROUha0uEgATZF+AKG2Zpe8co5VVQ+Lelvel5/S6c7gJPYTwg
 AhBaGGUAe0CFqyjPjN41Vag=
X-Google-Smtp-Source: ABdhPJwl624GAicF93kl7dieILZKed9/4fkBOAIWrqBdo2yU9vIljUIivWAYDtC8ft2w2WeeIrwmpw==
X-Received: by 2002:a17:902:8d95:b029:d8:c2ee:7dc with SMTP id
 v21-20020a1709028d95b02900d8c2ee07dcmr822221plo.57.1605637187208; 
 Tue, 17 Nov 2020 10:19:47 -0800 (PST)
Received: from bbox-1.mtv.corp.google.com
 ([2620:15c:211:201:7220:84ff:fe09:5e58])
 by smtp.gmail.com with ESMTPSA id h8sm4302639pjc.54.2020.11.17.10.19.44
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 17 Nov 2020 10:19:45 -0800 (PST)
From: Minchan Kim <minchan@kernel.org>
To: Andrew Morton <akpm@linux-foundation.org>
Date: Tue, 17 Nov 2020 10:19:32 -0800
Message-Id: <20201117181935.3613581-2-minchan@kernel.org>
X-Mailer: git-send-email 2.29.2.299.gdc1121823c-goog
In-Reply-To: <20201117181935.3613581-1-minchan@kernel.org>
References: <20201117181935.3613581-1-minchan@kernel.org>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: robh@kernel.org, devicetree@vger.kernel.org, linux-media@vger.kernel.org,
 david@redhat.com, Minchan Kim <minchan@kernel.org>,
 LKML <linux-kernel@vger.kernel.org>, willy@infradead.org,
 Brian.Starkey@arm.com, linaro-mm-sig@lists.linaro.org,
 linux-mm <linux-mm@kvack.org>, john.stultz@linaro.org,
 christian.koenig@amd.com, joaodias@google.com, hridya@google.com,
 iamjoonsoo.kim@lge.com, pullip.cho@samsung.com, surenb@google.com,
 vbabka@suse.cz, hyesoo.yu@samsung.com
Subject: [Linaro-mm-sig] [PATCH 1/4] mm: introduce cma_alloc_bulk API
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VGhlcmUgaXMgYSBuZWVkIGZvciBzcGVjaWFsIEhXIHRvIHJlcXVpcmUgYnVsayBhbGxvY2F0aW9u
IG9mCmhpZ2gtb3JkZXIgcGFnZXMuIEZvciBleGFtcGxlLCA0ODAwICogb3JkZXItNCBwYWdlcywg
d2hpY2gKd291bGQgYmUgbWluaW11bSwgc29tZXRpbWVzLCBpdCByZXF1aXJlcyBtb3JlLgoKVG8g
bWVldCB0aGUgcmVxdWlyZW1lbnQsIGEgb3B0aW9uIHJlc2VydmVzIDMwME0gQ01BIGFyZWEgYW5k
CnJlcXVlc3RzIHRoZSB3aG9sZSAzMDBNIGNvbnRpZ3VvdXMgbWVtb3J5LiBIb3dldmVyLCBpdCBk
b2Vzbid0CndvcmsgaWYgZXZlbiBvbmUgb2YgdGhvc2UgcGFnZXMgaW4gdGhlIHJhbmdlIGlzIGxv
bmctdGVybSBwaW5uZWQKZGlyZWN0bHkgb3IgaW5kaXJlY3RseS4gVGhlIG90aGVyIG9wdGlvbiBp
cyB0byBhc2sgaGlnaGVyLW9yZGVyCnNpemUgKGUuZy4sIDJNKSB0aGFuIHJlcXVlc3RlZCBvcmRl
cig2NEspIHJlcGVhdGVkbHkgdW50aWwgZHJpdmVyCmNvdWxkIGdhdGhlciBuZWNlc3NhcnkgYW1v
dW50IG9mIG1lbW9yeS4gQmFzaWNhbGx5LCB0aGlzIGFwcHJvYWNoCm1ha2VzIHRoZSBhbGxvY2F0
aW9uIHZlcnkgc2xvdyBkdWUgdG8gY21hX2FsbG9jJ3MgZnVuY3Rpb24Kc2xvd25lc3MgYW5kIGl0
IGNvdWxkIGJlIHN0dWNrIG9uIG9uZSBvZiB0aGUgcGFnZWJsb2NrcyBpZiBpdAplbmNvdW50ZXJz
IHVubWlncmF0YWJsZSBwYWdlLgoKVG8gc29sdmUgdGhlIGlzc3VlLCB0aGlzIHBhdGNoIGludHJv
ZHVjZXMgY21hX2FsbG9jX2J1bGsuCgoJaW50IGNtYV9hbGxvY19idWxrKHN0cnVjdCBjbWEgKmNt
YSwgdW5zaWduZWQgaW50IGFsaWduLAoJCWdmcF90IGdmcF9tYXNrLCB1bnNpZ25lZCBpbnQgb3Jk
ZXIsIHNpemVfdCBucl9yZXF1ZXN0cywKCQlzdHJ1Y3QgcGFnZSAqKnBhZ2VfYXJyYXksIHNpemVf
dCAqbnJfYWxsb2NhdGVkKTsKCk1vc3QgcGFyYW1ldGVycyBhcmUgc2FtZSB3aXRoIGNtYV9hbGxv
YyBidXQgaXQgYWRkaXRpb25hbGx5IHBhc3Nlcwp2ZWN0b3IgYXJyYXkgdG8gc3RvcmUgYWxsb2Nh
dGVkIG1lbW9yeS4gV2hhdCdzIGRpZmZlcmVudCB3aXRoIGNtYV9hbGxvYwppcyBpdCB3aWxsIHNr
aXAgcGFnZWJsb2NrcyB3aXRob3V0IHdhaXRpbmcvc3RvcHBpbmcgaWYgaXQgaGFzIHVubW92YWJs
ZQpwYWdlIHNvIHRoYXQgQVBJIGNvbnRpbnVlcyB0byBzY2FuIG90aGVyIHBhZ2VibG9ja3MgdG8g
ZmluZCByZXF1ZXN0ZWQKb3JkZXIgcGFnZS4KCmNtYV9hbGxvY19idWxrIGlzIGJlc3QgZWZmb3J0
IGFwcHJvYWNoIGluIHRoYXQgaXQgc2tpcHMgc29tZSBwYWdlYmxvY2tzCmlmIHRoZXkgaGF2ZSB1
bm1vdmFibGUgcGFnZXMgdW5saWtlIGNtYV9hbGxvYy4gSXQgZG9lc24ndCBuZWVkIHRvIGJlCnBl
cmZlY3QgZnJvbSB0aGUgYmVnaW5uaW5nIGF0IHRoZSBjb3N0IG9mIHBlcmZvcm1hbmNlLiBUaHVz
LCB0aGUgQVBJCnRha2VzIGdmcF90IHRvIHN1cHBvcnQgX19HRlBfTk9SRVRSWSB3aGljaCBpcyBw
cm9wYWdhdGVkIGludG8KYWxsb2NfY29udGlnX3BhZ2UgdG8gYXZvaWQgc2lnbmlmaWNhdCBvdmVy
aGVhZCBmdW5jdGlvbnMgdG8gaW5yZWNhc2UKQ01BIGFsbG9jYXRpb24gc3VjY2VzcyByYXRpbyhl
LmcuLCBtaWdyYXRpb24gcmV0cmlhbCwgUENQLCBMUlUgZHJhaW5pbmcKcGVyIHBhZ2VibG9jaykg
YXQgdGhlIGNvc3Qgb2YgbGVzcyBhbGxvY2F0aW9uIHN1Y2Nlc3MgcmF0aW8uCklmIHRoZSBjYWxs
ZXIgY291bGRuJ3QgYWxsb2NhdGUgZW5vdWdoIHBhZ2VzIHdpdGggX19HRlBfTk9SRVRSWSwgdGhl
eQpjb3VsZCBjYWxsIGl0IHdpdGhvdXQgX19HRlBfTk9SRVRSWSB0byBpbmNyZWFzZSBzdWNjZXNz
IHJhdGlvIHRoaXMgdGltZQppZiB0aGV5IGFyZSBva2F5IHRvIGV4cGVuc2UgdGhlIG92ZXJoZWFk
IGZvciB0aGUgc3VjY2VzcyByYXRpby4KClNpZ25lZC1vZmYtYnk6IE1pbmNoYW4gS2ltIDxtaW5j
aGFuQGtlcm5lbC5vcmc+Ci0tLQogaW5jbHVkZS9saW51eC9jbWEuaCAgICAgICAgICAgIHwgICA1
ICsrCiBpbmNsdWRlL2xpbnV4L3BhZ2UtaXNvbGF0aW9uLmggfCAgIDEgKwogbW0vY21hLmMgICAg
ICAgICAgICAgICAgICAgICAgIHwgMTI2ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKyst
LQogbW0vcGFnZV9hbGxvYy5jICAgICAgICAgICAgICAgIHwgIDE5ICsrKy0tCiBtbS9wYWdlX2lz
b2xhdGlvbi5jICAgICAgICAgICAgfCAgIDMgKy0KIDUgZmlsZXMgY2hhbmdlZCwgMTQxIGluc2Vy
dGlvbnMoKyksIDEzIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvY21h
LmggYi9pbmNsdWRlL2xpbnV4L2NtYS5oCmluZGV4IDIxNzk5OWM4YTc2Mi4uMmZjOGQyYjdjZjk5
IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xpbnV4L2NtYS5oCisrKyBiL2luY2x1ZGUvbGludXgvY21h
LmgKQEAgLTQ2LDYgKzQ2LDExIEBAIGV4dGVybiBpbnQgY21hX2luaXRfcmVzZXJ2ZWRfbWVtKHBo
eXNfYWRkcl90IGJhc2UsIHBoeXNfYWRkcl90IHNpemUsCiAJCQkJCXN0cnVjdCBjbWEgKipyZXNf
Y21hKTsKIGV4dGVybiBzdHJ1Y3QgcGFnZSAqY21hX2FsbG9jKHN0cnVjdCBjbWEgKmNtYSwgc2l6
ZV90IGNvdW50LCB1bnNpZ25lZCBpbnQgYWxpZ24sCiAJCQkgICAgICBib29sIG5vX3dhcm4pOwor
CitleHRlcm4gaW50IGNtYV9hbGxvY19idWxrKHN0cnVjdCBjbWEgKmNtYSwgdW5zaWduZWQgaW50
IGFsaWduLCBnZnBfdCBnZnBfbWFzaywKKwkJCXVuc2lnbmVkIGludCBvcmRlciwgc2l6ZV90IG5y
X3JlcXVlc3RzLAorCQkJc3RydWN0IHBhZ2UgKipwYWdlX2FycmF5LCBzaXplX3QgKm5yX2FsbG9j
YXRlZCk7CisKIGV4dGVybiBib29sIGNtYV9yZWxlYXNlKHN0cnVjdCBjbWEgKmNtYSwgY29uc3Qg
c3RydWN0IHBhZ2UgKnBhZ2VzLCB1bnNpZ25lZCBpbnQgY291bnQpOwogCiBleHRlcm4gaW50IGNt
YV9mb3JfZWFjaF9hcmVhKGludCAoKml0KShzdHJ1Y3QgY21hICpjbWEsIHZvaWQgKmRhdGEpLCB2
b2lkICpkYXRhKTsKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGludXgvcGFnZS1pc29sYXRpb24uaCBi
L2luY2x1ZGUvbGludXgvcGFnZS1pc29sYXRpb24uaAppbmRleCA1NzI0NTgwMTYzMzEuLjBlMTA1
ZGNlMmExNSAxMDA2NDQKLS0tIGEvaW5jbHVkZS9saW51eC9wYWdlLWlzb2xhdGlvbi5oCisrKyBi
L2luY2x1ZGUvbGludXgvcGFnZS1pc29sYXRpb24uaApAQCAtMzIsNiArMzIsNyBAQCBzdGF0aWMg
aW5saW5lIGJvb2wgaXNfbWlncmF0ZV9pc29sYXRlKGludCBtaWdyYXRldHlwZSkKIAogI2RlZmlu
ZSBNRU1PUllfT0ZGTElORQkweDEKICNkZWZpbmUgUkVQT1JUX0ZBSUxVUkUJMHgyCisjZGVmaW5l
IFNLSVBfUENQX0RSQUlOCTB4NAogCiBzdHJ1Y3QgcGFnZSAqaGFzX3VubW92YWJsZV9wYWdlcyhz
dHJ1Y3Qgem9uZSAqem9uZSwgc3RydWN0IHBhZ2UgKnBhZ2UsCiAJCQkJIGludCBtaWdyYXRldHlw
ZSwgaW50IGZsYWdzKTsKZGlmZiAtLWdpdCBhL21tL2NtYS5jIGIvbW0vY21hLmMKaW5kZXggMzY5
MmEzNGUyMzUzLi43YzExZWMyZGMwNGMgMTAwNjQ0Ci0tLSBhL21tL2NtYS5jCisrKyBiL21tL2Nt
YS5jCkBAIC0zMiw2ICszMiw3IEBACiAjaW5jbHVkZSA8bGludXgvaGlnaG1lbS5oPgogI2luY2x1
ZGUgPGxpbnV4L2lvLmg+CiAjaW5jbHVkZSA8bGludXgva21lbWxlYWsuaD4KKyNpbmNsdWRlIDxs
aW51eC9zd2FwLmg+CiAjaW5jbHVkZSA8dHJhY2UvZXZlbnRzL2NtYS5oPgogCiAjaW5jbHVkZSAi
Y21hLmgiCkBAIC0zOTcsNiArMzk4LDE0IEBAIHN0YXRpYyB2b2lkIGNtYV9kZWJ1Z19zaG93X2Fy
ZWFzKHN0cnVjdCBjbWEgKmNtYSkKIHN0YXRpYyBpbmxpbmUgdm9pZCBjbWFfZGVidWdfc2hvd19h
cmVhcyhzdHJ1Y3QgY21hICpjbWEpIHsgfQogI2VuZGlmCiAKK3N0YXRpYyB2b2lkIHJlc2V0X3Bh
Z2Vfa2FzYW5fdGFnKHN0cnVjdCBwYWdlICpwYWdlLCBpbnQgY291bnQpCit7CisJaW50IGk7CisK
Kwlmb3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykKKwkJcGFnZV9rYXNhbl90YWdfcmVzZXQocGFn
ZSArIGkpOworfQorCiAvKioKICAqIGNtYV9hbGxvYygpIC0gYWxsb2NhdGUgcGFnZXMgZnJvbSBj
b250aWd1b3VzIGFyZWEKICAqIEBjbWE6ICAgQ29udGlndW91cyBtZW1vcnkgcmVnaW9uIGZvciB3
aGljaCB0aGUgYWxsb2NhdGlvbiBpcyBwZXJmb3JtZWQuCkBAIC00MTQsNyArNDIzLDYgQEAgc3Ry
dWN0IHBhZ2UgKmNtYV9hbGxvYyhzdHJ1Y3QgY21hICpjbWEsIHNpemVfdCBjb3VudCwgdW5zaWdu
ZWQgaW50IGFsaWduLAogCXVuc2lnbmVkIGxvbmcgcGZuID0gLTE7CiAJdW5zaWduZWQgbG9uZyBz
dGFydCA9IDA7CiAJdW5zaWduZWQgbG9uZyBiaXRtYXBfbWF4bm8sIGJpdG1hcF9ubywgYml0bWFw
X2NvdW50OwotCXNpemVfdCBpOwogCXN0cnVjdCBwYWdlICpwYWdlID0gTlVMTDsKIAlpbnQgcmV0
ID0gLUVOT01FTTsKIApAQCAtNDc4LDEwICs0ODYsOCBAQCBzdHJ1Y3QgcGFnZSAqY21hX2FsbG9j
KHN0cnVjdCBjbWEgKmNtYSwgc2l6ZV90IGNvdW50LCB1bnNpZ25lZCBpbnQgYWxpZ24sCiAJICog
YmxvY2tzIGJlaW5nIG1hcmtlZCB3aXRoIGRpZmZlcmVudCB0YWdzLiBSZXNldCB0aGUgdGFncyB0
byBpZ25vcmUKIAkgKiB0aG9zZSBwYWdlIGJsb2Nrcy4KIAkgKi8KLQlpZiAocGFnZSkgewotCQlm
b3IgKGkgPSAwOyBpIDwgY291bnQ7IGkrKykKLQkJCXBhZ2Vfa2FzYW5fdGFnX3Jlc2V0KHBhZ2Ug
KyBpKTsKLQl9CisJaWYgKHBhZ2UpCisJCXJlc2V0X3BhZ2Vfa2FzYW5fdGFnKHBhZ2UsIGNvdW50
KTsKIAogCWlmIChyZXQgJiYgIW5vX3dhcm4pIHsKIAkJcHJfZXJyKCIlczogYWxsb2MgZmFpbGVk
LCByZXEtc2l6ZTogJXp1IHBhZ2VzLCByZXQ6ICVkXG4iLApAQCAtNDkzLDYgKzQ5OSwxMTYgQEAg
c3RydWN0IHBhZ2UgKmNtYV9hbGxvYyhzdHJ1Y3QgY21hICpjbWEsIHNpemVfdCBjb3VudCwgdW5z
aWduZWQgaW50IGFsaWduLAogCXJldHVybiBwYWdlOwogfQogCisvKgorICogY21hX2FsbG9jX2J1
bGsoKSAtIGFsbG9jYXRlIGhpZ2ggb3JkZXIgYnVsayBwYWdlcyBmcm9tIGNvbnRpZ3VvdXMgYXJl
YSB3aXRoCisgKiAJCWJlc3QgZWZmb3J0LiBJdCB3aWxsIHVzdWFsbHkgYmUgdXNlZCBmb3IgcHJp
dmF0ZSBAY21hCisgKgorICogQGNtYToJY29udGlndW91cyBtZW1vcnkgcmVnaW9uIGZvciB3aGlj
aCB0aGUgYWxsb2NhdGlvbiBpcyBwZXJmb3JtZWQuCisgKiBAYWxpZ246CXJlcXVlc3RlZCBhbGln
bm1lbnQgb2YgcGFnZXMgKGluIFBBR0VfU0laRSBvcmRlcikuCisgKiBAZ2ZwX21hc2s6CW1lbW9y
eSBhbGxvY2F0aW9uIGZsYWdzCisgKiBAb3JkZXI6CXJlcXVlc3RlZCBwYWdlIG9yZGVyCisgKiBA
bnJfcmVxdWVzdHM6IHRoZSBudW1iZXIgb2YgMl5vcmRlciBwYWdlcyByZXF1ZXN0ZWQgdG8gYmUg
YWxsb2NhdGVkIGFzIGlucHV0LAorICogQHBhZ2VfYXJyYXk6CXBhZ2VfYXJyYXkgcG9pbnRlciB0
byBzdG9yZSBhbGxvY2F0ZWQgcGFnZXMgKG11c3QgaGF2ZSBzcGFjZQorICoJCWZvciBhdCBsZWFz
dCBucl9yZXF1ZXN0cykKKyAqIEBucl9hbGxvY2F0ZWQ6IHRoZSBudW1iZXIgb2YgMl5vcmRlciBw
YWdlcyBhbGxvY2F0ZWQgYXMgb3V0cHV0CisgKgorICogVGhpcyBmdW5jdGlvbiB0cmllcyB0byBh
bGxvY2F0ZSB1cCB0byBAbnJfcmVxdWVzdHMgQG9yZGVyIHBhZ2VzIG9uIHNwZWNpZmljCisgKiBj
b250aWd1b3VzIG1lbW9yeSBhcmVhLiBJZiBAZ2ZwX21hc2sgaGFzIF9fR0ZQX05PUkVUUlksIGl0
IHdpbGwgYXZvaWQgY29zdGx5CisgKiBmdW5jdGlvbnMgdG8gaW5jcmVhc2UgYWxsb2NhdGlvbiBz
dWNjZXNzIHJhdGlvIHNvIGl0IHdpbGwgYmUgZmFzdCBidXQgbWlnaHQKKyAqIHJldHVybiBsZXNz
IHRoYW4gcmVxdWVzdGVkIG51bWJlciBvZiBwYWdlcy4gVXNlciBjb3VsZCByZXRyeSB3aXRoCisg
KiAhX19HRlBfTk9SRVRSWSBpZiBpdCBpcyBuZWVkZWQuCisgKgorICogUmV0dXJuOiBpdCB3aWxs
IHJldHVybiAwIG9ubHkgaWYgYWxsIHBhZ2VzIHJlcXVlc3RlZCBieSBAbnJfcmVxdWVzdHNlZCBh
cmUKKyAqIGFsbG9jYXRlZC4gT3RoZXJ3aXNlLCBpdCByZXR1cm5zIG5lZ2F0aXZlIGVycm9yIGNv
ZGUuCisgKgorICogTm90ZTogUmVnYXJkbGVzcyBvZiBzdWNjZXNzL2ZhaWx1cmUsIHVzZXIgc2hv
dWxkIGNoZWNrIEBucl9hbGxvY2F0ZWQgdG8gc2VlCisgKiBob3cgbWFueSBAb3JkZXIgcGFnZXMg
YXJlIGFsbG9jYXRlZCBhbmQgZnJlZSB0aG9zZSBwYWdlcyB3aGVuIHRoZXkgYXJlIG5vdAorICog
bmVlZGVkLgorICovCitpbnQgY21hX2FsbG9jX2J1bGsoc3RydWN0IGNtYSAqY21hLCB1bnNpZ25l
ZCBpbnQgYWxpZ24sIGdmcF90IGdmcF9tYXNrLAorCQkJdW5zaWduZWQgaW50IG9yZGVyLCBzaXpl
X3QgbnJfcmVxdWVzdHMsCisJCQlzdHJ1Y3QgcGFnZSAqKnBhZ2VfYXJyYXksIHNpemVfdCAqbnJf
YWxsb2NhdGVkKQoreworCWludCByZXQgPSAwOworCXNpemVfdCBpID0gMDsKKwl1bnNpZ25lZCBs
b25nIG5yX3BhZ2VzX25lZWRlZCA9IG5yX3JlcXVlc3RzICogKDEgPDwgb3JkZXIpOworCXVuc2ln
bmVkIGxvbmcgbnJfY2h1bmtfcGFnZXMsIG5yX3BhZ2VzOworCXVuc2lnbmVkIGxvbmcgbWFzaywg
b2Zmc2V0OworCXVuc2lnbmVkIGxvbmcgcGZuID0gLTE7CisJdW5zaWduZWQgbG9uZyBzdGFydCA9
IDA7CisJdW5zaWduZWQgbG9uZyBiaXRtYXBfbWF4bm8sIGJpdG1hcF9ubywgYml0bWFwX2NvdW50
OworCXN0cnVjdCBwYWdlICpwYWdlID0gTlVMTDsKKwlnZnBfdCBnZnAgPSBHRlBfS0VSTkVMfF9f
R0ZQX05PV0FSTnxnZnBfbWFzazsKKworCSpucl9hbGxvY2F0ZWQgPSAwOworCWlmICghY21hIHx8
ICFjbWEtPmNvdW50IHx8ICFjbWEtPmJpdG1hcCB8fCAhcGFnZV9hcnJheSkKKwkJcmV0dXJuIC1F
SU5WQUw7CisKKwlpZiAoIW5yX3BhZ2VzX25lZWRlZCkKKwkJcmV0dXJuIDA7CisKKwlucl9jaHVu
a19wYWdlcyA9IDEgPDwgbWF4X3QodW5zaWduZWQgaW50LCBvcmRlciwgcGFnZWJsb2NrX29yZGVy
KTsKKworCW1hc2sgPSBjbWFfYml0bWFwX2FsaWduZWRfbWFzayhjbWEsIGFsaWduKTsKKwlvZmZz
ZXQgPSBjbWFfYml0bWFwX2FsaWduZWRfb2Zmc2V0KGNtYSwgYWxpZ24pOworCWJpdG1hcF9tYXhu
byA9IGNtYV9iaXRtYXBfbWF4bm8oY21hKTsKKworCWxydV9hZGRfZHJhaW5fYWxsKCk7CisJZHJh
aW5fYWxsX3BhZ2VzKE5VTEwpOworCisJd2hpbGUgKG5yX3BhZ2VzX25lZWRlZCkgeworCQlucl9w
YWdlcyA9IG1pbihucl9jaHVua19wYWdlcywgbnJfcGFnZXNfbmVlZGVkKTsKKworCQliaXRtYXBf
Y291bnQgPSBjbWFfYml0bWFwX3BhZ2VzX3RvX2JpdHMoY21hLCBucl9wYWdlcyk7CisJCW11dGV4
X2xvY2soJmNtYS0+bG9jayk7CisJCWJpdG1hcF9ubyA9IGJpdG1hcF9maW5kX25leHRfemVyb19h
cmVhX29mZihjbWEtPmJpdG1hcCwKKwkJCQliaXRtYXBfbWF4bm8sIHN0YXJ0LCBiaXRtYXBfY291
bnQsIG1hc2ssCisJCQkJb2Zmc2V0KTsKKwkJaWYgKGJpdG1hcF9ubyA+PSBiaXRtYXBfbWF4bm8p
IHsKKwkJCW11dGV4X3VubG9jaygmY21hLT5sb2NrKTsKKwkJCWJyZWFrOworCQl9CisJCWJpdG1h
cF9zZXQoY21hLT5iaXRtYXAsIGJpdG1hcF9ubywgYml0bWFwX2NvdW50KTsKKwkJLyoKKwkJICog
SXQncyBzYWZlIHRvIGRyb3AgdGhlIGxvY2sgaGVyZS4gSWYgdGhlIG1pZ3JhdGlvbiBmYWlscwor
CQkgKiBjbWFfY2xlYXJfYml0bWFwIHdpbGwgdGFrZSB0aGUgbG9jayBhZ2FpbiBhbmQgdW5tYXJr
IGl0LgorCQkgKi8KKwkJbXV0ZXhfdW5sb2NrKCZjbWEtPmxvY2spOworCisJCXBmbiA9IGNtYS0+
YmFzZV9wZm4gKyAoYml0bWFwX25vIDw8IGNtYS0+b3JkZXJfcGVyX2JpdCk7CisJCXJldCA9IGFs
bG9jX2NvbnRpZ19yYW5nZShwZm4sIHBmbiArIG5yX3BhZ2VzLCBNSUdSQVRFX0NNQSwgZ2ZwKTsK
KwkJaWYgKHJldCkgeworCQkJY21hX2NsZWFyX2JpdG1hcChjbWEsIHBmbiwgbnJfcGFnZXMpOwor
CQkJaWYgKHJldCAhPSAtRUJVU1kpCisJCQkJYnJlYWs7CisKKwkJCS8qIGNvbnRpbnVlIHRvIHNl
YXJjaCBuZXh0IGJsb2NrICovCisJCQlzdGFydCA9IChwZm4gKyBucl9wYWdlcyAtIGNtYS0+YmFz
ZV9wZm4pID4+CisJCQkJCQljbWEtPm9yZGVyX3Blcl9iaXQ7CisJCQljb250aW51ZTsKKwkJfQor
CisJCXBhZ2UgPSBwZm5fdG9fcGFnZShwZm4pOworCQl3aGlsZSAobnJfcGFnZXMpIHsKKwkJCXBh
Z2VfYXJyYXlbaSsrXSA9IHBhZ2U7CisJCQlyZXNldF9wYWdlX2thc2FuX3RhZyhwYWdlLCAxIDw8
IG9yZGVyKTsKKwkJCXBhZ2UgKz0gMSA8PCBvcmRlcjsKKwkJCW5yX3BhZ2VzIC09IDEgPDwgb3Jk
ZXI7CisJCQlucl9wYWdlc19uZWVkZWQgLT0gMSA8PCBvcmRlcjsKKwkJfQorCisJCXN0YXJ0ID0g
Yml0bWFwX25vICsgYml0bWFwX2NvdW50OworCX0KKworCSpucl9hbGxvY2F0ZWQgPSBpOworCisJ
aWYgKCFyZXQgJiYgbnJfcGFnZXNfbmVlZGVkKQorCQlyZXQgPSAtRUJVU1k7CisKKwlyZXR1cm4g
cmV0OworfQorRVhQT1JUX1NZTUJPTF9HUEwoY21hX2FsbG9jX2J1bGspOworCiAvKioKICAqIGNt
YV9yZWxlYXNlKCkgLSByZWxlYXNlIGFsbG9jYXRlZCBwYWdlcwogICogQGNtYTogICBDb250aWd1
b3VzIG1lbW9yeSByZWdpb24gZm9yIHdoaWNoIHRoZSBhbGxvY2F0aW9uIGlzIHBlcmZvcm1lZC4K
ZGlmZiAtLWdpdCBhL21tL3BhZ2VfYWxsb2MuYyBiL21tL3BhZ2VfYWxsb2MuYwppbmRleCBmODRi
N2VlYTM5ZWMuLjA5N2NjODMwOTdiYiAxMDA2NDQKLS0tIGEvbW0vcGFnZV9hbGxvYy5jCisrKyBi
L21tL3BhZ2VfYWxsb2MuYwpAQCAtODQwNCw3ICs4NDA0LDggQEAgc3RhdGljIHVuc2lnbmVkIGxv
bmcgcGZuX21heF9hbGlnbl91cCh1bnNpZ25lZCBsb25nIHBmbikKIAogLyogW3N0YXJ0LCBlbmQp
IG11c3QgYmVsb25nIHRvIGEgc2luZ2xlIHpvbmUuICovCiBzdGF0aWMgaW50IF9fYWxsb2NfY29u
dGlnX21pZ3JhdGVfcmFuZ2Uoc3RydWN0IGNvbXBhY3RfY29udHJvbCAqY2MsCi0JCQkJCXVuc2ln
bmVkIGxvbmcgc3RhcnQsIHVuc2lnbmVkIGxvbmcgZW5kKQorCQkJCQl1bnNpZ25lZCBsb25nIHN0
YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCwKKwkJCQkJdW5zaWduZWQgaW50IG1heF90cmllcykKIHsK
IAkvKiBUaGlzIGZ1bmN0aW9uIGlzIGJhc2VkIG9uIGNvbXBhY3Rfem9uZSgpIGZyb20gY29tcGFj
dGlvbi5jLiAqLwogCXVuc2lnbmVkIGludCBucl9yZWNsYWltZWQ7CkBAIC04NDMyLDcgKzg0MzMs
NyBAQCBzdGF0aWMgaW50IF9fYWxsb2NfY29udGlnX21pZ3JhdGVfcmFuZ2Uoc3RydWN0IGNvbXBh
Y3RfY29udHJvbCAqY2MsCiAJCQkJYnJlYWs7CiAJCQl9CiAJCQl0cmllcyA9IDA7Ci0JCX0gZWxz
ZSBpZiAoKyt0cmllcyA9PSA1KSB7CisJCX0gZWxzZSBpZiAoKyt0cmllcyA9PSBtYXhfdHJpZXMp
IHsKIAkJCXJldCA9IHJldCA8IDAgPyByZXQgOiAtRUJVU1k7CiAJCQlicmVhazsKIAkJfQpAQCAt
ODQ3OCw2ICs4NDc5LDcgQEAgaW50IGFsbG9jX2NvbnRpZ19yYW5nZSh1bnNpZ25lZCBsb25nIHN0
YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCwKIAl1bnNpZ25lZCBsb25nIG91dGVyX3N0YXJ0LCBvdXRl
cl9lbmQ7CiAJdW5zaWduZWQgaW50IG9yZGVyOwogCWludCByZXQgPSAwOworCWJvb2wgbm9fcmV0
cnkgPSBnZnBfbWFzayAmIF9fR0ZQX05PUkVUUlk7CiAKIAlzdHJ1Y3QgY29tcGFjdF9jb250cm9s
IGNjID0gewogCQkubnJfbWlncmF0ZXBhZ2VzID0gMCwKQEAgLTg1MTYsNyArODUxOCw4IEBAIGlu
dCBhbGxvY19jb250aWdfcmFuZ2UodW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBl
bmQsCiAJICovCiAKIAlyZXQgPSBzdGFydF9pc29sYXRlX3BhZ2VfcmFuZ2UocGZuX21heF9hbGln
bl9kb3duKHN0YXJ0KSwKLQkJCQkgICAgICAgcGZuX21heF9hbGlnbl91cChlbmQpLCBtaWdyYXRl
dHlwZSwgMCk7CisJCQkJICAgICAgIHBmbl9tYXhfYWxpZ25fdXAoZW5kKSwgbWlncmF0ZXR5cGUs
CisJCQkJICAgICAgIG5vX3JldHJ5ID8gIFNLSVBfUENQX0RSQUlOIDogMCk7CiAJaWYgKHJldCkK
IAkJcmV0dXJuIHJldDsKIApAQCAtODUzMCw3ICs4NTMzLDcgQEAgaW50IGFsbG9jX2NvbnRpZ19y
YW5nZSh1bnNpZ25lZCBsb25nIHN0YXJ0LCB1bnNpZ25lZCBsb25nIGVuZCwKIAkgKiBhbGxvY2F0
ZWQuICBTbywgaWYgd2UgZmFsbCB0aHJvdWdoIGJlIHN1cmUgdG8gY2xlYXIgcmV0IHNvIHRoYXQK
IAkgKiAtRUJVU1kgaXMgbm90IGFjY2lkZW50YWxseSB1c2VkIG9yIHJldHVybmVkIHRvIGNhbGxl
ci4KIAkgKi8KLQlyZXQgPSBfX2FsbG9jX2NvbnRpZ19taWdyYXRlX3JhbmdlKCZjYywgc3RhcnQs
IGVuZCk7CisJcmV0ID0gX19hbGxvY19jb250aWdfbWlncmF0ZV9yYW5nZSgmY2MsIHN0YXJ0LCBl
bmQsIG5vX3JldHJ5ID8gMSA6IDUpOwogCWlmIChyZXQgJiYgcmV0ICE9IC1FQlVTWSkKIAkJZ290
byBkb25lOwogCXJldCA9MDsKQEAgLTg1NTIsNyArODU1NSw4IEBAIGludCBhbGxvY19jb250aWdf
cmFuZ2UodW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQgbG9uZyBlbmQsCiAJICogaXNvbGF0
ZWQgdGh1cyB0aGV5IHdvbid0IGdldCByZW1vdmVkIGZyb20gYnVkZHkuCiAJICovCiAKLQlscnVf
YWRkX2RyYWluX2FsbCgpOworCWlmICghbm9fcmV0cnkpCisJCWxydV9hZGRfZHJhaW5fYWxsKCk7
CiAKIAlvcmRlciA9IDA7CiAJb3V0ZXJfc3RhcnQgPSBzdGFydDsKQEAgLTg1NzksOCArODU4Myw5
IEBAIGludCBhbGxvY19jb250aWdfcmFuZ2UodW5zaWduZWQgbG9uZyBzdGFydCwgdW5zaWduZWQg
bG9uZyBlbmQsCiAKIAkvKiBNYWtlIHN1cmUgdGhlIHJhbmdlIGlzIHJlYWxseSBpc29sYXRlZC4g
Ki8KIAlpZiAodGVzdF9wYWdlc19pc29sYXRlZChvdXRlcl9zdGFydCwgZW5kLCAwKSkgewotCQlw
cl9pbmZvX3JhdGVsaW1pdGVkKCIlczogWyVseCwgJWx4KSBQRk5zIGJ1c3lcbiIsCi0JCQlfX2Z1
bmNfXywgb3V0ZXJfc3RhcnQsIGVuZCk7CisJCWlmICghbm9fcmV0cnkpCisJCQlwcl9pbmZvX3Jh
dGVsaW1pdGVkKCIlczogWyVseCwgJWx4KSBQRk5zIGJ1c3lcbiIsCisJCQkJX19mdW5jX18sIG91
dGVyX3N0YXJ0LCBlbmQpOwogCQlyZXQgPSAtRUJVU1k7CiAJCWdvdG8gZG9uZTsKIAl9CmRpZmYg
LS1naXQgYS9tbS9wYWdlX2lzb2xhdGlvbi5jIGIvbW0vcGFnZV9pc29sYXRpb24uYwppbmRleCBh
YmJmNDIyMTQ0ODUuLjMxYjFkY2MxYTM5NSAxMDA2NDQKLS0tIGEvbW0vcGFnZV9pc29sYXRpb24u
YworKysgYi9tbS9wYWdlX2lzb2xhdGlvbi5jCkBAIC00OSw3ICs0OSw4IEBAIHN0YXRpYyBpbnQg
c2V0X21pZ3JhdGV0eXBlX2lzb2xhdGUoc3RydWN0IHBhZ2UgKnBhZ2UsIGludCBtaWdyYXRldHlw
ZSwgaW50IGlzb2xfCiAKIAkJX19tb2Rfem9uZV9mcmVlcGFnZV9zdGF0ZSh6b25lLCAtbnJfcGFn
ZXMsIG10KTsKIAkJc3Bpbl91bmxvY2tfaXJxcmVzdG9yZSgmem9uZS0+bG9jaywgZmxhZ3MpOwot
CQlkcmFpbl9hbGxfcGFnZXMoem9uZSk7CisJCWlmICghKGlzb2xfZmxhZ3MgJiBTS0lQX1BDUF9E
UkFJTikpCisJCQlkcmFpbl9hbGxfcGFnZXMoem9uZSk7CiAJCXJldHVybiAwOwogCX0KIAotLSAK
Mi4yOS4yLjI5OS5nZGMxMTIxODIzYy1nb29nCgpfX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fXwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdApMaW5hcm8tbW0t
c2lnQGxpc3RzLmxpbmFyby5vcmcKaHR0cHM6Ly9saXN0cy5saW5hcm8ub3JnL21haWxtYW4vbGlz
dGluZm8vbGluYXJvLW1tLXNpZwo=
