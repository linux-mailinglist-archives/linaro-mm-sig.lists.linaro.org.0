Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id BB0991FF8ED
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 18 Jun 2020 18:13:43 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E4AC160688
	for <lists+linaro-mm-sig@lfdr.de>; Thu, 18 Jun 2020 16:13:42 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id D767566583; Thu, 18 Jun 2020 16:13:42 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.9 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_BLOCKED,RCVD_IN_MSPIKE_H3,RCVD_IN_MSPIKE_WL,
	SPF_HELO_PASS autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 6D1AD666FA;
	Thu, 18 Jun 2020 15:43:54 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id A6AA86659C
 for <linaro-mm-sig@lists.linaro.org>; Thu, 18 Jun 2020 15:41:54 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 97A89665FF; Thu, 18 Jun 2020 15:41:54 +0000 (UTC)
Received: from mailout2.w1.samsung.com (mailout2.w1.samsung.com
 [210.118.77.12])
 by lists.linaro.org (Postfix) with ESMTPS id 32FA66659C
 for <linaro-mm-sig@lists.linaro.org>; Thu, 18 Jun 2020 15:40:40 +0000 (UTC)
Received: from eucas1p1.samsung.com (unknown [182.198.249.206])
 by mailout2.w1.samsung.com (KnoxPortal) with ESMTP id
 20200618154039euoutp02542f269d844db60e4894f22ba8c9fe2b~ZrZ554WnK1486314863euoutp02N
 for <linaro-mm-sig@lists.linaro.org>; Thu, 18 Jun 2020 15:40:39 +0000 (GMT)
DKIM-Filter: OpenDKIM Filter v2.11.0 mailout2.w1.samsung.com
 20200618154039euoutp02542f269d844db60e4894f22ba8c9fe2b~ZrZ554WnK1486314863euoutp02N
Received: from eusmges3new.samsung.com (unknown [203.254.199.245]) by
 eucas1p2.samsung.com (KnoxPortal) with ESMTP id
 20200618154039eucas1p27f22f2881645b0769b94b16a5159f94d~ZrZ5oBFp40608806088eucas1p20;
 Thu, 18 Jun 2020 15:40:39 +0000 (GMT)
Received: from eucas1p1.samsung.com ( [182.198.249.206]) by
 eusmges3new.samsung.com (EUCPMTA) with SMTP id 61.70.60698.6FA8BEE5; Thu, 18
 Jun 2020 16:40:38 +0100 (BST)
Received: from eusmtrp1.samsung.com (unknown [182.198.249.138]) by
 eucas1p1.samsung.com (KnoxPortal) with ESMTPA id
 20200618154038eucas1p1acd4fcdd183de4c19c4004778527a755~ZrZ5UdJYA1545815458eucas1p1o;
 Thu, 18 Jun 2020 15:40:38 +0000 (GMT)
Received: from eusmgms2.samsung.com (unknown [182.198.249.180]) by
 eusmtrp1.samsung.com (KnoxPortal) with ESMTP id
 20200618154038eusmtrp12e800f642df656361881d213119aff1b~ZrZ5Ty4wZ2230622306eusmtrp1W;
 Thu, 18 Jun 2020 15:40:38 +0000 (GMT)
X-AuditID: cbfec7f5-a0fff7000001ed1a-54-5eeb8af69cde
Received: from eusmtip1.samsung.com ( [203.254.199.221]) by
 eusmgms2.samsung.com (EUCPMTA) with SMTP id 76.F9.07950.6FA8BEE5; Thu, 18
 Jun 2020 16:40:38 +0100 (BST)
Received: from AMDC2765.digital.local (unknown [106.120.51.73]) by
 eusmtip1.samsung.com (KnoxPortal) with ESMTPA id
 20200618154038eusmtip19632174da7f25d0e928d6533f76216c7~ZrZ4ojlkT0833608336eusmtip1V;
 Thu, 18 Jun 2020 15:40:38 +0000 (GMT)
From: Marek Szyprowski <m.szyprowski@samsung.com>
To: dri-devel@lists.freedesktop.org, iommu@lists.linux-foundation.org,
 linaro-mm-sig@lists.linaro.org, linux-kernel@vger.kernel.org
Date: Thu, 18 Jun 2020 17:39:56 +0200
Message-Id: <20200618153956.29558-36-m.szyprowski@samsung.com>
X-Mailer: git-send-email 2.17.1
In-Reply-To: <20200618153956.29558-1-m.szyprowski@samsung.com>
X-Brightmail-Tracker: H4sIAAAAAAAAA0VSfSxVYRzuPeeec8+9uXW6bN6htLtVqy0y2s7GRMXO1h+ppbU+cOPsMp/d
 g6g/ssR0XUYUSTGZb7ldopFEcUXdiBpJiLXrW7vubczIcaj/nt/z/J49z+/dS6DSLsyGCImI
 ZpQR8jAZLhbUdyzpD5tV035HFtvdqDT9e4R6nluDUWv1mSjVb5rHqfLKdoTqfTgsoApbXKnF
 /jGE0o5/xai+xnycUmteYFT1u2EhVaJdQajs2SUh1bowgXnspKueVAG62VwooLUVd3G6wTyK
 0SOpOoSuLb5FD62Oo3TWQCmgmwYTcHp8eRKn0+sqAG3U7qG7TEahj+Si2C2ICQuJZZSO7gHi
 4Lo7TVjU4zNxmYNvsQRQc0IFRAQkXWBxeg+iAmJCSpYBWNo/gfPDIoDjw29QfjACaNIX4FuW
 0aFZAS+UAvjDYEA4YcNyf8aDwzjpBFWzqg2DFZkEYGeaBYdRsgaFRVUkhy3JU/CVqVfIYQG5
 D36YasU4LCHdYbN5ZjPMHlZquBYiQrTOd+uSMC4Ykj+FUFOWg/JLJ2FnKm+GpCWc0tUJeWwH
 u7PUAt6QCOCYvlrID2oA+27nAn7LFX7XL6/HEev1DsKaRkee9oSGri8oR0NyBxyY3cUfsAPe
 q8/ZpCUwJVnKb++Hebpn/2Jbez5vVqPh4iezkH+sTADzH7ShGcA+739YIQAVwJqJYcMVDOsc
 wVx3YOXhbEyEwiEwMlwL1n9Y96rO9BK8XrnaBkgCyCwkhnPTflJMHsvGh7cBSKAyK8nxj91+
 UkmQPP4Go4z0V8aEMWwbsCUEMmuJc9HkFSmpkEczoQwTxSi3VIQQ2SQAu8Cg6NSGuaXta1bO
 GeLzjnp1cHCKZvqaxne+ExObygfYuJLQZH3OseUDigxRbs82URwYS3Qe7Ajx81ww7vVHjK4t
 BbWI+GbcJR8W9QLFj5xqn9p7H+2w/TZy+QJ6einAxScxg7I/W9ArBnO/e3u8s2ki0Xd385+W
 X/Neah+ZgA2WOx1Claz8LxjfRMVdAwAA
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFlrLIsWRmVeSWpSXmKPExsVy+t/xu7rful7HGZzepmvRe+4kk8XGGetZ
 Lf5vm8hsceXrezaLlauPMllcnHmXxWLBfmuLL1ceMllsenyN1eLyrjlsFj0btrJarD1yl91i
 2aY/TBZT3v5ktzj44QmrA7/HmnlrGD32flvA4rFpVSebx/ZvD1g97ncfZ/LYvKTe4/a/x8we
 k28sZ/TYfbOBzePxr5dsHn1bVjF6fN4k53Hq62f2AN4oPZui/NKSVIWM/OISW6VoQwsjPUNL
 Cz0jE0s9Q2PzWCsjUyV9O5uU1JzMstQifbsEvYwtLbtZC+YGVky8eZi1gXG9cxcjJ4eEgInE
 g9tvWboYuTiEBJYySmy79JwFIiEjcXJaAyuELSzx51oXG0TRJ6Cin8/ZQRJsAoYSXW8hEiIC
 nYwS07o/soM4zAI7mSX2337KCFIlLOAtsefrRbAOFgFViTOvDoKN5RWwk9j77Q0bxAp5idUb
 DjCD2JxA8dPHW8FqhARsJZ5/aGObwMi3gJFhFaNIamlxbnpusZFecWJucWleul5yfu4mRmBU
 bTv2c8sOxq53wYcYBTgYlXh4X4S8jhNiTSwrrsw9xCjBwawkwut09nScEG9KYmVValF+fFFp
 TmrxIUZToKMmMkuJJucDIz6vJN7Q1NDcwtLQ3Njc2MxCSZy3Q+BgjJBAemJJanZqakFqEUwf
 EwenVAPjjl8WdSqe5595zjmo+Enw/Pe537TWvbJ7HvXl0bednWmh3OHLm9tSMyKe+WyW36Gm
 Y9gXZ/rh7gxNBpEtEwzllrMeW3dCakl9z/VSZZX8aYzhqmf9NphnHOq8dcfyRHOJq5Xxn5fK
 3/5ve6HgdUj62e6UH8/VQsUWuDXbLnF7/TLiwYq/YlcUlFiKMxINtZiLihMB19SdncACAAA=
X-CMS-MailID: 20200618154038eucas1p1acd4fcdd183de4c19c4004778527a755
X-Msg-Generator: CA
X-RootMTR: 20200618154038eucas1p1acd4fcdd183de4c19c4004778527a755
X-EPHeader: CA
CMS-TYPE: 201P
X-CMS-RootMailID: 20200618154038eucas1p1acd4fcdd183de4c19c4004778527a755
References: <20200618153956.29558-1-m.szyprowski@samsung.com>
 <CGME20200618154038eucas1p1acd4fcdd183de4c19c4004778527a755@eucas1p1.samsung.com>
X-Virus-Scanned: ClamAV using ClamSMTP
Cc: Pawel Osciak <pawel@osciak.com>,
 Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>,
 David Airlie <airlied@linux.ie>, linux-media@vger.kernel.org,
 Daniel Vetter <daniel@ffwll.ch>, Hans Verkuil <hverkuil-cisco@xs4all.nl>,
 Mauro Carvalho Chehab <mchehab@kernel.org>,
 Robin Murphy <robin.murphy@arm.com>, Christoph Hellwig <hch@lst.de>,
 linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH v6 35/36] videobuf2: use sgtable-based
	scatterlist wrappers
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

VXNlIHJlY2VudGx5IGludHJvZHVjZWQgY29tbW9uIHdyYXBwZXJzIG9wZXJhdGluZyBkaXJlY3Rs
eSBvbiB0aGUgc3RydWN0CnNnX3RhYmxlIG9iamVjdHMgYW5kIHNjYXR0ZXJsaXN0IHBhZ2UgaXRl
cmF0b3JzIHRvIG1ha2UgdGhlIGNvZGUgYSBiaXQKbW9yZSBjb21wYWN0LCByb2J1c3QsIGVhc2ll
ciB0byBmb2xsb3cgYW5kIGNvcHkvcGFzdGUgc2FmZS4KCk5vIGZ1bmN0aW9uYWwgY2hhbmdlLCBi
ZWNhdXNlIHRoZSBjb2RlIGFscmVhZHkgcHJvcGVybHkgZGlkIGFsbCB0aGUKc2NhdGVybGlzdCBy
ZWxhdGVkIGNhbGxzLgoKU2lnbmVkLW9mZi1ieTogTWFyZWsgU3p5cHJvd3NraSA8bS5zenlwcm93
c2tpQHNhbXN1bmcuY29tPgotLS0KIC4uLi9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEt
Y29udGlnLmMgICB8IDQxICsrKysrKysrLS0tLS0tLS0tLS0KIC4uLi9tZWRpYS9jb21tb24vdmlk
ZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYyB8IDMyICsrKysrKy0tLS0tLS0tLQogLi4uL2NvbW1v
bi92aWRlb2J1ZjIvdmlkZW9idWYyLXZtYWxsb2MuYyAgICAgIHwgMTIgKystLS0tCiAzIGZpbGVz
IGNoYW5nZWQsIDM0IGluc2VydGlvbnMoKyksIDUxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jIGIv
ZHJpdmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtY29udGlnLmMKaW5k
ZXggZjRiNGE3YzEzNWViLi5iYTAxYTg2OTJkODggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEv
Y29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCisrKyBiL2RyaXZlcnMvbWVk
aWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItZG1hLWNvbnRpZy5jCkBAIC00OCwxNiArNDgs
MTUgQEAgc3RydWN0IHZiMl9kY19idWYgewogCiBzdGF0aWMgdW5zaWduZWQgbG9uZyB2YjJfZGNf
Z2V0X2NvbnRpZ3VvdXNfc2l6ZShzdHJ1Y3Qgc2dfdGFibGUgKnNndCkKIHsKLQlzdHJ1Y3Qgc2Nh
dHRlcmxpc3QgKnM7CiAJZG1hX2FkZHJfdCBleHBlY3RlZCA9IHNnX2RtYV9hZGRyZXNzKHNndC0+
c2dsKTsKLQl1bnNpZ25lZCBpbnQgaTsKKwlzdHJ1Y3Qgc2dfZG1hX3BhZ2VfaXRlciBkbWFfaXRl
cjsKIAl1bnNpZ25lZCBsb25nIHNpemUgPSAwOwogCi0JZm9yX2VhY2hfc2coc2d0LT5zZ2wsIHMs
IHNndC0+bmVudHMsIGkpIHsKLQkJaWYgKHNnX2RtYV9hZGRyZXNzKHMpICE9IGV4cGVjdGVkKQor
CWZvcl9lYWNoX3NndGFibGVfZG1hX3BhZ2Uoc2d0LCAmZG1hX2l0ZXIsIDApIHsKKwkJaWYgKHNn
X3BhZ2VfaXRlcl9kbWFfYWRkcmVzcygmZG1hX2l0ZXIpICE9IGV4cGVjdGVkKQogCQkJYnJlYWs7
Ci0JCWV4cGVjdGVkID0gc2dfZG1hX2FkZHJlc3MocykgKyBzZ19kbWFfbGVuKHMpOwotCQlzaXpl
ICs9IHNnX2RtYV9sZW4ocyk7CisJCWV4cGVjdGVkICs9IFBBR0VfU0laRTsKKwkJc2l6ZSArPSBQ
QUdFX1NJWkU7CiAJfQogCXJldHVybiBzaXplOwogfQpAQCAtOTksOCArOTgsNyBAQCBzdGF0aWMg
dm9pZCB2YjJfZGNfcHJlcGFyZSh2b2lkICpidWZfcHJpdikKIAlpZiAoIXNndCB8fCBidWYtPmRi
X2F0dGFjaCkKIAkJcmV0dXJuOwogCi0JZG1hX3N5bmNfc2dfZm9yX2RldmljZShidWYtPmRldiwg
c2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCSAgICAgICBidWYtPmRtYV9kaXIpOworCWRt
YV9zeW5jX3NndGFibGVfZm9yX2RldmljZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwog
fQogCiBzdGF0aWMgdm9pZCB2YjJfZGNfZmluaXNoKHZvaWQgKmJ1Zl9wcml2KQpAQCAtMTEyLDcg
KzExMCw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kY19maW5pc2godm9pZCAqYnVmX3ByaXYpCiAJaWYg
KCFzZ3QgfHwgYnVmLT5kYl9hdHRhY2gpCiAJCXJldHVybjsKIAotCWRtYV9zeW5jX3NnX2Zvcl9j
cHUoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2Rpcik7CisJ
ZG1hX3N5bmNfc2d0YWJsZV9mb3JfY3B1KGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9
CiAKIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCkBAIC0y
NzMsOCArMjcxLDggQEAgc3RhdGljIHZvaWQgdmIyX2RjX2RtYWJ1Zl9vcHNfZGV0YWNoKHN0cnVj
dCBkbWFfYnVmICpkYnVmLAogCQkgKiBtZW1vcnkgbG9jYXRpb25zIGRvIG5vdCByZXF1aXJlIGFu
eSBleHBsaWNpdCBjYWNoZQogCQkgKiBtYWludGVuYW5jZSBwcmlvciBvciBhZnRlciBiZWluZyB1
c2VkIGJ5IHRoZSBkZXZpY2UuCiAJCSAqLwotCQlkbWFfdW5tYXBfc2dfYXR0cnMoZGJfYXR0YWNo
LT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgYXR0YWNoLT5kbWFfZGly
LCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNo
LT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLAorCQkJCSAgRE1BX0FUVFJfU0tJUF9DUFVfU1lO
Qyk7CiAJc2dfZnJlZV90YWJsZShzZ3QpOwogCWtmcmVlKGF0dGFjaCk7CiAJZGJfYXR0YWNoLT5w
cml2ID0gTlVMTDsKQEAgLTI5OSw4ICsyOTcsOCBAQCBzdGF0aWMgc3RydWN0IHNnX3RhYmxlICp2
YjJfZGNfZG1hYnVmX29wc19tYXAoCiAKIAkvKiByZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAq
LwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05PTkUpIHsKLQkJZG1hX3VubWFwX3NnX2F0
dHJzKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCSAgIGF0
dGFjaC0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJCWRtYV91bm1hcF9zZ3Rh
YmxlKGRiX2F0dGFjaC0+ZGV2LCBzZ3QsIGF0dGFjaC0+ZG1hX2RpciwKKwkJCQkgIERNQV9BVFRS
X1NLSVBfQ1BVX1NZTkMpOwogCQlhdHRhY2gtPmRtYV9kaXIgPSBETUFfTk9ORTsKIAl9CiAKQEAg
LTMwOCw5ICszMDYsOCBAQCBzdGF0aWMgc3RydWN0IHNnX3RhYmxlICp2YjJfZGNfZG1hYnVmX29w
c19tYXAoCiAJICogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGggbmV3IGRpcmVjdGlvbiwgbm8g
Y2FjaGUgc3luYwogCSAqIHJlcXVpcmVkIHNlZSBjb21tZW50IGluIHZiMl9kY19kbWFidWZfb3Bz
X2RldGFjaCgpCiAJICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoZGJfYXR0YWNo
LT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgICAgZG1hX2RpciwgRE1B
X0FUVFJfU0tJUF9DUFVfU1lOQyk7Ci0JaWYgKCFzZ3QtPm5lbnRzKSB7CisJaWYgKGRtYV9tYXBf
c2d0YWJsZShkYl9hdHRhY2gtPmRldiwgc2d0LCBkbWFfZGlyLAorCQkJICAgIERNQV9BVFRSX1NL
SVBfQ1BVX1NZTkMpKSB7CiAJCXByX2VycigiZmFpbGVkIHRvIG1hcCBzY2F0dGVybGlzdFxuIik7
CiAJCW11dGV4X3VubG9jayhsb2NrKTsKIAkJcmV0dXJuIEVSUl9QVFIoLUVJTyk7CkBAIC00MjMs
OCArNDIwLDggQEAgc3RhdGljIHZvaWQgdmIyX2RjX3B1dF91c2VycHRyKHZvaWQgKmJ1Zl9wcml2
KQogCQkgKiBObyBuZWVkIHRvIHN5bmMgdG8gQ1BVLCBpdCdzIGFscmVhZHkgc3luY2VkIHRvIHRo
ZSBDUFUKIAkJICogc2luY2UgdGhlIGZpbmlzaCgpIG1lbW9wIHdpbGwgaGF2ZSBiZWVuIGNhbGxl
ZCBiZWZvcmUgdGhpcy4KIAkJICovCi0JCWRtYV91bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0
LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NL
SVBfQ1BVX1NZTkMpOworCQlkbWFfdW5tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRt
YV9kaXIsCisJCQkJICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAkJcGFnZXMgPSBmcmFtZV92
ZWN0b3JfcGFnZXMoYnVmLT52ZWMpOwogCQkvKiBzZ3Qgc2hvdWxkIGV4aXN0IG9ubHkgaWYgdmVj
dG9yIGNvbnRhaW5zIHBhZ2VzLi4uICovCiAJCUJVR19PTihJU19FUlIocGFnZXMpKTsKQEAgLTUy
MSw5ICs1MTgsOCBAQCBzdGF0aWMgdm9pZCAqdmIyX2RjX2dldF91c2VycHRyKHN0cnVjdCBkZXZp
Y2UgKmRldiwgdW5zaWduZWQgbG9uZyB2YWRkciwKIAkgKiBObyBuZWVkIHRvIHN5bmMgdG8gdGhl
IGRldmljZSwgdGhpcyB3aWxsIGhhcHBlbiBsYXRlciB3aGVuIHRoZQogCSAqIHByZXBhcmUoKSBt
ZW1vcCBpcyBjYWxsZWQuCiAJICovCi0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVm
LT5kZXYsIHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsCi0JCQkJICAgICAgYnVmLT5kbWFfZGly
LCBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKLQlpZiAoc2d0LT5uZW50cyA8PSAwKSB7CisJaWYg
KGRtYV9tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIsCisJCQkgICAgRE1B
X0FUVFJfU0tJUF9DUFVfU1lOQykpIHsKIAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJs
aXN0XG4iKTsKIAkJcmV0ID0gLUVJTzsKIAkJZ290byBmYWlsX3NndF9pbml0OwpAQCAtNTQ1LDgg
KzU0MSw3IEBAIHN0YXRpYyB2b2lkICp2YjJfZGNfZ2V0X3VzZXJwdHIoc3RydWN0IGRldmljZSAq
ZGV2LCB1bnNpZ25lZCBsb25nIHZhZGRyLAogCXJldHVybiBidWY7CiAKIGZhaWxfbWFwX3NnOgot
CWRtYV91bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCSAgIGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CisJZG1hX3VubWFw
X3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKIAogZmFpbF9zZ3RfaW5pdDoKIAlzZ19mcmVlX3RhYmxlKHNndCk7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL21lZGlhL2NvbW1vbi92aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jIGIvZHJp
dmVycy9tZWRpYS9jb21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYwppbmRleCA5MjA3
MmEwOGFmMjUuLjZkZGY5NTNlZmExMSAxMDA2NDQKLS0tIGEvZHJpdmVycy9tZWRpYS9jb21tb24v
dmlkZW9idWYyL3ZpZGVvYnVmMi1kbWEtc2cuYworKysgYi9kcml2ZXJzL21lZGlhL2NvbW1vbi92
aWRlb2J1ZjIvdmlkZW9idWYyLWRtYS1zZy5jCkBAIC0xNDIsOSArMTQyLDggQEAgc3RhdGljIHZv
aWQgKnZiMl9kbWFfc2dfYWxsb2Moc3RydWN0IGRldmljZSAqZGV2LCB1bnNpZ25lZCBsb25nIGRt
YV9hdHRycywKIAkgKiBObyBuZWVkIHRvIHN5bmMgdG8gdGhlIGRldmljZSwgdGhpcyB3aWxsIGhh
cHBlbiBsYXRlciB3aGVuIHRoZQogCSAqIHByZXBhcmUoKSBtZW1vcCBpcyBjYWxsZWQuCiAJICov
Ci0Jc2d0LT5uZW50cyA9IGRtYV9tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNndC0+c2dsLCBzZ3Qt
Pm9yaWdfbmVudHMsCi0JCQkJICAgICAgYnVmLT5kbWFfZGlyLCBETUFfQVRUUl9TS0lQX0NQVV9T
WU5DKTsKLQlpZiAoIXNndC0+bmVudHMpCisJaWYgKGRtYV9tYXBfc2d0YWJsZShidWYtPmRldiwg
c2d0LCBidWYtPmRtYV9kaXIsCisJCQkgICAgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQykpIHsKIAkJ
Z290byBmYWlsX21hcDsKIAogCWJ1Zi0+aGFuZGxlci5yZWZjb3VudCA9ICZidWYtPnJlZmNvdW50
OwpAQCAtMTgwLDggKzE3OSw4IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfcHV0KHZvaWQgKmJ1
Zl9wcml2KQogCWlmIChyZWZjb3VudF9kZWNfYW5kX3Rlc3QoJmJ1Zi0+cmVmY291bnQpKSB7CiAJ
CWRwcmludGsoMSwgIiVzOiBGcmVlaW5nIGJ1ZmZlciBvZiAlZCBwYWdlc1xuIiwgX19mdW5jX18s
CiAJCQlidWYtPm51bV9wYWdlcyk7Ci0JCWRtYV91bm1hcF9zZ19hdHRycyhidWYtPmRldiwgc2d0
LT5zZ2wsIHNndC0+b3JpZ19uZW50cywKLQkJCQkgICBidWYtPmRtYV9kaXIsIERNQV9BVFRSX1NL
SVBfQ1BVX1NZTkMpOworCQlkbWFfdW5tYXBfc2d0YWJsZShidWYtPmRldiwgc2d0LCBidWYtPmRt
YV9kaXIsCisJCQkJICBETUFfQVRUUl9TS0lQX0NQVV9TWU5DKTsKIAkJaWYgKGJ1Zi0+dmFkZHIp
CiAJCQl2bV91bm1hcF9yYW0oYnVmLT52YWRkciwgYnVmLT5udW1fcGFnZXMpOwogCQlzZ19mcmVl
X3RhYmxlKGJ1Zi0+ZG1hX3NndCk7CkBAIC0yMDIsOCArMjAxLDcgQEAgc3RhdGljIHZvaWQgdmIy
X2RtYV9zZ19wcmVwYXJlKHZvaWQgKmJ1Zl9wcml2KQogCWlmIChidWYtPmRiX2F0dGFjaCkKIAkJ
cmV0dXJuOwogCi0JZG1hX3N5bmNfc2dfZm9yX2RldmljZShidWYtPmRldiwgc2d0LT5zZ2wsIHNn
dC0+b3JpZ19uZW50cywKLQkJCSAgICAgICBidWYtPmRtYV9kaXIpOworCWRtYV9zeW5jX3NndGFi
bGVfZm9yX2RldmljZShidWYtPmRldiwgc2d0LCBidWYtPmRtYV9kaXIpOwogfQogCiBzdGF0aWMg
dm9pZCB2YjJfZG1hX3NnX2ZpbmlzaCh2b2lkICpidWZfcHJpdikKQEAgLTIxNSw3ICsyMTMsNyBA
QCBzdGF0aWMgdm9pZCB2YjJfZG1hX3NnX2ZpbmlzaCh2b2lkICpidWZfcHJpdikKIAlpZiAoYnVm
LT5kYl9hdHRhY2gpCiAJCXJldHVybjsKIAotCWRtYV9zeW5jX3NnX2Zvcl9jcHUoYnVmLT5kZXYs
IHNndC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2Rpcik7CisJZG1hX3N5bmNfc2d0
YWJsZV9mb3JfY3B1KGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1hX2Rpcik7CiB9CiAKIHN0YXRpYyB2
b2lkICp2YjJfZG1hX3NnX2dldF91c2VycHRyKHN0cnVjdCBkZXZpY2UgKmRldiwgdW5zaWduZWQg
bG9uZyB2YWRkciwKQEAgLTI1OCw5ICsyNTYsOCBAQCBzdGF0aWMgdm9pZCAqdmIyX2RtYV9zZ19n
ZXRfdXNlcnB0cihzdHJ1Y3QgZGV2aWNlICpkZXYsIHVuc2lnbmVkIGxvbmcgdmFkZHIsCiAJICog
Tm8gbmVlZCB0byBzeW5jIHRvIHRoZSBkZXZpY2UsIHRoaXMgd2lsbCBoYXBwZW4gbGF0ZXIgd2hl
biB0aGUKIAkgKiBwcmVwYXJlKCkgbWVtb3AgaXMgY2FsbGVkLgogCSAqLwotCXNndC0+bmVudHMg
PSBkbWFfbWFwX3NnX2F0dHJzKGJ1Zi0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAot
CQkJCSAgICAgIGJ1Zi0+ZG1hX2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7Ci0JaWYgKCFz
Z3QtPm5lbnRzKQorCWlmIChkbWFfbWFwX3NndGFibGUoYnVmLT5kZXYsIHNndCwgYnVmLT5kbWFf
ZGlyLAorCQkJICAgIERNQV9BVFRSX1NLSVBfQ1BVX1NZTkMpKSB7CiAJCWdvdG8gdXNlcnB0cl9m
YWlsX21hcDsKIAogCXJldHVybiBidWY7CkBAIC0yODYsOCArMjgzLDcgQEAgc3RhdGljIHZvaWQg
dmIyX2RtYV9zZ19wdXRfdXNlcnB0cih2b2lkICpidWZfcHJpdikKIAogCWRwcmludGsoMSwgIiVz
OiBSZWxlYXNpbmcgdXNlcnNwYWNlIGJ1ZmZlciBvZiAlZCBwYWdlc1xuIiwKIAkgICAgICAgX19m
dW5jX18sIGJ1Zi0+bnVtX3BhZ2VzKTsKLQlkbWFfdW5tYXBfc2dfYXR0cnMoYnVmLT5kZXYsIHNn
dC0+c2dsLCBzZ3QtPm9yaWdfbmVudHMsIGJ1Zi0+ZG1hX2RpciwKLQkJCSAgIERNQV9BVFRSX1NL
SVBfQ1BVX1NZTkMpOworCWRtYV91bm1hcF9zZ3RhYmxlKGJ1Zi0+ZGV2LCBzZ3QsIGJ1Zi0+ZG1h
X2RpciwgRE1BX0FUVFJfU0tJUF9DUFVfU1lOQyk7CiAJaWYgKGJ1Zi0+dmFkZHIpCiAJCXZtX3Vu
bWFwX3JhbShidWYtPnZhZGRyLCBidWYtPm51bV9wYWdlcyk7CiAJc2dfZnJlZV90YWJsZShidWYt
PmRtYV9zZ3QpOwpAQCAtNDEwLDggKzQwNiw3IEBAIHN0YXRpYyB2b2lkIHZiMl9kbWFfc2dfZG1h
YnVmX29wc19kZXRhY2goc3RydWN0IGRtYV9idWYgKmRidWYsCiAKIAkvKiByZWxlYXNlIHRoZSBz
Y2F0dGVybGlzdCBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05PTkUpCi0J
CWRtYV91bm1hcF9zZyhkYl9hdHRhY2gtPmRldiwgc2d0LT5zZ2wsIHNndC0+b3JpZ19uZW50cywK
LQkJCWF0dGFjaC0+ZG1hX2Rpcik7CisJCWRtYV91bm1hcF9zZ3RhYmxlKGRiX2F0dGFjaC0+ZGV2
LCBzZ3QsIGF0dGFjaC0+ZG1hX2Rpcik7CiAJc2dfZnJlZV90YWJsZShzZ3QpOwogCWtmcmVlKGF0
dGFjaCk7CiAJZGJfYXR0YWNoLT5wcml2ID0gTlVMTDsKQEAgLTQzNiwxNSArNDMxLDEyIEBAIHN0
YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKnZiMl9kbWFfc2dfZG1hYnVmX29wc19tYXAoCiAKIAkvKiBy
ZWxlYXNlIGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1B
X05PTkUpIHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5v
cmlnX25lbnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJf
YXR0YWNoLT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyKTsKIAkJYXR0YWNoLT5kbWFfZGlyID0g
RE1BX05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGggbmV3IGRpcmVj
dGlvbiAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNn
bCwgc2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0LT5uZW50cykgewor
CWlmIChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2RpciwgMCkpIHsK
IAkJcHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhfdW5sb2Nr
KGxvY2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMvbWVk
aWEvY29tbW9uL3ZpZGVvYnVmMi92aWRlb2J1ZjItdm1hbGxvYy5jIGIvZHJpdmVycy9tZWRpYS9j
b21tb24vdmlkZW9idWYyL3ZpZGVvYnVmMi12bWFsbG9jLmMKaW5kZXggYzY2ZmRhNGE2NWU0Li5i
ZjVhYzYzYTU3NDIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92
aWRlb2J1ZjItdm1hbGxvYy5jCisrKyBiL2RyaXZlcnMvbWVkaWEvY29tbW9uL3ZpZGVvYnVmMi92
aWRlb2J1ZjItdm1hbGxvYy5jCkBAIC0yMjksNyArMjI5LDcgQEAgc3RhdGljIGludCB2YjJfdm1h
bGxvY19kbWFidWZfb3BzX2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAkJa2ZyZWUoYXR0
YWNoKTsKIAkJcmV0dXJuIHJldDsKIAl9Ci0JZm9yX2VhY2hfc2coc2d0LT5zZ2wsIHNnLCBzZ3Qt
Pm5lbnRzLCBpKSB7CisJZm9yX2VhY2hfc2d0YWJsZV9zZyhzZ3QsIHNnLCBpKSB7CiAJCXN0cnVj
dCBwYWdlICpwYWdlID0gdm1hbGxvY190b19wYWdlKHZhZGRyKTsKIAogCQlpZiAoIXBhZ2UpIHsK
QEAgLTI1OSw4ICsyNTksNyBAQCBzdGF0aWMgdm9pZCB2YjJfdm1hbGxvY19kbWFidWZfb3BzX2Rl
dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZGJ1ZiwKIAogCS8qIHJlbGVhc2UgdGhlIHNjYXR0ZXJsaXN0
IGNhY2hlICovCiAJaWYgKGF0dGFjaC0+ZG1hX2RpciAhPSBETUFfTk9ORSkKLQkJZG1hX3VubWFw
X3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25lbnRzLAotCQkJYXR0YWNo
LT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgYXR0
YWNoLT5kbWFfZGlyLCAwKTsKIAlzZ19mcmVlX3RhYmxlKHNndCk7CiAJa2ZyZWUoYXR0YWNoKTsK
IAlkYl9hdHRhY2gtPnByaXYgPSBOVUxMOwpAQCAtMjg1LDE1ICsyODQsMTIgQEAgc3RhdGljIHN0
cnVjdCBzZ190YWJsZSAqdmIyX3ZtYWxsb2NfZG1hYnVmX29wc19tYXAoCiAKIAkvKiByZWxlYXNl
IGFueSBwcmV2aW91cyBjYWNoZSAqLwogCWlmIChhdHRhY2gtPmRtYV9kaXIgIT0gRE1BX05PTkUp
IHsKLQkJZG1hX3VubWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwgc2d0LT5vcmlnX25l
bnRzLAotCQkJYXR0YWNoLT5kbWFfZGlyKTsKKwkJZG1hX3VubWFwX3NndGFibGUoZGJfYXR0YWNo
LT5kZXYsIHNndCwgYXR0YWNoLT5kbWFfZGlyLCAwKTsKIAkJYXR0YWNoLT5kbWFfZGlyID0gRE1B
X05PTkU7CiAJfQogCiAJLyogbWFwcGluZyB0byB0aGUgY2xpZW50IHdpdGggbmV3IGRpcmVjdGlv
biAqLwotCXNndC0+bmVudHMgPSBkbWFfbWFwX3NnKGRiX2F0dGFjaC0+ZGV2LCBzZ3QtPnNnbCwg
c2d0LT5vcmlnX25lbnRzLAotCQkJCWRtYV9kaXIpOwotCWlmICghc2d0LT5uZW50cykgeworCWlm
IChkbWFfbWFwX3NndGFibGUoZGJfYXR0YWNoLT5kZXYsIHNndCwgZG1hX2RpciwgMCkpIHsKIAkJ
cHJfZXJyKCJmYWlsZWQgdG8gbWFwIHNjYXR0ZXJsaXN0XG4iKTsKIAkJbXV0ZXhfdW5sb2NrKGxv
Y2spOwogCQlyZXR1cm4gRVJSX1BUUigtRUlPKTsKLS0gCjIuMTcuMQoKX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxp
c3QKTGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnCmh0dHBzOi8vbGlzdHMubGluYXJvLm9y
Zy9tYWlsbWFuL2xpc3RpbmZvL2xpbmFyby1tbS1zaWcK
