Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 130A2A31183
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 11 Feb 2025 17:32:48 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 30B924493F
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 11 Feb 2025 16:32:47 +0000 (UTC)
Received: from mail-ed1-f54.google.com (mail-ed1-f54.google.com [209.85.208.54])
	by lists.linaro.org (Postfix) with ESMTPS id C586544A21
	for <linaro-mm-sig@lists.linaro.org>; Tue, 11 Feb 2025 16:31:17 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=gmail.com header.s=20230601 header.b=grgSVX6v;
	spf=pass (lists.linaro.org: domain of ckoenig.leichtzumerken@gmail.com designates 209.85.208.54 as permitted sender) smtp.mailfrom=ckoenig.leichtzumerken@gmail.com;
	dmarc=pass (policy=none) header.from=gmail.com
Received: by mail-ed1-f54.google.com with SMTP id 4fb4d7f45d1cf-5de6e26d4e4so5641346a12.1
        for <linaro-mm-sig@lists.linaro.org>; Tue, 11 Feb 2025 08:31:17 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20230601; t=1739291477; x=1739896277; darn=lists.linaro.org;
        h=content-transfer-encoding:mime-version:references:in-reply-to
         :message-id:date:subject:to:from:from:to:cc:subject:date:message-id
         :reply-to;
        bh=Iap7JYgTMRHbjhfQG7wI8MFuWjBZrMJp1uv8Se86XIw=;
        b=grgSVX6vlXDaQwCuhthJKIT3haOceUkqYrJbxyFJsQrFv6qFZPvFNLUi6tsFvH06fd
         S3JvvnAFD33pVSuwGz17lEVZQMAhxvqRKgD9wLSTUOhr/NAWQPwLdBB+ryFcNLscA2ak
         12qm2jsoRClXrD38PqeTjUT1aD4wKlQrYEhFlEkRQZiM5kl56Pnai4Cre4GbwB7F1GsW
         rNO9PXnOCzk9zpvIH5HPpIb6sVveyorAMKKcuCOaeEXzFAIUDeoKzUl52faPTnRrAvp4
         8WD3PeE8NBmKkJo9fSPbsAk32m1D865sjVzqaymePpDVcNV01nOIsZSBTp/dG/pYhYuR
         zfsw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20230601; t=1739291477; x=1739896277;
        h=content-transfer-encoding:mime-version:references:in-reply-to
         :message-id:date:subject:to:from:x-gm-message-state:from:to:cc
         :subject:date:message-id:reply-to;
        bh=Iap7JYgTMRHbjhfQG7wI8MFuWjBZrMJp1uv8Se86XIw=;
        b=HQAzTDfD/7NIsEq44JPZbzE1Fep4An2JmsnznOd1VE6ZmZMN9pKu7Zoj7AKPkeKxOm
         IRdqfrKHCjnQvPAjLV4vcod9QE9Mlue1m4NNby+BPAL64P8gp5Zstd6UVriea2ZdhiLp
         /5fekywj7tZH3uBiTSnD4e54HmHdwd0aQ8yznKKx/VYuwG0RJr9alsI1JklfQ6quKGy5
         FC68qjwzQ984v5/kzZN6f+QTPLK/RA53e0Wgh/qOnwSndU8jc2pHzdi93/ASQ2Z9WJw6
         rhZLISXjKorCEgCRqYcwb1Hon9PGsSG2hUocgUghR/tYQmKsFByBrDhdoIplFyGa3dik
         eTHQ==
X-Forwarded-Encrypted: i=1; AJvYcCXMWWYRnXnETucnRrEwqU1E6jfnglVC2B8yurN9ZJq5Kk/R9JKL+FNW8EerFJ+9qgZje/hYnxE+Gkk+M4fz@lists.linaro.org
X-Gm-Message-State: AOJu0YyIura3t/WRg1il210+zh/Afg3ry/htcA8ssFecLpML0xVou1ji
	UOP0X+hhgyG3a+OiPS3ri+na2nRgFttd6k8TffC6An+ly0HCFzev
X-Gm-Gg: ASbGnct3fx45KF0hCVJmQJVUjofxEPBSCpOyxntXNhDWQCry9/dW9vQkjP9t1paTqkI
	ELG0QyQ6JOfGl14C7p2hSlO6qke5hERUVrmchujbhFTma4kLgxjODrkIM9IrhKS0TcmGJXjKrxF
	FnnIzsHz7WdO0gNZPcyfFEpofcRI7zOK8GXlOYI32Je5ZLvNmr/QvNu2rvKQ89jnHo8MYAS+2Oh
	UatUymlyp7QMfAPWIBmxEjpuvyHLctI0M14qy0bRHig+EmMxLCRNB2FhuxBsHzayhxpRgynE5+n
	luweGscNmpcxRdW5jGLQAzwa0vav
X-Google-Smtp-Source: AGHT+IGF9R9HgdOEGRm7oeMq6tll9Vr6d7qgWBF/JPebGyFBvvrkKcnRNN07e+0gFg7U8jOVOVfd1g==
X-Received: by 2002:a05:6402:321d:b0:5dc:cf9b:b048 with SMTP id 4fb4d7f45d1cf-5de45040066mr19096031a12.1.1739291476410;
        Tue, 11 Feb 2025 08:31:16 -0800 (PST)
Received: from able.fritz.box ([2a00:e180:154a:1300:5b91:7670:e404:c65a])
        by smtp.gmail.com with ESMTPSA id 4fb4d7f45d1cf-5dcf1b7ade9sm9838748a12.25.2025.02.11.08.31.14
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Tue, 11 Feb 2025 08:31:15 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
To: sumit.semwal@linaro.org,
	tzimmermann@suse.de,
	simona@ffwll.ch,
	dmitry.osipenko@collabora.com,
	tvrtko.ursulin@igalia.com,
	linux-media@vger.kernel.org,
	dri-devel@lists.freedesktop.org,
	linaro-mm-sig@lists.linaro.org
Date: Tue, 11 Feb 2025 17:31:08 +0100
Message-Id: <20250211163109.12200-4-christian.koenig@amd.com>
X-Mailer: git-send-email 2.34.1
In-Reply-To: <20250211163109.12200-1-christian.koenig@amd.com>
References: <20250211163109.12200-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-Rspamd-Action: no action
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: C586544A21
X-Spamd-Bar: --
X-Spamd-Result: default: False [-2.50 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	RBL_SENDERSCORE_REPUT_7(0.50)[209.85.208.54:from];
	BAD_REP_POLICIES(0.10)[];
	MIME_GOOD(-0.10)[text/plain];
	R_SPF_ALLOW(0.00)[+ip4:209.85.128.0/17:c];
	RCVD_VIA_SMTP_AUTH(0.00)[];
	DMARC_POLICY_ALLOW(0.00)[gmail.com,none];
	ARC_NA(0.00)[];
	MIME_TRACE(0.00)[0:+];
	NEURAL_SPAM(0.00)[0.858];
	ASN(0.00)[asn:15169, ipnet:209.85.128.0/17, country:US];
	FREEMAIL_ENVFROM(0.00)[gmail.com];
	FREEMAIL_FROM(0.00)[gmail.com];
	RWL_MAILSPIKE_POSSIBLE(0.00)[209.85.208.54:from];
	RCPT_COUNT_SEVEN(0.00)[8];
	R_DKIM_ALLOW(0.00)[gmail.com:s=20230601];
	RCVD_COUNT_TWO(0.00)[2];
	FROM_EQ_ENVFROM(0.00)[];
	FROM_HAS_DN(0.00)[];
	RCVD_TLS_LAST(0.00)[];
	TO_DN_NONE(0.00)[];
	PREVIOUSLY_DELIVERED(0.00)[linaro-mm-sig@lists.linaro.org];
	TAGGED_FROM(0.00)[];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	DKIM_TRACE(0.00)[gmail.com:+]
Message-ID-Hash: 3TYPVBAPMSFQGK45MQLEJZAPNGGBMPZZ
X-Message-ID-Hash: 3TYPVBAPMSFQGK45MQLEJZAPNGGBMPZZ
X-MailFrom: ckoenig.leichtzumerken@gmail.com
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 3/4] dma-buf: dma-buf: stop mapping sg_tables on attach
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/3TYPVBAPMSFQGK45MQLEJZAPNGGBMPZZ/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

QXMgYSB3b3JrYXJvdW5kIHRvIHNtb290aGx5IHRyYW5zaXQgZnJvbSBzdGF0aWMgdG8gZHluYW1p
YyBETUEtYnVmDQpoYW5kbGluZyB3ZSBjYWNoZWQgdGhlIHNnX3RhYmxlIG9uIGF0dGFjaCBpZiBk
eW5hbWljIGhhbmRsaW5nIG1pc21hdGNoZWQNCmJldHdlZW4gZXhwb3J0ZXIgYW5kIGltcG9ydGVy
Lg0KDQpTaW5jZSBEbWl0cnkgYW5kIFRob21hcyBjbGVhbmVkIHRoYXQgdXAgYW5kIGFsc28gZG9j
dW1lbnRlZCB0aGUgbG9jaw0KaGFuZGxpbmcgd2UgY2FuIGRyb3AgdGhpcyB3b3JrYXJvdW5kIG5v
dy4NCg0KU2lnbmVkLW9mZi1ieTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0Bh
bWQuY29tPg0KLS0tDQogZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYyB8IDE0OSArKysrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQ0KIGluY2x1ZGUvbGludXgvZG1hLWJ1Zi5oICAg
fCAgMTQgLS0tLQ0KIDIgZmlsZXMgY2hhbmdlZCwgNTYgaW5zZXJ0aW9ucygrKSwgMTA3IGRlbGV0
aW9ucygtKQ0KDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYyBiL2RyaXZl
cnMvZG1hLWJ1Zi9kbWEtYnVmLmMNCmluZGV4IDViYWE4M2I4NTUxNS4uMzU3Yjk0YTNkYmFhIDEw
MDY0NA0KLS0tIGEvZHJpdmVycy9kbWEtYnVmL2RtYS1idWYuYw0KKysrIGIvZHJpdmVycy9kbWEt
YnVmL2RtYS1idWYuYw0KQEAgLTc4Miw3ICs3ODIsNyBAQCBzdGF0aWMgdm9pZCBtYW5nbGVfc2df
dGFibGUoc3RydWN0IHNnX3RhYmxlICpzZ190YWJsZSkNCiANCiAJLyogVG8gY2F0Y2ggYWJ1c2Ug
b2YgdGhlIHVuZGVybHlpbmcgc3RydWN0IHBhZ2UgYnkgaW1wb3J0ZXJzIG1peA0KIAkgKiB1cCB0
aGUgYml0cywgYnV0IHRha2UgY2FyZSB0byBwcmVzZXJ2ZSB0aGUgbG93IFNHXyBiaXRzIHRvDQot
CSAqIG5vdCBjb3JydXB0IHRoZSBzZ3QuIFRoZSBtaXhpbmcgaXMgdW5kb25lIGluIF9fdW5tYXBf
ZG1hX2J1Zg0KKwkgKiBub3QgY29ycnVwdCB0aGUgc2d0LiBUaGUgbWl4aW5nIGlzIHVuZG9uZSBv
biB1bm1hcA0KIAkgKiBiZWZvcmUgcGFzc2luZyB0aGUgc2d0IGJhY2sgdG8gdGhlIGV4cG9ydGVy
Lg0KIAkgKi8NCiAJZm9yX2VhY2hfc2d0YWJsZV9zZyhzZ190YWJsZSwgc2csIGkpDQpAQCAtNzkw
LDI5ICs3OTAsMjAgQEAgc3RhdGljIHZvaWQgbWFuZ2xlX3NnX3RhYmxlKHN0cnVjdCBzZ190YWJs
ZSAqc2dfdGFibGUpDQogI2VuZGlmDQogDQogfQ0KLXN0YXRpYyBzdHJ1Y3Qgc2dfdGFibGUgKl9f
bWFwX2RtYV9idWYoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoLA0KLQkJCQkgICAg
ICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQ0KLXsNCi0Jc3RydWN0IHNnX3Rh
YmxlICpzZ190YWJsZTsNCi0Jc2lnbmVkIGxvbmcgcmV0Ow0KLQ0KLQlzZ190YWJsZSA9IGF0dGFj
aC0+ZG1hYnVmLT5vcHMtPm1hcF9kbWFfYnVmKGF0dGFjaCwgZGlyZWN0aW9uKTsNCi0JaWYgKElT
X0VSUl9PUl9OVUxMKHNnX3RhYmxlKSkNCi0JCXJldHVybiBzZ190YWJsZTsNCi0NCi0JaWYgKCFk
bWFfYnVmX2F0dGFjaG1lbnRfaXNfZHluYW1pYyhhdHRhY2gpKSB7DQotCQlyZXQgPSBkbWFfcmVz
dl93YWl0X3RpbWVvdXQoYXR0YWNoLT5kbWFidWYtPnJlc3YsDQotCQkJCQkgICAgRE1BX1JFU1Zf
VVNBR0VfS0VSTkVMLCB0cnVlLA0KLQkJCQkJICAgIE1BWF9TQ0hFRFVMRV9USU1FT1VUKTsNCi0J
CWlmIChyZXQgPCAwKSB7DQotCQkJYXR0YWNoLT5kbWFidWYtPm9wcy0+dW5tYXBfZG1hX2J1Zihh
dHRhY2gsIHNnX3RhYmxlLA0KLQkJCQkJCQkgICBkaXJlY3Rpb24pOw0KLQkJCXJldHVybiBFUlJf
UFRSKHJldCk7DQotCQl9DQotCX0NCiANCi0JbWFuZ2xlX3NnX3RhYmxlKHNnX3RhYmxlKTsNCi0J
cmV0dXJuIHNnX3RhYmxlOw0KKy8qKg0KKyAqIGRtYV9idWZfcGluX29uX21hcCAtIGNoZWNrIGlm
IGEgRE1BLWJ1ZiBzaG91bGQgYmUgcGlubmVkIHdoZW4gbWFwcGVkDQorICogQGF0dGFjaDogdGhl
IERNQS1idWYgYXR0YWNobWVudCB0byBjaGVjaw0KKyAqDQorICogUmV0dXJuczogVHJ1ZSBpZiBh
IERNQS1idWYgZXhwb3J0IHByb3ZpZGVkIHBpbi91bnBpbiBjYWxsYmFja3MgYW5kIHdlIGNhbid0
DQorICogdXNlIHRoZSBpbXBvcnRlcnMgbW92ZSBub3RpZnkgZm9yIHNvbWUgcmVhc29uLg0KKyAq
Lw0KK3N0YXRpYyBib29sDQorZG1hX2J1Zl9waW5fb25fbWFwKHN0cnVjdCBkbWFfYnVmX2F0dGFj
aG1lbnQgKmF0dGFjaCkNCit7DQorCXJldHVybiBhdHRhY2gtPmRtYWJ1Zi0+b3BzLT5waW4gJiYN
CisJCSghSVNfRU5BQkxFRChDT05GSUdfRE1BQlVGX01PVkVfTk9USUZZKSB8fA0KKwkJICFhdHRh
Y2gtPmltcG9ydGVyX29wcyk7DQogfQ0KIA0KIC8qKg0KQEAgLTkzNSw0OCArOTI2LDExIEBAIGRt
YV9idWZfZHluYW1pY19hdHRhY2goc3RydWN0IGRtYV9idWYgKmRtYWJ1Ziwgc3RydWN0IGRldmlj
ZSAqZGV2LA0KIAlsaXN0X2FkZCgmYXR0YWNoLT5ub2RlLCAmZG1hYnVmLT5hdHRhY2htZW50cyk7
DQogCWRtYV9yZXN2X3VubG9jayhkbWFidWYtPnJlc3YpOw0KIA0KLQkvKiBXaGVuIGVpdGhlciB0
aGUgaW1wb3J0ZXIgb3IgdGhlIGV4cG9ydGVyIGNhbid0IGhhbmRsZSBkeW5hbWljDQotCSAqIG1h
cHBpbmdzIHdlIGNhY2hlIHRoZSBtYXBwaW5nIGhlcmUgdG8gYXZvaWQgaXNzdWVzIHdpdGggdGhl
DQotCSAqIHJlc2VydmF0aW9uIG9iamVjdCBsb2NrLg0KLQkgKi8NCi0JaWYgKGRtYV9idWZfYXR0
YWNobWVudF9pc19keW5hbWljKGF0dGFjaCkgIT0NCi0JICAgIGRtYV9idWZfaXNfZHluYW1pYyhk
bWFidWYpKSB7DQotCQlzdHJ1Y3Qgc2dfdGFibGUgKnNndDsNCi0NCi0JCWRtYV9yZXN2X2xvY2so
YXR0YWNoLT5kbWFidWYtPnJlc3YsIE5VTEwpOw0KLQkJaWYgKGRtYV9idWZfaXNfZHluYW1pYyhh
dHRhY2gtPmRtYWJ1ZikpIHsNCi0JCQlyZXQgPSBkbWFidWYtPm9wcy0+cGluKGF0dGFjaCk7DQot
CQkJaWYgKHJldCkNCi0JCQkJZ290byBlcnJfdW5sb2NrOw0KLQkJfQ0KLQ0KLQkJc2d0ID0gX19t
YXBfZG1hX2J1ZihhdHRhY2gsIERNQV9CSURJUkVDVElPTkFMKTsNCi0JCWlmICghc2d0KQ0KLQkJ
CXNndCA9IEVSUl9QVFIoLUVOT01FTSk7DQotCQlpZiAoSVNfRVJSKHNndCkpIHsNCi0JCQlyZXQg
PSBQVFJfRVJSKHNndCk7DQotCQkJZ290byBlcnJfdW5waW47DQotCQl9DQotCQlkbWFfcmVzdl91
bmxvY2soYXR0YWNoLT5kbWFidWYtPnJlc3YpOw0KLQkJYXR0YWNoLT5zZ3QgPSBzZ3Q7DQotCQlh
dHRhY2gtPmRpciA9IERNQV9CSURJUkVDVElPTkFMOw0KLQl9DQotDQogCXJldHVybiBhdHRhY2g7
DQogDQogZXJyX2F0dGFjaDoNCiAJa2ZyZWUoYXR0YWNoKTsNCiAJcmV0dXJuIEVSUl9QVFIocmV0
KTsNCi0NCi1lcnJfdW5waW46DQotCWlmIChkbWFfYnVmX2lzX2R5bmFtaWMoYXR0YWNoLT5kbWFi
dWYpKQ0KLQkJZG1hYnVmLT5vcHMtPnVucGluKGF0dGFjaCk7DQotDQotZXJyX3VubG9jazoNCi0J
ZG1hX3Jlc3ZfdW5sb2NrKGF0dGFjaC0+ZG1hYnVmLT5yZXN2KTsNCi0NCi0JZG1hX2J1Zl9kZXRh
Y2goZG1hYnVmLCBhdHRhY2gpOw0KLQlyZXR1cm4gRVJSX1BUUihyZXQpOw0KIH0NCiBFWFBPUlRf
U1lNQk9MX05TX0dQTChkbWFfYnVmX2R5bmFtaWNfYXR0YWNoLCAiRE1BX0JVRiIpOw0KIA0KQEAg
LTk5NSwxNiArOTQ5LDYgQEAgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqZG1hX2J1Zl9hdHRh
Y2goc3RydWN0IGRtYV9idWYgKmRtYWJ1ZiwNCiB9DQogRVhQT1JUX1NZTUJPTF9OU19HUEwoZG1h
X2J1Zl9hdHRhY2gsICJETUFfQlVGIik7DQogDQotc3RhdGljIHZvaWQgX191bm1hcF9kbWFfYnVm
KHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCwNCi0JCQkgICAgc3RydWN0IHNnX3Rh
YmxlICpzZ190YWJsZSwNCi0JCQkgICAgZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9u
KQ0KLXsNCi0JLyogdXNlcyBYT1IsIGhlbmNlIHRoaXMgdW5tYW5nbGVzICovDQotCW1hbmdsZV9z
Z190YWJsZShzZ190YWJsZSk7DQotDQotCWF0dGFjaC0+ZG1hYnVmLT5vcHMtPnVubWFwX2RtYV9i
dWYoYXR0YWNoLCBzZ190YWJsZSwgZGlyZWN0aW9uKTsNCi19DQotDQogLyoqDQogICogZG1hX2J1
Zl9kZXRhY2ggLSBSZW1vdmUgdGhlIGdpdmVuIGF0dGFjaG1lbnQgZnJvbSBkbWFidWYncyBhdHRh
Y2htZW50cyBsaXN0DQogICogQGRtYWJ1ZjoJW2luXQlidWZmZXIgdG8gZGV0YWNoIGZyb20uDQpA
QCAtMTAyMiwxMSArOTY2LDEyIEBAIHZvaWQgZG1hX2J1Zl9kZXRhY2goc3RydWN0IGRtYV9idWYg
KmRtYWJ1Ziwgc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAqYXR0YWNoKQ0KIAlkbWFfcmVzdl9s
b2NrKGRtYWJ1Zi0+cmVzdiwgTlVMTCk7DQogDQogCWlmIChhdHRhY2gtPnNndCkgew0KKwkJbWFu
Z2xlX3NnX3RhYmxlKGF0dGFjaC0+c2d0KTsNCisJCWF0dGFjaC0+ZG1hYnVmLT5vcHMtPnVubWFw
X2RtYV9idWYoYXR0YWNoLCBhdHRhY2gtPnNndCwNCisJCQkJCQkgICBhdHRhY2gtPmRpcik7DQog
DQotCQlfX3VubWFwX2RtYV9idWYoYXR0YWNoLCBhdHRhY2gtPnNndCwgYXR0YWNoLT5kaXIpOw0K
LQ0KLQkJaWYgKGRtYV9idWZfaXNfZHluYW1pYyhhdHRhY2gtPmRtYWJ1ZikpDQotCQkJZG1hYnVm
LT5vcHMtPnVucGluKGF0dGFjaCk7DQorCQlpZiAoZG1hX2J1Zl9waW5fb25fbWFwKGF0dGFjaCkp
DQorCQkJZG1hX2J1Zl91bnBpbihhdHRhY2gpOw0KIAl9DQogCWxpc3RfZGVsKCZhdHRhY2gtPm5v
ZGUpOw0KIA0KQEAgLTEwNTgsNyArMTAwMyw3IEBAIGludCBkbWFfYnVmX3BpbihzdHJ1Y3QgZG1h
X2J1Zl9hdHRhY2htZW50ICphdHRhY2gpDQogCXN0cnVjdCBkbWFfYnVmICpkbWFidWYgPSBhdHRh
Y2gtPmRtYWJ1ZjsNCiAJaW50IHJldCA9IDA7DQogDQotCVdBUk5fT04oIWRtYV9idWZfYXR0YWNo
bWVudF9pc19keW5hbWljKGF0dGFjaCkpOw0KKwlXQVJOX09OKCFhdHRhY2gtPmltcG9ydGVyX29w
cyk7DQogDQogCWRtYV9yZXN2X2Fzc2VydF9oZWxkKGRtYWJ1Zi0+cmVzdik7DQogDQpAQCAtMTA4
MSw3ICsxMDI2LDcgQEAgdm9pZCBkbWFfYnVmX3VucGluKHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1l
bnQgKmF0dGFjaCkNCiB7DQogCXN0cnVjdCBkbWFfYnVmICpkbWFidWYgPSBhdHRhY2gtPmRtYWJ1
ZjsNCiANCi0JV0FSTl9PTighZG1hX2J1Zl9hdHRhY2htZW50X2lzX2R5bmFtaWMoYXR0YWNoKSk7
DQorCVdBUk5fT04oIWF0dGFjaC0+aW1wb3J0ZXJfb3BzKTsNCiANCiAJZG1hX3Jlc3ZfYXNzZXJ0
X2hlbGQoZG1hYnVmLT5yZXN2KTsNCiANCkBAIC0xMTE1LDcgKzEwNjAsNyBAQCBzdHJ1Y3Qgc2df
dGFibGUgKmRtYV9idWZfbWFwX2F0dGFjaG1lbnQoc3RydWN0IGRtYV9idWZfYXR0YWNobWVudCAq
YXR0YWNoLA0KIAkJCQkJZW51bSBkbWFfZGF0YV9kaXJlY3Rpb24gZGlyZWN0aW9uKQ0KIHsNCiAJ
c3RydWN0IHNnX3RhYmxlICpzZ190YWJsZTsNCi0JaW50IHI7DQorCXNpZ25lZCBsb25nIHJldDsN
CiANCiAJbWlnaHRfc2xlZXAoKTsNCiANCkBAIC0xMTM2LDI5ICsxMDgxLDM3IEBAIHN0cnVjdCBz
Z190YWJsZSAqZG1hX2J1Zl9tYXBfYXR0YWNobWVudChzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50
ICphdHRhY2gsDQogCQlyZXR1cm4gYXR0YWNoLT5zZ3Q7DQogCX0NCiANCi0JaWYgKGRtYV9idWZf
aXNfZHluYW1pYyhhdHRhY2gtPmRtYWJ1ZikpIHsNCi0JCWlmICghSVNfRU5BQkxFRChDT05GSUdf
RE1BQlVGX01PVkVfTk9USUZZKSkgew0KLQkJCXIgPSBhdHRhY2gtPmRtYWJ1Zi0+b3BzLT5waW4o
YXR0YWNoKTsNCi0JCQlpZiAocikNCi0JCQkJcmV0dXJuIEVSUl9QVFIocik7DQotCQl9DQorCWlm
IChkbWFfYnVmX3Bpbl9vbl9tYXAoYXR0YWNoKSkgew0KKwkJcmV0ID0gYXR0YWNoLT5kbWFidWYt
Pm9wcy0+cGluKGF0dGFjaCk7DQorCQlpZiAocmV0KQ0KKwkJCXJldHVybiBFUlJfUFRSKHJldCk7
DQogCX0NCiANCi0Jc2dfdGFibGUgPSBfX21hcF9kbWFfYnVmKGF0dGFjaCwgZGlyZWN0aW9uKTsN
CisJc2dfdGFibGUgPSBhdHRhY2gtPmRtYWJ1Zi0+b3BzLT5tYXBfZG1hX2J1ZihhdHRhY2gsIGRp
cmVjdGlvbik7DQogCWlmICghc2dfdGFibGUpDQogCQlzZ190YWJsZSA9IEVSUl9QVFIoLUVOT01F
TSk7DQorCWlmIChJU19FUlIoc2dfdGFibGUpKQ0KKwkJZ290byBlcnJvcl91bnBpbjsNCiANCi0J
aWYgKElTX0VSUihzZ190YWJsZSkgJiYgZG1hX2J1Zl9pc19keW5hbWljKGF0dGFjaC0+ZG1hYnVm
KSAmJg0KLQkgICAgICFJU19FTkFCTEVEKENPTkZJR19ETUFCVUZfTU9WRV9OT1RJRlkpKQ0KLQkJ
YXR0YWNoLT5kbWFidWYtPm9wcy0+dW5waW4oYXR0YWNoKTsNCisJLyoNCisJICogV2hlbiBub3Qg
cHJvdmlkaW5nIG9wcyB0aGUgaW1wb3J0ZXIgZG9lc24ndCB3YWl0IGZvciBmZW5jZXMgZWl0aGVy
Lg0KKwkgKi8NCisJaWYgKCFhdHRhY2gtPmltcG9ydGVyX29wcykgew0KKwkJcmV0ID0gZG1hX3Jl
c3Zfd2FpdF90aW1lb3V0KGF0dGFjaC0+ZG1hYnVmLT5yZXN2LA0KKwkJCQkJICAgIERNQV9SRVNW
X1VTQUdFX0tFUk5FTCwgdHJ1ZSwNCisJCQkJCSAgICBNQVhfU0NIRURVTEVfVElNRU9VVCk7DQor
CQlpZiAocmV0IDwgMCkNCisJCQlnb3RvIGVycm9yX3VubWFwOw0KKwl9DQorCW1hbmdsZV9zZ190
YWJsZShzZ190YWJsZSk7DQogDQotCWlmICghSVNfRVJSKHNnX3RhYmxlKSAmJiBhdHRhY2gtPmRt
YWJ1Zi0+b3BzLT5jYWNoZV9zZ3RfbWFwcGluZykgew0KKwlpZiAoYXR0YWNoLT5kbWFidWYtPm9w
cy0+Y2FjaGVfc2d0X21hcHBpbmcpIHsNCiAJCWF0dGFjaC0+c2d0ID0gc2dfdGFibGU7DQogCQlh
dHRhY2gtPmRpciA9IGRpcmVjdGlvbjsNCiAJfQ0KIA0KICNpZmRlZiBDT05GSUdfRE1BX0FQSV9E
RUJVRw0KLQlpZiAoIUlTX0VSUihzZ190YWJsZSkpIHsNCisJew0KIAkJc3RydWN0IHNjYXR0ZXJs
aXN0ICpzZzsNCiAJCXU2NCBhZGRyOw0KIAkJaW50IGxlbjsNCkBAIC0xMTc1LDYgKzExMjgsMTYg
QEAgc3RydWN0IHNnX3RhYmxlICpkbWFfYnVmX21hcF9hdHRhY2htZW50KHN0cnVjdCBkbWFfYnVm
X2F0dGFjaG1lbnQgKmF0dGFjaCwNCiAJfQ0KICNlbmRpZiAvKiBDT05GSUdfRE1BX0FQSV9ERUJV
RyAqLw0KIAlyZXR1cm4gc2dfdGFibGU7DQorDQorZXJyb3JfdW5tYXA6DQorCWF0dGFjaC0+ZG1h
YnVmLT5vcHMtPnVubWFwX2RtYV9idWYoYXR0YWNoLCBzZ190YWJsZSwgZGlyZWN0aW9uKTsNCisJ
c2dfdGFibGUgPSBFUlJfUFRSKHJldCk7DQorDQorZXJyb3JfdW5waW46DQorCWlmIChkbWFfYnVm
X3Bpbl9vbl9tYXAoYXR0YWNoKSkNCisJCWF0dGFjaC0+ZG1hYnVmLT5vcHMtPnVucGluKGF0dGFj
aCk7DQorDQorCXJldHVybiBzZ190YWJsZTsNCiB9DQogRVhQT1JUX1NZTUJPTF9OU19HUEwoZG1h
X2J1Zl9tYXBfYXR0YWNobWVudCwgIkRNQV9CVUYiKTsNCiANCkBAIC0xMjMwLDExICsxMTkzLDEx
IEBAIHZvaWQgZG1hX2J1Zl91bm1hcF9hdHRhY2htZW50KHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1l
bnQgKmF0dGFjaCwNCiAJaWYgKGF0dGFjaC0+c2d0ID09IHNnX3RhYmxlKQ0KIAkJcmV0dXJuOw0K
IA0KLQlfX3VubWFwX2RtYV9idWYoYXR0YWNoLCBzZ190YWJsZSwgZGlyZWN0aW9uKTsNCisJbWFu
Z2xlX3NnX3RhYmxlKHNnX3RhYmxlKTsNCisJYXR0YWNoLT5kbWFidWYtPm9wcy0+dW5tYXBfZG1h
X2J1ZihhdHRhY2gsIHNnX3RhYmxlLCBkaXJlY3Rpb24pOw0KIA0KLQlpZiAoZG1hX2J1Zl9pc19k
eW5hbWljKGF0dGFjaC0+ZG1hYnVmKSAmJg0KLQkgICAgIUlTX0VOQUJMRUQoQ09ORklHX0RNQUJV
Rl9NT1ZFX05PVElGWSkpDQotCQlkbWFfYnVmX3VucGluKGF0dGFjaCk7DQorCWlmIChkbWFfYnVm
X3Bpbl9vbl9tYXAoYXR0YWNoKSkNCisJCWF0dGFjaC0+ZG1hYnVmLT5vcHMtPnVucGluKGF0dGFj
aCk7DQogfQ0KIEVYUE9SVF9TWU1CT0xfTlNfR1BMKGRtYV9idWZfdW5tYXBfYXR0YWNobWVudCwg
IkRNQV9CVUYiKTsNCiANCmRpZmYgLS1naXQgYS9pbmNsdWRlL2xpbnV4L2RtYS1idWYuaCBiL2lu
Y2x1ZGUvbGludXgvZG1hLWJ1Zi5oDQppbmRleCAzNjIxNmQyOGQ4YmQuLmM1NGZmMmRkYThjYiAx
MDA2NDQNCi0tLSBhL2luY2x1ZGUvbGludXgvZG1hLWJ1Zi5oDQorKysgYi9pbmNsdWRlL2xpbnV4
L2RtYS1idWYuaA0KQEAgLTU4MywyMCArNTgzLDYgQEAgc3RhdGljIGlubGluZSBib29sIGRtYV9i
dWZfaXNfZHluYW1pYyhzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmKQ0KIAlyZXR1cm4gISFkbWFidWYt
Pm9wcy0+cGluOw0KIH0NCiANCi0vKioNCi0gKiBkbWFfYnVmX2F0dGFjaG1lbnRfaXNfZHluYW1p
YyAtIGNoZWNrIGlmIGEgRE1BLWJ1ZiBhdHRhY2htZW50IHVzZXMgZHluYW1pYw0KLSAqIG1hcHBp
bmdzDQotICogQGF0dGFjaDogdGhlIERNQS1idWYgYXR0YWNobWVudCB0byBjaGVjaw0KLSAqDQot
ICogUmV0dXJucyB0cnVlIGlmIGEgRE1BLWJ1ZiBpbXBvcnRlciB3YW50cyB0byBjYWxsIHRoZSBt
YXAvdW5tYXAgZnVuY3Rpb25zIHdpdGgNCi0gKiB0aGUgZG1hX3Jlc3YgbG9jayBoZWxkLg0KLSAq
Lw0KLXN0YXRpYyBpbmxpbmUgYm9vbA0KLWRtYV9idWZfYXR0YWNobWVudF9pc19keW5hbWljKHN0
cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKmF0dGFjaCkNCi17DQotCXJldHVybiAhIWF0dGFjaC0+
aW1wb3J0ZXJfb3BzOw0KLX0NCi0NCiBzdHJ1Y3QgZG1hX2J1Zl9hdHRhY2htZW50ICpkbWFfYnVm
X2F0dGFjaChzdHJ1Y3QgZG1hX2J1ZiAqZG1hYnVmLA0KIAkJCQkJICBzdHJ1Y3QgZGV2aWNlICpk
ZXYpOw0KIHN0cnVjdCBkbWFfYnVmX2F0dGFjaG1lbnQgKg0KLS0gDQoyLjM0LjENCg0KX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBt
YWlsaW5nIGxpc3QgLS0gbGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2Ny
aWJlIHNlbmQgYW4gZW1haWwgdG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3Jn
Cg==
