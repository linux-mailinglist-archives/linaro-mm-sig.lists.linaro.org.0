Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 49E89423DD0
	for <lists+linaro-mm-sig@lfdr.de>; Wed,  6 Oct 2021 14:36:27 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 298F260561
	for <lists+linaro-mm-sig@lfdr.de>; Wed,  6 Oct 2021 12:36:25 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id B868C60767; Wed,  6 Oct 2021 12:36:22 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id E223E60A81;
	Wed,  6 Oct 2021 12:36:19 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 5CD6860561
 for <linaro-mm-sig@lists.linaro.org>; Wed,  6 Oct 2021 12:36:15 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id 5AD416057D; Wed,  6 Oct 2021 12:36:15 +0000 (UTC)
Received: from mail-wr1-f44.google.com (mail-wr1-f44.google.com
 [209.85.221.44])
 by lists.linaro.org (Postfix) with ESMTPS id 4C4486056F
 for <linaro-mm-sig@lists.linaro.org>; Wed,  6 Oct 2021 12:36:13 +0000 (UTC)
Received: by mail-wr1-f44.google.com with SMTP id k7so8278550wrd.13
 for <linaro-mm-sig@lists.linaro.org>; Wed, 06 Oct 2021 05:36:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20210112;
 h=from:to:cc:subject:date:message-id:in-reply-to:references
 :mime-version:content-transfer-encoding;
 bh=89OOgwIjAdHEsJJAQ88awEfVzr+pvOl73kjL6eCX7Ww=;
 b=qh84H34U5hLSCDUP73mzuGZ0fIEmj0EMWOyrmqZPfZpFuaBbuwm4HGTDuZ+J/aAyxN
 TmM68rbq2cGiZuCBAulHC/qv2Cems1obpGqeS4b8AiXCaWQOLCsp5l7XXQK6irbFf96B
 wSuLfLujm6L3zDv8bw/l3sMw31PwlHl4LlsFUAHKzDGIw9m2FjAq7aS79VgjyOPH5qxv
 wOnL6trGQMsigOMISYeThR/rnlezJccu9fpeM0OM/K0DEpzx19TZWTVUS9ITrsCwiH+D
 LLDy0/O/Td1qVPYC5socDBsIhmLRFdSM5FVM/P8AWVGVusT/ex6+csso6BRdk0xVrZsB
 qX5g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:from:to:cc:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=89OOgwIjAdHEsJJAQ88awEfVzr+pvOl73kjL6eCX7Ww=;
 b=EdZc89rHmjsP8c0Bs3lLbSjQh5736xLeKPCKLnPqgREMOpdDavN2gecSNN3mcUx8Jd
 6a8io0W/qSGuTSt/uBVrnXcYBpVE6P2oOuNjMkaBlfct1978/4bLFr23L9IQphg21IP3
 AgE24LCSwFhFM/uMph18/a/ViZu5sJm0VWCDIZXewpnw/kpRoKin9hN/WuEAVYOpz21/
 1VF/IrYt0DK2pa335Wv+/hwt2dMwUd83ucDqqwsuYJBCoFwS9KCklgtfh8LVhZ24FoqL
 SVcpvoaMoLl29vgZ26IeO6GNgsEpcdtCr05yPOCS12R83e64MBkbOMtRQX+JuT27fnKz
 fA+A==
X-Gm-Message-State: AOAM530JPx7Wbpfl1hUWIajMcLJwLd0CxMPaCaEoxP+9/vec9/gzkpit
 ni455NwDbBHvM+TxFqJG2FCO0SxSszw=
X-Google-Smtp-Source: ABdhPJzSJnI5oyhF4GY/Mg9pp/fHbN3cI0NXNZ0vDmZgpFuyWCgu+twOsdBPRFrH3we+AaP5BJAYqg==
X-Received: by 2002:a1c:ac03:: with SMTP id v3mr9951186wme.127.1633523772342; 
 Wed, 06 Oct 2021 05:36:12 -0700 (PDT)
Received: from abel.fritz.box (p5b0ea1b5.dip0.t-ipconnect.de. [91.14.161.181])
 by smtp.gmail.com with ESMTPSA id
 l124sm5194770wml.8.2021.10.06.05.36.11
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Wed, 06 Oct 2021 05:36:11 -0700 (PDT)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: linaro-mm-sig@lists.linaro.org, dri-devel@lists.freedesktop.org,
 linux-media@vger.kernel.org, intel-gfx@lists.freedesktop.org,
 daniel@ffwll.ch
Date: Wed,  6 Oct 2021 14:36:09 +0200
Message-Id: <20211006123609.2026-2-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20211006123609.2026-1-christian.koenig@amd.com>
References: <20211006123609.2026-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: [Linaro-mm-sig] [PATCH 2/2] dma-buf: add dma_resv selftest v3
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Cc: tvrtko.ursulin@linux.intel.com
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

SnVzdCBleGVyY2lzaW5nIGEgdmVyeSBtaW5vciBzdWJzZXQgb2YgdGhlIGZ1bmN0aW9uYWxpdHks
IGJ1dCBhbHJlYWR5CnByb3ZlbiB1c2VmdWwuCgp2MjogYWRkIG1pc3NpbmcgbG9ja2luZwp2Mzog
c29tZSBtb3JlIGNsZWFudXAgYW5kIGNvbnNvbGlkYXRpb24sIGFkZCB1bmxvY2tlZCB0ZXN0IGFz
IHdlbGwKClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdA
YW1kLmNvbT4KLS0tCiBkcml2ZXJzL2RtYS1idWYvTWFrZWZpbGUgICAgICB8ICAgMyArLQogZHJp
dmVycy9kbWEtYnVmL3NlbGZ0ZXN0cy5oICAgfCAgIDEgKwogZHJpdmVycy9kbWEtYnVmL3N0LWRt
YS1yZXN2LmMgfCAyODIgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogMyBmaWxl
cyBjaGFuZ2VkLCAyODUgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQogY3JlYXRlIG1vZGUg
MTAwNjQ0IGRyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtcmVzdi5jCgpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9kbWEtYnVmL01ha2VmaWxlIGIvZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlCmluZGV4IDFlZjAy
MTI3M2EwNi4uNTExODA1ZGJlYjc1IDEwMDY0NAotLS0gYS9kcml2ZXJzL2RtYS1idWYvTWFrZWZp
bGUKKysrIGIvZHJpdmVycy9kbWEtYnVmL01ha2VmaWxlCkBAIC0xMSw2ICsxMSw3IEBAIG9iai0k
KENPTkZJR19ETUFCVUZfU1lTRlNfU1RBVFMpICs9IGRtYS1idWYtc3lzZnMtc3RhdHMubwogZG1h
YnVmX3NlbGZ0ZXN0cy15IDo9IFwKIAlzZWxmdGVzdC5vIFwKIAlzdC1kbWEtZmVuY2UubyBcCi0J
c3QtZG1hLWZlbmNlLWNoYWluLm8KKwlzdC1kbWEtZmVuY2UtY2hhaW4ubyBcCisJc3QtZG1hLXJl
c3YubwogCiBvYmotJChDT05GSUdfRE1BQlVGX1NFTEZURVNUUykJKz0gZG1hYnVmX3NlbGZ0ZXN0
cy5vCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvc2VsZnRlc3RzLmggYi9kcml2ZXJzL2Rt
YS1idWYvc2VsZnRlc3RzLmgKaW5kZXggYmM4Y2VhNjdiZjFlLi45N2Q3M2FhYTMxZGEgMTAwNjQ0
Ci0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9zZWxmdGVzdHMuaAorKysgYi9kcml2ZXJzL2RtYS1idWYv
c2VsZnRlc3RzLmgKQEAgLTEyLDMgKzEyLDQgQEAKIHNlbGZ0ZXN0KHNhbml0eWNoZWNrLCBfX3Nh
bml0eWNoZWNrX18pIC8qIGtlZXAgZmlyc3QgKGlndCBzZWxmY2hlY2spICovCiBzZWxmdGVzdChk
bWFfZmVuY2UsIGRtYV9mZW5jZSkKIHNlbGZ0ZXN0KGRtYV9mZW5jZV9jaGFpbiwgZG1hX2ZlbmNl
X2NoYWluKQorc2VsZnRlc3QoZG1hX3Jlc3YsIGRtYV9yZXN2KQpkaWZmIC0tZ2l0IGEvZHJpdmVy
cy9kbWEtYnVmL3N0LWRtYS1yZXN2LmMgYi9kcml2ZXJzL2RtYS1idWYvc3QtZG1hLXJlc3YuYwpu
ZXcgZmlsZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAwMDAuLjUwZDM3OTFjY2I4YwotLS0g
L2Rldi9udWxsCisrKyBiL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtcmVzdi5jCkBAIC0wLDAgKzEs
MjgyIEBACisvKiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogTUlUICovCisKKy8qCisqIENvcHly
aWdodCDCqSAyMDE5IEludGVsIENvcnBvcmF0aW9uCisqIENvcHlyaWdodCDCqSAyMDIxIEFkdmFu
Y2VkIE1pY3JvIERldmljZXMsIEluYy4KKyovCisKKyNpbmNsdWRlIDxsaW51eC9zbGFiLmg+Cisj
aW5jbHVkZSA8bGludXgvc3BpbmxvY2suaD4KKyNpbmNsdWRlIDxsaW51eC9kbWEtcmVzdi5oPgor
CisjaW5jbHVkZSAic2VsZnRlc3QuaCIKKworc3RhdGljIHN0cnVjdCBzcGlubG9jayBmZW5jZV9s
b2NrOworCitzdGF0aWMgY29uc3QgY2hhciAqZmVuY2VfbmFtZShzdHJ1Y3QgZG1hX2ZlbmNlICpm
KQoreworCXJldHVybiAic2VsZnRlc3QiOworfQorCitzdGF0aWMgY29uc3Qgc3RydWN0IGRtYV9m
ZW5jZV9vcHMgZmVuY2Vfb3BzID0geworCS5nZXRfZHJpdmVyX25hbWUgPSBmZW5jZV9uYW1lLAor
CS5nZXRfdGltZWxpbmVfbmFtZSA9IGZlbmNlX25hbWUsCit9OworCitzdGF0aWMgc3RydWN0IGRt
YV9mZW5jZSAqYWxsb2NfZmVuY2Uodm9pZCkKK3sKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmOworCisJ
ZiA9IGttYWxsb2Moc2l6ZW9mKCpmKSwgR0ZQX0tFUk5FTCk7CisJaWYgKCFmKQorCQlyZXR1cm4g
TlVMTDsKKworCWRtYV9mZW5jZV9pbml0KGYsICZmZW5jZV9vcHMsICZmZW5jZV9sb2NrLCAwLCAw
KTsKKwlyZXR1cm4gZjsKK30KKworc3RhdGljIGludCBzYW5pdHljaGVjayh2b2lkICphcmcpCit7
CisJc3RydWN0IGRtYV9yZXN2IHJlc3Y7CisJc3RydWN0IGRtYV9mZW5jZSAqZjsKKwlpbnQgcjsK
KworCWYgPSBhbGxvY19mZW5jZSgpOworCWlmICghZikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlk
bWFfZmVuY2Vfc2lnbmFsKGYpOworCWRtYV9mZW5jZV9wdXQoZik7CisKKwlkbWFfcmVzdl9pbml0
KCZyZXN2KTsKKwlyID0gZG1hX3Jlc3ZfbG9jaygmcmVzdiwgTlVMTCk7CisJaWYgKHIpCisJCXBy
X2VycigiUmVzdiBsb2NraW5nIGZhaWxlZFxuIik7CisJZWxzZQorCQlkbWFfcmVzdl91bmxvY2so
JnJlc3YpOworCWRtYV9yZXN2X2ZpbmkoJnJlc3YpOworCXJldHVybiByOworfQorCitzdGF0aWMg
aW50IHRlc3Rfc2lnbmFsaW5nKHZvaWQgKmFyZywgYm9vbCBzaGFyZWQpCit7CisJc3RydWN0IGRt
YV9yZXN2IHJlc3Y7CisJc3RydWN0IGRtYV9mZW5jZSAqZjsKKwlpbnQgcjsKKworCWYgPSBhbGxv
Y19mZW5jZSgpOworCWlmICghZikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlkbWFfcmVzdl9pbml0
KCZyZXN2KTsKKwlyID0gZG1hX3Jlc3ZfbG9jaygmcmVzdiwgTlVMTCk7CisJaWYgKHIpIHsKKwkJ
cHJfZXJyKCJSZXN2IGxvY2tpbmcgZmFpbGVkXG4iKTsKKwkJZ290byBlcnJfZnJlZTsKKwl9CisK
KwlpZiAoc2hhcmVkKSB7CisJCXIgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZCgmcmVzdiwgMSk7
CisJCWlmIChyKSB7CisJCQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNsb3QgYWxsb2NhdGlvbiBmYWls
ZWRcbiIpOworCQkJZ290byBlcnJfdW5sb2NrOworCQl9CisKKwkJZG1hX3Jlc3ZfYWRkX3NoYXJl
ZF9mZW5jZSgmcmVzdiwgZik7CisJfSBlbHNlIHsKKwkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2Uo
JnJlc3YsIGYpOworCX0KKworCWlmIChkbWFfcmVzdl90ZXN0X3NpZ25hbGVkKCZyZXN2LCBzaGFy
ZWQpKSB7CisJCXByX2VycigiUmVzdiB1bmV4cGVjdGVkbHkgc2lnbmFsZWRcbiIpOworCQlyID0g
LUVJTlZBTDsKKwkJZ290byBlcnJfdW5sb2NrOworCX0KKwlkbWFfZmVuY2Vfc2lnbmFsKGYpOwor
CWlmICghZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZCgmcmVzdiwgc2hhcmVkKSkgeworCQlwcl9lcnIo
IlJlc3Ygbm90IHJlcG9ydGluZyBzaWduYWxlZFxuIik7CisJCXIgPSAtRUlOVkFMOworCQlnb3Rv
IGVycl91bmxvY2s7CisJfQorZXJyX3VubG9jazoKKwlkbWFfcmVzdl91bmxvY2soJnJlc3YpOwor
ZXJyX2ZyZWU6CisJZG1hX3Jlc3ZfZmluaSgmcmVzdik7CisJZG1hX2ZlbmNlX3B1dChmKTsKKwly
ZXR1cm4gcjsKK30KKworc3RhdGljIGludCB0ZXN0X2V4Y2xfc2lnbmFsaW5nKHZvaWQgKmFyZykK
K3sKKwlyZXR1cm4gdGVzdF9zaWduYWxpbmcoYXJnLCBmYWxzZSk7Cit9CisKK3N0YXRpYyBpbnQg
dGVzdF9zaGFyZWRfc2lnbmFsaW5nKHZvaWQgKmFyZykKK3sKKwlyZXR1cm4gdGVzdF9zaWduYWxp
bmcoYXJnLCB0cnVlKTsKK30KKworc3RhdGljIGludCB0ZXN0X2Zvcl9lYWNoKHZvaWQgKmFyZywg
Ym9vbCBzaGFyZWQpCit7CisJc3RydWN0IGRtYV9yZXN2X2l0ZXIgY3Vyc29yOworCXN0cnVjdCBk
bWFfZmVuY2UgKmYsICpmZW5jZTsKKwlzdHJ1Y3QgZG1hX3Jlc3YgcmVzdjsKKwlpbnQgcjsKKwor
CWYgPSBhbGxvY19mZW5jZSgpOworCWlmICghZikKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlkbWFf
cmVzdl9pbml0KCZyZXN2KTsKKwlyID0gZG1hX3Jlc3ZfbG9jaygmcmVzdiwgTlVMTCk7CisJaWYg
KHIpIHsKKwkJcHJfZXJyKCJSZXN2IGxvY2tpbmcgZmFpbGVkXG4iKTsKKwkJZ290byBlcnJfZnJl
ZTsKKwl9CisKKwlpZiAoc2hhcmVkKSB7CisJCXIgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZCgm
cmVzdiwgMSk7CisJCWlmIChyKSB7CisJCQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNsb3QgYWxsb2Nh
dGlvbiBmYWlsZWRcbiIpOworCQkJZ290byBlcnJfdW5sb2NrOworCQl9CisKKwkJZG1hX3Jlc3Zf
YWRkX3NoYXJlZF9mZW5jZSgmcmVzdiwgZik7CisJfSBlbHNlIHsKKwkJZG1hX3Jlc3ZfYWRkX2V4
Y2xfZmVuY2UoJnJlc3YsIGYpOworCX0KKworCXIgPSAtRU5PRU5UOworCWRtYV9yZXN2X2Zvcl9l
YWNoX2ZlbmNlKCZjdXJzb3IsICZyZXN2LCBzaGFyZWQsIGZlbmNlKSB7CisJCWlmICghcikgewor
CQkJcHJfZXJyKCJNb3JlIHRoYW4gb25lIGZlbmNlIGZvdW5kXG4iKTsKKwkJCXIgPSAtRUlOVkFM
OworCQkJZ290byBlcnJfdW5sb2NrOworCQl9CisJCWlmIChmICE9IGZlbmNlKSB7CisJCQlwcl9l
cnIoIlVuZXhwZWN0ZWQgZmVuY2VcbiIpOworCQkJciA9IC1FSU5WQUw7CisJCQlnb3RvIGVycl91
bmxvY2s7CisJCX0KKwkJaWYgKGRtYV9yZXN2X2l0ZXJfaXNfZXhjbHVzaXZlKCZjdXJzb3IpICE9
ICFzaGFyZWQpIHsKKwkJCXByX2VycigiVW5leHBlY3RlZCBmZW5jZSB1c2FnZVxuIik7CisJCQly
ID0gLUVJTlZBTDsKKwkJCWdvdG8gZXJyX3VubG9jazsKKwkJfQorCQlyID0gMDsKKwl9CisJaWYg
KHIpIHsKKwkJcHJfZXJyKCJObyBmZW5jZSBmb3VuZFxuIik7CisJCWdvdG8gZXJyX3VubG9jazsK
Kwl9CisJZG1hX2ZlbmNlX3NpZ25hbChmKTsKK2Vycl91bmxvY2s6CisJZG1hX3Jlc3ZfdW5sb2Nr
KCZyZXN2KTsKK2Vycl9mcmVlOgorCWRtYV9yZXN2X2ZpbmkoJnJlc3YpOworCWRtYV9mZW5jZV9w
dXQoZik7CisJcmV0dXJuIHI7Cit9CisKK3N0YXRpYyBpbnQgdGVzdF9leGNsX2Zvcl9lYWNoKHZv
aWQgKmFyZykKK3sKKwlyZXR1cm4gdGVzdF9mb3JfZWFjaChhcmcsIGZhbHNlKTsKK30KKworc3Rh
dGljIGludCB0ZXN0X3NoYXJlZF9mb3JfZWFjaCh2b2lkICphcmcpCit7CisJcmV0dXJuIHRlc3Rf
Zm9yX2VhY2goYXJnLCBmYWxzZSk7Cit9CisKK3N0YXRpYyBpbnQgdGVzdF9mb3JfZWFjaF91bmxv
Y2tlZCh2b2lkICphcmcsIGJvb2wgc2hhcmVkKQoreworCXN0cnVjdCBkbWFfcmVzdl9pdGVyIGN1
cnNvcjsKKwlzdHJ1Y3QgZG1hX2ZlbmNlICpmLCAqZmVuY2U7CisJc3RydWN0IGRtYV9yZXN2IHJl
c3Y7CisJaW50IHI7CisKKwlmID0gYWxsb2NfZmVuY2UoKTsKKwlpZiAoIWYpCisJCXJldHVybiAt
RU5PTUVNOworCisJZG1hX3Jlc3ZfaW5pdCgmcmVzdik7CisJciA9IGRtYV9yZXN2X2xvY2soJnJl
c3YsIE5VTEwpOworCWlmIChyKSB7CisJCXByX2VycigiUmVzdiBsb2NraW5nIGZhaWxlZFxuIik7
CisJCWdvdG8gZXJyX2ZyZWU7CisJfQorCisJaWYgKHNoYXJlZCkgeworCQlyID0gZG1hX3Jlc3Zf
cmVzZXJ2ZV9zaGFyZWQoJnJlc3YsIDEpOworCQlpZiAocikgeworCQkJcHJfZXJyKCJSZXN2IHNo
YXJlZCBzbG90IGFsbG9jYXRpb24gZmFpbGVkXG4iKTsKKwkJCWRtYV9yZXN2X3VubG9jaygmcmVz
dik7CisJCQlnb3RvIGVycl9mcmVlOworCQl9CisKKwkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5j
ZSgmcmVzdiwgZik7CisJfSBlbHNlIHsKKwkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UoJnJlc3Ys
IGYpOworCX0KKwlkbWFfcmVzdl91bmxvY2soJnJlc3YpOworCisJciA9IC1FTk9FTlQ7CisJZG1h
X3Jlc3ZfaXRlcl9iZWdpbigmY3Vyc29yLCAmcmVzdiwgc2hhcmVkKTsKKwlkbWFfcmVzdl9mb3Jf
ZWFjaF9mZW5jZV91bmxvY2tlZCgmY3Vyc29yLCBmZW5jZSkgeworCQlpZiAoIXIpIHsKKwkJCWRt
YV9yZXN2X2l0ZXJfZW5kKCZjdXJzb3IpOworCQkJcHJfZXJyKCJNb3JlIHRoYW4gb25lIGZlbmNl
IGZvdW5kXG4iKTsKKwkJCXIgPSAtRUlOVkFMOworCQkJZ290byBlcnJfZnJlZTsKKwkJfQorCQlp
ZiAoZiAhPSBmZW5jZSkgeworCQkJZG1hX3Jlc3ZfaXRlcl9lbmQoJmN1cnNvcik7CisJCQlwcl9l
cnIoIlVuZXhwZWN0ZWQgZmVuY2VcbiIpOworCQkJciA9IC1FSU5WQUw7CisJCQlnb3RvIGVycl9m
cmVlOworCQl9CisJCWlmIChkbWFfcmVzdl9pdGVyX2lzX2V4Y2x1c2l2ZSgmY3Vyc29yKSAhPSAh
c2hhcmVkKSB7CisJCQlkbWFfcmVzdl9pdGVyX2VuZCgmY3Vyc29yKTsKKwkJCXByX2VycigiVW5l
eHBlY3RlZCBmZW5jZSB1c2FnZVxuIik7CisJCQlyID0gLUVJTlZBTDsKKwkJCWdvdG8gZXJyX2Zy
ZWU7CisJCX0KKwkJciA9IDA7CisJfQorCWRtYV9yZXN2X2l0ZXJfZW5kKCZjdXJzb3IpOworCWlm
IChyKSB7CisJCXByX2VycigiTm8gZmVuY2UgZm91bmRcbiIpOworCQlnb3RvIGVycl9mcmVlOwor
CX0KKwlkbWFfZmVuY2Vfc2lnbmFsKGYpOworZXJyX2ZyZWU6CisJZG1hX3Jlc3ZfZmluaSgmcmVz
dik7CisJZG1hX2ZlbmNlX3B1dChmKTsKKwlyZXR1cm4gcjsKK30KKworc3RhdGljIGludCB0ZXN0
X2V4Y2xfZm9yX2VhY2hfdW5sb2NrZWQodm9pZCAqYXJnKQoreworCXJldHVybiB0ZXN0X2Zvcl9l
YWNoX3VubG9ja2VkKGFyZywgZmFsc2UpOworfQorCitzdGF0aWMgaW50IHRlc3Rfc2hhcmVkX2Zv
cl9lYWNoX3VubG9ja2VkKHZvaWQgKmFyZykKK3sKKwlyZXR1cm4gdGVzdF9mb3JfZWFjaF91bmxv
Y2tlZChhcmcsIHRydWUpOworfQorCitpbnQgZG1hX3Jlc3Yodm9pZCkKK3sKKwlzdGF0aWMgY29u
c3Qgc3RydWN0IHN1YnRlc3QgdGVzdHNbXSA9IHsKKwkJU1VCVEVTVChzYW5pdHljaGVjayksCisJ
CVNVQlRFU1QodGVzdF9leGNsX3NpZ25hbGluZyksCisJCVNVQlRFU1QodGVzdF9zaGFyZWRfc2ln
bmFsaW5nKSwKKwkJU1VCVEVTVCh0ZXN0X2V4Y2xfZm9yX2VhY2gpLAorCQlTVUJURVNUKHRlc3Rf
c2hhcmVkX2Zvcl9lYWNoKSwKKwkJU1VCVEVTVCh0ZXN0X2V4Y2xfZm9yX2VhY2hfdW5sb2NrZWQp
LAorCQlTVUJURVNUKHRlc3Rfc2hhcmVkX2Zvcl9lYWNoX3VubG9ja2VkKSwKKwl9OworCisJc3Bp
bl9sb2NrX2luaXQoJmZlbmNlX2xvY2spOworCXJldHVybiBzdWJ0ZXN0cyh0ZXN0cywgTlVMTCk7
Cit9Ci0tIAoyLjI1LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fCkxpbmFyby1tbS1zaWcgbWFpbGluZyBsaXN0CkxpbmFyby1tbS1zaWdAbGlzdHMubGlu
YXJvLm9yZwpodHRwczovL2xpc3RzLmxpbmFyby5vcmcvbWFpbG1hbi9saXN0aW5mby9saW5hcm8t
bW0tc2lnCg==
