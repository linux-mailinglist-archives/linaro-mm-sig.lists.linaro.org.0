Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id C10ED46BB5E
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  7 Dec 2021 13:35:32 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 2D9B962F97
	for <lists+linaro-mm-sig@lfdr.de>; Tue,  7 Dec 2021 12:35:31 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id B74E962D4E; Tue,  7 Dec 2021 12:35:24 +0000 (UTC)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 3D79D62DB0;
	Tue,  7 Dec 2021 12:35:20 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id 35D3A62169
 for <linaro-mm-sig@lists.linaro.org>; Tue,  7 Dec 2021 12:34:41 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id F10D661ECD; Tue,  7 Dec 2021 12:34:37 +0000 (UTC)
Received: from mail-wm1-f47.google.com (mail-wm1-f47.google.com
 [209.85.128.47])
 by lists.linaro.org (Postfix) with ESMTPS id DFBEA62D21
 for <linaro-mm-sig@lists.linaro.org>; Tue,  7 Dec 2021 12:34:32 +0000 (UTC)
Received: by mail-wm1-f47.google.com with SMTP id 137so10611609wma.1
 for <linaro-mm-sig@lists.linaro.org>; Tue, 07 Dec 2021 04:34:32 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=gmail.com; s=20210112;
 h=from:to:subject:date:message-id:in-reply-to:references:mime-version
 :content-transfer-encoding;
 bh=yNh3v5cxlYtv9AQjNhCzxQeCTZHQDmnOAXHeBYFgLFQ=;
 b=OCCaMGWhrt8YVF5sCrdUhA9tamqnAQeCQ9M0fl0IM0t9PJW3PXsO/t+uaWiF0s+/0e
 eOxYgu35IWooaE5Y55SxZB+KAusTIk3zG0c8zdbX6YFhHVVE7GLOSg/kvzUKUtqhgrS0
 fbtvxo5FON5NubI74ItRNmPvtW4gTRRhyJi9yVmdPeK3q+XPk7MntC6XAhrvmhYNJG73
 N0BXRhsrP3tCVN5LD6OvTsWh6jqUMeZE6OuJzuuMZaO3/Qf8auCU7wT+QWrYwL8ccNIB
 sND1mhkgO1qnhIyGR/phK5RErCuypaFMNZthrlF8ZY+HCsD1nNObIXL+CnN78evLtn6m
 jVlg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20210112;
 h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
 :references:mime-version:content-transfer-encoding;
 bh=yNh3v5cxlYtv9AQjNhCzxQeCTZHQDmnOAXHeBYFgLFQ=;
 b=mg0cZk+dpiK1g8FtczKxGwiMCNQGqVFBLYO6Bv0PSx6o1v3kbCTDZ3GZoSI9CAKc0q
 C+7mGCN5d+L5pnCUHFYfGbT3pKw3b6AI2C1JiF7vI20W83PIAggPM9VcgWBFU00qXcGA
 v3vdhth4GYm8jU61KyEK7XtvUPx+9WSRb5tjTy1xBLLwDbvcxocKr4mzUuUN6kn71p2H
 59F3XdADsyqmb3aMsydoF8g/pflmq3iB9068yZsTxTK1i+FK1I1lGPGbh1DtWlJNo5wH
 HVlBJukykxd1IHzbSxXRhhiIyz1Ch7ZkeVKIMD+40G8SA/lmeyisV4r5SMkr2LdCjFw0
 U9PQ==
X-Gm-Message-State: AOAM533dStsIYLOYY6gJiRO9FEp+C0c0XGJHntTTpd3jxW0N3BbIomBM
 BVeVHlhk+o9xdNnLnQ+193w=
X-Google-Smtp-Source: ABdhPJwm5RFFs4HA9SrQU/wrybtR0sDqMfg7yAw/cr6f1xUgjWdLgfKocJ+GzpXn2XpaNw1+iytJHQ==
X-Received: by 2002:a7b:c155:: with SMTP id z21mr6536887wmi.107.1638880471503; 
 Tue, 07 Dec 2021 04:34:31 -0800 (PST)
Received: from abel.fritz.box (p57b0bff8.dip0.t-ipconnect.de. [87.176.191.248])
 by smtp.gmail.com with ESMTPSA id f19sm2802203wmq.34.2021.12.07.04.34.28
 (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
 Tue, 07 Dec 2021 04:34:29 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?=
 <christian.koenig@amd.com>
To: daniel@ffwll.ch, dri-devel@lists.freedesktop.org,
 linux-media@vger.kernel.org, linaro-mm-sig@lists.linaro.org
Date: Tue,  7 Dec 2021 13:34:01 +0100
Message-Id: <20211207123411.167006-15-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20211207123411.167006-1-christian.koenig@amd.com>
References: <20211207123411.167006-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-Virus-Scanned: ClamAV using ClamSMTP
Subject: [Linaro-mm-sig] [PATCH 14/24] dma-buf/drivers: make reserving a
 shared slot mandatory v2
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

QXVkaXQgYWxsIHRoZSB1c2VycyBvZiBkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZSgpIGFuZCBtYWtl
IHN1cmUgdGhleQpyZXNlcnZlIGEgc2hhcmVkIHNsb3QgYWxzbyB3aGVuIG9ubHkgdHJ5aW5nIHRv
IGFkZCBhbiBleGNsdXNpdmUgZmVuY2UuCgpUaGlzIGlzIHRoZSBuZXh0IHN0ZXAgdG93YXJkcyBo
YW5kbGluZyB0aGUgZXhjbHVzaXZlIGZlbmNlIGxpa2UgYQpzaGFyZWQgb25lLgoKdjI6IGZpeCBt
aXNzZWQgY2FzZSBpbiBhbWRncHUKClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNo
cmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4KLS0tCiBkcml2ZXJzL2RtYS1idWYvc3QtZG1hLXJlc3Yu
YyAgICAgICAgICAgICAgICAgfCA2NCArKysrKysrKystLS0tLS0tLS0tCiBkcml2ZXJzL2dwdS9k
cm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMgICAgfCAgOCArKysKIGRyaXZlcnMvZ3B1L2Ry
bS9ldG5hdml2L2V0bmF2aXZfZ2VtX3N1Ym1pdC5jICB8ICA4ICstLQogZHJpdmVycy9ncHUvZHJt
L2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYyAgIHwgIDMgKy0KIC4uLi9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2V4ZWNidWZmZXIuYyAgICB8ICA4ICstLQogLi4uL2RybS9pOTE1L2dlbS9z
ZWxmdGVzdHMvaTkxNV9nZW1fbWlncmF0ZS5jIHwgIDUgKy0KIGRyaXZlcnMvZ3B1L2RybS9pOTE1
L2k5MTVfdm1hLmMgICAgICAgICAgICAgICB8ICA2ICsrCiAuLi4vZHJtL2k5MTUvc2VsZnRlc3Rz
L2ludGVsX21lbW9yeV9yZWdpb24uYyAgfCAgNyArKwogZHJpdmVycy9ncHUvZHJtL2xpbWEvbGlt
YV9nZW0uYyAgICAgICAgICAgICAgIHwgMTAgKystCiBkcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9n
ZW1fc3VibWl0LmMgICAgICAgICAgfCAxOCArKystLS0KIGRyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1
L25vdXZlYXVfZmVuY2UuYyAgICAgICB8ICA5ICstLQogZHJpdmVycy9ncHUvZHJtL3BhbmZyb3N0
L3BhbmZyb3N0X2pvYi5jICAgICAgIHwgIDQgKysKIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2Jv
X3V0aWwuYyAgICAgICAgICAgICB8IDEyICsrKy0KIGRyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2V4
ZWNidWZfdXRpbC5jICAgICAgICB8IDExICsrLS0KIGRyaXZlcnMvZ3B1L2RybS92M2QvdjNkX2dl
bS5jICAgICAgICAgICAgICAgICB8IDE1ICsrKy0tCiBkcml2ZXJzL2dwdS9kcm0vdmdlbS92Z2Vt
X2ZlbmNlLmMgICAgICAgICAgICAgfCAxMiArKy0tCiBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3Zp
cnRncHVfZ2VtLmMgICAgICAgICAgfCAgOSArKysKIGRyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13
Z2Z4X2JvLmMgICAgICAgICAgICB8IDE2ICsrKy0tCiAxOCBmaWxlcyBjaGFuZ2VkLCAxMzMgaW5z
ZXJ0aW9ucygrKSwgOTIgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZHJpdmVycy9kbWEtYnVm
L3N0LWRtYS1yZXN2LmMgYi9kcml2ZXJzL2RtYS1idWYvc3QtZG1hLXJlc3YuYwppbmRleCBjYmU5
OTljNmU3YTYuLmYzM2JhZmM3ODY5MyAxMDA2NDQKLS0tIGEvZHJpdmVycy9kbWEtYnVmL3N0LWRt
YS1yZXN2LmMKKysrIGIvZHJpdmVycy9kbWEtYnVmL3N0LWRtYS1yZXN2LmMKQEAgLTc1LDE3ICs3
NSwxNiBAQCBzdGF0aWMgaW50IHRlc3Rfc2lnbmFsaW5nKHZvaWQgKmFyZywgYm9vbCBzaGFyZWQp
CiAJCWdvdG8gZXJyX2ZyZWU7CiAJfQogCi0JaWYgKHNoYXJlZCkgewotCQlyID0gZG1hX3Jlc3Zf
cmVzZXJ2ZV9zaGFyZWQoJnJlc3YsIDEpOwotCQlpZiAocikgewotCQkJcHJfZXJyKCJSZXN2IHNo
YXJlZCBzbG90IGFsbG9jYXRpb24gZmFpbGVkXG4iKTsKLQkJCWdvdG8gZXJyX3VubG9jazsKLQkJ
fQorCXIgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZCgmcmVzdiwgMSk7CisJaWYgKHIpIHsKKwkJ
cHJfZXJyKCJSZXN2IHNoYXJlZCBzbG90IGFsbG9jYXRpb24gZmFpbGVkXG4iKTsKKwkJZ290byBl
cnJfdW5sb2NrOworCX0KIAorCWlmIChzaGFyZWQpCiAJCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVu
Y2UoJnJlc3YsIGYpOwotCX0gZWxzZSB7CisJZWxzZQogCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5j
ZSgmcmVzdiwgZik7Ci0JfQogCiAJaWYgKGRtYV9yZXN2X3Rlc3Rfc2lnbmFsZWQoJnJlc3YsIHNo
YXJlZCkpIHsKIAkJcHJfZXJyKCJSZXN2IHVuZXhwZWN0ZWRseSBzaWduYWxlZFxuIik7CkBAIC0x
MzQsMTcgKzEzMywxNiBAQCBzdGF0aWMgaW50IHRlc3RfZm9yX2VhY2godm9pZCAqYXJnLCBib29s
IHNoYXJlZCkKIAkJZ290byBlcnJfZnJlZTsKIAl9CiAKLQlpZiAoc2hhcmVkKSB7Ci0JCXIgPSBk
bWFfcmVzdl9yZXNlcnZlX3NoYXJlZCgmcmVzdiwgMSk7Ci0JCWlmIChyKSB7Ci0JCQlwcl9lcnIo
IlJlc3Ygc2hhcmVkIHNsb3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOwotCQkJZ290byBlcnJfdW5s
b2NrOwotCQl9CisJciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKCZyZXN2LCAxKTsKKwlpZiAo
cikgeworCQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNsb3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOwor
CQlnb3RvIGVycl91bmxvY2s7CisJfQogCisJaWYgKHNoYXJlZCkKIAkJZG1hX3Jlc3ZfYWRkX3No
YXJlZF9mZW5jZSgmcmVzdiwgZik7Ci0JfSBlbHNlIHsKKwllbHNlCiAJCWRtYV9yZXN2X2FkZF9l
eGNsX2ZlbmNlKCZyZXN2LCBmKTsKLQl9CiAKIAlyID0gLUVOT0VOVDsKIAlkbWFfcmVzdl9mb3Jf
ZWFjaF9mZW5jZSgmY3Vyc29yLCAmcmVzdiwgc2hhcmVkLCBmZW5jZSkgewpAQCAtMjA2LDE4ICsy
MDQsMTcgQEAgc3RhdGljIGludCB0ZXN0X2Zvcl9lYWNoX3VubG9ja2VkKHZvaWQgKmFyZywgYm9v
bCBzaGFyZWQpCiAJCWdvdG8gZXJyX2ZyZWU7CiAJfQogCi0JaWYgKHNoYXJlZCkgewotCQlyID0g
ZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoJnJlc3YsIDEpOwotCQlpZiAocikgewotCQkJcHJfZXJy
KCJSZXN2IHNoYXJlZCBzbG90IGFsbG9jYXRpb24gZmFpbGVkXG4iKTsKLQkJCWRtYV9yZXN2X3Vu
bG9jaygmcmVzdik7Ci0JCQlnb3RvIGVycl9mcmVlOwotCQl9CisJciA9IGRtYV9yZXN2X3Jlc2Vy
dmVfc2hhcmVkKCZyZXN2LCAxKTsKKwlpZiAocikgeworCQlwcl9lcnIoIlJlc3Ygc2hhcmVkIHNs
b3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOworCQlkbWFfcmVzdl91bmxvY2soJnJlc3YpOworCQln
b3RvIGVycl9mcmVlOworCX0KIAorCWlmIChzaGFyZWQpCiAJCWRtYV9yZXN2X2FkZF9zaGFyZWRf
ZmVuY2UoJnJlc3YsIGYpOwotCX0gZWxzZSB7CisJZWxzZQogCQlkbWFfcmVzdl9hZGRfZXhjbF9m
ZW5jZSgmcmVzdiwgZik7Ci0JfQogCWRtYV9yZXN2X3VubG9jaygmcmVzdik7CiAKIAlyID0gLUVO
T0VOVDsKQEAgLTI5MCwxOCArMjg3LDE3IEBAIHN0YXRpYyBpbnQgdGVzdF9nZXRfZmVuY2VzKHZv
aWQgKmFyZywgYm9vbCBzaGFyZWQpCiAJCWdvdG8gZXJyX3Jlc3Y7CiAJfQogCi0JaWYgKHNoYXJl
ZCkgewotCQlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoJnJlc3YsIDEpOwotCQlpZiAocikg
ewotCQkJcHJfZXJyKCJSZXN2IHNoYXJlZCBzbG90IGFsbG9jYXRpb24gZmFpbGVkXG4iKTsKLQkJ
CWRtYV9yZXN2X3VubG9jaygmcmVzdik7Ci0JCQlnb3RvIGVycl9yZXN2OwotCQl9CisJciA9IGRt
YV9yZXN2X3Jlc2VydmVfc2hhcmVkKCZyZXN2LCAxKTsKKwlpZiAocikgeworCQlwcl9lcnIoIlJl
c3Ygc2hhcmVkIHNsb3QgYWxsb2NhdGlvbiBmYWlsZWRcbiIpOworCQlkbWFfcmVzdl91bmxvY2so
JnJlc3YpOworCQlnb3RvIGVycl9yZXN2OworCX0KIAorCWlmIChzaGFyZWQpCiAJCWRtYV9yZXN2
X2FkZF9zaGFyZWRfZmVuY2UoJnJlc3YsIGYpOwotCX0gZWxzZSB7CisJZWxzZQogCQlkbWFfcmVz
dl9hZGRfZXhjbF9mZW5jZSgmcmVzdiwgZik7Ci0JfQogCWRtYV9yZXN2X3VubG9jaygmcmVzdik7
CiAKIAlyID0gZG1hX3Jlc3ZfZ2V0X2ZlbmNlcygmcmVzdiwgc2hhcmVkLCAmaSwgJmZlbmNlcyk7
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMg
Yi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMKaW5kZXggNGZjZmMy
MzEzYjhjLi4yNGE2Yjg4YWZjY2EgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9vYmplY3QuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRn
cHVfb2JqZWN0LmMKQEAgLTEzNjcsNiArMTM2NywxNCBAQCB2b2lkIGFtZGdwdV9ib19mZW5jZShz
dHJ1Y3QgYW1kZ3B1X2JvICpibywgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsCiAJCSAgICAgYm9v
bCBzaGFyZWQpCiB7CiAJc3RydWN0IGRtYV9yZXN2ICpyZXN2ID0gYm8tPnRiby5iYXNlLnJlc3Y7
CisJaW50IHI7CisKKwlyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQocmVzdiwgMSk7CisJaWYg
KHIpIHsKKwkJLyogQXMgbGFzdCByZXNvcnQgb24gT09NIHdlIGJsb2NrIGZvciB0aGUgZmVuY2Ug
Ki8KKwkJZG1hX2ZlbmNlX3dhaXQoZmVuY2UsIGZhbHNlKTsKKwkJcmV0dXJuOworCX0KIAogCWlm
IChzaGFyZWQpCiAJCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UocmVzdiwgZmVuY2UpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYwppbmRleCA0Mjg2ZGM5
M2ZkYWEuLmQ0YTcwNzMxOTBlYyAxMDA2NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYv
ZXRuYXZpdl9nZW1fc3VibWl0LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZp
dl9nZW1fc3VibWl0LmMKQEAgLTE3OSwxMSArMTc5LDkgQEAgc3RhdGljIGludCBzdWJtaXRfZmVu
Y2Vfc3luYyhzdHJ1Y3QgZXRuYXZpdl9nZW1fc3VibWl0ICpzdWJtaXQpCiAJCXN0cnVjdCBldG5h
dml2X2dlbV9zdWJtaXRfYm8gKmJvID0gJnN1Ym1pdC0+Ym9zW2ldOwogCQlzdHJ1Y3QgZG1hX3Jl
c3YgKnJvYmogPSBiby0+b2JqLT5iYXNlLnJlc3Y7CiAKLQkJaWYgKCEoYm8tPmZsYWdzICYgRVRO
QV9TVUJNSVRfQk9fV1JJVEUpKSB7Ci0JCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChy
b2JqLCAxKTsKLQkJCWlmIChyZXQpCi0JCQkJcmV0dXJuIHJldDsKLQkJfQorCQlyZXQgPSBkbWFf
cmVzdl9yZXNlcnZlX3NoYXJlZChyb2JqLCAxKTsKKwkJaWYgKHJldCkKKwkJCXJldHVybiByZXQ7
CiAKIAkJaWYgKHN1Ym1pdC0+ZmxhZ3MgJiBFVE5BX1NVQk1JVF9OT19JTVBMSUNJVCkKIAkJCWNv
bnRpbnVlOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2Ns
Zmx1c2guYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMKaW5k
ZXggZjA0MzVjNmZlYjY4Li5mYzU3YWI5MTRiNjAgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9jbGZsdXNoLmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUv
Z2VtL2k5MTVfZ2VtX2NsZmx1c2guYwpAQCAtMTAwLDcgKzEwMCw4IEBAIGJvb2wgaTkxNV9nZW1f
Y2xmbHVzaF9vYmplY3Qoc3RydWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwKIAl0cmFjZV9p
OTE1X2dlbV9vYmplY3RfY2xmbHVzaChvYmopOwogCiAJY2xmbHVzaCA9IE5VTEw7Ci0JaWYgKCEo
ZmxhZ3MgJiBJOTE1X0NMRkxVU0hfU1lOQykpCisJaWYgKCEoZmxhZ3MgJiBJOTE1X0NMRkxVU0hf
U1lOQykgJiYKKwkgICAgZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQob2JqLT5iYXNlLnJlc3YsIDEp
ID09IDApCiAJCWNsZmx1c2ggPSBjbGZsdXNoX3dvcmtfY3JlYXRlKG9iaik7CiAJaWYgKGNsZmx1
c2gpIHsKIAkJaTkxNV9zd19mZW5jZV9hd2FpdF9yZXNlcnZhdGlvbigmY2xmbHVzaC0+YmFzZS5j
aGFpbiwKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9pOTE1X2dlbV9leGVj
YnVmZmVyLmMgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5j
CmluZGV4IDRkN2RhMDc0NDJmMi4uZmMwZTE2MjU4NDdjIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fZXhlY2J1ZmZlci5jCisrKyBiL2RyaXZlcnMvZ3B1L2Ry
bS9pOTE1L2dlbS9pOTE1X2dlbV9leGVjYnVmZmVyLmMKQEAgLTk4OSwxMSArOTg5LDkgQEAgc3Rh
dGljIGludCBlYl92YWxpZGF0ZV92bWFzKHN0cnVjdCBpOTE1X2V4ZWNidWZmZXIgKmViKQogCQkJ
fQogCQl9CiAKLQkJaWYgKCEoZXYtPmZsYWdzICYgRVhFQ19PQkpFQ1RfV1JJVEUpKSB7Ci0JCQll
cnIgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZCh2bWEtPnJlc3YsIDEpOwotCQkJaWYgKGVycikK
LQkJCQlyZXR1cm4gZXJyOwotCQl9CisJCWVyciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKHZt
YS0+cmVzdiwgMSk7CisJCWlmIChlcnIpCisJCQlyZXR1cm4gZXJyOwogCiAJCUdFTV9CVUdfT04o
ZHJtX21tX25vZGVfYWxsb2NhdGVkKCZ2bWEtPm5vZGUpICYmCiAJCQkgICBlYl92bWFfbWlzcGxh
Y2VkKCZlYi0+ZXhlY1tpXSwgdm1hLCBldi0+ZmxhZ3MpKTsKZGlmZiAtLWdpdCBhL2RyaXZlcnMv
Z3B1L2RybS9pOTE1L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbWlncmF0ZS5jIGIvZHJpdmVycy9n
cHUvZHJtL2k5MTUvZ2VtL3NlbGZ0ZXN0cy9pOTE1X2dlbV9taWdyYXRlLmMKaW5kZXggMjhhNzAw
ZjA4YjQ5Li4yYmY0OTFmZDVjZGYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dl
bS9zZWxmdGVzdHMvaTkxNV9nZW1fbWlncmF0ZS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1
L2dlbS9zZWxmdGVzdHMvaTkxNV9nZW1fbWlncmF0ZS5jCkBAIC0xNzksNyArMTc5LDEwIEBAIHN0
YXRpYyBpbnQgaWd0X2xtZW1fcGFnZXNfbWlncmF0ZSh2b2lkICphcmcpCiAJCQkJCSAgaTkxNV9n
ZW1fb2JqZWN0X2lzX2xtZW0ob2JqKSwKIAkJCQkJICAweGRlYWRiZWFmLCAmcnEpOwogCQlpZiAo
cnEpIHsKLQkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKG9iai0+YmFzZS5yZXN2LCAmcnEtPmZl
bmNlKTsKKwkJCWVyciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKG9iai0+YmFzZS5yZXN2LCAx
KTsKKwkJCWlmICghZXJyKQorCQkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKG9iai0+YmFzZS5y
ZXN2LAorCQkJCQkJCSZycS0+ZmVuY2UpOwogCQkJaTkxNV9yZXF1ZXN0X3B1dChycSk7CiAJCX0K
IAkJaWYgKGVycikKZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCmluZGV4IGJlZjc5NWUyNjVhNi4uNWVj
ODdkZTYzOTYzIDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1X3ZtYS5jCisr
KyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5MTVfdm1hLmMKQEAgLTEyNTUsNiArMTI1NSwxMiBA
QCBpbnQgX2k5MTVfdm1hX21vdmVfdG9fYWN0aXZlKHN0cnVjdCBpOTE1X3ZtYSAqdm1hLAogCQkJ
aW50ZWxfZnJvbnRidWZmZXJfcHV0KGZyb250KTsKIAkJfQogCisJCWlmICghKGZsYWdzICYgX19F
WEVDX09CSkVDVF9OT19SRVNFUlZFKSkgeworCQkJZXJyID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFy
ZWQodm1hLT5yZXN2LCAxKTsKKwkJCWlmICh1bmxpa2VseShlcnIpKQorCQkJCXJldHVybiBlcnI7
CisJCX0KKwogCQlpZiAoZmVuY2UpIHsKIAkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHZtYS0+
cmVzdiwgZmVuY2UpOwogCQkJb2JqLT53cml0ZV9kb21haW4gPSBJOTE1X0dFTV9ET01BSU5fUkVO
REVSOwpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX21l
bW9yeV9yZWdpb24uYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1v
cnlfcmVnaW9uLmMKaW5kZXggNDE4Y2FhZTg0NzU5Li5iODVhZjE2NzJhN2UgMTAwNjQ0Ci0tLSBh
L2RyaXZlcnMvZ3B1L2RybS9pOTE1L3NlbGZ0ZXN0cy9pbnRlbF9tZW1vcnlfcmVnaW9uLmMKKysr
IGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvc2VsZnRlc3RzL2ludGVsX21lbW9yeV9yZWdpb24uYwpA
QCAtODk0LDYgKzg5NCwxMyBAQCBzdGF0aWMgaW50IGlndF9sbWVtX3dyaXRlX2NwdSh2b2lkICph
cmcpCiAJfQogCiAJaTkxNV9nZW1fb2JqZWN0X2xvY2sob2JqLCBOVUxMKTsKKworCWVyciA9IGRt
YV9yZXN2X3Jlc2VydmVfc2hhcmVkKG9iai0+YmFzZS5yZXN2LCAxKTsKKwlpZiAoZXJyKSB7CisJ
CWk5MTVfZ2VtX29iamVjdF91bmxvY2sob2JqKTsKKwkJZ290byBvdXRfcHV0OworCX0KKwogCS8q
IFB1dCB0aGUgcGFnZXMgaW50byBhIGtub3duIHN0YXRlIC0tIGZyb20gdGhlIGdwdSBmb3IgYWRk
ZWQgZnVuICovCiAJaW50ZWxfZW5naW5lX3BtX2dldChlbmdpbmUpOwogCWVyciA9IGludGVsX2Nv
bnRleHRfbWlncmF0ZV9jbGVhcihlbmdpbmUtPmd0LT5taWdyYXRlLmNvbnRleHQsIE5VTEwsCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbGltYS9saW1hX2dlbS5jIGIvZHJpdmVycy9ncHUv
ZHJtL2xpbWEvbGltYV9nZW0uYwppbmRleCBmOWE5MTk4ZWYxOTguLmI0ODQ2MDA3NDYzZiAxMDA2
NDQKLS0tIGEvZHJpdmVycy9ncHUvZHJtL2xpbWEvbGltYV9nZW0uYworKysgYi9kcml2ZXJzL2dw
dS9kcm0vbGltYS9saW1hX2dlbS5jCkBAIC0yNTUsMTMgKzI1NSwxMSBAQCBpbnQgbGltYV9nZW1f
Z2V0X2luZm8oc3RydWN0IGRybV9maWxlICpmaWxlLCB1MzIgaGFuZGxlLCB1MzIgKnZhLCB1NjQg
Km9mZnNldCkKIHN0YXRpYyBpbnQgbGltYV9nZW1fc3luY19ibyhzdHJ1Y3QgbGltYV9zY2hlZF90
YXNrICp0YXNrLCBzdHJ1Y3QgbGltYV9ibyAqYm8sCiAJCQkgICAgYm9vbCB3cml0ZSwgYm9vbCBl
eHBsaWNpdCkKIHsKLQlpbnQgZXJyID0gMDsKKwlpbnQgZXJyOwogCi0JaWYgKCF3cml0ZSkgewot
CQllcnIgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChsaW1hX2JvX3Jlc3YoYm8pLCAxKTsKLQkJ
aWYgKGVycikKLQkJCXJldHVybiBlcnI7Ci0JfQorCWVyciA9IGRtYV9yZXN2X3Jlc2VydmVfc2hh
cmVkKGxpbWFfYm9fcmVzdihibyksIDEpOworCWlmIChlcnIpCisJCXJldHVybiBlcnI7CiAKIAkv
KiBleHBsaWNpdCBzeW5jIHVzZSB1c2VyIHBhc3NlZCBkZXAgZmVuY2UgKi8KIAlpZiAoZXhwbGlj
aXQpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMKaW5kZXggM2NiMDI5ZjEwOTI1Li5l
ODc0ZDA5Yjc0ZWYgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dlbV9zdWJt
aXQuYworKysgYi9kcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMKQEAgLTMyMCwx
NiArMzIwLDE0IEBAIHN0YXRpYyBpbnQgc3VibWl0X2ZlbmNlX3N5bmMoc3RydWN0IG1zbV9nZW1f
c3VibWl0ICpzdWJtaXQsIGJvb2wgbm9faW1wbGljaXQpCiAJCXN0cnVjdCBkcm1fZ2VtX29iamVj
dCAqb2JqID0gJnN1Ym1pdC0+Ym9zW2ldLm9iai0+YmFzZTsKIAkJYm9vbCB3cml0ZSA9IHN1Ym1p
dC0+Ym9zW2ldLmZsYWdzICYgTVNNX1NVQk1JVF9CT19XUklURTsKIAotCQlpZiAoIXdyaXRlKSB7
Ci0JCQkvKiBOT1RFOiBfcmVzZXJ2ZV9zaGFyZWQoKSBtdXN0IGhhcHBlbiBiZWZvcmUKLQkJCSAq
IF9hZGRfc2hhcmVkX2ZlbmNlKCksIHdoaWNoIG1ha2VzIHRoaXMgYSBzbGlnaHRseQotCQkJICog
c3RyYW5nZSBwbGFjZSB0byBjYWxsIGl0LiAgT1RPSCB0aGlzIGlzIGEKLQkJCSAqIGNvbnZlbmll
bnQgY2FuLWZhaWwgcG9pbnQgdG8gaG9vayBpdCBpbi4KLQkJCSAqLwotCQkJcmV0ID0gZG1hX3Jl
c3ZfcmVzZXJ2ZV9zaGFyZWQob2JqLT5yZXN2LCAxKTsKLQkJCWlmIChyZXQpCi0JCQkJcmV0dXJu
IHJldDsKLQkJfQorCQkvKiBOT1RFOiBfcmVzZXJ2ZV9zaGFyZWQoKSBtdXN0IGhhcHBlbiBiZWZv
cmUKKwkJICogX2FkZF9zaGFyZWRfZmVuY2UoKSwgd2hpY2ggbWFrZXMgdGhpcyBhIHNsaWdodGx5
CisJCSAqIHN0cmFuZ2UgcGxhY2UgdG8gY2FsbCBpdC4gIE9UT0ggdGhpcyBpcyBhCisJCSAqIGNv
bnZlbmllbnQgY2FuLWZhaWwgcG9pbnQgdG8gaG9vayBpdCBpbi4KKwkJICovCisJCXJldCA9IGRt
YV9yZXN2X3Jlc2VydmVfc2hhcmVkKG9iai0+cmVzdiwgMSk7CisJCWlmIChyZXQpCisJCQlyZXR1
cm4gcmV0OwogCiAJCS8qIGV4Y2x1c2l2ZSBmZW5jZXMgbXVzdCBiZSBvcmRlcmVkICovCiAJCWlm
IChub19pbXBsaWNpdCAmJiAhd3JpdGUpCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91
dmVhdS9ub3V2ZWF1X2ZlbmNlLmMgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2Zl
bmNlLmMKaW5kZXggMjZmOTI5OWRmODgxLi5jZDY3MTViZDZkNmIgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS9ub3V2ZWF1L25vdXZlYXVfZmVuY2UuYworKysgYi9kcml2ZXJzL2dwdS9kcm0v
bm91dmVhdS9ub3V2ZWF1X2ZlbmNlLmMKQEAgLTM0OSwxMiArMzQ5LDkgQEAgbm91dmVhdV9mZW5j
ZV9zeW5jKHN0cnVjdCBub3V2ZWF1X2JvICpudmJvLCBzdHJ1Y3Qgbm91dmVhdV9jaGFubmVsICpj
aGFuLAogCXN0cnVjdCBub3V2ZWF1X2ZlbmNlICpmOwogCWludCByZXQ7CiAKLQlpZiAoIWV4Y2x1
c2l2ZSkgewotCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChyZXN2LCAxKTsKLQotCQlp
ZiAocmV0KQotCQkJcmV0dXJuIHJldDsKLQl9CisJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFy
ZWQocmVzdiwgMSk7CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKIAogCWRtYV9yZXN2X2Zvcl9l
YWNoX2ZlbmNlKCZjdXJzb3IsIHJlc3YsIGV4Y2x1c2l2ZSwgZmVuY2UpIHsKIAkJc3RydWN0IG5v
dXZlYXVfY2hhbm5lbCAqcHJldiA9IE5VTEw7CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0v
cGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMgYi9kcml2ZXJzL2dwdS9kcm0vcGFuZnJvc3QvcGFuZnJv
c3Rfam9iLmMKaW5kZXggOTA4ZDc5NTIwODUzLi44OWMzZmUzODk0NzYgMTAwNjQ0Ci0tLSBhL2Ry
aXZlcnMvZ3B1L2RybS9wYW5mcm9zdC9wYW5mcm9zdF9qb2IuYworKysgYi9kcml2ZXJzL2dwdS9k
cm0vcGFuZnJvc3QvcGFuZnJvc3Rfam9iLmMKQEAgLTI0Nyw2ICsyNDcsMTAgQEAgc3RhdGljIGlu
dCBwYW5mcm9zdF9hY3F1aXJlX29iamVjdF9mZW5jZXMoc3RydWN0IGRybV9nZW1fb2JqZWN0ICoq
Ym9zLAogCWludCBpLCByZXQ7CiAKIAlmb3IgKGkgPSAwOyBpIDwgYm9fY291bnQ7IGkrKykgewor
CQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJlZChib3NbaV0tPnJlc3YsIDEpOworCQlpZiAo
cmV0KQorCQkJcmV0dXJuIHJldDsKKwogCQkvKiBwYW5mcm9zdCBhbHdheXMgdXNlcyB3cml0ZSBt
b2RlIGluIGl0cyBjdXJyZW50IHVhcGkgKi8KIAkJcmV0ID0gZHJtX3NjaGVkX2pvYl9hZGRfaW1w
bGljaXRfZGVwZW5kZW5jaWVzKGpvYiwgYm9zW2ldLAogCQkJCQkJCSAgICAgIHRydWUpOwpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jIGIvZHJpdmVycy9ncHUv
ZHJtL3R0bS90dG1fYm9fdXRpbC5jCmluZGV4IDcyYTk0MzAxYmM5NS4uZWE5ZWFiY2MwYTBjIDEw
MDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9ib191dGlsLmMKKysrIGIvZHJpdmVy
cy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jCkBAIC0yMjEsOSArMjIxLDYgQEAgc3RhdGljIGlu
dCB0dG1fYnVmZmVyX29iamVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJv
LAogCiAJZmJvLT5iYXNlID0gKmJvOwogCi0JdHRtX2JvX2dldChibyk7Ci0JZmJvLT5ibyA9IGJv
OwotCiAJLyoqCiAJICogRml4IHVwIG1lbWJlcnMgdGhhdCB3ZSBzaG91bGRuJ3QgY29weSBkaXJl
Y3RseToKIAkgKiBUT0RPOiBFeHBsaWNpdCBtZW1iZXIgY29weSB3b3VsZCBwcm9iYWJseSBiZSBi
ZXR0ZXIgaGVyZS4KQEAgLTI0Niw2ICsyNDMsMTUgQEAgc3RhdGljIGludCB0dG1fYnVmZmVyX29i
amVjdF90cmFuc2ZlcihzdHJ1Y3QgdHRtX2J1ZmZlcl9vYmplY3QgKmJvLAogCXJldCA9IGRtYV9y
ZXN2X3RyeWxvY2soJmZiby0+YmFzZS5iYXNlLl9yZXN2KTsKIAlXQVJOX09OKCFyZXQpOwogCisJ
cmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoJmZiby0+YmFzZS5iYXNlLl9yZXN2LCAxKTsK
KwlpZiAocmV0KSB7CisJCWtmcmVlKGZibyk7CisJCXJldHVybiByZXQ7CisJfQorCisJdHRtX2Jv
X2dldChibyk7CisJZmJvLT5ibyA9IGJvOworCiAJdHRtX2JvX21vdmVfdG9fbHJ1X3RhaWxfdW5s
b2NrZWQoJmZiby0+YmFzZSk7CiAKIAkqbmV3X29iaiA9ICZmYm8tPmJhc2U7CmRpZmYgLS1naXQg
YS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYyBiL2RyaXZlcnMvZ3B1L2Ry
bS90dG0vdHRtX2V4ZWNidWZfdXRpbC5jCmluZGV4IDA3MWM0OGQ2NzJjNi4uNWRhOTIyNjM5ZDU0
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYworKysg
Yi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9leGVjYnVmX3V0aWwuYwpAQCAtOTAsNiArOTAsNyBA
QCBpbnQgdHRtX2V1X3Jlc2VydmVfYnVmZmVycyhzdHJ1Y3Qgd3dfYWNxdWlyZV9jdHggKnRpY2tl
dCwKIAogCWxpc3RfZm9yX2VhY2hfZW50cnkoZW50cnksIGxpc3QsIGhlYWQpIHsKIAkJc3RydWN0
IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IGVudHJ5LT5ibzsKKwkJdW5zaWduZWQgaW50IG51bV9m
ZW5jZXM7CiAKIAkJcmV0ID0gdHRtX2JvX3Jlc2VydmUoYm8sIGludHIsICh0aWNrZXQgPT0gTlVM
TCksIHRpY2tldCk7CiAJCWlmIChyZXQgPT0gLUVBTFJFQURZICYmIGR1cHMpIHsKQEAgLTEwMCwx
MiArMTAxLDEwIEBAIGludCB0dG1fZXVfcmVzZXJ2ZV9idWZmZXJzKHN0cnVjdCB3d19hY3F1aXJl
X2N0eCAqdGlja2V0LAogCQkJY29udGludWU7CiAJCX0KIAorCQludW1fZmVuY2VzID0gbWluKGVu
dHJ5LT5udW1fc2hhcmVkLCAxdSk7CiAJCWlmICghcmV0KSB7Ci0JCQlpZiAoIWVudHJ5LT5udW1f
c2hhcmVkKQotCQkJCWNvbnRpbnVlOwotCiAJCQlyZXQgPSBkbWFfcmVzdl9yZXNlcnZlX3NoYXJl
ZChiby0+YmFzZS5yZXN2LAotCQkJCQkJCQllbnRyeS0+bnVtX3NoYXJlZCk7CisJCQkJCQkgICAg
ICBudW1fZmVuY2VzKTsKIAkJCWlmICghcmV0KQogCQkJCWNvbnRpbnVlOwogCQl9CkBAIC0xMjAs
OSArMTE5LDkgQEAgaW50IHR0bV9ldV9yZXNlcnZlX2J1ZmZlcnMoc3RydWN0IHd3X2FjcXVpcmVf
Y3R4ICp0aWNrZXQsCiAJCQlyZXQgPSB0dG1fYm9fcmVzZXJ2ZV9zbG93cGF0aChibywgaW50ciwg
dGlja2V0KTsKIAkJfQogCi0JCWlmICghcmV0ICYmIGVudHJ5LT5udW1fc2hhcmVkKQorCQlpZiAo
IXJldCkKIAkJCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKGJvLT5iYXNlLnJlc3YsCi0J
CQkJCQkJCWVudHJ5LT5udW1fc2hhcmVkKTsKKwkJCQkJCSAgICAgIG51bV9mZW5jZXMpOwogCiAJ
CWlmICh1bmxpa2VseShyZXQgIT0gMCkpIHsKIAkJCWlmICh0aWNrZXQpIHsKZGlmZiAtLWdpdCBh
L2RyaXZlcnMvZ3B1L2RybS92M2QvdjNkX2dlbS5jIGIvZHJpdmVycy9ncHUvZHJtL3YzZC92M2Rf
Z2VtLmMKaW5kZXggYzdlZDJlMWNiYWI2Li4xYmVhOTBlNDBjZTEgMTAwNjQ0Ci0tLSBhL2RyaXZl
cnMvZ3B1L2RybS92M2QvdjNkX2dlbS5jCisrKyBiL2RyaXZlcnMvZ3B1L2RybS92M2QvdjNkX2dl
bS5jCkBAIC0yNTksMTYgKzI1OSwyMSBAQCB2M2RfbG9ja19ib19yZXNlcnZhdGlvbnMoc3RydWN0
IHYzZF9qb2IgKmpvYiwKIAkJcmV0dXJuIHJldDsKIAogCWZvciAoaSA9IDA7IGkgPCBqb2ItPmJv
X2NvdW50OyBpKyspIHsKKwkJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQoam9iLT5ib1tp
XS0+cmVzdiwgMSk7CisJCWlmIChyZXQpCisJCQlnb3RvIGZhaWw7CisKIAkJcmV0ID0gZHJtX3Nj
aGVkX2pvYl9hZGRfaW1wbGljaXRfZGVwZW5kZW5jaWVzKCZqb2ItPmJhc2UsCiAJCQkJCQkJICAg
ICAgam9iLT5ib1tpXSwgdHJ1ZSk7Ci0JCWlmIChyZXQpIHsKLQkJCWRybV9nZW1fdW5sb2NrX3Jl
c2VydmF0aW9ucyhqb2ItPmJvLCBqb2ItPmJvX2NvdW50LAotCQkJCQkJICAgIGFjcXVpcmVfY3R4
KTsKLQkJCXJldHVybiByZXQ7Ci0JCX0KKwkJaWYgKHJldCkKKwkJCWdvdG8gZmFpbDsKIAl9CiAK
IAlyZXR1cm4gMDsKKworZmFpbDoKKwlkcm1fZ2VtX3VubG9ja19yZXNlcnZhdGlvbnMoam9iLT5i
bywgam9iLT5ib19jb3VudCwgYWNxdWlyZV9jdHgpOworCXJldHVybiByZXQ7CiB9CiAKIC8qKgpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZnZW0vdmdlbV9mZW5jZS5jIGIvZHJpdmVycy9n
cHUvZHJtL3ZnZW0vdmdlbV9mZW5jZS5jCmluZGV4IGJkNmY3NTI4NWZkOS4uYTRjYjI5NmQ0ZmNk
IDEwMDY0NAotLS0gYS9kcml2ZXJzL2dwdS9kcm0vdmdlbS92Z2VtX2ZlbmNlLmMKKysrIGIvZHJp
dmVycy9ncHUvZHJtL3ZnZW0vdmdlbV9mZW5jZS5jCkBAIC0xNTcsMTIgKzE1NywxNCBAQCBpbnQg
dmdlbV9mZW5jZV9hdHRhY2hfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwKIAl9CiAKIAkv
KiBFeHBvc2UgdGhlIGZlbmNlIHZpYSB0aGUgZG1hLWJ1ZiAqLwotCXJldCA9IDA7CiAJZG1hX3Jl
c3ZfbG9jayhyZXN2LCBOVUxMKTsKLQlpZiAoYXJnLT5mbGFncyAmIFZHRU1fRkVOQ0VfV1JJVEUp
Ci0JCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHJlc3YsIGZlbmNlKTsKLQllbHNlIGlmICgocmV0
ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9zaGFyZWQocmVzdiwgMSkpID09IDApCi0JCWRtYV9yZXN2X2Fk
ZF9zaGFyZWRfZmVuY2UocmVzdiwgZmVuY2UpOworCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hh
cmVkKHJlc3YsIDEpOworCWlmICghcmV0KSB7CisJCWlmIChhcmctPmZsYWdzICYgVkdFTV9GRU5D
RV9XUklURSkKKwkJCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHJlc3YsIGZlbmNlKTsKKwkJZWxz
ZQorCQkJZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShyZXN2LCBmZW5jZSk7CisJfQogCWRtYV9y
ZXN2X3VubG9jayhyZXN2KTsKIAogCS8qIFJlY29yZCB0aGUgZmVuY2UgaW4gb3VyIGlkciBmb3Ig
bGF0ZXIgc2lnbmFsaW5nICovCmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3Zp
cnRncHVfZ2VtLmMgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZ2VtLmMKaW5kZXgg
MmRlNjFiNjNlZjkxLi5hZWMxMDVjZGQ2NGMgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92
aXJ0aW8vdmlydGdwdV9nZW0uYworKysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVf
Z2VtLmMKQEAgLTIxNCw2ICsyMTQsNyBAQCB2b2lkIHZpcnRpb19ncHVfYXJyYXlfYWRkX29iaihz
dHJ1Y3QgdmlydGlvX2dwdV9vYmplY3RfYXJyYXkgKm9ianMsCiAKIGludCB2aXJ0aW9fZ3B1X2Fy
cmF5X2xvY2tfcmVzdihzdHJ1Y3QgdmlydGlvX2dwdV9vYmplY3RfYXJyYXkgKm9ianMpCiB7CisJ
dW5zaWduZWQgaW50IGk7CiAJaW50IHJldDsKIAogCWlmIChvYmpzLT5uZW50cyA9PSAxKSB7CkBA
IC0yMjIsNiArMjIzLDE0IEBAIGludCB2aXJ0aW9fZ3B1X2FycmF5X2xvY2tfcmVzdihzdHJ1Y3Qg
dmlydGlvX2dwdV9vYmplY3RfYXJyYXkgKm9ianMpCiAJCXJldCA9IGRybV9nZW1fbG9ja19yZXNl
cnZhdGlvbnMob2Jqcy0+b2Jqcywgb2Jqcy0+bmVudHMsCiAJCQkJCQkmb2Jqcy0+dGlja2V0KTsK
IAl9CisJaWYgKHJldCkKKwkJcmV0dXJuIHJldDsKKworCWZvciAoaSA9IDA7IGkgPCBvYmpzLT5u
ZW50czsgKytpKSB7CisJCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfc2hhcmVkKG9ianMtPm9ianNb
aV0tPnJlc3YsIDEpOworCQlpZiAocmV0KQorCQkJcmV0dXJuIHJldDsKKwl9CiAJcmV0dXJuIHJl
dDsKIH0KIApkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYyBi
L2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMKaW5kZXggYzk3YTNkNWU5MGNlLi42
ZDBhYmMyYjBiZWIgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2Jv
LmMKKysrIGIvZHJpdmVycy9ncHUvZHJtL3Ztd2dmeC92bXdnZnhfYm8uYwpAQCAtMTA1MywxNiAr
MTA1MywyMiBAQCB2b2lkIHZtd19ib19mZW5jZV9zaW5nbGUoc3RydWN0IHR0bV9idWZmZXJfb2Jq
ZWN0ICpibywKIAkJCSBzdHJ1Y3Qgdm13X2ZlbmNlX29iaiAqZmVuY2UpCiB7CiAJc3RydWN0IHR0
bV9kZXZpY2UgKmJkZXYgPSBiby0+YmRldjsKLQogCXN0cnVjdCB2bXdfcHJpdmF0ZSAqZGV2X3By
aXYgPQogCQljb250YWluZXJfb2YoYmRldiwgc3RydWN0IHZtd19wcml2YXRlLCBiZGV2KTsKKwlp
bnQgcmV0OwogCi0JaWYgKGZlbmNlID09IE5VTEwpIHsKKwlpZiAoZmVuY2UgPT0gTlVMTCkKIAkJ
dm13X2V4ZWNidWZfZmVuY2VfY29tbWFuZHMoTlVMTCwgZGV2X3ByaXYsICZmZW5jZSwgTlVMTCk7
CisJZWxzZQorCQlkbWFfZmVuY2VfZ2V0KCZmZW5jZS0+YmFzZSk7CisKKwlyZXQgPSBkbWFfcmVz
dl9yZXNlcnZlX3NoYXJlZChiby0+YmFzZS5yZXN2LCAxKTsKKwlpZiAoIXJldCkKIAkJZG1hX3Jl
c3ZfYWRkX2V4Y2xfZmVuY2UoYm8tPmJhc2UucmVzdiwgJmZlbmNlLT5iYXNlKTsKLQkJZG1hX2Zl
bmNlX3B1dCgmZmVuY2UtPmJhc2UpOwotCX0gZWxzZQotCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5j
ZShiby0+YmFzZS5yZXN2LCAmZmVuY2UtPmJhc2UpOworCWVsc2UKKwkJLyogTGFzdCByZXNvcnQg
ZmFsbGJhY2sgd2hlbiB3ZSBhcmUgT09NICovCisJCWRtYV9mZW5jZV93YWl0KCZmZW5jZS0+YmFz
ZSwgZmFsc2UpOworCWRtYV9mZW5jZV9wdXQoJmZlbmNlLT5iYXNlKTsKIH0KIAogCi0tIAoyLjI1
LjEKCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbmFy
by1tbS1zaWcgbWFpbGluZyBsaXN0CkxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpodHRw
czovL2xpc3RzLmxpbmFyby5vcmcvbWFpbG1hbi9saXN0aW5mby9saW5hcm8tbW0tc2lnCg==
