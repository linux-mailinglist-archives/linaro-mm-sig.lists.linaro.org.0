Return-Path: <linaro-mm-sig-bounces@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [107.22.173.205])
	by mail.lfdr.de (Postfix) with ESMTPS id 7AC781B6D53
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 24 Apr 2020 07:37:15 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 88C2765FCD
	for <lists+linaro-mm-sig@lfdr.de>; Fri, 24 Apr 2020 05:37:14 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
	id 78F496602B; Fri, 24 Apr 2020 05:37:14 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.2 (2018-09-13) on lists.linaro.org
X-Spam-Level: 
X-Spam-Status: No, score=-5.2 required=5.0 tests=BAYES_00,MAILING_LIST_MULTI,
	RCVD_IN_DNSWL_MED,SPF_HELO_NONE autolearn=disabled version=3.4.2
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id F23BE66052;
	Fri, 24 Apr 2020 05:29:48 +0000 (UTC)
X-Original-To: linaro-mm-sig@lists.linaro.org
Delivered-To: linaro-mm-sig@lists.linaro.org
Received: from lists.linaro.org (localhost [127.0.0.1])
 by lists.linaro.org (Postfix) with ESMTP id D592766600
 for <linaro-mm-sig@lists.linaro.org>; Wed,  8 Apr 2020 12:00:56 +0000 (UTC)
Received: by lists.linaro.org (Postfix, from userid 109)
 id C54AA666D9; Wed,  8 Apr 2020 12:00:56 +0000 (UTC)
Received: from bombadil.infradead.org (bombadil.infradead.org
 [198.137.202.133])
 by lists.linaro.org (Postfix) with ESMTPS id 7FA7A66600
 for <linaro-mm-sig@lists.linaro.org>; Wed,  8 Apr 2020 12:00:16 +0000 (UTC)
Received: from [2001:4bb8:180:5765:65b6:f11e:f109:b151] (helo=localhost)
 by bombadil.infradead.org with esmtpsa (Exim 4.92.3 #3 (Red Hat Linux))
 id 1jM9Mv-0001oV-9e; Wed, 08 Apr 2020 11:59:45 +0000
From: Christoph Hellwig <hch@lst.de>
To: Andrew Morton <akpm@linux-foundation.org>,
 "K. Y. Srinivasan" <kys@microsoft.com>,
 Haiyang Zhang <haiyangz@microsoft.com>,
 Stephen Hemminger <sthemmin@microsoft.com>, Wei Liu <wei.liu@kernel.org>,
 x86@kernel.org, David Airlie <airlied@linux.ie>,
 Daniel Vetter <daniel@ffwll.ch>, Laura Abbott <labbott@redhat.com>,
 Sumit Semwal <sumit.semwal@linaro.org>,
 Sakari Ailus <sakari.ailus@linux.intel.com>,
 Minchan Kim <minchan@kernel.org>, Nitin Gupta <ngupta@vflare.org>
Date: Wed,  8 Apr 2020 13:59:03 +0200
Message-Id: <20200408115926.1467567-6-hch@lst.de>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20200408115926.1467567-1-hch@lst.de>
References: <20200408115926.1467567-1-hch@lst.de>
MIME-Version: 1.0
X-SRS-Rewrite: SMTP reverse-path rewritten from <hch@infradead.org> by
 bombadil.infradead.org. See http://www.infradead.org/rpr.html
X-Virus-Scanned: ClamAV using ClamSMTP
X-Mailman-Approved-At: Fri, 24 Apr 2020 05:29:38 +0000
Cc: Christophe Leroy <christophe.leroy@c-s.fr>, linux-arch@vger.kernel.org,
 linux-hyperv@vger.kernel.org, linux-s390@vger.kernel.org,
 Peter Zijlstra <peterz@infradead.org>, linuxppc-dev@lists.ozlabs.org,
 linux-kernel@vger.kernel.org, dri-devel@lists.freedesktop.org,
 linaro-mm-sig@lists.linaro.org, linux-mm@kvack.org,
 iommu@lists.linux-foundation.org, bpf@vger.kernel.org,
 Robin Murphy <robin.murphy@arm.com>, linux-arm-kernel@lists.infradead.org
Subject: [Linaro-mm-sig] [PATCH 05/28] powerpc: add an ioremap_phb helper
X-BeenThere: linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 2.1.16
Precedence: list
List-Id: "Unified memory management interest group."
 <linaro-mm-sig.lists.linaro.org>
List-Unsubscribe: <https://lists.linaro.org/mailman/options/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=unsubscribe>
List-Archive: <http://lists.linaro.org/pipermail/linaro-mm-sig/>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Subscribe: <https://lists.linaro.org/mailman/listinfo/linaro-mm-sig>,
 <mailto:linaro-mm-sig-request@lists.linaro.org?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: linaro-mm-sig-bounces@lists.linaro.org
Sender: "Linaro-mm-sig" <linaro-mm-sig-bounces@lists.linaro.org>
X-Virus-Scanned: ClamAV using ClamSMTP

RmFjdG9yIGNvZGUgc2hhcmVkIGJldHdlZW4gcGNpXzY0IGFuZCBlbGVjdHJhX2NmIGludG8gYSBp
b3JlbWFwX3BiaApoZWxwZXIgdGhhdCBmb2xsb3dzIHRoZSBub3JtYWwgaW9yZW1hcCBzZW1hbnRp
Y3MsIGFuZCByZXR1cm5zIGEKdXNlZnVsIF9faW9tZW0gcG9pbnRlci4gIE5vdGUgdGhhdCBpdCBv
cGVuY29kZXMgX19pb3JlbWFwX2F0IGFzCndlIGtub3cgZnJvbSB0aGUgY2FsbGVycyB0aGUgc2xh
YiBpcyBhdmFpbGFibGUuICBTd2l0Y2ggcGNpXzY0CnRvIGFsc28gc3RvcmUgdGhlIHJlc3VsdCBh
cyBfX2lvbWVtIHBvaW50ZXIsIGFuZCB1bm1hcCB0aGUgcmVzdWx0CnVzaW5nIGlvdW5tYXAgaW5z
dGVhZCBvZiBmb3JjZSBjYXN0aW5nIGFuZCB1c2luZyB2bWFsbG9jIEFQSXMuCgpTaWduZWQtb2Zm
LWJ5OiBDaHJpc3RvcGggSGVsbHdpZyA8aGNoQGxzdC5kZT4KLS0tCiBhcmNoL3Bvd2VycGMvaW5j
bHVkZS9hc20vaW8uaCAgICAgICAgIHwgIDIgKwogYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3Bj
aS1icmlkZ2UuaCB8ICAyICstCiBhcmNoL3Bvd2VycGMva2VybmVsL3BjaV82NC5jICAgICAgICAg
IHwgNTMgKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tCiBkcml2ZXJzL3BjbWNpYS9lbGVjdHJh
X2NmLmMgICAgICAgICAgIHwgNDUgKysrKysrKystLS0tLS0tLS0tLS0tLS0KIDQgZmlsZXMgY2hh
bmdlZCwgNTQgaW5zZXJ0aW9ucygrKSwgNDggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvYXJj
aC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmggYi9hcmNoL3Bvd2VycGMvaW5jbHVkZS9hc20vaW8u
aAppbmRleCA2MzU5NjliNWI1OGUuLjcxZjFjNWQ2OTgzOSAxMDA2NDQKLS0tIGEvYXJjaC9wb3dl
cnBjL2luY2x1ZGUvYXNtL2lvLmgKKysrIGIvYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL2lvLmgK
QEAgLTcxOSw2ICs3MTksOCBAQCB2b2lkIF9faW9tZW0gKmlvcmVtYXBfY29oZXJlbnQocGh5c19h
ZGRyX3QgYWRkcmVzcywgdW5zaWduZWQgbG9uZyBzaXplKTsKIAogZXh0ZXJuIHZvaWQgaW91bm1h
cCh2b2xhdGlsZSB2b2lkIF9faW9tZW0gKmFkZHIpOwogCit2b2lkIF9faW9tZW0gKmlvcmVtYXBf
cGJoKHBoeXNfYWRkcl90IHBhZGRyLCB1bnNpZ25lZCBsb25nIHNpemUpOworCiBpbnQgZWFybHlf
aW9yZW1hcF9yYW5nZSh1bnNpZ25lZCBsb25nIGVhLCBwaHlzX2FkZHJfdCBwYSwKIAkJCXVuc2ln
bmVkIGxvbmcgc2l6ZSwgcGdwcm90X3QgcHJvdCk7CiB2b2lkIF9faW9tZW0gKmRvX2lvcmVtYXAo
cGh5c19hZGRyX3QgcGEsIHBoeXNfYWRkcl90IG9mZnNldCwgdW5zaWduZWQgbG9uZyBzaXplLApk
aWZmIC0tZ2l0IGEvYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BjaS1icmlkZ2UuaCBiL2FyY2gv
cG93ZXJwYy9pbmNsdWRlL2FzbS9wY2ktYnJpZGdlLmgKaW5kZXggNjlmNGNiM2I3YzU2Li5iOTJl
ODFiMjU2ZTUgMTAwNjQ0Ci0tLSBhL2FyY2gvcG93ZXJwYy9pbmNsdWRlL2FzbS9wY2ktYnJpZGdl
LmgKKysrIGIvYXJjaC9wb3dlcnBjL2luY2x1ZGUvYXNtL3BjaS1icmlkZ2UuaApAQCAtNjYsNyAr
NjYsNyBAQCBzdHJ1Y3QgcGNpX2NvbnRyb2xsZXIgewogCiAJdm9pZCBfX2lvbWVtICppb19iYXNl
X3ZpcnQ7CiAjaWZkZWYgQ09ORklHX1BQQzY0Ci0Jdm9pZCAqaW9fYmFzZV9hbGxvYzsKKwl2b2lk
IF9faW9tZW0gKmlvX2Jhc2VfYWxsb2M7CiAjZW5kaWYKIAlyZXNvdXJjZV9zaXplX3QgaW9fYmFz
ZV9waHlzOwogCXJlc291cmNlX3NpemVfdCBwY2lfaW9fc2l6ZTsKZGlmZiAtLWdpdCBhL2FyY2gv
cG93ZXJwYy9rZXJuZWwvcGNpXzY0LmMgYi9hcmNoL3Bvd2VycGMva2VybmVsL3BjaV82NC5jCmlu
ZGV4IGY4M2QxZjY5YjFkZC4uOGU4NmJkOWMxZWNhIDEwMDY0NAotLS0gYS9hcmNoL3Bvd2VycGMv
a2VybmVsL3BjaV82NC5jCisrKyBiL2FyY2gvcG93ZXJwYy9rZXJuZWwvcGNpXzY0LmMKQEAgLTEw
OSwyMyArMTA5LDQ2IEBAIGludCBwY2liaW9zX3VubWFwX2lvX3NwYWNlKHN0cnVjdCBwY2lfYnVz
ICpidXMpCiAJLyogR2V0IHRoZSBob3N0IGJyaWRnZSAqLwogCWhvc2UgPSBwY2lfYnVzX3RvX2hv
c3QoYnVzKTsKIAotCS8qIENoZWNrIGlmIHdlIGhhdmUgSU9zIGFsbG9jYXRlZCAqLwotCWlmICho
b3NlLT5pb19iYXNlX2FsbG9jID09IE5VTEwpCi0JCXJldHVybiAwOwotCiAJcHJfZGVidWcoIklP
IHVubWFwcGluZyBmb3IgUEhCICVwT0ZcbiIsIGhvc2UtPmRuKTsKIAlwcl9kZWJ1ZygiICBhbGxv
Yz0weCVwXG4iLCBob3NlLT5pb19iYXNlX2FsbG9jKTsKIAotCS8qIFRoaXMgaXMgYSBQSEIsIHdl
IGZ1bGx5IHVubWFwIHRoZSBJTyBhcmVhICovCi0JdnVubWFwKGhvc2UtPmlvX2Jhc2VfYWxsb2Mp
OwotCisJaW91bm1hcChob3NlLT5pb19iYXNlX2FsbG9jKTsKIAlyZXR1cm4gMDsKIH0KIEVYUE9S
VF9TWU1CT0xfR1BMKHBjaWJpb3NfdW5tYXBfaW9fc3BhY2UpOwogCi1zdGF0aWMgaW50IHBjaWJp
b3NfbWFwX3BoYl9pb19zcGFjZShzdHJ1Y3QgcGNpX2NvbnRyb2xsZXIgKmhvc2UpCit2b2lkIF9f
aW9tZW0gKmlvcmVtYXBfcGJoKHBoeXNfYWRkcl90IHBhZGRyLCB1bnNpZ25lZCBsb25nIHNpemUp
CiB7CiAJc3RydWN0IHZtX3N0cnVjdCAqYXJlYTsKKwl1bnNpZ25lZCBsb25nIGFkZHI7CisKKwlX
QVJOX09OX09OQ0UocGFkZHIgJiB+UEFHRV9NQVNLKTsKKwlXQVJOX09OX09OQ0Uoc2l6ZSAmIH5Q
QUdFX01BU0spOworCisJLyoKKwkgKiBMZXQncyBhbGxvY2F0ZSBzb21lIElPIHNwYWNlIGZvciB0
aGF0IGd1eS4gV2UgZG9uJ3QgcGFzcyBWTV9JT1JFTUFQCisJICogYmVjYXVzZSB3ZSBkb24ndCBj
YXJlIGFib3V0IGFsaWdubWVudCB0cmlja3MgdGhhdCB0aGUgY29yZSBkb2VzIGluCisJICogdGhh
dCBjYXNlLiAgTWF5YmUgd2Ugc2hvdWxkIGR1ZSB0byBzdHVwaWQgY2FyZCB3aXRoIGluY29tcGxl
dGUKKwkgKiBhZGRyZXNzIGRlY29kaW5nIGJ1dCBJJ2QgcmF0aGVyIG5vdCBkZWFsIHdpdGggdGhv
c2Ugb3V0c2lkZSBvZiB0aGUKKwkgKiByZXNlcnZlZCA2NEsgbGVnYWN5IHJlZ2lvbi4KKwkgKi8K
KwlhcmVhID0gX19nZXRfdm1fYXJlYShzaXplLCAwLCBQSEJfSU9fQkFTRSwgUEhCX0lPX0VORCk7
CisJaWYgKCFhcmVhKQorCQlyZXR1cm4gTlVMTDsKKworCWFkZHIgPSAodW5zaWduZWQgbG9uZylh
cmVhLT5hZGRyOworCWlmIChpb3JlbWFwX3BhZ2VfcmFuZ2UoYWRkciwgYWRkciArIHNpemUsIHBh
ZGRyLAorCQkJcGdwcm90X25vbmNhY2hlZChQQUdFX0tFUk5FTCkpKSB7CisJCXVubWFwX2tlcm5l
bF9yYW5nZShhZGRyLCBzaXplKTsKKwkJcmV0dXJuIE5VTEw7CisJfQorCisJcmV0dXJuICh2b2lk
IF9faW9tZW0gKilhZGRyOworfQorRVhQT1JUX1NZTUJPTF9HUEwoaW9yZW1hcF9wYmgpOworCitz
dGF0aWMgaW50IHBjaWJpb3NfbWFwX3BoYl9pb19zcGFjZShzdHJ1Y3QgcGNpX2NvbnRyb2xsZXIg
Kmhvc2UpCit7CiAJdW5zaWduZWQgbG9uZyBwaHlzX3BhZ2U7CiAJdW5zaWduZWQgbG9uZyBzaXpl
X3BhZ2U7CiAJdW5zaWduZWQgbG9uZyBpb192aXJ0X29mZnNldDsKQEAgLTE0NiwxMiArMTY5LDEx
IEBAIHN0YXRpYyBpbnQgcGNpYmlvc19tYXBfcGhiX2lvX3NwYWNlKHN0cnVjdCBwY2lfY29udHJv
bGxlciAqaG9zZSkKIAkgKiB3aXRoIGluY29tcGxldGUgYWRkcmVzcyBkZWNvZGluZyBidXQgSSdk
IHJhdGhlciBub3QgZGVhbCB3aXRoCiAJICogdGhvc2Ugb3V0c2lkZSBvZiB0aGUgcmVzZXJ2ZWQg
NjRLIGxlZ2FjeSByZWdpb24uCiAJICovCi0JYXJlYSA9IF9fZ2V0X3ZtX2FyZWEoc2l6ZV9wYWdl
LCAwLCBQSEJfSU9fQkFTRSwgUEhCX0lPX0VORCk7Ci0JaWYgKGFyZWEgPT0gTlVMTCkKKwlob3Nl
LT5pb19iYXNlX2FsbG9jID0gaW9yZW1hcF9wYmgocGh5c19wYWdlLCBzaXplX3BhZ2UpOworCWlm
ICghaG9zZS0+aW9fYmFzZV9hbGxvYykKIAkJcmV0dXJuIC1FTk9NRU07Ci0JaG9zZS0+aW9fYmFz
ZV9hbGxvYyA9IGFyZWEtPmFkZHI7Ci0JaG9zZS0+aW9fYmFzZV92aXJ0ID0gKHZvaWQgX19pb21l
bSAqKShhcmVhLT5hZGRyICsKLQkJCQkJICAgICAgaG9zZS0+aW9fYmFzZV9waHlzIC0gcGh5c19w
YWdlKTsKKwlob3NlLT5pb19iYXNlX3ZpcnQgPSBob3NlLT5pb19iYXNlX2FsbG9jICsKKwkJCQlo
b3NlLT5pb19iYXNlX3BoeXMgLSBwaHlzX3BhZ2U7CiAKIAlwcl9kZWJ1ZygiSU8gbWFwcGluZyBm
b3IgUEhCICVwT0ZcbiIsIGhvc2UtPmRuKTsKIAlwcl9kZWJ1ZygiICBwaHlzPTB4JTAxNmxseCwg
dmlydD0weCVwIChhbGxvYz0weCVwKVxuIiwKQEAgLTE1OSwxMSArMTgxLDYgQEAgc3RhdGljIGlu
dCBwY2liaW9zX21hcF9waGJfaW9fc3BhY2Uoc3RydWN0IHBjaV9jb250cm9sbGVyICpob3NlKQog
CXByX2RlYnVnKCIgIHNpemU9MHglMDE2bGx4IChhbGxvYz0weCUwMTZseClcbiIsCiAJCSBob3Nl
LT5wY2lfaW9fc2l6ZSwgc2l6ZV9wYWdlKTsKIAotCS8qIEVzdGFibGlzaCB0aGUgbWFwcGluZyAq
LwotCWlmIChfX2lvcmVtYXBfYXQocGh5c19wYWdlLCBhcmVhLT5hZGRyLCBzaXplX3BhZ2UsCi0J
CQkgcGdwcm90X25vbmNhY2hlZChQQUdFX0tFUk5FTCkpID09IE5VTEwpCi0JCXJldHVybiAtRU5P
TUVNOwotCiAJLyogRml4dXAgaG9zZSBJTyByZXNvdXJjZSAqLwogCWlvX3ZpcnRfb2Zmc2V0ID0g
cGNpYmlvc19pb19zcGFjZV9vZmZzZXQoaG9zZSk7CiAJaG9zZS0+aW9fcmVzb3VyY2Uuc3RhcnQg
Kz0gaW9fdmlydF9vZmZzZXQ7CmRpZmYgLS1naXQgYS9kcml2ZXJzL3BjbWNpYS9lbGVjdHJhX2Nm
LmMgYi9kcml2ZXJzL3BjbWNpYS9lbGVjdHJhX2NmLmMKaW5kZXggZjI3NDFjMDQyODlkLi43N2Iy
MjlmOGQyMTggMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvcGNtY2lhL2VsZWN0cmFfY2YuYworKysgYi9k
cml2ZXJzL3BjbWNpYS9lbGVjdHJhX2NmLmMKQEAgLTE3OCwxMCArMTc4LDkgQEAgc3RhdGljIGlu
dCBlbGVjdHJhX2NmX3Byb2JlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKm9mZGV2KQogCXN0cnVj
dCBkZXZpY2Vfbm9kZSAqbnAgPSBvZmRldi0+ZGV2Lm9mX25vZGU7CiAJc3RydWN0IGVsZWN0cmFf
Y2Zfc29ja2V0ICAgKmNmOwogCXN0cnVjdCByZXNvdXJjZSBtZW0sIGlvOwotCWludCBzdGF0dXM7
CisJaW50IHN0YXR1cyA9IC1FTk9NRU07CiAJY29uc3QgdW5zaWduZWQgaW50ICpwcm9wOwogCWlu
dCBlcnI7Ci0Jc3RydWN0IHZtX3N0cnVjdCAqYXJlYTsKIAogCWVyciA9IG9mX2FkZHJlc3NfdG9f
cmVzb3VyY2UobnAsIDAsICZtZW0pOwogCWlmIChlcnIpCkBAIC0yMDIsMzAgKzIwMSwxOSBAQCBz
dGF0aWMgaW50IGVsZWN0cmFfY2ZfcHJvYmUoc3RydWN0IHBsYXRmb3JtX2RldmljZSAqb2ZkZXYp
CiAJY2YtPm1lbV9waHlzID0gbWVtLnN0YXJ0OwogCWNmLT5tZW1fc2l6ZSA9IFBBR0VfQUxJR04o
cmVzb3VyY2Vfc2l6ZSgmbWVtKSk7CiAJY2YtPm1lbV9iYXNlID0gaW9yZW1hcChjZi0+bWVtX3Bo
eXMsIGNmLT5tZW1fc2l6ZSk7CisJaWYgKCFjZi0+bWVtX2Jhc2UpCisJCWdvdG8gb3V0X2ZyZWVf
Y2Y7CiAJY2YtPmlvX3NpemUgPSBQQUdFX0FMSUdOKHJlc291cmNlX3NpemUoJmlvKSk7Ci0KLQlh
cmVhID0gX19nZXRfdm1fYXJlYShjZi0+aW9fc2l6ZSwgMCwgUEhCX0lPX0JBU0UsIFBIQl9JT19F
TkQpOwotCWlmIChhcmVhID09IE5VTEwpIHsKLQkJc3RhdHVzID0gLUVOT01FTTsKLQkJZ290byBm
YWlsMTsKLQl9Ci0KLQljZi0+aW9fdmlydCA9ICh2b2lkIF9faW9tZW0gKikoYXJlYS0+YWRkcik7
CisJY2YtPmlvX3ZpcnQgPSBpb3JlbWFwX3BiaChpby5zdGFydCwgY2YtPmlvX3NpemUpOworCWlm
ICghY2YtPmlvX3ZpcnQpCisJCWdvdG8gb3V0X3VubWFwX21lbTsKIAogCWNmLT5ncGlvX2Jhc2Ug
PSBpb3JlbWFwKDB4ZmMxMDMwMDAsIDB4MTAwMCk7CisJaWYgKCFjZi0+Z3Bpb19iYXNlKQorCQln
b3RvIG91dF91bm1hcF92aXJ0OwogCWRldl9zZXRfZHJ2ZGF0YShkZXZpY2UsIGNmKTsKIAotCWlm
ICghY2YtPm1lbV9iYXNlIHx8ICFjZi0+aW9fdmlydCB8fCAhY2YtPmdwaW9fYmFzZSB8fAotCSAg
ICAoX19pb3JlbWFwX2F0KGlvLnN0YXJ0LCBjZi0+aW9fdmlydCwgY2YtPmlvX3NpemUsCi0JCQkg
IHBncHJvdF9ub25jYWNoZWQoUEFHRV9LRVJORUwpKSA9PSBOVUxMKSkgewotCQlkZXZfZXJyKGRl
dmljZSwgImNhbid0IGlvcmVtYXAgcmFuZ2VzXG4iKTsKLQkJc3RhdHVzID0gLUVOT01FTTsKLQkJ
Z290byBmYWlsMTsKLQl9Ci0KLQogCWNmLT5pb19iYXNlID0gKHVuc2lnbmVkIGxvbmcpY2YtPmlv
X3ZpcnQgLSBWTUFMTE9DX0VORDsKLQogCWNmLT5pb21lbS5zdGFydCA9ICh1bnNpZ25lZCBsb25n
KWNmLT5tZW1fYmFzZTsKIAljZi0+aW9tZW0uZW5kID0gKHVuc2lnbmVkIGxvbmcpY2YtPm1lbV9i
YXNlICsgKG1lbS5lbmQgLSBtZW0uc3RhcnQpOwogCWNmLT5pb21lbS5mbGFncyA9IElPUkVTT1VS
Q0VfTUVNOwpAQCAtMzA1LDE0ICsyOTMsMTMgQEAgc3RhdGljIGludCBlbGVjdHJhX2NmX3Byb2Jl
KHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKm9mZGV2KQogCWlmIChjZi0+aXJxKQogCQlmcmVlX2ly
cShjZi0+aXJxLCBjZik7CiAKLQlpZiAoY2YtPmlvX3ZpcnQpCi0JCV9faW91bm1hcF9hdChjZi0+
aW9fdmlydCwgY2YtPmlvX3NpemUpOwotCWlmIChjZi0+bWVtX2Jhc2UpCi0JCWlvdW5tYXAoY2Yt
Pm1lbV9iYXNlKTsKLQlpZiAoY2YtPmdwaW9fYmFzZSkKLQkJaW91bm1hcChjZi0+Z3Bpb19iYXNl
KTsKLQlpZiAoYXJlYSkKLQkJZGV2aWNlX2luaXRfd2FrZXVwKCZvZmRldi0+ZGV2LCAwKTsKKwlp
b3VubWFwKGNmLT5ncGlvX2Jhc2UpOworb3V0X3VubWFwX3ZpcnQ6CisJZGV2aWNlX2luaXRfd2Fr
ZXVwKCZvZmRldi0+ZGV2LCAwKTsKKwlpb3VubWFwKGNmLT5pb192aXJ0KTsKK291dF91bm1hcF9t
ZW06CisJaW91bm1hcChjZi0+bWVtX2Jhc2UpOworb3V0X2ZyZWVfY2Y6CiAJa2ZyZWUoY2YpOwog
CXJldHVybiBzdGF0dXM7CiAKQEAgLTMzMCw3ICszMTcsNyBAQCBzdGF0aWMgaW50IGVsZWN0cmFf
Y2ZfcmVtb3ZlKHN0cnVjdCBwbGF0Zm9ybV9kZXZpY2UgKm9mZGV2KQogCWZyZWVfaXJxKGNmLT5p
cnEsIGNmKTsKIAlkZWxfdGltZXJfc3luYygmY2YtPnRpbWVyKTsKIAotCV9faW91bm1hcF9hdChj
Zi0+aW9fdmlydCwgY2YtPmlvX3NpemUpOworCWlvdW5tYXAoY2YtPmlvX3ZpcnQpOwogCWlvdW5t
YXAoY2YtPm1lbV9iYXNlKTsKIAlpb3VubWFwKGNmLT5ncGlvX2Jhc2UpOwogCXJlbGVhc2VfbWVt
X3JlZ2lvbihjZi0+bWVtX3BoeXMsIGNmLT5tZW1fc2l6ZSk7Ci0tIAoyLjI1LjEKCl9fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCkxpbmFyby1tbS1zaWcgbWFp
bGluZyBsaXN0CkxpbmFyby1tbS1zaWdAbGlzdHMubGluYXJvLm9yZwpodHRwczovL2xpc3RzLmxp
bmFyby5vcmcvbWFpbG1hbi9saXN0aW5mby9saW5hcm8tbW0tc2lnCg==
