Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 6F8FC4B8067
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 16 Feb 2022 07:15:40 +0100 (CET)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id A60783EE90
	for <lists+linaro-mm-sig@lfdr.de>; Wed, 16 Feb 2022 06:15:39 +0000 (UTC)
Received: from mail-ed1-f46.google.com (mail-ed1-f46.google.com [209.85.208.46])
	by lists.linaro.org (Postfix) with ESMTPS id ECC513EEC6
	for <linaro-mm-sig@lists.linaro.org>; Fri, 11 Feb 2022 12:50:22 +0000 (UTC)
Received: by mail-ed1-f46.google.com with SMTP id ch26so16206892edb.12
        for <linaro-mm-sig@lists.linaro.org>; Fri, 11 Feb 2022 04:50:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20210112;
        h=from:to:subject:date:message-id:in-reply-to:references:mime-version
         :content-transfer-encoding;
        bh=EQgefwg/ddLV5zisEgajIUlyv7b4U6dHD72L4/xsNlc=;
        b=L+beR/6LjY6abHXHTzOxQhkiNWp3ccOtI0hRm5Root8SCXblRw6duBS8HcGsacGfzy
         J/wYfsnwwduxbOOHgxxxNq85khZJ7s6NLyZ+qz9i+rhxOYUBBRbTOHNhgbozyuavcsw0
         eQFQDNfvV+iN9lQ7Pp7lEiLaKH9aZGArokjapDtoAuvXFj8QWZzx8s0g8mqornU1iuff
         hatKrf0qUeNew3Hq3O1wv6zFmgMQDcBVGbOxKIgbFtkrbbU72YwhY+7F6R7knYdI7Kdl
         KfO6YxWn6w7ZXtJ9d60nsnCfjdFPjV7GIkNX9XJdFMjB8sm6GZ2yrI5P0lsFEecEE8d0
         BE4g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20210112;
        h=x-gm-message-state:from:to:subject:date:message-id:in-reply-to
         :references:mime-version:content-transfer-encoding;
        bh=EQgefwg/ddLV5zisEgajIUlyv7b4U6dHD72L4/xsNlc=;
        b=O3pwURmhs8a59f8ZbiR5U1gOTHQqHJtCistI0K6XSaYWRqhEG8CRIHAxfmQd+WVHor
         tUHVwzlYyp6g0ak5I+yHv0vVoEBRU9cIGUiczulhckSuLahRouOPi+Oc56FUDwN25snj
         vPIQBFB3l9UHzQpQj4xaYNE1tNoDTRDwFhmNc60/trxjHWF/ZUvbxhq6ESxRUYRkk9EL
         sjotnbuyg6YyMFu7cm2S1LgcizYE7ts/+OW56zHhzKm2Dx/UTBcY3dBvqG363+ergOVz
         HVokwYF0xPXdbCtikCyLKmwGFKq+8Tih9myunrmW48VGLujfO4zMHgdHhwKKRbdrC97y
         glrA==
X-Gm-Message-State: AOAM533UvYXXlH9oEEMG35tLGO4EKyXklnnKgOrY3O4Nb/6yk57gem+R
	dKdm/zcYSWdj/kNNMNqVbcE=
X-Google-Smtp-Source: ABdhPJzaeDOTwfOLB4VO3Xqv9X6oNwmgXbx/WXmXeA7h5qMDiG4h2WfqNYraPiS0htL/Q59YQVGReg==
X-Received: by 2002:a05:6402:1a31:: with SMTP id be17mr1765488edb.360.1644583821632;
        Fri, 11 Feb 2022 04:50:21 -0800 (PST)
Received: from able.fritz.box (p57b0bff8.dip0.t-ipconnect.de. [87.176.191.248])
        by smtp.gmail.com with ESMTPSA id w22sm7868604ejc.137.2022.02.11.04.50.20
        (version=TLS1_3 cipher=TLS_AES_256_GCM_SHA384 bits=256/256);
        Fri, 11 Feb 2022 04:50:21 -0800 (PST)
From: "=?UTF-8?q?Christian=20K=C3=B6nig?=" <ckoenig.leichtzumerken@gmail.com>
X-Google-Original-From: =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>
To: daniel@ffwll.ch,
	sumit.semwal@linaro.org,
	dri-devel@lists.freedesktop.org,
	linaro-mm-sig@lists.linaro.org
Date: Fri, 11 Feb 2022 13:49:57 +0100
Message-Id: <20220211125003.918447-18-christian.koenig@amd.com>
X-Mailer: git-send-email 2.25.1
In-Reply-To: <20220211125003.918447-1-christian.koenig@amd.com>
References: <20220211125003.918447-1-christian.koenig@amd.com>
MIME-Version: 1.0
X-MailFrom: ckoenig.leichtzumerken@gmail.com
X-Mailman-Rule-Hits: max-size
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; news-moderation; no-subject; digests; suspicious-header
Message-ID-Hash: 6DS6UU7YCWLHADSVO43AVR2RHPGSPKC2
X-Message-ID-Hash: 6DS6UU7YCWLHADSVO43AVR2RHPGSPKC2
X-Mailman-Approved-At: Wed, 16 Feb 2022 06:15:30 +0000
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 17/23] dma-buf: specify usage while adding fences to dma_resv obj v4
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/6DS6UU7YCWLHADSVO43AVR2RHPGSPKC2/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

SW5zdGVhZCBvZiBkaXN0aW5ndGluZyBiZXR3ZWVuIHNoYXJlZCBhbmQgZXhjbHVzaXZlIGZlbmNl
cyBzcGVjaWZ5DQp0aGUgZmVuY2UgdXNhZ2Ugd2hpbGUgYWRkaW5nIGZlbmNlcy4NCg0KUmV3b3Jr
IGFsbCBkcml2ZXJzIHRvIHVzZSB0aGlzIGludGVyZmFjZSBpbnN0ZWFkIGFuZCBkZXByZWNhdGUg
dGhlIG9sZCBvbmUuDQoNCnYyOiBzb21lIGtlcm5lbGRvYyBjb21tZW50cyBzdWdnZXN0ZWQgYnkg
RGFuaWVsDQp2MzogZml4IGEgbWlzc2luZyBjYXNlIGluIHJhZGVvbg0KdjQ6IHJlYmFzZSBvbiBu
b3V2ZWF1IGNoYW5nZXMsIGZpeCBsb2NrZGVwIGFuZCB0ZW1wb3JhcnkgZGlzYWJsZSB3YXJuaW5n
DQoNClNpZ25lZC1vZmYtYnk6IENocmlzdGlhbiBLw7ZuaWcgPGNocmlzdGlhbi5rb2VuaWdAYW1k
LmNvbT4NCi0tLQ0KIGRyaXZlcnMvZG1hLWJ1Zi9kbWEtcmVzdi5jICAgICAgICAgICAgICAgICAg
ICB8IDM0NSArKysrKysrKy0tLS0tLS0tLS0NCiBkcml2ZXJzL2RtYS1idWYvc3QtZG1hLXJlc3Yu
YyAgICAgICAgICAgICAgICAgfCAxMDEgKystLS0NCiAuLi4vZ3B1L2RybS9hbWQvYW1kZ3B1L2Ft
ZGdwdV9hbWRrZmRfZ3B1dm0uYyAgfCAgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfY3MuYyAgICAgICAgfCAgIDYgKy0NCiBkcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdw
dS9hbWRncHVfb2JqZWN0LmMgICAgfCAgIDYgKy0NCiBkcml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9l
dG5hdml2X2dlbV9zdWJtaXQuYyAgfCAgMTAgKy0NCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fYnVzeS5jICAgICAgfCAgMTMgKy0NCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fY2xmbHVzaC5jICAgfCAgIDMgKy0NCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0v
aTkxNV9nZW1fdHRtX21vdmUuYyAgfCAgIDUgKy0NCiBkcml2ZXJzL2dwdS9kcm0vaTkxNS9pOTE1
X3ZtYS5jICAgICAgICAgICAgICAgfCAgIDYgKy0NCiBkcml2ZXJzL2dwdS9kcm0vbGltYS9saW1h
X2dlbS5jICAgICAgICAgICAgICAgfCAgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vbXNtL21zbV9n
ZW1fc3VibWl0LmMgICAgICAgICAgfCAgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9u
b3V2ZWF1X2JvLmMgICAgICAgICAgfCAgIDkgKy0NCiBkcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9u
b3V2ZWF1X2ZlbmNlLmMgICAgICAgfCAgIDQgKy0NCiBkcml2ZXJzL2dwdS9kcm0vcXhsL3F4bF9y
ZWxlYXNlLmMgICAgICAgICAgICAgfCAgIDMgKy0NCiBkcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3Jh
ZGVvbl9vYmplY3QuYyAgICAgICAgfCAgIDYgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9i
by5jICAgICAgICAgICAgICAgICAgfCAgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9i
b191dGlsLmMgICAgICAgICAgICAgfCAgIDUgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9l
eGVjYnVmX3V0aWwuYyAgICAgICAgfCAgIDYgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdjNkL3YzZF9n
ZW0uYyAgICAgICAgICAgICAgICAgfCAgIDQgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9n
ZW0uYyAgICAgICAgICAgICAgICAgfCAgIDIgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdmdlbS92Z2Vt
X2ZlbmNlLmMgICAgICAgICAgICAgfCAgIDkgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdmlydGlvL3Zp
cnRncHVfZ2VtLmMgICAgICAgICAgfCAgIDMgKy0NCiBkcml2ZXJzL2dwdS9kcm0vdm13Z2Z4L3Zt
d2dmeF9iby5jICAgICAgICAgICAgfCAgIDMgKy0NCiBpbmNsdWRlL2xpbnV4L2RtYS1yZXN2Lmgg
ICAgICAgICAgICAgICAgICAgICAgfCAgNzIgKystLQ0KIDI1IGZpbGVzIGNoYW5nZWQsIDI2OSBp
bnNlcnRpb25zKCspLCAzNjAgZGVsZXRpb25zKC0pDQoNCmRpZmYgLS1naXQgYS9kcml2ZXJzL2Rt
YS1idWYvZG1hLXJlc3YuYyBiL2RyaXZlcnMvZG1hLWJ1Zi9kbWEtcmVzdi5jDQppbmRleCAwMTgw
MzQ4ZjMyZjguLjgyMWVmNDdjM2EyNCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9kbWEt
cmVzdi5jDQorKysgYi9kcml2ZXJzL2RtYS1idWYvZG1hLXJlc3YuYw0KQEAgLTQ0LDEyICs0NCwx
MiBAQA0KIC8qKg0KICAqIERPQzogUmVzZXJ2YXRpb24gT2JqZWN0IE92ZXJ2aWV3DQogICoNCi0g
KiBUaGUgcmVzZXJ2YXRpb24gb2JqZWN0IHByb3ZpZGVzIGEgbWVjaGFuaXNtIHRvIG1hbmFnZSBz
aGFyZWQgYW5kDQotICogZXhjbHVzaXZlIGZlbmNlcyBhc3NvY2lhdGVkIHdpdGggYSBidWZmZXIu
ICBBIHJlc2VydmF0aW9uIG9iamVjdA0KLSAqIGNhbiBoYXZlIGF0dGFjaGVkIG9uZSBleGNsdXNp
dmUgZmVuY2UgKG5vcm1hbGx5IGFzc29jaWF0ZWQgd2l0aA0KLSAqIHdyaXRlIG9wZXJhdGlvbnMp
IG9yIE4gc2hhcmVkIGZlbmNlcyAocmVhZCBvcGVyYXRpb25zKS4gIFRoZSBSQ1UNCi0gKiBtZWNo
YW5pc20gaXMgdXNlZCB0byBwcm90ZWN0IHJlYWQgYWNjZXNzIHRvIGZlbmNlcyBmcm9tIGxvY2tl
ZA0KLSAqIHdyaXRlLXNpZGUgdXBkYXRlcy4NCisgKiBUaGUgcmVzZXJ2YXRpb24gb2JqZWN0IHBy
b3ZpZGVzIGEgbWVjaGFuaXNtIHRvIG1hbmFnZSBhIGNvbnRhaW5lciBvZg0KKyAqIGRtYV9mZW5j
ZSBvYmplY3QgYXNzb2NpYXRlZCB3aXRoIGEgcmVzb3VyY2UuIEEgcmVzZXJ2YXRpb24gb2JqZWN0
DQorICogY2FuIGhhdmUgYW55IG51bWJlciBvZiBmZW5jZXMgYXR0YWNoZXMgdG8gaXQuIEVhY2gg
ZmVuY2UgY2FycmluZyBhbiB1c2FnZQ0KKyAqIHBhcmFtZXRlciBkZXRlcm1pbmluZyBob3cgdGhl
IG9wZXJhdGlvbiByZXByZXNlbnRlZCBieSB0aGUgZmVuY2UgaXMgdXNpbmcgdGhlDQorICogcmVz
b3VyY2UuIFRoZSBSQ1UgbWVjaGFuaXNtIGlzIHVzZWQgdG8gcHJvdGVjdCByZWFkIGFjY2VzcyB0
byBmZW5jZXMgZnJvbQ0KKyAqIGxvY2tlZCB3cml0ZS1zaWRlIHVwZGF0ZXMuDQogICoNCiAgKiBT
ZWUgc3RydWN0IGRtYV9yZXN2IGZvciBtb3JlIGRldGFpbHMuDQogICovDQpAQCAtNTcsMjkgKzU3
LDc0IEBADQogREVGSU5FX1dEX0NMQVNTKHJlc2VydmF0aW9uX3d3X2NsYXNzKTsNCiBFWFBPUlRf
U1lNQk9MKHJlc2VydmF0aW9uX3d3X2NsYXNzKTsNCiANCisvKiBNYXNrIGZvciB0aGUgbG93ZXIg
ZmVuY2UgcG9pbnRlciBiaXRzICovDQorI2RlZmluZSBETUFfUkVTVl9MSVNUX01BU0sJMHgzDQor
DQogc3RydWN0IGRtYV9yZXN2X2xpc3Qgew0KIAlzdHJ1Y3QgcmN1X2hlYWQgcmN1Ow0KLQl1MzIg
c2hhcmVkX2NvdW50LCBzaGFyZWRfbWF4Ow0KLQlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpzaGFy
ZWRbXTsNCisJdTMyIG51bV9mZW5jZXMsIG1heF9mZW5jZXM7DQorCXN0cnVjdCBkbWFfZmVuY2Ug
X19yY3UgKnRhYmxlW107DQogfTsNCiANCisvKioNCisgKiBkbWFfcmVzdl9saXN0X2VudHJ5IC0g
ZXh0cmFjdCBmZW5jZSBhbmQgdXNhZ2UgZnJvbSBhIGxpc3QgZW50cnkNCisgKiBAbGlzdDogdGhl
IGxpc3QgdG8gZXh0cmFjdCBhbmQgZW50cnkgZnJvbQ0KKyAqIEBpbmRleDogd2hpY2ggZW50cnkg
d2Ugd2FudA0KKyAqIEByZXN2OiBvcHRpb25hbCBkbWFfcmVzdiBvYmogZm9yIGxvY2tkZXAgY2hl
Y2sgdGhhdCB0aGUgYWNjZXNzIGlzIGFsbG93ZWQNCisgKiBAZmVuY2U6IHRoZSByZXN1bHRpbmcg
ZmVuY2UNCisgKiBAdXNhZ2U6IHRoZSByZXN1bHRpbmcgdXNhZ2UNCisgKg0KKyAqIEV4dHJhY3Qg
dGhlIGZlbmNlIGFuZCB1c2FnZSBmbGFncyBmcm9tIGFuIFJDVSBwcm90ZWN0ZWQgZW50cnkgaW4g
dGhlIGxpc3QuDQorICovDQorc3RhdGljIHZvaWQgZG1hX3Jlc3ZfbGlzdF9lbnRyeShzdHJ1Y3Qg
ZG1hX3Jlc3ZfbGlzdCAqbGlzdCwgdW5zaWduZWQgaW50IGluZGV4LA0KKwkJCQlzdHJ1Y3QgZG1h
X3Jlc3YgKnJlc3YsIHN0cnVjdCBkbWFfZmVuY2UgKipmZW5jZSwNCisJCQkJZW51bSBkbWFfcmVz
dl91c2FnZSAqdXNhZ2UpDQorew0KKwlsb25nIHRtcDsNCisNCisJdG1wID0gKGxvbmcpcmN1X2Rl
cmVmZXJlbmNlX2NoZWNrKGxpc3QtPnRhYmxlW2luZGV4XSwNCisJCQkJCSAgcmVzdiA/IGRtYV9y
ZXN2X2hlbGQocmVzdikgOiB0cnVlKTsNCisJKmZlbmNlID0gKHN0cnVjdCBkbWFfZmVuY2UgKiko
dG1wICYgfkRNQV9SRVNWX0xJU1RfTUFTSyk7DQorCWlmICh1c2FnZSkNCisJCSp1c2FnZSA9IHRt
cCAmIERNQV9SRVNWX0xJU1RfTUFTSzsNCit9DQorDQorLyoqDQorICogZG1hX3Jlc3ZfbGlzdF9z
ZXQgLSBzZXQgZmVuY2UgYW5kIHVzYWdlIGF0IGEgc3BlY2lmaWMgaW5kZXgNCisgKiBAbGlzdDog
dGhlIGxpc3QgdG8gbW9kaWZ5DQorICogQGluZGV4OiB3aGVyZSB0byBtYWtlIHRoZSBjaGFuZ2UN
CisgKiBAZmVuY2U6IHRoZSBmZW5jZSB0byBzZXQNCisgKiBAdXNhZ2U6IHRoZSB1c2FnZSB0byBz
ZXQNCisgKg0KKyAqIFNldCB0aGUgZmVuY2UgYW5kIHVzYWdlIGZsYWdzIGF0IHRoZSBzcGVjaWZp
YyBpbmRleCBpbiB0aGUgbGlzdC4NCisgKi8NCitzdGF0aWMgdm9pZCBkbWFfcmVzdl9saXN0X3Nl
dChzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqbGlzdCwNCisJCQkgICAgICB1bnNpZ25lZCBpbnQgaW5k
ZXgsDQorCQkJICAgICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UsDQorCQkJICAgICAgZW51bSBk
bWFfcmVzdl91c2FnZSB1c2FnZSkNCit7DQorCWxvbmcgdG1wID0gKChsb25nKWZlbmNlKSB8IHVz
YWdlOw0KKw0KKwlSQ1VfSU5JVF9QT0lOVEVSKGxpc3QtPnRhYmxlW2luZGV4XSwgKHN0cnVjdCBk
bWFfZmVuY2UgKil0bXApOw0KK30NCisNCiAvKioNCiAgKiBkbWFfcmVzdl9saXN0X2FsbG9jIC0g
YWxsb2NhdGUgZmVuY2UgbGlzdA0KLSAqIEBzaGFyZWRfbWF4OiBudW1iZXIgb2YgZmVuY2VzIHdl
IG5lZWQgc3BhY2UgZm9yDQorICogQG1heF9mZW5jZXM6IG51bWJlciBvZiBmZW5jZXMgd2UgbmVl
ZCBzcGFjZSBmb3INCiAgKg0KICAqIEFsbG9jYXRlIGEgbmV3IGRtYV9yZXN2X2xpc3QgYW5kIG1h
a2Ugc3VyZSB0byBjb3JyZWN0bHkgaW5pdGlhbGl6ZQ0KLSAqIHNoYXJlZF9tYXguDQorICogbWF4
X2ZlbmNlcy4NCiAgKi8NCi1zdGF0aWMgc3RydWN0IGRtYV9yZXN2X2xpc3QgKmRtYV9yZXN2X2xp
c3RfYWxsb2ModW5zaWduZWQgaW50IHNoYXJlZF9tYXgpDQorc3RhdGljIHN0cnVjdCBkbWFfcmVz
dl9saXN0ICpkbWFfcmVzdl9saXN0X2FsbG9jKHVuc2lnbmVkIGludCBtYXhfZmVuY2VzKQ0KIHsN
CiAJc3RydWN0IGRtYV9yZXN2X2xpc3QgKmxpc3Q7DQogDQotCWxpc3QgPSBrbWFsbG9jKHN0cnVj
dF9zaXplKGxpc3QsIHNoYXJlZCwgc2hhcmVkX21heCksIEdGUF9LRVJORUwpOw0KKwlsaXN0ID0g
a21hbGxvYyhzdHJ1Y3Rfc2l6ZShsaXN0LCB0YWJsZSwgbWF4X2ZlbmNlcyksIEdGUF9LRVJORUwp
Ow0KIAlpZiAoIWxpc3QpDQogCQlyZXR1cm4gTlVMTDsNCiANCi0JbGlzdC0+c2hhcmVkX21heCA9
IChrc2l6ZShsaXN0KSAtIG9mZnNldG9mKHR5cGVvZigqbGlzdCksIHNoYXJlZCkpIC8NCi0JCXNp
emVvZigqbGlzdC0+c2hhcmVkKTsNCisJbGlzdC0+bWF4X2ZlbmNlcyA9IChrc2l6ZShsaXN0KSAt
IG9mZnNldG9mKHR5cGVvZigqbGlzdCksIHRhYmxlKSkgLw0KKwkJc2l6ZW9mKCpsaXN0LT50YWJs
ZSk7DQogDQogCXJldHVybiBsaXN0Ow0KIH0NCkBAIC05Nyw5ICsxNDIsMTIgQEAgc3RhdGljIHZv
aWQgZG1hX3Jlc3ZfbGlzdF9mcmVlKHN0cnVjdCBkbWFfcmVzdl9saXN0ICpsaXN0KQ0KIAlpZiAo
IWxpc3QpDQogCQlyZXR1cm47DQogDQotCWZvciAoaSA9IDA7IGkgPCBsaXN0LT5zaGFyZWRfY291
bnQ7ICsraSkNCi0JCWRtYV9mZW5jZV9wdXQocmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChsaXN0
LT5zaGFyZWRbaV0sIHRydWUpKTsNCisJZm9yIChpID0gMDsgaSA8IGxpc3QtPm51bV9mZW5jZXM7
ICsraSkgew0KKwkJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7DQogDQorCQlkbWFfcmVzdl9saXN0
X2VudHJ5KGxpc3QsIGksIE5VTEwsICZmZW5jZSwgTlVMTCk7DQorCQlkbWFfZmVuY2VfcHV0KGZl
bmNlKTsNCisJfQ0KIAlrZnJlZV9yY3UobGlzdCwgcmN1KTsNCiB9DQogDQpAQCAtMTEyLDggKzE2
MCw3IEBAIHZvaWQgZG1hX3Jlc3ZfaW5pdChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaikNCiAJd3dfbXV0
ZXhfaW5pdCgmb2JqLT5sb2NrLCAmcmVzZXJ2YXRpb25fd3dfY2xhc3MpOw0KIAlzZXFjb3VudF93
d19tdXRleF9pbml0KCZvYmotPnNlcSwgJm9iai0+bG9jayk7DQogDQotCVJDVV9JTklUX1BPSU5U
RVIob2JqLT5mZW5jZSwgTlVMTCk7DQotCVJDVV9JTklUX1BPSU5URVIob2JqLT5mZW5jZV9leGNs
LCBOVUxMKTsNCisJUkNVX0lOSVRfUE9JTlRFUihvYmotPmZlbmNlcywgTlVMTCk7DQogfQ0KIEVY
UE9SVF9TWU1CT0woZG1hX3Jlc3ZfaW5pdCk7DQogDQpAQCAtMTIzLDQ2ICsxNzAsMzEgQEAgRVhQ
T1JUX1NZTUJPTChkbWFfcmVzdl9pbml0KTsNCiAgKi8NCiB2b2lkIGRtYV9yZXN2X2Zpbmkoc3Ry
dWN0IGRtYV9yZXN2ICpvYmopDQogew0KLQlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZm9iajsNCi0J
c3RydWN0IGRtYV9mZW5jZSAqZXhjbDsNCi0NCiAJLyoNCiAJICogVGhpcyBvYmplY3Qgc2hvdWxk
IGJlIGRlYWQgYW5kIGFsbCByZWZlcmVuY2VzIG11c3QgaGF2ZQ0KIAkgKiBiZWVuIHJlbGVhc2Vk
IHRvIGl0LCBzbyBubyBuZWVkIHRvIGJlIHByb3RlY3RlZCB3aXRoIHJjdS4NCiAJICovDQotCWV4
Y2wgPSByY3VfZGVyZWZlcmVuY2VfcHJvdGVjdGVkKG9iai0+ZmVuY2VfZXhjbCwgMSk7DQotCWlm
IChleGNsKQ0KLQkJZG1hX2ZlbmNlX3B1dChleGNsKTsNCi0NCi0JZm9iaiA9IHJjdV9kZXJlZmVy
ZW5jZV9wcm90ZWN0ZWQob2JqLT5mZW5jZSwgMSk7DQotCWRtYV9yZXN2X2xpc3RfZnJlZShmb2Jq
KTsNCisJZG1hX3Jlc3ZfbGlzdF9mcmVlKHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQob2JqLT5m
ZW5jZXMsIHRydWUpKTsNCiAJd3dfbXV0ZXhfZGVzdHJveSgmb2JqLT5sb2NrKTsNCiB9DQogRVhQ
T1JUX1NZTUJPTChkbWFfcmVzdl9maW5pKTsNCiANCi1zdGF0aWMgaW5saW5lIHN0cnVjdCBkbWFf
ZmVuY2UgKg0KLWRtYV9yZXN2X2V4Y2xfZmVuY2Uoc3RydWN0IGRtYV9yZXN2ICpvYmopDQorc3Rh
dGljIGlubGluZSBzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZG1hX3Jlc3ZfZmVuY2VzX2xpc3Qoc3Ry
dWN0IGRtYV9yZXN2ICpvYmopDQogew0KLSAgICAgICByZXR1cm4gcmN1X2RlcmVmZXJlbmNlX2No
ZWNrKG9iai0+ZmVuY2VfZXhjbCwgZG1hX3Jlc3ZfaGVsZChvYmopKTsNCi19DQotDQotc3RhdGlj
IGlubGluZSBzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZG1hX3Jlc3Zfc2hhcmVkX2xpc3Qoc3RydWN0
IGRtYV9yZXN2ICpvYmopDQotew0KLQlyZXR1cm4gcmN1X2RlcmVmZXJlbmNlX2NoZWNrKG9iai0+
ZmVuY2UsIGRtYV9yZXN2X2hlbGQob2JqKSk7DQorCXJldHVybiByY3VfZGVyZWZlcmVuY2VfY2hl
Y2sob2JqLT5mZW5jZXMsIGRtYV9yZXN2X2hlbGQob2JqKSk7DQogfQ0KIA0KIC8qKg0KLSAqIGRt
YV9yZXN2X3Jlc2VydmVfZmVuY2VzIC0gUmVzZXJ2ZSBzcGFjZSB0byBhZGQgc2hhcmVkIGZlbmNl
cyB0bw0KLSAqIGEgZG1hX3Jlc3YuDQorICogZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMgLSBSZXNl
cnZlIHNwYWNlIHRvIGFkZCBmZW5jZXMgdG8gYSBkbWFfcmVzdiBvYmplY3QuDQogICogQG9iajog
cmVzZXJ2YXRpb24gb2JqZWN0DQogICogQG51bV9mZW5jZXM6IG51bWJlciBvZiBmZW5jZXMgd2Ug
d2FudCB0byBhZGQNCiAgKg0KLSAqIFNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIGRtYV9yZXN2X2Fk
ZF9zaGFyZWRfZmVuY2UoKS4gIE11c3QNCi0gKiBiZSBjYWxsZWQgd2l0aCBAb2JqIGxvY2tlZCB0
aHJvdWdoIGRtYV9yZXN2X2xvY2soKS4NCisgKiBTaG91bGQgYmUgY2FsbGVkIGJlZm9yZSBkbWFf
cmVzdl9hZGRfZmVuY2UoKS4gIE11c3QgYmUgY2FsbGVkIHdpdGggQG9iag0KKyAqIGxvY2tlZCB0
aHJvdWdoIGRtYV9yZXN2X2xvY2soKS4NCiAgKg0KICAqIE5vdGUgdGhhdCB0aGUgcHJlYWxsb2Nh
dGVkIHNsb3RzIG5lZWQgdG8gYmUgcmUtcmVzZXJ2ZWQgaWYgQG9iaiBpcyB1bmxvY2tlZA0KLSAq
IGF0IGFueSB0aW1lIGJlZm9yZSBjYWxsaW5nIGRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoKS4g
VGhpcyBpcyB2YWxpZGF0ZWQNCi0gKiB3aGVuIENPTkZJR19ERUJVR19NVVRFWEVTIGlzIGVuYWJs
ZWQuDQorICogYXQgYW55IHRpbWUgYmVmb3JlIGNhbGxpbmcgZG1hX3Jlc3ZfYWRkX2ZlbmNlKCku
IFRoaXMgaXMgdmFsaWRhdGVkIHdoZW4NCisgKiBDT05GSUdfREVCVUdfTVVURVhFUyBpcyBlbmFi
bGVkLg0KICAqDQogICogUkVUVVJOUw0KICAqIFplcm8gZm9yIHN1Y2Nlc3MsIG9yIC1lcnJubw0K
QEAgLTE3NCwxMSArMjA2LDExIEBAIGludCBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyhzdHJ1Y3Qg
ZG1hX3Jlc3YgKm9iaiwgdW5zaWduZWQgaW50IG51bV9mZW5jZXMpDQogDQogCWRtYV9yZXN2X2Fz
c2VydF9oZWxkKG9iaik7DQogDQotCW9sZCA9IGRtYV9yZXN2X3NoYXJlZF9saXN0KG9iaik7DQot
CWlmIChvbGQgJiYgb2xkLT5zaGFyZWRfbWF4KSB7DQotCQlpZiAoKG9sZC0+c2hhcmVkX2NvdW50
ICsgbnVtX2ZlbmNlcykgPD0gb2xkLT5zaGFyZWRfbWF4KQ0KKwlvbGQgPSBkbWFfcmVzdl9mZW5j
ZXNfbGlzdChvYmopOw0KKwlpZiAob2xkICYmIG9sZC0+bWF4X2ZlbmNlcykgew0KKwkJaWYgKChv
bGQtPm51bV9mZW5jZXMgKyBudW1fZmVuY2VzKSA8PSBvbGQtPm1heF9mZW5jZXMpDQogCQkJcmV0
dXJuIDA7DQotCQltYXggPSBtYXgob2xkLT5zaGFyZWRfY291bnQgKyBudW1fZmVuY2VzLCBvbGQt
PnNoYXJlZF9tYXggKiAyKTsNCisJCW1heCA9IG1heChvbGQtPm51bV9mZW5jZXMgKyBudW1fZmVu
Y2VzLCBvbGQtPm1heF9mZW5jZXMgKiAyKTsNCiAJfSBlbHNlIHsNCiAJCW1heCA9IG1heCg0dWws
IHJvdW5kdXBfcG93X29mX3R3byhudW1fZmVuY2VzKSk7DQogCX0NCkBAIC0xOTMsMjcgKzIyNSwy
NyBAQCBpbnQgZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpvYmosIHVu
c2lnbmVkIGludCBudW1fZmVuY2VzKQ0KIAkgKiByZWZlcmVuY2VzIGZyb20gdGhlIG9sZCBzdHJ1
Y3QgYXJlIGNhcnJpZWQgb3ZlciB0bw0KIAkgKiB0aGUgbmV3Lg0KIAkgKi8NCi0JZm9yIChpID0g
MCwgaiA9IDAsIGsgPSBtYXg7IGkgPCAob2xkID8gb2xkLT5zaGFyZWRfY291bnQgOiAwKTsgKytp
KSB7DQorCWZvciAoaSA9IDAsIGogPSAwLCBrID0gbWF4OyBpIDwgKG9sZCA/IG9sZC0+bnVtX2Zl
bmNlcyA6IDApOyArK2kpIHsNCisJCWVudW0gZG1hX3Jlc3ZfdXNhZ2UgdXNhZ2U7DQogCQlzdHJ1
Y3QgZG1hX2ZlbmNlICpmZW5jZTsNCiANCi0JCWZlbmNlID0gcmN1X2RlcmVmZXJlbmNlX3Byb3Rl
Y3RlZChvbGQtPnNoYXJlZFtpXSwNCi0JCQkJCQkgIGRtYV9yZXN2X2hlbGQob2JqKSk7DQorCQlk
bWFfcmVzdl9saXN0X2VudHJ5KG9sZCwgaSwgb2JqLCAmZmVuY2UsICZ1c2FnZSk7DQogCQlpZiAo
ZG1hX2ZlbmNlX2lzX3NpZ25hbGVkKGZlbmNlKSkNCi0JCQlSQ1VfSU5JVF9QT0lOVEVSKG5ldy0+
c2hhcmVkWy0ta10sIGZlbmNlKTsNCisJCQlSQ1VfSU5JVF9QT0lOVEVSKG5ldy0+dGFibGVbLS1r
XSwgZmVuY2UpOw0KIAkJZWxzZQ0KLQkJCVJDVV9JTklUX1BPSU5URVIobmV3LT5zaGFyZWRbaisr
XSwgZmVuY2UpOw0KKwkJCWRtYV9yZXN2X2xpc3Rfc2V0KG5ldywgaisrLCBmZW5jZSwgdXNhZ2Up
Ow0KIAl9DQotCW5ldy0+c2hhcmVkX2NvdW50ID0gajsNCisJbmV3LT5udW1fZmVuY2VzID0gajsN
CiANCiAJLyoNCiAJICogV2UgYXJlIG5vdCBjaGFuZ2luZyB0aGUgZWZmZWN0aXZlIHNldCBvZiBm
ZW5jZXMgaGVyZSBzbyBjYW4NCiAJICogbWVyZWx5IHVwZGF0ZSB0aGUgcG9pbnRlciB0byB0aGUg
bmV3IGFycmF5OyBib3RoIGV4aXN0aW5nDQogCSAqIHJlYWRlcnMgYW5kIG5ldyByZWFkZXJzIHdp
bGwgc2VlIGV4YWN0bHkgdGhlIHNhbWUgc2V0IG9mDQotCSAqIGFjdGl2ZSAodW5zaWduYWxlZCkg
c2hhcmVkIGZlbmNlcy4gSW5kaXZpZHVhbCBmZW5jZXMgYW5kIHRoZQ0KKwkgKiBhY3RpdmUgKHVu
c2lnbmFsZWQpIGZlbmNlcy4gSW5kaXZpZHVhbCBmZW5jZXMgYW5kIHRoZQ0KIAkgKiBvbGQgYXJy
YXkgYXJlIHByb3RlY3RlZCBieSBSQ1UgYW5kIHNvIHdpbGwgbm90IHZhbmlzaCB1bmRlcg0KIAkg
KiB0aGUgZ2F6ZSBvZiB0aGUgcmN1X3JlYWRfbG9jaygpIHJlYWRlcnMuDQogCSAqLw0KLQlyY3Vf
YXNzaWduX3BvaW50ZXIob2JqLT5mZW5jZSwgbmV3KTsNCisJcmN1X2Fzc2lnbl9wb2ludGVyKG9i
ai0+ZmVuY2VzLCBuZXcpOw0KIA0KIAlpZiAoIW9sZCkNCiAJCXJldHVybiAwOw0KQEAgLTIyMiw3
ICsyNTQsNyBAQCBpbnQgZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpv
YmosIHVuc2lnbmVkIGludCBudW1fZmVuY2VzKQ0KIAlmb3IgKGkgPSBrOyBpIDwgbWF4OyArK2kp
IHsNCiAJCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOw0KIA0KLQkJZmVuY2UgPSByY3VfZGVyZWZl
cmVuY2VfcHJvdGVjdGVkKG5ldy0+c2hhcmVkW2ldLA0KKwkJZmVuY2UgPSByY3VfZGVyZWZlcmVu
Y2VfcHJvdGVjdGVkKG5ldy0+dGFibGVbaV0sDQogCQkJCQkJICBkbWFfcmVzdl9oZWxkKG9iaikp
Ow0KIAkJZG1hX2ZlbmNlX3B1dChmZW5jZSk7DQogCX0NCkBAIC0yMzQsMzcgKzI2NiwzOSBAQCBF
WFBPUlRfU1lNQk9MKGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKTsNCiANCiAjaWZkZWYgQ09ORklH
X0RFQlVHX01VVEVYRVMNCiAvKioNCi0gKiBkbWFfcmVzdl9yZXNldF9zaGFyZWRfbWF4IC0gcmVz
ZXQgc2hhcmVkIGZlbmNlcyBmb3IgZGVidWdnaW5nDQorICogZG1hX3Jlc3ZfcmVzZXRfbWF4X2Zl
bmNlcyAtIHJlc2V0IGZlbmNlcyBmb3IgZGVidWdnaW5nDQogICogQG9iajogdGhlIGRtYV9yZXN2
IG9iamVjdCB0byByZXNldA0KICAqDQotICogUmVzZXQgdGhlIG51bWJlciBvZiBwcmUtcmVzZXJ2
ZWQgc2hhcmVkIHNsb3RzIHRvIHRlc3QgdGhhdCBkcml2ZXJzIGRvDQorICogUmVzZXQgdGhlIG51
bWJlciBvZiBwcmUtcmVzZXJ2ZWQgZmVuY2Ugc2xvdHMgdG8gdGVzdCB0aGF0IGRyaXZlcnMgZG8N
CiAgKiBjb3JyZWN0IHNsb3QgYWxsb2NhdGlvbiB1c2luZyBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNl
cygpLiBTZWUgYWxzbw0KLSAqICZkbWFfcmVzdl9saXN0LnNoYXJlZF9tYXguDQorICogJmRtYV9y
ZXN2X2xpc3QubWF4X2ZlbmNlcy4NCiAgKi8NCi12b2lkIGRtYV9yZXN2X3Jlc2V0X3NoYXJlZF9t
YXgoc3RydWN0IGRtYV9yZXN2ICpvYmopDQordm9pZCBkbWFfcmVzdl9yZXNldF9tYXhfZmVuY2Vz
KHN0cnVjdCBkbWFfcmVzdiAqb2JqKQ0KIHsNCi0Jc3RydWN0IGRtYV9yZXN2X2xpc3QgKmZlbmNl
cyA9IGRtYV9yZXN2X3NoYXJlZF9saXN0KG9iaik7DQorCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpm
ZW5jZXMgPSBkbWFfcmVzdl9mZW5jZXNfbGlzdChvYmopOw0KIA0KIAlkbWFfcmVzdl9hc3NlcnRf
aGVsZChvYmopOw0KIA0KLQkvKiBUZXN0IHNoYXJlZCBmZW5jZSBzbG90IHJlc2VydmF0aW9uICov
DQorCS8qIFRlc3QgZmVuY2Ugc2xvdCByZXNlcnZhdGlvbiAqLw0KIAlpZiAoZmVuY2VzKQ0KLQkJ
ZmVuY2VzLT5zaGFyZWRfbWF4ID0gZmVuY2VzLT5zaGFyZWRfY291bnQ7DQorCQlmZW5jZXMtPm1h
eF9mZW5jZXMgPSBmZW5jZXMtPm51bV9mZW5jZXM7DQogfQ0KLUVYUE9SVF9TWU1CT0woZG1hX3Jl
c3ZfcmVzZXRfc2hhcmVkX21heCk7DQorRVhQT1JUX1NZTUJPTChkbWFfcmVzdl9yZXNldF9tYXhf
ZmVuY2VzKTsNCiAjZW5kaWYNCiANCiAvKioNCi0gKiBkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNl
IC0gQWRkIGEgZmVuY2UgdG8gYSBzaGFyZWQgc2xvdA0KKyAqIGRtYV9yZXN2X2FkZF9mZW5jZSAt
IEFkZCBhIGZlbmNlIHRvIHRoZSBkbWFfcmVzdiBvYmoNCiAgKiBAb2JqOiB0aGUgcmVzZXJ2YXRp
b24gb2JqZWN0DQotICogQGZlbmNlOiB0aGUgc2hhcmVkIGZlbmNlIHRvIGFkZA0KKyAqIEBmZW5j
ZTogdGhlIGZlbmNlIHRvIGFkZA0KKyAqIEB1c2FnZTogaG93IHRoZSBmZW5jZSBpcyB1c2VkLCBz
ZWUgZW51bSBkbWFfcmVzdl91c2FnZQ0KICAqDQotICogQWRkIGEgZmVuY2UgdG8gYSBzaGFyZWQg
c2xvdCwgQG9iaiBtdXN0IGJlIGxvY2tlZCB3aXRoIGRtYV9yZXN2X2xvY2soKSwgYW5kDQorICog
QWRkIGEgZmVuY2UgdG8gYSBzbG90LCBAb2JqIG11c3QgYmUgbG9ja2VkIHdpdGggZG1hX3Jlc3Zf
bG9jaygpLCBhbmQNCiAgKiBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcygpIGhhcyBiZWVuIGNhbGxl
ZC4NCiAgKg0KICAqIFNlZSBhbHNvICZkbWFfcmVzdi5mZW5jZSBmb3IgYSBkaXNjdXNzaW9uIG9m
IHRoZSBzZW1hbnRpY3MuDQogICovDQotdm9pZCBkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHN0
cnVjdCBkbWFfcmVzdiAqb2JqLCBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkNCit2b2lkIGRtYV9y
ZXN2X2FkZF9mZW5jZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0IGRtYV9mZW5jZSAqZmVu
Y2UsDQorCQkJZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSkNCiB7DQogCXN0cnVjdCBkbWFfcmVz
dl9saXN0ICpmb2JqOw0KIAlzdHJ1Y3QgZG1hX2ZlbmNlICpvbGQ7DQpAQCAtMjc0LDQ0ICszMDgs
NDUgQEAgdm9pZCBkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHN0cnVjdCBkbWFfcmVzdiAqb2Jq
LCBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkNCiANCiAJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQob2Jq
KTsNCiANCi0JLyogRHJpdmVycyBzaG91bGQgbm90IGFkZCBjb250YWluZXJzIGhlcmUsIGluc3Rl
YWQgYWRkIGVhY2ggZmVuY2UNCi0JICogaW5kaXZpZHVhbGx5Lg0KKwkvKiBUT0RPOiBEcml2ZXJz
IHNob3VsZCBub3QgYWRkIGNvbnRhaW5lcnMgaGVyZSwgaW5zdGVhZCBhZGQgZWFjaCBmZW5jZQ0K
KwkgKiBpbmRpdmlkdWFsbHkuIERpc2FibGVkIGZvciBub3cgdW50aWwgd2UgY2xlYW5lZCB1cCBh
bWRncHUvdHRtLg0KIAkgKi8NCi0JV0FSTl9PTihkbWFfZmVuY2VfaXNfY29udGFpbmVyKGZlbmNl
KSk7DQorCS8qIFdBUk5fT04oZG1hX2ZlbmNlX2lzX2NvbnRhaW5lcihmZW5jZSkpOyAqLw0KIA0K
LQlmb2JqID0gZG1hX3Jlc3Zfc2hhcmVkX2xpc3Qob2JqKTsNCi0JY291bnQgPSBmb2JqLT5zaGFy
ZWRfY291bnQ7DQorCWZvYmogPSBkbWFfcmVzdl9mZW5jZXNfbGlzdChvYmopOw0KKwljb3VudCA9
IGZvYmotPm51bV9mZW5jZXM7DQogDQogCXdyaXRlX3NlcWNvdW50X2JlZ2luKCZvYmotPnNlcSk7
DQogDQogCWZvciAoaSA9IDA7IGkgPCBjb3VudDsgKytpKSB7DQorCQllbnVtIGRtYV9yZXN2X3Vz
YWdlIG9sZF91c2FnZTsNCiANCi0JCW9sZCA9IHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoZm9i
ai0+c2hhcmVkW2ldLA0KLQkJCQkJCWRtYV9yZXN2X2hlbGQob2JqKSk7DQotCQlpZiAob2xkLT5j
b250ZXh0ID09IGZlbmNlLT5jb250ZXh0IHx8DQorCQlkbWFfcmVzdl9saXN0X2VudHJ5KGZvYmos
IGksIG9iaiwgJm9sZCwgJm9sZF91c2FnZSk7DQorCQlpZiAoKG9sZC0+Y29udGV4dCA9PSBmZW5j
ZS0+Y29udGV4dCAmJiBvbGRfdXNhZ2UgPj0gdXNhZ2UpIHx8DQogCQkgICAgZG1hX2ZlbmNlX2lz
X3NpZ25hbGVkKG9sZCkpDQogCQkJZ290byByZXBsYWNlOw0KIAl9DQogDQotCUJVR19PTihmb2Jq
LT5zaGFyZWRfY291bnQgPj0gZm9iai0+c2hhcmVkX21heCk7DQorCUJVR19PTihmb2JqLT5udW1f
ZmVuY2VzID49IGZvYmotPm1heF9mZW5jZXMpOw0KIAlvbGQgPSBOVUxMOw0KIAljb3VudCsrOw0K
IA0KIHJlcGxhY2U6DQotCVJDVV9JTklUX1BPSU5URVIoZm9iai0+c2hhcmVkW2ldLCBmZW5jZSk7
DQotCS8qIHBvaW50ZXIgdXBkYXRlIG11c3QgYmUgdmlzaWJsZSBiZWZvcmUgd2UgZXh0ZW5kIHRo
ZSBzaGFyZWRfY291bnQgKi8NCi0Jc21wX3N0b3JlX21iKGZvYmotPnNoYXJlZF9jb3VudCwgY291
bnQpOw0KKwlkbWFfcmVzdl9saXN0X3NldChmb2JqLCBpLCBmZW5jZSwgdXNhZ2UpOw0KKwkvKiBw
b2ludGVyIHVwZGF0ZSBtdXN0IGJlIHZpc2libGUgYmVmb3JlIHdlIGV4dGVuZCB0aGUgbnVtX2Zl
bmNlcyAqLw0KKwlzbXBfc3RvcmVfbWIoZm9iai0+bnVtX2ZlbmNlcywgY291bnQpOw0KIA0KIAl3
cml0ZV9zZXFjb3VudF9lbmQoJm9iai0+c2VxKTsNCiAJZG1hX2ZlbmNlX3B1dChvbGQpOw0KIH0N
Ci1FWFBPUlRfU1lNQk9MKGRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UpOw0KK0VYUE9SVF9TWU1C
T0woZG1hX3Jlc3ZfYWRkX2ZlbmNlKTsNCiANCiAvKioNCiAgKiBkbWFfcmVzdl9yZXBsYWNlX2Zl
bmNlcyAtIHJlcGxhY2UgZmVuY2VzIGluIHRoZSBkbWFfcmVzdiBvYmoNCiAgKiBAb2JqOiB0aGUg
cmVzZXJ2YXRpb24gb2JqZWN0DQogICogQGNvbnRleHQ6IHRoZSBjb250ZXh0IG9mIHRoZSBmZW5j
ZXMgdG8gcmVwbGFjZQ0KICAqIEByZXBsYWNlbWVudDogdGhlIG5ldyBmZW5jZSB0byB1c2UgaW5z
dGVhZA0KKyAqIEB1c2FnZTogaG93IHRoZSBuZXcgZmVuY2UgaXMgdXNlZCwgc2VlIGVudW0gZG1h
X3Jlc3ZfdXNhZ2UNCiAgKg0KICAqIFJlcGxhY2UgZmVuY2VzIHdpdGggYSBzcGVjaWZpZWQgY29u
dGV4dCB3aXRoIGEgbmV3IGZlbmNlLiBPbmx5IHZhbGlkIGlmIHRoZQ0KICAqIG9wZXJhdGlvbiBy
ZXByZXNlbnRlZCBieSB0aGUgb3JpZ2luYWwgZmVuY2VzIGlzIGNvbXBsZXRlZCBvciBoYXMgbm8g
bG9uZ2VyDQpAQCAtMzE5LDEwNyArMzU0LDcyIEBAIEVYUE9SVF9TWU1CT0woZG1hX3Jlc3ZfYWRk
X3NoYXJlZF9mZW5jZSk7DQogICogY29tcGxldGVzLg0KICAqLw0KIHZvaWQgZG1hX3Jlc3ZfcmVw
bGFjZV9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpvYmosIHVpbnQ2NF90IGNvbnRleHQsDQotCQkJ
ICAgICBzdHJ1Y3QgZG1hX2ZlbmNlICpyZXBsYWNlbWVudCkNCisJCQkgICAgIHN0cnVjdCBkbWFf
ZmVuY2UgKnJlcGxhY2VtZW50LA0KKwkJCSAgICAgZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSkN
CiB7DQogCXN0cnVjdCBkbWFfcmVzdl9saXN0ICpsaXN0Ow0KLQlzdHJ1Y3QgZG1hX2ZlbmNlICpv
bGQ7DQogCXVuc2lnbmVkIGludCBpOw0KIA0KIAlkbWFfcmVzdl9hc3NlcnRfaGVsZChvYmopOw0K
IA0KKwlsaXN0ID0gZG1hX3Jlc3ZfZmVuY2VzX2xpc3Qob2JqKTsNCiAJd3JpdGVfc2VxY291bnRf
YmVnaW4oJm9iai0+c2VxKTsNCisJZm9yIChpID0gMDsgbGlzdCAmJiBpIDwgbGlzdC0+bnVtX2Zl
bmNlczsgKytpKSB7DQorCQlzdHJ1Y3QgZG1hX2ZlbmNlICpvbGQ7DQogDQotCW9sZCA9IGRtYV9y
ZXN2X2V4Y2xfZmVuY2Uob2JqKTsNCi0JaWYgKG9sZC0+Y29udGV4dCA9PSBjb250ZXh0KSB7DQot
CQlSQ1VfSU5JVF9QT0lOVEVSKG9iai0+ZmVuY2VfZXhjbCwgZG1hX2ZlbmNlX2dldChyZXBsYWNl
bWVudCkpOw0KLQkJZG1hX2ZlbmNlX3B1dChvbGQpOw0KLQl9DQotDQotCWxpc3QgPSBkbWFfcmVz
dl9zaGFyZWRfbGlzdChvYmopOw0KLQlmb3IgKGkgPSAwOyBsaXN0ICYmIGkgPCBsaXN0LT5zaGFy
ZWRfY291bnQ7ICsraSkgew0KLQkJb2xkID0gcmN1X2RlcmVmZXJlbmNlX3Byb3RlY3RlZChsaXN0
LT5zaGFyZWRbaV0sDQotCQkJCQkJZG1hX3Jlc3ZfaGVsZChvYmopKTsNCisJCWRtYV9yZXN2X2xp
c3RfZW50cnkobGlzdCwgaSwgb2JqLCAmb2xkLCBOVUxMKTsNCiAJCWlmIChvbGQtPmNvbnRleHQg
IT0gY29udGV4dCkNCiAJCQljb250aW51ZTsNCiANCi0JCXJjdV9hc3NpZ25fcG9pbnRlcihsaXN0
LT5zaGFyZWRbaV0sIGRtYV9mZW5jZV9nZXQocmVwbGFjZW1lbnQpKTsNCisJCWRtYV9yZXN2X2xp
c3Rfc2V0KGxpc3QsIGksIHJlcGxhY2VtZW50LCB1c2FnZSk7DQogCQlkbWFfZmVuY2VfcHV0KG9s
ZCk7DQogCX0NCi0NCiAJd3JpdGVfc2VxY291bnRfZW5kKCZvYmotPnNlcSk7DQogfQ0KIEVYUE9S
VF9TWU1CT0woZG1hX3Jlc3ZfcmVwbGFjZV9mZW5jZXMpOw0KIA0KIC8qKg0KLSAqIGRtYV9yZXN2
X2FkZF9leGNsX2ZlbmNlIC0gQWRkIGFuIGV4Y2x1c2l2ZSBmZW5jZS4NCi0gKiBAb2JqOiB0aGUg
cmVzZXJ2YXRpb24gb2JqZWN0DQotICogQGZlbmNlOiB0aGUgZXhjbHVzaXZlIGZlbmNlIHRvIGFk
ZA0KKyAqIGRtYV9yZXN2X2l0ZXJfcmVzdGFydF91bmxvY2tlZCAtIHJlc3RhcnQgdGhlIHVubG9j
a2VkIGl0ZXJhdG9yDQorICogQGN1cnNvcjogVGhlIGRtYV9yZXN2X2l0ZXIgb2JqZWN0IHRvIHJl
c3RhcnQNCiAgKg0KLSAqIEFkZCBhIGZlbmNlIHRvIHRoZSBleGNsdXNpdmUgc2xvdC4gQG9iaiBt
dXN0IGJlIGxvY2tlZCB3aXRoIGRtYV9yZXN2X2xvY2soKS4NCi0gKiBTZWUgYWxzbyAmZG1hX3Jl
c3YuZmVuY2VfZXhjbCBmb3IgYSBkaXNjdXNzaW9uIG9mIHRoZSBzZW1hbnRpY3MuDQorICogUmVz
dGFydCB0aGUgdW5sb2NrZWQgaXRlcmF0aW9uIGJ5IGluaXRpYWxpemluZyB0aGUgY3Vyc29yIG9i
amVjdC4NCiAgKi8NCi12b2lkIGRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKHN0cnVjdCBkbWFfcmVz
diAqb2JqLCBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5jZSkNCi17DQotCXN0cnVjdCBkbWFfZmVuY2Ug
Km9sZF9mZW5jZSA9IGRtYV9yZXN2X2V4Y2xfZmVuY2Uob2JqKTsNCi0NCi0JZG1hX3Jlc3ZfYXNz
ZXJ0X2hlbGQob2JqKTsNCi0NCi0JZG1hX2ZlbmNlX2dldChmZW5jZSk7DQotDQotCXdyaXRlX3Nl
cWNvdW50X2JlZ2luKCZvYmotPnNlcSk7DQotCS8qIHdyaXRlX3NlcWNvdW50X2JlZ2luIHByb3Zp
ZGVzIHRoZSBuZWNlc3NhcnkgbWVtb3J5IGJhcnJpZXIgKi8NCi0JUkNVX0lOSVRfUE9JTlRFUihv
YmotPmZlbmNlX2V4Y2wsIGZlbmNlKTsNCi0Jd3JpdGVfc2VxY291bnRfZW5kKCZvYmotPnNlcSk7
DQotDQotCWRtYV9mZW5jZV9wdXQob2xkX2ZlbmNlKTsNCi19DQotRVhQT1JUX1NZTUJPTChkbWFf
cmVzdl9hZGRfZXhjbF9mZW5jZSk7DQotDQotLyogUmVzdGFydCB0aGUgaXRlcmF0b3IgYnkgaW5p
dGlhbGl6aW5nIGFsbCB0aGUgbmVjZXNzYXJ5IGZpZWxkcywgYnV0IG5vdCB0aGUNCi0gKiByZWxh
dGlvbiB0byB0aGUgZG1hX3Jlc3Ygb2JqZWN0LiAqLw0KIHN0YXRpYyB2b2lkIGRtYV9yZXN2X2l0
ZXJfcmVzdGFydF91bmxvY2tlZChzdHJ1Y3QgZG1hX3Jlc3ZfaXRlciAqY3Vyc29yKQ0KIHsNCiAJ
Y3Vyc29yLT5zZXEgPSByZWFkX3NlcWNvdW50X2JlZ2luKCZjdXJzb3ItPm9iai0+c2VxKTsNCi0J
Y3Vyc29yLT5pbmRleCA9IC0xOw0KLQljdXJzb3ItPnNoYXJlZF9jb3VudCA9IDA7DQotCWlmIChj
dXJzb3ItPnVzYWdlID49IERNQV9SRVNWX1VTQUdFX1JFQUQpIHsNCi0JCWN1cnNvci0+ZmVuY2Vz
ID0gZG1hX3Jlc3Zfc2hhcmVkX2xpc3QoY3Vyc29yLT5vYmopOw0KLQkJaWYgKGN1cnNvci0+ZmVu
Y2VzKQ0KLQkJCWN1cnNvci0+c2hhcmVkX2NvdW50ID0gY3Vyc29yLT5mZW5jZXMtPnNoYXJlZF9j
b3VudDsNCi0JfSBlbHNlIHsNCi0JCWN1cnNvci0+ZmVuY2VzID0gTlVMTDsNCi0JfQ0KKwljdXJz
b3ItPmluZGV4ID0gMDsNCisJY3Vyc29yLT5udW1fZmVuY2VzID0gMDsNCisJY3Vyc29yLT5mZW5j
ZXMgPSBkbWFfcmVzdl9mZW5jZXNfbGlzdChjdXJzb3ItPm9iaik7DQorCWlmIChjdXJzb3ItPmZl
bmNlcykNCisJCWN1cnNvci0+bnVtX2ZlbmNlcyA9IGN1cnNvci0+ZmVuY2VzLT5udW1fZmVuY2Vz
Ow0KIAljdXJzb3ItPmlzX3Jlc3RhcnRlZCA9IHRydWU7DQogfQ0KIA0KIC8qIFdhbGsgdG8gdGhl
IG5leHQgbm90IHNpZ25hbGVkIGZlbmNlIGFuZCBncmFiIGEgcmVmZXJlbmNlIHRvIGl0ICovDQog
c3RhdGljIHZvaWQgZG1hX3Jlc3ZfaXRlcl93YWxrX3VubG9ja2VkKHN0cnVjdCBkbWFfcmVzdl9p
dGVyICpjdXJzb3IpDQogew0KLQlzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiA9IGN1cnNvci0+b2JqOw0K
KwlpZiAoIWN1cnNvci0+ZmVuY2VzKQ0KKwkJcmV0dXJuOw0KIA0KIAlkbyB7DQogCQkvKiBEcm9w
IHRoZSByZWZlcmVuY2UgZnJvbSB0aGUgcHJldmlvdXMgcm91bmQgKi8NCiAJCWRtYV9mZW5jZV9w
dXQoY3Vyc29yLT5mZW5jZSk7DQogDQotCQlpZiAoY3Vyc29yLT5pbmRleCA9PSAtMSkgew0KLQkJ
CWN1cnNvci0+ZmVuY2UgPSBkbWFfcmVzdl9leGNsX2ZlbmNlKG9iaik7DQotCQkJY3Vyc29yLT5p
bmRleCsrOw0KLQkJCWlmICghY3Vyc29yLT5mZW5jZSkNCi0JCQkJY29udGludWU7DQotDQotCQl9
IGVsc2UgaWYgKCFjdXJzb3ItPmZlbmNlcyB8fA0KLQkJCSAgIGN1cnNvci0+aW5kZXggPj0gY3Vy
c29yLT5zaGFyZWRfY291bnQpIHsNCisJCWlmIChjdXJzb3ItPmluZGV4ID49IGN1cnNvci0+bnVt
X2ZlbmNlcykgew0KIAkJCWN1cnNvci0+ZmVuY2UgPSBOVUxMOw0KIAkJCWJyZWFrOw0KIA0KLQkJ
fSBlbHNlIHsNCi0JCQlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZmVuY2VzID0gY3Vyc29yLT5mZW5j
ZXM7DQotCQkJdW5zaWduZWQgaW50IGlkeCA9IGN1cnNvci0+aW5kZXgrKzsNCi0NCi0JCQljdXJz
b3ItPmZlbmNlID0gcmN1X2RlcmVmZXJlbmNlKGZlbmNlcy0+c2hhcmVkW2lkeF0pOw0KIAkJfQ0K
Kw0KKwkJZG1hX3Jlc3ZfbGlzdF9lbnRyeShjdXJzb3ItPmZlbmNlcywgY3Vyc29yLT5pbmRleCsr
LA0KKwkJCQkgICAgY3Vyc29yLT5vYmosICZjdXJzb3ItPmZlbmNlLA0KKwkJCQkgICAgJmN1cnNv
ci0+ZmVuY2VfdXNhZ2UpOw0KIAkJY3Vyc29yLT5mZW5jZSA9IGRtYV9mZW5jZV9nZXRfcmN1KGN1
cnNvci0+ZmVuY2UpOw0KLQkJaWYgKCFjdXJzb3ItPmZlbmNlIHx8ICFkbWFfZmVuY2VfaXNfc2ln
bmFsZWQoY3Vyc29yLT5mZW5jZSkpDQorCQlpZiAoIWN1cnNvci0+ZmVuY2UpDQorCQkJYnJlYWs7
DQorDQorCQlpZiAoIWRtYV9mZW5jZV9pc19zaWduYWxlZChjdXJzb3ItPmZlbmNlKSAmJg0KKwkJ
ICAgIGN1cnNvci0+dXNhZ2UgPj0gY3Vyc29yLT5mZW5jZV91c2FnZSkNCiAJCQlicmVhazsNCiAJ
fSB3aGlsZSAodHJ1ZSk7DQogfQ0KQEAgLTQ5NCwxNSArNDk0LDkgQEAgc3RydWN0IGRtYV9mZW5j
ZSAqZG1hX3Jlc3ZfaXRlcl9maXJzdChzdHJ1Y3QgZG1hX3Jlc3ZfaXRlciAqY3Vyc29yKQ0KIAlk
bWFfcmVzdl9hc3NlcnRfaGVsZChjdXJzb3ItPm9iaik7DQogDQogCWN1cnNvci0+aW5kZXggPSAw
Ow0KLQlpZiAoY3Vyc29yLT51c2FnZSA+PSBETUFfUkVTVl9VU0FHRV9SRUFEKQ0KLQkJY3Vyc29y
LT5mZW5jZXMgPSBkbWFfcmVzdl9zaGFyZWRfbGlzdChjdXJzb3ItPm9iaik7DQotCWVsc2UNCi0J
CWN1cnNvci0+ZmVuY2VzID0gTlVMTDsNCi0NCi0JZmVuY2UgPSBkbWFfcmVzdl9leGNsX2ZlbmNl
KGN1cnNvci0+b2JqKTsNCi0JaWYgKCFmZW5jZSkNCi0JCWZlbmNlID0gZG1hX3Jlc3ZfaXRlcl9u
ZXh0KGN1cnNvcik7DQorCWN1cnNvci0+ZmVuY2VzID0gZG1hX3Jlc3ZfZmVuY2VzX2xpc3QoY3Vy
c29yLT5vYmopOw0KIA0KKwlmZW5jZSA9IGRtYV9yZXN2X2l0ZXJfbmV4dChjdXJzb3IpOw0KIAlj
dXJzb3ItPmlzX3Jlc3RhcnRlZCA9IHRydWU7DQogCXJldHVybiBmZW5jZTsNCiB9DQpAQCAtNTE3
LDE3ICs1MTEsMTcgQEAgRVhQT1JUX1NZTUJPTF9HUEwoZG1hX3Jlc3ZfaXRlcl9maXJzdCk7DQog
ICovDQogc3RydWN0IGRtYV9mZW5jZSAqZG1hX3Jlc3ZfaXRlcl9uZXh0KHN0cnVjdCBkbWFfcmVz
dl9pdGVyICpjdXJzb3IpDQogew0KLQl1bnNpZ25lZCBpbnQgaWR4Ow0KKwlzdHJ1Y3QgZG1hX2Zl
bmNlICpmZW5jZTsNCiANCiAJZG1hX3Jlc3ZfYXNzZXJ0X2hlbGQoY3Vyc29yLT5vYmopOw0KIA0K
IAljdXJzb3ItPmlzX3Jlc3RhcnRlZCA9IGZhbHNlOw0KLQlpZiAoIWN1cnNvci0+ZmVuY2VzIHx8
IGN1cnNvci0+aW5kZXggPj0gY3Vyc29yLT5mZW5jZXMtPnNoYXJlZF9jb3VudCkNCisJaWYgKCFj
dXJzb3ItPmZlbmNlcyB8fCBjdXJzb3ItPmluZGV4ID49IGN1cnNvci0+ZmVuY2VzLT5udW1fZmVu
Y2VzKQ0KIAkJcmV0dXJuIE5VTEw7DQogDQotCWlkeCA9IGN1cnNvci0+aW5kZXgrKzsNCi0JcmV0
dXJuIHJjdV9kZXJlZmVyZW5jZV9wcm90ZWN0ZWQoY3Vyc29yLT5mZW5jZXMtPnNoYXJlZFtpZHhd
LA0KLQkJCQkJIGRtYV9yZXN2X2hlbGQoY3Vyc29yLT5vYmopKTsNCisJZG1hX3Jlc3ZfbGlzdF9l
bnRyeShjdXJzb3ItPmZlbmNlcywgY3Vyc29yLT5pbmRleCsrLA0KKwkJCSAgICBjdXJzb3ItPm9i
aiwgJmZlbmNlLCAmY3Vyc29yLT5mZW5jZV91c2FnZSk7DQorCXJldHVybiBmZW5jZTsNCiB9DQog
RVhQT1JUX1NZTUJPTF9HUEwoZG1hX3Jlc3ZfaXRlcl9uZXh0KTsNCiANCkBAIC01NDIsNTcgKzUz
Niw0MyBAQCBpbnQgZG1hX3Jlc3ZfY29weV9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpkc3QsIHN0
cnVjdCBkbWFfcmVzdiAqc3JjKQ0KIHsNCiAJc3RydWN0IGRtYV9yZXN2X2l0ZXIgY3Vyc29yOw0K
IAlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqbGlzdDsNCi0Jc3RydWN0IGRtYV9mZW5jZSAqZiwgKmV4
Y2w7DQorCXN0cnVjdCBkbWFfZmVuY2UgKmY7DQogDQogCWRtYV9yZXN2X2Fzc2VydF9oZWxkKGRz
dCk7DQogDQogCWxpc3QgPSBOVUxMOw0KLQlleGNsID0gTlVMTDsNCiANCiAJZG1hX3Jlc3ZfaXRl
cl9iZWdpbigmY3Vyc29yLCBzcmMsIERNQV9SRVNWX1VTQUdFX1JFQUQpOw0KIAlkbWFfcmVzdl9m
b3JfZWFjaF9mZW5jZV91bmxvY2tlZCgmY3Vyc29yLCBmKSB7DQogDQogCQlpZiAoZG1hX3Jlc3Zf
aXRlcl9pc19yZXN0YXJ0ZWQoJmN1cnNvcikpIHsNCiAJCQlkbWFfcmVzdl9saXN0X2ZyZWUobGlz
dCk7DQotCQkJZG1hX2ZlbmNlX3B1dChleGNsKTsNCi0NCi0JCQlpZiAoY3Vyc29yLnNoYXJlZF9j
b3VudCkgew0KLQkJCQlsaXN0ID0gZG1hX3Jlc3ZfbGlzdF9hbGxvYyhjdXJzb3Iuc2hhcmVkX2Nv
dW50KTsNCi0JCQkJaWYgKCFsaXN0KSB7DQotCQkJCQlkbWFfcmVzdl9pdGVyX2VuZCgmY3Vyc29y
KTsNCi0JCQkJCXJldHVybiAtRU5PTUVNOw0KLQkJCQl9DQogDQotCQkJCWxpc3QtPnNoYXJlZF9j
b3VudCA9IDA7DQotDQotCQkJfSBlbHNlIHsNCi0JCQkJbGlzdCA9IE5VTEw7DQorCQkJbGlzdCA9
IGRtYV9yZXN2X2xpc3RfYWxsb2MoY3Vyc29yLm51bV9mZW5jZXMpOw0KKwkJCWlmICghbGlzdCkg
ew0KKwkJCQlkbWFfcmVzdl9pdGVyX2VuZCgmY3Vyc29yKTsNCisJCQkJcmV0dXJuIC1FTk9NRU07
DQogCQkJfQ0KLQkJCWV4Y2wgPSBOVUxMOw0KKwkJCWxpc3QtPm51bV9mZW5jZXMgPSAwOw0KIAkJ
fQ0KIA0KIAkJZG1hX2ZlbmNlX2dldChmKTsNCi0JCWlmIChkbWFfcmVzdl9pdGVyX2lzX2V4Y2x1
c2l2ZSgmY3Vyc29yKSkNCi0JCQlleGNsID0gZjsNCi0JCWVsc2UNCi0JCQlSQ1VfSU5JVF9QT0lO
VEVSKGxpc3QtPnNoYXJlZFtsaXN0LT5zaGFyZWRfY291bnQrK10sIGYpOw0KKwkJZG1hX3Jlc3Zf
bGlzdF9zZXQobGlzdCwgbGlzdC0+bnVtX2ZlbmNlcysrLCBmLA0KKwkJCQkgIGRtYV9yZXN2X2l0
ZXJfdXNhZ2UoJmN1cnNvcikpOw0KIAl9DQogCWRtYV9yZXN2X2l0ZXJfZW5kKCZjdXJzb3IpOw0K
IA0KIAl3cml0ZV9zZXFjb3VudF9iZWdpbigmZHN0LT5zZXEpOw0KLQlleGNsID0gcmN1X3JlcGxh
Y2VfcG9pbnRlcihkc3QtPmZlbmNlX2V4Y2wsIGV4Y2wsIGRtYV9yZXN2X2hlbGQoZHN0KSk7DQot
CWxpc3QgPSByY3VfcmVwbGFjZV9wb2ludGVyKGRzdC0+ZmVuY2UsIGxpc3QsIGRtYV9yZXN2X2hl
bGQoZHN0KSk7DQorCWxpc3QgPSByY3VfcmVwbGFjZV9wb2ludGVyKGRzdC0+ZmVuY2VzLCBsaXN0
LCBkbWFfcmVzdl9oZWxkKGRzdCkpOw0KIAl3cml0ZV9zZXFjb3VudF9lbmQoJmRzdC0+c2VxKTsN
CiANCiAJZG1hX3Jlc3ZfbGlzdF9mcmVlKGxpc3QpOw0KLQlkbWFfZmVuY2VfcHV0KGV4Y2wpOw0K
LQ0KIAlyZXR1cm4gMDsNCiB9DQogRVhQT1JUX1NZTUJPTChkbWFfcmVzdl9jb3B5X2ZlbmNlcyk7
DQogDQogLyoqDQotICogZG1hX3Jlc3ZfZ2V0X2ZlbmNlcyAtIEdldCBhbiBvYmplY3QncyBzaGFy
ZWQgYW5kIGV4Y2x1c2l2ZQ0KKyAqIGRtYV9yZXN2X2dldF9mZW5jZXMgLSBHZXQgYW4gb2JqZWN0
J3MgZmVuY2VzDQogICogZmVuY2VzIHdpdGhvdXQgdXBkYXRlIHNpZGUgbG9jayBoZWxkDQogICog
QG9iajogdGhlIHJlc2VydmF0aW9uIG9iamVjdA0KICAqIEB1c2FnZTogY29udHJvbHMgd2hpY2gg
ZmVuY2VzIHRvIGluY2x1ZGUsIHNlZSBlbnVtIGRtYV9yZXN2X3VzYWdlLg0KQEAgLTYyMSw3ICs2
MDEsNyBAQCBpbnQgZG1hX3Jlc3ZfZ2V0X2ZlbmNlcyhzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgZW51
bSBkbWFfcmVzdl91c2FnZSB1c2FnZSwNCiAJCQl3aGlsZSAoKm51bV9mZW5jZXMpDQogCQkJCWRt
YV9mZW5jZV9wdXQoKCpmZW5jZXMpWy0tKCpudW1fZmVuY2VzKV0pOw0KIA0KLQkJCWNvdW50ID0g
Y3Vyc29yLnNoYXJlZF9jb3VudCArIDE7DQorCQkJY291bnQgPSBjdXJzb3IubnVtX2ZlbmNlcyAr
IDE7DQogDQogCQkJLyogRXZlbnR1YWxseSByZS1hbGxvY2F0ZSB0aGUgYXJyYXkgKi8NCiAJCQkq
ZmVuY2VzID0ga3JlYWxsb2NfYXJyYXkoKmZlbmNlcywgY291bnQsDQpAQCAtNjkzLDggKzY3Myw3
IEBAIGludCBkbWFfcmVzdl9nZXRfc2luZ2xldG9uKHN0cnVjdCBkbWFfcmVzdiAqb2JqLCBlbnVt
IGRtYV9yZXN2X3VzYWdlIHVzYWdlLA0KIEVYUE9SVF9TWU1CT0xfR1BMKGRtYV9yZXN2X2dldF9z
aW5nbGV0b24pOw0KIA0KIC8qKg0KLSAqIGRtYV9yZXN2X3dhaXRfdGltZW91dCAtIFdhaXQgb24g
cmVzZXJ2YXRpb24ncyBvYmplY3RzDQotICogc2hhcmVkIGFuZC9vciBleGNsdXNpdmUgZmVuY2Vz
Lg0KKyAqIGRtYV9yZXN2X3dhaXRfdGltZW91dCAtIFdhaXQgb24gcmVzZXJ2YXRpb24ncyBvYmpl
Y3RzIGZlbmNlcw0KICAqIEBvYmo6IHRoZSByZXNlcnZhdGlvbiBvYmplY3QNCiAgKiBAdXNhZ2U6
IGNvbnRyb2xzIHdoaWNoIGZlbmNlcyB0byBpbmNsdWRlLCBzZWUgZW51bSBkbWFfcmVzdl91c2Fn
ZS4NCiAgKiBAaW50cjogaWYgdHJ1ZSwgZG8gaW50ZXJydXB0aWJsZSB3YWl0DQpAQCAtNzY3LDEz
ICs3NDYsMTMgQEAgRVhQT1JUX1NZTUJPTF9HUEwoZG1hX3Jlc3ZfdGVzdF9zaWduYWxlZCk7DQog
ICovDQogdm9pZCBkbWFfcmVzdl9kZXNjcmliZShzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0
IHNlcV9maWxlICpzZXEpDQogew0KKwlzdGF0aWMgY29uc3QgY2hhciAqdXNhZ2VbXSA9IHsgImtl
cm5lbCIsICJ3cml0ZSIsICJyZWFkIiwgIm90aGVyIiB9Ow0KIAlzdHJ1Y3QgZG1hX3Jlc3ZfaXRl
ciBjdXJzb3I7DQogCXN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlOw0KIA0KIAlkbWFfcmVzdl9mb3Jf
ZWFjaF9mZW5jZSgmY3Vyc29yLCBvYmosIHRydWUsIGZlbmNlKSB7DQogCQlzZXFfcHJpbnRmKHNl
cSwgIlx0JXMgZmVuY2U6IiwNCi0JCQkgICBkbWFfcmVzdl9pdGVyX2lzX2V4Y2x1c2l2ZSgmY3Vy
c29yKSA/DQotCQkJCSJFeGNsdXNpdmUiIDogIlNoYXJlZCIpOw0KKwkJCSAgIHVzYWdlW2RtYV9y
ZXN2X2l0ZXJfdXNhZ2UoJmN1cnNvcildKTsNCiAJCWRtYV9mZW5jZV9kZXNjcmliZShmZW5jZSwg
c2VxKTsNCiAJfQ0KIH0NCmRpZmYgLS1naXQgYS9kcml2ZXJzL2RtYS1idWYvc3QtZG1hLXJlc3Yu
YyBiL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtcmVzdi5jDQppbmRleCBkMDk3OTgxMDYxYjEuLmQw
ZjdjMmJmZDRmMCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZG1hLWJ1Zi9zdC1kbWEtcmVzdi5jDQor
KysgYi9kcml2ZXJzL2RtYS1idWYvc3QtZG1hLXJlc3YuYw0KQEAgLTU4LDggKzU4LDkgQEAgc3Rh
dGljIGludCBzYW5pdHljaGVjayh2b2lkICphcmcpDQogCXJldHVybiByOw0KIH0NCiANCi1zdGF0
aWMgaW50IHRlc3Rfc2lnbmFsaW5nKHZvaWQgKmFyZywgZW51bSBkbWFfcmVzdl91c2FnZSB1c2Fn
ZSkNCitzdGF0aWMgaW50IHRlc3Rfc2lnbmFsaW5nKHZvaWQgKmFyZykNCiB7DQorCWVudW0gZG1h
X3Jlc3ZfdXNhZ2UgdXNhZ2UgPSAodW5zaWduZWQgbG9uZylhcmc7DQogCXN0cnVjdCBkbWFfcmVz
diByZXN2Ow0KIAlzdHJ1Y3QgZG1hX2ZlbmNlICpmOw0KIAlpbnQgcjsNCkBAIC04MSwxMSArODIs
NyBAQCBzdGF0aWMgaW50IHRlc3Rfc2lnbmFsaW5nKHZvaWQgKmFyZywgZW51bSBkbWFfcmVzdl91
c2FnZSB1c2FnZSkNCiAJCWdvdG8gZXJyX3VubG9jazsNCiAJfQ0KIA0KLQlpZiAodXNhZ2UgPj0g
RE1BX1JFU1ZfVVNBR0VfUkVBRCkNCi0JCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoJnJlc3Ys
IGYpOw0KLQllbHNlDQotCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZSgmcmVzdiwgZik7DQotDQor
CWRtYV9yZXN2X2FkZF9mZW5jZSgmcmVzdiwgZiwgdXNhZ2UpOw0KIAlpZiAoZG1hX3Jlc3ZfdGVz
dF9zaWduYWxlZCgmcmVzdiwgdXNhZ2UpKSB7DQogCQlwcl9lcnIoIlJlc3YgdW5leHBlY3RlZGx5
IHNpZ25hbGVkXG4iKTsNCiAJCXIgPSAtRUlOVkFMOw0KQEAgLTEwNSwxOCArMTAyLDkgQEAgc3Rh
dGljIGludCB0ZXN0X3NpZ25hbGluZyh2b2lkICphcmcsIGVudW0gZG1hX3Jlc3ZfdXNhZ2UgdXNh
Z2UpDQogCXJldHVybiByOw0KIH0NCiANCi1zdGF0aWMgaW50IHRlc3RfZXhjbF9zaWduYWxpbmco
dm9pZCAqYXJnKQ0KLXsNCi0JcmV0dXJuIHRlc3Rfc2lnbmFsaW5nKGFyZywgRE1BX1JFU1ZfVVNB
R0VfV1JJVEUpOw0KLX0NCi0NCi1zdGF0aWMgaW50IHRlc3Rfc2hhcmVkX3NpZ25hbGluZyh2b2lk
ICphcmcpDQotew0KLQlyZXR1cm4gdGVzdF9zaWduYWxpbmcoYXJnLCBETUFfUkVTVl9VU0FHRV9S
RUFEKTsNCi19DQotDQotc3RhdGljIGludCB0ZXN0X2Zvcl9lYWNoKHZvaWQgKmFyZywgZW51bSBk
bWFfcmVzdl91c2FnZSB1c2FnZSkNCitzdGF0aWMgaW50IHRlc3RfZm9yX2VhY2godm9pZCAqYXJn
KQ0KIHsNCisJZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSA9ICh1bnNpZ25lZCBsb25nKWFyZzsN
CiAJc3RydWN0IGRtYV9yZXN2X2l0ZXIgY3Vyc29yOw0KIAlzdHJ1Y3QgZG1hX2ZlbmNlICpmLCAq
ZmVuY2U7DQogCXN0cnVjdCBkbWFfcmVzdiByZXN2Ow0KQEAgLTEzOSwxMCArMTI3LDcgQEAgc3Rh
dGljIGludCB0ZXN0X2Zvcl9lYWNoKHZvaWQgKmFyZywgZW51bSBkbWFfcmVzdl91c2FnZSB1c2Fn
ZSkNCiAJCWdvdG8gZXJyX3VubG9jazsNCiAJfQ0KIA0KLQlpZiAodXNhZ2UgPj0gRE1BX1JFU1Zf
VVNBR0VfUkVBRCkNCi0JCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoJnJlc3YsIGYpOw0KLQll
bHNlDQotCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZSgmcmVzdiwgZik7DQorCWRtYV9yZXN2X2Fk
ZF9mZW5jZSgmcmVzdiwgZiwgdXNhZ2UpOw0KIA0KIAlyID0gLUVOT0VOVDsNCiAJZG1hX3Jlc3Zf
Zm9yX2VhY2hfZmVuY2UoJmN1cnNvciwgJnJlc3YsIHVzYWdlLCBmZW5jZSkgew0KQEAgLTE1Niw4
ICsxNDEsNyBAQCBzdGF0aWMgaW50IHRlc3RfZm9yX2VhY2godm9pZCAqYXJnLCBlbnVtIGRtYV9y
ZXN2X3VzYWdlIHVzYWdlKQ0KIAkJCXIgPSAtRUlOVkFMOw0KIAkJCWdvdG8gZXJyX3VubG9jazsN
CiAJCX0NCi0JCWlmIChkbWFfcmVzdl9pdGVyX2lzX2V4Y2x1c2l2ZSgmY3Vyc29yKSAhPQ0KLQkJ
ICAgICh1c2FnZSA+PSBETUFfUkVTVl9VU0FHRV9SRUFEKSkgew0KKwkJaWYgKGRtYV9yZXN2X2l0
ZXJfdXNhZ2UoJmN1cnNvcikgIT0gdXNhZ2UpIHsNCiAJCQlwcl9lcnIoIlVuZXhwZWN0ZWQgZmVu
Y2UgdXNhZ2VcbiIpOw0KIAkJCXIgPSAtRUlOVkFMOw0KIAkJCWdvdG8gZXJyX3VubG9jazsNCkBA
IC0xNzcsMTggKzE2MSw5IEBAIHN0YXRpYyBpbnQgdGVzdF9mb3JfZWFjaCh2b2lkICphcmcsIGVu
dW0gZG1hX3Jlc3ZfdXNhZ2UgdXNhZ2UpDQogCXJldHVybiByOw0KIH0NCiANCi1zdGF0aWMgaW50
IHRlc3RfZXhjbF9mb3JfZWFjaCh2b2lkICphcmcpDQotew0KLQlyZXR1cm4gdGVzdF9mb3JfZWFj
aChhcmcsIERNQV9SRVNWX1VTQUdFX1dSSVRFKTsNCi19DQotDQotc3RhdGljIGludCB0ZXN0X3No
YXJlZF9mb3JfZWFjaCh2b2lkICphcmcpDQotew0KLQlyZXR1cm4gdGVzdF9mb3JfZWFjaChhcmcs
IERNQV9SRVNWX1VTQUdFX1JFQUQpOw0KLX0NCi0NCi1zdGF0aWMgaW50IHRlc3RfZm9yX2VhY2hf
dW5sb2NrZWQodm9pZCAqYXJnLCBlbnVtIGRtYV9yZXN2X3VzYWdlIHVzYWdlKQ0KK3N0YXRpYyBp
bnQgdGVzdF9mb3JfZWFjaF91bmxvY2tlZCh2b2lkICphcmcpDQogew0KKwllbnVtIGRtYV9yZXN2
X3VzYWdlIHVzYWdlID0gKHVuc2lnbmVkIGxvbmcpYXJnOw0KIAlzdHJ1Y3QgZG1hX3Jlc3ZfaXRl
ciBjdXJzb3I7DQogCXN0cnVjdCBkbWFfZmVuY2UgKmYsICpmZW5jZTsNCiAJc3RydWN0IGRtYV9y
ZXN2IHJlc3Y7DQpAQCAtMjEyLDEwICsxODcsNyBAQCBzdGF0aWMgaW50IHRlc3RfZm9yX2VhY2hf
dW5sb2NrZWQodm9pZCAqYXJnLCBlbnVtIGRtYV9yZXN2X3VzYWdlIHVzYWdlKQ0KIAkJZ290byBl
cnJfZnJlZTsNCiAJfQ0KIA0KLQlpZiAodXNhZ2UgPj0gRE1BX1JFU1ZfVVNBR0VfUkVBRCkNCi0J
CWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoJnJlc3YsIGYpOw0KLQllbHNlDQotCQlkbWFfcmVz
dl9hZGRfZXhjbF9mZW5jZSgmcmVzdiwgZik7DQorCWRtYV9yZXN2X2FkZF9mZW5jZSgmcmVzdiwg
ZiwgdXNhZ2UpOw0KIAlkbWFfcmVzdl91bmxvY2soJnJlc3YpOw0KIA0KIAlyID0gLUVOT0VOVDsN
CkBAIC0yMzUsOCArMjA3LDcgQEAgc3RhdGljIGludCB0ZXN0X2Zvcl9lYWNoX3VubG9ja2VkKHZv
aWQgKmFyZywgZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSkNCiAJCQlyID0gLUVJTlZBTDsNCiAJ
CQlnb3RvIGVycl9pdGVyX2VuZDsNCiAJCX0NCi0JCWlmIChkbWFfcmVzdl9pdGVyX2lzX2V4Y2x1
c2l2ZSgmY3Vyc29yKSAhPQ0KLQkJICAgICh1c2FnZSA+PSBETUFfUkVTVl9VU0FHRV9SRUFEKSkg
ew0KKwkJaWYgKGRtYV9yZXN2X2l0ZXJfdXNhZ2UoJmN1cnNvcikgIT0gdXNhZ2UpIHsNCiAJCQlw
cl9lcnIoIlVuZXhwZWN0ZWQgZmVuY2UgdXNhZ2VcbiIpOw0KIAkJCXIgPSAtRUlOVkFMOw0KIAkJ
CWdvdG8gZXJyX2l0ZXJfZW5kOw0KQEAgLTI2MiwxOCArMjMzLDkgQEAgc3RhdGljIGludCB0ZXN0
X2Zvcl9lYWNoX3VubG9ja2VkKHZvaWQgKmFyZywgZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSkN
CiAJcmV0dXJuIHI7DQogfQ0KIA0KLXN0YXRpYyBpbnQgdGVzdF9leGNsX2Zvcl9lYWNoX3VubG9j
a2VkKHZvaWQgKmFyZykNCi17DQotCXJldHVybiB0ZXN0X2Zvcl9lYWNoX3VubG9ja2VkKGFyZywg
RE1BX1JFU1ZfVVNBR0VfV1JJVEUpOw0KLX0NCi0NCi1zdGF0aWMgaW50IHRlc3Rfc2hhcmVkX2Zv
cl9lYWNoX3VubG9ja2VkKHZvaWQgKmFyZykNCi17DQotCXJldHVybiB0ZXN0X2Zvcl9lYWNoX3Vu
bG9ja2VkKGFyZywgRE1BX1JFU1ZfVVNBR0VfUkVBRCk7DQotfQ0KLQ0KLXN0YXRpYyBpbnQgdGVz
dF9nZXRfZmVuY2VzKHZvaWQgKmFyZywgZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSkNCitzdGF0
aWMgaW50IHRlc3RfZ2V0X2ZlbmNlcyh2b2lkICphcmcpDQogew0KKwllbnVtIGRtYV9yZXN2X3Vz
YWdlIHVzYWdlID0gKHVuc2lnbmVkIGxvbmcpYXJnOw0KIAlzdHJ1Y3QgZG1hX2ZlbmNlICpmLCAq
KmZlbmNlcyA9IE5VTEw7DQogCXN0cnVjdCBkbWFfcmVzdiByZXN2Ow0KIAlpbnQgciwgaTsNCkBA
IC0yOTYsMTAgKzI1OCw3IEBAIHN0YXRpYyBpbnQgdGVzdF9nZXRfZmVuY2VzKHZvaWQgKmFyZywg
ZW51bSBkbWFfcmVzdl91c2FnZSB1c2FnZSkNCiAJCWdvdG8gZXJyX3Jlc3Y7DQogCX0NCiANCi0J
aWYgKHVzYWdlID49IERNQV9SRVNWX1VTQUdFX1JFQUQpDQotCQlkbWFfcmVzdl9hZGRfc2hhcmVk
X2ZlbmNlKCZyZXN2LCBmKTsNCi0JZWxzZQ0KLQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UoJnJl
c3YsIGYpOw0KKwlkbWFfcmVzdl9hZGRfZmVuY2UoJnJlc3YsIGYsIHVzYWdlKTsNCiAJZG1hX3Jl
c3ZfdW5sb2NrKCZyZXN2KTsNCiANCiAJciA9IGRtYV9yZXN2X2dldF9mZW5jZXMoJnJlc3YsIHVz
YWdlLCAmaSwgJmZlbmNlcyk7DQpAQCAtMzI0LDMwICsyODMsMjQgQEAgc3RhdGljIGludCB0ZXN0
X2dldF9mZW5jZXModm9pZCAqYXJnLCBlbnVtIGRtYV9yZXN2X3VzYWdlIHVzYWdlKQ0KIAlyZXR1
cm4gcjsNCiB9DQogDQotc3RhdGljIGludCB0ZXN0X2V4Y2xfZ2V0X2ZlbmNlcyh2b2lkICphcmcp
DQotew0KLQlyZXR1cm4gdGVzdF9nZXRfZmVuY2VzKGFyZywgRE1BX1JFU1ZfVVNBR0VfV1JJVEUp
Ow0KLX0NCi0NCi1zdGF0aWMgaW50IHRlc3Rfc2hhcmVkX2dldF9mZW5jZXModm9pZCAqYXJnKQ0K
LXsNCi0JcmV0dXJuIHRlc3RfZ2V0X2ZlbmNlcyhhcmcsIERNQV9SRVNWX1VTQUdFX1JFQUQpOw0K
LX0NCi0NCiBpbnQgZG1hX3Jlc3Yodm9pZCkNCiB7DQogCXN0YXRpYyBjb25zdCBzdHJ1Y3Qgc3Vi
dGVzdCB0ZXN0c1tdID0gew0KIAkJU1VCVEVTVChzYW5pdHljaGVjayksDQotCQlTVUJURVNUKHRl
c3RfZXhjbF9zaWduYWxpbmcpLA0KLQkJU1VCVEVTVCh0ZXN0X3NoYXJlZF9zaWduYWxpbmcpLA0K
LQkJU1VCVEVTVCh0ZXN0X2V4Y2xfZm9yX2VhY2gpLA0KLQkJU1VCVEVTVCh0ZXN0X3NoYXJlZF9m
b3JfZWFjaCksDQotCQlTVUJURVNUKHRlc3RfZXhjbF9mb3JfZWFjaF91bmxvY2tlZCksDQotCQlT
VUJURVNUKHRlc3Rfc2hhcmVkX2Zvcl9lYWNoX3VubG9ja2VkKSwNCi0JCVNVQlRFU1QodGVzdF9l
eGNsX2dldF9mZW5jZXMpLA0KLQkJU1VCVEVTVCh0ZXN0X3NoYXJlZF9nZXRfZmVuY2VzKSwNCisJ
CVNVQlRFU1QodGVzdF9zaWduYWxpbmcpLA0KKwkJU1VCVEVTVCh0ZXN0X2Zvcl9lYWNoKSwNCisJ
CVNVQlRFU1QodGVzdF9mb3JfZWFjaF91bmxvY2tlZCksDQorCQlTVUJURVNUKHRlc3RfZ2V0X2Zl
bmNlcyksDQogCX07DQorCWVudW0gZG1hX3Jlc3ZfdXNhZ2UgdXNhZ2U7DQorCWludCByOw0KIA0K
IAlzcGluX2xvY2tfaW5pdCgmZmVuY2VfbG9jayk7DQotCXJldHVybiBzdWJ0ZXN0cyh0ZXN0cywg
TlVMTCk7DQorCWZvciAodXNhZ2UgPSBETUFfUkVTVl9VU0FHRV9XUklURTsgdXNhZ2UgPD0gRE1B
X1JFU1ZfVVNBR0VfUkVBRDsNCisJICAgICArK3VzYWdlKSB7DQorCQlyID0gc3VidGVzdHModGVz
dHMsICh2b2lkICopKHVuc2lnbmVkIGxvbmcpdXNhZ2UpOw0KKwkJaWYgKHIpDQorCQkJcmV0dXJu
IHI7DQorCX0NCisJcmV0dXJuIDA7DQogfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9h
bWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRfZ3B1dm0uYyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1k
Z3B1L2FtZGdwdV9hbWRrZmRfZ3B1dm0uYw0KaW5kZXggN2RlOGY2N2Y3ZGRlLi5hYjVkNmI2MzBh
NDkgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfYW1ka2Zk
X2dwdXZtLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9hbWRrZmRf
Z3B1dm0uYw0KQEAgLTI2Myw3ICsyNjMsNyBAQCBzdGF0aWMgaW50IGFtZGdwdV9hbWRrZmRfcmVt
b3ZlX2V2aWN0aW9uX2ZlbmNlKHN0cnVjdCBhbWRncHVfYm8gKmJvLA0KIAkgKi8NCiAJcmVwbGFj
ZW1lbnQgPSBkbWFfZmVuY2VfZ2V0X3N0dWIoKTsNCiAJZG1hX3Jlc3ZfcmVwbGFjZV9mZW5jZXMo
Ym8tPnRiby5iYXNlLnJlc3YsIGVmLT5iYXNlLmNvbnRleHQsDQotCQkJCXJlcGxhY2VtZW50KTsN
CisJCQkJcmVwbGFjZW1lbnQsIERNQV9SRVNWX1VTQUdFX1JFQUQpOw0KIAlkbWFfZmVuY2VfcHV0
KHJlcGxhY2VtZW50KTsNCiAJcmV0dXJuIDA7DQogfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1
L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jIGIvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUv
YW1kZ3B1X2NzLmMNCmluZGV4IDk1YzQzNzBhMDU0OS4uYzIxYWU2Njk0ZGY3IDEwMDY0NA0KLS0t
IGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1kZ3B1X2NzLmMNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9hbWQvYW1kZ3B1L2FtZGdwdV9jcy5jDQpAQCAtNTQsOCArNTQsOCBAQCBzdGF0aWMg
aW50IGFtZGdwdV9jc191c2VyX2ZlbmNlX2NodW5rKHN0cnVjdCBhbWRncHVfY3NfcGFyc2VyICpw
LA0KIAlibyA9IGFtZGdwdV9ib19yZWYoZ2VtX3RvX2FtZGdwdV9ibyhnb2JqKSk7DQogCXAtPnVm
X2VudHJ5LnByaW9yaXR5ID0gMDsNCiAJcC0+dWZfZW50cnkudHYuYm8gPSAmYm8tPnRibzsNCi0J
LyogT25lIGZvciBUVE0gYW5kIG9uZSBmb3IgdGhlIENTIGpvYiAqLw0KLQlwLT51Zl9lbnRyeS50
di5udW1fc2hhcmVkID0gMjsNCisJLyogT25lIGZvciBUVE0gYW5kIHR3byBmb3IgdGhlIENTIGpv
YiAqLw0KKwlwLT51Zl9lbnRyeS50di5udW1fc2hhcmVkID0gMzsNCiANCiAJZHJtX2dlbV9vYmpl
Y3RfcHV0KGdvYmopOw0KIA0KQEAgLTEyODQsNyArMTI4NCw3IEBAIHN0YXRpYyBpbnQgYW1kZ3B1
X2NzX3N1Ym1pdChzdHJ1Y3QgYW1kZ3B1X2NzX3BhcnNlciAqcCwNCiAJCQlicmVhazsNCiAJCX0N
CiAJCWRtYV9mZW5jZV9jaGFpbl9pbml0KGNoYWluLCBmZW5jZSwgZG1hX2ZlbmNlX2dldChwLT5m
ZW5jZSksIDEpOw0KLQkJcmN1X2Fzc2lnbl9wb2ludGVyKHJlc3YtPmZlbmNlX2V4Y2wsICZjaGFp
bi0+YmFzZSk7DQorCQlkbWFfcmVzdl9hZGRfZmVuY2UocmVzdiwgJmNoYWluLT5iYXNlLCBETUFf
UkVTVl9VU0FHRV9XUklURSk7DQogCQllLT5jaGFpbiA9IE5VTEw7DQogCX0NCiANCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMgYi9kcml2ZXJz
L2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2JqZWN0LmMNCmluZGV4IDE2OGJhYzY2MGFlMi4u
N2I1MDZlYjk2YTY1IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL2FtZC9hbWRncHUvYW1k
Z3B1X29iamVjdC5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vYW1kL2FtZGdwdS9hbWRncHVfb2Jq
ZWN0LmMNCkBAIC0xMzkzLDEwICsxMzkzLDggQEAgdm9pZCBhbWRncHVfYm9fZmVuY2Uoc3RydWN0
IGFtZGdwdV9ibyAqYm8sIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLA0KIAkJcmV0dXJuOw0KIAl9
DQogDQotCWlmIChzaGFyZWQpDQotCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHJlc3YsIGZl
bmNlKTsNCi0JZWxzZQ0KLQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UocmVzdiwgZmVuY2UpOw0K
KwlkbWFfcmVzdl9hZGRfZmVuY2UocmVzdiwgZmVuY2UsIHNoYXJlZCA/IERNQV9SRVNWX1VTQUdF
X1JFQUQgOg0KKwkJCSAgIERNQV9SRVNWX1VTQUdFX1dSSVRFKTsNCiB9DQogDQogLyoqDQpkaWZm
IC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRuYXZpdl9nZW1fc3VibWl0LmMgYi9k
cml2ZXJzL2dwdS9kcm0vZXRuYXZpdi9ldG5hdml2X2dlbV9zdWJtaXQuYw0KaW5kZXggZDdjZDI2
ZGZhZjhhLi4wY2MwMzZkOTNhZmMgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZXRuYXZp
di9ldG5hdml2X2dlbV9zdWJtaXQuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2V0bmF2aXYvZXRu
YXZpdl9nZW1fc3VibWl0LmMNCkBAIC0yMDMsMTQgKzIwMywxMCBAQCBzdGF0aWMgdm9pZCBzdWJt
aXRfYXR0YWNoX29iamVjdF9mZW5jZXMoc3RydWN0IGV0bmF2aXZfZ2VtX3N1Ym1pdCAqc3VibWl0
KQ0KIA0KIAlmb3IgKGkgPSAwOyBpIDwgc3VibWl0LT5ucl9ib3M7IGkrKykgew0KIAkJc3RydWN0
IGRybV9nZW1fb2JqZWN0ICpvYmogPSAmc3VibWl0LT5ib3NbaV0ub2JqLT5iYXNlOw0KKwkJYm9v
bCB3cml0ZSA9IHN1Ym1pdC0+Ym9zW2ldLmZsYWdzICYgRVROQV9TVUJNSVRfQk9fV1JJVEU7DQog
DQotCQlpZiAoc3VibWl0LT5ib3NbaV0uZmxhZ3MgJiBFVE5BX1NVQk1JVF9CT19XUklURSkNCi0J
CQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShvYmotPnJlc3YsDQotCQkJCQkJCSAgc3VibWl0LT5v
dXRfZmVuY2UpOw0KLQkJZWxzZQ0KLQkJCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2Uob2JqLT5y
ZXN2LA0KLQkJCQkJCQkgICAgc3VibWl0LT5vdXRfZmVuY2UpOw0KLQ0KKwkJZG1hX3Jlc3ZfYWRk
X2ZlbmNlKG9iai0+cmVzdiwgc3VibWl0LT5vdXRfZmVuY2UsIHdyaXRlID8NCisJCQkJICAgRE1B
X1JFU1ZfVVNBR0VfV1JJVEUgOiBETUFfUkVTVl9VU0FHRV9SRUFEKTsNCiAJCXN1Ym1pdF91bmxv
Y2tfb2JqZWN0KHN1Ym1pdCwgaSk7DQogCX0NCiB9DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2J1c3kuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2dlbS9p
OTE1X2dlbV9idXN5LmMNCmluZGV4IDE0YTFjMGFkOGMzYy4uZTdhZTk0ZWUxYjQ0IDEwMDY0NA0K
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2J1c3kuYw0KKysrIGIvZHJp
dmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2J1c3kuYw0KQEAgLTE0OCwxMiArMTQ4LDEz
IEBAIGk5MTVfZ2VtX2J1c3lfaW9jdGwoc3RydWN0IGRybV9kZXZpY2UgKmRldiwgdm9pZCAqZGF0
YSwNCiAJCWlmIChkbWFfcmVzdl9pdGVyX2lzX3Jlc3RhcnRlZCgmY3Vyc29yKSkNCiAJCQlhcmdz
LT5idXN5ID0gMDsNCiANCi0JCWlmIChkbWFfcmVzdl9pdGVyX2lzX2V4Y2x1c2l2ZSgmY3Vyc29y
KSkNCi0JCQkvKiBUcmFuc2xhdGUgdGhlIGV4Y2x1c2l2ZSBmZW5jZSB0byB0aGUgUkVBRCAqYW5k
KiBXUklURSBlbmdpbmUgKi8NCi0JCQlhcmdzLT5idXN5IHw9IGJ1c3lfY2hlY2tfd3JpdGVyKGZl
bmNlKTsNCi0JCWVsc2UNCi0JCQkvKiBUcmFuc2xhdGUgc2hhcmVkIGZlbmNlcyB0byBSRUFEIHNl
dCBvZiBlbmdpbmVzICovDQotCQkJYXJncy0+YnVzeSB8PSBidXN5X2NoZWNrX3JlYWRlcihmZW5j
ZSk7DQorCQkvKiBUcmFuc2xhdGUgcmVhZCBmZW5jZXMgdG8gUkVBRCBzZXQgb2YgZW5naW5lcyAq
Lw0KKwkJYXJncy0+YnVzeSB8PSBidXN5X2NoZWNrX3JlYWRlcihmZW5jZSk7DQorCX0NCisJZG1h
X3Jlc3ZfaXRlcl9iZWdpbigmY3Vyc29yLCBvYmotPmJhc2UucmVzdiwgRE1BX1JFU1ZfVVNBR0Vf
V1JJVEUpOw0KKwlkbWFfcmVzdl9mb3JfZWFjaF9mZW5jZV91bmxvY2tlZCgmY3Vyc29yLCBmZW5j
ZSkgew0KKwkJLyogVHJhbnNsYXRlIHRoZSB3cml0ZSBmZW5jZXMgdG8gdGhlIFJFQUQgKmFuZCog
V1JJVEUgZW5naW5lICovDQorCQlhcmdzLT5idXN5IHw9IGJ1c3lfY2hlY2tfd3JpdGVyKGZlbmNl
KTsNCiAJfQ0KIAlkbWFfcmVzdl9pdGVyX2VuZCgmY3Vyc29yKTsNCiANCmRpZmYgLS1naXQgYS9k
cml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVzaC5jIGIvZHJpdmVycy9ncHUv
ZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX2NsZmx1c2guYw0KaW5kZXggOGEyMjIzZWIwYmE5Li44ODdj
YjZiNzFhZTQgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1f
Y2xmbHVzaC5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fY2xmbHVz
aC5jDQpAQCAtMTE0LDcgKzExNCw4IEBAIGJvb2wgaTkxNV9nZW1fY2xmbHVzaF9vYmplY3Qoc3Ry
dWN0IGRybV9pOTE1X2dlbV9vYmplY3QgKm9iaiwNCiAJCQkJCQlvYmotPmJhc2UucmVzdiwgTlVM
TCwgdHJ1ZSwNCiAJCQkJCQlpOTE1X2ZlbmNlX3RpbWVvdXQoaTkxNSksDQogCQkJCQkJSTkxNV9G
RU5DRV9HRlApOw0KLQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2Uob2JqLT5iYXNlLnJlc3YsICZj
bGZsdXNoLT5iYXNlLmRtYSk7DQorCQlkbWFfcmVzdl9hZGRfZmVuY2Uob2JqLT5iYXNlLnJlc3Ys
ICZjbGZsdXNoLT5iYXNlLmRtYSwNCisJCQkJICAgRE1BX1JFU1ZfVVNBR0VfV1JJVEUpOw0KIAkJ
ZG1hX2ZlbmNlX3dvcmtfY29tbWl0KCZjbGZsdXNoLT5iYXNlKTsNCiAJCS8qDQogCQkgKiBXZSBt
dXN0IGhhdmUgc3VjY2Vzc2Z1bGx5IHBvcHVsYXRlZCB0aGUgcGFnZXMoc2luY2Ugd2UgYXJlDQpk
aWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2VtL2k5MTVfZ2VtX3R0bV9tb3ZlLmMg
Yi9kcml2ZXJzL2dwdS9kcm0vaTkxNS9nZW0vaTkxNV9nZW1fdHRtX21vdmUuYw0KaW5kZXggNGRl
NjUwMGYzYzU1Li5lNGEyMzJlMjJmOWQgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vaTkx
NS9nZW0vaTkxNV9nZW1fdHRtX21vdmUuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5MTUvZ2Vt
L2k5MTVfZ2VtX3R0bV9tb3ZlLmMNCkBAIC02MjIsOSArNjIyLDggQEAgaW50IGk5MTVfZ2VtX29i
al9jb3B5X3R0bShzdHJ1Y3QgZHJtX2k5MTVfZ2VtX29iamVjdCAqZHN0LA0KIAlpZiAoSVNfRVJS
X09SX05VTEwoY29weV9mZW5jZSkpDQogCQlyZXR1cm4gUFRSX0VSUl9PUl9aRVJPKGNvcHlfZmVu
Y2UpOw0KIA0KLQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZShkc3RfYm8tPmJhc2UucmVzdiwgY29w
eV9mZW5jZSk7DQotCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2Uoc3JjX2JvLT5iYXNlLnJlc3Ys
IGNvcHlfZmVuY2UpOw0KLQ0KKwlkbWFfcmVzdl9hZGRfZmVuY2UoZHN0X2JvLT5iYXNlLnJlc3Ys
IGNvcHlfZmVuY2UsIERNQV9SRVNWX1VTQUdFX1dSSVRFKTsNCisJZG1hX3Jlc3ZfYWRkX2ZlbmNl
KHNyY19iby0+YmFzZS5yZXN2LCBjb3B5X2ZlbmNlLCBETUFfUkVTVl9VU0FHRV9SRUFEKTsNCiAJ
ZG1hX2ZlbmNlX3B1dChjb3B5X2ZlbmNlKTsNCiANCiAJcmV0dXJuIDA7DQpkaWZmIC0tZ2l0IGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYyBiL2RyaXZlcnMvZ3B1L2RybS9pOTE1L2k5
MTVfdm1hLmMNCmluZGV4IGZlOWY4OTI4OTQxOC4uNTJmZDY3MDVhNTE4IDEwMDY0NA0KLS0tIGEv
ZHJpdmVycy9ncHUvZHJtL2k5MTUvaTkxNV92bWEuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2k5
MTUvaTkxNV92bWEuYw0KQEAgLTE2NDAsNyArMTY0MCw4IEBAIGludCBfaTkxNV92bWFfbW92ZV90
b19hY3RpdmUoc3RydWN0IGk5MTVfdm1hICp2bWEsDQogCQl9DQogDQogCQlpZiAoZmVuY2UpIHsN
Ci0JCQlkbWFfcmVzdl9hZGRfZXhjbF9mZW5jZSh2bWEtPm9iai0+YmFzZS5yZXN2LCBmZW5jZSk7
DQorCQkJZG1hX3Jlc3ZfYWRkX2ZlbmNlKHZtYS0+b2JqLT5iYXNlLnJlc3YsIGZlbmNlLA0KKwkJ
CQkJICAgRE1BX1JFU1ZfVVNBR0VfV1JJVEUpOw0KIAkJCW9iai0+d3JpdGVfZG9tYWluID0gSTkx
NV9HRU1fRE9NQUlOX1JFTkRFUjsNCiAJCQlvYmotPnJlYWRfZG9tYWlucyA9IDA7DQogCQl9DQpA
QCAtMTY1Miw3ICsxNjUzLDggQEAgaW50IF9pOTE1X3ZtYV9tb3ZlX3RvX2FjdGl2ZShzdHJ1Y3Qg
aTkxNV92bWEgKnZtYSwNCiAJCX0NCiANCiAJCWlmIChmZW5jZSkgew0KLQkJCWRtYV9yZXN2X2Fk
ZF9zaGFyZWRfZmVuY2Uodm1hLT5vYmotPmJhc2UucmVzdiwgZmVuY2UpOw0KKwkJCWRtYV9yZXN2
X2FkZF9mZW5jZSh2bWEtPm9iai0+YmFzZS5yZXN2LCBmZW5jZSwNCisJCQkJCSAgIERNQV9SRVNW
X1VTQUdFX1JFQUQpOw0KIAkJCW9iai0+d3JpdGVfZG9tYWluID0gMDsNCiAJCX0NCiAJfQ0KZGlm
ZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfZ2VtLmMgYi9kcml2ZXJzL2dwdS9k
cm0vbGltYS9saW1hX2dlbS5jDQppbmRleCA2NTY4MTJmMGJmMzguLmNjMDc2YmQ4NzMyMyAxMDA2
NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9saW1hL2xpbWFfZ2VtLmMNCisrKyBiL2RyaXZlcnMv
Z3B1L2RybS9saW1hL2xpbWFfZ2VtLmMNCkBAIC0zNjUsNyArMzY1LDcgQEAgaW50IGxpbWFfZ2Vt
X3N1Ym1pdChzdHJ1Y3QgZHJtX2ZpbGUgKmZpbGUsIHN0cnVjdCBsaW1hX3N1Ym1pdCAqc3VibWl0
KQ0KIAkJaWYgKHN1Ym1pdC0+Ym9zW2ldLmZsYWdzICYgTElNQV9TVUJNSVRfQk9fV1JJVEUpDQog
CQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UobGltYV9ib19yZXN2KGJvc1tpXSksIGZlbmNlKTsN
CiAJCWVsc2UNCi0JCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKGxpbWFfYm9fcmVzdihib3Nb
aV0pLCBmZW5jZSk7DQorCQkJZG1hX3Jlc3ZfYWRkX2ZlbmNlKGxpbWFfYm9fcmVzdihib3NbaV0p
LCBmZW5jZSk7DQogCX0NCiANCiAJZHJtX2dlbV91bmxvY2tfcmVzZXJ2YXRpb25zKChzdHJ1Y3Qg
ZHJtX2dlbV9vYmplY3QgKiopYm9zLA0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9tc20v
bXNtX2dlbV9zdWJtaXQuYyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNtX2dlbV9zdWJtaXQuYw0K
aW5kZXggOTkzZGJjZDdhNTg2Li4yNzg2OTEzYmUwMGEgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dw
dS9kcm0vbXNtL21zbV9nZW1fc3VibWl0LmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9tc20vbXNt
X2dlbV9zdWJtaXQuYw0KQEAgLTM5Nyw3ICszOTcsNyBAQCBzdGF0aWMgdm9pZCBzdWJtaXRfYXR0
YWNoX29iamVjdF9mZW5jZXMoc3RydWN0IG1zbV9nZW1fc3VibWl0ICpzdWJtaXQpDQogCQlpZiAo
c3VibWl0LT5ib3NbaV0uZmxhZ3MgJiBNU01fU1VCTUlUX0JPX1dSSVRFKQ0KIAkJCWRtYV9yZXN2
X2FkZF9leGNsX2ZlbmNlKG9iai0+cmVzdiwgc3VibWl0LT51c2VyX2ZlbmNlKTsNCiAJCWVsc2Ug
aWYgKHN1Ym1pdC0+Ym9zW2ldLmZsYWdzICYgTVNNX1NVQk1JVF9CT19SRUFEKQ0KLQkJCWRtYV9y
ZXN2X2FkZF9zaGFyZWRfZmVuY2Uob2JqLT5yZXN2LCBzdWJtaXQtPnVzZXJfZmVuY2UpOw0KKwkJ
CWRtYV9yZXN2X2FkZF9mZW5jZShvYmotPnJlc3YsIHN1Ym1pdC0+dXNlcl9mZW5jZSk7DQogCX0N
CiB9DQogDQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5j
IGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jDQppbmRleCBjNmJiNGRiY2Q3
MzUuLjA1MDc2ZTUzMGU3ZCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9ub3V2ZWF1L25v
dXZlYXVfYm8uYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVhdV9iby5jDQpA
QCAtMTMwOCwxMCArMTMwOCwxMSBAQCBub3V2ZWF1X2JvX2ZlbmNlKHN0cnVjdCBub3V2ZWF1X2Jv
ICpudmJvLCBzdHJ1Y3Qgbm91dmVhdV9mZW5jZSAqZmVuY2UsIGJvb2wgZXhjbA0KIHsNCiAJc3Ry
dWN0IGRtYV9yZXN2ICpyZXN2ID0gbnZiby0+Ym8uYmFzZS5yZXN2Ow0KIA0KLQlpZiAoZXhjbHVz
aXZlKQ0KLQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UocmVzdiwgJmZlbmNlLT5iYXNlKTsNCi0J
ZWxzZSBpZiAoZmVuY2UpDQotCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKHJlc3YsICZmZW5j
ZS0+YmFzZSk7DQorCWlmICghZmVuY2UpDQorCQlyZXR1cm47DQorDQorCWRtYV9yZXN2X2FkZF9m
ZW5jZShyZXN2LCAmZmVuY2UtPmJhc2UsIGV4Y2x1c2l2ZSA/DQorCQkJICAgRE1BX1JFU1ZfVVNB
R0VfV1JJVEUgOiBETUFfUkVTVl9VU0FHRV9SRUFEKTsNCiB9DQogDQogc3RhdGljIHZvaWQNCmRp
ZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2ZlbmNlLmMgYi9kcml2
ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2ZlbmNlLmMNCmluZGV4IGQ1ZTgxY2NlZTAxYy4u
N2YwMWRjZjgxZmFiIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL25vdXZlYXUvbm91dmVh
dV9mZW5jZS5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vbm91dmVhdS9ub3V2ZWF1X2ZlbmNlLmMN
CkBAIC0zNjAsOSArMzYwLDExIEBAIG5vdXZlYXVfZmVuY2Vfc3luYyhzdHJ1Y3Qgbm91dmVhdV9i
byAqbnZibywgc3RydWN0IG5vdXZlYXVfY2hhbm5lbCAqY2hhbiwNCiAJCWRtYV9yZXN2X2Zvcl9l
YWNoX2ZlbmNlKCZjdXJzb3IsIHJlc3YsDQogCQkJCQlkbWFfcmVzdl91c2FnZV9ydyhleGNsdXNp
dmUpLA0KIAkJCQkJZmVuY2UpIHsNCisJCQllbnVtIGRtYV9yZXN2X3VzYWdlIHVzYWdlOw0KIAkJ
CXN0cnVjdCBub3V2ZWF1X2ZlbmNlICpmOw0KIA0KLQkJCWlmIChpID09IDAgJiYgZG1hX3Jlc3Zf
aXRlcl9pc19leGNsdXNpdmUoJmN1cnNvcikpDQorCQkJdXNhZ2UgPSBkbWFfcmVzdl9pdGVyX3Vz
YWdlKCZjdXJzb3IpOw0KKwkJCWlmIChpID09IDAgJiYgdXNhZ2UgPT0gRE1BX1JFU1ZfVVNBR0Vf
V1JJVEUpDQogCQkJCWNvbnRpbnVlOw0KIA0KIAkJCWYgPSBub3V2ZWF1X2xvY2FsX2ZlbmNlKGZl
bmNlLCBjaGFuLT5kcm0pOw0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3Jl
bGVhc2UuYyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3JlbGVhc2UuYw0KaW5kZXggY2RlMWU4
ZGRhZWFhLi4zNjhkMjZkYTBkNmEgMTAwNjQ0DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vcXhsL3F4
bF9yZWxlYXNlLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS9xeGwvcXhsX3JlbGVhc2UuYw0KQEAg
LTQyOSw3ICs0MjksOCBAQCB2b2lkIHF4bF9yZWxlYXNlX2ZlbmNlX2J1ZmZlcl9vYmplY3RzKHN0
cnVjdCBxeGxfcmVsZWFzZSAqcmVsZWFzZSkNCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShlbnRyeSwg
JnJlbGVhc2UtPmJvcywgaGVhZCkgew0KIAkJYm8gPSBlbnRyeS0+Ym87DQogDQotCQlkbWFfcmVz
dl9hZGRfc2hhcmVkX2ZlbmNlKGJvLT5iYXNlLnJlc3YsICZyZWxlYXNlLT5iYXNlKTsNCisJCWRt
YV9yZXN2X2FkZF9mZW5jZShiby0+YmFzZS5yZXN2LCAmcmVsZWFzZS0+YmFzZSwNCisJCQkJICAg
RE1BX1JFU1ZfVVNBR0VfUkVBRCk7DQogCQl0dG1fYm9fbW92ZV90b19scnVfdGFpbF91bmxvY2tl
ZChibyk7DQogCQlkbWFfcmVzdl91bmxvY2soYm8tPmJhc2UucmVzdik7DQogCX0NCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYyBiL2RyaXZlcnMvZ3B1
L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5jDQppbmRleCA4NzBiMTM2MzVkYmYuLjUyYWI5YWFm
MjIzNCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9yYWRlb24vcmFkZW9uX29iamVjdC5j
DQorKysgYi9kcml2ZXJzL2dwdS9kcm0vcmFkZW9uL3JhZGVvbl9vYmplY3QuYw0KQEAgLTgxNyw4
ICs4MTcsNiBAQCB2b2lkIHJhZGVvbl9ib19mZW5jZShzdHJ1Y3QgcmFkZW9uX2JvICpibywgc3Ry
dWN0IHJhZGVvbl9mZW5jZSAqZmVuY2UsDQogCQlyZXR1cm47DQogCX0NCiANCi0JaWYgKHNoYXJl
ZCkNCi0JCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UocmVzdiwgJmZlbmNlLT5iYXNlKTsNCi0J
ZWxzZQ0KLQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UocmVzdiwgJmZlbmNlLT5iYXNlKTsNCisJ
ZG1hX3Jlc3ZfYWRkX2ZlbmNlKHJlc3YsICZmZW5jZS0+YmFzZSwgc2hhcmVkID8NCisJCQkgICBE
TUFfUkVTVl9VU0FHRV9SRUFEIDogRE1BX1JFU1ZfVVNBR0VfV1JJVEUpOw0KIH0NCmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90
dG1fYm8uYw0KaW5kZXggZDRiMjY5NTYwNmUyLi42MDE0YzM2M2Q2ZTYgMTAwNjQ0DQotLS0gYS9k
cml2ZXJzL2dwdS9kcm0vdHRtL3R0bV9iby5jDQorKysgYi9kcml2ZXJzL2dwdS9kcm0vdHRtL3R0
bV9iby5jDQpAQCAtNzYyLDcgKzc2Miw3IEBAIHN0YXRpYyBpbnQgdHRtX2JvX2FkZF9tb3ZlX2Zl
bmNlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAqYm8sDQogCQlyZXR1cm4gcmV0Ow0KIAl9DQog
DQotCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UoYm8tPmJhc2UucmVzdiwgZmVuY2UpOw0KKwlk
bWFfcmVzdl9hZGRfZmVuY2UoYm8tPmJhc2UucmVzdiwgZmVuY2UsIERNQV9SRVNWX1VTQUdFX1dS
SVRFKTsNCiANCiAJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9mZW5jZXMoYm8tPmJhc2UucmVzdiwg
MSk7DQogCWlmICh1bmxpa2VseShyZXQpKSB7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJt
L3R0bS90dG1fYm9fdXRpbC5jIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9fdXRpbC5jDQpp
bmRleCA4NjJkMmYyMjQxMmEuLjQ5Njg5YzdjODA3OCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1
L2RybS90dG0vdHRtX2JvX3V0aWwuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fYm9f
dXRpbC5jDQpAQCAtNTA4LDcgKzUwOCw4IEBAIHN0YXRpYyBpbnQgdHRtX2JvX21vdmVfdG9fZ2hv
c3Qoc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibywNCiAJaWYgKHJldCkNCiAJCXJldHVybiBy
ZXQ7DQogDQotCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKCZnaG9zdF9vYmotPmJhc2UuX3Jlc3Ys
IGZlbmNlKTsNCisJZG1hX3Jlc3ZfYWRkX2ZlbmNlKCZnaG9zdF9vYmotPmJhc2UuX3Jlc3YsIGZl
bmNlLA0KKwkJCSAgIERNQV9SRVNWX1VTQUdFX1dSSVRFKTsNCiANCiAJLyoqDQogCSAqIElmIHdl
J3JlIG5vdCBtb3ZpbmcgdG8gZml4ZWQgbWVtb3J5LCB0aGUgVFRNIG9iamVjdA0KQEAgLTU2Miw3
ICs1NjMsNyBAQCBpbnQgdHRtX2JvX21vdmVfYWNjZWxfY2xlYW51cChzdHJ1Y3QgdHRtX2J1ZmZl
cl9vYmplY3QgKmJvLA0KIAlzdHJ1Y3QgdHRtX3Jlc291cmNlX21hbmFnZXIgKm1hbiA9IHR0bV9t
YW5hZ2VyX3R5cGUoYmRldiwgbmV3X21lbS0+bWVtX3R5cGUpOw0KIAlpbnQgcmV0ID0gMDsNCiAN
Ci0JZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UoYm8tPmJhc2UucmVzdiwgZmVuY2UpOw0KKwlkbWFf
cmVzdl9hZGRfZmVuY2UoYm8tPmJhc2UucmVzdiwgZmVuY2UsIERNQV9SRVNWX1VTQUdFX1dSSVRF
KTsNCiAJaWYgKCFldmljdCkNCiAJCXJldCA9IHR0bV9ib19tb3ZlX3RvX2dob3N0KGJvLCBmZW5j
ZSwgbWFuLT51c2VfdHQpOw0KIAllbHNlIGlmICghZnJvbS0+dXNlX3R0ICYmIHBpcGVsaW5lKQ0K
ZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2V4ZWNidWZfdXRpbC5jIGIvZHJp
dmVycy9ncHUvZHJtL3R0bS90dG1fZXhlY2J1Zl91dGlsLmMNCmluZGV4IDc4OWM2NDVmMDA0ZS4u
MGViOTk1ZDI1ZGYxIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL3R0bS90dG1fZXhlY2J1
Zl91dGlsLmMNCisrKyBiL2RyaXZlcnMvZ3B1L2RybS90dG0vdHRtX2V4ZWNidWZfdXRpbC5jDQpA
QCAtMTU0LDEwICsxNTQsOCBAQCB2b2lkIHR0bV9ldV9mZW5jZV9idWZmZXJfb2JqZWN0cyhzdHJ1
Y3Qgd3dfYWNxdWlyZV9jdHggKnRpY2tldCwNCiAJbGlzdF9mb3JfZWFjaF9lbnRyeShlbnRyeSwg
bGlzdCwgaGVhZCkgew0KIAkJc3RydWN0IHR0bV9idWZmZXJfb2JqZWN0ICpibyA9IGVudHJ5LT5i
bzsNCiANCi0JCWlmIChlbnRyeS0+bnVtX3NoYXJlZCkNCi0JCQlkbWFfcmVzdl9hZGRfc2hhcmVk
X2ZlbmNlKGJvLT5iYXNlLnJlc3YsIGZlbmNlKTsNCi0JCWVsc2UNCi0JCQlkbWFfcmVzdl9hZGRf
ZXhjbF9mZW5jZShiby0+YmFzZS5yZXN2LCBmZW5jZSk7DQorCQlkbWFfcmVzdl9hZGRfZmVuY2Uo
Ym8tPmJhc2UucmVzdiwgZmVuY2UsIGVudHJ5LT5udW1fc2hhcmVkID8NCisJCQkJICAgRE1BX1JF
U1ZfVVNBR0VfUkVBRCA6IERNQV9SRVNWX1VTQUdFX1dSSVRFKTsNCiAJCXR0bV9ib19tb3ZlX3Rv
X2xydV90YWlsX3VubG9ja2VkKGJvKTsNCiAJCWRtYV9yZXN2X3VubG9jayhiby0+YmFzZS5yZXN2
KTsNCiAJfQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92M2QvdjNkX2dlbS5jIGIvZHJp
dmVycy9ncHUvZHJtL3YzZC92M2RfZ2VtLmMNCmluZGV4IDk2MTgxMmQzMzgyNy4uMjM1MmU5NjQw
OTIyIDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL3YzZC92M2RfZ2VtLmMNCisrKyBiL2Ry
aXZlcnMvZ3B1L2RybS92M2QvdjNkX2dlbS5jDQpAQCAtNTUwLDggKzU1MCw4IEBAIHYzZF9hdHRh
Y2hfZmVuY2VzX2FuZF91bmxvY2tfcmVzZXJ2YXRpb24oc3RydWN0IGRybV9maWxlICpmaWxlX3By
aXYsDQogDQogCWZvciAoaSA9IDA7IGkgPCBqb2ItPmJvX2NvdW50OyBpKyspIHsNCiAJCS8qIFhY
WDogVXNlIHNoYXJlZCBmZW5jZXMgZm9yIHJlYWQtb25seSBvYmplY3RzLiAqLw0KLQkJZG1hX3Jl
c3ZfYWRkX2V4Y2xfZmVuY2Uoam9iLT5ib1tpXS0+cmVzdiwNCi0JCQkJCWpvYi0+ZG9uZV9mZW5j
ZSk7DQorCQlkbWFfcmVzdl9hZGRfZmVuY2Uoam9iLT5ib1tpXS0+cmVzdiwgam9iLT5kb25lX2Zl
bmNlLA0KKwkJCQkgICBETUFfUkVTVl9VU0FHRV9XUklURSk7DQogCX0NCiANCiAJZHJtX2dlbV91
bmxvY2tfcmVzZXJ2YXRpb25zKGpvYi0+Ym8sIGpvYi0+Ym9fY291bnQsIGFjcXVpcmVfY3R4KTsN
CmRpZmYgLS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmM0L3ZjNF9nZW0uYyBiL2RyaXZlcnMvZ3B1
L2RybS92YzQvdmM0X2dlbS5jDQppbmRleCA0YWFjYzVkZTIxOTkuLmU5MjVlNjVmY2Q5ZCAxMDA2
NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS92YzQvdmM0X2dlbS5jDQorKysgYi9kcml2ZXJzL2dw
dS9kcm0vdmM0L3ZjNF9nZW0uYw0KQEAgLTU0Myw3ICs1NDMsNyBAQCB2YzRfdXBkYXRlX2JvX3Nl
cW5vcyhzdHJ1Y3QgdmM0X2V4ZWNfaW5mbyAqZXhlYywgdWludDY0X3Qgc2Vxbm8pDQogCQlibyA9
IHRvX3ZjNF9ibygmZXhlYy0+Ym9baV0tPmJhc2UpOw0KIAkJYm8tPnNlcW5vID0gc2Vxbm87DQog
DQotCQlkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKGJvLT5iYXNlLmJhc2UucmVzdiwgZXhlYy0+
ZmVuY2UpOw0KKwkJZG1hX3Jlc3ZfYWRkX2ZlbmNlKGJvLT5iYXNlLmJhc2UucmVzdiwgZXhlYy0+
ZmVuY2UpOw0KIAl9DQogDQogCWxpc3RfZm9yX2VhY2hfZW50cnkoYm8sICZleGVjLT51bnJlZl9s
aXN0LCB1bnJlZl9oZWFkKSB7DQpkaWZmIC0tZ2l0IGEvZHJpdmVycy9ncHUvZHJtL3ZnZW0vdmdl
bV9mZW5jZS5jIGIvZHJpdmVycy9ncHUvZHJtL3ZnZW0vdmdlbV9mZW5jZS5jDQppbmRleCA5MWZj
NDk0MGM2NWEuLmMyYTg3OTczNGQ0MCAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS92Z2Vt
L3ZnZW1fZmVuY2UuYw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL3ZnZW0vdmdlbV9mZW5jZS5jDQpA
QCAtMTYxLDEyICsxNjEsOSBAQCBpbnQgdmdlbV9mZW5jZV9hdHRhY2hfaW9jdGwoc3RydWN0IGRy
bV9kZXZpY2UgKmRldiwNCiAJLyogRXhwb3NlIHRoZSBmZW5jZSB2aWEgdGhlIGRtYS1idWYgKi8N
CiAJZG1hX3Jlc3ZfbG9jayhyZXN2LCBOVUxMKTsNCiAJcmV0ID0gZG1hX3Jlc3ZfcmVzZXJ2ZV9m
ZW5jZXMocmVzdiwgMSk7DQotCWlmICghcmV0KSB7DQotCQlpZiAoYXJnLT5mbGFncyAmIFZHRU1f
RkVOQ0VfV1JJVEUpDQotCQkJZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVuY2UocmVzdiwgZmVuY2UpOw0K
LQkJZWxzZQ0KLQkJCWRtYV9yZXN2X2FkZF9zaGFyZWRfZmVuY2UocmVzdiwgZmVuY2UpOw0KLQl9
DQorCWlmICghcmV0KQ0KKwkJZG1hX3Jlc3ZfYWRkX2ZlbmNlKHJlc3YsIGZlbmNlLCBhcmctPmZs
YWdzICYgVkdFTV9GRU5DRV9XUklURSA/DQorCQkJCSAgIERNQV9SRVNWX1VTQUdFX1dSSVRFIDog
RE1BX1JFU1ZfVVNBR0VfUkVBRCk7DQogCWRtYV9yZXN2X3VubG9jayhyZXN2KTsNCiANCiAJLyog
UmVjb3JkIHRoZSBmZW5jZSBpbiBvdXIgaWRyIGZvciBsYXRlciBzaWduYWxpbmcgKi8NCmRpZmYg
LS1naXQgYS9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZ2VtLmMgYi9kcml2ZXJzL2dw
dS9kcm0vdmlydGlvL3ZpcnRncHVfZ2VtLmMNCmluZGV4IDE4MjBjYTZjZjY3My4uNTgwYTc4ODA5
ODM2IDEwMDY0NA0KLS0tIGEvZHJpdmVycy9ncHUvZHJtL3ZpcnRpby92aXJ0Z3B1X2dlbS5jDQor
KysgYi9kcml2ZXJzL2dwdS9kcm0vdmlydGlvL3ZpcnRncHVfZ2VtLmMNCkBAIC0yNTAsNyArMjUw
LDggQEAgdm9pZCB2aXJ0aW9fZ3B1X2FycmF5X2FkZF9mZW5jZShzdHJ1Y3QgdmlydGlvX2dwdV9v
YmplY3RfYXJyYXkgKm9ianMsDQogCWludCBpOw0KIA0KIAlmb3IgKGkgPSAwOyBpIDwgb2Jqcy0+
bmVudHM7IGkrKykNCi0JCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKG9ianMtPm9ianNbaV0tPnJl
c3YsIGZlbmNlKTsNCisJCWRtYV9yZXN2X2FkZF9mZW5jZShvYmpzLT5vYmpzW2ldLT5yZXN2LCBm
ZW5jZSwNCisJCQkJICAgRE1BX1JFU1ZfVVNBR0VfV1JJVEUpOw0KIH0NCiANCiB2b2lkIHZpcnRp
b19ncHVfYXJyYXlfcHV0X2ZyZWUoc3RydWN0IHZpcnRpb19ncHVfb2JqZWN0X2FycmF5ICpvYmpz
KQ0KZGlmZiAtLWdpdCBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMgYi9kcml2
ZXJzL2dwdS9kcm0vdm13Z2Z4L3Ztd2dmeF9iby5jDQppbmRleCBiOTY4ODRmN2QwM2QuLmJlYzUw
MjIzZWZlNSAxMDA2NDQNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMN
CisrKyBiL2RyaXZlcnMvZ3B1L2RybS92bXdnZngvdm13Z2Z4X2JvLmMNCkBAIC03NTgsNyArNzU4
LDggQEAgdm9pZCB2bXdfYm9fZmVuY2Vfc2luZ2xlKHN0cnVjdCB0dG1fYnVmZmVyX29iamVjdCAq
Ym8sDQogDQogCXJldCA9IGRtYV9yZXN2X3Jlc2VydmVfZmVuY2VzKGJvLT5iYXNlLnJlc3YsIDEp
Ow0KIAlpZiAoIXJldCkNCi0JCWRtYV9yZXN2X2FkZF9leGNsX2ZlbmNlKGJvLT5iYXNlLnJlc3Ys
ICZmZW5jZS0+YmFzZSk7DQorCQlkbWFfcmVzdl9hZGRfZmVuY2UoYm8tPmJhc2UucmVzdiwgJmZl
bmNlLT5iYXNlLA0KKwkJCQkgICBETUFfUkVTVl9VU0FHRV9XUklURSk7DQogCWVsc2UNCiAJCS8q
IExhc3QgcmVzb3J0IGZhbGxiYWNrIHdoZW4gd2UgYXJlIE9PTSAqLw0KIAkJZG1hX2ZlbmNlX3dh
aXQoJmZlbmNlLT5iYXNlLCBmYWxzZSk7DQpkaWZmIC0tZ2l0IGEvaW5jbHVkZS9saW51eC9kbWEt
cmVzdi5oIGIvaW5jbHVkZS9saW51eC9kbWEtcmVzdi5oDQppbmRleCA2NTg2NzRjNGI3YjkuLmFl
MDQzNmQ3ZTdiOCAxMDA2NDQNCi0tLSBhL2luY2x1ZGUvbGludXgvZG1hLXJlc3YuaA0KKysrIGIv
aW5jbHVkZS9saW51eC9kbWEtcmVzdi5oDQpAQCAtOTUsOCArOTUsOCBAQCBzdGF0aWMgaW5saW5l
IGVudW0gZG1hX3Jlc3ZfdXNhZ2UgZG1hX3Jlc3ZfdXNhZ2VfcncoYm9vbCB3cml0ZSkNCiAvKioN
CiAgKiBzdHJ1Y3QgZG1hX3Jlc3YgLSBhIHJlc2VydmF0aW9uIG9iamVjdCBtYW5hZ2VzIGZlbmNl
cyBmb3IgYSBidWZmZXINCiAgKg0KLSAqIFRoZXJlIGFyZSBtdWx0aXBsZSB1c2VzIGZvciB0aGlz
LCB3aXRoIHNvbWV0aW1lcyBzbGlnaHRseSBkaWZmZXJlbnQgcnVsZXMgaW4NCi0gKiBob3cgdGhl
IGZlbmNlIHNsb3RzIGFyZSB1c2VkLg0KKyAqIFRoaXMgaXMgYSBjb250YWluZXIgZm9yIGRtYV9m
ZW5jZSBvYmplY3RzIHdoaWNoIG5lZWRzIHRvIGhhbmRsZSBtdWx0aXBsZSB1c2UNCisgKiBjYXNl
cy4NCiAgKg0KICAqIE9uZSB1c2UgaXMgdG8gc3luY2hyb25pemUgY3Jvc3MtZHJpdmVyIGFjY2Vz
cyB0byBhIHN0cnVjdCBkbWFfYnVmLCBlaXRoZXIgZm9yDQogICogZHluYW1pYyBidWZmZXIgbWFu
YWdlbWVudCBvciBqdXN0IHRvIGhhbmRsZSBpbXBsaWNpdCBzeW5jaHJvbml6YXRpb24gYmV0d2Vl
bg0KQEAgLTEyNiw0NyArMTI2LDIyIEBAIHN0cnVjdCBkbWFfcmVzdiB7DQogCSAqIEBzZXE6DQog
CSAqDQogCSAqIFNlcXVlbmNlIGNvdW50IGZvciBtYW5hZ2luZyBSQ1UgcmVhZC1zaWRlIHN5bmNo
cm9uaXphdGlvbiwgYWxsb3dzDQotCSAqIHJlYWQtb25seSBhY2Nlc3MgdG8gQGZlbmNlX2V4Y2wg
YW5kIEBmZW5jZSB3aGlsZSBlbnN1cmluZyB3ZSB0YWtlIGENCi0JICogY29uc2lzdGVudCBzbmFw
c2hvdC4NCisJICogcmVhZC1vbmx5IGFjY2VzcyB0byBAZmVuY2VzIHdoaWxlIGVuc3VyaW5nIHdl
IHRha2UgYSBjb25zaXN0ZW50DQorCSAqIHNuYXBzaG90Lg0KIAkgKi8NCiAJc2VxY291bnRfd3df
bXV0ZXhfdCBzZXE7DQogDQogCS8qKg0KLQkgKiBAZmVuY2VfZXhjbDoNCisJICogQGZlbmNlczoN
CiAJICoNCi0JICogVGhlIGV4Y2x1c2l2ZSBmZW5jZSwgaWYgdGhlcmUgaXMgb25lIGN1cnJlbnRs
eS4NCisJICogQXJyYXkgb2YgZmVuY2VzIHdoaWNoIHdoZXJlIGFkZGVkIHRvIHRoZSBkbWFfcmVz
diBvYmplY3QNCiAJICoNCi0JICogVG8gZ3VhcmFudGVlIHRoYXQgbm8gZmVuY2VzIGFyZSBsb3N0
LCB0aGlzIG5ldyBmZW5jZSBtdXN0IHNpZ25hbA0KLQkgKiBvbmx5IGFmdGVyIHRoZSBwcmV2aW91
cyBleGNsdXNpdmUgZmVuY2UgaGFzIHNpZ25hbGxlZC4gSWYNCi0JICogc2VtYW50aWNhbGx5IG9u
bHkgYSBuZXcgYWNjZXNzIGlzIGFkZGVkIHdpdGhvdXQgYWN0dWFsbHkgdHJlYXRpbmcgdGhlDQot
CSAqIHByZXZpb3VzIG9uZSBhcyBhIGRlcGVuZGVuY3kgdGhlIGV4Y2x1c2l2ZSBmZW5jZXMgY2Fu
IGJlIHN0cnVuZw0KLQkgKiB0b2dldGhlciB1c2luZyBzdHJ1Y3QgZG1hX2ZlbmNlX2NoYWluLg0K
LQkgKg0KLQkgKiBOb3RlIHRoYXQgYWN0dWFsIHNlbWFudGljcyBvZiB3aGF0IGFuIGV4Y2x1c2l2
ZSBvciBzaGFyZWQgZmVuY2UgbWVhbg0KLQkgKiBpcyBkZWZpbmVkIGJ5IHRoZSB1c2VyLCBmb3Ig
cmVzZXJ2YXRpb24gb2JqZWN0cyBzaGFyZWQgYWNyb3NzIGRyaXZlcnMNCi0JICogc2VlICZkbWFf
YnVmLnJlc3YuDQotCSAqLw0KLQlzdHJ1Y3QgZG1hX2ZlbmNlIF9fcmN1ICpmZW5jZV9leGNsOw0K
LQ0KLQkvKioNCi0JICogQGZlbmNlOg0KLQkgKg0KLQkgKiBMaXN0IG9mIGN1cnJlbnQgc2hhcmVk
IGZlbmNlcy4NCi0JICoNCi0JICogVGhlcmUgYXJlIG5vIG9yZGVyaW5nIGNvbnN0cmFpbnRzIG9m
IHNoYXJlZCBmZW5jZXMgYWdhaW5zdCB0aGUNCi0JICogZXhjbHVzaXZlIGZlbmNlIHNsb3QuIElm
IGEgd2FpdGVyIG5lZWRzIHRvIHdhaXQgZm9yIGFsbCBhY2Nlc3MsIGl0DQotCSAqIGhhcyB0byB3
YWl0IGZvciBib3RoIHNldHMgb2YgZmVuY2VzIHRvIHNpZ25hbC4NCi0JICoNCi0JICogQSBuZXcg
ZmVuY2UgaXMgYWRkZWQgYnkgY2FsbGluZyBkbWFfcmVzdl9hZGRfc2hhcmVkX2ZlbmNlKCkuIFNp
bmNlDQotCSAqIHRoaXMgb2Z0ZW4gbmVlZHMgdG8gYmUgZG9uZSBwYXN0IHRoZSBwb2ludCBvZiBu
byByZXR1cm4gaW4gY29tbWFuZA0KKwkgKiBBIG5ldyBmZW5jZSBpcyBhZGRlZCBieSBjYWxsaW5n
IGRtYV9yZXN2X2FkZF9mZW5jZSgpLiBTaW5jZSB0aGlzDQorCSAqIG9mdGVuIG5lZWRzIHRvIGJl
IGRvbmUgcGFzdCB0aGUgcG9pbnQgb2Ygbm8gcmV0dXJuIGluIGNvbW1hbmQNCiAJICogc3VibWlz
c2lvbiBpdCBjYW5ub3QgZmFpbCwgYW5kIHRoZXJlZm9yZSBzdWZmaWNpZW50IHNsb3RzIG5lZWQg
dG8gYmUNCiAJICogcmVzZXJ2ZWQgYnkgY2FsbGluZyBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcygp
Lg0KLQkgKg0KLQkgKiBOb3RlIHRoYXQgYWN0dWFsIHNlbWFudGljcyBvZiB3aGF0IGFuIGV4Y2x1
c2l2ZSBvciBzaGFyZWQgZmVuY2UgbWVhbg0KLQkgKiBpcyBkZWZpbmVkIGJ5IHRoZSB1c2VyLCBm
b3IgcmVzZXJ2YXRpb24gb2JqZWN0cyBzaGFyZWQgYWNyb3NzIGRyaXZlcnMNCi0JICogc2VlICZk
bWFfYnVmLnJlc3YuDQogCSAqLw0KLQlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCBfX3JjdSAqZmVuY2U7
DQorCXN0cnVjdCBkbWFfcmVzdl9saXN0IF9fcmN1ICpmZW5jZXM7DQogfTsNCiANCiAvKioNCkBA
IC0xOTEsNiArMTY2LDkgQEAgc3RydWN0IGRtYV9yZXN2X2l0ZXIgew0KIAkvKiogQGZlbmNlOiB0
aGUgY3VycmVudGx5IGhhbmRsZWQgZmVuY2UgKi8NCiAJc3RydWN0IGRtYV9mZW5jZSAqZmVuY2U7
DQogDQorCS8qKiBAZmVuY2VfdXNhZ2U6IHRoZSB1c2FnZSBvZiB0aGUgY3VycmVudCBmZW5jZSAq
Lw0KKwllbnVtIGRtYV9yZXN2X3VzYWdlIGZlbmNlX3VzYWdlOw0KKw0KIAkvKiogQHNlcTogc2Vx
dWVuY2UgbnVtYmVyIHRvIGNoZWNrIGZvciBtb2RpZmljYXRpb25zICovDQogCXVuc2lnbmVkIGlu
dCBzZXE7DQogDQpAQCAtMjAwLDggKzE3OCw4IEBAIHN0cnVjdCBkbWFfcmVzdl9pdGVyIHsNCiAJ
LyoqIEBmZW5jZXM6IHRoZSBzaGFyZWQgZmVuY2VzOyBwcml2YXRlLCAqTVVTVCogbm90IGRlcmVm
ZXJlbmNlICAqLw0KIAlzdHJ1Y3QgZG1hX3Jlc3ZfbGlzdCAqZmVuY2VzOw0KIA0KLQkvKiogQHNo
YXJlZF9jb3VudDogbnVtYmVyIG9mIHNoYXJlZCBmZW5jZXMgKi8NCi0JdW5zaWduZWQgaW50IHNo
YXJlZF9jb3VudDsNCisJLyoqIEBudW1fZmVuY2VzOiBudW1iZXIgb2YgZmVuY2VzICovDQorCXVu
c2lnbmVkIGludCBudW1fZmVuY2VzOw0KIA0KIAkvKiogQGlzX3Jlc3RhcnRlZDogdHJ1ZSBpZiB0
aGlzIGlzIHRoZSBmaXJzdCByZXR1cm5lZCBmZW5jZSAqLw0KIAlib29sIGlzX3Jlc3RhcnRlZDsN
CkBAIC0yNDAsMTQgKzIxOCwxNSBAQCBzdGF0aWMgaW5saW5lIHZvaWQgZG1hX3Jlc3ZfaXRlcl9l
bmQoc3RydWN0IGRtYV9yZXN2X2l0ZXIgKmN1cnNvcikNCiB9DQogDQogLyoqDQotICogZG1hX3Jl
c3ZfaXRlcl9pc19leGNsdXNpdmUgLSB0ZXN0IGlmIHRoZSBjdXJyZW50IGZlbmNlIGlzIHRoZSBl
eGNsdXNpdmUgb25lDQorICogZG1hX3Jlc3ZfaXRlcl91c2FnZSAtIFJldHVybiB0aGUgdXNhZ2Ug
b2YgdGhlIGN1cnJlbnQgZmVuY2UNCiAgKiBAY3Vyc29yOiB0aGUgY3Vyc29yIG9mIHRoZSBjdXJy
ZW50IHBvc2l0aW9uDQogICoNCi0gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGN1cnJlbnRseSByZXR1
cm5lZCBmZW5jZSBpcyB0aGUgZXhjbHVzaXZlIG9uZS4NCisgKiBSZXR1cm5zIHRoZSB1c2FnZSBv
ZiB0aGUgY3VycmVudGx5IHByb2Nlc3NlZCBmZW5jZS4NCiAgKi8NCi1zdGF0aWMgaW5saW5lIGJv
b2wgZG1hX3Jlc3ZfaXRlcl9pc19leGNsdXNpdmUoc3RydWN0IGRtYV9yZXN2X2l0ZXIgKmN1cnNv
cikNCitzdGF0aWMgaW5saW5lIGVudW0gZG1hX3Jlc3ZfdXNhZ2UNCitkbWFfcmVzdl9pdGVyX3Vz
YWdlKHN0cnVjdCBkbWFfcmVzdl9pdGVyICpjdXJzb3IpDQogew0KLQlyZXR1cm4gY3Vyc29yLT5p
bmRleCA9PSAwOw0KKwlyZXR1cm4gY3Vyc29yLT5mZW5jZV91c2FnZTsNCiB9DQogDQogLyoqDQpA
QCAtMzAyLDkgKzI4MSw5IEBAIHN0YXRpYyBpbmxpbmUgYm9vbCBkbWFfcmVzdl9pdGVyX2lzX3Jl
c3RhcnRlZChzdHJ1Y3QgZG1hX3Jlc3ZfaXRlciAqY3Vyc29yKQ0KICNkZWZpbmUgZG1hX3Jlc3Zf
YXNzZXJ0X2hlbGQob2JqKSBsb2NrZGVwX2Fzc2VydF9oZWxkKCYob2JqKS0+bG9jay5iYXNlKQ0K
IA0KICNpZmRlZiBDT05GSUdfREVCVUdfTVVURVhFUw0KLXZvaWQgZG1hX3Jlc3ZfcmVzZXRfc2hh
cmVkX21heChzdHJ1Y3QgZG1hX3Jlc3YgKm9iaik7DQordm9pZCBkbWFfcmVzdl9yZXNldF9tYXhf
ZmVuY2VzKHN0cnVjdCBkbWFfcmVzdiAqb2JqKTsNCiAjZWxzZQ0KLXN0YXRpYyBpbmxpbmUgdm9p
ZCBkbWFfcmVzdl9yZXNldF9zaGFyZWRfbWF4KHN0cnVjdCBkbWFfcmVzdiAqb2JqKSB7fQ0KK3N0
YXRpYyBpbmxpbmUgdm9pZCBkbWFfcmVzdl9yZXNldF9tYXhfZmVuY2VzKHN0cnVjdCBkbWFfcmVz
diAqb2JqKSB7fQ0KICNlbmRpZg0KIA0KIC8qKg0KQEAgLTQ1MCwxNyArNDI5LDE4IEBAIHN0YXRp
YyBpbmxpbmUgc3RydWN0IHd3X2FjcXVpcmVfY3R4ICpkbWFfcmVzdl9sb2NraW5nX2N0eChzdHJ1
Y3QgZG1hX3Jlc3YgKm9iaikNCiAgKi8NCiBzdGF0aWMgaW5saW5lIHZvaWQgZG1hX3Jlc3ZfdW5s
b2NrKHN0cnVjdCBkbWFfcmVzdiAqb2JqKQ0KIHsNCi0JZG1hX3Jlc3ZfcmVzZXRfc2hhcmVkX21h
eChvYmopOw0KKwlkbWFfcmVzdl9yZXNldF9tYXhfZmVuY2VzKG9iaik7DQogCXd3X211dGV4X3Vu
bG9jaygmb2JqLT5sb2NrKTsNCiB9DQogDQogdm9pZCBkbWFfcmVzdl9pbml0KHN0cnVjdCBkbWFf
cmVzdiAqb2JqKTsNCiB2b2lkIGRtYV9yZXN2X2Zpbmkoc3RydWN0IGRtYV9yZXN2ICpvYmopOw0K
IGludCBkbWFfcmVzdl9yZXNlcnZlX2ZlbmNlcyhzdHJ1Y3QgZG1hX3Jlc3YgKm9iaiwgdW5zaWdu
ZWQgaW50IG51bV9mZW5jZXMpOw0KLXZvaWQgZG1hX3Jlc3ZfYWRkX3NoYXJlZF9mZW5jZShzdHJ1
Y3QgZG1hX3Jlc3YgKm9iaiwgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOw0KK3ZvaWQgZG1hX3Jl
c3ZfYWRkX2ZlbmNlKHN0cnVjdCBkbWFfcmVzdiAqb2JqLCBzdHJ1Y3QgZG1hX2ZlbmNlICpmZW5j
ZSwNCisJCQllbnVtIGRtYV9yZXN2X3VzYWdlIHVzYWdlKTsNCiB2b2lkIGRtYV9yZXN2X3JlcGxh
Y2VfZmVuY2VzKHN0cnVjdCBkbWFfcmVzdiAqb2JqLCB1aW50NjRfdCBjb250ZXh0LA0KLQkJCSAg
ICAgc3RydWN0IGRtYV9mZW5jZSAqZmVuY2UpOw0KLXZvaWQgZG1hX3Jlc3ZfYWRkX2V4Y2xfZmVu
Y2Uoc3RydWN0IGRtYV9yZXN2ICpvYmosIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlKTsNCisJCQkg
ICAgIHN0cnVjdCBkbWFfZmVuY2UgKmZlbmNlLA0KKwkJCSAgICAgZW51bSBkbWFfcmVzdl91c2Fn
ZSB1c2FnZSk7DQogaW50IGRtYV9yZXN2X2dldF9mZW5jZXMoc3RydWN0IGRtYV9yZXN2ICpvYmos
IGVudW0gZG1hX3Jlc3ZfdXNhZ2UgdXNhZ2UsDQogCQkJdW5zaWduZWQgaW50ICpudW1fZmVuY2Vz
LCBzdHJ1Y3QgZG1hX2ZlbmNlICoqKmZlbmNlcyk7DQogaW50IGRtYV9yZXN2X2dldF9zaW5nbGV0
b24oc3RydWN0IGRtYV9yZXN2ICpvYmosIGVudW0gZG1hX3Jlc3ZfdXNhZ2UgdXNhZ2UsDQotLSAN
CjIuMjUuMQ0KDQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
XwpMaW5hcm8tbW0tc2lnIG1haWxpbmcgbGlzdCAtLSBsaW5hcm8tbW0tc2lnQGxpc3RzLmxpbmFy
by5vcmcKVG8gdW5zdWJzY3JpYmUgc2VuZCBhbiBlbWFpbCB0byBsaW5hcm8tbW0tc2lnLWxlYXZl
QGxpc3RzLmxpbmFyby5vcmcK
