Return-Path: <linaro-mm-sig-bounces+lists+linaro-mm-sig=lfdr.de@lists.linaro.org>
X-Original-To: lists+linaro-mm-sig@lfdr.de
Delivered-To: lists+linaro-mm-sig@lfdr.de
Received: from lists.linaro.org (lists.linaro.org [3.208.193.21])
	by mail.lfdr.de (Postfix) with ESMTPS id 79A22B05BEF
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 15 Jul 2025 15:25:15 +0200 (CEST)
Received: from lists.linaro.org (localhost [127.0.0.1])
	by lists.linaro.org (Postfix) with ESMTP id 8048244037
	for <lists+linaro-mm-sig@lfdr.de>; Tue, 15 Jul 2025 13:25:14 +0000 (UTC)
Received: from nyc.source.kernel.org (nyc.source.kernel.org [147.75.193.91])
	by lists.linaro.org (Postfix) with ESMTPS id 093AE44943
	for <linaro-mm-sig@lists.linaro.org>; Tue, 15 Jul 2025 13:24:57 +0000 (UTC)
Authentication-Results: lists.linaro.org;
	dkim=pass header.d=linuxfoundation.org header.s=korg header.b=hEAEwkvY;
	spf=pass (lists.linaro.org: domain of gregkh@linuxfoundation.org designates 147.75.193.91 as permitted sender) smtp.mailfrom=gregkh@linuxfoundation.org;
	dmarc=pass (policy=none) header.from=linuxfoundation.org
Received: from smtp.kernel.org (transwarp.subspace.kernel.org [100.75.92.58])
	by nyc.source.kernel.org (Postfix) with ESMTP id CFEF5A56FFF;
	Tue, 15 Jul 2025 13:24:56 +0000 (UTC)
Received: by smtp.kernel.org (Postfix) with ESMTPSA id 08BA0C4CEE3;
	Tue, 15 Jul 2025 13:24:56 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=linuxfoundation.org;
	s=korg; t=1752585896;
	bh=JJduVbsTrD4UwIdCLXwCmMALGCtioinwKQGoVV9+j3s=;
	h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
	b=hEAEwkvYOQAtr1LDcsQW0FA9TI8DpYZhn8SB9IdvXVp26vsimyR7rHqNgjgd2M9mF
	 qoEMCAkp6zRXIRDui4y6EYQ4NzaGxVpdlwGT8wGxwjbHVmLnK0PVAxlb2WUXiRU2Us
	 r7HfPKhRwpR3Bf6hwflWZmEbybS7d1GW8sv2wCtc=
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
To: stable@vger.kernel.org
Date: Tue, 15 Jul 2025 15:13:05 +0200
Message-ID: <20250715130800.838187407@linuxfoundation.org>
X-Mailer: git-send-email 2.50.1
In-Reply-To: <20250715130758.864940641@linuxfoundation.org>
References: <20250715130758.864940641@linuxfoundation.org>
User-Agent: quilt/0.68
X-stable: review
X-Patchwork-Hint: ignore
MIME-Version: 1.0
X-Rspamd-Server: lists.linaro.org
X-Rspamd-Queue-Id: 093AE44943
X-Spamd-Bar: ----
X-Spamd-Result: default: False [-4.00 / 15.00];
	BAYES_HAM(-3.00)[100.00%];
	DMARC_POLICY_ALLOW(-0.50)[linuxfoundation.org,none];
	R_SPF_ALLOW(-0.20)[+ip4:147.75.193.91];
	R_DKIM_ALLOW(-0.20)[linuxfoundation.org:s=korg];
	MIME_GOOD(-0.10)[text/plain];
	TO_MATCH_ENVRCPT_SOME(0.00)[];
	ARC_NA(0.00)[];
	RCVD_VIA_SMTP_AUTH(0.00)[];
	FREEMAIL_CC(0.00)[linuxfoundation.org,lists.linux.dev,suse.de,web.de,kernel.org,alien8.de,redhat.com,amd.com,linux.intel.com,linaro.org,vger.kernel.org,lists.freedesktop.org,lists.linaro.org];
	ASN(0.00)[asn:15830, ipnet:147.75.193.0/24, country:NL];
	RCPT_COUNT_TWELVE(0.00)[15];
	MIME_TRACE(0.00)[0:+];
	RCVD_COUNT_TWO(0.00)[2];
	FROM_HAS_DN(0.00)[];
	NEURAL_HAM(-0.00)[-1.000];
	RCVD_TLS_LAST(0.00)[];
	DNSWL_BLOCKED(0.00)[100.75.92.58:received,147.75.193.91:from];
	MID_RHS_MATCH_FROM(0.00)[];
	URIBL_BLOCKED(0.00)[nyc.source.kernel.org:rdns,nyc.source.kernel.org:helo,intel.com:email,linuxfoundation.org:email,linuxfoundation.org:dkim,linuxfoundation.org:mid,linaro.org:email,suse.de:email,alien8.de:email,lists.freedesktop.org:email];
	TO_DN_SOME(0.00)[];
	FROM_EQ_ENVFROM(0.00)[];
	DKIM_TRACE(0.00)[linuxfoundation.org:+]
X-Rspamd-Action: no action
Message-ID-Hash: GAA7554MOPR34VMSWR3QM6XBKNH6M5I7
X-Message-ID-Hash: GAA7554MOPR34VMSWR3QM6XBKNH6M5I7
X-MailFrom: gregkh@linuxfoundation.org
X-Mailman-Rule-Misses: dmarc-mitigation; no-senders; approved; emergency; loop; banned-address; member-moderation; nonmember-moderation; administrivia; implicit-dest; max-recipients; max-size; news-moderation; no-subject; digests; suspicious-header
CC: Greg Kroah-Hartman <gregkh@linuxfoundation.org>, patches@lists.linux.dev, Thomas Zimmermann <tzimmermann@suse.de>, Bert Karwatzki <spasswolf@web.de>, Mario Limonciello <superm1@kernel.org>, "Borislav Petkov (AMD)" <bp@alien8.de>, Anusha Srivatsa <asrivats@redhat.com>, =?UTF-8?q?Christian=20K=C3=B6nig?= <christian.koenig@amd.com>, Maarten Lankhorst <maarten.lankhorst@linux.intel.com>, Maxime Ripard <mripard@kernel.org>, Sumit Semwal <sumit.semwal@linaro.org>, linux-media@vger.kernel.org, dri-devel@lists.freedesktop.org, linaro-mm-sig@lists.linaro.org
X-Mailman-Version: 3.3.5
Precedence: list
Subject: [Linaro-mm-sig] [PATCH 6.6 049/109] drm/framebuffer: Acquire internal references on GEM handles
List-Id: "Unified memory management interest group." <linaro-mm-sig.lists.linaro.org>
Archived-At: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/message/GAA7554MOPR34VMSWR3QM6XBKNH6M5I7/>
List-Archive: <https://lists.linaro.org/archives/list/linaro-mm-sig@lists.linaro.org/>
List-Help: <mailto:linaro-mm-sig-request@lists.linaro.org?subject=help>
List-Owner: <mailto:linaro-mm-sig-owner@lists.linaro.org>
List-Post: <mailto:linaro-mm-sig@lists.linaro.org>
List-Subscribe: <mailto:linaro-mm-sig-join@lists.linaro.org>
List-Unsubscribe: <mailto:linaro-mm-sig-leave@lists.linaro.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

Ni42LXN0YWJsZSByZXZpZXcgcGF0Y2guICBJZiBhbnlvbmUgaGFzIGFueSBvYmplY3Rpb25zLCBw
bGVhc2UgbGV0IG1lIGtub3cuDQoNCi0tLS0tLS0tLS0tLS0tLS0tLQ0KDQpGcm9tOiBUaG9tYXMg
WmltbWVybWFubiA8dHppbW1lcm1hbm5Ac3VzZS5kZT4NCg0KY29tbWl0IGY2YmZjOWFmYzc1MTBj
YjVlNmZiZTBhMTdjNTA3OTE3YjAxMjAyODAgdXBzdHJlYW0uDQoNCkFjcXVpcmUgR0VNIGhhbmRs
ZXMgaW4gZHJtX2ZyYW1lYnVmZmVyX2luaXQoKSBhbmQgcmVsZWFzZSB0aGVtIGluDQp0aGUgY29y
cmVzcG9uZGluZyBkcm1fZnJhbWVidWZmZXJfY2xlYW51cCgpLiBUaWVzIHRoZSBoYW5kbGUncw0K
bGlmZXRpbWUgdG8gdGhlIGZyYW1lYnVmZmVyLiBOb3QgYWxsIEdFTSBidWZmZXIgb2JqZWN0cyBo
YXZlIEdFTQ0KaGFuZGxlcy4gSWYgbm90IHNldCwgbm8gcmVmY291bnRpbmcgdGFrZXMgcGxhY2Uu
IFRoaXMgaXMgdGhlIGNhc2UNCmZvciBzb21lIGZiZGV2IGVtdWxhdGlvbi4gVGhpcyBpcyBub3Qg
YSBwcm9ibGVtIGFzIHRoZXNlIEdFTSBvYmplY3RzDQpkbyBub3QgdXNlIGRtYS1idWZzIGFuZCBk
cml2ZXJzIHdpbGwgbm90IHJlbGVhc2UgdGhlbSB3aGlsZSBmYmRldg0KZW11bGF0aW9uIGlzIHJ1
bm5pbmcuIEZyYW1lYnVmZmVyIGZsYWdzIGtlZXAgYSBiaXQgcGVyIGNvbG9yIHBsYW5lDQpvZiB3
aGljaCB0aGUgZnJhbWVidWZmZXIgaG9sZHMgYSBHRU0gaGFuZGxlIHJlZmVyZW5jZS4NCg0KQXMg
YWxsIGRyaXZlcnMgdXNlIGRybV9mcmFtZWJ1ZmZlcl9pbml0KCksIHRoZXkgd2lsbCBub3cgYWxs
IGhvbGQNCmRtYS1idWYgcmVmZXJlbmNlcyBhcyBmaXhlZCBpbiBjb21taXQgNTMwN2RjZTg3OGQ0
ICgiZHJtL2dlbTogQWNxdWlyZQ0KcmVmZXJlbmNlcyBvbiBHRU0gaGFuZGxlcyBmb3IgZnJhbWVi
dWZmZXJzIikuDQoNCkluIHRoZSBHRU0gZnJhbWVidWZmZXIgaGVscGVycywgcmVzdG9yZSB0aGUg
b3JpZ2luYWwgcmVmIGNvdW50aW5nDQpvbiBidWZmZXIgb2JqZWN0cy4gQXMgdGhlIGhlbHBlcnMg
Zm9yIGhhbmRsZSByZWZjb3VudGluZyBhcmUgbm93DQpubyBsb25nZXIgY2FsbGVkIGZyb20gb3V0
c2lkZSB0aGUgRFJNIGNvcmUsIHVuZXhwb3J0IHRoZSBzeW1ib2xzLg0KDQp2MzoNCi0gZG9uJ3Qg
bWl4IGludGVybmFsIGZsYWdzIHdpdGggbW9kZSBmbGFncyAoQ2hyaXN0aWFuKQ0KdjI6DQotIHRy
YWNrIGZyYW1lYnVmZmVyIGhhbmRsZSByZWZzIGJ5IGZsYWcNCi0gZHJvcCBnbWE1MDAgY2xlYW51
cCAoQ2hyaXN0aWFuKQ0KDQpTaWduZWQtb2ZmLWJ5OiBUaG9tYXMgWmltbWVybWFubiA8dHppbW1l
cm1hbm5Ac3VzZS5kZT4NCkZpeGVzOiA1MzA3ZGNlODc4ZDQgKCJkcm0vZ2VtOiBBY3F1aXJlIHJl
ZmVyZW5jZXMgb24gR0VNIGhhbmRsZXMgZm9yIGZyYW1lYnVmZmVycyIpDQpSZXBvcnRlZC1ieTog
QmVydCBLYXJ3YXR6a2kgPHNwYXNzd29sZkB3ZWIuZGU+DQpDbG9zZXM6IGh0dHBzOi8vbG9yZS5r
ZXJuZWwub3JnL2RyaS1kZXZlbC8yMDI1MDcwMzExNTkxNS4zMDk2LTEtc3Bhc3N3b2xmQHdlYi5k
ZS8NClRlc3RlZC1ieTogQmVydCBLYXJ3YXR6a2kgPHNwYXNzd29sZkB3ZWIuZGU+DQpUZXN0ZWQt
Ynk6IE1hcmlvIExpbW9uY2llbGxvIDxzdXBlcm0xQGtlcm5lbC5vcmc+DQpUZXN0ZWQtYnk6IEJv
cmlzbGF2IFBldGtvdiAoQU1EKSA8YnBAYWxpZW44LmRlPg0KQ2M6IFRob21hcyBaaW1tZXJtYW5u
IDx0emltbWVybWFubkBzdXNlLmRlPg0KQ2M6IEFudXNoYSBTcml2YXRzYSA8YXNyaXZhdHNAcmVk
aGF0LmNvbT4NCkNjOiBDaHJpc3RpYW4gS8O2bmlnIDxjaHJpc3RpYW4ua29lbmlnQGFtZC5jb20+
DQpDYzogTWFhcnRlbiBMYW5raG9yc3QgPG1hYXJ0ZW4ubGFua2hvcnN0QGxpbnV4LmludGVsLmNv
bT4NCkNjOiBNYXhpbWUgUmlwYXJkIDxtcmlwYXJkQGtlcm5lbC5vcmc+DQpDYzogU3VtaXQgU2Vt
d2FsIDxzdW1pdC5zZW13YWxAbGluYXJvLm9yZz4NCkNjOiAiQ2hyaXN0aWFuIEvDtm5pZyIgPGNo
cmlzdGlhbi5rb2VuaWdAYW1kLmNvbT4NCkNjOiBsaW51eC1tZWRpYUB2Z2VyLmtlcm5lbC5vcmcN
CkNjOiBkcmktZGV2ZWxAbGlzdHMuZnJlZWRlc2t0b3Aub3JnDQpDYzogbGluYXJvLW1tLXNpZ0Bs
aXN0cy5saW5hcm8ub3JnDQpDYzogPHN0YWJsZUB2Z2VyLmtlcm5lbC5vcmc+DQpSZXZpZXdlZC1i
eTogQ2hyaXN0aWFuIEvDtm5pZyA8Y2hyaXN0aWFuLmtvZW5pZ0BhbWQuY29tPg0KTGluazogaHR0
cHM6Ly9sb3JlLmtlcm5lbC5vcmcvci8yMDI1MDcwNzEzMTIyNC4yNDk0OTYtMS10emltbWVybWFu
bkBzdXNlLmRlDQpTaWduZWQtb2ZmLWJ5OiBHcmVnIEtyb2FoLUhhcnRtYW4gPGdyZWdraEBsaW51
eGZvdW5kYXRpb24ub3JnPg0KLS0tDQogZHJpdmVycy9ncHUvZHJtL2RybV9mcmFtZWJ1ZmZlci5j
ICAgICAgICAgICAgfCAgIDMxICsrKysrKysrKysrKysrKysrKysrLS0NCiBkcml2ZXJzL2dwdS9k
cm0vZHJtX2dlbS5jICAgICAgICAgICAgICAgICAgICB8ICAgMzggKysrKysrKysrKysrKysrKyst
LS0tLS0tLS0tDQogZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmMg
fCAgIDE2ICsrKystLS0tLS0tDQogZHJpdmVycy9ncHUvZHJtL2RybV9pbnRlcm5hbC5oICAgICAg
ICAgICAgICAgfCAgICAyIC0NCiBpbmNsdWRlL2RybS9kcm1fZnJhbWVidWZmZXIuaCAgICAgICAg
ICAgICAgICB8ICAgIDcgKysrKw0KIDUgZmlsZXMgY2hhbmdlZCwgNjggaW5zZXJ0aW9ucygrKSwg
MjYgZGVsZXRpb25zKC0pDQoNCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1fZnJhbWVidWZmZXIu
Yw0KKysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9mcmFtZWJ1ZmZlci5jDQpAQCAtODQ0LDExICs4
NDQsMjMgQEAgdm9pZCBkcm1fZnJhbWVidWZmZXJfZnJlZShzdHJ1Y3Qga3JlZiAqaw0KIGludCBk
cm1fZnJhbWVidWZmZXJfaW5pdChzdHJ1Y3QgZHJtX2RldmljZSAqZGV2LCBzdHJ1Y3QgZHJtX2Zy
YW1lYnVmZmVyICpmYiwNCiAJCQkgY29uc3Qgc3RydWN0IGRybV9mcmFtZWJ1ZmZlcl9mdW5jcyAq
ZnVuY3MpDQogew0KKwl1bnNpZ25lZCBpbnQgaTsNCiAJaW50IHJldDsNCisJYm9vbCBleGlzdHM7
DQogDQogCWlmIChXQVJOX09OX09OQ0UoZmItPmRldiAhPSBkZXYgfHwgIWZiLT5mb3JtYXQpKQ0K
IAkJcmV0dXJuIC1FSU5WQUw7DQogDQorCWZvciAoaSA9IDA7IGkgPCBmYi0+Zm9ybWF0LT5udW1f
cGxhbmVzOyBpKyspIHsNCisJCWlmIChkcm1fV0FSTl9PTl9PTkNFKGRldiwgZmItPmludGVybmFs
X2ZsYWdzICYgRFJNX0ZSQU1FQlVGRkVSX0hBU19IQU5ETEVfUkVGKGkpKSkNCisJCQlmYi0+aW50
ZXJuYWxfZmxhZ3MgJj0gfkRSTV9GUkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRihpKTsNCisJCWlm
IChmYi0+b2JqW2ldKSB7DQorCQkJZXhpc3RzID0gZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF9p
Zl9leGlzdHNfdW5sb2NrZWQoZmItPm9ialtpXSk7DQorCQkJaWYgKGV4aXN0cykNCisJCQkJZmIt
PmludGVybmFsX2ZsYWdzIHw9IERSTV9GUkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRihpKTsNCisJ
CX0NCisJfQ0KKw0KIAlJTklUX0xJU1RfSEVBRCgmZmItPmZpbHBfaGVhZCk7DQogDQogCWZiLT5m
dW5jcyA9IGZ1bmNzOw0KQEAgLTg1Nyw3ICs4NjksNyBAQCBpbnQgZHJtX2ZyYW1lYnVmZmVyX2lu
aXQoc3RydWN0IGRybV9kZXZpDQogCXJldCA9IF9fZHJtX21vZGVfb2JqZWN0X2FkZChkZXYsICZm
Yi0+YmFzZSwgRFJNX01PREVfT0JKRUNUX0ZCLA0KIAkJCQkgICAgZmFsc2UsIGRybV9mcmFtZWJ1
ZmZlcl9mcmVlKTsNCiAJaWYgKHJldCkNCi0JCWdvdG8gb3V0Ow0KKwkJZ290byBlcnI7DQogDQog
CW11dGV4X2xvY2soJmRldi0+bW9kZV9jb25maWcuZmJfbG9jayk7DQogCWRldi0+bW9kZV9jb25m
aWcubnVtX2ZiKys7DQpAQCAtODY1LDcgKzg3NywxNiBAQCBpbnQgZHJtX2ZyYW1lYnVmZmVyX2lu
aXQoc3RydWN0IGRybV9kZXZpDQogCW11dGV4X3VubG9jaygmZGV2LT5tb2RlX2NvbmZpZy5mYl9s
b2NrKTsNCiANCiAJZHJtX21vZGVfb2JqZWN0X3JlZ2lzdGVyKGRldiwgJmZiLT5iYXNlKTsNCi1v
dXQ6DQorDQorCXJldHVybiAwOw0KKw0KK2VycjoNCisJZm9yIChpID0gMDsgaSA8IGZiLT5mb3Jt
YXQtPm51bV9wbGFuZXM7IGkrKykgew0KKwkJaWYgKGZiLT5pbnRlcm5hbF9mbGFncyAmIERSTV9G
UkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRihpKSkgew0KKwkJCWRybV9nZW1fb2JqZWN0X2hhbmRs
ZV9wdXRfdW5sb2NrZWQoZmItPm9ialtpXSk7DQorCQkJZmItPmludGVybmFsX2ZsYWdzICY9IH5E
Uk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoaSk7DQorCQl9DQorCX0NCiAJcmV0dXJuIHJl
dDsNCiB9DQogRVhQT1JUX1NZTUJPTChkcm1fZnJhbWVidWZmZXJfaW5pdCk7DQpAQCAtOTQyLDYg
Kzk2MywxMiBAQCBFWFBPUlRfU1lNQk9MKGRybV9mcmFtZWJ1ZmZlcl91bnJlZ2lzdGVyDQogdm9p
ZCBkcm1fZnJhbWVidWZmZXJfY2xlYW51cChzdHJ1Y3QgZHJtX2ZyYW1lYnVmZmVyICpmYikNCiB7
DQogCXN0cnVjdCBkcm1fZGV2aWNlICpkZXYgPSBmYi0+ZGV2Ow0KKwl1bnNpZ25lZCBpbnQgaTsN
CisNCisJZm9yIChpID0gMDsgaSA8IGZiLT5mb3JtYXQtPm51bV9wbGFuZXM7IGkrKykgew0KKwkJ
aWYgKGZiLT5pbnRlcm5hbF9mbGFncyAmIERSTV9GUkFNRUJVRkZFUl9IQVNfSEFORExFX1JFRihp
KSkNCisJCQlkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X3VubG9ja2VkKGZiLT5vYmpbaV0pOw0K
Kwl9DQogDQogCW11dGV4X2xvY2soJmRldi0+bW9kZV9jb25maWcuZmJfbG9jayk7DQogCWxpc3Rf
ZGVsKCZmYi0+aGVhZCk7DQotLS0gYS9kcml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5jDQorKysgYi9k
cml2ZXJzL2dwdS9kcm0vZHJtX2dlbS5jDQpAQCAtMTk3LDIzICsxOTcsMzQgQEAgc3RhdGljIHZv
aWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldChzdA0KIH0NCiANCiAvKioNCi0gKiBkcm1fZ2Vt
X29iamVjdF9oYW5kbGVfZ2V0X3VubG9ja2VkIC0gYWNxdWlyZSByZWZlcmVuY2Ugb24gdXNlci1z
cGFjZSBoYW5kbGVzDQorICogZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF9pZl9leGlzdHNfdW5s
b2NrZWQgLSBhY3F1aXJlIHJlZmVyZW5jZSBvbiB1c2VyLXNwYWNlIGhhbmRsZSwgaWYgYW55DQog
ICogQG9iajogR0VNIG9iamVjdA0KICAqDQotICogQWNxdWlyZXMgYSByZWZlcmVuY2Ugb24gdGhl
IEdFTSBidWZmZXIgb2JqZWN0J3MgaGFuZGxlLiBSZXF1aXJlZA0KLSAqIHRvIGtlZXAgdGhlIEdF
TSBvYmplY3QgYWxpdmUuIENhbGwgZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZCgp
DQotICogdG8gcmVsZWFzZSB0aGUgcmVmZXJlbmNlLg0KKyAqIEFjcXVpcmVzIGEgcmVmZXJlbmNl
IG9uIHRoZSBHRU0gYnVmZmVyIG9iamVjdCdzIGhhbmRsZS4gUmVxdWlyZWQgdG8ga2VlcA0KKyAq
IHRoZSBHRU0gb2JqZWN0IGFsaXZlLiBDYWxsIGRybV9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfaWZf
ZXhpc3RzX3VubG9ja2VkKCkNCisgKiB0byByZWxlYXNlIHRoZSByZWZlcmVuY2UuIERvZXMgbm90
aGluZyBpZiB0aGUgYnVmZmVyIG9iamVjdCBoYXMgbm8gaGFuZGxlLg0KKyAqDQorICogUmV0dXJu
czoNCisgKiBUcnVlIGlmIGEgaGFuZGxlIGV4aXN0cywgb3IgZmFsc2Ugb3RoZXJ3aXNlDQogICov
DQotdm9pZCBkcm1fZ2VtX29iamVjdF9oYW5kbGVfZ2V0X3VubG9ja2VkKHN0cnVjdCBkcm1fZ2Vt
X29iamVjdCAqb2JqKQ0KK2Jvb2wgZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF9pZl9leGlzdHNf
dW5sb2NrZWQoc3RydWN0IGRybV9nZW1fb2JqZWN0ICpvYmopDQogew0KIAlzdHJ1Y3QgZHJtX2Rl
dmljZSAqZGV2ID0gb2JqLT5kZXY7DQogDQogCWd1YXJkKG11dGV4KSgmZGV2LT5vYmplY3RfbmFt
ZV9sb2NrKTsNCiANCi0JZHJtX1dBUk5fT04oZGV2LCAhb2JqLT5oYW5kbGVfY291bnQpOyAvKiBm
aXJzdCByZWYgdGFrZW4gaW4gY3JlYXRlLXRhaWwgaGVscGVyICovDQorCS8qDQorCSAqIEZpcnN0
IHJlZiB0YWtlbiBkdXJpbmcgR0VNIG9iamVjdCBjcmVhdGlvbiwgaWYgYW55LiBTb21lDQorCSAq
IGRyaXZlcnMgc2V0IHVwIGludGVybmFsIGZyYW1lYnVmZmVycyB3aXRoIEdFTSBvYmplY3RzIHRo
YXQNCisJICogZG8gbm90IGhhdmUgYSBHRU0gaGFuZGxlLiBIZW5jZSwgdGhpcyBjb3VudGVyIGNh
biBiZSB6ZXJvLg0KKwkgKi8NCisJaWYgKCFvYmotPmhhbmRsZV9jb3VudCkNCisJCXJldHVybiBm
YWxzZTsNCisNCiAJZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldChvYmopOw0KKw0KKwlyZXR1cm4g
dHJ1ZTsNCiB9DQotRVhQT1JUX1NZTUJPTChkcm1fZ2VtX29iamVjdF9oYW5kbGVfZ2V0X3VubG9j
a2VkKTsNCiANCiAvKioNCiAgKiBkcm1fZ2VtX29iamVjdF9oYW5kbGVfZnJlZSAtIHJlbGVhc2Ug
cmVzb3VyY2VzIGJvdW5kIHRvIHVzZXJzcGFjZSBoYW5kbGVzDQpAQCAtMjQ2LDcgKzI1Nyw3IEBA
IHN0YXRpYyB2b2lkIGRybV9nZW1fb2JqZWN0X2V4cG9ydGVkX2RtYV8NCiB9DQogDQogLyoqDQot
ICogZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZCAtIHJlbGVhc2VzIHJlZmVyZW5j
ZSBvbiB1c2VyLXNwYWNlIGhhbmRsZXMNCisgKiBkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X3Vu
bG9ja2VkIC0gcmVsZWFzZXMgcmVmZXJlbmNlIG9uIHVzZXItc3BhY2UgaGFuZGxlDQogICogQG9i
ajogR0VNIG9iamVjdA0KICAqDQogICogUmVsZWFzZXMgYSByZWZlcmVuY2Ugb24gdGhlIEdFTSBi
dWZmZXIgb2JqZWN0J3MgaGFuZGxlLiBQb3NzaWJseSByZWxlYXNlcw0KQEAgLTI1NywxNCArMjY4
LDE0IEBAIHZvaWQgZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZCgNCiAJc3RydWN0
IGRybV9kZXZpY2UgKmRldiA9IG9iai0+ZGV2Ow0KIAlib29sIGZpbmFsID0gZmFsc2U7DQogDQot
CWlmIChXQVJOX09OKFJFQURfT05DRShvYmotPmhhbmRsZV9jb3VudCkgPT0gMCkpDQorCWlmIChk
cm1fV0FSTl9PTihkZXYsIFJFQURfT05DRShvYmotPmhhbmRsZV9jb3VudCkgPT0gMCkpDQogCQly
ZXR1cm47DQogDQogCS8qDQotCSogTXVzdCBidW1wIGhhbmRsZSBjb3VudCBmaXJzdCBhcyB0aGlz
IG1heSBiZSB0aGUgbGFzdA0KLQkqIHJlZiwgaW4gd2hpY2ggY2FzZSB0aGUgb2JqZWN0IHdvdWxk
IGRpc2FwcGVhciBiZWZvcmUgd2UNCi0JKiBjaGVja2VkIGZvciBhIG5hbWUNCi0JKi8NCisJICog
TXVzdCBidW1wIGhhbmRsZSBjb3VudCBmaXJzdCBhcyB0aGlzIG1heSBiZSB0aGUgbGFzdA0KKwkg
KiByZWYsIGluIHdoaWNoIGNhc2UgdGhlIG9iamVjdCB3b3VsZCBkaXNhcHBlYXIgYmVmb3JlDQor
CSAqIHdlIGNoZWNrZWQgZm9yIGEgbmFtZS4NCisJICovDQogDQogCW11dGV4X2xvY2soJmRldi0+
b2JqZWN0X25hbWVfbG9jayk7DQogCWlmICgtLW9iai0+aGFuZGxlX2NvdW50ID09IDApIHsNCkBA
IC0yNzcsNyArMjg4LDYgQEAgdm9pZCBkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X3VubG9ja2Vk
KA0KIAlpZiAoZmluYWwpDQogCQlkcm1fZ2VtX29iamVjdF9wdXQob2JqKTsNCiB9DQotRVhQT1JU
X1NZTUJPTChkcm1fZ2VtX29iamVjdF9oYW5kbGVfcHV0X3VubG9ja2VkKTsNCiANCiAvKg0KICAq
IENhbGxlZCBhdCBkZXZpY2Ugb3Igb2JqZWN0IGNsb3NlIHRvIHJlbGVhc2UgdGhlIGZpbGUncw0K
LS0tIGEvZHJpdmVycy9ncHUvZHJtL2RybV9nZW1fZnJhbWVidWZmZXJfaGVscGVyLmMNCisrKyBi
L2RyaXZlcnMvZ3B1L2RybS9kcm1fZ2VtX2ZyYW1lYnVmZmVyX2hlbHBlci5jDQpAQCAtOTksNyAr
OTksNyBAQCB2b2lkIGRybV9nZW1fZmJfZGVzdHJveShzdHJ1Y3QgZHJtX2ZyYW1lDQogCXVuc2ln
bmVkIGludCBpOw0KIA0KIAlmb3IgKGkgPSAwOyBpIDwgZmItPmZvcm1hdC0+bnVtX3BsYW5lczsg
aSsrKQ0KLQkJZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZChmYi0+b2JqW2ldKTsN
CisJCWRybV9nZW1fb2JqZWN0X3B1dChmYi0+b2JqW2ldKTsNCiANCiAJZHJtX2ZyYW1lYnVmZmVy
X2NsZWFudXAoZmIpOw0KIAlrZnJlZShmYik7DQpAQCAtMTgyLDEwICsxODIsOCBAQCBpbnQgZHJt
X2dlbV9mYl9pbml0X3dpdGhfZnVuY3Moc3RydWN0IGRyDQogCQlpZiAoIW9ianNbaV0pIHsNCiAJ
CQlkcm1fZGJnX2ttcyhkZXYsICJGYWlsZWQgdG8gbG9va3VwIEdFTSBvYmplY3RcbiIpOw0KIAkJ
CXJldCA9IC1FTk9FTlQ7DQotCQkJZ290byBlcnJfZ2VtX29iamVjdF9oYW5kbGVfcHV0X3VubG9j
a2VkOw0KKwkJCWdvdG8gZXJyX2dlbV9vYmplY3RfcHV0Ow0KIAkJfQ0KLQkJZHJtX2dlbV9vYmpl
Y3RfaGFuZGxlX2dldF91bmxvY2tlZChvYmpzW2ldKTsNCi0JCWRybV9nZW1fb2JqZWN0X3B1dChv
YmpzW2ldKTsNCiANCiAJCW1pbl9zaXplID0gKGhlaWdodCAtIDEpICogbW9kZV9jbWQtPnBpdGNo
ZXNbaV0NCiAJCQkgKyBkcm1fZm9ybWF0X2luZm9fbWluX3BpdGNoKGluZm8sIGksIHdpZHRoKQ0K
QEAgLTE5NSwyMiArMTkzLDIyIEBAIGludCBkcm1fZ2VtX2ZiX2luaXRfd2l0aF9mdW5jcyhzdHJ1
Y3QgZHINCiAJCQlkcm1fZGJnX2ttcyhkZXYsDQogCQkJCSAgICAiR0VNIG9iamVjdCBzaXplICgl
enUpIHNtYWxsZXIgdGhhbiBtaW5pbXVtIHNpemUgKCV1KSBmb3IgcGxhbmUgJWRcbiIsDQogCQkJ
CSAgICBvYmpzW2ldLT5zaXplLCBtaW5fc2l6ZSwgaSk7DQotCQkJZHJtX2dlbV9vYmplY3RfaGFu
ZGxlX3B1dF91bmxvY2tlZChvYmpzW2ldKTsNCisJCQlkcm1fZ2VtX29iamVjdF9wdXQob2Jqc1tp
XSk7DQogCQkJcmV0ID0gLUVJTlZBTDsNCi0JCQlnb3RvIGVycl9nZW1fb2JqZWN0X2hhbmRsZV9w
dXRfdW5sb2NrZWQ7DQorCQkJZ290byBlcnJfZ2VtX29iamVjdF9wdXQ7DQogCQl9DQogCX0NCiAN
CiAJcmV0ID0gZHJtX2dlbV9mYl9pbml0KGRldiwgZmIsIG1vZGVfY21kLCBvYmpzLCBpLCBmdW5j
cyk7DQogCWlmIChyZXQpDQotCQlnb3RvIGVycl9nZW1fb2JqZWN0X2hhbmRsZV9wdXRfdW5sb2Nr
ZWQ7DQorCQlnb3RvIGVycl9nZW1fb2JqZWN0X3B1dDsNCiANCiAJcmV0dXJuIDA7DQogDQotZXJy
X2dlbV9vYmplY3RfaGFuZGxlX3B1dF91bmxvY2tlZDoNCitlcnJfZ2VtX29iamVjdF9wdXQ6DQog
CXdoaWxlIChpID4gMCkgew0KIAkJLS1pOw0KLQkJZHJtX2dlbV9vYmplY3RfaGFuZGxlX3B1dF91
bmxvY2tlZChvYmpzW2ldKTsNCisJCWRybV9nZW1fb2JqZWN0X3B1dChvYmpzW2ldKTsNCiAJfQ0K
IAlyZXR1cm4gcmV0Ow0KIH0NCi0tLSBhL2RyaXZlcnMvZ3B1L2RybS9kcm1faW50ZXJuYWwuaA0K
KysrIGIvZHJpdmVycy9ncHUvZHJtL2RybV9pbnRlcm5hbC5oDQpAQCAtMTU1LDcgKzE1NSw3IEBA
IHZvaWQgZHJtX3N5c2ZzX2xlYXNlX2V2ZW50KHN0cnVjdCBkcm1fZGUNCiANCiAvKiBkcm1fZ2Vt
LmMgKi8NCiBpbnQgZHJtX2dlbV9pbml0KHN0cnVjdCBkcm1fZGV2aWNlICpkZXYpOw0KLXZvaWQg
ZHJtX2dlbV9vYmplY3RfaGFuZGxlX2dldF91bmxvY2tlZChzdHJ1Y3QgZHJtX2dlbV9vYmplY3Qg
Km9iaik7DQorYm9vbCBkcm1fZ2VtX29iamVjdF9oYW5kbGVfZ2V0X2lmX2V4aXN0c191bmxvY2tl
ZChzdHJ1Y3QgZHJtX2dlbV9vYmplY3QgKm9iaik7DQogdm9pZCBkcm1fZ2VtX29iamVjdF9oYW5k
bGVfcHV0X3VubG9ja2VkKHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqKTsNCiBpbnQgZHJtX2dl
bV9oYW5kbGVfY3JlYXRlX3RhaWwoc3RydWN0IGRybV9maWxlICpmaWxlX3ByaXYsDQogCQkJICAg
ICAgIHN0cnVjdCBkcm1fZ2VtX29iamVjdCAqb2JqLA0KLS0tIGEvaW5jbHVkZS9kcm0vZHJtX2Zy
YW1lYnVmZmVyLmgNCisrKyBiL2luY2x1ZGUvZHJtL2RybV9mcmFtZWJ1ZmZlci5oDQpAQCAtMjMs
NiArMjMsNyBAQA0KICNpZm5kZWYgX19EUk1fRlJBTUVCVUZGRVJfSF9fDQogI2RlZmluZSBfX0RS
TV9GUkFNRUJVRkZFUl9IX18NCiANCisjaW5jbHVkZSA8bGludXgvYml0cy5oPg0KICNpbmNsdWRl
IDxsaW51eC9jdHlwZS5oPg0KICNpbmNsdWRlIDxsaW51eC9saXN0Lmg+DQogI2luY2x1ZGUgPGxp
bnV4L3NjaGVkLmg+DQpAQCAtMTAwLDYgKzEwMSw4IEBAIHN0cnVjdCBkcm1fZnJhbWVidWZmZXJf
ZnVuY3Mgew0KIAkJICAgICB1bnNpZ25lZCBudW1fY2xpcHMpOw0KIH07DQogDQorI2RlZmluZSBE
Uk1fRlJBTUVCVUZGRVJfSEFTX0hBTkRMRV9SRUYoX2kpCUJJVCgwdSArIChfaSkpDQorDQogLyoq
DQogICogc3RydWN0IGRybV9mcmFtZWJ1ZmZlciAtIGZyYW1lIGJ1ZmZlciBvYmplY3QNCiAgKg0K
QEAgLTE4OSw2ICsxOTIsMTAgQEAgc3RydWN0IGRybV9mcmFtZWJ1ZmZlciB7DQogCSAqLw0KIAlp
bnQgZmxhZ3M7DQogCS8qKg0KKwkgKiBAaW50ZXJuYWxfZmxhZ3M6IEZyYW1lYnVmZmVyIGZsYWdz
IGxpa2UgRFJNX0ZSQU1FQlVGRkVSX0hBU19IQU5ETEVfUkVGLg0KKwkgKi8NCisJdW5zaWduZWQg
aW50IGludGVybmFsX2ZsYWdzOw0KKwkvKioNCiAJICogQGhvdF94OiBYIGNvb3JkaW5hdGUgb2Yg
dGhlIGN1cnNvciBob3RzcG90LiBVc2VkIGJ5IHRoZSBsZWdhY3kgY3Vyc29yDQogCSAqIElPQ1RM
IHdoZW4gdGhlIGRyaXZlciBzdXBwb3J0cyBjdXJzb3IgdGhyb3VnaCBhIERSTV9QTEFORV9UWVBF
X0NVUlNPUg0KIAkgKiB1bml2ZXJzYWwgcGxhbmUuDQoNCg0KX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX18KTGluYXJvLW1tLXNpZyBtYWlsaW5nIGxpc3QgLS0g
bGluYXJvLW1tLXNpZ0BsaXN0cy5saW5hcm8ub3JnClRvIHVuc3Vic2NyaWJlIHNlbmQgYW4gZW1h
aWwgdG8gbGluYXJvLW1tLXNpZy1sZWF2ZUBsaXN0cy5saW5hcm8ub3JnCg==
